<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>æ®‹å·®è¿æ¥ï¼ˆResidual Connectionï¼‰</title>
      <link href="/2024/09/09/2024-09-09-%E6%AE%8B%E5%B7%AE%E8%BF%9E%E6%8E%A5/"/>
      <url>/2024/09/09/2024-09-09-%E6%AE%8B%E5%B7%AE%E8%BF%9E%E6%8E%A5/</url>
      
        <content type="html"><![CDATA[<h1 id="æ®‹å·®è¿æ¥ï¼ˆResidual-Connectionï¼‰"><a href="#æ®‹å·®è¿æ¥ï¼ˆResidual-Connectionï¼‰" class="headerlink" title="æ®‹å·®è¿æ¥ï¼ˆResidual Connectionï¼‰"></a>æ®‹å·®è¿æ¥ï¼ˆResidual Connectionï¼‰</h1><p><a href="https://blog.csdn.net/weixin_66526635/article/details/132411168?ops_request_misc=%7B%22request_id%22:%223415ECC2-BAC2-49E8-A135-FB3D948A035C%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=3415ECC2-BAC2-49E8-A135-FB3D948A035C&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-132411168-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=%E6%AE%8B%E5%B7%AE%E8%BF%9E%E6%8E%A5%E5%92%8C%E8%B7%B3%E8%B7%83%E8%BF%9E%E6%8E%A5&spm=1018.2226.3001.4187">ã€æ·±åº¦å­¦ä¹  | ResNetæ ¸å¿ƒæ€æƒ³ã€‘æ®‹å·®è¿æ¥ &amp; è·³è·ƒè¿æ¥ï¼šè®©ä¿¡æ¯è‡ªç”±æµåŠ¨çš„ç¥å¥‡ä¹‹é“-CSDNåšå®¢</a></p><p><img src="https://s2.loli.net/2024/09/09/bNeC7wGVQOBK4on.png" alt="image-20240909210607856.png"></p><h2 id="èƒŒæ™¯ï¼š"><a href="#èƒŒæ™¯ï¼š" class="headerlink" title="èƒŒæ™¯ï¼š"></a>èƒŒæ™¯ï¼š</h2><p>åœ¨æ·±åº¦ç¥ç»ç½‘ç»œä¸­ï¼Œéšç€å±‚æ•°çš„å¢åŠ ï¼Œç½‘ç»œçš„æ€§èƒ½åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¼šæé«˜ï¼ˆç½‘æ ¼é€€åŒ– Degradationï¼‰ã€‚ç„¶è€Œï¼Œæ·±åº¦ç½‘ç»œçš„è®­ç»ƒä¹Ÿé¢ä¸´ç€ä¸€äº›æŒ‘æˆ˜ï¼Œå…¶ä¸­ä¹‹ä¸€æ˜¯æ¢¯åº¦æ¶ˆå¤±æˆ–æ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜ã€‚å½“åå‘ä¼ æ’­è¿‡ç¨‹ä¸­çš„æ¢¯åº¦å˜å¾—éå¸¸å°æˆ–éå¸¸å¤§æ—¶ï¼Œç½‘ç»œçš„å‚æ•°æ›´æ–°ä¼šå—åˆ°å½±å“ï¼Œå¯¼è‡´è®­ç»ƒå˜å¾—å›°éš¾ã€‚</p><h3 id="æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸ï¼š"><a href="#æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸ï¼š" class="headerlink" title="æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸ï¼š"></a>æ¢¯åº¦æ¶ˆå¤±å’Œæ¢¯åº¦çˆ†ç‚¸ï¼š</h3><h4 id="æ¦‚å¿µï¼š"><a href="#æ¦‚å¿µï¼š" class="headerlink" title="æ¦‚å¿µï¼š"></a>æ¦‚å¿µï¼š</h4><p>æ¢¯åº¦æ¶ˆå¤±ï¼šåœ¨æ·±å±‚ç½‘ç»œä¸­ï¼Œæ¢¯åº¦éœ€è¦é€šè¿‡å¤šä¸ªå±‚æ¬¡è¿›è¡Œåå‘ä¼ æ’­ã€‚æ ¹æ®é“¾å¼æ³•åˆ™ï¼Œæ¢¯åº¦åœ¨ä¼ æ’­è¿‡ç¨‹ä¸­ä¼šä¸æ–­ç›¸ä¹˜ï¼Œå½“å±‚æ•°è¾ƒå¤šæ—¶ï¼Œæ¢¯åº¦å€¼å¯èƒ½ä¼šä»¥æŒ‡æ•°å½¢å¼è¡°å‡å¹¶è¶‹è¿‘äºé›¶ï¼Œå¯¼è‡´æ¢¯åº¦æ¶ˆå¤±ã€‚</p><p>æ¢¯åº¦çˆ†ç‚¸ï¼šæ·±å±‚ç½‘ç»œä¸­çš„æ¢¯åº¦åœ¨ä¼ æ’­è¿‡ç¨‹ä¸­ä¹Ÿå¯èƒ½å› é“¾å¼æ³•åˆ™çš„è¿ä¹˜æ•ˆåº”è€Œè¿…é€Ÿå¢é•¿ï¼Œç”šè‡³å‘ˆæŒ‡æ•°çº§å¢é•¿ï¼Œå¯¼è‡´ç½‘ç»œå‚æ•°æ›´æ–°è¿‡å¤§ï¼Œç½‘ç»œä¸ç¨³å®šã€‚</p><h4 id="ä¸ºä»€ä¹ˆä¼šæ¢¯åº¦æ¶ˆå¤±ï¼š"><a href="#ä¸ºä»€ä¹ˆä¼šæ¢¯åº¦æ¶ˆå¤±ï¼š" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šæ¢¯åº¦æ¶ˆå¤±ï¼š"></a>ä¸ºä»€ä¹ˆä¼šæ¢¯åº¦æ¶ˆå¤±ï¼š</h4><p>åœ¨ä½¿ç”¨æ¿€æ´»å‡½æ•°ä¸ºSigmoidæˆ–Tanhç­‰é¥±å’Œæ¿€æ´»å‡½æ•°æ—¶ï¼Œå› ä¸ºè¿™äº›å‡½æ•°åœ¨è¾“å…¥è¾ƒå¤§æˆ–è¾ƒå°çš„æƒ…å†µä¸‹ä¼šé¥±å’Œå¹¶å¯¼è‡´æ¢¯åº¦å˜å¾—éå¸¸å°ã€‚å½“è¾“å…¥æ¥è¿‘1æ—¶ï¼ŒSigmoidå‡½æ•°çš„è¾“å‡ºå€¼ä¼šæ¥è¿‘äº1ï¼Œå¯¼æ•°è¶‹è¿‘äº0ã€‚äºæ˜¯åœ¨åå‘ä¼ æ’­è¿‡ç¨‹ä¸­ï¼Œæ¢¯åº¦çš„ä¹˜ç§¯ä¼šè¶‹è¿‘äºé›¶ã€‚ï¼ˆä¸ºäº†ç¼“è§£æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Œæ·±åº¦ç¥ç»ç½‘ç»œä¸­å¸¸å¸¸ä½¿ç”¨å…¶ä»–ç±»å‹çš„æ¿€æ´»å‡½æ•°ï¼Œå¦‚ReLUï¼‰</p><p>æ·±åº¦ç¥ç»ç½‘ç»œä¸­ï¼Œæ¢¯åº¦æ˜¯é€šè¿‡é“¾å¼æ³•åˆ™è¿›è¡Œåå‘ä¼ æ’­çš„ã€‚æ¯ä¸€å±‚çš„æ¢¯åº¦éƒ½éœ€è¦ä¸å‰ä¸€å±‚çš„æ¢¯åº¦ç›¸ä¹˜ï¼Œç„¶åå†ä¼ é€’åˆ°å‰ä¸€å±‚ï¼Œä¾æ­¤ç±»æ¨ï¼Œç›´åˆ°ä¼ é€’åˆ°ç½‘ç»œçš„è¾“å…¥å±‚ã€‚å¦‚æœç½‘ç»œå±‚æ•°è¾ƒå¤šï¼Œé‚£ä¹ˆåœ¨åå‘ä¼ æ’­è¿‡ç¨‹ä¸­ä¼šç»è¿‡å¤šæ¬¡è¿ç»­çš„ä¹˜æ³•æ“ä½œï¼Œä»è€Œå¯èƒ½å¯¼è‡´æ¢¯åº¦çš„å€¼æŒ‡æ•°çº§åœ°å‡å°ï¼Œæœ€ç»ˆè¶‹è¿‘äºé›¶ï¼Œå³æ¢¯åº¦æ¶ˆå¤±ã€‚<br><img src="https://s2.loli.net/2024/09/09/253BReLWoJ4ApOQ.png" alt="image-20240909211427431.png"></p><h4 id="ä¸ºä»€ä¹ˆä¼šæ¢¯åº¦çˆ†ç‚¸ï¼š"><a href="#ä¸ºä»€ä¹ˆä¼šæ¢¯åº¦çˆ†ç‚¸ï¼š" class="headerlink" title="ä¸ºä»€ä¹ˆä¼šæ¢¯åº¦çˆ†ç‚¸ï¼š"></a>ä¸ºä»€ä¹ˆä¼šæ¢¯åº¦çˆ†ç‚¸ï¼š</h4><ul><li><p>ç¥ç»ç½‘ç»œç»è¿‡å¤šæ¬¡çš„è¿ä¹˜ï¼Œæ¯æ¬¡ä¹˜æ³•æ“ä½œéƒ½å¯èƒ½å°†æ¢¯åº¦æ”¾å¤§ï¼Œä»è€Œå¯¼è‡´æ¢¯åº¦å€¼å˜å¾—éå¸¸å¤§ï¼Œä»è€Œå¯¼è‡´æ¢¯åº¦çˆ†ç‚¸ã€‚</p></li><li><p>æ¢¯åº¦çˆ†ç‚¸ä¼šå¯¼è‡´ç½‘ç»œçš„æƒé‡å‚æ•°æ›´æ–°è¿‡å¤§ï¼Œä»è€Œä½¿å¾—æ¨¡å‹çš„è®­ç»ƒå˜å¾—ä¸ç¨³å®šã€‚</p><p><img src="https://s2.loli.net/2024/09/09/3uFWrCbyYoi7MNL.png" alt="image-20240909211523062.png"></p></li></ul><h2 id="æ®‹å·®è¿æ¥çš„æ€æƒ³ï¼š"><a href="#æ®‹å·®è¿æ¥çš„æ€æƒ³ï¼š" class="headerlink" title="æ®‹å·®è¿æ¥çš„æ€æƒ³ï¼š"></a>æ®‹å·®è¿æ¥çš„æ€æƒ³ï¼š</h2><p>æ®‹å·®è¿æ¥çš„æ ¸å¿ƒæ€æƒ³æ˜¯åœ¨ç½‘ç»œçš„ä¸€å±‚æˆ–å¤šå±‚ä¹‹é—´å¼•å…¥ç›´æ¥è¿æ¥ï¼Œä½¿å¾—è¿™äº›å±‚çš„è¾“å‡ºä¸ä»…åŒ…æ‹¬ç»è¿‡éçº¿æ€§å˜æ¢çš„ç‰¹å¾ï¼Œè¿˜åŒ…æ‹¬æœªç»å¤„ç†çš„è¾“å…¥ç‰¹å¾ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯å…è®¸ç½‘ç»œå­¦ä¹ åˆ°çš„æ˜¯è¾“å…¥å’Œè¾“å‡ºä¹‹é—´çš„æ®‹å·®ï¼ˆå³å·®å¼‚ï¼‰ï¼Œè€Œä¸æ˜¯ç›´æ¥å­¦ä¹ ä¸€ä¸ªå®Œæ•´çš„æ˜ å°„ã€‚è¿™ç§æ–¹å¼æœ‰åŠ©äºæ¢¯åº¦åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­æ›´æœ‰æ•ˆåœ°å›æµï¼Œå‡è½»æ·±åº¦ç½‘ç»œä¸­æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ã€‚</p><p>æ®‹å·®è¿æ¥çš„æ ¸å¿ƒæ€æƒ³æ˜¯å¼•å…¥ä¸€ä¸ªâ€œå¿«æ·è¿æ¥â€ï¼ˆshortcut connectionï¼‰æˆ–â€œè·³è¿‡è¿æ¥â€ï¼ˆskip connectionï¼‰ï¼Œå…è®¸æ•°æ®ç»•è¿‡ä¸€äº›å±‚ç›´æ¥ä¼ æ’­ã€‚è¿™æ ·ï¼Œç½‘ç»œä¸­çš„ä¸€éƒ¨åˆ†å¯ä»¥ç›´æ¥å­¦ä¹ åˆ°è¾“å…¥ä¸è¾“å‡ºä¹‹é—´çš„æ®‹å·®ï¼ˆå³å·®å¼‚ï¼‰ï¼Œè€Œä¸æ˜¯ç›´æ¥å­¦ä¹ åˆ°æ˜ å°„æœ¬èº«ã€‚å…·ä½“æ¥è¯´ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›å­¦ä¹ çš„ç›®æ ‡æ˜ å°„æ˜¯ H(x)ï¼Œæˆ‘ä»¬è®©ç½‘ç»œå­¦ä¹ æ®‹å·®æ˜ å°„ F(x)&#x3D;H(x)âˆ’xã€‚å› æ­¤ï¼ŒåŸå§‹çš„ç›®æ ‡æ˜ å°„å¯ä»¥è¡¨ç¤ºä¸º F(x)+xã€‚</p><p><strong>è¡¥ä¸€ä¸ªè·³è¿‡è¿æ¥ï¼ˆskip connectionsï¼‰ï¼š</strong></p><p>Skip connectionsçš„å®ç°æ–¹å¼é€šå¸¸æ˜¯å°†æŸä¸€å±‚çš„è¾“å‡ºï¼ˆé€šå¸¸ç»è¿‡ä¸€ä¸ªæ’ç­‰æ˜ å°„æˆ–ç®€å•çš„çº¿æ€§å˜æ¢ï¼‰ç›´æ¥åŠ åˆ°ä¸‹ä¸€å±‚ï¼ˆæˆ–æ›´æ·±å±‚ï¼‰çš„è¾“å‡ºä¸Šã€‚ è¿™æ ·ï¼Œç½‘ç»œçš„è¾“å‡ºå°±å¯ä»¥è¡¨ç¤ºä¸ºè¾“å…¥çš„éçº¿æ€§å˜æ¢ä¸è¾“å…¥çš„çº¿æ€§å åŠ ï¼Œå³y &#x3D; F(x) + xï¼Œå…¶ä¸­F(x)è¡¨ç¤ºè¾“å…¥xç»è¿‡ä¸€ç³»åˆ—éçº¿æ€§å˜æ¢åçš„è¾“å‡ºï¼Œxè¡¨ç¤ºç›´æ¥ä¼ é€’çš„è¾“å…¥ã€‚<br><strong>e.g. :</strong></p><ul><li><p><strong>æ¨¡å‹ä¸€å…±56å±‚ï¼Œè‹¥ç¬¬20å±‚æ—¶æ¨¡å‹å·²ç»å……åˆ†å­¦ä¹ è¾¾åˆ°æµ‹è¯•é›†æœ€ä½³æ•ˆæœï¼Œåˆ™è®©ä»21å±‚å¼€å§‹åˆ°ç¬¬56å±‚å­¦ä¹ ä¸€ç§æ’ç­‰å˜æ¢ï¼Œåœ¨æœ€åä¸€å±‚å°†ç¬¬20å±‚çš„è¾“å‡ºæ’ç­‰æ˜ å°„å‡ºæ¥ã€‚</strong></p><p><img src="https://s2.loli.net/2024/09/09/wjOu1lXDdct64qM.png" alt="image-20240909211034228.png"></p><p>æ®‹å·®è¿æ¥æ˜¯ä¸€ç§è·³è¿‡è¿æ¥ã€‚</p></li></ul><h2 id="å…·ä½“å®ç°ï¼š"><a href="#å…·ä½“å®ç°ï¼š" class="headerlink" title="å…·ä½“å®ç°ï¼š"></a>å…·ä½“å®ç°ï¼š</h2><p>åœ¨ä¼ ç»Ÿçš„æ·±åº¦ç¥ç»ç½‘ç»œä¸­ï¼Œæ¯ä¸€å±‚çš„è¾“å‡ºæ˜¯åŸºäºå‰ä¸€å±‚çš„è¾“å‡ºè¿›è¡Œè®¡ç®—ã€‚å½“ç½‘ç»œå±‚æ¬¡å¢åŠ æ—¶ï¼Œç½‘ç»œçš„è®­ç»ƒå˜å¾—å›°éš¾ï¼Œå› ä¸ºæ¢¯åº¦åœ¨åå‘ä¼ æ’­è¿‡ç¨‹ä¸­å®¹æ˜“æ¶ˆå¤±æˆ–çˆ†ç‚¸ã€‚æ®‹å·®è¿æ¥é€šè¿‡æ·»åŠ é¢å¤–çš„â€œå¿«æ·è¿æ¥â€ï¼ˆshortcut connectionsï¼‰æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚è¿™äº›å¿«æ·è¿æ¥å…è®¸ä¸€éƒ¨åˆ†è¾“å…¥ç›´æ¥è·³è¿‡ä¸€ä¸ªæˆ–å¤šä¸ªå±‚ä¼ åˆ°æ›´æ·±çš„å±‚ï¼Œä»è€Œåœ¨ä¸å¢åŠ é¢å¤–å‚æ•°æˆ–è®¡ç®—å¤æ‚åº¦çš„æƒ…å†µä¸‹ï¼Œä¿ƒè¿›æ¢¯åº¦çš„ç›´æ¥åå‘ä¼ æ’­ã€‚</p><p>å…·ä½“æ¥è¯´ï¼šè®¾æƒ³ä¸€ä¸ªç®€å•çš„ç½‘ç»œå±‚ï¼Œå…¶è¾“å…¥ä¸º ğ‘¥ï¼Œè¦é€šè¿‡ä¸€ä¸ªéçº¿æ€§å˜æ¢ ğ¹(ğ‘¥) æ¥å¾—åˆ°è¾“å‡ºã€‚åœ¨æ²¡æœ‰æ®‹å·®è¿æ¥çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå±‚çš„è¾“å‡ºå°±æ˜¯ ğ¹(ğ‘¥)ã€‚å½“å¼•å…¥æ®‹å·®è¿æ¥åï¼Œè¿™ä¸ªå±‚çš„è¾“å‡ºå˜ä¸ºğ¹(ğ‘¥) + ğ‘¥ã€‚è¿™é‡Œçš„ğ‘¥æ˜¯ç›´æ¥ä»è¾“å…¥åˆ°è¾“å‡ºçš„è·³è¿‡è¿æ¥ï¼ˆSkip Connectionï¼‰ï¼Œğ¹(ğ‘¥) + ğ‘¥å³æ˜¯è€ƒè™‘äº†è¾“å…¥æœ¬èº«çš„æ®‹å·®è¾“å‡ºã€‚è¿™æ ·è®¾è®¡å…è®¸ç½‘ç»œåœ¨éœ€è¦æ—¶å€¾å‘äºå­¦ä¹ æ›´ç®€å•çš„å‡½æ•°ï¼ˆä¾‹å¦‚ï¼Œå½“ ğ¹(ğ‘¥) æ¥è¿‘0æ—¶ï¼Œè¾“å‡ºæ¥è¿‘è¾“å…¥ï¼‰ï¼Œè¿™æœ‰åŠ©äºæé«˜ç½‘ç»œçš„è®­ç»ƒé€Ÿåº¦å’Œå‡†ç¡®æ€§ã€‚</p><h2 id="ä¼˜ç‚¹ï¼š"><a href="#ä¼˜ç‚¹ï¼š" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h2><ol><li><p>æ¢¯åº¦ä¼ æ’­ï¼š æ¢¯åº¦èƒ½å¤Ÿæ›´å®¹æ˜“åœ°é€šè¿‡æ®‹å·®è¿æ¥ä¼ é€’ã€‚åœ¨åå‘ä¼ æ’­æ—¶ï¼Œç”±äºç›´æ¥çš„è·³è¿‡è¿æ¥ï¼Œæ¢¯åº¦ä¸ä¼šæ¶ˆå¤±å¾—å¤ªå¿«ï¼Œä½¿å¾—è®­ç»ƒæ›´åŠ å®¹æ˜“ã€‚</p></li><li><p>ä¿¡æ¯æµåŠ¨ï¼š æ®‹å·®è¿æ¥å…è®¸ä¿¡æ¯ç›´æ¥ä»è¾“å…¥å±‚æµå‘åç»­å±‚ï¼Œå‡è½»äº†æ·±åº¦ç½‘ç»œä¸­ä¿¡æ¯éš¾ä»¥ä¼ é€’çš„é—®é¢˜ï¼Œæœ‰åŠ©äºä¿æŒæ›´åŠ ç›´æ¥çš„ä¿¡æ¯æµåŠ¨ã€‚</p></li><li><p>ç½‘ç»œæ·±åº¦ï¼š å…è®¸æ„å»ºéå¸¸æ·±çš„ç½‘ç»œè€Œä¸ä¼šé‡åˆ°æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ï¼Œä»è€Œæ¨åŠ¨äº†æ·±åº¦å­¦ä¹ æ¨¡å‹çš„å‘å±•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"> </span><br><span class="line"><span class="comment"># å®šä¹‰æ®‹å·®å—</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ResidualBlock</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, in_channels, out_channels, stride=<span class="number">1</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(ResidualBlock, self).__init__()</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># ç¬¬ä¸€ä¸ªå·ç§¯å±‚</span></span><br><span class="line">        self.conv1 = nn.Conv2d(in_channels, out_channels, kernel_size=<span class="number">3</span>, stride=stride, padding=<span class="number">1</span>, bias=<span class="literal">False</span>)</span><br><span class="line">        self.bn1 = nn.BatchNorm2d(out_channels)</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># æ¿€æ´»å‡½æ•°</span></span><br><span class="line">        self.relu = nn.ReLU(inplace=<span class="literal">True</span>)</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># ç¬¬äºŒä¸ªå·ç§¯å±‚</span></span><br><span class="line">        self.conv2 = nn.Conv2d(out_channels, out_channels, kernel_size=<span class="number">3</span>, stride=<span class="number">1</span>, padding=<span class="number">1</span>, bias=<span class="literal">False</span>)</span><br><span class="line">        self.bn2 = nn.BatchNorm2d(out_channels)</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># å¦‚æœè¾“å…¥å’Œè¾“å‡ºçš„é€šé“æ•°ä¸ä¸€è‡´ï¼Œéœ€è¦è¿›è¡Œè°ƒæ•´ï¼Œç”¨äºæ®‹å·®è¿æ¥</span></span><br><span class="line">        self.shortcut = nn.Sequential()</span><br><span class="line">        <span class="keyword">if</span> stride != <span class="number">1</span> <span class="keyword">or</span> in_channels != out_channels:</span><br><span class="line">            self.shortcut = nn.Sequential(</span><br><span class="line">                nn.Conv2d(in_channels, out_channels, kernel_size=<span class="number">1</span>, stride=stride, bias=<span class="literal">False</span>),</span><br><span class="line">                nn.BatchNorm2d(out_channels)</span><br><span class="line">            )</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        residual = x  <span class="comment"># ä¿å­˜è¾“å…¥ï¼Œç”¨äºæ®‹å·®è¿æ¥</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment"># ç¬¬ä¸€ä¸ªå·ç§¯å—</span></span><br><span class="line">        out = self.conv1(x)</span><br><span class="line">        out = self.bn1(out)</span><br><span class="line">        out = self.relu(out)</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># ç¬¬äºŒä¸ªå·ç§¯å—</span></span><br><span class="line">        out = self.conv2(out)</span><br><span class="line">        out = self.bn2(out)</span><br><span class="line"> </span><br><span class="line">        out += self.shortcut(residual)  <span class="comment"># æ®‹å·®è¿æ¥</span></span><br><span class="line">        out = self.relu(out)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line"> </span><br><span class="line"><span class="comment"># å®šä¹‰ResNetæ¨¡å‹</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ResNet</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, block, layers, num_classes=<span class="number">10</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(ResNet, self).__init__()</span><br><span class="line">        self.in_channels = <span class="number">64</span>  <span class="comment"># è¾“å…¥é€šé“æ•°</span></span><br><span class="line">        self.conv1 = nn.Conv2d(<span class="number">3</span>, <span class="number">64</span>, kernel_size=<span class="number">3</span>, stride=<span class="number">1</span>, padding=<span class="number">1</span>, bias=<span class="literal">False</span>)</span><br><span class="line">        self.bn1 = nn.BatchNorm2d(<span class="number">64</span>)</span><br><span class="line">        self.relu = nn.ReLU(inplace=<span class="literal">True</span>)</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># é€šè¿‡make_layerå‡½æ•°æ„å»ºResNetçš„å„å±‚</span></span><br><span class="line">        self.layer1 = self.make_layer(block, <span class="number">64</span>, layers[<span class="number">0</span>], stride=<span class="number">1</span>)</span><br><span class="line">        self.layer2 = self.make_layer(block, <span class="number">128</span>, layers[<span class="number">1</span>], stride=<span class="number">2</span>)</span><br><span class="line">        self.layer3 = self.make_layer(block, <span class="number">256</span>, layers[<span class="number">2</span>], stride=<span class="number">2</span>)</span><br><span class="line">        self.layer4 = self.make_layer(block, <span class="number">512</span>, layers[<span class="number">3</span>], stride=<span class="number">2</span>)</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># å…¨å±€å¹³å‡æ± åŒ–å±‚</span></span><br><span class="line">        self.avg_pool = nn.AdaptiveAvgPool2d((<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># å…¨è¿æ¥å±‚</span></span><br><span class="line">        self.fc = nn.Linear(<span class="number">512</span>, num_classes)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># æ„å»ºæ¯ä¸€å±‚çš„å‡½æ•°</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">make_layer</span>(<span class="params">self, block, out_channels, blocks, stride</span>):</span><br><span class="line">        layers = []</span><br><span class="line">        layers.append(block(self.in_channels, out_channels, stride))</span><br><span class="line">        self.in_channels = out_channels</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, blocks):</span><br><span class="line">            layers.append(block(out_channels, out_channels, stride=<span class="number">1</span>))</span><br><span class="line">        <span class="keyword">return</span> nn.Sequential(*layers)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="comment"># ç¬¬ä¸€ä¸ªå·ç§¯å—</span></span><br><span class="line">        out = self.conv1(x)</span><br><span class="line">        out = self.bn1(out)</span><br><span class="line">        out = self.relu(out)</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># åç»­å„å±‚çš„å·ç§¯å—</span></span><br><span class="line">        out = self.layer1(out)</span><br><span class="line">        out = self.layer2(out)</span><br><span class="line">        out = self.layer3(out)</span><br><span class="line">        out = self.layer4(out)</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># å…¨å±€å¹³å‡æ± åŒ–</span></span><br><span class="line">        out = self.avg_pool(out)</span><br><span class="line">        out = out.view(out.size(<span class="number">0</span>), -<span class="number">1</span>)</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># å…¨è¿æ¥å±‚</span></span><br><span class="line">        out = self.fc(out)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> out</span><br><span class="line"> </span><br><span class="line"><span class="comment"># åˆ›å»ºResNet18æ¨¡å‹</span></span><br><span class="line">model = ResNet(ResidualBlock, [<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>])</span><br><span class="line"> </span><br><span class="line"><span class="comment"># æ‰“å°æ¨¡å‹ç»“æ„</span></span><br><span class="line"><span class="built_in">print</span>(model)</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> æ·±åº¦å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ·±åº¦å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿æ®µæ ‘</title>
      <link href="/2024/09/08/2024-09-08-%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
      <url>/2024/09/08/2024-09-08-%E7%BA%BF%E6%AE%B5%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<h1 id="çº¿æ®µæ ‘"><a href="#çº¿æ®µæ ‘" class="headerlink" title="çº¿æ®µæ ‘"></a>çº¿æ®µæ ‘</h1><p>çº¿æ®µæ ‘æ˜¯ä¸€ç§äºŒå‰æ ‘ï¼Œä¹Ÿå°±æ˜¯å¯¹äºä¸€ä¸ªçº¿æ®µï¼Œæˆ‘ä»¬ä¼šç”¨ä¸€ä¸ªäºŒå‰æ ‘æ¥è¡¨ç¤ºã€‚</p><p>æ€§è´¨ï¼šèŠ‚ç‚¹ i çš„æƒå€¼ &#x3D; å¥¹çš„å·¦å„¿å­æƒå€¼ + å¥¹çš„å³å„¿å­æƒå€¼ã€‚</p><h2 id="1-å»ºæ ‘"><a href="#1-å»ºæ ‘" class="headerlink" title="1. å»ºæ ‘"></a>1. å»ºæ ‘</h2><p>æ ¹æ®è¿™ä¸ªæ€è·¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥å»ºæ ‘äº†ï¼Œæˆ‘ä»¬è®¾ä¸€ä¸ªç»“æ„ä½“ <code>tree</code>ï¼Œ<code>tree[i].l</code> ä¸ <code>tree[i].r</code> åˆ†åˆ«è¡¨ç¤ºè¿™ä¸ªç‚¹ä»£è¡¨çš„çº¿æ®µçš„å·¦å³ä¸‹æ ‡ï¼Œ<code>tree[i].sum</code> è¡¨ç¤ºè¿™ä¸ªèŠ‚ç‚¹è¡¨ç¤ºçš„çº¿æ®µå’Œã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œä¸€é¢—ä»1å¼€å§‹ç¼–å·çš„äºŒå‰æ ‘ï¼Œç»“ç‚¹ i çš„å·¦å„¿å­å’Œå³å„¿å­ç¼–å·åˆ†åˆ«æ˜¯ 2Ã—i å’Œ 2Ã—i+1ã€‚</p><p>å†æ ¹æ®åˆšæ‰çš„æ€§è´¨ï¼Œå¾—åˆ°å¼å­ï¼štree[ i ].sum &#x3D; tree[iâˆ—2].sum + tree [iâˆ—2+1].sum ï¼Œå°±å¯ä»¥å»ºä¸€é¢—çº¿æ®µæ ‘äº†ï¼ä»£ç å¦‚ä¸‹ï¼ˆè¿™é‡Œä»¥åŒºé—´æ±‚å’Œçš„æŸ¥è¯¢ä¸ºä¾‹ï¼‰ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> i,<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;<span class="comment">//é€’å½’å»ºæ ‘</span></span><br><span class="line">    tree[i].l=l;tree[i].r=r;</span><br><span class="line">    <span class="keyword">if</span>(l==r)&#123;<span class="comment">//å¦‚æœè¿™ä¸ªèŠ‚ç‚¹æ˜¯å¶å­èŠ‚ç‚¹</span></span><br><span class="line">        tree[i].sum=input[l];</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//äºŒåˆ†å»ºæ ‘</span></span><br><span class="line">    <span class="type">int</span> mid=(l+r)/<span class="number">2</span>;</span><br><span class="line">    <span class="built_in">build</span>(i*<span class="number">2</span>,l,mid);<span class="comment">//åˆ†åˆ«æ„é€ å·¦å­æ ‘å’Œå³å­æ ‘</span></span><br><span class="line">    <span class="built_in">build</span>(i*<span class="number">2</span>+<span class="number">1</span>,mid+<span class="number">1</span>,r);</span><br><span class="line">    tree[i].sum=tree[i*<span class="number">2</span>].sum+tree[i*<span class="number">2</span>+<span class="number">1</span>].sum;<span class="comment">//åˆšæ‰æˆ‘ä»¬å‘ç°çš„æ€§è´¨return ;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="2-ç®€å•ï¼ˆæ— pushdownï¼‰çš„çº¿æ®µæ ‘"><a href="#2-ç®€å•ï¼ˆæ— pushdownï¼‰çš„çº¿æ®µæ ‘" class="headerlink" title="2. ç®€å•ï¼ˆæ— pushdownï¼‰çš„çº¿æ®µæ ‘"></a>2. ç®€å•ï¼ˆæ— pushdownï¼‰çš„çº¿æ®µæ ‘</h2><h3 id="2-1-å•ç‚¹ä¿®æ”¹ï¼ŒåŒºé—´æŸ¥è¯¢"><a href="#2-1-å•ç‚¹ä¿®æ”¹ï¼ŒåŒºé—´æŸ¥è¯¢" class="headerlink" title="2.1 å•ç‚¹ä¿®æ”¹ï¼ŒåŒºé—´æŸ¥è¯¢"></a>2.1 å•ç‚¹ä¿®æ”¹ï¼ŒåŒºé—´æŸ¥è¯¢</h3><p><strong>çº¿æ®µæ ‘çš„æŸ¥è¯¢æ–¹æ³•ï¼ˆèŒƒå›´æŸ¥è¯¢ï¼‰ï¼š</strong></p><ol><li>å¦‚æœè¿™ä¸ªåŒºé—´è¢«å®Œå…¨åŒ…æ‹¬åœ¨ç›®æ ‡åŒºé—´é‡Œé¢ï¼Œç›´æ¥è¿”å›è¿™ä¸ªåŒºé—´çš„å€¼</li><li>å¦‚æœè¿™ä¸ªåŒºé—´çš„å·¦å„¿å­å’Œç›®æ ‡åŒºé—´æœ‰äº¤é›†ï¼Œé‚£ä¹ˆæœç´¢å·¦å„¿å­</li><li>å¦‚æœè¿™ä¸ªåŒºé—´çš„å³å„¿å­å’Œç›®æ ‡åŒºé—´æœ‰äº¤é›†ï¼Œé‚£ä¹ˆæœç´¢å³å„¿å­</li></ol><p>è¿™é‡Œä»¥åŒºé—´æ±‚å’Œçš„æŸ¥è¯¢ä¸ºä¾‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">search</span><span class="params">(<span class="type">int</span> i,<span class="type">int</span> l,<span class="type">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tree[i].l&gt;=l &amp;&amp; tree[i].r&lt;=r)<span class="comment">//å¦‚æœè¿™ä¸ªåŒºé—´è¢«å®Œå…¨åŒ…æ‹¬åœ¨ç›®æ ‡åŒºé—´é‡Œé¢ï¼Œç›´æ¥è¿”å›è¿™ä¸ªåŒºé—´çš„å€¼</span></span><br><span class="line">        <span class="keyword">return</span> tree[i].sum;</span><br><span class="line">    <span class="keyword">if</span>(tree[i].r&lt;l || tree[i].l&gt;r)  <span class="keyword">return</span> <span class="number">0</span>;<span class="comment">//å¦‚æœè¿™ä¸ªåŒºé—´å’Œç›®æ ‡åŒºé—´æ¯«ä¸ç›¸å¹²ï¼Œè¿”å›0</span></span><br><span class="line">    <span class="type">int</span> s=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(tree[i*<span class="number">2</span>].r&gt;=l)  s+=<span class="built_in">search</span>(i*<span class="number">2</span>,l,r);<span class="comment">//å¦‚æœè¿™ä¸ªåŒºé—´çš„å·¦å„¿å­å’Œç›®æ ‡åŒºé—´åˆäº¤é›†ï¼Œé‚£ä¹ˆæœç´¢å·¦å„¿å­</span></span><br><span class="line">    <span class="keyword">if</span>(tree[i*<span class="number">2</span>+<span class="number">1</span>].l&lt;=r)  s+=<span class="built_in">search</span>(i*<span class="number">2</span>+<span class="number">1</span>,l,r);<span class="comment">//å¦‚æœè¿™ä¸ªåŒºé—´çš„å³å„¿å­å’Œç›®æ ‡åŒºé—´åˆäº¤é›†ï¼Œé‚£ä¹ˆæœç´¢å³å„¿å­</span></span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ³¨æ„å‡ ä¸ªifæ¡ä»¶å’Œä¼ å‚ï¼š</p><ol><li>ä¼ å‚ï¼šèŠ‚ç‚¹ç¼–å·+å·¦èŒƒå›´+å³èŒƒå›´</li><li>å®Œå…¨åŒ…å«-&gt;ç›´æ¥è¿”å›sumï¼›</li><li>æ¯«ä¸ç›¸å¹²-&gt;è¿”å›0ï¼›</li><li>å·¦å„¿å­&#x2F;å³å„¿å­æœ‰äº¤é›†-&gt;é€’å½’æœç´¢ä¸‹å»</li></ol><p><strong>å•ç‚¹æ›´æ–°ï¼š</strong></p><p>æ€ä¹ˆä¿®æ”¹è¿™ä¸ªåŒºé—´çš„å•ç‚¹ï¼Œå…¶å®è¿™ä¸ªç›¸å¯¹ç®€å•å¾ˆå¤šï¼Œä½ è¦æŠŠåŒºé—´çš„ç¬¬disä½åŠ ä¸Škï¼Œé‚£ä¹ˆä½ ä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œçœ‹è¿™ä¸ªdisæ˜¯åœ¨å·¦å„¿å­è¿˜æ˜¯åœ¨å³å„¿å­ï¼Œåœ¨å“ªå¾€å“ªè·‘ï¼Œ</p><p>ç„¶åè¿”å›çš„æ—¶å€™ï¼Œè¿˜æ˜¯æŒ‰ç…§<code>tree[i].sum=tree[i*2].sum+tree[i*2+1].sum</code>çš„åŸåˆ™ï¼Œæ›´æ–°æ‰€æœ‰è·¯è¿‡çš„ç‚¹ã€‚</p><p>æ•´ä¸ªè¿‡ç¨‹ä¹Ÿæ˜¯é€’å½’çš„</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> i,<span class="type">int</span> dis,<span class="type">int</span> k)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(tree[i].l==tree[i].r)&#123;<span class="comment">//å¦‚æœæ˜¯å¶å­èŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¯´æ˜æ‰¾åˆ°äº†</span></span><br><span class="line">        tree[i].sum+=k;</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(dis&lt;=tree[i*<span class="number">2</span>].r)  <span class="built_in">add</span>(i*<span class="number">2</span>,dis,k);<span class="comment">//åœ¨å“ªå¾€å“ªè·‘</span></span><br><span class="line">    <span class="keyword">else</span>  <span class="built_in">add</span>(i*<span class="number">2</span>+<span class="number">1</span>,dis,k);</span><br><span class="line">    tree[i].sum=tree[i*<span class="number">2</span>].sum+tree[i*<span class="number">2</span>+<span class="number">1</span>].sum;<span class="comment">//è¿”å›æ›´æ–°</span></span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-2-åŒºé—´ä¿®æ”¹ï¼Œå•ç‚¹æŸ¥è¯¢"><a href="#2-2-åŒºé—´ä¿®æ”¹ï¼Œå•ç‚¹æŸ¥è¯¢" class="headerlink" title="2.2 åŒºé—´ä¿®æ”¹ï¼Œå•ç‚¹æŸ¥è¯¢"></a>2.2 åŒºé—´ä¿®æ”¹ï¼Œå•ç‚¹æŸ¥è¯¢</h3><p>åŒºé—´ä¿®æ”¹å’Œå•ç‚¹æŸ¥è¯¢ï¼Œæˆ‘ä»¬çš„æ€è·¯å°±å˜ä¸ºï¼šå¦‚æœæŠŠè¿™ä¸ªåŒºé—´åŠ ä¸Š k ï¼Œç›¸å½“äºæŠŠè¿™ä¸ªåŒºé—´æ¶‚ä¸Šä¸€ä¸ª k çš„æ ‡è®°ï¼Œç„¶åå•ç‚¹æŸ¥è¯¢çš„æ—¶å€™ï¼Œå°±ä»ä¸Šè·‘åˆ°ä¸‹ï¼ŒæŠŠæ²¿è·¯çš„æ ‡è®°åŠ èµ·æ¥å°±å¥½ã€‚</p><p>è¿™é‡Œé¢ç»™åŒºé—´è´´æ ‡è®°çš„æ–¹å¼ä¸ä¸Šé¢çš„åŒºé—´æŸ¥æ‰¾ç±»ä¼¼ï¼ŒåŸåˆ™è¿˜æ˜¯é‚£ä¸‰æ¡ï¼Œåªä¸è¿‡ç¬¬ä¸€æ¡ï¼šå¦‚æœè¿™ä¸ªåŒºé—´è¢«å®Œå…¨åŒ…æ‹¬åœ¨ç›®æ ‡åŒºé—´é‡Œé¢ï¼Œç›´æ¥å°†è¿™ä¸ªåŒºé—´çš„å€¼+kã€‚ï¼ˆlazyæ ‡è®°ï¼‰</p><p>å…·ä½“åšæ³•å¾ˆåƒï¼Œè¿™é‡Œè´´ä¸Šä»£ç ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> k)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(tr[p].l &gt;= l &amp;&amp; tr[p].r &lt;= r) &#123;</span><br><span class="line">tr[p].num += k;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> mid = tr[p].l + tr[p].r &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(l &lt;= mid) <span class="built_in">modify</span>(p &lt;&lt; <span class="number">1</span>, l, r, k);</span><br><span class="line"><span class="keyword">if</span>(r &gt; mid) <span class="built_in">modify</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r, k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">inline void add(int i,int l,int r,int k)&#123;</span></span><br><span class="line"><span class="comment">    if(tree[i].l&gt;=l &amp;&amp; tree[i].r&lt;=r)&#123;//å¦‚æœè¿™ä¸ªåŒºé—´è¢«å®Œå…¨åŒ…æ‹¬åœ¨ç›®æ ‡åŒºé—´é‡Œé¢ï¼Œè®²è¿™ä¸ªåŒºé—´æ ‡è®°k</span></span><br><span class="line"><span class="comment">        tree[i].sum+=k;</span></span><br><span class="line"><span class="comment">        return ;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    if(tree[i*2].r&gt;=l)</span></span><br><span class="line"><span class="comment">        add(i*2,l,r,k);</span></span><br><span class="line"><span class="comment">    if(tree[i*2+1].l&lt;=r)</span></span><br><span class="line"><span class="comment">        add(i*2+1,l,r,k);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å•ç‚¹æŸ¥è¯¢äº†ï¼Œè¿™ä¸ªæ›´å¥½ç†è§£äº†ï¼Œå°±æ˜¯disåœ¨å“ªå¾€å“ªè·‘ï¼ŒæŠŠè·¯å¾„ä¸Šæ‰€æœ‰çš„æ ‡è®°(åŠ ä¸Šlazyæ ‡è®°)åŠ ä¸Šå°±å¥½äº†ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">query</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ans += tr[p].num;<span class="comment">//ä¸€è·¯åŠ èµ·æ¥</span></span><br><span class="line"><span class="keyword">if</span>(tr[p].l == tr[p].r) <span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> mid = tr[p].l + tr[p].r &gt;&gt; <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(x &lt;= mid) <span class="built_in">query</span>(p &lt;&lt; <span class="number">1</span>, x);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">query</span>(p &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, x); </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">void search(int i,int dis)&#123;</span></span><br><span class="line"><span class="comment">    ans+=tree[i].sum;//ä¸€è·¯åŠ èµ·æ¥</span></span><br><span class="line"><span class="comment">    if(tree[i].l==tree[i].r)</span></span><br><span class="line"><span class="comment">        return ;</span></span><br><span class="line"><span class="comment">    if(dis&lt;=tree[i*2].r)</span></span><br><span class="line"><span class="comment">        search(i*2,dis);</span></span><br><span class="line"><span class="comment">    if(dis&gt;=tree[i*2+1].l)</span></span><br><span class="line"><span class="comment">        search(i*2+1,dis);</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å®Œæ•´ä»£ç ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">5e5</span> + <span class="number">7</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m, s, t;</span><br><span class="line"><span class="type">int</span> ans;</span><br><span class="line"><span class="type">int</span> a[maxn];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">segment_tree</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> l, r;</span><br><span class="line"><span class="type">int</span> num;</span><br><span class="line">&#125;tr[maxn * <span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">tr[p] = &#123;l, r, <span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">if</span>(l == r) &#123;</span><br><span class="line">tr[p].num = a[l];</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> mid = (l + r)/<span class="number">2</span>;</span><br><span class="line"><span class="built_in">build</span>(p*<span class="number">2</span>, l, mid);</span><br><span class="line"><span class="built_in">build</span>(p*<span class="number">2</span>+<span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åŒºé—´ä¿®æ”¹</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">modify</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> k)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="comment">//å®Œå…¨åœ¨åŒºé—´é‡Œé¢</span></span><br><span class="line"><span class="keyword">if</span>(tr[p].l &gt;= l &amp;&amp; tr[p].r &lt;= r) &#123;</span><br><span class="line">tr[p].num += k;</span><br><span class="line"><span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> mid = (tr[p].l + tr[p].r)/<span class="number">2</span>;</span><br><span class="line"><span class="keyword">if</span>(l &lt;= mid) <span class="built_in">modify</span>(p*<span class="number">2</span>, l, r, k);</span><br><span class="line"><span class="keyword">if</span>(r &gt; mid) <span class="built_in">modify</span>(p*<span class="number">2</span>+<span class="number">1</span>, l, r, k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å•ç‚¹æŸ¥è¯¢</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">query</span><span class="params">(<span class="type">int</span> p, <span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">ans += tr[p].num;</span><br><span class="line"><span class="keyword">if</span>(tr[p].l == tr[p].r) <span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> mid = (tr[p].l + tr[p].r)/<span class="number">2</span>;</span><br><span class="line"><span class="keyword">if</span>(x &lt;= mid) <span class="built_in">query</span>(p*<span class="number">2</span>, x);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">query</span>(p*<span class="number">2</span>+<span class="number">1</span>, x); </span><br><span class="line">&#125;</span><br><span class="line">&#125;ST;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++ i) &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">&#125;</span><br><span class="line">ST.<span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++ i) &#123;</span><br><span class="line">        <span class="type">int</span> c;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;c);</span><br><span class="line">        <span class="keyword">if</span>(c == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="type">int</span> x, y, z;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>, &amp;x, &amp;y, &amp;z);</span><br><span class="line">            ST.<span class="built_in">modify</span>(<span class="number">1</span>, x, y, z);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            ans = <span class="number">0</span>;</span><br><span class="line">            <span class="type">int</span> x;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">            ST.<span class="built_in">query</span>(<span class="number">1</span>, x);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">int main()</span></span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">n = 100;</span></span><br><span class="line"><span class="comment">for (int i = 1; i &lt;= n; ++ i) &#123;</span></span><br><span class="line"><span class="comment">a[i] = i;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">ST.build(1, 1, n);</span></span><br><span class="line"><span class="comment">m = 10;</span></span><br><span class="line"><span class="comment">for (int i = 1; i &lt;= m; ++ i) &#123;</span></span><br><span class="line"><span class="comment">int l = 1, r = 100;</span></span><br><span class="line"><span class="comment">ST.modify(1, l, r, 10000);</span></span><br><span class="line"><span class="comment">ans = 0;</span></span><br><span class="line"><span class="comment">// query(p, x), p = 1, x ä¸ºæƒ³è¦æŸ¥è¯¢çš„ç‚¹çš„ä¸‹æ ‡</span></span><br><span class="line"><span class="comment">ST.query(1, 50); // å•ç‚¹æŸ¥è¯¢ ä¸‹æ ‡ä¸º 50 çš„ç‚¹çš„å€¼ï¼Œans = 50 + 10000 * i</span></span><br><span class="line"><span class="comment">cout &lt;&lt; i &lt;&lt; &quot; &quot; &lt;&lt; ans &lt;&lt; &#x27;\n&#x27;;</span></span><br><span class="line"><span class="comment">ans = 0;</span></span><br><span class="line"><span class="comment">ST.query(1, 100); // å•ç‚¹æŸ¥è¯¢ ans = 100 + 10000 * i</span></span><br><span class="line"><span class="comment">cout &lt;&lt; i &lt;&lt; &quot; &quot; &lt;&lt; ans &lt;&lt; &#x27;\n&#x27;; </span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">return 0;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
            <tag> c++ </tag>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Transformerè§£æ</title>
      <link href="/2024/09/05/2024-09-05-Transformer%E8%A7%A3%E6%9E%90/"/>
      <url>/2024/09/05/2024-09-05-Transformer%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<h1 id="Transformerè§£æï¼ˆAttention-Is-All-You-Needï¼‰"><a href="#Transformerè§£æï¼ˆAttention-Is-All-You-Needï¼‰" class="headerlink" title="Transformerè§£æï¼ˆAttention Is All You Needï¼‰"></a>Transformerè§£æï¼ˆAttention Is All You Needï¼‰</h1><p><a href="https://blog.csdn.net/weixin_42475060/article/details/121101749">ã€è¶…è¯¦ç»†ã€‘ã€åŸç†ç¯‡&amp;å®æˆ˜ç¯‡ã€‘ä¸€æ–‡è¯»æ‡‚Transformer-CSDNåšå®¢</a></p><p><a href="https://www.bilibili.com/video/BV1pu411o7BE/?spm_id_from=333.788&vd_source=d2728007bbda9125d177004b9124afc1">Transformerè®ºæ–‡é€æ®µç²¾è¯»ã€è®ºæ–‡ç²¾è¯»ã€‘_å“”å“©å“”å“©_bilibili</a></p><p><a href="https://blog.csdn.net/weixin_42475060/article/details/121101749?ops_request_misc=%7B%22request_id%22:%2223205416-E55A-4366-8460-16BF03B50DC7%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=23205416-E55A-4366-8460-16BF03B50DC7&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-2-121101749-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=Transformer&spm=1018.2226.3001.4187">ã€è¶…è¯¦ç»†ã€‘ã€åŸç†ç¯‡&amp;å®æˆ˜ç¯‡ã€‘ä¸€æ–‡è¯»æ‡‚Transformer-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/2401_84033492/article/details/137428500?ops_request_misc=&request_id=&biz_id=102&utm_term=%E6%AE%8B%E5%B7%AE%E8%BF%9E%E6%8E%A5&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-8-137428500.142%5Ev100%5Epc_search_result_base8&spm=1018.2226.3001.4187">å¤§æ¨¡å‹é¢è¯•å‡†å¤‡ï¼ˆåäºŒï¼‰ï¼šæ·±å…¥å‰–æTransformer - æ®‹å·®è¿æ¥å’Œå±‚å½’ä¸€åŒ–_æ®‹å·®å±‚å’Œå½’ä¸€åŒ–å±‚-CSDNåšå®¢</a></p><p><img src="https://s2.loli.net/2024/09/09/AkNgzf385QGD1pq.png" alt="a78c6302f00b8b42a12d28dd3081a82c[1].png"></p><p>â€œAttention Is All You Needâ€ æ˜¯ä¸€ç¯‡ç”± Ashish Vaswani ç­‰äººæ’°å†™çš„è®ºæ–‡ï¼Œå‘è¡¨äº 2017 å¹´çš„ NeurIPS ä¼šè®®ä¸Šã€‚è¿™ç¯‡è®ºæ–‡æå‡ºäº† Transformer æ¨¡å‹ï¼ŒTransformeræ˜¯ä¸€ç§ç”¨äºè‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰å’Œå…¶ä»–åºåˆ—åˆ°åºåˆ—ï¼ˆsequence-to-sequenceï¼‰ä»»åŠ¡çš„æ·±åº¦å­¦ä¹ æ¨¡å‹æ¶æ„ã€‚Transformeræ¶æ„å¼•å…¥äº†è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ˆself-attention mechanismï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªå…³é”®çš„åˆ›æ–°ï¼Œä½¿å…¶åœ¨å¤„ç†åºåˆ—æ•°æ®æ—¶è¡¨ç°å‡ºè‰²ã€‚</p><h2 id="Transformer-æ¨¡å‹çš„ä¸»è¦ç‰¹ç‚¹ï¼š"><a href="#Transformer-æ¨¡å‹çš„ä¸»è¦ç‰¹ç‚¹ï¼š" class="headerlink" title="Transformer æ¨¡å‹çš„ä¸»è¦ç‰¹ç‚¹ï¼š"></a>Transformer æ¨¡å‹çš„ä¸»è¦ç‰¹ç‚¹ï¼š</h2><ol><li><p><strong>è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ˆSelf-Attentionï¼‰</strong>ï¼šTransformer æ¨¡å‹çš„æ ¸å¿ƒæ˜¯è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œå®ƒå…è®¸æ¨¡å‹åœ¨åºåˆ—çš„æ¯ä¸ªä½ç½®éƒ½è®¡ç®—ä¸å…¶ä»–ä½ç½®çš„æ³¨æ„åŠ›ï¼Œä»è€Œæ•æ‰åºåˆ—å†…éƒ¨çš„é•¿è·ç¦»ä¾èµ–å…³ç³»ã€‚è¿™ç§æœºåˆ¶ä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£æ–‡æœ¬ä¸­çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p></li><li><p><strong>å¹¶è¡ŒåŒ–å¤„ç†</strong>ï¼šä¸å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰å’Œé•¿çŸ­æœŸè®°å¿†ç½‘ç»œï¼ˆLSTMï¼‰ä¸åŒï¼ŒTransformer æ¨¡å‹å¯ä»¥å¹¶è¡Œå¤„ç†åºåˆ—ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œè¿™å¤§å¤§æé«˜äº†æ¨¡å‹çš„è®­ç»ƒé€Ÿåº¦ã€‚</p></li><li><p><strong>ç¼–ç å™¨-è§£ç å™¨æ¶æ„</strong>ï¼šTransformer æ¨¡å‹é€šå¸¸ç”±ç¼–ç å™¨å’Œè§£ç å™¨ä¸¤éƒ¨åˆ†ç»„æˆã€‚ç¼–ç å™¨å°†è¾“å…¥åºåˆ—è½¬æ¢ä¸ºä¸­é—´è¡¨ç¤ºï¼Œè§£ç å™¨åˆ™æ ¹æ®è¿™ä¸ªè¡¨ç¤ºç”Ÿæˆè¾“å‡ºåºåˆ—ã€‚è¿™ç§æ¶æ„ç‰¹åˆ«é€‚ç”¨äºæœºå™¨ç¿»è¯‘ç­‰ä»»åŠ¡ã€‚</p></li><li><p><strong>ä½ç½®ç¼–ç </strong>ï¼šç”±äºè‡ªæ³¨æ„åŠ›æœºåˆ¶æœ¬èº«ä¸åŒ…å«åºåˆ—ä¸­çš„ä½ç½®ä¿¡æ¯ï¼ŒTransformer å¼•å…¥äº†ä½ç½®ç¼–ç æ¥ä¸ºæ¨¡å‹æä¾›åºåˆ—ä¸­å•è¯çš„ä½ç½®ä¿¡æ¯ã€‚</p></li><li><p><strong>å¤šå¤´æ³¨æ„åŠ›ï¼ˆMulti-Head Attentionï¼‰</strong>ï¼šTransformer æ¨¡å‹ä½¿ç”¨å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶æ¥ä»ä¸åŒçš„è¡¨ç¤ºå­ç©ºé—´ä¸­æ•æ‰ä¿¡æ¯ï¼Œè¿™å¢å¼ºäº†æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›ã€‚</p></li><li><p><strong>å±‚æ ‡å‡†åŒ–ï¼ˆLayer Normalizationï¼‰</strong>å’Œ<strong>æ®‹å·®è¿æ¥ï¼ˆResidual Connectionsï¼‰</strong>ï¼šè¿™äº›æŠ€æœ¯æœ‰åŠ©äºæé«˜æ¨¡å‹çš„è®­ç»ƒç¨³å®šæ€§å’Œæ€§èƒ½ã€‚</p></li></ol><h2 id="Transformeré‡ç‚¹"><a href="#Transformeré‡ç‚¹" class="headerlink" title="Transformeré‡ç‚¹"></a>Transformeré‡ç‚¹</h2><h3 id="ç¼–ç å™¨ï¼ˆEncoderï¼‰ï¼š"><a href="#ç¼–ç å™¨ï¼ˆEncoderï¼‰ï¼š" class="headerlink" title="ç¼–ç å™¨ï¼ˆEncoderï¼‰ï¼š"></a>ç¼–ç å™¨ï¼ˆEncoderï¼‰ï¼š</h3><p>ç¼–ç å™¨ï¼šï¼ˆå¤šå¤´æ³¨æ„åŠ›+MLP+æ®‹å·®è¿æ¥ï¼‰*Nï¼ˆN&#x3D;6ï¼‰</p><ul><li><p>2 sub layer: </p><ol><li>Multi-Head Attentionï¼ˆå¤šå¤´æ³¨æ„åŠ›ï¼‰</li><li>position-wise fully connected feed-forward networkï¼ˆä¸€ä¸ªMLPï¼‰</li></ol><p>åœ¨æ¯ä¸€ä¸ªsub layerä¸­ï¼Œæœ‰ä¸€ä¸ªresidual connectionï¼ˆæ®‹å·®è¿æ¥ï¼‰å’Œä¸€ä¸ªLayer Normï¼ˆå±‚å½’ä¸€åŒ–ï¼‰ã€‚</p><p><a href="https://blog.csdn.net/m0_73624835/article/details/134743624?ops_request_misc=%7B%22request_id%22:%22F95741FB-CE0D-4A26-A431-25A8C54101E0%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=F95741FB-CE0D-4A26-A431-25A8C54101E0&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-134743624-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=%E6%AE%8B%E5%B7%AE%E8%BF%9E%E6%8E%A5&spm=1018.2226.3001.4187">æ®‹å·®è¿æ¥ï¼ˆResidual Connectionï¼‰-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/weixin_66526635/article/details/132411168?ops_request_misc=%7B%22request_id%22:%223415ECC2-BAC2-49E8-A135-FB3D948A035C%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=3415ECC2-BAC2-49E8-A135-FB3D948A035C&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-132411168-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=%E6%AE%8B%E5%B7%AE%E8%BF%9E%E6%8E%A5%E5%92%8C%E8%B7%B3%E8%B7%83%E8%BF%9E%E6%8E%A5&spm=1018.2226.3001.4187">ã€æ·±åº¦å­¦ä¹  | ResNetæ ¸å¿ƒæ€æƒ³ã€‘æ®‹å·®è¿æ¥ &amp; è·³è·ƒè¿æ¥ï¼šè®©ä¿¡æ¯è‡ªç”±æµåŠ¨çš„ç¥å¥‡ä¹‹é“-CSDNåšå®¢</a></p><p>Layer Norm(x+sub layer(x))</p><p>[BatchNormå’ŒLayerNormâ€”â€”é€šä¿—æ˜“æ‡‚çš„ç†è§£_layernormå’Œbatchnorm-CSDNåšå®¢](<a href="https://blog.csdn.net/Little_White_9/article/details/123345062?ops_request_misc=%7B%22request_id%22:%225650B123-9D57-41CE-A28B-51467C660DDF%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=5650B123-9D57-41CE-A28B-51467C660DDF&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-123345062-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=Layer">https://blog.csdn.net/Little_White_9/article/details/123345062?ops_request_misc=%7B%22request%5Fid%22%3A%225650B123-9D57-41CE-A28B-51467C660DDF%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=5650B123-9D57-41CE-A28B-51467C660DDF&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-123345062-null-null.142^v100^pc_search_result_base8&amp;utm_term=Layer</a> Norm&amp;spm&#x3D;1018.2226.3001.4187)</p><ul><li><p>batchNormå’ŒlayerNorm:</p><p><img src="https://s2.loli.net/2024/09/09/sTIE2vQASRWmqnu.png" alt="image-20240909205149244.png"></p><p>åœ¨ä¸Šé¢çš„ç«‹æ–¹ä½“ä¸­ï¼Œå¯ä»¥ç†è§£ä¸ºbatch(æœ‰å¤šå°‘ä¸ªå¥å­)ï¼Œseqï¼ˆå¥å­é‡Œæœ‰å¤šå°‘è¯ï¼‰,featureï¼ˆä¸€ä¸ªè¯çš„å‘é‡è¡¨ç¤ºï¼Œåœ¨è®ºæ–‡ä¸­æ˜¯é•¿åº¦ä¸º512)ã€‚å‡å€¼å˜ä¸º0æ–¹å·®å˜ä¸º1ï¼ˆå‡å»å‡å€¼å†é™¤ä»¥æ ‡å‡†å·®ï¼‰ã€‚</p><p>batchNormï¼ˆæ‰¹å½’ä¸€åŒ–ï¼‰æ˜¯å…³æ³¨çš„ä¸åŒæ ·æœ¬å’Œåºåˆ—çš„åŒä¸€featureçš„åˆ‡é¢ï¼ˆè“è‰²ï¼‰ã€‚</p><p>è€ŒlayerNormï¼ˆå±‚å½’ä¸€åŒ–ï¼‰å…³æ³¨çš„æ˜¯ä¸€ä¸ªæ ·æœ¬ä¸‹çš„ä¸œè¥¿ï¼ˆé»„è‰²ï¼‰ã€‚</p></li></ul></li></ul><p>ç¼–ç å™¨çš„è¾“å‡ºä½œä¸ºè§£ç å™¨çš„è¾“å…¥ã€‚</p><h3 id="è§£ç å™¨ï¼ˆDecoderï¼‰ï¼š"><a href="#è§£ç å™¨ï¼ˆDecoderï¼‰ï¼š" class="headerlink" title="è§£ç å™¨ï¼ˆDecoderï¼‰ï¼š"></a>è§£ç å™¨ï¼ˆDecoderï¼‰ï¼š</h3><p>è§£ç å™¨ï¼šï¼ˆå¸¦æ©ç çš„å¤šå¤´æ³¨æ„åŠ›+å¤šå¤´æ³¨æ„åŠ›+MLP+æ®‹å·®è¿æ¥ï¼‰*Nï¼ˆN&#x3D;6ï¼‰</p><ul><li>3 sub layer: <ol><li>Masked Multi-Head Attentionï¼ˆå¸¦æ©ç å¤šå¤´æ³¨æ„åŠ›ï¼‰</li><li>Multi-Head Attentionï¼ˆå¤šå¤´æ³¨æ„åŠ›)</li><li>position-wise fully connected feed-forward networkï¼ˆä¸€ä¸ªMLPï¼‰</li></ol></li></ul><p>åœ¨ Transformer æ¨¡å‹ä¸­ï¼Œå¸¦æ©ç çš„å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ï¼ˆMasked Multi-Head Attentionï¼‰ä¸»è¦ç”¨äºè§£ç å™¨ï¼ˆDecoderï¼‰éƒ¨åˆ†ï¼Œå…¶ä½œç”¨æ˜¯ç¡®ä¿è§£ç å™¨åœ¨ç”Ÿæˆè¾“å‡ºåºåˆ—æ—¶ï¼Œæ¯ä¸€æ­¥åªèƒ½ä½¿ç”¨ä¹‹å‰çš„æ—¶é—´æ­¥çš„ä¿¡æ¯ï¼Œè€Œä¸èƒ½â€œçœ‹åˆ°â€æœªæ¥çš„ä¿¡æ¯ã€‚è¿™ç§æœºåˆ¶å¯¹äºä¿æŒç”Ÿæˆåºåˆ—çš„è‡ªå›å½’ç‰¹æ€§è‡³å…³é‡è¦ï¼Œä»¥ä¸‹æ˜¯å…¶å…·ä½“ä½œç”¨å’Œé‡è¦æ€§ï¼š</p><ol><li><strong>è‡ªå›å½’ç‰¹æ€§</strong>ï¼šåœ¨åºåˆ—ç”Ÿæˆä»»åŠ¡ï¼ˆå¦‚è¯­è¨€æ¨¡å‹ã€æœºå™¨ç¿»è¯‘ï¼‰ä¸­ï¼Œæ¨¡å‹åœ¨ç”Ÿæˆå½“å‰è¯çš„åŒæ—¶ï¼Œåªèƒ½ä¾èµ–äºä¹‹å‰å·²ç»ç”Ÿæˆçš„è¯ï¼Œè€Œä¸èƒ½åˆ©ç”¨æœªæ¥çš„è¯ã€‚å¸¦æ©ç çš„å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶é€šè¿‡æ©ç ï¼ˆMaskingï¼‰æ“ä½œå®ç°è¿™ä¸€ç‚¹ï¼Œç¡®ä¿åœ¨è®¡ç®—å½“å‰ä½ç½®çš„æ³¨æ„åŠ›æƒé‡æ—¶ï¼Œåªè€ƒè™‘å½“å‰å’Œä¹‹å‰ä½ç½®çš„ä¿¡æ¯ã€‚</li><li><strong>é¿å…æœªæ¥ä¿¡æ¯æ³„éœ²</strong>ï¼šåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæ¨¡å‹åº”è¯¥åªæ ¹æ®ç»™å®šçš„è¾“å…¥åºåˆ—ç”Ÿæˆè¾“å‡ºï¼Œè€Œä¸åº”è¯¥åˆ©ç”¨æœªæ¥çš„ä¿¡æ¯ã€‚å¦‚æœä¸ä½¿ç”¨æ©ç ï¼Œæ¨¡å‹å¯èƒ½ä¼šâ€œä½œå¼Šâ€ï¼Œåˆ©ç”¨æœªæ¥çš„ä¿¡æ¯æ¥ç”Ÿæˆå½“å‰çš„è¾“å‡ºï¼Œè¿™ä¼šå½±å“æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›å’Œå®ç”¨æ€§ã€‚</li><li><strong>æé«˜æ¨¡å‹çš„é²æ£’æ€§</strong>ï¼šé€šè¿‡é™åˆ¶æ¨¡å‹åªèƒ½ä½¿ç”¨è¿‡å»çš„ä¿¡æ¯ï¼Œå¸¦æ©ç çš„å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶è¿«ä½¿æ¨¡å‹å­¦ä¹ å¦‚ä½•æ›´å¥½åœ°ä»å·²æœ‰çš„ä¿¡æ¯ä¸­æå–å’Œåˆ©ç”¨æœ‰ç”¨çš„ç‰¹å¾ï¼Œä»è€Œæé«˜äº†æ¨¡å‹çš„é²æ£’æ€§ã€‚</li><li><strong>å®ç°å¹¶è¡Œè§£ç </strong>ï¼šåœ¨è§£ç è¿‡ç¨‹ä¸­ï¼Œç”±äºæ¯ä¸ªæ—¶é—´æ­¥çš„è¾“å‡ºåªä¾èµ–äºä¹‹å‰çš„è¾“å‡ºï¼Œè¿™å…è®¸æ¨¡å‹å¹¶è¡Œç”Ÿæˆæ•´ä¸ªåºåˆ—ï¼Œè€Œä¸æ˜¯å¿…é¡»ç­‰å¾…å‰ä¸€ä¸ªè¯ç”Ÿæˆå®Œæ¯•ã€‚è¿™åœ¨æŸäº›åœºæ™¯ä¸‹å¯ä»¥æé«˜è§£ç çš„æ•ˆç‡ã€‚</li><li><strong>ä¿æŒåºåˆ—ç”Ÿæˆçš„è¿è´¯æ€§</strong>ï¼šåœ¨ç”Ÿæˆæ–‡æœ¬æˆ–å…¶ä»–ç±»å‹çš„åºåˆ—æ•°æ®æ—¶ï¼Œä¿æŒåºåˆ—çš„è¿è´¯æ€§å’Œé€»è¾‘æ€§æ˜¯éå¸¸é‡è¦çš„ã€‚å¸¦æ©ç çš„å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶é€šè¿‡ç¡®ä¿æ¯ä¸€æ­¥ç”Ÿæˆéƒ½åªä¾èµ–äºä¹‹å‰çš„ä¿¡æ¯ï¼Œæœ‰åŠ©äºç”Ÿæˆæ›´åŠ è¿è´¯å’Œåˆç†çš„åºåˆ—ã€‚</li></ol><p>åœ¨ Transformer æ¨¡å‹ä¸­ï¼Œè¿™ç§æ©ç é€šå¸¸æ˜¯é€šè¿‡ä¸€ä¸ªä¸Šä¸‰è§’çŸ©é˜µå®ç°çš„ï¼Œå…¶ä¸­æœªæ¥ä½ç½®çš„æƒé‡è¢«è®¾ç½®ä¸ºä¸€ä¸ªéå¸¸å¤§çš„è´Ÿæ•°ï¼ˆä¾‹å¦‚è´Ÿæ— ç©·å¤§ï¼‰ï¼Œè¿™æ ·åœ¨åº”ç”¨ softmax å‡½æ•°æ—¶ï¼Œè¿™äº›ä½ç½®çš„æ³¨æ„åŠ›æƒé‡ä¼šæ¥è¿‘äºé›¶ï¼Œä»è€Œè¢«å¿½ç•¥ã€‚è¿™ç§æ©ç ä¹Ÿè¢«ç§°ä¸ºå› æœæ©ç ï¼ˆCausal Maskï¼‰ï¼Œå› ä¸ºå®ƒç¡®ä¿äº†è§£ç è¿‡ç¨‹ä¸­çš„å› æœå…³ç³»ã€‚</p><p>ç¼–ç å™¨å’Œè§£ç å™¨ä¹‹é—´çš„è”ç³»ä½œç”¨çš„å‡ ä¸ªå…³é”®ç‚¹ï¼š</p><ol><li><strong>ä¿¡æ¯ä¼ é€’</strong>ï¼šç¼–ç å™¨å°†è¾“å…¥åºåˆ—ï¼ˆå¦‚æºè¯­è¨€æ–‡æœ¬ï¼‰è½¬æ¢ä¸ºä¸€ç³»åˆ—è¿ç»­çš„è¡¨ç¤ºï¼Œè§£ç å™¨åˆ™åˆ©ç”¨è¿™äº›è¡¨ç¤ºæ¥ç”Ÿæˆè¾“å‡ºåºåˆ—ï¼ˆå¦‚ç›®æ ‡è¯­è¨€æ–‡æœ¬ï¼‰ã€‚ç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›æœºåˆ¶ä½¿å¾—è§£ç å™¨èƒ½å¤Ÿåœ¨æ¯ä¸€æ­¥ç”Ÿæˆè¾“å‡ºæ—¶ï¼Œéƒ½èƒ½å¤Ÿå‚è€ƒç¼–ç å™¨æä¾›çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</li><li><strong>å¯¹é½å…³ç³»</strong>ï¼šåœ¨æœºå™¨ç¿»è¯‘ç­‰ä»»åŠ¡ä¸­ï¼Œç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›æœºåˆ¶æœ‰åŠ©äºè¯†åˆ«è¾“å…¥åºåˆ—å’Œè¾“å‡ºåºåˆ—ä¹‹é—´çš„å¯¹é½å…³ç³»ã€‚ä¾‹å¦‚ï¼Œå®ƒå¯ä»¥å¸®åŠ©æ¨¡å‹ç¡®å®šåœ¨ç¿»è¯‘è¿‡ç¨‹ä¸­ï¼Œæºè¯­è¨€ä¸­çš„æŸä¸ªè¯å¯¹åº”äºç›®æ ‡è¯­è¨€ä¸­çš„å“ªä¸ªè¯ã€‚</li><li><strong>ä¸Šä¸‹æ–‡å»ºæ¨¡</strong>ï¼šè§£ç å™¨åœ¨ç”Ÿæˆæ¯ä¸ªè¾“å‡ºè¯æ—¶ï¼Œä¸ä»…è¦è€ƒè™‘å·²ç»ç”Ÿæˆçš„è¾“å‡ºåºåˆ—çš„éƒ¨åˆ†ï¼Œè¿˜è¦è€ƒè™‘æ•´ä¸ªè¾“å…¥åºåˆ—çš„ä¸Šä¸‹æ–‡ã€‚ç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›æœºåˆ¶ä½¿å¾—è§£ç å™¨èƒ½å¤Ÿåœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­å……åˆ†åˆ©ç”¨è¾“å…¥åºåˆ—çš„å…¨å±€ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</li><li><strong>çµæ´»æ€§</strong>ï¼šç¼–ç å™¨-è§£ç å™¨æ¶æ„æä¾›äº†çµæ´»æ€§ï¼Œä½¿å¾—æ¨¡å‹å¯ä»¥å¤„ç†å„ç§åºåˆ—åˆ°åºåˆ—çš„ä»»åŠ¡ï¼Œå¦‚æ–‡æœ¬æ‘˜è¦ã€é—®ç­”ç³»ç»Ÿã€å¯¹è¯ç³»ç»Ÿç­‰ï¼Œè€Œä¸ä»…ä»…æ˜¯æœºå™¨ç¿»è¯‘ã€‚</li><li><strong>å¹¶è¡Œå¤„ç†</strong>ï¼šåœ¨è®­ç»ƒé˜¶æ®µï¼Œç¼–ç å™¨å¯ä»¥å¹¶è¡Œå¤„ç†æ•´ä¸ªè¾“å…¥åºåˆ—ï¼Œè€Œè§£ç å™¨åˆ™å¯ä»¥å¹¶è¡Œç”Ÿæˆæ•´ä¸ªè¾“å‡ºåºåˆ—ï¼Œè¿™å¤§å¤§æé«˜äº†æ¨¡å‹çš„è®­ç»ƒæ•ˆç‡ã€‚</li><li><strong>è‡ªå›å½’ç‰¹æ€§</strong>ï¼šå°½ç®¡è§£ç å™¨å¯ä»¥å¹¶è¡Œæ¥æ”¶ç¼–ç å™¨çš„è¾“å‡ºï¼Œä½†åœ¨ç”Ÿæˆè¾“å‡ºåºåˆ—æ—¶ï¼Œå®ƒä»ç„¶ä¿æŒè‡ªå›å½’ç‰¹æ€§ï¼Œå³åœ¨ç”Ÿæˆå½“å‰è¯æ—¶ï¼Œåªèƒ½ä½¿ç”¨ä¹‹å‰çš„æ—¶é—´æ­¥ä¿¡æ¯ï¼Œè€Œä¸èƒ½ä½¿ç”¨æœªæ¥çš„ä¿¡æ¯ã€‚</li></ol><p>åœ¨ Transformer æ¨¡å‹çš„å…·ä½“å®ç°ä¸­ï¼Œç¼–ç å™¨-è§£ç å™¨æ³¨æ„åŠ›å±‚é€šå¸¸ä½äºè§£ç å™¨çš„æ¯ä¸ªå±‚ä¸­ã€‚åœ¨è¿™ä¸€å±‚æ¬¡ä¸Šï¼ŒæŸ¥è¯¢ï¼ˆQueriesï¼‰æ¥è‡ªäºè§£ç å™¨çš„ä¸Šä¸€å±‚è¾“å‡ºï¼Œé”®ï¼ˆKeysï¼‰å’Œå€¼ï¼ˆValuesï¼‰æ¥è‡ªäºç¼–ç å™¨çš„è¾“å‡ºã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œè§£ç å™¨å¯ä»¥æœ‰æ•ˆåœ°åˆ©ç”¨ç¼–ç å™¨å¤„ç†è¿‡çš„è¾“å…¥åºåˆ—ä¿¡æ¯æ¥ç”Ÿæˆè¾“å‡ºåºåˆ—ã€‚</p><h3 id="Attentionï¼š"><a href="#Attentionï¼š" class="headerlink" title="Attentionï¼š"></a>Attentionï¼š</h3><p>Qã€Kã€Vï¼ˆéƒ½æ˜¯çŸ©é˜µï¼‰ï¼š</p><p><img src="C:\Users\11505\AppData\Roaming\Typora\typora-user-images\image-20240909214257577.png" alt="image-20240909214257577"></p><p>å¯¹äºæ¯ä¸€ä¸ªkeyï¼Œæœ‰ä¸€ä¸ªvalueå’Œå®ƒå¯¹åº”ã€‚</p><p>queryï¼ˆé»„è‰²éƒ¨åˆ†ï¼‰å°†è¿›è¡ŒæŸ¥è¯¢ï¼Œæœç´¢åˆ°ä¸queryç›¸ä¼¼åº¦æœ€å¤§çš„è‹¥å¹²keyï¼Œå¹¶è¿›è¡Œæƒé‡çš„åˆ†é…ï¼ˆç›¸ä¼¼åº¦è¶Šé«˜çš„æƒé‡ä¹Ÿå°±è¶Šé«˜ï¼‰ï¼Œç»¼åˆvalueè¿”å›ç»“æœã€‚</p><p>ä¸åŒæ³¨æ„åŠ›-&gt;ä¸åŒæƒé‡ï¼Œç»“æœä¹Ÿä¸åŒ</p><h4 id="Scaled-Dot-Product-Attention"><a href="#Scaled-Dot-Product-Attention" class="headerlink" title="Scaled Dot-Product Attention"></a>Scaled Dot-Product Attention</h4><p>Transformerè‡ªå·±çš„æ³¨æ„åŠ›æœºåˆ¶å«åšï¼š<strong>Scaled Dot-Product Attention</strong>ã€‚</p><p>$$<br>Attention(Q,K,V)&#x3D;softmax(QK^T&#x2F;\sqrt{dk})V<br>$$</p><p>è¿™é‡Œçš„queryå’Œkeyçš„ç»´åº¦æ˜¯ä¸€æ ·çš„ï¼ˆéƒ½æ˜¯dkï¼‰ï¼Œè€Œvalueçš„ç»´åº¦æ˜¯ï¼ˆdvï¼‰ã€‚</p><p>æ³¨æ„åˆ°softmaxä¸­çš„å…¬å¼ï¼ŒQä¹˜ä»¥Kçš„è½¬ç½®ï¼ˆåšä¸€ä¸ªå†…ç§¯ï¼Œä½™å¼¦ç›¸ä¼¼åº¦ï¼‰ï¼Œå†é™¤ä»¥æ ¹å·dkï¼Œå†softmaxï¼ˆå¯¹æ¯ä¸€è¡Œåšsoftmaxï¼‰å¾—åˆ°nä¸ªéè´Ÿçš„ä¸”åŠ èµ·æ¥å’Œç­‰äº1çš„æƒé‡ã€‚</p><p><img src="https://s2.loli.net/2024/09/09/VeZ7kDjfEz9XHnw.png" alt="image-20240909220428169.png"></p><p>è¿™é‡Œå…¶å®æ˜¯ä¸€ä¸ªç‚¹ä¹˜æ³¨æ„åŠ›ï¼ˆdot-product attentionï¼‰+é™¤ä»¥æ ¹å·dk</p><p><strong>ä¸ºä»€ä¹ˆé™¤ä»¥æ ¹å·dk</strong>ï¼Ÿ</p><p>Scaled dot-product attention ä¸­çš„ç¼©æ”¾å› å­<br>$$<br>\sqrt{dk}<br>$$<br> æ˜¯ä¸ºäº†è°ƒæ•´ç‚¹ç§¯æ³¨æ„åŠ›çš„ç¼©æ”¾ï¼Œä»¥é˜²æ­¢åœ¨è®¡ç®—æ³¨æ„åŠ›åˆ†æ•°æ—¶å‡ºç°è¿‡å¤§çš„æ•°å€¼ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æ¢¯åº¦æ¶ˆå¤±æˆ–è€…æ¢¯åº¦çˆ†ç‚¸çš„é—®é¢˜ã€‚è¿™é‡Œçš„<br>$$<br>\sqrt{dk}<br>$$<br> æ˜¯æŸ¥è¯¢ï¼ˆqueriesï¼‰ã€é”®ï¼ˆkeysï¼‰å‘é‡çš„ç»´åº¦ã€‚</p><p>å½“æˆ‘ä»¬è®¡ç®—ä¸¤ä¸ªå‘é‡çš„ç‚¹ç§¯æ—¶ï¼Œå¦‚æœå‘é‡çš„ç»´åº¦<br>$$<br>\sqrt{dk}<br>$$<br>è¾ƒå¤§ï¼Œé‚£ä¹ˆç‚¹ç§¯çš„ç»“æœå¯èƒ½ä¼šå˜å¾—éå¸¸å¤§ã€‚ç”±äº softmax å‡½æ•°çš„è¾“å…¥å€¼å¦‚æœè¿‡å¤§ï¼Œä¼šå¯¼è‡´è¾“å‡ºå€¼æ¥è¿‘äº 0 æˆ– 1ï¼Œè¿™ä¼šä½¿å¾—æ¢¯åº¦éå¸¸å°ï¼Œä»è€Œåœ¨åå‘ä¼ æ’­è¿‡ç¨‹ä¸­éš¾ä»¥æœ‰æ•ˆåœ°æ›´æ–°æƒé‡ã€‚é€šè¿‡é™¤ä»¥<br>$$<br> \sqrt{dk}<br>$$<br>ï¼Œæˆ‘ä»¬å¯ä»¥å°†ç‚¹ç§¯çš„ç»“æœç¼©æ”¾åˆ°ä¸€ä¸ªæ›´åˆç†çš„èŒƒå›´å†…ï¼Œè¿™æ · softmax å‡½æ•°çš„è¾“å‡ºåˆ†å¸ƒä¼šæ›´åŠ å¹³æ»‘ï¼Œæ¢¯åº¦ä¹Ÿä¼šæ›´åŠ ç¨³å®šã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œç¼©æ”¾ç‚¹ç§¯æ³¨æ„åŠ›çš„è®¡ç®—æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>è®¡ç®—æŸ¥è¯¢ Q<em>Q</em> å’Œæ‰€æœ‰é”® K<em>K</em> ä¹‹é—´çš„ç‚¹ç§¯ã€‚</p></li><li><p>å°†ç‚¹ç§¯ç»“æœé™¤ä»¥<br>$$<br>\sqrt{dk}<br>$$<br>ï¼Œè¿™æ ·åšå¯ä»¥é˜²æ­¢ç‚¹ç§¯ç»“æœè¿‡å¤§ã€‚</p></li><li><p>åº”ç”¨ softmax å‡½æ•°æ¥è·å–æ³¨æ„åŠ›æƒé‡ï¼Œè¿™äº›æƒé‡è¡¨ç¤ºæ¯ä¸ªå€¼ Våœ¨è®¡ç®—åŠ æƒå’Œæ—¶çš„é‡è¦æ€§ã€‚</p></li><li><p>ä½¿ç”¨æ³¨æ„åŠ›æƒé‡å¯¹å€¼ Vè¿›è¡ŒåŠ æƒæ±‚å’Œï¼Œå¾—åˆ°æœ€ç»ˆçš„æ³¨æ„åŠ›è¾“å‡ºã€‚</p></li></ol><p>æ•°å­¦ä¸Šï¼ŒScaled dot-product attention å¯ä»¥è¡¨ç¤ºä¸ºï¼š<br>$$<br>Attention(Q,K,V)&#x3D;softmax(QK^T&#x2F;\sqrt{dk})V<br>$$<br>å…¶ä¸­ Qæ˜¯æŸ¥è¯¢çŸ©é˜µï¼ŒK æ˜¯é”®çŸ©é˜µï¼ŒVæ˜¯å€¼çŸ©é˜µï¼Œ<br>$$<br>\sqrt{dk}<br>$$<br>æ˜¯ç¼©æ”¾å› å­ã€‚</p><p>è¿™ç§ç¼©æ”¾æ“ä½œæ˜¯ Transformer æ¨¡å‹ä¸­çš„ä¸€ä¸ªå…³é”®è®¾è®¡ï¼Œå®ƒæœ‰åŠ©äºæ¨¡å‹åœ¨å¤„ç†é•¿åºåˆ—æ—¶ä¿æŒç¨³å®šæ€§ï¼Œå¹¶ä¸”ä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæ›´æœ‰æ•ˆåœ°å­¦ä¹ åºåˆ—ä¸­çš„é•¿è·ç¦»ä¾èµ–å…³ç³»ã€‚</p><h4 id="æ©ç æœºåˆ¶"><a href="#æ©ç æœºåˆ¶" class="headerlink" title="æ©ç æœºåˆ¶"></a>æ©ç æœºåˆ¶</h4><p>æ©ç æœºåˆ¶ï¼š</p><p><img src="https://s2.loli.net/2024/09/09/FYbUzcojJktZCqh.png" alt="image-20240909221704256.png"></p><p>åœ¨ Transformer æ¨¡å‹ä¸­ï¼Œæ©ç æœºåˆ¶ï¼ˆMasking Mechanismï¼‰çš„ä½œç”¨ä¸»è¦æ˜¯åœ¨è§£ç å™¨ï¼ˆDecoderï¼‰çš„è‡ªæ³¨æ„åŠ›å±‚ä¸­é˜²æ­¢æœªæ¥ä¿¡æ¯çš„æ³„éœ²ï¼Œç¡®ä¿æ¨¡å‹åœ¨ç”Ÿæˆå½“å‰è¾“å‡ºæ—¶åªèƒ½ä½¿ç”¨ä¹‹å‰çš„æ—¶é—´æ­¥ä¿¡æ¯ã€‚è¿™ç§æœºåˆ¶å¯¹äºä¿è¯åºåˆ—ç”Ÿæˆä»»åŠ¡çš„æ­£ç¡®æ€§å’Œå› æœå…³ç³»è‡³å…³é‡è¦ã€‚ä»¥ä¸‹æ˜¯æ©ç æœºåˆ¶çš„å‡ ä¸ªä¸»è¦ä½œç”¨ï¼š</p><ol><li><strong>å› æœå…³ç³»ç»´æŠ¤</strong>ï¼šåœ¨åºåˆ—ç”Ÿæˆä»»åŠ¡ä¸­ï¼Œå¦‚è¯­è¨€æ¨¡å‹æˆ–æœºå™¨ç¿»è¯‘ï¼Œæ¯ä¸ªè¾“å‡ºåº”è¯¥æ˜¯åŸºäºä¹‹å‰è¾“å‡ºçš„å› æœåºåˆ—ã€‚æ©ç æœºåˆ¶ç¡®ä¿è§£ç å™¨åœ¨ç”Ÿæˆå½“å‰è¯æ—¶ï¼Œä¸ä¼šåˆ©ç”¨åˆ°æœªæ¥è¯çš„ä¿¡æ¯ï¼Œä»è€Œç»´æŠ¤äº†åºåˆ—çš„å› æœæ€§ã€‚</li><li><strong>è®­ç»ƒç¨³å®šæ€§</strong>ï¼šé€šè¿‡é™åˆ¶è‡ªæ³¨æ„åŠ›å±‚çš„è®¡ç®—èŒƒå›´ï¼Œæ©ç æœºåˆ¶å¯ä»¥é˜²æ­¢åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯çš„ä¿¡æ¯æµï¼Œè¿™æœ‰åŠ©äºæé«˜æ¨¡å‹è®­ç»ƒçš„ç¨³å®šæ€§å’Œæ•ˆç‡ã€‚</li><li><strong>å¹¶è¡Œè§£ç </strong>ï¼šåœ¨è§£ç è¿‡ç¨‹ä¸­ï¼Œæ©ç æœºåˆ¶å…è®¸æ¨¡å‹å¹¶è¡Œç”Ÿæˆæ•´ä¸ªåºåˆ—ï¼Œå› ä¸ºæ¯ä¸ªè¾“å‡ºè¯çš„ç”Ÿæˆåªä¾èµ–äºå®ƒä¹‹å‰çš„è¯ï¼Œè€Œä¸æ˜¯æ•´ä¸ªåºåˆ—ã€‚è¿™å¤§å¤§æé«˜äº†è§£ç é€Ÿåº¦ã€‚</li><li><strong>é¿å…æ— æ•ˆè®¡ç®—</strong>ï¼šåœ¨è‡ªæ³¨æ„åŠ›è®¡ç®—ä¸­ï¼Œæ©ç æœºåˆ¶é€šè¿‡å¿½ç•¥æ— å…³çš„ä½ç½®ï¼ˆä¾‹å¦‚å¡«å……ä½ç½®æˆ–æœªæ¥çš„è¯ï¼‰ï¼Œå‡å°‘äº†ä¸å¿…è¦çš„è®¡ç®—ï¼Œä»è€Œæé«˜äº†è®¡ç®—æ•ˆç‡ã€‚</li><li><strong>å¤„ç†å˜é•¿åºåˆ—</strong>ï¼šåœ¨å¤„ç†ä¸åŒé•¿åº¦çš„åºåˆ—æ—¶ï¼Œæ©ç æœºåˆ¶å¯ä»¥åŠ¨æ€åœ°é€‚åº”åºåˆ—çš„å®é™…é•¿åº¦ï¼Œå¿½ç•¥å¡«å……éƒ¨åˆ†ï¼Œç¡®ä¿æ¨¡å‹åªå…³æ³¨æœ‰æ•ˆçš„åºåˆ—éƒ¨åˆ†ã€‚</li></ol><p>åœ¨ Transformer æ¨¡å‹çš„è§£ç å™¨ä¸­ï¼Œé€šå¸¸ä½¿ç”¨ä¸¤ç§ç±»å‹çš„æ©ç ï¼š</p><ul><li><strong>å› æœæ©ç ï¼ˆCausal Maskï¼‰</strong>ï¼šè¿™ç§æ©ç ç¡®ä¿åœ¨ç”Ÿæˆåºåˆ—çš„æ¯ä¸ªæ—¶é—´æ­¥æ—¶ï¼Œæ¨¡å‹åªèƒ½çœ‹åˆ°å½“å‰å’Œä¹‹å‰çš„è¯ï¼Œè€Œä¸èƒ½â€œçœ‹åˆ°â€æœªæ¥çš„è¯ã€‚è¿™é€šå¸¸é€šè¿‡ä¸€ä¸ªä¸Šä¸‰è§’çŸ©é˜µå®ç°ï¼Œå…¶ä¸­æœªæ¥ä½ç½®çš„æƒé‡è¢«è®¾ç½®ä¸ºä¸€ä¸ªéå¸¸å¤§çš„è´Ÿæ•°ï¼ˆä¾‹å¦‚è´Ÿæ— ç©·å¤§ï¼‰ï¼Œ<strong>ä½¿å¾—åœ¨åº”ç”¨ softmax å‡½æ•°æ—¶ï¼Œè¿™äº›ä½ç½®çš„æ³¨æ„åŠ›æƒé‡æ¥è¿‘äºé›¶</strong>ã€‚</li><li><strong>å¡«å……æ©ç ï¼ˆPadding Maskï¼‰</strong>ï¼šåœ¨å¤„ç†åŒ…å«ä¸åŒé•¿åº¦åºåˆ—çš„æ‰¹æ¬¡æ—¶ï¼Œé€šå¸¸ä¼šä½¿ç”¨<strong>å¡«å……ï¼ˆPaddingï¼‰æ¥å¯¹é½åºåˆ—é•¿åº¦</strong>ã€‚å¡«å……æ©ç ç”¨äºå‘Šè¯‰æ¨¡å‹å¿½ç•¥è¿™äº›å¡«å……çš„ä½ç½®ï¼Œå› ä¸ºå®ƒä»¬ä¸åŒ…å«æœ‰æ•ˆä¿¡æ¯ã€‚</li></ul><p>ä¾‹å¦‚ï¼Œåœ¨æœºå™¨ç¿»è¯‘ä»»åŠ¡ä¸­ï¼Œå½“æ¨¡å‹æ­£åœ¨ç”Ÿæˆè‹±æ–‡ç¿»è¯‘çš„ç¬¬ i ä¸ªè¯æ—¶ï¼Œå®ƒåªèƒ½ä½¿ç”¨åˆ°å·²ç»ç¿»è¯‘å¥½çš„å‰ i-1 ä¸ªè¯ï¼Œè€Œä¸èƒ½ä½¿ç”¨ç¬¬ i ä¸ªè¯ä¹‹åçš„ä¿¡æ¯ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿ç¿»è¯‘çš„è¿è´¯æ€§å’Œæ­£ç¡®æ€§ï¼Œå› ä¸ºç¿»è¯‘çš„æ¯ä¸ªæ­¥éª¤éƒ½æ˜¯åŸºäºå½“å‰å¯ç”¨çš„æœ€å®Œæ•´çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</p><h4 id="å¤šå¤´æ³¨æ„åŠ›"><a href="#å¤šå¤´æ³¨æ„åŠ›" class="headerlink" title="å¤šå¤´æ³¨æ„åŠ›"></a>å¤šå¤´æ³¨æ„åŠ›</h4><p><img src="https://s2.loli.net/2024/09/09/cUkOgSZYiDBRw2r.png" alt="image-20240909222828981.png"></p><p>å…¶å®åœ¨Scaled Dot-Product Attentionä¸­æ²¡æœ‰ä»€ä¹ˆè¦å»å­¦çš„å‚æ•°ï¼Œè¿™é‡Œç›´æ¥QKVçº¿æ€§å˜åŒ–ä½ç»´æŠ•å½±ï¼Œç„¶åé‡å¤hæ¬¡æœ€åconcatå†åšä¸€æ¬¡çº¿æ€§æŠ•å½±ã€‚</p><p>åœ¨ Transformer æ¨¡å‹ä¸­çš„å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶ï¼ˆMulti-Head Attentionï¼‰ä¸­ï¼Œè¿›è¡Œçº¿æ€§å˜æ¢ï¼ˆLinear Transformationï¼‰å’Œæ‹¼æ¥ï¼ˆConcatenationï¼‰çš„æ­¥éª¤æ˜¯ä¸ºäº†å¢åŠ æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›ï¼Œå…è®¸å®ƒåœ¨ä¸åŒçš„è¡¨ç¤ºå­ç©ºé—´ä¸­å¹¶è¡Œåœ°å­¦ä¹ ä¿¡æ¯ã€‚ä»¥ä¸‹æ˜¯è¿™äº›æ­¥éª¤çš„å…·ä½“ä½œç”¨å’ŒåŸå› ï¼š</p><ol><li><p><strong>çº¿æ€§å˜æ¢</strong>ï¼š</p><ul><li><strong>å¢åŠ éçº¿æ€§</strong>ï¼šé€šè¿‡çº¿æ€§å˜æ¢ï¼Œæ¨¡å‹å¯ä»¥å­¦ä¹ åˆ°è¾“å…¥æ•°æ®çš„ä¸åŒçº¿æ€§ç»„åˆï¼Œè¿™æœ‰åŠ©äºå¼•å…¥éçº¿æ€§ç‰¹æ€§ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæ•æ‰æ›´å¤æ‚çš„ç‰¹å¾å’Œæ¨¡å¼ã€‚</li><li><strong>ç‰¹å¾æå–</strong>ï¼šæ¯ä¸ªâ€œå¤´â€ï¼ˆHeadï¼‰ä¸­çš„çº¿æ€§å˜æ¢å¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§ç‰¹å¾æå–è¿‡ç¨‹ï¼Œå®ƒå…è®¸æ¨¡å‹åœ¨ä¸åŒçš„è¡¨ç¤ºå­ç©ºé—´ä¸­æ•æ‰ä¸åŒçš„ä¿¡æ¯ã€‚</li><li><strong>å‡å°‘ç»´åº¦</strong>ï¼šåœ¨æ‹¼æ¥ä¹‹å‰ï¼Œé€šå¸¸éœ€è¦å¯¹æ¯ä¸ªå¤´çš„è¾“å‡ºè¿›è¡Œçº¿æ€§å˜æ¢ï¼Œä»¥å‡å°‘ç»´åº¦ï¼Œä½¿å¾—ä¸åŒå¤´çš„è¾“å‡ºå¯ä»¥è¢«æ‹¼æ¥åœ¨ä¸€èµ·è€Œä¸ä¼šè¶…è¿‡åŸå§‹çš„ç»´åº¦é™åˆ¶ã€‚</li></ul></li><li><p><strong>æ‹¼æ¥</strong>ï¼š</p><ul><li><strong>æ•´åˆä¿¡æ¯</strong>ï¼šæ‹¼æ¥æ“ä½œå°†å¤šä¸ªå¤´çš„è¾“å‡ºåˆå¹¶æˆä¸€ä¸ªå•ä¸€çš„è¡¨ç¤ºï¼Œè¿™æ ·æ¨¡å‹å°±å¯ä»¥åŒæ—¶è€ƒè™‘åˆ°æ‰€æœ‰å¤´å­¦ä¹ åˆ°çš„ä¿¡æ¯ã€‚</li><li><strong>å¢åŠ å®½åº¦</strong>ï¼šæ‹¼æ¥å¢åŠ äº†æ¨¡å‹çš„å®½åº¦ï¼Œç±»ä¼¼äºåœ¨å·ç§¯ç¥ç»ç½‘ç»œä¸­å¢åŠ æ»¤æ³¢å™¨çš„æ•°é‡ï¼Œè¿™æœ‰åŠ©äºæé«˜æ¨¡å‹çš„å®¹é‡å’Œå­¦ä¹ èƒ½åŠ›ã€‚</li><li><strong>ä¿ç•™å¤šæ ·æ€§</strong>ï¼šæ¯ä¸ªå¤´å¯ä»¥å­¦ä¹ åˆ°ä¸åŒçš„ç‰¹å¾ï¼Œæ‹¼æ¥è¿™äº›ç‰¹å¾å¯ä»¥ä¿ç•™è¿™ç§å¤šæ ·æ€§ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿä»å¤šä¸ªè§’åº¦ç†è§£æ•°æ®ã€‚</li></ul></li><li><p><strong>å¤šå¤´æ³¨æ„åŠ›çš„ä¼˜åŠ¿</strong>ï¼š</p><ul><li><strong>å¹¶è¡Œå¤„ç†</strong>ï¼šå¤šå¤´æ³¨æ„åŠ›å…è®¸æ¨¡å‹å¹¶è¡Œåœ°åœ¨ä¸åŒçš„å­ç©ºé—´ä¸­å­¦ä¹ ä¿¡æ¯ï¼Œè¿™æé«˜äº†è®¡ç®—æ•ˆç‡ã€‚</li><li><strong>æ•æ‰ä¸åŒå°ºåº¦çš„ç‰¹å¾</strong>ï¼šä¸åŒçš„å¤´å¯ä»¥æ•æ‰åˆ°ä¸åŒå°ºåº¦çš„ç‰¹å¾ï¼Œä¾‹å¦‚ï¼Œä¸€äº›å¤´å¯èƒ½å…³æ³¨å±€éƒ¨ç»†èŠ‚ï¼Œè€Œå¦ä¸€äº›å¤´å¯èƒ½å…³æ³¨æ›´å¹¿æ³›çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚</li><li><strong>æé«˜é²æ£’æ€§</strong>ï¼šå¤šå¤´æœºåˆ¶å¢åŠ äº†æ¨¡å‹çš„é²æ£’æ€§ï¼Œå³ä½¿æŸäº›å¤´æ²¡æœ‰å­¦ä¹ åˆ°æœ‰ç”¨çš„ç‰¹å¾ï¼Œå…¶ä»–å¤´ä»ç„¶å¯ä»¥æä¾›æœ‰ç”¨çš„ä¿¡æ¯ã€‚</li></ul></li></ol><p>åœ¨å®é™…æ“ä½œä¸­ï¼Œå¤šå¤´æ³¨æ„åŠ›çš„è®¡ç®—è¿‡ç¨‹é€šå¸¸å¦‚ä¸‹ï¼š</p><ol><li>å°†è¾“å…¥ ( X ) é€šè¿‡ä¸‰ä¸ªä¸åŒçš„çº¿æ€§å˜æ¢å¾—åˆ°æŸ¥è¯¢ ( Q )ã€é”® ( K ) å’Œå€¼ ( V )ã€‚</li><li>å°† ( Q )ã€( K ) å’Œ ( V ) åˆ†åˆ«åˆ†å‰²æˆå¤šä¸ªå¤´ï¼Œæ¯ä¸ªå¤´å¯¹åº”ä¸€ä¸ªå­ç©ºé—´ã€‚</li><li>å¯¹æ¯ä¸ªå¤´ï¼Œè®¡ç®— ( Q ) å’Œ ( K ) çš„ç‚¹ç§¯æ³¨æ„åŠ›ï¼Œç„¶ååº”ç”¨ softmax å‡½æ•°å¾—åˆ°æ³¨æ„åŠ›æƒé‡ï¼Œæœ€åç”¨è¿™äº›æƒé‡å¯¹ ( V ) è¿›è¡ŒåŠ æƒæ±‚å’Œã€‚</li><li>å°†æ‰€æœ‰å¤´çš„è¾“å‡ºæ‹¼æ¥åœ¨ä¸€èµ·ï¼Œå¹¶é€šè¿‡å¦ä¸€ä¸ªçº¿æ€§å˜æ¢æ¥æ•´åˆä¿¡æ¯ï¼Œå¾—åˆ°æœ€ç»ˆçš„å¤šå¤´æ³¨æ„åŠ›è¾“å‡ºã€‚</li></ol><p>è¿™ç§è®¾è®¡ä½¿å¾— Transformer æ¨¡å‹åœ¨å¤„ç†åºåˆ—æ•°æ®æ—¶éå¸¸æœ‰æ•ˆï¼Œå°¤å…¶æ˜¯åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ä¸­ã€‚</p><p><img src="https://s2.loli.net/2024/09/09/X9HYDxWQgil2aOM.png" alt="image-20240909223600900.png"></p><p><a href="https://blog.csdn.net/WhiffeYF/article/details/140336134?ops_request_misc=&request_id=&biz_id=102&utm_term=%E5%A4%9A%E5%A4%B4%E6%B3%A8%E6%84%8F%E5%8A%9B%E7%9A%84%E5%85%AC%E5%BC%8F%E8%A7%A3%E8%AF%BB&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-140336134.142%5Ev100%5Epc_search_result_base8&spm=1018.2226.3001.4187">å¤šå¤´æ³¨æ„åŠ›çš„å…¬å¼ç†è§£_multihead attentionå…¬å¼-CSDNåšå®¢</a></p><h4 id="Application-of-Attention-in-Our-Model"><a href="#Application-of-Attention-in-Our-Model" class="headerlink" title="Application of Attention in Our Model"></a>Application of Attention in Our Model</h4><p>Transformerä¸­çš„ä¸‰ä¸ªattentionæ˜¯åœ¨å¹²ä»€ä¹ˆäº‹æƒ…ï¼Ÿ</p><p><img src="https://s2.loli.net/2024/09/09/hAuO47UifTsYnyM.png" alt="image-20240909230308576.png"></p><p>åœ¨Transformeræ¶æ„ä¸­ï¼Œæœ‰3ç§ä¸åŒçš„æ³¨æ„åŠ›å±‚ï¼š</p><ul><li><p>è§£ç å™¨ä¸­çš„äº¤å‰æ³¨æ„åŠ›å±‚ï¼ˆCross attention layerï¼‰ï¼ˆå³ä¸Šè§’ï¼‰</p><ul><li><p>åœ¨ Transformer ä¸­ï¼Œäº¤å‰æ³¨æ„åŠ›å±‚ä½äºå­—é¢ä¸Šçš„ä¸­å¿ƒä½ç½®ï¼›å®ƒè¿æ¥äº†ç¼–ç å™¨å’Œè§£ç å™¨ï¼Œæ˜¯åœ¨æ¨¡å‹ä¸­ä½¿ç”¨æ³¨æ„åŠ›æœ€ç›´æ¥çš„æ–¹å¼ã€‚</p><p>è¦å®ç°è¿™ä¸€ç‚¹ï¼Œéœ€è¦å°†ç›®æ ‡åºåˆ—ä½œä¸ºæŸ¥è¯¢ï¼Œå°†ä¸Šä¸‹æ–‡åºåˆ—ä½œä¸ºé”®&#x2F;å€¼ä¼ é€’ã€‚</p><ul><li>Q &#x3D; è§£ç å™¨ä¸­å› æœæ³¨æ„åŠ›å±‚çš„è¾“å‡ºå‘é‡</li><li>K &#x3D; ç¼–ç å™¨è¾“å‡ºçš„æ³¨æ„åŠ›å‘é‡</li><li>V &#x3D; ç¼–ç å™¨è¾“å‡ºçš„æ³¨æ„åŠ›å‘é‡</li></ul></li></ul></li><li><p>ç¼–ç å™¨ä¸­çš„å…¨å±€è‡ªæ³¨æ„åŠ›å±‚ï¼ˆGlobal self attention layerï¼‰ï¼ˆå·¦ä¸‹è§’ï¼‰</p><ul><li><p>å…¨å±€è‡ªæ³¨æ„åŠ›æ˜¯Transformerç¼–ç å™¨çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒçš„ä½œç”¨æ˜¯è´Ÿè´£å¤„ç†æ•´ä¸ªè¾“å…¥åºåˆ—ã€‚</p><p>å®ƒå…è®¸æ¯ä¸ªåºåˆ—å…ƒç´ ç›´æ¥è®¿é—®å…¶ä»–æ‰€æœ‰åºåˆ—å…ƒç´ ï¼Œåªéœ€å°†æ•´ä¸ªåºåˆ—ä½œä¸ºQï¼ŒKï¼ŒVå³å¯ï¼Œæ‰€æœ‰è¾“å‡ºå¯ä»¥å¹¶è¡Œè®¡ç®—ã€‚</p><ul><li><p>Q &#x3D; è¾“å…¥åºåˆ—ä¸­çš„å½“å‰ä½ç½®è¯å‘é‡</p></li><li><p>K &#x3D; è¾“å…¥åºåˆ—ä¸­çš„æ‰€æœ‰ä½ç½®è¯å‘é‡</p></li><li><p>V &#x3D; è¾“å…¥åºåˆ—ä¸­çš„æ‰€æœ‰ä½ç½®è¯å‘é‡</p></li></ul></li></ul></li><li><p>è§£ç å™¨ä¸­çš„å› æœè‡ªæ³¨æ„åŠ›å±‚ï¼ˆCasual attention layerï¼‰ï¼ˆå³ä¸‹è§’ï¼‰</p><ul><li><p>å› æœæ³¨æ„åŠ›å±‚å¯¹è§£ç å™¨ä¸­è¾“å‡ºåºåˆ—æ‰§è¡Œç±»ä¼¼äºå…¨å±€è‡ªæ³¨æ„åŠ›å±‚çš„å·¥ä½œï¼›ä½†ä¸ç¼–ç å™¨çš„å…¨å±€è‡ªæ³¨æ„åŠ›å±‚æœ‰ä¸åŒçš„å¤„ç†æ–¹å¼ã€‚</p><p>Transformeræ˜¯ä¸€ä¸ªâ€œè‡ªå›å½’â€æ¨¡å‹ï¼Œå®ƒé€ä¸ªæ ‡è®°åœ°ç”Ÿæˆæ–‡æœ¬ï¼Œå¹¶å°†è¾“å‡ºåé¦ˆåˆ°è¾“å…¥ä¸­ï¼›ä¸ºäº†ä½¿è¿™ä¸ªè¿‡ç¨‹é«˜æ•ˆï¼Œè¿™äº›æ¨¡å‹ç¡®ä¿æ¯ä¸ªåºåˆ—å…ƒç´ çš„è¾“å‡ºåªä¾èµ–äºå‰é¢çš„åºåˆ—å…ƒç´ ï¼›è¿™äº›æ¨¡å‹æ˜¯â€œå› æœâ€çš„ã€‚</p><p>è¦æ„å»ºä¸€ä¸ªå› æœè‡ªæ³¨æ„åŠ›å±‚ï¼Œåœ¨è®¡ç®—æ³¨æ„åŠ›åˆ†æ•°å’Œæ±‚å’Œæ³¨æ„åŠ›å€¼æ—¶éœ€è¦ä½¿ç”¨é€‚å½“çš„æ©ç ï¼Œå› ä¸ºè¾“å‡ºåºåˆ—ä¹Ÿæ˜¯ä¸€æ¬¡æ€§è¾“å…¥çš„ï¼Œä½†åœ¨è®¡ç®—å‰é¢åˆ†è¯çš„æ—¶å€™æ˜¯ä¸å¸Œæœ›å®ƒåé¢çš„åˆ†è¯ä¹Ÿå‚ä¸è®¡ç®—çš„ã€‚</p></li></ul></li></ul><h3 id="Position-wise-Feed-Forward-Networks"><a href="#Position-wise-Feed-Forward-Networks" class="headerlink" title="Position-wise Feed-Forward Networks"></a>Position-wise Feed-Forward Networks</h3><p><img src="C:\Users\11505\AppData\Roaming\Typora\typora-user-images\image-20240910082508849.png" alt="image-20240910082508849"><br>$$<br>\text{FFN}(x) &#x3D; \max(0, xW_1 + b_1)W_2 + b_2<br>$$<br>ä¸€ä¸ªå•éšè—å±‚çš„MLPï¼Œåšè¯­ä¹‰çš„è½¬æ¢ã€‚</p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼š</p><ul><li>æœ€ä¸‹é¢è“è‰²çš„æ˜¯è¾“å…¥ï¼Œä¸Šé¢çº¢è‰²çš„é•¿å—å°±æ˜¯æ³¨æ„åŠ›</li><li>æ³¨æ„åŠ›èƒ½å¤Ÿæå–åˆ°æœ‰ç”¨çš„åºåˆ—ä¿¡æ¯</li><li>è¿™äº›æœ‰ç”¨çš„ä¿¡æ¯å†ç»è¿‡ä¸€æ¬¡MLP</li></ul><p>åœ¨Transformeræ¨¡å‹ä¸­ï¼ŒPosition-wise Feed-Forward Networkï¼ˆFFNï¼‰æ˜¯ç¼–ç å™¨å’Œè§£ç å™¨å†…éƒ¨çš„ä¸€ä¸ªå…³é”®ç»„ä»¶ã€‚å®ƒçš„ä½œç”¨ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p><ol><li><p><strong>å¢åŠ æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›</strong>ï¼šFFNé€šè¿‡å¼•å…¥éçº¿æ€§å˜æ¢ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿæ•æ‰åˆ°è¾“å…¥æ•°æ®ä¸­æ›´å¤æ‚çš„ç‰¹å¾å’Œæ¨¡å¼ã€‚è¿™å¯¹äºå¤„ç†åºåˆ—æ•°æ®å°¤å…¶é‡è¦ï¼Œå› ä¸ºåºåˆ—æ•°æ®å¾€å¾€åŒ…å«ä¸°å¯Œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯å’Œå¤æ‚çš„ä¾èµ–å…³ç³»ã€‚</p></li><li><p><strong>å‚æ•°æ•ˆç‡</strong>ï¼šå°½ç®¡Transformeræ¨¡å‹çš„è‡ªæ³¨æ„åŠ›æœºåˆ¶èƒ½å¤Ÿå¤„ç†é•¿è·ç¦»ä¾èµ–ï¼Œä½†å®ƒçš„å‚æ•°æ•°é‡éšç€è¾“å…¥åºåˆ—é•¿åº¦çš„å¢åŠ è€Œçº¿æ€§å¢é•¿ã€‚FFNé€šè¿‡åœ¨æ¯ä¸ªä½ç½®ç‹¬ç«‹åœ°åº”ç”¨ç›¸åŒçš„æƒé‡ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿåœ¨ä¿æŒå‚æ•°æ•°é‡ç›¸å¯¹å›ºå®šçš„åŒæ—¶ï¼Œå¤„ç†ä¸åŒé•¿åº¦çš„è¾“å…¥åºåˆ—ã€‚</p></li><li><p><strong>ä½ç½®ä¸å˜æ€§</strong>ï¼šFFNçš„è®¾è®¡ä½¿å¾—å®ƒå¯¹è¾“å…¥åºåˆ—ä¸­çš„ä½ç½®ä¿¡æ¯ä¸æ•æ„Ÿï¼Œè¿™æœ‰åŠ©äºæ¨¡å‹æ›´å¥½åœ°æ³›åŒ–åˆ°ä¸åŒçš„è¾“å…¥åºåˆ—ã€‚åœ¨è‡ªæ³¨æ„åŠ›æœºåˆ¶ä¸­ï¼Œä½ç½®ä¿¡æ¯æ˜¯é€šè¿‡ä½ç½®ç¼–ç ï¼ˆPositional Encodingï¼‰æ¥å¼•å…¥çš„ï¼Œè€ŒFFNåˆ™ä¸“æ³¨äºå¤„ç†åºåˆ—ä¸­çš„å±€éƒ¨ç‰¹å¾ã€‚</p></li><li><p><strong>å¹¶è¡ŒåŒ–å¤„ç†</strong>ï¼šç”±äºFFNåœ¨æ¯ä¸ªä½ç½®ç‹¬ç«‹åœ°åº”ç”¨ç›¸åŒçš„æƒé‡ï¼Œè¿™ä½¿å¾—å®ƒå¯ä»¥å¾ˆå®¹æ˜“åœ°åœ¨ä¸åŒçš„ä½ç½®ä¸Šå¹¶è¡Œå¤„ç†ï¼Œä»è€Œæé«˜æ¨¡å‹çš„è®­ç»ƒæ•ˆç‡ã€‚</p></li><li><p><strong>å‡å°‘è¿‡æ‹Ÿåˆ</strong>ï¼šFFNé€šè¿‡å¼•å…¥é¢å¤–çš„å‚æ•°å’Œéçº¿æ€§å˜æ¢ï¼Œå¢åŠ äº†æ¨¡å‹çš„å¤æ‚åº¦ï¼Œè¿™æœ‰åŠ©äºæ¨¡å‹åœ¨é¢å¯¹å¤æ‚æ•°æ®æ—¶å‡å°‘è¿‡æ‹Ÿåˆçš„é£é™©ã€‚</p></li></ol><p>FFNé€šå¸¸ç”±ä¸¤ä¸ªçº¿æ€§å˜æ¢å’Œä¸€ä¸ªéçº¿æ€§æ¿€æ´»å‡½æ•°ï¼ˆå¦‚ReLUï¼‰ç»„æˆï¼Œå…¶ç»“æ„å¯ä»¥è¡¨ç¤ºä¸ºï¼š<br>$$<br>\text{FFN}(x) &#x3D; \max(0, xW_1 + b_1)W_2 + b_2<br>$$<br>å…¶ä¸­ï¼Œ( x ) æ˜¯è¾“å…¥å‘é‡ï¼Œ( W_1 ) å’Œ ( W_2 ) æ˜¯æƒé‡çŸ©é˜µï¼Œ( b_1 ) å’Œ ( b_2 ) æ˜¯åç½®å‘é‡ã€‚</p><p>FFNçš„ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š</p><ol><li><strong>ç¬¬ä¸€ä¸ªçº¿æ€§å˜æ¢</strong>ï¼šè¾“å…¥æ•°æ®é¦–å…ˆé€šè¿‡ä¸€ä¸ªçº¿æ€§å˜æ¢ï¼Œè¿™ä¸ªå˜æ¢ç”±æƒé‡çŸ©é˜µ <em>W</em>1 å’Œåç½®å‘é‡ <em>b</em>1 ç»„æˆã€‚</li><li><strong>ReLUæ¿€æ´»å‡½æ•°</strong>ï¼šç»è¿‡ç¬¬ä¸€ä¸ªçº¿æ€§å˜æ¢åï¼Œæ•°æ®ä¼šé€šè¿‡ReLUæ¿€æ´»å‡½æ•°ï¼ŒReLUå‡½æ•°çš„å…¬å¼æ˜¯ maxâ¡(0,x)max(0,<em>x</em>)ï¼Œå®ƒå°†æ‰€æœ‰è´Ÿå€¼ç½®ä¸º0ï¼Œä¿ç•™æ‰€æœ‰æ­£å€¼ã€‚è¿™ä¸€æ­¥çš„ç›®çš„æ˜¯å¢åŠ æ¨¡å‹çš„éçº¿æ€§ï¼Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿå­¦ä¹ åˆ°æ›´å¤æ‚çš„å‡½æ•°ã€‚</li><li><strong>ç¬¬äºŒä¸ªçº¿æ€§å˜æ¢</strong>ï¼šç»è¿‡ReLUæ¿€æ´»åçš„æ•°æ®å†é€šè¿‡å¦ä¸€ä¸ªçº¿æ€§å˜æ¢ï¼Œè¿™ä¸ªå˜æ¢ç”±æƒé‡çŸ©é˜µ <em>W</em>2 å’Œåç½®å‘é‡ <em>b</em>2 ç»„æˆã€‚</li></ol><p>åœ¨Transformeræ¨¡å‹ä¸­ï¼ŒFFNé€šå¸¸åœ¨è‡ªæ³¨æ„åŠ›å±‚ä¹‹ååº”ç”¨ï¼Œå®ƒçš„ä½œç”¨æ˜¯å¯¹è‡ªæ³¨æ„åŠ›å±‚çš„è¾“å‡ºè¿›è¡Œè¿›ä¸€æ­¥çš„å˜æ¢å’Œç‰¹å¾æå–ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒFFNä¸è‡ªæ³¨æ„åŠ›æœºåˆ¶ååŒå·¥ä½œï¼Œå…±åŒæé«˜äº†æ¨¡å‹çš„æ€§èƒ½å’Œæ³›åŒ–èƒ½åŠ›ã€‚</p><p>RNNï¼š</p><p><img src="https://s2.loli.net/2024/09/10/TdGkIrPghzVW4vL.png" alt="image-20240910092953130.png"></p><p><a href="https://blog.csdn.net/v_JULY_v/article/details/89894058?ops_request_misc=%7B%22request_id%22:%22BA7B6A11-87B4-438A-9CEE-4ECB7E7E651A%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=BA7B6A11-87B4-438A-9CEE-4ECB7E7E651A&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-89894058-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=RNN&spm=1018.2226.3001.4187">å¦‚ä½•ä»RNNèµ·æ­¥ï¼Œä¸€æ­¥ä¸€æ­¥é€šä¿—ç†è§£LSTM_rnn lstm-CSDNåšå®¢</a></p><h3 id="Embeddings-and-Softmax"><a href="#Embeddings-and-Softmax" class="headerlink" title="Embeddings and Softmax"></a>Embeddings and Softmax</h3><p><img src="https://s2.loli.net/2024/09/10/q9WzusRYHvoL1kO.png" alt="image-20240910094410891.png"></p><p>åœ¨RNNä¸­ï¼Œè‡ªç„¶æ˜¯åŒ…å«æ—¶åºä¿¡æ¯çš„ï¼šå°†ä¹‹å‰çš„è¾“å‡ºè‡ªç„¶çš„ä½œä¸ºè¾“å‡ºã€‚</p><p>ä½†æ³¨æ„åŠ›æœºåˆ¶è€Œè¨€ï¼Œå¦‚æœå°†ä¸€ä¸ªå¥å­é¡ºåºæ‰“ä¹±ï¼Œå…¶å¾—åˆ°çš„æƒé‡æ˜¯ä¸å˜çš„-&gt;è¿™æ˜¾ç„¶æ˜¯ä¸ç¬¦åˆå¸¸ç†çš„ï¼Œå› ä¸ºæ‰“ä¹±é¡ºåºå°±æ„å‘³ç€è¯­ä¹‰å˜åŒ–ã€‚ä¸ºäº†å¼¥è¡¥è¿™ç§ç¼ºé™·ï¼ŒåŠ å…¥äº† ä½ç½®ç¼–ç ã€‚</p><p>input-&gt;è¯åµŒå…¥ï¼Œå¾—åˆ°ä¸€ä¸ªå‘é‡-&gt;ä½ç½®ç¼–ç ï¼ˆæ­£ä½™å¼¦ï¼Œå€¼åœ¨-1åˆ°1ï¼‰-&gt;å°†å‘é‡å’Œä½ç½®ç¼–ç ç›¸åŠ ã€‚</p><p>åœ¨Transformeræ¨¡å‹ä¸­ï¼Œâ€Embeddingâ€ å’Œ â€œSoftmaxâ€ æ˜¯ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œå®ƒä»¬åœ¨æ¨¡å‹çš„ä¸åŒéƒ¨åˆ†å‘æŒ¥ç€å…³é”®ä½œç”¨ã€‚</p><h4 id="Embedding"><a href="#Embedding" class="headerlink" title="Embedding"></a>Embedding</h4><ol><li><p><strong>å®šä¹‰</strong>ï¼š</p><ul><li>Embedding æ˜¯ä¸€ç§å°†ç¦»æ•£æ•°æ®ï¼ˆå¦‚å•è¯ã€å­—ç¬¦æˆ–å…¶ä»–ç¬¦å·ï¼‰æ˜ å°„åˆ°è¿ç»­çš„å‘é‡ç©ºé—´çš„æŠ€æœ¯ã€‚åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ä¸­ï¼Œembedding é€šå¸¸ç”¨äºå°†è¯æ±‡è¡¨ä¸­çš„å•è¯è½¬æ¢ä¸ºå›ºå®šé•¿åº¦çš„å‘é‡ã€‚</li></ul></li><li><p><strong>åœ¨Transformerä¸­çš„åº”ç”¨</strong>ï¼š</p><ul><li><strong>è¯åµŒå…¥ï¼ˆWord Embeddingï¼‰</strong>ï¼šåœ¨Transformeræ¨¡å‹çš„è¾“å…¥é˜¶æ®µï¼Œæ¯ä¸ªå•è¯é¦–å…ˆè¢«è½¬æ¢ä¸ºä¸€ä¸ªè¯åµŒå…¥å‘é‡ã€‚è¿™äº›å‘é‡æ•æ‰äº†å•è¯çš„è¯­ä¹‰ä¿¡æ¯ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡è®­ç»ƒè¿›ä¸€æ­¥ä¼˜åŒ–ã€‚</li><li><strong>ä½ç½®ç¼–ç ï¼ˆPositional Encodingï¼‰</strong>ï¼šç”±äºTransformeræ¨¡å‹æœ¬èº«ä¸å…·å¤‡æ•æ‰åºåˆ—ä¸­ä½ç½®ä¿¡æ¯çš„èƒ½åŠ›ï¼Œå› æ­¤éœ€è¦æ·»åŠ ä½ç½®ç¼–ç åˆ°è¯åµŒå…¥ä¸­ã€‚ä½ç½®ç¼–ç æ˜¯ä¸€ç§å°†ä½ç½®ä¿¡æ¯ç¼–ç åˆ°å‘é‡ä¸­çš„æ–¹æ³•ï¼Œ<strong>å®ƒä¸è¯åµŒå…¥å‘é‡ç›¸åŠ ï¼Œä»¥ç¡®ä¿æ¨¡å‹èƒ½å¤Ÿç†è§£å•è¯åœ¨åºåˆ—ä¸­çš„ä½ç½®</strong>ã€‚</li></ul></li></ol><h4 id="Softmax"><a href="#Softmax" class="headerlink" title="Softmax"></a>Softmax</h4><ol><li><p><strong>å®šä¹‰</strong>ï¼š</p><ul><li>Softmax æ˜¯ä¸€ç§å°†å®æ•°å‘é‡è½¬æ¢ä¸ºæ¦‚ç‡åˆ†å¸ƒçš„å‡½æ•°ã€‚å¯¹äºå‘é‡ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼ŒSoftmax å‡½æ•°è®¡ç®—å…¶ç›¸å¯¹äºå…¶ä»–å…ƒç´ çš„æŒ‡æ•°ï¼Œå¹¶å°†å…¶å½’ä¸€åŒ–ï¼Œä½¿å¾—æ‰€æœ‰è¾“å‡ºå€¼çš„å’Œä¸º1ã€‚</li></ul></li><li><p><strong>åœ¨Transformerä¸­çš„åº”ç”¨</strong>ï¼š</p><ul><li><strong>è‡ªæ³¨æ„åŠ›æœºåˆ¶ä¸­çš„è¾“å‡º</strong>ï¼šåœ¨è‡ªæ³¨æ„åŠ›å±‚ä¸­ï¼Œæ¯ä¸ªå•è¯çš„åµŒå…¥å‘é‡ä¼šé€šè¿‡ä¸€ä¸ªçº¿æ€§å˜æ¢ï¼Œç„¶ååº”ç”¨Softmaxå‡½æ•°ã€‚Softmaxå‡½æ•°çš„è¾“å‡ºè¡¨ç¤ºæ¯ä¸ªå•è¯å¯¹å…¶ä»–æ‰€æœ‰å•è¯çš„å…³æ³¨ç¨‹åº¦ï¼Œå³æ³¨æ„åŠ›æƒé‡ã€‚</li><li><strong>è§£ç å™¨ä¸­çš„è¾“å‡º</strong>ï¼šåœ¨è§£ç å™¨çš„æœ€åé˜¶æ®µï¼Œæ¨¡å‹ä¼šé¢„æµ‹ä¸‹ä¸€ä¸ªå•è¯çš„æ¦‚ç‡åˆ†å¸ƒã€‚è¿™é‡Œä¹Ÿä¼šä½¿ç”¨Softmaxå‡½æ•°ï¼Œå°†æœ€åä¸€ä¸ªéšè—å±‚çš„è¾“å‡ºè½¬æ¢ä¸ºè¯æ±‡è¡¨ä¸Šçš„æ¦‚ç‡åˆ†å¸ƒï¼Œä»¥ä¾¿é€‰æ‹©ä¸‹ä¸€ä¸ªæœ€å¯èƒ½çš„å•è¯ã€‚</li></ul></li></ol><h3 id="å…·ä½“åº”ç”¨ç¤ºä¾‹"><a href="#å…·ä½“åº”ç”¨ç¤ºä¾‹" class="headerlink" title="å…·ä½“åº”ç”¨ç¤ºä¾‹"></a>å…·ä½“åº”ç”¨ç¤ºä¾‹</h3><ol><li><p><strong>è¯åµŒå…¥</strong>ï¼š</p><ul><li>å‡è®¾è¯æ±‡è¡¨å¤§å°ä¸º10000ï¼Œæ¯ä¸ªå•è¯è¢«æ˜ å°„åˆ°ä¸€ä¸ªç»´åº¦ä¸º512çš„å‘é‡ç©ºé—´ã€‚è¯åµŒå…¥å±‚ä¼šå°†è¾“å…¥çš„å•è¯ç´¢å¼•è½¬æ¢ä¸ºç›¸åº”çš„512ç»´å‘é‡ã€‚</li></ul></li><li><p><strong>ä½ç½®ç¼–ç </strong>ï¼š</p><ul><li>ä½ç½®ç¼–ç é€šå¸¸æ˜¯ä¸è¯åµŒå…¥å‘é‡ç›¸åŒç»´åº¦çš„å‘é‡ï¼Œå®ƒé€šè¿‡æ­£å¼¦å’Œä½™å¼¦å‡½æ•°ç”Ÿæˆï¼Œä»¥ç¡®ä¿æ¨¡å‹èƒ½å¤ŸåŒºåˆ†ä¸åŒä½ç½®çš„å•è¯ã€‚</li></ul></li><li><p><strong>è‡ªæ³¨æ„åŠ›å±‚ä¸­çš„Softmax</strong>ï¼š</p><ul><li>åœ¨è‡ªæ³¨æ„åŠ›å±‚ä¸­ï¼Œæ¯ä¸ªå•è¯çš„åµŒå…¥å‘é‡ä¼šé€šè¿‡ä¸€ä¸ªçº¿æ€§å˜æ¢ï¼Œå¾—åˆ°ä¸€ä¸ªæœªå½’ä¸€åŒ–çš„æ³¨æ„åŠ›åˆ†æ•°ã€‚ç„¶åï¼ŒSoftmaxå‡½æ•°å°†è¿™äº›åˆ†æ•°è½¬æ¢ä¸ºæ¦‚ç‡åˆ†å¸ƒï¼Œå³æ¯ä¸ªå•è¯å¯¹å…¶ä»–å•è¯çš„å…³æ³¨æƒé‡ã€‚</li></ul></li><li><p><strong>è§£ç å™¨çš„è¾“å‡ºSoftmax</strong>ï¼š</p><ul><li>åœ¨è§£ç å™¨çš„æœ€åï¼Œæ¨¡å‹ä¼šå°†æœ€åä¸€ä¸ªéšè—å±‚çš„è¾“å‡ºé€šè¿‡ä¸€ä¸ªçº¿æ€§å˜æ¢ï¼Œç„¶ååº”ç”¨Softmaxå‡½æ•°ï¼Œå¾—åˆ°è¯æ±‡è¡¨ä¸Šæ¯ä¸ªå•è¯çš„æ¦‚ç‡åˆ†å¸ƒã€‚è¿™ä¸ªåˆ†å¸ƒç”¨äºé€‰æ‹©ä¸‹ä¸€ä¸ªæœ€å¯èƒ½çš„å•è¯ã€‚</li></ul></li></ol><p>é€šè¿‡è¿™äº›æœºåˆ¶ï¼ŒTransformeræ¨¡å‹èƒ½å¤Ÿæœ‰æ•ˆåœ°å¤„ç†åºåˆ—æ•°æ®ï¼Œæ•æ‰å•è¯ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå¹¶åœ¨å„ç§NLPä»»åŠ¡ä¸­å–å¾—ä¼˜å¼‚çš„æ€§èƒ½ã€‚</p><h3 id="Why-Self-Attention"><a href="#Why-Self-Attention" class="headerlink" title="Why Self-Attention"></a>Why Self-Attention</h3><p>æ²¡æœ‰è¯´çš„å¤ªæ¸…æ¥š</p><p><img src="C:\Users\11505\AppData\Roaming\Typora\typora-user-images\image-20240910121441665.png" alt="image-20240910121441665"></p><p><strong>Complexity per Layerï¼ˆæ¯å±‚çš„å¤æ‚åº¦ï¼‰</strong></p><p><strong>Sequential Operationsï¼ˆåºåˆ—æ“ä½œï¼‰</strong>ï¼š</p><ul><li><strong>O(1)ï¼š</strong>è¿™æ„å‘³ç€åœ¨å¤„ç†åºåˆ—æ—¶ï¼Œæ¯ä¸ªå±‚çš„æ“ä½œå¯ä»¥å¹¶è¡ŒåŒ–ï¼Œä¸éœ€è¦ç­‰å¾…å‰ä¸€ä¸ªæ“ä½œå®Œæˆã€‚</li><li>**O(n)**ï¼šå¹¶è¡ŒåŒ–ç¨‹åº¦è¾ƒå·®</li></ul><p><strong>Maximum Path Lengthï¼ˆæœ€å¤§è·¯å¾„é•¿åº¦ï¼‰</strong></p><p><a href="https://zhuanlan.zhihu.com/p/615000678">CNN&#x2F;RNN&#x2F;Transformerå¯¹æ¯” - çŸ¥ä¹ (zhihu.com)</a></p><h2 id="Transformer-çš„åº”ç”¨ï¼š"><a href="#Transformer-çš„åº”ç”¨ï¼š" class="headerlink" title="Transformer çš„åº”ç”¨ï¼š"></a>Transformer çš„åº”ç”¨ï¼š</h2><p>Transformer æ¨¡å‹è‡ªæå‡ºä»¥æ¥ï¼Œå·²ç»åœ¨è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸå–å¾—äº†å·¨å¤§çš„æˆåŠŸï¼Œå°¤å…¶æ˜¯åœ¨æœºå™¨ç¿»è¯‘ã€æ–‡æœ¬æ‘˜è¦ã€é—®ç­”ç³»ç»Ÿå’Œæ–‡æœ¬ç”Ÿæˆç­‰ä»»åŠ¡ä¸­ã€‚æ­¤å¤–ï¼Œå®ƒä¹Ÿè¢«ç”¨äºè¯­éŸ³è¯†åˆ«å’Œè®¡ç®—æœºè§†è§‰ç­‰é¢†åŸŸã€‚</p><p>â€œAttention Is All You Needâ€ è®ºæ–‡çš„æå‡ºæ ‡å¿—ç€ NLP é¢†åŸŸçš„ä¸€ä¸ªé‡è¦è½¬æŠ˜ç‚¹ï¼Œå®ƒä¸ä»…æ¨åŠ¨äº†æ¨¡å‹æ¶æ„çš„å‘å±•ï¼Œä¹Ÿä¸ºåç»­çš„ç ”ç©¶å’Œåº”ç”¨å¥ å®šäº†åŸºç¡€ã€‚</p><h2 id="Transformerå’ŒCNNï¼š"><a href="#Transformerå’ŒCNNï¼š" class="headerlink" title="Transformerå’ŒCNNï¼š"></a>Transformerå’ŒCNNï¼š</h2><p>Transformer å’Œ CNN æ˜¯ä¸¤ç§åœ¨æ·±åº¦å­¦ä¹ é¢†åŸŸå¹¿æ³›ä½¿ç”¨çš„æ¨¡å‹æ¶æ„ï¼Œå®ƒä»¬å„è‡ªæœ‰ç€ç‹¬ç‰¹çš„ä¼˜åŠ¿å’Œé€‚ç”¨åœºæ™¯ã€‚</p><p><strong>Transformer</strong>ï¼š</p><ul><li><strong>å¹¶è¡Œå¤„ç†èƒ½åŠ›</strong>ï¼šTransformer æ¨¡å‹ç”±äºä¸ä¾èµ–äºåºåˆ—çš„å¾ªç¯ç»“æ„ï¼Œå¯ä»¥å¹¶è¡Œå¤„ç†åºåˆ—ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œè¿™ä½¿å¾—å®ƒåœ¨è®­ç»ƒæ—¶èƒ½å¤Ÿå……åˆ†åˆ©ç”¨ç°ä»£ç¡¬ä»¶çš„å¹¶è¡Œè®¡ç®—èƒ½åŠ›ï¼Œä»è€ŒåŠ å¿«è®­ç»ƒé€Ÿåº¦ã€‚</li><li><strong>è‡ªæ³¨æ„åŠ›æœºåˆ¶</strong>ï¼šTransformer é€šè¿‡è‡ªæ³¨æ„åŠ›æœºåˆ¶èƒ½å¤Ÿæ•æ‰åºåˆ—ä¸­çš„é•¿è·ç¦»ä¾èµ–å…³ç³»ï¼Œè¿™åœ¨å¤„ç†é•¿åºåˆ—æ•°æ®æ—¶ç‰¹åˆ«æœ‰ç”¨ï¼Œå¦‚æœºå™¨ç¿»è¯‘å’Œæ–‡æœ¬ç”Ÿæˆç­‰ä»»åŠ¡ã€‚</li><li><strong>å¤šå¤´æ³¨æ„åŠ›</strong>ï¼šTransformer æ¨¡å‹ä¸­çš„å¤šå¤´æ³¨æ„åŠ›æœºåˆ¶å¯ä»¥åŒæ—¶ä»ä¸åŒçš„è¡¨ç¤ºå­ç©ºé—´ä¸­å­¦ä¹ ä¿¡æ¯ï¼Œå¢å¼ºäº†æ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›ã€‚</li><li><strong>ä½ç½®ç¼–ç </strong>ï¼šç”±äº Transformer æœ¬èº«ä¸åŒ…å«åºåˆ—ä¸­çš„ä½ç½®ä¿¡æ¯ï¼Œå› æ­¤éœ€è¦å¼•å…¥ä½ç½®ç¼–ç æ¥ä¸ºæ¨¡å‹æä¾›åºåˆ—ä¸­å•è¯çš„ä½ç½®ä¿¡æ¯ã€‚</li></ul><p><strong>CNN</strong>ï¼š</p><ul><li><strong>å±€éƒ¨ç‰¹å¾æå–</strong>ï¼šCNN é€šè¿‡å·ç§¯å±‚å¯ä»¥æœ‰æ•ˆåœ°æå–å›¾åƒä¸­çš„å±€éƒ¨ç‰¹å¾ï¼Œå¦‚è¾¹ç¼˜ã€çº¹ç†ç­‰ï¼Œè¿™ä½¿å¾—å®ƒåœ¨å›¾åƒè¯†åˆ«å’Œåˆ†ç±»ä»»åŠ¡ä¸­è¡¨ç°å‡ºè‰²ã€‚</li><li><strong>å‚æ•°å…±äº«</strong>ï¼šCNN çš„å·ç§¯å±‚é€šè¿‡æƒé‡å…±äº«å‡å°‘äº†æ¨¡å‹çš„å‚æ•°æ•°é‡ï¼Œè¿™ä¸ä»…å‡å°‘äº†è®¡ç®—æˆæœ¬ï¼Œä¹Ÿä½¿å¾—æ¨¡å‹æ›´åŠ é«˜æ•ˆã€‚</li><li><strong>å¤šå±‚ç»“æ„</strong>ï¼šCNN é€šå¸¸åŒ…å«å¤šä¸ªå·ç§¯å±‚å’Œæ± åŒ–å±‚ï¼Œè¿™æœ‰åŠ©äºæ¨¡å‹å­¦ä¹ ä»ä½çº§åˆ°é«˜çº§çš„ç‰¹å¾è¡¨ç¤ºã€‚</li><li><strong>å¹³ç§»ä¸å˜æ€§</strong>ï¼šCNN çš„å·ç§¯æ“ä½œå…·æœ‰å¹³ç§»ä¸å˜æ€§ï¼Œè¿™æ„å‘³ç€æ¨¡å‹å¯¹å›¾åƒä¸­ç‰©ä½“çš„ä½ç½®å˜åŒ–å…·æœ‰ä¸€å®šçš„é²æ£’æ€§ã€‚</li></ul><p>åœ¨<strong>è®¡ç®—æœºè§†è§‰</strong>é¢†åŸŸï¼ŒCNN é•¿æœŸä»¥æ¥ä¸€ç›´æ˜¯ä¸»æµçš„æ¨¡å‹æ¶æ„ï¼Œä½†è¿‘å¹´æ¥ Transformer ä¹Ÿå¼€å§‹åœ¨è¿™ä¸€é¢†åŸŸå–å¾—çªç ´ã€‚ä¾‹å¦‚ï¼ŒVision Transformerï¼ˆViTï¼‰é€šè¿‡å°†å›¾åƒåˆ†å‰²æˆå¤šä¸ªå°å—ï¼Œç„¶åå°†è¿™äº›å°å—ä½œä¸ºåºåˆ—è¾“å…¥åˆ° Transformer æ¨¡å‹ä¸­ï¼Œå·²ç»åœ¨å¤šä¸ªè§†è§‰ä»»åŠ¡ä¸­å–å¾—äº†ä¼˜å¼‚çš„æ€§èƒ½ã€‚</p><p>åœ¨<strong>è‡ªç„¶è¯­è¨€å¤„ç†</strong>é¢†åŸŸï¼ŒTransformer å·²ç»æˆä¸ºè®¸å¤šä»»åŠ¡çš„é¦–é€‰æ¨¡å‹ï¼Œå¦‚æœºå™¨ç¿»è¯‘ã€æ–‡æœ¬æ‘˜è¦å’Œé—®ç­”ç³»ç»Ÿç­‰ã€‚å®ƒçš„å¹¶è¡ŒåŒ–å¤„ç†èƒ½åŠ›å’Œé•¿è·ç¦»ä¾èµ–å…³ç³»çš„æ•æ‰èƒ½åŠ›ä½¿å…¶åœ¨è¿™äº›ä»»åŠ¡ä¸­è¶…è¶Šäº†ä¼ ç»Ÿçš„ RNN å’Œ LSTM æ¨¡å‹ã€‚</p><p>æ€»çš„æ¥è¯´ï¼ŒTransformer å’Œ CNN å„æœ‰ä¼˜åŠ¿ï¼Œé€‰æ‹©å“ªç§æ¨¡å‹å–å†³äºå…·ä½“çš„ä»»åŠ¡éœ€æ±‚ã€æ•°æ®ç±»å‹å’Œè®¡ç®—èµ„æºã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç”šè‡³å¯ä»¥å°†ä¸¤è€…ç»“åˆèµ·æ¥ï¼Œä»¥åˆ©ç”¨å®ƒä»¬å„è‡ªçš„ä¼˜åŠ¿ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å¤§æ¨¡å‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> äººå·¥æ™ºèƒ½ </tag>
            
            <tag> Transformer </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸¤ä¸‡å­—è®²æ¸…æ¥šï¼šç°åœ¨çš„AIäº§å“æœ‰å¤šéš¾åšï¼Ÿ</title>
      <link href="/2024/09/05/2024-09-05-%E4%B8%A4%E4%B8%87%E5%AD%97%E8%AE%B2%E6%B8%85%E6%A5%9A%EF%BC%9A%E7%8E%B0%E5%9C%A8%E7%9A%84AI%E4%BA%A7%E5%93%81%E6%9C%89%E5%A4%9A%E9%9A%BE%E5%81%9A%EF%BC%9F/"/>
      <url>/2024/09/05/2024-09-05-%E4%B8%A4%E4%B8%87%E5%AD%97%E8%AE%B2%E6%B8%85%E6%A5%9A%EF%BC%9A%E7%8E%B0%E5%9C%A8%E7%9A%84AI%E4%BA%A7%E5%93%81%E6%9C%89%E5%A4%9A%E9%9A%BE%E5%81%9A%EF%BC%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸¤ä¸‡å­—è®²æ¸…æ¥šï¼šç°åœ¨çš„AIäº§å“æœ‰å¤šéš¾åšï¼Ÿ"><a href="#ä¸¤ä¸‡å­—è®²æ¸…æ¥šï¼šç°åœ¨çš„AIäº§å“æœ‰å¤šéš¾åšï¼Ÿ" class="headerlink" title="ä¸¤ä¸‡å­—è®²æ¸…æ¥šï¼šç°åœ¨çš„AIäº§å“æœ‰å¤šéš¾åšï¼Ÿ"></a>ä¸¤ä¸‡å­—è®²æ¸…æ¥šï¼šç°åœ¨çš„AIäº§å“æœ‰å¤šéš¾åšï¼Ÿ</h1><p><a href="https://mp.weixin.qq.com/s/pMt_VMs6uq5wsPPscOyefA">https://mp.weixin.qq.com/s/pMt_VMs6uq5wsPPscOyefA</a></p><p>è¿™ç¯‡æ–‡ç« æ·±å…¥æ¢è®¨äº†AIäº§å“ç»ç†åœ¨å¤„ç†å¤§å‹AIæ¨¡å‹æ—¶åº”è¯¥è€ƒè™‘çš„å…³é”®é—®é¢˜å’Œæœºé‡ã€‚</p><h3 id="1-å…³æ³¨APIè€Œéä»…ä»…æ˜¯äº§å“"><a href="#1-å…³æ³¨APIè€Œéä»…ä»…æ˜¯äº§å“" class="headerlink" title="1. å…³æ³¨APIè€Œéä»…ä»…æ˜¯äº§å“"></a>1. <strong>å…³æ³¨APIè€Œéä»…ä»…æ˜¯äº§å“</strong></h3><ul><li><strong>æ ¸å¿ƒè§‚ç‚¹</strong>ï¼šäº§å“ç»ç†åº”è¯¥æ·±å…¥ç†è§£å¤§æ¨¡å‹çš„APIï¼Œå› ä¸ºè¿™æ˜¯æ¨¡å‹èƒ½åŠ›çš„ç›´æ¥ä½“ç°ã€‚äº§å“çš„æœ€ç»ˆå½¢æ€å¾€å¾€æ˜¯APIèƒ½åŠ›çš„å»¶ä¼¸ï¼Œä½†å¯èƒ½ä¼šå› ä¸ºå„ç§å·¥ç¨‹é™åˆ¶è€Œä¸APIçš„èƒ½åŠ›æœ‰æ‰€å·®å¼‚ã€‚</li><li><strong>å®é™…æ„ä¹‰</strong>ï¼šäº†è§£APIçš„èƒ½åŠ›å’Œé™åˆ¶å¯ä»¥å¸®åŠ©äº§å“ç»ç†æ›´å‡†ç¡®åœ°è®¾è®¡äº§å“åŠŸèƒ½ï¼Œé¿å…è¿‡åº¦ä¾èµ–æ¨¡å‹æ— æ³•å®ç°çš„åŠŸèƒ½ã€‚</li></ul><h3 id="2-AIä¸ç§»åŠ¨äº’è”ç½‘çš„ç±»æ¯”ä¸æ°å½“"><a href="#2-AIä¸ç§»åŠ¨äº’è”ç½‘çš„ç±»æ¯”ä¸æ°å½“" class="headerlink" title="2. AIä¸ç§»åŠ¨äº’è”ç½‘çš„ç±»æ¯”ä¸æ°å½“"></a>2. <strong>AIä¸ç§»åŠ¨äº’è”ç½‘çš„ç±»æ¯”ä¸æ°å½“</strong></h3><ul><li><strong>æ ¸å¿ƒè§‚ç‚¹</strong>ï¼šç®€å•åœ°å°†AIæŠ€æœ¯åº”ç”¨åˆ°æ‰€æœ‰åº”ç”¨ä¸­å¹¶ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆç­–ç•¥ã€‚åªæœ‰é‚£äº›çœŸæ­£èƒ½å¤Ÿä»AIä¸­è·å¾—æ˜¾è‘—ä¼˜åŠ¿çš„åº”ç”¨æ‰åº”è¯¥è¿›è¡ŒAIé‡æ„ã€‚</li><li><strong>å®é™…æ„ä¹‰</strong>ï¼šè¿™è¦æ±‚äº§å“ç»ç†è¿›è¡Œæ·±å…¥çš„éœ€æ±‚åˆ†æå’Œæˆæœ¬æ•ˆç›Šåˆ†æï¼Œä»¥ç¡®å®šAIçš„æŠ•å…¥æ˜¯å¦çœŸæ­£å€¼å¾—ã€‚</li></ul><h3 id="3-äº§å“ç»ç†éœ€è¦å­¦ä¼šè°ƒç”¨API"><a href="#3-äº§å“ç»ç†éœ€è¦å­¦ä¼šè°ƒç”¨API" class="headerlink" title="3. äº§å“ç»ç†éœ€è¦å­¦ä¼šè°ƒç”¨API"></a>3. <strong>äº§å“ç»ç†éœ€è¦å­¦ä¼šè°ƒç”¨API</strong></h3><ul><li><strong>æ ¸å¿ƒè§‚ç‚¹</strong>ï¼šäº§å“ç»ç†åº”è¯¥å…·å¤‡ç›´æ¥ä¸AIæ¨¡å‹äº¤äº’çš„èƒ½åŠ›ï¼Œè¿™æœ‰åŠ©äºæ›´å¥½åœ°ç†è§£æ¨¡å‹çš„èƒ½åŠ›å’Œå±€é™ã€‚</li><li><strong>å®é™…æ„ä¹‰</strong>ï¼šè¿™ç§èƒ½åŠ›å¯ä»¥å¸®åŠ©äº§å“ç»ç†åœ¨äº§å“å¼€å‘è¿‡ç¨‹ä¸­åšå‡ºæ›´å‡†ç¡®çš„å†³ç­–ï¼Œå¹¶èƒ½å¤Ÿå¿«é€Ÿè¿­ä»£äº§å“ä»¥é€‚åº”æ¨¡å‹çš„å˜åŒ–ã€‚</li></ul><h3 id="4-å¤§æ¨¡å‹çš„é•¿å¤„åœ¨äºè·¨å†…å®¹åª’ä»‹å’Œæ¨¡æ€"><a href="#4-å¤§æ¨¡å‹çš„é•¿å¤„åœ¨äºè·¨å†…å®¹åª’ä»‹å’Œæ¨¡æ€" class="headerlink" title="4. å¤§æ¨¡å‹çš„é•¿å¤„åœ¨äºè·¨å†…å®¹åª’ä»‹å’Œæ¨¡æ€"></a>4. <strong>å¤§æ¨¡å‹çš„é•¿å¤„åœ¨äºè·¨å†…å®¹åª’ä»‹å’Œæ¨¡æ€</strong></h3><ul><li><strong>æ ¸å¿ƒè§‚ç‚¹</strong>ï¼šå¤§æ¨¡å‹çš„ä¸€ä¸ªä¸»è¦ä¼˜åŠ¿æ˜¯èƒ½å¤Ÿå¤„ç†å’Œè½¬æ¢ä¸åŒç±»å‹çš„æ•°æ®å’Œåª’ä»‹ï¼Œå¦‚æ–‡æœ¬ã€å›¾åƒå’Œå£°éŸ³ã€‚</li><li><strong>å®é™…æ„ä¹‰</strong>ï¼šè¿™ä¸ºåˆ›é€ æ–°å‹çš„å¤šåª’ä½“äº§å“æä¾›äº†å¯èƒ½ï¼Œäº§å“ç»ç†å¯ä»¥æ¢ç´¢å¦‚ä½•åˆ©ç”¨è¿™ä¸€èƒ½åŠ›æ¥å¢å¼ºç”¨æˆ·ä½“éªŒã€‚</li></ul><h3 id="5-å¤§æ¨¡å‹çš„å±€é™æ€§"><a href="#5-å¤§æ¨¡å‹çš„å±€é™æ€§" class="headerlink" title="5. å¤§æ¨¡å‹çš„å±€é™æ€§"></a>5. <strong>å¤§æ¨¡å‹çš„å±€é™æ€§</strong></h3><ul><li><strong>æ ¸å¿ƒè§‚ç‚¹</strong>ï¼šå°½ç®¡å¤§æ¨¡å‹åŠŸèƒ½å¼ºå¤§ï¼Œä½†å®ƒä»¬åœ¨æˆæœ¬ã€ä¸Šä¸‹æ–‡å¤„ç†ã€æ•°æ®å‡†ç¡®æ€§ç­‰æ–¹é¢å­˜åœ¨å±€é™ã€‚</li><li><strong>å®é™…æ„ä¹‰</strong>ï¼šäº§å“ç»ç†åœ¨è®¾è®¡äº§å“æ—¶éœ€è¦è€ƒè™‘è¿™äº›å±€é™ï¼Œç¡®ä¿äº§å“åœ¨å®é™…ä½¿ç”¨ä¸­èƒ½å¤Ÿç¨³å®šè¿è¡Œï¼Œå¹¶ä¸”æä¾›å‡†ç¡®çš„æœåŠ¡ã€‚</li></ul><h3 id="6-å¤§æ¨¡å‹å¯èƒ½æ°¸è¿œæ— æ³•è§£å†³çš„é—®é¢˜"><a href="#6-å¤§æ¨¡å‹å¯èƒ½æ°¸è¿œæ— æ³•è§£å†³çš„é—®é¢˜" class="headerlink" title="6. å¤§æ¨¡å‹å¯èƒ½æ°¸è¿œæ— æ³•è§£å†³çš„é—®é¢˜"></a>6. <strong>å¤§æ¨¡å‹å¯èƒ½æ°¸è¿œæ— æ³•è§£å†³çš„é—®é¢˜</strong></h3><ul><li><strong>æ ¸å¿ƒè§‚ç‚¹</strong>ï¼šæŸäº›é—®é¢˜ï¼Œå¦‚æˆæœ¬å’Œæ€§èƒ½çš„å¹³è¡¡ï¼Œå¯èƒ½æ°¸è¿œæ— æ³•é€šè¿‡æŠ€æœ¯è¿›æ­¥å®Œå…¨è§£å†³ã€‚</li><li><strong>å®é™…æ„ä¹‰</strong>ï¼šäº§å“ç»ç†éœ€è¦åœ¨è®¾è®¡äº§å“æ—¶è€ƒè™‘åˆ°è¿™äº›é•¿æœŸå­˜åœ¨çš„é—®é¢˜ï¼Œå¹¶å¯»æ‰¾åˆ›æ–°çš„æ–¹æ³•æ¥å‡è½»å®ƒä»¬çš„å½±å“ã€‚</li></ul><h3 id="7-å¤§æ¨¡å‹ç›®å‰å·¥ç¨‹ä¸Šçš„éš¾ç‚¹"><a href="#7-å¤§æ¨¡å‹ç›®å‰å·¥ç¨‹ä¸Šçš„éš¾ç‚¹" class="headerlink" title="7. å¤§æ¨¡å‹ç›®å‰å·¥ç¨‹ä¸Šçš„éš¾ç‚¹"></a>7. <strong>å¤§æ¨¡å‹ç›®å‰å·¥ç¨‹ä¸Šçš„éš¾ç‚¹</strong></h3><ul><li><strong>æ ¸å¿ƒè§‚ç‚¹</strong>ï¼šæ•°æ®çš„è·å–å’Œå¤„ç†ï¼Œä»¥åŠå®‰å…¨æœºåˆ¶çš„è®¾ç½®ï¼Œæ˜¯å½“å‰å¤§æ¨¡å‹åº”ç”¨ä¸­çš„å·¥ç¨‹æŒ‘æˆ˜ã€‚</li><li><strong>å®é™…æ„ä¹‰</strong>ï¼šäº§å“ç»ç†éœ€è¦ä¸æ•°æ®ç§‘å­¦å®¶å’Œå·¥ç¨‹å¸ˆç´§å¯†åˆä½œï¼Œç¡®ä¿æ•°æ®çš„è´¨é‡å’Œå®‰å…¨æ€§ï¼ŒåŒæ—¶ä¼˜åŒ–æ¨¡å‹çš„æ€§èƒ½ã€‚</li></ul><h3 id="8-å¤§æ¨¡å‹æœªæ¥å¯èƒ½ä¼šè¢«è§£å†³çš„é—®é¢˜"><a href="#8-å¤§æ¨¡å‹æœªæ¥å¯èƒ½ä¼šè¢«è§£å†³çš„é—®é¢˜" class="headerlink" title="8. å¤§æ¨¡å‹æœªæ¥å¯èƒ½ä¼šè¢«è§£å†³çš„é—®é¢˜"></a>8. <strong>å¤§æ¨¡å‹æœªæ¥å¯èƒ½ä¼šè¢«è§£å†³çš„é—®é¢˜</strong></h3><ul><li><strong>æ ¸å¿ƒè§‚ç‚¹</strong>ï¼šéšç€æŠ€æœ¯çš„å‘å±•ï¼Œå¤§æ¨¡å‹åœ¨æ„å›¾ç†è§£ã€åˆ›ä½œå’Œæ¨ç†èƒ½åŠ›æ–¹é¢çš„å¼±ç‚¹å¯èƒ½ä¼šå¾—åˆ°æ”¹å–„ã€‚</li><li><strong>å®é™…æ„ä¹‰</strong>ï¼šäº§å“ç»ç†åº”è¯¥å…³æ³¨è¿™äº›è¿›æ­¥ï¼Œä»¥ä¾¿åŠæ—¶æ›´æ–°äº§å“åŠŸèƒ½ï¼Œåˆ©ç”¨æ¨¡å‹çš„æ–°èƒ½åŠ›ã€‚</li></ul><h3 id="9-ä»RAGè§’åº¦ç†è§£å¤§æ¨¡å‹äº§å“"><a href="#9-ä»RAGè§’åº¦ç†è§£å¤§æ¨¡å‹äº§å“" class="headerlink" title="9. ä»RAGè§’åº¦ç†è§£å¤§æ¨¡å‹äº§å“"></a>9. <strong>ä»RAGè§’åº¦ç†è§£å¤§æ¨¡å‹äº§å“</strong></h3><ul><li><strong>æ ¸å¿ƒè§‚ç‚¹</strong>ï¼šRAGæŠ€æœ¯é€šè¿‡ç»“åˆæ£€ç´¢å’Œç”Ÿæˆï¼Œæé«˜äº†æ¨¡å‹åœ¨ç‰¹å®šä»»åŠ¡ä¸Šçš„è¡¨ç°ã€‚</li><li><strong>å®é™…æ„ä¹‰</strong>ï¼šäº§å“ç»ç†å¯ä»¥åˆ©ç”¨RAGæŠ€æœ¯æ¥è®¾è®¡æ›´æ™ºèƒ½çš„ä¿¡æ¯æ£€ç´¢å’Œå†…å®¹ç”Ÿæˆäº§å“ã€‚</li></ul><h3 id="10-ä»åª’ä»‹è§’åº¦ç†è§£å¤§æ¨¡å‹ä»·å€¼"><a href="#10-ä»åª’ä»‹è§’åº¦ç†è§£å¤§æ¨¡å‹ä»·å€¼" class="headerlink" title="10. ä»åª’ä»‹è§’åº¦ç†è§£å¤§æ¨¡å‹ä»·å€¼"></a>10. <strong>ä»åª’ä»‹è§’åº¦ç†è§£å¤§æ¨¡å‹ä»·å€¼</strong></h3><ul><li><strong>æ ¸å¿ƒè§‚ç‚¹</strong>ï¼šå¤§æ¨¡å‹å’ŒAIGCåœ¨å†…å®¹ç”Ÿäº§å’Œåª’ä»‹è½¬æ¢æ–¹é¢å…·æœ‰é©å‘½æ€§çš„æ„ä¹‰ã€‚</li><li><strong>å®é™…æ„ä¹‰</strong>ï¼šäº§å“ç»ç†å¯ä»¥æ¢ç´¢å¦‚ä½•é€šè¿‡AIæŠ€æœ¯æ”¹å˜å†…å®¹çš„åˆ›ä½œã€åˆ†å‘å’Œæ¶ˆè´¹æ–¹å¼ã€‚</li></ul><h3 id="11-ä¸ºä»€ä¹ˆæˆ‘ä»¬é«˜ä¼°äº†å¤§æ¨¡å‹"><a href="#11-ä¸ºä»€ä¹ˆæˆ‘ä»¬é«˜ä¼°äº†å¤§æ¨¡å‹" class="headerlink" title="11. ä¸ºä»€ä¹ˆæˆ‘ä»¬é«˜ä¼°äº†å¤§æ¨¡å‹"></a>11. <strong>ä¸ºä»€ä¹ˆæˆ‘ä»¬é«˜ä¼°äº†å¤§æ¨¡å‹</strong></h3><ul><li><strong>æ ¸å¿ƒè§‚ç‚¹</strong>ï¼šå¤§æ¨¡å‹åœ¨æŸäº›æ–¹é¢è¢«è¿‡åº¦ç†æƒ³åŒ–ï¼Œå®é™…ä¸Šå®ƒä»¬å¹¶ä¸èƒ½å®Œå…¨æ›¿ä»£ä¼ ç»Ÿçš„åº”ç”¨å’Œäº¤äº’æ–¹å¼ã€‚</li><li><strong>å®é™…æ„ä¹‰</strong>ï¼šäº§å“ç»ç†éœ€è¦æœ‰ç°å®çš„æœŸæœ›ï¼Œå¹¶ç»“åˆAIæŠ€æœ¯ä¸ä¼ ç»Ÿæ–¹æ³•ï¼Œåˆ›é€ å‡ºçœŸæ­£æœ‰ä»·å€¼çš„äº§å“ã€‚</li></ul><h3 id="12-å¯¹äº§å“ç»ç†çš„å·¥ä½œå¯ç¤º"><a href="#12-å¯¹äº§å“ç»ç†çš„å·¥ä½œå¯ç¤º" class="headerlink" title="12. å¯¹äº§å“ç»ç†çš„å·¥ä½œå¯ç¤º"></a>12. <strong>å¯¹äº§å“ç»ç†çš„å·¥ä½œå¯ç¤º</strong></h3><ul><li><strong>æ ¸å¿ƒè§‚ç‚¹</strong>ï¼šäº§å“ç»ç†åº”è¯¥å…³æ³¨å®é™…çš„ä¸šåŠ¡éœ€æ±‚å’Œæ•°æ®ï¼Œè€Œä¸æ˜¯ç›²ç›®è¿½æ±‚æœ€æ–°çš„æŠ€æœ¯è¶‹åŠ¿ã€‚</li><li><strong>å®é™…æ„ä¹‰</strong>ï¼šè¿™è¦æ±‚äº§å“ç»ç†å…·å¤‡æ‰¹åˆ¤æ€§æ€ç»´ï¼Œèƒ½å¤Ÿä»å•†ä¸šå’Œç”¨æˆ·éœ€æ±‚çš„è§’åº¦è¯„ä¼°æŠ€æœ¯çš„é€‚ç”¨æ€§ã€‚</li></ul><h3 id="13-AI-Agentå®è·µå»ºè®®"><a href="#13-AI-Agentå®è·µå»ºè®®" class="headerlink" title="13. AI Agentå®è·µå»ºè®®"></a>13. <strong>AI Agentå®è·µå»ºè®®</strong></h3><ul><li><strong>æ ¸å¿ƒè§‚ç‚¹</strong>ï¼šè®¾è®¡AI Agentæ—¶ï¼Œåº”è¯¥è€ƒè™‘ä»»åŠ¡çš„ç»†åˆ†ã€æˆæœ¬ä¸æ•ˆæœçš„å¹³è¡¡ï¼Œä»¥åŠå¦‚ä½•æœ€æœ‰æ•ˆåœ°åˆ©ç”¨æ¨¡å‹çš„èƒ½åŠ›ã€‚</li><li><strong>å®é™…æ„ä¹‰</strong>ï¼šè¿™äº›å»ºè®®å¯ä»¥å¸®åŠ©äº§å“ç»ç†æ›´æœ‰æ•ˆåœ°åˆ©ç”¨AIæŠ€æœ¯ï¼Œæé«˜äº§å“çš„æ•ˆç‡å’Œç”¨æˆ·ä½“éªŒã€‚</li></ul><p>æ•´ä½“è€Œè¨€ï¼Œæ–‡ç« å¼ºè°ƒäº†äº§å“ç»ç†åœ¨AIé¢†åŸŸçš„å·¥ä½œä¸­éœ€è¦å…·å¤‡æ·±å…¥çš„æŠ€æœ¯ç†è§£ã€æ•é”çš„å•†ä¸šæ´å¯ŸåŠ›å’Œåˆ›æ–°çš„è®¾è®¡æ€ç»´ã€‚é€šè¿‡è¿™äº›èƒ½åŠ›ï¼Œäº§å“ç»ç†å¯ä»¥æ›´å¥½åœ°åˆ©ç”¨AIæŠ€æœ¯ï¼Œåˆ›é€ å‡ºçœŸæ­£æœ‰ä»·å€¼çš„äº§å“å’ŒæœåŠ¡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å¤§æ¨¡å‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> äººå·¥æ™ºèƒ½ </tag>
            
            <tag> å¤§æ¨¡å‹ </tag>
            
            <tag> AIäº§å“ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤§æ¨¡å‹å­¦ä¹ è·¯çº¿</title>
      <link href="/2024/09/05/2024-09-05-%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/"/>
      <url>/2024/09/05/2024-09-05-%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/</url>
      
        <content type="html"><![CDATA[<h1 id="å¤§æ¨¡å‹å­¦ä¹ è·¯çº¿"><a href="#å¤§æ¨¡å‹å­¦ä¹ è·¯çº¿" class="headerlink" title="å¤§æ¨¡å‹å­¦ä¹ è·¯çº¿"></a>å¤§æ¨¡å‹å­¦ä¹ è·¯çº¿</h1><p><img src="https://s2.loli.net/2024/09/05/oKB5wZPCIe3mUuQ.png" alt="44cdfe55149112730ff6324728982a15[1].png"></p><p>ç°åœ¨é—¨æ§›é™ä½äº†ï¼Œæˆæœ¬ä¹Ÿé™ä½äº†ã€‚å¤§æ¨¡å‹æŠ€æœ¯çˆ†å‘ï¼ŒæŠ“ä½æœºä¼šã€‚</p><p>å¼€æºå¤§æ¨¡å‹ï¼ˆç¦»çº¿ï¼Œæ›´å®‰å…¨ï¼‰&#x2F;åœ¨çº¿å¤§æ¨¡å‹</p><ol><li><p>å¾®è°ƒï¼šLora-&gt;å‚ç±»</p><ul><li>é€‚ç”¨äºç”¨æˆ·æ„å›¾è¯†åˆ«</li></ul></li><li><p>RAGï¼šæ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆä¸€ç³»åˆ—ä¸“å®¶ï¼Œæå‡è¡¨ç°å¹…åº¦ï¼Œé™ä½å¹»è§‰ï¼‰</p><ul><li>åªè¦æä¾›äº†æ­£ç¡®ç­”æ¡ˆï¼Œå¤§æ¦‚ç‡å°±ä¸ä¼šç­”é”™</li><li>é€‚åˆç§æœ‰æ•°æ®åº“</li><li>æ‰€ä»¥ä¾èµ–äºæä¾›çš„æ•°æ®åº“çš„ä¿¡æ¯ï¼Œå¯¹æ•°æ®è´¨é‡è¦æ±‚æ¯”è¾ƒé«˜</li><li>æ¨ç†æ›´åŠ ç¼“æ…¢ï¼ˆä½äºå¾®è°ƒï¼‰</li><li>å¯¹çŸ¥è¯†åº“æ„å»º&#x2F;ä¿¡æ¯å‹ç¼©æ’åç­‰ï¼ˆå¹¶éæ·±åº¦å­¦ä¹ æ–¹é¢ï¼Œéœ€è¦æ·±åº¦å­¦ä¹ ç®—æ³•å·¥ç¨‹å¸ˆè¿›è¡Œè¾…åŠ©ï¼‰</li></ul></li><li><p>æç¤ºè¯å·¥ç¨‹</p><p><a href="https://blog.csdn.net/zhangcongyi420/article/details/140736194?ops_request_misc=%7B%22request_id%22:%225D002298-9B1C-475B-9F7A-0D6B76FE2120%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=5D002298-9B1C-475B-9F7A-0D6B76FE2120&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-2-140736194-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=%E6%8F%90%E7%A4%BA%E8%AF%8D%E5%B7%A5%E7%A8%8B&spm=1018.2226.3001.4187">ã€AIå¤§æ¨¡å‹ã€‘Prompt æç¤ºè¯å·¥ç¨‹ä½¿ç”¨è¯¦è§£_å¤§æ¨¡å‹promptçš„ç”¨æ³•è¯¦è§£-CSDNåšå®¢</a></p></li><li><p>é¢„è®­ç»ƒï¼šåˆ›é€ å‡ºå±äºè‡ªå·±çš„å…¨æ–°å¤§æ¨¡å‹</p><ul><li>éœ€è¦ç®—åŠ›æœ€å¤šï¼ˆå¾®è°ƒå…¶æ¬¡ï¼ŒRAGå’Œæç¤ºè¯å·¥ç¨‹å¯¹äºç®—åŠ›çš„è¦æ±‚å°±æ²¡é‚£ä¹ˆé«˜ï¼‰</li></ul></li></ol><p>agent-&gt;æ‹…ä»»80%è„‘åŠ›å·¥ä½œ</p><h2 id="ä¸€äº›è¯¾ç¨‹"><a href="#ä¸€äº›è¯¾ç¨‹" class="headerlink" title="ä¸€äº›è¯¾ç¨‹"></a>ä¸€äº›è¯¾ç¨‹</h2><h3 id="NLP"><a href="#NLP" class="headerlink" title="NLP"></a>NLP</h3><p><a href="https://github.com/FudanNLP/nlp-beginner">FudanNLP&#x2F;nlp-beginner: NLPä¸Šæ‰‹æ•™ç¨‹ (github.com)</a></p><p>è‡ªç„¶è¯­è¨€å¤„ç†çš„å…¥é—¨ç»ƒä¹ </p><h3 id="æ·±åº¦å­¦ä¹ "><a href="#æ·±åº¦å­¦ä¹ " class="headerlink" title="æ·±åº¦å­¦ä¹ "></a>æ·±åº¦å­¦ä¹ </h3><p><a href="https://space.bilibili.com/1567748478/channel/seriesdetail?sid=358497">è·Ÿææ²å­¦AIçš„ä¸ªäººç©ºé—´-è·Ÿææ²å­¦AIä¸ªäººä¸»é¡µ-å“”å“©å“”å“©è§†é¢‘ (bilibili.com)</a></p><p>åŠ¨æ‰‹å­¦æ·±åº¦å­¦ä¹ </p><h3 id="è®ºæ–‡ç²¾è¯»"><a href="#è®ºæ–‡ç²¾è¯»" class="headerlink" title="è®ºæ–‡ç²¾è¯»"></a>è®ºæ–‡ç²¾è¯»</h3><p><a href="https://www.bilibili.com/video/BV1H44y1t75x/?spm_id_from=333.999.0.0">https://www.bilibili.com/video/BV1H44y1t75x/?spm_id_from=333.999.0.0</a></p><h3 id="llm-course-star"><a href="#llm-course-star" class="headerlink" title="llm-course :star:"></a>llm-course :star:</h3><p><a href="https://github.com/mlabonne/llm-course">mlabonne&#x2F;llm-course: Course to get into Large Language Models (LLMs) with roadmaps and Colab notebooks. (github.com)</a></p><p>è¯¾ç¨‹åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š</p><ol><li>LLMçš„åŸºç¡€çŸ¥è¯†ï¼ŒåŒ…å«æ•°å­¦pythonç¥ç»ç½‘ç»œ</li><li>ç†è®ºï¼šä¸“æ³¨äºä½¿ç”¨æœ€æ–°æŠ€æœ¯æ„å»ºæœ€å¥½çš„ LLM</li><li>å·¥ç¨‹ï¼šä¸“æ³¨äºåˆ›å»ºåŸºäº LLM çš„åº”ç”¨ç¨‹åºå¹¶éƒ¨ç½²å®ƒä»¬</li></ol><h3 id="æç¤ºè¯å·¥ç¨‹"><a href="#æç¤ºè¯å·¥ç¨‹" class="headerlink" title="æç¤ºè¯å·¥ç¨‹"></a>æç¤ºè¯å·¥ç¨‹</h3><p><a href="https://github.com/Kevin-free/chatgpt-prompt-engineering-for-developers">https://github.com/Kevin-free/chatgpt-prompt-engineering-for-developers</a></p><h2 id="ä¸€äº›é¡¹ç›®"><a href="#ä¸€äº›é¡¹ç›®" class="headerlink" title="ä¸€äº›é¡¹ç›®"></a>ä¸€äº›é¡¹ç›®</h2><p><a href="https://www.bilibili.com/video/BV1kDpme9EwU/?spm_id_from=autoNext&vd_source=d2728007bbda9125d177004b9124afc1">ã€2024æœ€æ–°ã€‘54ä¸ªå¤§æ¨¡å‹å®æˆ˜é¡¹ç›®ï¼Œç»ƒå®Œå³å¯å°±ä¸šï¼Œä»å…¥é—¨åˆ°è¿›é˜¶ï¼ŒåŸºç¡€åˆ°æ¡†æ¶ï¼Œä½ æƒ³è¦çš„å…¨éƒ½æœ‰ï¼Œå»ºè®®ç ä½ï¼è¶…çº§é€‚åˆå°ç™½å…¥é—¨å­¦ä¹ ï¼Œå¤§æ¨¡å‹æ•™ç¨‹_å“”å“©å“”å“©_bilibili</a></p><p><a href="https://www.bilibili.com/video/BV1XS411w7qr/?spm_id_from=333.788.recommend_more_video.0&vd_source=d2728007bbda9125d177004b9124afc1">ã€æå®æ¯…ã€‘2024å¹´å…¬è®¤æœ€å¥½çš„ã€LLMå¤§æ¨¡å‹ã€‘æ•™ç¨‹ï¼å¤§æ¨¡å‹å…¥é—¨åˆ°è¿›é˜¶ï¼Œä¸€å¥—å…¨è§£å†³ï¼2024ç”Ÿæˆå¼äººå·¥æ™ºæ…§-é™„å¸¦è¯¾ä»¶ä»£ç _å“”å“©å“”å“©_bilibili</a></p>]]></content>
      
      
      <categories>
          
          <category> å¤§æ¨¡å‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> äººå·¥æ™ºèƒ½ </tag>
            
            <tag> å¤§æ¨¡å‹å­¦ä¹ è·¯çº¿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>xxl-jobå­¦ä¹ ç¬”è®°</title>
      <link href="/2024/08/25/2024-08-25-xxl-job%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2024/08/25/2024-08-25-xxl-job%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="xxl-jobå­¦ä¹ ç¬”è®°"><a href="#xxl-jobå­¦ä¹ ç¬”è®°" class="headerlink" title="xxl-jobå­¦ä¹ ç¬”è®°"></a>xxl-jobå­¦ä¹ ç¬”è®°</h1><h2 id="åŸºç¡€æ¦‚å¿µ"><a href="#åŸºç¡€æ¦‚å¿µ" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h2><p>xxl-jobæ˜¯ä¸€ä¸ªè½»é‡çº§åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å°ï¼Œå…¶æ ¸å¿ƒè®¾è®¡ç›®æ ‡æ˜¯å¼€å‘è¿…é€Ÿã€å­¦ä¹ ç®€å•ã€è½»é‡çº§ã€æ˜“æ‰©å±•ã€‚ç°å·²å¼€æ”¾æºä»£ç å¹¶æ¥å…¥å¤šå®¶å…¬å¸çº¿ä¸Šäº§å“çº¿ï¼Œå¼€ç®±å³ç”¨ã€‚</p><h2 id="ä»»åŠ¡æ‰§è¡Œæµç¨‹"><a href="#ä»»åŠ¡æ‰§è¡Œæµç¨‹" class="headerlink" title="ä»»åŠ¡æ‰§è¡Œæµç¨‹"></a>ä»»åŠ¡æ‰§è¡Œæµç¨‹</h2><p><img src="https://s2.loli.net/2024/08/25/iCr1DvLhW2K94eR.png" alt="image-20240825111454492.png"></p><p><strong>æ‰§è¡Œæµç¨‹</strong></p><ol><li><p>ä»»åŠ¡æ‰§è¡Œå™¨æ ¹æ®é…ç½®çš„è°ƒåº¦ä¸­å¿ƒçš„åœ°å€ï¼Œè‡ªåŠ¨æ³¨å†Œåˆ°è°ƒåº¦ä¸­å¿ƒ</p></li><li><p>è¾¾åˆ°ä»»åŠ¡å‡ºå‘æ¡ä»¶ï¼Œè°ƒåº¦ä¸­å¿ƒä¸‹å‘ä»»åŠ¡</p></li><li><p>æ‰§è¡Œå™¨åŸºäºçº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡ï¼Œå¹¶æŠŠæ‰§è¡Œç»“æœæ”¾å…¥å†…å­˜é˜Ÿåˆ—ã€æŠŠæ‰§è¡Œæ—¥å¿—å†™å…¥æ—¥å¿—æ–‡ä»¶ä¸­</p></li><li><p>æ‰§è¡Œå™¨æ¶ˆè´¹å†…å­˜é˜Ÿåˆ—ä¸­çš„æ‰§è¡Œç»“æœï¼Œä¸»åŠ¨ä¸ŠæŠ¥ç»™è°ƒåº¦ä¸­å¿ƒ</p></li><li><p>å½“ç”¨æˆ·åœ¨è°ƒåº¦ä¸­å¿ƒæŸ¥çœ‹ä»»åŠ¡æ—¥å¿—ï¼Œè°ƒåº¦ä¸­å¿ƒè¯·æ±‚ä»»åŠ¡æ‰§è¡Œå™¨ï¼Œä»»åŠ¡æ‰§è¡Œå™¨è¯»å–ä»»åŠ¡æ—¥å¿—æ–‡ä»¶å¹¶è¿”å›æ—¥å¿—è¯¦æƒ…</p></li></ol><h2 id="æ­å»ºxxl-job"><a href="#æ­å»ºxxl-job" class="headerlink" title="æ­å»ºxxl-job"></a>æ­å»ºxxl-job</h2><p><a href="https://gitee.com/xuxueli0323/xxl-job">xxl-job: ä¸€ä¸ªåˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å°ï¼Œå…¶æ ¸å¿ƒè®¾è®¡ç›®æ ‡æ˜¯å¼€å‘è¿…é€Ÿã€å­¦ä¹ ç®€å•ã€è½»é‡çº§ã€æ˜“æ‰©å±•ã€‚ç°å·²å¼€æ”¾æºä»£ç å¹¶æ¥å…¥å¤šå®¶å…¬å¸çº¿ä¸Šäº§å“çº¿ï¼Œå¼€ç®±å³ç”¨ã€‚ (gitee.com)</a></p><h3 id="ä½¿ç”¨dockeræ­å»ºxxl-job"><a href="#ä½¿ç”¨dockeræ­å»ºxxl-job" class="headerlink" title="ä½¿ç”¨dockeræ­å»ºxxl-job"></a>ä½¿ç”¨dockeræ­å»ºxxl-job</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">docker search xxl-job</span><br><span class="line">docker pull xuxueli/xxl-job-admin:2.4.0</span><br><span class="line"></span><br><span class="line">docker run  -d \</span><br><span class="line">        -p 8088:8088\</span><br><span class="line">        -v /tool/xxl-job/logs:/data/applogs \</span><br><span class="line">        -v /tool/xxl-job/application.properties:/xxl-job/xxl-job-admin/src/main/resources/application.properties \</span><br><span class="line">        -e PARAMS=&quot;--server.port=8088\</span><br><span class="line">        --spring.datasource.url=jdbc:mysql://xxx.xx.xx.xxx:3306/xxl_job?useUnicode=true&amp;characterEncoding=UTF-8&amp;autoReconnect=true&amp;serverTimezone=Asia/Shanghai \</span><br><span class="line">        --spring.datasource.username=root \</span><br><span class="line">        --spring.datasource.password=Wing1Q2W#E&quot; \</span><br><span class="line">        --name xxl-job-admin  \</span><br><span class="line">xuxueli/xxl-job-admin:2.4.0</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨docker pså‘½ä»¤å¯ä»¥æŸ¥çœ‹æ˜¯å¦è¿è¡ŒæˆåŠŸã€‚</p><h3 id="å¸¸è§„æ­å»º"><a href="#å¸¸è§„æ­å»º" class="headerlink" title="å¸¸è§„æ­å»º"></a>å¸¸è§„æ­å»º</h3><ol><li><p>ä¸‹è½½é¡¹ç›®å¹¶è§£å‹ï¼Œæ‰§è¡Œæ•°æ®åº“åˆå§‹åŒ–SQLè„šæœ¬ï¼ˆåœ¨doc&#x2F;dbç›®å½•ä¸‹ï¼‰ï¼Œæ ¹æ®æ•°æ®åº“è„šæœ¬åˆ›å»ºæ•°æ®åº“ï¼Œæœ‰ä»¥ä¸‹å…«å¼ è¡¨ï¼ˆMySQLé…ç½®ï¼š<a href="https://blog.csdn.net/weixin_47406082/article/details/131867849?ops_request_misc=%7B%22request_id%22:%22172455767816800226561928%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172455767816800226561928&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-2-131867849-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=MYSQL%E5%AE%89%E8%A3%85&spm=1018.2226.3001.4187">Mysqlè¶…è¯¦ç»†å®‰è£…é…ç½®æ•™ç¨‹(ä¿å§†çº§)_mysqlå®‰è£…åŠé…ç½®è¶…è¯¦ç»†æ•™ç¨‹-CSDNåšå®¢</a>ï¼‰ï¼ˆnavicat:<a href="https://blog.csdn.net/weixin_50670076/article/details/136350060?ops_request_misc=%7B%22request_id%22:%22172455932816800207023974%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172455932816800207023974&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-136350060-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=navicat&spm=1018.2226.3001.4187">Navicat16\17å®‰è£…å’Œæ¿€æ´»è¯¦ç»†è®²è§£ï¼ˆå…¨ç½‘æœ€ç®€å•ä¸”é è°±ï¼‰_navicat 16-CSDNåšå®¢</a>ï¼‰</p><p><img src="https://s2.loli.net/2024/08/25/1uCKvHfTnWPLipR.png" alt="image-20240825111113486.png"></p><ul><li><strong>xxl_job_lockï¼š</strong>ä»»åŠ¡è°ƒåº¦é”è¡¨ï¼›</li><li><strong>xxl_job_groupï¼š</strong>æ‰§è¡Œå™¨ä¿¡æ¯è¡¨ï¼Œç»´æŠ¤ä»»åŠ¡æ‰§è¡Œå™¨ä¿¡æ¯ï¼›</li><li><strong>xxl_job_infoï¼š</strong>è°ƒåº¦æ‰©å±•ä¿¡æ¯è¡¨ï¼š ç”¨äºä¿å­˜XXL-JOBè°ƒåº¦ä»»åŠ¡çš„æ‰©å±•ä¿¡æ¯ï¼Œå¦‚ä»»åŠ¡åˆ†ç»„ã€ä»»åŠ¡åã€æœºå™¨åœ°å€ã€æ‰§è¡Œå™¨ã€æ‰§è¡Œå…¥å‚å’ŒæŠ¥è­¦é‚®ä»¶ç­‰ç­‰ï¼›</li><li><strong>xxl_job_logï¼š</strong>è°ƒåº¦æ—¥å¿—è¡¨ï¼š ç”¨äºä¿å­˜XXL-JOBä»»åŠ¡è°ƒåº¦çš„å†å²ä¿¡æ¯ï¼Œå¦‚è°ƒåº¦ç»“æœã€æ‰§è¡Œç»“æœã€è°ƒåº¦å…¥å‚ã€è°ƒåº¦æœºå™¨å’Œæ‰§è¡Œå™¨ç­‰ç­‰ï¼›</li><li><strong>xxl_job_logglueï¼š</strong>ä»»åŠ¡GLUEæ—¥å¿—ï¼šç”¨äºä¿å­˜GLUEæ›´æ–°å†å²ï¼Œç”¨äºæ”¯æŒGLUEçš„ç‰ˆæœ¬å›æº¯åŠŸèƒ½ï¼›</li><li><strong>xxl_job_registry</strong>ï¼šæ‰§è¡Œå™¨æ³¨å†Œè¡¨ï¼Œç»´æŠ¤åœ¨çº¿çš„æ‰§è¡Œå™¨å’Œè°ƒåº¦ä¸­å¿ƒæœºå™¨åœ°å€ä¿¡æ¯ï¼›</li><li><strong>xxl_job_userï¼š</strong>ç³»ç»Ÿç”¨æˆ·è¡¨ï¼›</li></ul><p>æ³¨æ„äº‹é¡¹ï¼š</p><ul><li>è°ƒåº¦ä¸­å¿ƒï¼ˆå³xxl-jobï¼‰æ”¯æŒé›†ç¾¤éƒ¨ç½²ï¼Œé›†ç¾¤æƒ…å†µä¸‹å„èŠ‚ç‚¹åŠ¡å¿…è¿æ¥åŒä¸€ä¸ªmysqlå®ä¾‹;</li><li>å¦‚æœmysqlåšä¸»ä»,è°ƒåº¦ä¸­å¿ƒé›†ç¾¤èŠ‚ç‚¹åŠ¡å¿…å¼ºåˆ¶èµ°ä¸»åº“;</li><li>é»˜è®¤è´¦å·å¯†ç ï¼šadmin&#x2F;123456</li></ul></li><li><p>éƒ¨ç½²é…ç½®è°ƒåº¦ä¸­å¿ƒ</p><ul><li><p>è°ƒåº¦ä¸­å¿ƒé¡¹ç›®ï¼šxxl-job-admin</p></li><li><p>ä½œç”¨ï¼šç»Ÿä¸€ç®¡ç†ä»»åŠ¡è°ƒåº¦å¹³å°ä¸Šè°ƒåº¦ä»»åŠ¡ï¼Œè´Ÿè´£è§¦å‘è°ƒåº¦æ‰§è¡Œï¼Œå¹¶ä¸”æä¾›ä»»åŠ¡ç®¡ç†å¹³å°ã€‚</p></li><li><p>è°ƒåº¦ä¸­å¿ƒé…ç½®æ–‡ä»¶åœ°å€ï¼š&#x2F;xxl-job&#x2F;xxl-job-admin&#x2F;src&#x2F;main&#x2F;resources&#x2F;application.properties</p><p><img src="https://s2.loli.net/2024/08/25/MlOS5o38knEebrQ.png" alt="image-20240825133654385.png"></p><p>å¦‚å›¾æ‰€ç¤ºï¼Œè¿™é‡Œé…ç½®çš„æœ‰å¯¹åº”çš„æ•°æ®åº“çš„åœ°å€ã€ç”¨æˆ·åå’Œå¯†ç ç­‰å†…å®¹ã€‚</p></li></ul></li><li><p>å¯åŠ¨xxl-job</p><p>å¯åŠ¨æˆåŠŸï¼Œè®¿é—®<strong><a href="http://localhost:8080/xxl-job-admin/**%EF%BC%8C%E9%BB%98%E8%AE%A4%E7%99%BB%E5%BD%95%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81">http://localhost:8080/xxl-job-admin/**ï¼Œé»˜è®¤ç™»å½•è´¦å·å¯†ç </a> â€œ**admin&#x2F;123456</strong>â€, ç™»å½•åè¿è¡Œç•Œé¢å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="https://s2.loli.net/2024/08/25/nzdXia3VHRfDNvL.png" alt="image-20240825133630704.png"></p></li></ol><h2 id="æ¡ˆä¾‹ä½¿ç”¨-pku-serviceï¼Œè¿›è¡Œæ¥å…¥"><a href="#æ¡ˆä¾‹ä½¿ç”¨-pku-serviceï¼Œè¿›è¡Œæ¥å…¥" class="headerlink" title="æ¡ˆä¾‹ä½¿ç”¨(pku-serviceï¼Œè¿›è¡Œæ¥å…¥)"></a>æ¡ˆä¾‹ä½¿ç”¨(pku-serviceï¼Œè¿›è¡Œæ¥å…¥)</h2><p>å‰ç½®æ¡ä»¶ï¼šxxl-jobçš„æœåŠ¡ç«¯å·²ç»èµ·å¥½ã€‚</p><p>ç›®å½•ç»“æ„ï¼ˆéœ€è¦ä»xxl-jobçš„é¡¹ç›®ä¸­å°†xxl-job-executor-sample-springbootç›®å½•copyå‡ºæ¥ï¼‰ï¼š</p><p><img src="https://s2.loli.net/2024/08/25/TK1eRXJpIgALwt6.png" alt="image-20240825145410259.png"></p><ol><li><p><strong>javaè¿æ¥xxl-job</strong></p><p><strong>æ·»åŠ ä¾èµ–</strong>mavenï¼ˆpom.xmlï¼‰</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--xxl-job--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.xuxueli<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xxl-job-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>yamlæ–‡ä»¶æ·»åŠ </strong>(æˆ–è€…ç›´æ¥application.propertiesä¹Ÿè¡Œ)</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">xxl:</span></span><br><span class="line">  <span class="attr">job:</span></span><br><span class="line">    <span class="attr">admin:</span></span><br><span class="line">      <span class="attr">addresses:</span> <span class="string">http://*******:8080/xxl-job-admin/</span>  <span class="comment">#**** æ›´æ¢æœåŠ¡å™¨åœ°å€  </span></span><br><span class="line">    <span class="attr">executor:</span></span><br><span class="line">      <span class="attr">appname:</span> <span class="string">pku-service</span>         <span class="comment">#æ‰§è¡Œå™¨åå­—</span></span><br><span class="line">      <span class="attr">address:</span></span><br><span class="line">      <span class="attr">ip:</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">9999</span></span><br><span class="line">      <span class="attr">logpath:</span> <span class="string">/data/applogs/xxl-job-jobhandler</span></span><br><span class="line">      <span class="attr">logretentiondays:</span> <span class="number">30</span></span><br><span class="line">    <span class="attr">accessToken:</span> <span class="string">default_token</span></span><br></pre></td></tr></table></figure></li><li><p><strong>é…ç½®xxl-jobçš„æ‰§è¡Œå™¨</strong></p><ul><li><p>å°†ç¤ºä¾‹å·¥ç¨‹ä¸‹çš„é…ç½®ç±»æ‹·è´åˆ°pku-serviceå·¥ç¨‹ä¸‹ï¼Œè¯¥ç±»ä¸­çš„å±æ€§å°±æ˜¯è·å–é…ç½®æ–‡ä»¶ä¸­çš„é…ç½®å¾—åˆ°çš„ï¼ŒåŒæ—¶æä¾›äº†ä¸€ä¸ªæ‰§è¡Œå™¨çš„Bean</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.xxl.job.core.executor.impl.XxlJobSpringExecutor;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.logging.Logger;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">XxlJobConfig</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> (Logger) LoggerFactory.getLogger(XxlJobConfig.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;xxl.job.admin.addresses&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String adminAddresses;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;xxl.job.accessToken&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String accessToken;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;xxl.job.executor.appname&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String appname;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;xxl.job.executor.address&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;xxl.job.executor.ip&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String ip;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;xxl.job.executor.port&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> port;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;xxl.job.executor.logpath&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String logPath;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;xxl.job.executor.logretentiondays&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> logRetentionDays;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> XxlJobSpringExecutor <span class="title function_">xxlJobExecutor</span><span class="params">()</span> &#123;</span><br><span class="line">        logger.info(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job config init.&quot;</span>);</span><br><span class="line">        <span class="type">XxlJobSpringExecutor</span> <span class="variable">xxlJobSpringExecutor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XxlJobSpringExecutor</span>();</span><br><span class="line">        xxlJobSpringExecutor.setAdminAddresses(adminAddresses);</span><br><span class="line">        xxlJobSpringExecutor.setAppname(appname);</span><br><span class="line">        xxlJobSpringExecutor.setAddress(address);</span><br><span class="line">        xxlJobSpringExecutor.setIp(ip);</span><br><span class="line">        xxlJobSpringExecutor.setPort(port);</span><br><span class="line">        xxlJobSpringExecutor.setAccessToken(accessToken);</span><br><span class="line">        xxlJobSpringExecutor.setLogPath(logPath);</span><br><span class="line">        xxlJobSpringExecutor.setLogRetentionDays(logRetentionDays);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> xxlJobSpringExecutor;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é’ˆå¯¹å¤šç½‘å¡ã€å®¹å™¨å†…éƒ¨ç½²ç­‰æƒ…å†µï¼Œå¯å€ŸåŠ© &quot;spring-cloud-commons&quot; æä¾›çš„ &quot;InetUtils&quot; ç»„ä»¶çµæ´»å®šåˆ¶æ³¨å†ŒIPï¼›</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *      1ã€å¼•å…¥ä¾èµ–ï¼š</span></span><br><span class="line"><span class="comment">     *          &lt;dependency&gt;</span></span><br><span class="line"><span class="comment">     *             &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;</span></span><br><span class="line"><span class="comment">     *             &lt;artifactId&gt;spring-cloud-commons&lt;/artifactId&gt;</span></span><br><span class="line"><span class="comment">     *             &lt;version&gt;$&#123;version&#125;&lt;/version&gt;</span></span><br><span class="line"><span class="comment">     *         &lt;/dependency&gt;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *      2ã€é…ç½®æ–‡ä»¶ï¼Œæˆ–è€…å®¹å™¨å¯åŠ¨å˜é‡</span></span><br><span class="line"><span class="comment">     *          spring.cloud.inetutils.preferred-networks: &#x27;xxx.xxx.xxx.&#x27;</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     *      3ã€è·å–IP</span></span><br><span class="line"><span class="comment">     *          String ip_ = inetUtils.findFirstNonLoopbackHostInfo().getIpAddress();</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul></li><li><p>ç¼–å†™æ‰§è¡Œå™¨ä»£ç ï¼ˆSampleXxlJob.javaï¼‰</p><p>æ³¨æ„è¿™é‡Œçš„jobHandlerçš„åç§°è¦åŒ¹é…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 1ã€ç®€å•ä»»åŠ¡ç¤ºä¾‹ï¼ˆBeanæ¨¡å¼ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@XxlJob(&quot;PKUJobHandler&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">demoJobHandler</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        XxlJobHelper.log(<span class="string">&quot;XXL-JOB, Hello World.&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;XXL-JOB, Hello World.&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">            XxlJobHelper.log(<span class="string">&quot;beat at:&quot;</span> + i);</span><br><span class="line">            TimeUnit.SECONDS.sleep(<span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// default success</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>æ–°å¢æ‰§è¡Œå™¨</strong></p><p><img src="https://s2.loli.net/2024/08/25/pe5PfDoUkBvqQ38.png" alt="image-20240825134502190.png"></p><p><img src="https://s2.loli.net/2024/08/25/CAtXTZEYodl32Up.png" alt="image-20240825135245256.png"></p><table><thead><tr><th>å±æ€§åç§°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>AppName</td><td>æ˜¯æ¯ä¸ªæ‰§è¡Œå™¨é›†ç¾¤çš„å”¯ä¸€æ ‡ç¤ºAppName, æ‰§è¡Œå™¨ä¼šå‘¨æœŸæ€§ä»¥AppNameä¸ºå¯¹è±¡è¿›è¡Œè‡ªåŠ¨æ³¨å†Œã€‚å¯é€šè¿‡è¯¥é…ç½®è‡ªåŠ¨å‘ç°æ³¨å†ŒæˆåŠŸçš„æ‰§è¡Œå™¨, ä¾›ä»»åŠ¡è°ƒåº¦æ—¶ä½¿ç”¨;</td></tr><tr><td>åç§°</td><td>æ‰§è¡Œå™¨çš„åç§°, å› ä¸ºAppNameé™åˆ¶å­—æ¯æ•°å­—ç­‰ç»„æˆ,å¯è¯»æ€§ä¸å¼º, åç§°ä¸ºäº†æé«˜æ‰§è¡Œå™¨çš„å¯è¯»æ€§;</td></tr><tr><td>æ’åº</td><td>æ‰§è¡Œå™¨çš„æ’åº, ç³»ç»Ÿä¸­éœ€è¦æ‰§è¡Œå™¨çš„åœ°æ–¹,å¦‚ä»»åŠ¡æ–°å¢, å°†ä¼šæŒ‰ç…§è¯¥æ’åºè¯»å–å¯ç”¨çš„æ‰§è¡Œå™¨åˆ—è¡¨;</td></tr><tr><td>æ³¨å†Œæ–¹å¼</td><td>è°ƒåº¦ä¸­å¿ƒè·å–æ‰§è¡Œå™¨åœ°å€çš„æ–¹å¼ï¼›</td></tr><tr><td>æœºå™¨åœ°å€</td><td>æ³¨å†Œæ–¹å¼ä¸ºâ€æ‰‹åŠ¨å½•å…¥â€æ—¶æœ‰æ•ˆï¼Œæ”¯æŒäººå·¥ç»´æŠ¤æ‰§è¡Œå™¨çš„åœ°å€ä¿¡æ¯ï¼›</td></tr></tbody></table></li><li><p>åˆ›å»ºä»»åŠ¡</p><p>ç™»å½•è°ƒåº¦ä¸­å¿ƒï¼Œç‚¹å‡»ä¸‹å›¾æ‰€ç¤ºâ€œæ–°å»ºä»»åŠ¡â€æŒ‰é’®ï¼Œæ–°å»ºç¤ºä¾‹ä»»åŠ¡ï¼š</p><p><img src="https://s2.loli.net/2024/08/25/xGND9ycV3aznuvF.png" alt="image-20240825150227329.png"></p><p>æ³¨æ„è¿™é‡Œçš„JobHandlerçš„åç§°è¦åŒ¹é…ã€‚</p><p><strong>åŸºç¡€é…ç½®ï¼š</strong></p><ul><li>æ‰§è¡Œå™¨ï¼šæ¯ä¸ªä»»åŠ¡å¿…é¡»ç»‘å®šä¸€ä¸ªæ‰§è¡Œå™¨, æ–¹ä¾¿ç»™ä»»åŠ¡è¿›è¡Œåˆ†ç»„</li><li>ä»»åŠ¡æè¿°ï¼šä»»åŠ¡çš„æè¿°ä¿¡æ¯ï¼Œä¾¿äºä»»åŠ¡ç®¡ç†ï¼›</li><li>è´Ÿè´£äººï¼šä»»åŠ¡çš„è´Ÿè´£äººï¼›</li><li>æŠ¥è­¦é‚®ä»¶ï¼šä»»åŠ¡è°ƒåº¦å¤±è´¥æ—¶é‚®ä»¶é€šçŸ¥çš„é‚®ç®±åœ°å€ï¼Œæ”¯æŒé…ç½®å¤šé‚®ç®±åœ°å€ï¼Œé…ç½®å¤šä¸ªé‚®ç®±åœ°å€æ—¶ç”¨é€—å·åˆ†éš”</li></ul><p><strong>è°ƒåº¦é…ç½®ï¼š</strong></p><ul><li><p>è°ƒåº¦ç±»å‹ï¼š</p><ul><li><p>æ— ï¼šè¯¥ç±»å‹ä¸ä¼šä¸»åŠ¨è§¦å‘è°ƒåº¦ï¼›</p></li><li><p>CRONï¼šè¯¥ç±»å‹å°†ä¼šé€šè¿‡CRONï¼Œè§¦å‘ä»»åŠ¡è°ƒåº¦ï¼›</p></li><li><p>å›ºå®šé€Ÿåº¦ï¼šè¯¥ç±»å‹å°†ä¼šä»¥å›ºå®šé€Ÿåº¦ï¼Œè§¦å‘ä»»åŠ¡è°ƒåº¦ï¼›æŒ‰ç…§å›ºå®šçš„é—´éš”æ—¶é—´ï¼Œå‘¨æœŸæ€§è§¦å‘ï¼›</p></li></ul></li></ul><p><strong>ä»»åŠ¡é…ç½®ï¼š</strong></p><ul><li>è¿è¡Œæ¨¡å¼ï¼š<ul><li>BEANæ¨¡å¼ï¼šä»»åŠ¡ä»¥JobHandleræ–¹å¼ç»´æŠ¤åœ¨æ‰§è¡Œå™¨ç«¯ï¼›éœ€è¦ç»“åˆ â€œJobHandlerâ€ å±æ€§åŒ¹é…æ‰§è¡Œå™¨ä¸­ä»»åŠ¡ï¼›</li></ul></li><li>JobHandlerï¼šè¿è¡Œæ¨¡å¼ä¸º â€œBEANæ¨¡å¼â€ æ—¶ç”Ÿæ•ˆï¼Œå¯¹åº”æ‰§è¡Œå™¨ä¸­æ–°å¼€å‘çš„JobHandlerç±»â€œ@JobHandlerâ€æ³¨è§£è‡ªå®šä¹‰çš„valueå€¼ï¼›</li><li>ä»»åŠ¡å‚æ•°ï¼šä»»åŠ¡æ‰§è¡Œæ‰€éœ€çš„å‚æ•°ï¼›</li></ul><p><strong>é«˜çº§é…ç½®</strong>ï¼š</p><ul><li><p><strong>é˜»å¡å¤„ç†ç­–ç•¥ï¼š</strong></p><ul><li>é˜»å¡å¤„ç†ç­–ç•¥ï¼šè°ƒåº¦è¿‡äºå¯†é›†æ‰§è¡Œå™¨æ¥ä¸åŠå¤„ç†æ—¶çš„å¤„ç†ç­–ç•¥ï¼›</li><li>å•æœºä¸²è¡Œï¼ˆé»˜è®¤ï¼‰ï¼šè°ƒåº¦è¯·æ±‚è¿›å…¥å•æœºæ‰§è¡Œå™¨åï¼Œè°ƒåº¦è¯·æ±‚è¿›å…¥FIFO(First Input First Output)é˜Ÿåˆ—å¹¶ä»¥ä¸²è¡Œæ–¹å¼è¿è¡Œï¼›</li><li>ä¸¢å¼ƒåç»­è°ƒåº¦ï¼šè°ƒåº¦è¯·æ±‚è¿›å…¥å•æœºæ‰§è¡Œå™¨åï¼Œå‘ç°æ‰§è¡Œå™¨å­˜åœ¨è¿è¡Œçš„è°ƒåº¦ä»»åŠ¡ï¼Œæœ¬æ¬¡è¯·æ±‚å°†ä¼šè¢«ä¸¢å¼ƒå¹¶æ ‡è®°ä¸ºå¤±è´¥ï¼›</li><li>è¦†ç›–ä¹‹å‰è°ƒåº¦ï¼šè°ƒåº¦è¯·æ±‚è¿›å…¥å•æœºæ‰§è¡Œå™¨åï¼Œå‘ç°æ‰§è¡Œå™¨å­˜åœ¨è¿è¡Œçš„è°ƒåº¦ä»»åŠ¡ï¼Œå°†ä¼šç»ˆæ­¢è¿è¡Œä¸­çš„è°ƒåº¦ä»»åŠ¡å¹¶æ¸…ç©ºé˜Ÿåˆ—ï¼Œç„¶åè¿è¡Œæœ¬åœ°è°ƒåº¦ä»»åŠ¡ï¼›</li></ul></li><li><p><strong>è·¯ç”±ç­–ç•¥ï¼š</strong></p><p>å½“æ‰§è¡Œå™¨é›†ç¾¤éƒ¨ç½²æ—¶ï¼Œæä¾›ä¸°å¯Œçš„è·¯ç”±ç­–ç•¥ï¼ŒåŒ…æ‹¬ï¼›</p><ul><li>FIRSTï¼ˆç¬¬ä¸€ä¸ªï¼‰ï¼šå›ºå®šé€‰æ‹©ç¬¬ä¸€ä¸ªæœºå™¨ï¼›</li><li>LASTï¼ˆæœ€åä¸€ä¸ªï¼‰ï¼šå›ºå®šé€‰æ‹©æœ€åä¸€ä¸ªæœºå™¨ï¼›</li><li>ROUNDï¼ˆè½®è¯¢ï¼‰</li><li>RANDOMï¼ˆéšæœºï¼‰ï¼šéšæœºé€‰æ‹©åœ¨çº¿çš„æœºå™¨ï¼›</li><li>CONSISTENT_HASHï¼ˆä¸€è‡´æ€§HASHï¼‰ï¼šæ¯ä¸ªä»»åŠ¡æŒ‰ç…§Hashç®—æ³•å›ºå®šé€‰æ‹©æŸä¸€å°æœºå™¨ï¼Œä¸”æ‰€æœ‰ä»»åŠ¡å‡åŒ€æ•£åˆ—åœ¨ä¸åŒæœºå™¨ä¸Šã€‚</li><li>LEAST_FREQUENTLY_USEDï¼ˆæœ€ä¸ç»å¸¸ä½¿ç”¨ï¼‰ï¼šä½¿ç”¨é¢‘ç‡æœ€ä½çš„æœºå™¨ä¼˜å…ˆè¢«é€‰ä¸¾ï¼›</li><li>LEAST_RECENTLY_USEDï¼ˆæœ€è¿‘æœ€ä¹…æœªä½¿ç”¨ï¼‰ï¼šæœ€ä¹…æœªä½¿ç”¨çš„æœºå™¨ä¼˜å…ˆè¢«é€‰ä¸¾ï¼›</li><li>FAILOVERï¼ˆæ•…éšœè½¬ç§»ï¼‰ï¼šæŒ‰ç…§é¡ºåºä¾æ¬¡è¿›è¡Œå¿ƒè·³æ£€æµ‹ï¼Œç¬¬ä¸€ä¸ªå¿ƒè·³æ£€æµ‹æˆåŠŸçš„æœºå™¨é€‰å®šä¸ºç›®æ ‡æ‰§è¡Œå™¨å¹¶å‘èµ·è°ƒåº¦ï¼›</li><li>BUSYOVERï¼ˆå¿™ç¢Œè½¬ç§»ï¼‰ï¼šæŒ‰ç…§é¡ºåºä¾æ¬¡è¿›è¡Œç©ºé—²æ£€æµ‹ï¼Œç¬¬ä¸€ä¸ªç©ºé—²æ£€æµ‹æˆåŠŸçš„æœºå™¨é€‰å®šä¸ºç›®æ ‡æ‰§è¡Œå™¨å¹¶å‘èµ·è°ƒåº¦ï¼›</li><li>SHARDING_BROADCAST(åˆ†ç‰‡å¹¿æ’­)ï¼šå¹¿æ’­è§¦å‘å¯¹åº”é›†ç¾¤ä¸­æ‰€æœ‰æœºå™¨æ‰§è¡Œä¸€æ¬¡ä»»åŠ¡ï¼ŒåŒæ—¶ç³»ç»Ÿè‡ªåŠ¨ä¼ é€’åˆ†ç‰‡å‚æ•°ï¼›å¯æ ¹æ®åˆ†ç‰‡å‚æ•°å¼€å‘åˆ†ç‰‡ä»»åŠ¡ï¼›</li></ul></li></ul></li><li><p>å¯åŠ¨JobExecutorApplication</p><p><img src="https://s2.loli.net/2024/08/25/dGneOK7hab5pNtI.png" alt="image-20240825150957492.png"></p><p>è¿™é‡Œå·²ç»èƒ½å¤ŸæˆåŠŸè°ƒåº¦äº†ã€‚åŒæ—¶æ³¨æ„åˆ°æ‰§è¡Œå™¨è¿™é‡Œå·²ç»è‡ªåŠ¨æ³¨å†Œä¸Šäº†ï¼š</p><p><img src="https://s2.loli.net/2024/08/25/gDEbZwI95W3xmuJ.png" alt="image-20240825151112157.png"></p></li></ol><h2 id="è¡¥å……ï¼šæ‰§è¡Œå™¨å’Œjobhandlerçš„åŒºåˆ«"><a href="#è¡¥å……ï¼šæ‰§è¡Œå™¨å’Œjobhandlerçš„åŒºåˆ«" class="headerlink" title="è¡¥å……ï¼šæ‰§è¡Œå™¨å’Œjobhandlerçš„åŒºåˆ«"></a>è¡¥å……ï¼šæ‰§è¡Œå™¨å’Œjobhandlerçš„åŒºåˆ«</h2><p><img src="https://s2.loli.net/2024/08/25/O6C7zl8WNDEnrd2.png" alt="image-20240825111406289.png"></p><p>XXL-JOBæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å°ï¼Œå®ƒå…·æœ‰ç®€å•æ˜“ç”¨ã€è½»é‡çº§å’Œæ˜“æ‰©å±•çš„ç‰¹ç‚¹ã€‚åœ¨XXL-JOBä¸­ï¼Œæ‰§è¡Œå™¨ï¼ˆExecutorï¼‰å’Œä»»åŠ¡å¤„ç†å™¨ï¼ˆJobHandlerï¼‰æ˜¯ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ï¼Œå®ƒä»¬å…±åŒåä½œæ¥å®Œæˆå®šæ—¶ä»»åŠ¡çš„æ‰§è¡Œã€‚</p><p>æ‰§è¡Œå™¨æ˜¯ä»»åŠ¡çš„å®é™…æ‰§è¡Œè€…ï¼Œå¯ä»¥ç†è§£ä¸ºæ‰¿è½½ä»»åŠ¡çš„å…·ä½“æœåŠ¡å®ä¾‹ã€‚æ¯ä¸ªæ‰§è¡Œå™¨æœ‰è‡ªå·±ç‹¬ç‰¹çš„åç§°ï¼Œé€šå¸¸è®¾ç½®ä¸ºæœåŠ¡åä»¥æ–¹ä¾¿è¯†åˆ«ã€‚æ‰§è¡Œå™¨çš„ä¸»è¦èŒè´£æ˜¯æ¥æ”¶æ¥è‡ªè°ƒåº¦ä¸­å¿ƒçš„è°ƒåº¦è¯·æ±‚ï¼Œå¹¶æ‰§è¡Œç›¸åº”çš„ä»»åŠ¡é€»è¾‘ã€‚æ‰§è¡Œå™¨æ”¯æŒé›†ç¾¤éƒ¨ç½²ï¼Œä»¥å®ç°ä»»åŠ¡çš„é«˜å¯ç”¨æ€§å’Œè´Ÿè½½å‡è¡¡  ã€‚</p><p>JobHandleråˆ™æ˜¯ä»»åŠ¡çš„æŠ½è±¡è¡¨ç¤ºï¼Œå®ƒè´Ÿè´£ç¼–å†™å’Œå¤„ç†å…·ä½“çš„ä»»åŠ¡ä»£ç ã€‚å¼€å‘è€…éœ€è¦å®ç°JobHandleræ¥å£ä¸­çš„<code>execute</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ˜¯ä»»åŠ¡æ‰§è¡Œçš„å…¥å£ç‚¹ã€‚åœ¨æ‰§è¡Œå™¨å¯åŠ¨æ—¶ï¼Œä¼šåˆå§‹åŒ–JobHandlerå¹¶å°†å®ƒä»¬æ³¨å†Œåˆ°æ‰§è¡Œå™¨çš„å®¹å™¨ä¸­ï¼Œä»¥ä¾¿åœ¨æ¥æ”¶åˆ°è°ƒåº¦è¯·æ±‚æ—¶èƒ½å¤Ÿæ‰¾åˆ°å¹¶æ‰§è¡Œç›¸åº”çš„ä»»åŠ¡é€»è¾‘  ã€‚</p><p>åœ¨XXL-JOBçš„æ¶æ„ä¸­ï¼Œâ€è°ƒåº¦ä¸­å¿ƒâ€è´Ÿè´£ç®¡ç†è°ƒåº¦ä¿¡æ¯å¹¶å‘å‡ºè°ƒåº¦è¯·æ±‚ï¼Œè€Œâ€æ‰§è¡Œå™¨â€åˆ™è´Ÿè´£æ¥æ”¶è¿™äº›è¯·æ±‚å¹¶æ‰§è¡ŒJobHandlerä¸­çš„ä¸šåŠ¡é€»è¾‘ã€‚è¿™ç§è®¾è®¡ä½¿å¾—è°ƒåº¦å’Œä»»åŠ¡å¯ä»¥ç›¸äº’è§£è€¦ï¼Œæé«˜äº†ç³»ç»Ÿæ•´ä½“çš„ç¨³å®šæ€§å’Œæ‰©å±•æ€§  ã€‚</p><p>æ€»ç»“æ¥è¯´ï¼Œæ‰§è¡Œå™¨å’ŒJobHandleråœ¨XXL-JOBä¸­çš„åŒºåˆ«ä¸»è¦åœ¨äºï¼š</p><ul><li>æ‰§è¡Œå™¨ï¼ˆExecutorï¼‰ï¼šä»»åŠ¡çš„å®é™…æ‰§è¡Œè€…ï¼Œæ¥æ”¶è°ƒåº¦è¯·æ±‚å¹¶æ‰§è¡Œä»»åŠ¡ã€‚</li><li>ä»»åŠ¡å¤„ç†å™¨ï¼ˆJobHandlerï¼‰ï¼šä»»åŠ¡çš„æŠ½è±¡ï¼ŒåŒ…å«å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œç”±æ‰§è¡Œå™¨æ‰§è¡Œã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> åç«¯ </tag>
            
            <tag> å¾®æœåŠ¡ </tag>
            
            <tag> åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaåå°„ï¼šè·å–ç±»å­—æ®µï¼ˆgetDeclaredFields()ï¼‰</title>
      <link href="/2024/08/17/2024-08-17-Java%E5%8F%8D%E5%B0%84%EF%BC%9A%E8%8E%B7%E5%8F%96%E7%B1%BB%E5%AD%97%E6%AE%B5%EF%BC%88getDeclaredFields()%EF%BC%89/"/>
      <url>/2024/08/17/2024-08-17-Java%E5%8F%8D%E5%B0%84%EF%BC%9A%E8%8E%B7%E5%8F%96%E7%B1%BB%E5%AD%97%E6%AE%B5%EF%BC%88getDeclaredFields()%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<h1 id="Javaåå°„ï¼šè·å–ç±»å­—æ®µgetFields-æ–¹æ³•å’ŒgetDeclaredFields-æ–¹æ³•"><a href="#Javaåå°„ï¼šè·å–ç±»å­—æ®µgetFields-æ–¹æ³•å’ŒgetDeclaredFields-æ–¹æ³•" class="headerlink" title="Javaåå°„ï¼šè·å–ç±»å­—æ®µgetFields()æ–¹æ³•å’ŒgetDeclaredFields ()æ–¹æ³•"></a>Javaåå°„ï¼šè·å–ç±»å­—æ®µgetFields()æ–¹æ³•å’ŒgetDeclaredFields ()æ–¹æ³•</h1><h2 id="1-æ¦‚å¿µ"><a href="#1-æ¦‚å¿µ" class="headerlink" title="1. æ¦‚å¿µ"></a>1. æ¦‚å¿µ</h2><p>åå°„æ˜¯Javaä¸­ä¸€ç§å¼ºå¤§çš„æœºåˆ¶ï¼Œå…è®¸åœ¨è¿è¡Œæ—¶è·å–ã€æ£€æŸ¥å’Œæ“ä½œç±»ã€æ–¹æ³•ã€å­—æ®µç­‰ä¿¡æ¯ï¼Œè€Œä¸éœ€è¦åœ¨ç¼–è¯‘æ—¶çŸ¥é“è¿™äº›ä¿¡æ¯ã€‚</p><p>å…¶ä¸­å­—æ®µï¼ˆFieldï¼‰åœ¨Javaä¸­æ˜¯ç±»ä¸­ç”¨äºå­˜å‚¨æ•°æ®çš„æˆå‘˜å˜é‡ã€‚åœ¨åå°„ä¸­ï¼Œå¯ä»¥é€šè¿‡Fieldç±»è·å–å’Œæ“ä½œç±»çš„å­—æ®µã€‚</p><ul><li><p><code>getFields()</code>ï¼š è¯¥æ–¹æ³•ç”¨äºè·å–æŸä¸ªç±»åŠå…¶çˆ¶ç±»ä¸­æ‰€æœ‰çš„å…¬æœ‰å­—æ®µã€‚å…¬æœ‰å­—æ®µæ˜¯æŒ‡ç”¨publicä¿®é¥°çš„å­—æ®µã€‚</p><p>è¿™ä¸ªæ–¹æ³•å¯¹äºéœ€è¦è·å–ç±»çš„å…¬æœ‰å±æ€§æ—¶å¾ˆæœ‰ç”¨ï¼Œä¾‹å¦‚åœ¨æŸäº›æ¡†æ¶æˆ–é€šç”¨åº“ä¸­ã€‚</p></li><li><p><code>getDeclaredFields()</code>ï¼š è¯¥æ–¹æ³•ç”¨äºè·å–æŸä¸ªç±»ä¸­å£°æ˜çš„æ‰€æœ‰å­—æ®µï¼ŒåŒ…æ‹¬å…¬æœ‰ã€ç§æœ‰ã€å—ä¿æŠ¤çš„å­—æ®µï¼Œä½†ä¸åŒ…æ‹¬ç»§æ‰¿çš„å­—æ®µã€‚</p><p>è¿™ä¸ªæ–¹æ³•å¯¹äºéœ€è¦è·å–ç±»çš„æ‰€æœ‰å­—æ®µæ—¶å¾ˆæœ‰ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨è¿›è¡Œä¸€äº›é«˜çº§çš„æ“ä½œæ—¶ã€‚</p></li></ul><p><img src="C:\Users\11505\AppData\Roaming\Typora\typora-user-images\image-20240817170953470.png" alt="image-20240817170953470"></p><h2 id="2-getFields"><a href="#2-getFields" class="headerlink" title="2. getFields()"></a>2. getFields()</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GetFieldsTest1</span> &#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> number;</span><br><span class="line">        <span class="keyword">public</span> String name;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">boolean</span> isAdmin;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Student</span> <span class="keyword">extends</span> <span class="title class_">User</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> String school;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Field[] fields = Student.class.getFields();</span><br><span class="line">        System.out.println(fields.length); <span class="comment">// è¾“å‡ºï¼š3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">            System.out.println(field.getName()); <span class="comment">// è¾“å‡ºï¼šschool, number, name, </span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè·å–äº†è‡ªå·±çš„å­—æ®µå’Œçˆ¶ç±»ä¸­çš„publicå­—æ®µã€‚</p><h2 id="3-getDeclaredFields"><a href="#3-getDeclaredFields" class="headerlink" title="3. getDeclaredFields()"></a>3. getDeclaredFields()</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GetFieldsTest2</span> &#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> number;</span><br><span class="line">        <span class="keyword">public</span> String name;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">boolean</span> isAdmin;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        Field[] fields = User.class.getDeclaredFields();</span><br><span class="line">        System.out.println(fields.length); <span class="comment">// è¾“å‡ºï¼š4</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">            System.out.println(field.getName()); <span class="comment">// è¾“å‡ºï¼šnumber, name, isAdmin, this$0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¿˜æœ‰ä¸ª<code>this$0</code>ã€‚åœ¨Javaä¸­ï¼Œ<code>this$0</code>æ˜¯ä¸€ä¸ªåœ¨åŒ¿åå†…éƒ¨ç±»æˆ–å±€éƒ¨å†…éƒ¨ç±»ä¸­ä½¿ç”¨çš„ç‰¹æ®Šçš„å¼•ç”¨å˜é‡ã€‚å®ƒæŒ‡å‘å¤–éƒ¨ç±»çš„ä¸€ä¸ªå®ä¾‹ï¼Œå³å†…éƒ¨ç±»è¢«åˆ›å»ºçš„é‚£ä¸ªå¤–éƒ¨ç±»çš„å®ä¾‹ã€‚</p><h2 id="4-Fieldçš„ä¸€äº›æ–¹æ³•"><a href="#4-Fieldçš„ä¸€äº›æ–¹æ³•" class="headerlink" title="4. Fieldçš„ä¸€äº›æ–¹æ³•"></a>4. Fieldçš„ä¸€äº›æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ–¹æ³•:get(Object obj) è¿”å›æŒ‡å®šå¯¹è±¡objä¸Šæ­¤ Field è¡¨ç¤ºçš„å­—æ®µçš„å€¼</span></span><br><span class="line"></span><br><span class="line">field.get(obj)</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ–¹æ³•: set(Object obj, Object value)  å°†æŒ‡å®šå¯¹è±¡å˜é‡ä¸Šæ­¤ Field å¯¹è±¡è¡¨ç¤ºçš„å­—æ®µè®¾ç½®ä¸ºæŒ‡å®šçš„æ–°å€¼</span></span><br><span class="line"></span><br><span class="line">field.set(obj,value)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> åå°„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaä½¿ç”¨ESæ¡ä»¶æ„é€ å™¨BoolQueryBuilder</title>
      <link href="/2024/08/14/2024-08-14-Java%E4%BD%BF%E7%94%A8ES%E6%9D%A1%E4%BB%B6%E6%9E%84%E9%80%A0%E5%99%A8BoolQueryBuilder/"/>
      <url>/2024/08/14/2024-08-14-Java%E4%BD%BF%E7%94%A8ES%E6%9D%A1%E4%BB%B6%E6%9E%84%E9%80%A0%E5%99%A8BoolQueryBuilder/</url>
      
        <content type="html"><![CDATA[<h1 id="Javaä½¿ç”¨ESæ¡ä»¶æ„é€ å™¨BoolQueryBuilder"><a href="#Javaä½¿ç”¨ESæ¡ä»¶æ„é€ å™¨BoolQueryBuilder" class="headerlink" title="Javaä½¿ç”¨ESæ¡ä»¶æ„é€ å™¨BoolQueryBuilder"></a>Javaä½¿ç”¨ESæ¡ä»¶æ„é€ å™¨BoolQueryBuilder</h1><h2 id="1-æ£€ç´¢å‰æ„é€ "><a href="#1-æ£€ç´¢å‰æ„é€ " class="headerlink" title="1. æ£€ç´¢å‰æ„é€ "></a>1. æ£€ç´¢å‰æ„é€ </h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.æ„å»ºSearchRequestè¯·æ±‚å¯¹è±¡ï¼ŒæŒ‡å®šç´¢å¼•åº“</span></span><br><span class="line"><span class="type">SearchRequest</span> <span class="variable">searchRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SearchRequest</span>(<span class="string">&quot;data_info&quot;</span>);</span><br><span class="line"><span class="comment">//2.æ„å»ºSearchSourceBuilderæŸ¥è¯¢å¯¹è±¡</span></span><br><span class="line"><span class="type">SearchSourceBuilder</span> <span class="variable">sourceBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SearchSourceBuilder</span>();</span><br><span class="line"><span class="comment">//2.1 è¿™ä¸ªæ¡ä»¶ç”¨äºè¿”å›æ‰€æœ‰å‘½ä¸­æ¡ä»¶çš„æ•°æ®æ•°é‡, ä¸è®¾ç½®åˆ™è¿”å›å¤§æ¦‚æ•°å€¼</span></span><br><span class="line">sourceBuilder.trackTotalHits(<span class="literal">true</span>);</span><br><span class="line"><span class="comment">//3.æ£€ç´¢æ¡ä»¶æ„é€ </span></span><br><span class="line"><span class="type">BoolQueryBuilder</span> <span class="variable">bqb</span> <span class="operator">=</span> QueryBuilders.boolQuery();</span><br></pre></td></tr></table></figure><h2 id="2-æ¡ä»¶æ„é€ "><a href="#2-æ¡ä»¶æ„é€ " class="headerlink" title="2. æ¡ä»¶æ„é€ "></a>2. æ¡ä»¶æ„é€ </h2><ul><li>mustå¯ç”¨filterä»£æ›¿ï¼ŒæŸ¥è¯¢æ•ˆç‡ä¼šæ›´é«˜ï¼Œå› ä¸ºmustä¼šå¯¹ç»“æœè¿›è¡Œ_scoreè¯„ä¼°</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//3.1 å®Œå…¨åŒ¹é…</span></span><br><span class="line">bqb.must(QueryBuilders.matchQuery(<span class="string">&quot;code&quot;</span>, <span class="number">666L</span>);</span><br><span class="line">         </span><br><span class="line"><span class="comment">//3.2 æ¨¡ç³ŠåŒ¹é…</span></span><br><span class="line">bqb.must(QueryBuilders.matchPhraseQuery(<span class="string">&quot;name&quot;</span>, <span class="string">&quot;å¼ &quot;</span>);</span><br><span class="line">         </span><br><span class="line"><span class="comment">//3.3 inçš„æ•ˆæœ ä¼ å•ä¸ªå‚æ•°å°±æ˜¯å®Œå…¨åŒ¹é…</span></span><br><span class="line">bqb.must(QueryBuilders.termsQuery(<span class="string">&quot;code&quot;</span>, <span class="keyword">new</span> <span class="title class_">Long</span>[]&#123;<span class="number">1L</span>, <span class="number">2L</span>, <span class="number">3L</span>&#125;);</span><br><span class="line">bqb.must(QueryBuilders.termsQuery(<span class="string">&quot;code&quot;</span>, <span class="number">1L</span>, <span class="number">2L</span>, <span class="number">3L</span>);</span><br><span class="line">         </span><br><span class="line"><span class="comment">//3.4 oræ¡ä»¶</span></span><br><span class="line"><span class="type">BoolQueryBuilder</span> <span class="variable">shouldQuery</span> <span class="operator">=</span> QueryBuilders.boolQuery();</span><br><span class="line">shouldQuery.should(QueryBuilders.matchQuery(<span class="string">&quot;code&quot;</span>, <span class="number">1L</span>);</span><br><span class="line">shouldQuery.should(QueryBuilders.matchQuery(<span class="string">&quot;code&quot;</span>, <span class="number">2L</span>);</span><br><span class="line">shouldQuery.minimumShouldMatch(<span class="number">1</span>); <span class="comment">//è‡³å°‘æ»¡è¶³ä¸€ä¸ª</span></span><br><span class="line">bqb.must(shouldQuery);</span><br><span class="line">                   </span><br><span class="line"><span class="comment">//3.5 énull</span></span><br><span class="line">bqb.must(QueryBuilders.existsQuery(<span class="string">&quot;iden&quot;</span>));</span><br><span class="line"><span class="comment">//æ˜¯null             </span></span><br><span class="line">bqb.mustNot(QueryBuilders.existsQuery(<span class="string">&quot;iden&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.6 å¤§äºç­‰äºgte (gt-å¤§äº lt-å°äº lte-å°äºç­‰äº)</span></span><br><span class="line">bqb.must(QueryBuilders.rangeQuery(<span class="string">&quot;time&quot;</span>).gte(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">         </span><br><span class="line"><span class="comment">//3.7 ä¸­æ–‡å®Œå…¨åŒ¹é…</span></span><br><span class="line">bqb.must(queryBuilder.matchPhraseQuery(<span class="string">&quot;key&quot;</span>, value));</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.8 åŒ¹é…å¤šä¸ªå­—æ®µ</span></span><br><span class="line">bqb.must(queryBuilder.multiMatchQuery(value, key1, key2, key3));</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="3-æ„é€ å®Œæˆè¿›è¡ŒæŸ¥è¯¢"><a href="#3-æ„é€ å®Œæˆè¿›è¡ŒæŸ¥è¯¢" class="headerlink" title="3. æ„é€ å®Œæˆè¿›è¡ŒæŸ¥è¯¢"></a>3. æ„é€ å®Œæˆè¿›è¡ŒæŸ¥è¯¢</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//4.å°†BoolQueryBuilderå¯¹è±¡è®¾ç½®åˆ°SearchSourceBuilderå¯¹è±¡ä¸­</span></span><br><span class="line">sourceBuilder.query(bqb);</span><br><span class="line"><span class="comment">//5.æ’åº</span></span><br><span class="line">sourceBuilder.sort(<span class="string">&quot;updateTime&quot;</span>, SortOrder.DESC);</span><br><span class="line"><span class="comment">//6.åˆ†é¡µ</span></span><br><span class="line">sourceBuilder.from((dto.getPageNum() - <span class="number">1</span>) * dto.getPageSize());</span><br><span class="line">sourceBuilder.size(dto.getPageSize());</span><br><span class="line"></span><br><span class="line"><span class="comment">//7.å°†SearchSourceBuilderè®¾ç½®åˆ°SearchRequestä¸­</span></span><br><span class="line">searchRequest.source(sourceBuilder);</span><br><span class="line"></span><br><span class="line"><span class="comment">//8.è°ƒç”¨æ–¹æ³•æŸ¥è¯¢æ•°æ®</span></span><br><span class="line"><span class="type">SearchResponse</span> <span class="variable">searchResponse</span> <span class="operator">=</span> client.search(searchRequest, RequestOptions.DEFAULT);</span><br><span class="line">         </span><br><span class="line"><span class="comment">//9.è§£æè¿”å›ç»“æœ</span></span><br><span class="line">SearchHit[] hits = searchResponse.getHits().getHits();</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; hits.length; i++) &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;è¿”å›çš„ç»“æœï¼š &quot;</span> + hits[i].getSourceAsString());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">log.info(<span class="string">&quot;è¿”å›æ€»æ•°ä¸ºï¼š&quot;</span> + searchResponse.getHits().getTotalHits());</span><br><span class="line"><span class="type">int</span> <span class="variable">total</span> <span class="operator">=</span> (<span class="type">int</span>)searchResponse.getHits().getTotalHits().value;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> å¾®æœåŠ¡ </tag>
            
            <tag> ElasticSearch </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaå®ç°LRUçš„ä¸¤ç§æ–¹å¼</title>
      <link href="/2024/08/14/2024-08-14-Java%E5%AE%9E%E7%8E%B0LRU%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F/"/>
      <url>/2024/08/14/2024-08-14-Java%E5%AE%9E%E7%8E%B0LRU%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="Javaå®ç°LRUçš„ä¸¤ç§æ–¹å¼"><a href="#Javaå®ç°LRUçš„ä¸¤ç§æ–¹å¼" class="headerlink" title="Javaå®ç°LRUçš„ä¸¤ç§æ–¹å¼"></a>Javaå®ç°LRUçš„ä¸¤ç§æ–¹å¼</h1><h2 id="1-ç›´æ¥ç»§æ‰¿LinkedHashMap"><a href="#1-ç›´æ¥ç»§æ‰¿LinkedHashMap" class="headerlink" title="1. ç›´æ¥ç»§æ‰¿LinkedHashMap"></a>1. ç›´æ¥ç»§æ‰¿<code>LinkedHashMap</code></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LRUCache</span> <span class="keyword">extends</span> <span class="title class_">LinkedHashMap</span>&lt;Integer, Integer&gt;&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> capacity;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LRUCache</span><span class="params">(<span class="type">int</span> capacity)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(capacity, <span class="number">0.75F</span>, <span class="literal">true</span>);</span><br><span class="line">        <span class="built_in">this</span>.capacity = capacity;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">get</span><span class="params">(<span class="type">int</span> key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.getOrDefault(key, -<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(<span class="type">int</span> key, <span class="type">int</span> value)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.put(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">removeEldestEntry</span><span class="params">(Map.Entry&lt;Integer, Integer&gt; eldest)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size() &gt; capacity; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="2-å“ˆå¸Œ-åŒé“¾è¡¨"><a href="#2-å“ˆå¸Œ-åŒé“¾è¡¨" class="headerlink" title="2. å“ˆå¸Œ+åŒé“¾è¡¨"></a>2. å“ˆå¸Œ+åŒé“¾è¡¨</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LRUCache</span> &#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">DLinkedNode</span> &#123;</span><br><span class="line">        <span class="type">int</span> key;</span><br><span class="line">        <span class="type">int</span> value;</span><br><span class="line">        DLinkedNode prev;</span><br><span class="line">        DLinkedNode next;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">DLinkedNode</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">DLinkedNode</span><span class="params">(<span class="type">int</span> _key, <span class="type">int</span> _value)</span> &#123;key = _key; value = _value;&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;Integer, DLinkedNode&gt; cache = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;Integer, DLinkedNode&gt;();</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> capacity;</span><br><span class="line">    <span class="keyword">private</span> DLinkedNode head, tail;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LRUCache</span><span class="params">(<span class="type">int</span> capacity)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.size = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">this</span>.capacity = capacity;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨ä¼ªå¤´éƒ¨å’Œä¼ªå°¾éƒ¨èŠ‚ç‚¹</span></span><br><span class="line">        head = <span class="keyword">new</span> <span class="title class_">DLinkedNode</span>();</span><br><span class="line">        tail = <span class="keyword">new</span> <span class="title class_">DLinkedNode</span>();</span><br><span class="line">        head.next = tail;</span><br><span class="line">        tail.prev = head;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">get</span><span class="params">(<span class="type">int</span> key)</span> &#123;</span><br><span class="line">        <span class="type">DLinkedNode</span> <span class="variable">node</span> <span class="operator">=</span> cache.get(key);</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¦‚æœ key å­˜åœ¨ï¼Œå…ˆé€šè¿‡å“ˆå¸Œè¡¨å®šä½ï¼Œå†ç§»åˆ°å¤´éƒ¨</span></span><br><span class="line">        moveToHead(node);</span><br><span class="line">        <span class="keyword">return</span> node.value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(<span class="type">int</span> key, <span class="type">int</span> value)</span> &#123;</span><br><span class="line">        <span class="type">DLinkedNode</span> <span class="variable">node</span> <span class="operator">=</span> cache.get(key);</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœ key ä¸å­˜åœ¨ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹</span></span><br><span class="line">            <span class="type">DLinkedNode</span> <span class="variable">newNode</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DLinkedNode</span>(key, value);</span><br><span class="line">            <span class="comment">// æ·»åŠ è¿›å“ˆå¸Œè¡¨</span></span><br><span class="line">            cache.put(key, newNode);</span><br><span class="line">            <span class="comment">// æ·»åŠ è‡³åŒå‘é“¾è¡¨çš„å¤´éƒ¨</span></span><br><span class="line">            addToHead(newNode);</span><br><span class="line">            ++size;</span><br><span class="line">            <span class="keyword">if</span> (size &gt; capacity) &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœè¶…å‡ºå®¹é‡ï¼Œåˆ é™¤åŒå‘é“¾è¡¨çš„å°¾éƒ¨èŠ‚ç‚¹</span></span><br><span class="line">                <span class="type">DLinkedNode</span> <span class="variable">tail</span> <span class="operator">=</span> removeTail();</span><br><span class="line">                <span class="comment">// åˆ é™¤å“ˆå¸Œè¡¨ä¸­å¯¹åº”çš„é¡¹</span></span><br><span class="line">                cache.remove(tail.key);</span><br><span class="line">                --size;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœ key å­˜åœ¨ï¼Œå…ˆé€šè¿‡å“ˆå¸Œè¡¨å®šä½ï¼Œå†ä¿®æ”¹ valueï¼Œå¹¶ç§»åˆ°å¤´éƒ¨</span></span><br><span class="line">            node.value = value;</span><br><span class="line">            moveToHead(node);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">addToHead</span><span class="params">(DLinkedNode node)</span> &#123;</span><br><span class="line">        node.prev = head;</span><br><span class="line">        node.next = head.next;</span><br><span class="line">        head.next.prev = node;</span><br><span class="line">        head.next = node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">removeNode</span><span class="params">(DLinkedNode node)</span> &#123;</span><br><span class="line">        node.prev.next = node.next;</span><br><span class="line">        node.next.prev = node.prev;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">moveToHead</span><span class="params">(DLinkedNode node)</span> &#123;</span><br><span class="line">        removeNode(node);</span><br><span class="line">        addToHead(node);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> DLinkedNode <span class="title function_">removeTail</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DLinkedNode</span> <span class="variable">res</span> <span class="operator">=</span> tail.prev;</span><br><span class="line">        removeNode(res);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> Java </tag>
            
            <tag> LRU </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MySQLåˆ†é¡µæŸ¥è¯¢æ€»ç»“</title>
      <link href="/2024/08/14/2024-08-14-MySQL%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2%E6%80%BB%E7%BB%93/"/>
      <url>/2024/08/14/2024-08-14-MySQL%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h1 id="MySQLåˆ†é¡µæŸ¥è¯¢æ€»ç»“"><a href="#MySQLåˆ†é¡µæŸ¥è¯¢æ€»ç»“" class="headerlink" title="MySQLåˆ†é¡µæŸ¥è¯¢æ€»ç»“"></a>MySQLåˆ†é¡µæŸ¥è¯¢æ€»ç»“</h1><p>LIMITè¯­æ³•ï¼š LIMIT {[offset,] row_count | row_count OFFSET offset}</p><p>LIMITå­å¥å¯ä»¥è¢«ç”¨äºé™åˆ¶è¢«SELECTè¯­å¥è¿”å›çš„è¡Œæ•°ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ä½¿ç”¨ä¸¤ä¸ªå‚æ•°æ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šè¿”å›çš„åç§»é‡ï¼Œç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šè¿”å›çš„è¡Œæ•°ã€‚åˆå§‹è¡Œçš„åç§»é‡ä¸º<span class="number">0</span>ï¼ˆä¸æ˜¯<span class="number">1</span>ï¼‰ï¼š</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> tbl LIMIT <span class="number">5</span>,<span class="number">10</span>;  # Retrieve <span class="keyword">rows</span> <span class="number">6</span><span class="number">-15</span></span><br><span class="line"></span><br><span class="line">ä½¿ç”¨ä¸€ä¸ªå‚æ•°æ—¶ï¼ŒæŒ‡å®šä»å¼€å¤´è¿”å›çš„è¡Œæ•°ï¼š</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> tbl LIMIT <span class="number">5</span>;     # Retrieve <span class="keyword">first</span> <span class="number">5</span> <span class="keyword">rows</span></span><br></pre></td></tr></table></figure><p><strong>å†™æ³•å®ç°ï¼š</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ†é¡µæŸ¥è¯¢ é€šç”¨è¯­å¥</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">TABLE</span> </span><br><span class="line">LIMIT (pageIndex<span class="number">-1</span>)<span class="operator">*</span>pageSize,pageSize</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ç¬¬ä¸€é¡µ æ¯é¡µ100æ¡</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> EMP LIMIT <span class="number">0</span>,<span class="number">100</span></span><br><span class="line"><span class="comment">-- ç¬¬äºŒé¡µ æ¯é¡µ100æ¡</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> EMP LIMIT <span class="number">100</span>,<span class="number">100</span></span><br><span class="line"><span class="comment">-- ç¬¬801é¡µ æ¯é¡µ100æ¡</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> EMP LIMIT <span class="number">80000</span>,<span class="number">100</span>  <span class="comment">-- ç”¨æ—¶0.046s</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
            <tag> MySQL </tag>
            
            <tag> åˆ†é¡µæŸ¥è¯¢ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rediså®ç°åˆ†å¸ƒå¼é”åŠRedisson</title>
      <link href="/2024/08/11/2024-08-11-Redis%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E5%8F%8ARedisson/"/>
      <url>/2024/08/11/2024-08-11-Redis%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E5%8F%8ARedisson/</url>
      
        <content type="html"><![CDATA[<h1 id="Rediså®ç°åˆ†å¸ƒå¼é”åŠRedisson"><a href="#Rediså®ç°åˆ†å¸ƒå¼é”åŠRedisson" class="headerlink" title="Rediså®ç°åˆ†å¸ƒå¼é”åŠRedisson"></a>Rediså®ç°åˆ†å¸ƒå¼é”åŠRedisson</h1><p>â€‹åˆ†å¸ƒå¼é”æ˜¯æ§åˆ¶åˆ†å¸ƒå¼ç³»ç»Ÿä¹‹é—´åŒæ­¥è®¿é—®å…±äº«èµ„æºçš„ä¸€ç§æ–¹å¼ã€‚</p><p>â€‹åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¸¸å¸¸éœ€è¦åè°ƒä»–ä»¬çš„åŠ¨ä½œï¼Œè‹¥ä¸åŒçš„ç³»ç»Ÿæˆ–æ˜¯åŒä¸€ä¸ªç³»ç»Ÿçš„ä¸åŒä¸»æœºä¹‹é—´å…±äº«äº†ä¸€ä¸ªæˆ–ä¸€ç»„èµ„æºï¼Œé‚£ä¹ˆè®¿é—®è¿™äº›èµ„æºçš„æ—¶å€™ï¼Œå¾€å¾€éœ€è¦äº’æ–¥æ¥é˜²æ­¢å½¼æ­¤å¹²æ‰°æ¥ä¿è¯<a href="https://baike.baidu.com/item/%E4%B8%80%E8%87%B4%E6%80%A7?fromModule=lemma_inlink">ä¸€è‡´æ€§</a>ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä¾¿éœ€è¦ä½¿ç”¨åˆ°åˆ†å¸ƒå¼é”ã€‚</p><p><img src="https://s2.loli.net/2024/08/11/YoWBi2jXDCratgx.png" alt="image-20240811183351968.png"></p><h2 id="ä¾‹å­ï¼šå•†å“ç§’æ€è¶…å–"><a href="#ä¾‹å­ï¼šå•†å“ç§’æ€è¶…å–" class="headerlink" title="ä¾‹å­ï¼šå•†å“ç§’æ€è¶…å–"></a>ä¾‹å­ï¼šå•†å“ç§’æ€è¶…å–</h2><h3 id="1-æ— é”"><a href="#1-æ— é”" class="headerlink" title="1. æ— é”"></a>1. æ— é”</h3><p><img src="https://s2.loli.net/2024/08/11/1hIc83xbNWUgKv2.png" alt="image-20240811183509559.png"></p><p>è¿™æ˜¯ä¸€ä¸ªè®¢å•åº“å­˜çš„ä¾‹å­ï¼Œåº“å­˜stockä¸º1ï¼Œè¿™é‡Œå¾ˆå®¹æ˜“ä¼šå‘ç°å®¹æ˜“é€ æˆå¤šæ¬¡ä¸‹å•æˆåŠŸçš„é”™è¯¯ã€‚</p><h3 id="2-åŠ åŒæ­¥é”"><a href="#2-åŠ åŒæ­¥é”" class="headerlink" title="2. åŠ åŒæ­¥é”"></a>2. åŠ åŒæ­¥é”</h3><p><img src="https://s2.loli.net/2024/08/11/b6XwlNH2iLxFPQf.png" alt="image-20240811183631363.png"></p><p>è¿™é‡Œåœ¨å•æœºæƒ…å†µä¸‹ç¡®å®èƒ½å¤Ÿæ»¡è¶³ä¸å‡ºç°è¶…å–çš„é—®é¢˜ã€‚</p><p>ç¼ºç‚¹ï¼šå¦‚æœä½œNginxè¿›è¡Œè´Ÿè½½å‡è¡¡+åˆ†å¸ƒå¼é›†ç¾¤éƒ¨ç½²ï¼Œä¾ç„¶ä¼šå‡ºç°è¶…å–é—®é¢˜ã€‚</p><ul><li>åŸå› æ˜¯åŒæ­¥é”<code>synchronized</code>æ˜¯JVMçº§åˆ«çš„ï¼Œæ¯å°æœåŠ¡å™¨åœ¨å¹¶å‘æƒ…å†µä¸‹ï¼Œåªèƒ½é”ä½ä¸€ä¸ªçº¿ç¨‹ã€‚</li></ul><p><img src="https://s2.loli.net/2024/08/11/ToOWu59JGKh3y2b.png" alt="image-20240811184041126.png"></p><p>æ‰€ä»¥ï¼Œå¦‚ä½•å¤„ç†è¿™ç§åˆ†å¸ƒå¼çš„æƒ…å†µå‘¢ï¼Ÿ</p><h3 id="3-Redis-or-Zookeeper"><a href="#3-Redis-or-Zookeeper" class="headerlink" title="3. Redis or Zookeeper"></a>3. Redis or Zookeeper</h3><p>ç”±äºç³»ç»Ÿå·²ç»ä½¿ç”¨åˆ°äº†Redisï¼Œä¸ºäº†ç³»ç»Ÿçš„è½»é‡é¿å…å†—ä½™å¼•å…¥æ–°ç»„ä»¶ï¼Œé€‰æ‹©é€šè¿‡Redisæ¥è¿›è¡Œå®ç°åˆ†å¸ƒå¼é”ã€‚</p><h2 id="Rediså®ç°åˆ†å¸ƒå¼é”"><a href="#Rediså®ç°åˆ†å¸ƒå¼é”" class="headerlink" title="Rediså®ç°åˆ†å¸ƒå¼é”"></a>Rediså®ç°åˆ†å¸ƒå¼é”</h2><h3 id="1-SETNXå’ŒSET-NXå‘½ä»¤"><a href="#1-SETNXå’ŒSET-NXå‘½ä»¤" class="headerlink" title="1. SETNXå’ŒSET NXå‘½ä»¤"></a>1. SETNXå’ŒSET NXå‘½ä»¤</h3><p>[Windowsç‰ˆDockerå®‰è£…Redisæ•™ç¨‹(ä¿å§†çº§)ï¼Œé€‚åˆå¼€å‘ç¯å¢ƒå¿«é€Ÿæä¾›RedisæœåŠ¡_windows docker å®‰è£…redis-CSDNåšå®¢](<a href="https://blog.csdn.net/BXD19931010/article/details/135065606?ops_request_misc=&request_id=&biz_id=102&utm_term=windows">https://blog.csdn.net/BXD19931010/article/details/135065606?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=windows</a> dockerå®‰è£…redis&amp;utm_medium&#x3D;distribute.pc_search_result.none-task-blog-2<del>all</del>sobaiduweb~default-3-135065606.142^v100^pc_search_result_base8&amp;spm&#x3D;1018.2226.3001.4187)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºå®¹å™¨å¹¶æ‰§è¡Œ</span></span><br><span class="line">docker run -it --name redis -p 6379:6379 redis --bind 0.0.0.0 --protected-mode no</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åå°è¿è¡Œå®¹å™¨</span></span><br><span class="line">docker run -it -d redis</span><br><span class="line">docker ps</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">exec</span>è¡¨ç¤ºåœ¨è¿è¡Œçš„å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤ itè¡¨ç¤ºä»¥ç»ˆç«¯äº¤äº’çš„æ–¹å¼æ‰§è¡Œå‘½ä»¤ /bin/bashè¡¨ç¤ºéœ€è¦æŒ‡å®šçš„å‘½ä»¤</span></span><br><span class="line">docker exec it redis /bin/bash</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿›å…¥å®¹å™¨åå¯é€šè¿‡redis-cliå‘½ä»¤è¿æ¥å®¹å™¨å†…çš„redisæœåŠ¡å™¨ï¼Œå¯é€šè¿‡<span class="built_in">set</span>åˆ›å»ºå˜é‡ï¼Œgetè·å–å˜é‡çš„å€¼</span></span><br><span class="line">redis-cli</span><br></pre></td></tr></table></figure><p>â€‹<code>Redis</code>å®ç°åˆ†å¸ƒå¼é”çš„æ ¸å¿ƒä¾¿åœ¨äº<code>SETNX</code>å‘½ä»¤ï¼Œå®ƒæ˜¯<code>SET if Not eXists</code>çš„ç¼©å†™ï¼Œå¦‚æœé”®ä¸å­˜åœ¨ï¼Œåˆ™å°†é”®è®¾ç½®ä¸ºç»™å®šå€¼ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒç­‰äºSETï¼›å½“é”®å·²å­˜åœ¨æ—¶ï¼Œä¸æ‰§è¡Œä»»ä½•æ“ä½œï¼›æˆåŠŸæ—¶è¿”å›1ï¼Œå¤±è´¥è¿”å›0</p><p>â€‹ä½†<code>setnx</code>ä¸èƒ½åŒæ—¶å®Œæˆ<code>expire</code>è®¾ç½®å¤±æ•ˆæ—¶é•¿ï¼Œä¸èƒ½ä¿è¯<code>setnx</code>å’Œ<code>expire</code>çš„åŸå­æ€§ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>set</code>å‘½ä»¤å®Œæˆ<code>setnx</code>å’Œ<code>expire</code>çš„æ“ä½œï¼Œå¹¶ä¸”è¿™ç§æ“ä½œæ˜¯åŸå­æ“ä½œã€‚</p><p>â€‹ä¸‹é¢æ˜¯<code>set</code>å‘½ä»¤çš„å¯é€‰é¡¹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">set key value [EX seconds] [PX milliseconds] [NX|XX]</span><br><span class="line">EX secondsï¼šè®¾ç½®å¤±æ•ˆæ—¶é•¿ï¼Œå•ä½ç§’</span><br><span class="line">PX millisecondsï¼šè®¾ç½®å¤±æ•ˆæ—¶é•¿ï¼Œå•ä½æ¯«ç§’</span><br><span class="line">NXï¼škeyä¸å­˜åœ¨æ—¶è®¾ç½®valueï¼ŒæˆåŠŸè¿”å›OKï¼Œå¤±è´¥è¿”å›(nil)</span><br><span class="line">XXï¼škeyå­˜åœ¨æ—¶è®¾ç½®valueï¼ŒæˆåŠŸè¿”å›OKï¼Œå¤±è´¥è¿”å›(nil)</span><br></pre></td></tr></table></figure><ul><li><p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p><ul><li><p>ä¸¤æ¬¡æ’å…¥ç›¸åŒé”®ä¸åŒå€¼ï¼Œç¬¬ä¸€æ¬¡è¿”å›æˆåŠŸï¼Œç¬¬äºŒæ¬¡è¿”å›å¤±è´¥ï¼š</p><p><img src="https://s2.loli.net/2024/08/11/2Gs4CMv78hiuzlx.png" alt="image-20240811191203670.png"></p></li><li><p>è®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆåç§’ï¼‰ï¼š</p><p><img src="https://s2.loli.net/2024/08/11/9cB6eCYJLUnwRxQ.png" alt="image-20240811191459809.png"></p></li></ul></li></ul><h3 id="2-é€šè¿‡Redisçš„SETNXå®ç°åˆ†å¸ƒå¼é”"><a href="#2-é€šè¿‡Redisçš„SETNXå®ç°åˆ†å¸ƒå¼é”" class="headerlink" title="2. é€šè¿‡Redisçš„SETNXå®ç°åˆ†å¸ƒå¼é”"></a>2. é€šè¿‡Redisçš„SETNXå®ç°åˆ†å¸ƒå¼é”</h3><p>å‘½ä»¤ SET resource-name anystring NX EX max-lock-time æ˜¯ä¸€ç§åœ¨ Redis ä¸­å®ç°é”çš„ç®€å•æ–¹æ³•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">ç»™lockè®¾ç½®äº†è¿‡æœŸæ—¶é—´ä¸º60000æ¯«ç§’(ä¹Ÿå¯ä»¥ç”¨ex 6000,å•ä½å°±å˜æˆäº†ç§’)ï¼Œå½“ç”¨NXå†æ¬¡èµ‹å€¼ï¼Œåˆ™è¿”å›nil,ä¸èƒ½é‡å…¥æ“ä½œ</span></span><br><span class="line">127.0.0.1:6379&gt; set lock true NX px 60000</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; set lock true NX px 6000</span><br><span class="line">(nil)</span><br><span class="line">127.0.0.1:6379&gt; get lock</span><br><span class="line">&quot;true&quot;</span><br><span class="line">127.0.0.1:6379&gt; ttl lock</span><br><span class="line">(integer) 43</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æ—¶é—´è¿‡æœŸåå†æ¬¡get,è¿”å›nil,è¡¨æ˜key ä¸º lockçš„é”å·²ç»é‡Šæ”¾</span></span><br><span class="line">127.0.0.1:6379&gt; get lock</span><br><span class="line">(nil)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¦‚æœsetnx è¿”å›ok è¯´æ˜æ‹¿åˆ°äº†é”ï¼›å¦‚æœsetnx è¿”å› nilï¼Œè¯´æ˜æ‹¿é”å¤±è´¥ï¼Œè¢«å…¶ä»–çº¿ç¨‹å ç”¨ã€‚</p><p>æ¢æˆå®¢æˆ·ç«¯æœåŠ¡å™¨åˆ™æ˜¯å¦‚ä¸‹ï¼š</p><ul><li>å®¢æˆ·ç«¯æ‰§è¡Œä»¥ä¸Šçš„å‘½ä»¤ï¼š<ul><li>å¦‚æœæœåŠ¡å™¨è¿”å› OK ï¼Œé‚£ä¹ˆè¿™ä¸ªå®¢æˆ·ç«¯è·å¾—é”ã€‚</li><li>å¦‚æœæœåŠ¡å™¨è¿”å› NIL ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯è·å–é”å¤±è´¥ï¼Œå¯ä»¥åœ¨ç¨åå†é‡è¯•ã€‚</li></ul></li></ul><p><img src="https://s2.loli.net/2024/08/11/IKD3wsvdYLnlfuM.png" alt="image-20240811190440207.png"></p><h4 id="é—®é¢˜ä¸€ï¼šä¸ºä»€ä¹ˆéœ€è¦PX-XXè®¾ç½®è¶…æ—¶æ—¶é—´ï¼Ÿ"><a href="#é—®é¢˜ä¸€ï¼šä¸ºä»€ä¹ˆéœ€è¦PX-XXè®¾ç½®è¶…æ—¶æ—¶é—´ï¼Ÿ" class="headerlink" title="é—®é¢˜ä¸€ï¼šä¸ºä»€ä¹ˆéœ€è¦PX&#x2F;XXè®¾ç½®è¶…æ—¶æ—¶é—´ï¼Ÿ"></a>é—®é¢˜ä¸€ï¼šä¸ºä»€ä¹ˆéœ€è¦PX&#x2F;XXè®¾ç½®è¶…æ—¶æ—¶é—´ï¼Ÿ</h4><p>ç­”ï¼šå¦‚æœç¬¬ä¸€ä¸ªsetçš„è¿›ç¨‹Aä¸è®²é“ç†&#x2F;çªç„¶å®•æœºï¼Œé”æ°¸è¿œé‡Šæ”¾ä¸äº†ï¼Œå¯¼è‡´ç³»ç»Ÿä¸­å…¶ä»–æœºå™¨çš„å…¶ä»–çº¿ç¨‹è°ä¹Ÿæ‹¿ä¸åˆ°é”ã€‚</p><h4 id="é—®é¢˜äºŒï¼šè®¾ç½®äº†è¶…æ—¶æ—¶é—´è¿˜æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ"><a href="#é—®é¢˜äºŒï¼šè®¾ç½®äº†è¶…æ—¶æ—¶é—´è¿˜æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ" class="headerlink" title="é—®é¢˜äºŒï¼šè®¾ç½®äº†è¶…æ—¶æ—¶é—´è¿˜æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ"></a>é—®é¢˜äºŒï¼šè®¾ç½®äº†è¶…æ—¶æ—¶é—´è¿˜æœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ</h4><ol><li>å¦‚æœç¬¬ä¸€ä¸ªsetçš„è¿›ç¨‹Aåˆä¸è®²é“ç†ï¼Œä¸šåŠ¡æ­¥éª¤æ—¶é—´è¶…è¿‡è®¾ç½®çš„è¶…æ—¶æ—¶é—´ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´å…¶ä»–è¿›ç¨‹æ‹¿åˆ°é”ï¼ˆè¶è™šè€Œå…¥ï¼‰ï¼Œå¯¼è‡´è¶…å–é—®é¢˜ã€‚</li><li>åŒæ—¶ï¼Œç­‰è¿›ç¨‹Aå›æ¥äº†ï¼Œå›æ‰‹å°±æ˜¯æŠŠå…¶ä»–è¿›ç¨‹çš„é”åˆ äº†&#x2F;é‡Šæ”¾å…¶ä»–çº¿ç¨‹çš„é”ï¼Œå°±ä¼šæ›´åŠ è¶è™šè€Œå…¥å¯¼è‡´è¶…å–ã€‚</li></ol><p><strong>è§£å†³åŠæ³•ï¼š</strong></p><ol><li>åŠ é•¿é”çš„è¿‡æœŸæ—¶é—´ï¼Œå¹¶æ·»åŠ å­çº¿ç¨‹æ¯éš”10ç§’ç¡®è®¤ä¸»çº¿ç¨‹æ˜¯å¦åœ¨çº¿ï¼Œå¦‚æœåœ¨çº¿åˆ™å°†è¿‡æœŸæ—¶é—´é‡æ–°è®¾ç½®ï¼ˆç»™é”ç»­å‘½ï¼‰ã€‚</li><li>ç»™é”åŠ ä¸ŠUUIDï¼ˆé”ä¸çº¿ç¨‹çš„å”¯ä¸€æ€§ï¼‰ï¼Œè¿™æ ·å°±ä¸ä¼šé‡Šæ”¾åˆ«äººçš„é”äº†ã€‚</li></ol><p>ä»¥ä¸Šè§£å†³æ–¹æ¡ˆè¦ç¡®ä¿ä»£ç çš„æ­£ç¡®æ€§ã€å¥å£®æ€§è¿˜æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼Œåœ¨æ­¤å¼•å…¥<code>Redisson</code>å·¥å…·ã€‚</p><h2 id="Redisson"><a href="#Redisson" class="headerlink" title="Redisson"></a>Redisson</h2><h3 id="RedissonåŸç†"><a href="#RedissonåŸç†" class="headerlink" title="RedissonåŸç†"></a>RedissonåŸç†</h3><p><img src="https://s2.loli.net/2024/08/11/ghpivaGCYZNtf6d.png" alt="image-20240811200433350.png"></p><p>è¿™é‡Œçš„åŸç†å°±æ˜¯ä¸Šé¢æåˆ°çš„é‚£ä¸¤ç‚¹ã€‚</p><h3 id="é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ"><a href="#é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ" class="headerlink" title="é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ"></a>é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ</h3><p>å› ä¸º<code>Redis</code>æ˜¯æ»¡è¶³<code>AP</code>ï¼ˆé«˜å¯ç”¨+åˆ†åŒºå®¹é”™ï¼‰ï¼Œå½“<code>Redis</code>é‡‡ç”¨é›†ç¾¤ï¼ˆä¸»ä»èŠ‚ç‚¹ï¼‰ï¼Œè¿™é‡Œçš„åŠ é”åªä¼šå¾€<code>Redis</code>çš„ä¸€ä¸ªèŠ‚ç‚¹å»åŠ é”ï¼Œæ¯”å¦‚å¯¹ä¸»èŠ‚ç‚¹åŠ é”äº†ï¼Œè¿™æ—¶ä¸»èŠ‚ç‚¹ä¼šå»ä»èŠ‚ç‚¹é‚£è¿›è¡Œé”çŠ¶æ€çš„åŒæ­¥ã€‚å€˜è‹¥è¿™æ—¶ä¸»èŠ‚ç‚¹æŒ‚æ‰äº†ï¼Œä»èŠ‚ç‚¹æ²¡æœ‰æœ‰æ•ˆåŒæ­¥ï¼Œä¾ç„¶ä¼šå‘ç”Ÿçº¿ç¨‹ä¸å®‰å…¨çš„æƒ…å†µã€‚</p><p>è§£å†³æ–¹æ¡ˆï¼š</p><ul><li><p>é‡‡ç”¨<code>redlock</code>ï¼ˆçº¢é”ï¼‰å®ç°ï¼šå¯¹<code>Redis</code>çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½è¿›è¡ŒåŠ é”åï¼Œæ‰è¿”å›å“åº”ã€‚</p><p><a href="https://way2j.com/a/1338">Redisson-çº¢é”(Redlock)-ä½¿ç”¨&#x2F;åŸç† - è‡ªå­¦ç²¾çµ (way2j.com)</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> åç«¯ </tag>
            
            <tag> Redis </tag>
            
            <tag> åˆ†å¸ƒå¼é” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaçš„Streamæµ</title>
      <link href="/2024/08/08/2024-08-08-Java%E7%9A%84Stream%E6%B5%81/"/>
      <url>/2024/08/08/2024-08-08-Java%E7%9A%84Stream%E6%B5%81/</url>
      
        <content type="html"><![CDATA[<h1 id="Javaçš„Streamæµ"><a href="#Javaçš„Streamæµ" class="headerlink" title="Javaçš„Streamæµ"></a>Javaçš„Streamæµ</h1><p>[è®²é€JAVA Streamçš„collectç”¨æ³•ä¸åŸç†ï¼Œè¿œæ¯”ä½ æƒ³è±¡çš„æ›´å¼ºå¤§_stream.collection-CSDNåšå®¢](<a href="https://blog.csdn.net/veezean/article/details/125857074?ops_request_misc=%7B%22request_id%22:%22172258578116800227423214%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172258578116800227423214&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-125857074-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=Java">https://blog.csdn.net/veezean/article/details/125857074?ops_request_misc=%7B%22request%5Fid%22%3A%22172258578116800227423214%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172258578116800227423214&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-125857074-null-null.142^v100^pc_search_result_base8&amp;utm_term=Java</a> stream collect&amp;spm&#x3D;1018.2226.3001.4187)</p><p>[Javaâ€“Streamæµè¯¦è§£_java stream-CSDNåšå®¢](<a href="https://blog.csdn.net/MinggeQingchun/article/details/123184273?ops_request_misc=%7B%22request_id%22:%22172258592916800182196501%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172258592916800182196501&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-123184273-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=Java">https://blog.csdn.net/MinggeQingchun/article/details/123184273?ops_request_misc=%7B%22request%5Fid%22%3A%22172258592916800182196501%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172258592916800182196501&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-123184273-null-null.142^v100^pc_search_result_base8&amp;utm_term=Java</a> streamæµ&amp;spm&#x3D;1018.2226.3001.4187)</p><h2 id="streamçš„åˆ›å»ºï¼š"><a href="#streamçš„åˆ›å»ºï¼š" class="headerlink" title="streamçš„åˆ›å»ºï¼š"></a>streamçš„åˆ›å»ºï¼š</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//1.Stream.of(array) ï¼ˆè¿™é‡Œé¢çš„1,2,3,4å…¶å®æ˜¯Arrayçš„ç±»å‹ï¼‰</span></span><br><span class="line">Stream.of(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)    </span><br><span class="line">    </span><br><span class="line"><span class="comment">//2.list.Stream()</span></span><br><span class="line"><span class="number">2.</span> list.stream()</span><br></pre></td></tr></table></figure><h2 id="æ“ä½œç¬¦"><a href="#æ“ä½œç¬¦" class="headerlink" title="æ“ä½œç¬¦"></a>æ“ä½œç¬¦</h2><h3 id="å¸¸ç”¨ä¸­é—´æ“ä½œç¬¦"><a href="#å¸¸ç”¨ä¸­é—´æ“ä½œç¬¦" class="headerlink" title="å¸¸ç”¨ä¸­é—´æ“ä½œç¬¦"></a>å¸¸ç”¨ä¸­é—´æ“ä½œç¬¦</h3><ol><li><p>filterï¼šç”¨äºè¿‡æ»¤ ï¼Œæ¥å—ä¸€ä¸ªè¿”å›booleanå€¼çš„å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªæµ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list.stream().filter(number-&gt;number&gt;=<span class="number">2</span>).collect(Collectors.toList());</span><br></pre></td></tr></table></figure></li><li><p>mapï¼šç”¨äºæ˜ å°„ ï¼Œæ˜ å°„æµä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ä¸ºå¦ä¸€ä¸ªæµä¸­çš„å…ƒç´ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//toList</span></span><br><span class="line">list.stream().(str-&gt;str+<span class="string">&quot;-IT&quot;</span>).collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line"><span class="comment">//toMap  åœ¨ toMap æ–¹æ³•ä¸­ï¼Œä»¥æ¯ä¸ªæ•´æ•°çš„å­—èŠ‚å€¼ä¸ºé”®ï¼Œè¯¥æ•´æ•°ä¹˜ä»¥ 2 ä¸ºå€¼ï¼Œå½“é‡åˆ°é‡å¤çš„é”®æ—¶å–æœ€åä¸€ä¸ªå€¼ã€‚ï¼ˆè¿™é‡Œå®é™…ä¸Šå¯ä»¥ç”¨ä»»ä½•èƒ½åŒºåˆ†ä¸åŒé”®çš„æ–¹å¼ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè€Œä¸ä¸€å®šæ˜¯ Integer::byteValueï¼‰</span></span><br><span class="line">list.stream().collect(Collectors.toMap(Integer::byteValue,num-&gt;num*<span class="number">2</span>,(num1,num2)-&gt;num2));</span><br></pre></td></tr></table></figure></li><li><p>dinstinct:  ç”¨äºå»é‡ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">numbers.stream().filter(i -&gt; i % <span class="number">2</span> == <span class="number">0</span>).distinct().forEach(System.out::println);</span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/qq_36929361/article/details/84926277?ops_request_misc=%7B%22request_id%22:%22172258713216800188592335%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172258713216800188592335&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-84926277-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=System.out::println&spm=1018.2226.3001.4187&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT1TeXN0ZW0ub3V0JTNBJTNBcHJpbnRsbiZ0PSZ1PSZ1cnc9">æ•™ä½ çœ‹æ‡‚System.out::println-CSDNåšå®¢</a></p></li><li><p>sorted: ç”¨äºæ’åº  </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; collect = strings1.stream().sorted().collect(Collectors.toList());</span><br></pre></td></tr></table></figure></li><li><p>limit: å¯ä»¥å°†æµé™åˆ¶ä¸ºæŒ‡å®šçš„å…ƒç´ æ•°</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; collect = numbers.stream().limit(<span class="number">3</span>).collect(Collectors.toList());</span><br></pre></td></tr></table></figure></li></ol><h3 id="å¸¸ç”¨ç»ˆç«¯æ“ä½œç¬¦"><a href="#å¸¸ç”¨ç»ˆç«¯æ“ä½œç¬¦" class="headerlink" title="å¸¸ç”¨ç»ˆç«¯æ“ä½œç¬¦"></a>å¸¸ç”¨ç»ˆç«¯æ“ä½œç¬¦</h3><ol><li><p>collect: æ”¶é›†å™¨ï¼Œå°†æµè½¬æ¢ä¸ºå…¶ä»–å½¢å¼ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">strings.stream().collect(Collectors.toSet()); </span><br><span class="line"></span><br><span class="line">strings.stream().collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">strings.stream().collect(Collectors.toMap()); </span><br></pre></td></tr></table></figure></li><li><p>forEach:éå†æµ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strings.stream().forEach(s -&gt; out.println(s));</span><br></pre></td></tr></table></figure></li><li><p>Count(è®¡æ•°)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; names = Arrays.asList(<span class="string">&quot;Alex&quot;</span>, <span class="string">&quot;Brian&quot;</span>, <span class="string">&quot;Charles&quot;</span>, <span class="string">&quot;David&quot;</span>);</span><br><span class="line"><span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> names.stream().count();</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> åç«¯ </tag>
            
            <tag> Stream </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¹¶å‘ï¼šJavaçš„Futureå’ŒFutureTask</title>
      <link href="/2024/08/08/2024-08-08-%E5%B9%B6%E5%8F%91%EF%BC%9AJava%E7%9A%84Future%E5%92%8CFutureTask/"/>
      <url>/2024/08/08/2024-08-08-%E5%B9%B6%E5%8F%91%EF%BC%9AJava%E7%9A%84Future%E5%92%8CFutureTask/</url>
      
        <content type="html"><![CDATA[<h1 id="å¹¶å‘ï¼šJavaçš„Futureå’ŒFutureTask"><a href="#å¹¶å‘ï¼šJavaçš„Futureå’ŒFutureTask" class="headerlink" title="å¹¶å‘ï¼šJavaçš„Futureå’ŒFutureTask"></a>å¹¶å‘ï¼šJavaçš„Futureå’ŒFutureTask</h1><h2 id="Futureç±»çš„ä½œç”¨"><a href="#Futureç±»çš„ä½œç”¨" class="headerlink" title="Futureç±»çš„ä½œç”¨"></a>Futureç±»çš„ä½œç”¨</h2><p><code>Future </code>ç±»æ˜¯å¼‚æ­¥æ€æƒ³çš„å…¸å‹è¿ç”¨ï¼Œä¸»è¦ç”¨åœ¨ä¸€äº›éœ€è¦æ‰§è¡Œè€—æ—¶ä»»åŠ¡çš„åœºæ™¯ï¼Œé¿å…ç¨‹åºä¸€ç›´åŸåœ°ç­‰å¾…è€—æ—¶ä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œæ‰§è¡Œæ•ˆç‡å¤ªä½ã€‚å…·ä½“æ¥è¯´æ˜¯è¿™æ ·çš„ï¼šå½“æˆ‘ä»¬æ‰§è¡ŒæŸä¸€è€—æ—¶çš„ä»»åŠ¡æ—¶ï¼Œå¯ä»¥å°†è¿™ä¸ªè€—æ—¶ä»»åŠ¡äº¤ç»™ä¸€ä¸ªå­çº¿ç¨‹å»å¼‚æ­¥æ‰§è¡Œï¼ŒåŒæ—¶æˆ‘ä»¬å¯ä»¥å¹²ç‚¹å…¶ä»–äº‹æƒ…ï¼Œä¸ç”¨å‚»å‚»ç­‰å¾…è€—æ—¶ä»»åŠ¡æ‰§è¡Œå®Œæˆã€‚ç­‰æˆ‘ä»¬çš„äº‹æƒ…å¹²å®Œåï¼Œæˆ‘ä»¬å†é€šè¿‡ Future ç±»è·å–åˆ°è€—æ—¶ä»»åŠ¡çš„æ‰§è¡Œç»“æœã€‚è¿™æ ·ä¸€æ¥ï¼Œç¨‹åºçš„æ‰§è¡Œæ•ˆç‡å°±æ˜æ˜¾æé«˜äº†ã€‚</p><p>è¿™å…¶å®å°±æ˜¯å¤šçº¿ç¨‹ä¸­ç»å…¸çš„ <code>Future</code> æ¨¡å¼ï¼Œä½ å¯ä»¥å°†å…¶çœ‹ä½œæ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯å¼‚æ­¥è°ƒç”¨ï¼Œä¸»è¦ç”¨åœ¨å¤šçº¿ç¨‹é¢†åŸŸï¼Œå¹¶é Java è¯­è¨€ç‹¬æœ‰ã€‚</p><p>åœ¨ <code>Java </code>ä¸­ï¼Œ<code>Future</code> ç±»åªæ˜¯ä¸€ä¸ªæ³›å‹æ¥å£ï¼Œä½äº<code>java.util.concurrent</code>åŒ…ä¸‹ï¼Œå…¶ä¸­å®šä¹‰äº† 5 ä¸ªæ–¹æ³•ï¼Œä¸»è¦åŒ…æ‹¬ä¸‹é¢è¿™ 4 ä¸ªåŠŸèƒ½ï¼š</p><ol><li>å–æ¶ˆä»»åŠ¡ï¼›</li><li>åˆ¤æ–­ä»»åŠ¡æ˜¯å¦è¢«å–æ¶ˆ;</li><li>åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å·²ç»æ‰§è¡Œå®Œæˆ;</li><li>è·å–ä»»åŠ¡æ‰§è¡Œç»“æœã€‚</li></ol><h3 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// V ä»£è¡¨äº†Futureæ‰§è¡Œçš„ä»»åŠ¡è¿”å›å€¼çš„ç±»å‹</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Future</span>&lt;V&gt; &#123;</span><br><span class="line">    <span class="comment">// å–æ¶ˆä»»åŠ¡æ‰§è¡Œ</span></span><br><span class="line">    <span class="comment">// æˆåŠŸå–æ¶ˆè¿”å› trueï¼Œå¦åˆ™è¿”å› false</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">cancel</span><span class="params">(<span class="type">boolean</span> mayInterruptIfRunning)</span>;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­ä»»åŠ¡æ˜¯å¦è¢«å–æ¶ˆ</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isCancelled</span><span class="params">()</span>;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å·²ç»æ‰§è¡Œå®Œæˆ</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isDone</span><span class="params">()</span>;</span><br><span class="line">    <span class="comment">// è·å–ä»»åŠ¡æ‰§è¡Œç»“æœ</span></span><br><span class="line">    V <span class="title function_">get</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException, ExecutionException;</span><br><span class="line">    <span class="comment">// æŒ‡å®šæ—¶é—´å†…æ²¡æœ‰è¿”å›è®¡ç®—ç»“æœå°±æŠ›å‡º TimeOutException å¼‚å¸¸</span></span><br><span class="line">    V <span class="title function_">get</span><span class="params">(<span class="type">long</span> timeout, TimeUnit unit)</span></span><br><span class="line">        <span class="keyword">throws</span> InterruptedException, ExecutionException, TimeoutExceptio</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="FutureTaskçš„ä½œç”¨"><a href="#FutureTaskçš„ä½œç”¨" class="headerlink" title="FutureTaskçš„ä½œç”¨"></a>FutureTaskçš„ä½œç”¨</h2><p><code>FutureTask</code>æ˜¯<code>Future</code>çš„å…·ä½“å®ç°ã€‚</p><p><code>FutureTask</code>å®ç°äº†<code>RunnableFuture</code>æ¥å£ã€‚<code>RunnableFuture</code>æ¥å£åˆåŒæ—¶ç»§æ‰¿äº†<code>Future </code>å’Œ <code>Runnable</code> æ¥å£ã€‚æ‰€ä»¥<code>FutureTask</code>æ—¢å¯ä»¥ä½œä¸º<code>Runnable</code>è¢«çº¿ç¨‹æ‰§è¡Œï¼Œåˆå¯ä»¥ä½œä¸º<code>Future</code>å¾—åˆ°<code>Callable</code>çš„è¿”å›å€¼ï¼Œå¯ä»¥ä½œä¸ºä»»åŠ¡ç›´æ¥è¢«çº¿ç¨‹æ‰§è¡Œã€‚</p><h3 id="æ„é€ å‡½æ•°"><a href="#æ„é€ å‡½æ•°" class="headerlink" title="æ„é€ å‡½æ•°"></a>æ„é€ å‡½æ•°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">FutureTask</span><span class="params">(Callable&lt;V&gt; callable)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (callable == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>();</span><br><span class="line">    <span class="built_in">this</span>.callable = callable;</span><br><span class="line">    <span class="built_in">this</span>.state = NEW;       <span class="comment">// ensure visibility of callable</span></span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span> <span class="title function_">FutureTask</span><span class="params">(Runnable runnable, V result)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.callable = Executors.callable(runnable, result);</span><br><span class="line">    <span class="built_in">this</span>.state = NEW;       <span class="comment">// ensure visibility of callable</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.Callable;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ExecutionException;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.FutureTask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FutureTaskTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException, ExecutionException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">starttime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//input2ç”Ÿæˆï¼Œ éœ€è¦è€—è´¹3ç§’</span></span><br><span class="line">        FutureTask&lt;Integer&gt; input2_futuretask = <span class="keyword">new</span> <span class="title class_">FutureTask</span>&lt;&gt;(<span class="keyword">new</span> <span class="title class_">Callable</span>&lt;Integer&gt;() &#123;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Integer <span class="title function_">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                Thread.sleep(<span class="number">3000</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(input2_futuretask).start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//input1ç”Ÿæˆï¼Œéœ€è¦è€—è´¹2ç§’</span></span><br><span class="line">        FutureTask&lt;Integer&gt; input1_futuretask = <span class="keyword">new</span> <span class="title class_">FutureTask</span>&lt;&gt;(<span class="keyword">new</span> <span class="title class_">Callable</span>&lt;Integer&gt;() &#123;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Integer <span class="title function_">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">                Thread.sleep(<span class="number">2000</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="number">3</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Thread</span>(input1_futuretask).start();</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">integer1</span> <span class="operator">=</span> input1_futuretask.get();</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">integer2</span> <span class="operator">=</span> input2_futuretask.get();</span><br><span class="line">        System.out.println(algorithm(integer1, integer2));</span><br><span class="line">        <span class="type">long</span> <span class="variable">endtime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        System.out.println(<span class="string">&quot;ç”¨æ—¶ï¼š&quot;</span> + String.valueOf(endtime - starttime)+<span class="string">&quot;ms&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è¿™æ˜¯æˆ‘ä»¬è¦æ‰§è¡Œçš„ç®—æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">algorithm</span><span class="params">(<span class="type">int</span> input, <span class="type">int</span> input2)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> input + input2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/08/08/LZ8uTfUOjQ7dMlP.png" alt="image-20240808152922034.png"></p><p>è¿™é‡Œç”¨æ—¶ä»…ä»…åªæœ‰3013msï¼Œâ€input2ç”Ÿæˆï¼Œ éœ€è¦è€—è´¹3ç§’â€ï¼Œè¿™ä¸€æ­¥å äº†ä¸»è¦æ—¶é—´ã€‚ç”±æ­¤è§‚ä¹‹ï¼Œæ•´ä¸ªè¿‡ç¨‹æ˜¯å¼‚æ­¥çš„ï¼ˆä¸ç„¶æ—¶é—´å°†ä¼šæ˜¯&gt;3+2&#x3D;5sçš„ï¼‰ã€‚</p><h2 id="CompletableFutureç±»"><a href="#CompletableFutureç±»" class="headerlink" title="CompletableFutureç±»"></a>CompletableFutureç±»</h2><p><code>Future</code> åœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­å­˜åœ¨ä¸€äº›å±€é™æ€§ï¼Œæ¯”å¦‚ä¸æ”¯æŒå¼‚æ­¥ä»»åŠ¡çš„ç¼–æ’ç»„åˆã€è·å–è®¡ç®—ç»“æœçš„ get() æ–¹æ³•ä¸ºé˜»å¡è°ƒç”¨ã€‚</p><p>Java 8 æ‰è¢«å¼•å…¥<code>CompletableFuture</code> ç±»å¯ä»¥è§£å†³<code>Future</code> çš„è¿™äº›ç¼ºé™·ã€‚<code>CompletableFuture</code> é™¤äº†æä¾›äº†æ›´ä¸ºå¥½ç”¨å’Œå¼ºå¤§çš„ <code>Future</code> ç‰¹æ€§ä¹‹å¤–ï¼Œè¿˜æä¾›äº†å‡½æ•°å¼ç¼–ç¨‹ã€å¼‚æ­¥ä»»åŠ¡ç¼–æ’ç»„åˆï¼ˆå¯ä»¥å°†å¤šä¸ªå¼‚æ­¥ä»»åŠ¡ä¸²è”èµ·æ¥ï¼Œç»„æˆä¸€ä¸ªå®Œæ•´çš„é“¾å¼è°ƒç”¨ï¼‰ç­‰èƒ½åŠ›ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//programmer-clubä¸­çš„ä¾‹å­ </span></span><br><span class="line"><span class="comment">//å¯¹äºæ¯ä¸ªcategoryï¼Œè°ƒç”¨å¼‚æ­¥çš„CompletableFuture.supplyAsync()æ‰§è¡ŒgetLabelBOListæ–¹æ³•å’ŒThreadPoolExecutorä½œä¸ºExecutorå»å¤šçº¿ç¨‹+å¼‚æ­¥çš„è·å–labelBOList</span></span><br><span class="line">List&lt;CompletableFuture&lt;Map&lt;Long, List&lt;SubjectLabelBO&gt;&gt;&gt;&gt; completableFutureList = categoryBOList.stream().map(category -&gt;</span><br><span class="line">                CompletableFuture.supplyAsync(() -&gt; getLabelBOList(category), labelThreadPool).collect(Collectors.toList());</span><br><span class="line">                                                                                                     </span><br></pre></td></tr></table></figure><p><code>CompletableFuture</code>æ˜¯å¯¹<code>Future</code>çš„æ‰©å±•å’Œå¢å¼ºã€‚<code>CompletableFuture</code>å®ç°äº†<code>Future</code>æ¥å£ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œäº†ä¸°å¯Œçš„æ‰©å±•ï¼Œå®Œç¾å¼¥è¡¥äº†<code>Future</code>çš„å±€é™æ€§ï¼Œ<strong>åŒæ—¶<code>CompletableFuture</code>å®ç°äº†å¯¹ä»»åŠ¡ç¼–æ’çš„èƒ½åŠ›</strong>(é‡ç‚¹)ã€‚</p><p><img src="C:\Users\11505\AppData\Roaming\Typora\typora-user-images\image-20240826221248525.png" alt="image-20240826221248525"></p><p><code>CompletionStage</code>æ¥å£å®šä¹‰äº†ä»»åŠ¡ç¼–æ’çš„æ–¹æ³•ï¼Œæ‰§è¡ŒæŸä¸€é˜¶æ®µï¼Œå¯ä»¥å‘ä¸‹æ‰§è¡Œåç»­é˜¶æ®µã€‚<strong>å¼‚æ­¥æ‰§è¡Œçš„ï¼Œé»˜è®¤çº¿ç¨‹æ± æ˜¯<code>ForkJoinPool.commonPool()</code>ï¼Œä½†ä¸ºäº†ä¸šåŠ¡ä¹‹é—´äº’ä¸å½±å“ï¼Œä¸”ä¾¿äºå®šä½é—®é¢˜ï¼Œå¼ºçƒˆæ¨èä½¿ç”¨è‡ªå®šä¹‰çº¿ç¨‹æ± </strong>ã€‚</p><h3 id="åŠŸèƒ½"><a href="#åŠŸèƒ½" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h3><h4 id="å¸¸ç”¨æ–¹æ³•"><a href="#å¸¸ç”¨æ–¹æ³•" class="headerlink" title="å¸¸ç”¨æ–¹æ³•"></a>å¸¸ç”¨æ–¹æ³•</h4><p><strong>ä¾èµ–å…³ç³»</strong></p><ul><li>thenApply()ï¼šæŠŠå‰é¢ä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼Œäº¤ç»™åé¢çš„Functionã€‚</li><li>thenCompose()ï¼šç”¨æ¥è¿æ¥ä¸¤ä¸ªæœ‰ä¾èµ–å…³ç³»çš„ä»»åŠ¡ï¼Œç»“æœç”±ç¬¬äºŒä¸ªä»»åŠ¡è¿”å›ã€‚</li></ul><p><strong>andé›†åˆå…³ç³»</strong></p><ul><li>thenCombine()ï¼šåˆå¹¶ä»»åŠ¡ï¼Œæœ‰è¿”å›å€¼ã€‚</li><li>thenAccepetBoth()ï¼šä¸¤ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œå°†ç»“æœäº¤ç»™thenAccepetBothå¤„ç†ï¼Œæ— è¿”å›å€¼ã€‚</li><li>runAfterBoth()ï¼šä¸¤ä¸ªä»»åŠ¡éƒ½æ‰§è¡Œå®Œæˆåï¼Œæ‰§è¡Œä¸‹ä¸€æ­¥æ“ä½œ(Runnableç±»å‹ä»»åŠ¡)ã€‚</li></ul><p><strong>orèšåˆå…³ç³»</strong></p><ul><li>applyToEither()ï¼šä¸¤ä¸ªä»»åŠ¡å“ªä¸ªæ‰§è¡Œçš„å¿«ï¼Œå°±ä½¿ç”¨å“ªä¸€ä¸ªç»“æœï¼Œæœ‰è¿”å›å€¼ã€‚</li><li>acceptEither()ï¼šä¸¤ä¸ªä»»åŠ¡å“ªä¸ªæ‰§è¡Œçš„å¿«ï¼Œå°±æ¶ˆè´¹å“ªä¸€ä¸ªç»“æœï¼Œæ— è¿”å›å€¼ã€‚</li><li>runAfterEither()ï¼šä»»æ„ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œè¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œ(Runnableç±»å‹ä»»åŠ¡)ã€‚</li></ul><p><strong>å¹¶è¡Œæ‰§è¡Œ</strong></p><ul><li>allOf()ï¼šå½“æ‰€æœ‰ç»™å®šçš„ CompletableFuture å®Œæˆæ—¶ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ CompletableFutureã€‚</li><li>anyOf()ï¼šå½“ä»»ä½•ä¸€ä¸ªç»™å®šçš„CompletablFutureå®Œæˆæ—¶ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„CompletableFutureã€‚</li></ul><p><strong>ç»“æœå¤„ç†</strong></p><ul><li>whenCompleteï¼šå½“ä»»åŠ¡å®Œæˆæ—¶ï¼Œå°†ä½¿ç”¨ç»“æœ(æˆ– null)å’Œæ­¤é˜¶æ®µçš„å¼‚å¸¸(æˆ– nullå¦‚æœæ²¡æœ‰)æ‰§è¡Œç»™å®šæ“ä½œã€‚</li><li>exceptionallyï¼šè¿”å›ä¸€ä¸ªæ–°çš„CompletableFutureï¼Œå½“å‰é¢çš„CompletableFutureå®Œæˆæ—¶ï¼Œå®ƒä¹Ÿå®Œæˆï¼Œå½“å®ƒå¼‚å¸¸å®Œæˆæ—¶ï¼Œç»™å®šå‡½æ•°çš„å¼‚å¸¸è§¦å‘è¿™ä¸ªCompletableFutureçš„å®Œæˆã€‚</li></ul><h4 id="å¼‚æ­¥æ“ä½œ"><a href="#å¼‚æ­¥æ“ä½œ" class="headerlink" title="å¼‚æ­¥æ“ä½œ"></a>å¼‚æ­¥æ“ä½œ</h4><p>æä¾›äº†å››ä¸ªé™æ€æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> CompletableFuture&lt;Void&gt; <span class="title function_">runAsync</span><span class="params">(Runnable runnable)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> CompletableFuture&lt;Void&gt; <span class="title function_">runAsync</span><span class="params">(Runnable runnable, Executor executor)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;U&gt; CompletableFuture&lt;U&gt; <span class="title function_">supplyAsync</span><span class="params">(Supplier&lt;U&gt; supplier)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;U&gt; CompletableFuture&lt;U&gt; <span class="title function_">supplyAsync</span><span class="params">(Supplier&lt;U&gt; supplier, Executor executor)</span></span><br></pre></td></tr></table></figure><p>è¿™å››ä¸ªæ–¹æ³•çš„åŒºåˆ«ï¼š</p><ul><li><p><code>runAsync()</code> ä»¥<code>Runnable</code>å‡½æ•°å¼æ¥å£ç±»å‹ä¸ºå‚æ•°ï¼Œæ²¡æœ‰è¿”å›ç»“æœï¼Œ<code>supplyAsync() </code>ä»¥<code>Supplier</code>å‡½æ•°å¼æ¥å£ç±»å‹ä¸ºå‚æ•°ï¼Œè¿”å›ç»“æœç±»å‹ä¸º<code>U</code>ï¼›<code>Supplier</code>æ¥å£çš„ <code>get()</code>æ˜¯æœ‰è¿”å›å€¼çš„(ä¼šé˜»å¡)</p></li><li><p>ä½¿ç”¨æ²¡æœ‰æŒ‡å®š<code>Executor</code>çš„æ–¹æ³•æ—¶ï¼Œå†…éƒ¨ä½¿ç”¨<code>ForkJoinPool.commonPool() </code>ä½œä¸ºå®ƒçš„çº¿ç¨‹æ± æ‰§è¡Œå¼‚æ­¥ä»£ç ã€‚å¦‚æœæŒ‡å®šçº¿ç¨‹æ± ï¼Œåˆ™ä½¿ç”¨æŒ‡å®šçš„çº¿ç¨‹æ± è¿è¡Œã€‚</p></li><li><p>é»˜è®¤æƒ…å†µä¸‹<code>CompletableFuture</code>ä¼šä½¿ç”¨å…¬å…±çš„<code>ForkJoinPool</code>çº¿ç¨‹æ± ï¼Œè¿™ä¸ªçº¿ç¨‹æ± é»˜è®¤åˆ›å»ºçš„çº¿ç¨‹æ•°æ˜¯ CPU çš„æ ¸æ•°ï¼ˆä¹Ÿå¯ä»¥é€šè¿‡<code> JVM option</code>:</p><p><code>-Djava.util.concurrent.ForkJoinPool.common.parallelism </code>æ¥è®¾ç½®<code>ForkJoinPool</code>çº¿ç¨‹æ± çš„çº¿ç¨‹æ•°ï¼‰ã€‚å¦‚æœæ‰€æœ‰<code>CompletableFuture</code>å…±äº«ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œé‚£ä¹ˆä¸€æ—¦æœ‰ä»»åŠ¡æ‰§è¡Œä¸€äº›å¾ˆæ…¢çš„ I&#x2F;O æ“ä½œï¼Œå°±ä¼šå¯¼è‡´çº¿ç¨‹æ± ä¸­æ‰€æœ‰çº¿ç¨‹éƒ½é˜»å¡åœ¨ I&#x2F;O æ“ä½œä¸Šï¼Œä»è€Œé€ æˆçº¿ç¨‹é¥¥é¥¿ï¼Œè¿›è€Œå½±å“æ•´ä¸ªç³»ç»Ÿçš„æ€§èƒ½ã€‚æ‰€ä»¥ï¼Œå¼ºçƒˆå»ºè®®ä½ è¦æ ¹æ®ä¸åŒçš„ä¸šåŠ¡ç±»å‹åˆ›å»ºä¸åŒçš„çº¿ç¨‹æ± ï¼Œä»¥é¿å…äº’ç›¸å¹²æ‰°</p></li></ul><p><strong>å¼‚æ­¥æ“ä½œ</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Runnable</span> <span class="variable">runnable</span> <span class="operator">=</span> () -&gt; System.out.println(<span class="string">&quot;æ— è¿”å›ç»“æœå¼‚æ­¥ä»»åŠ¡&quot;</span>);</span><br><span class="line">CompletableFuture.runAsync(runnable);</span><br><span class="line"></span><br><span class="line">CompletableFuture&lt;String&gt; future = CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;æœ‰è¿”å›å€¼çš„å¼‚æ­¥ä»»åŠ¡&quot;</span>);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Thread.sleep(<span class="number">5000</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello World&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> future.get();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>è·å–ç»“æœï¼ˆjoin&amp;getï¼‰</strong></p><p><code>join()</code>å’Œ<code>get()</code>æ–¹æ³•éƒ½æ˜¯ç”¨æ¥è·å–<code>CompletableFuture</code>å¼‚æ­¥ä¹‹åçš„è¿”å›å€¼ã€‚<code>join()</code>æ–¹æ³•æŠ›å‡ºçš„æ˜¯<code>uncheck</code>å¼‚å¸¸ï¼ˆå³æœªç»æ£€æŸ¥çš„å¼‚å¸¸),ä¸ä¼šå¼ºåˆ¶å¼€å‘è€…æŠ›å‡ºã€‚<code>get()</code>æ–¹æ³•æŠ›å‡ºçš„æ˜¯ç»è¿‡æ£€æŸ¥çš„å¼‚å¸¸ï¼Œ<code>ExecutionException, InterruptedException </code>éœ€è¦ç”¨æˆ·æ‰‹åŠ¨å¤„ç†ï¼ˆæŠ›å‡ºæˆ–è€… <code>try catch</code>ï¼‰</p><p><strong>ç»“æœå¤„ç†</strong></p><p>å½“CompletableFutureçš„è®¡ç®—ç»“æœå®Œæˆï¼Œæˆ–è€…æŠ›å‡ºå¼‚å¸¸çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œç‰¹å®šçš„ Actionã€‚ä¸»è¦æ˜¯ä¸‹é¢çš„æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> CompletableFuture&lt;T&gt; <span class="title function_">whenComplete</span><span class="params">(BiConsumer&lt;? <span class="built_in">super</span> T,? <span class="built_in">super</span> Throwable&gt; action)</span></span><br><span class="line"><span class="keyword">public</span> CompletableFuture&lt;T&gt; <span class="title function_">whenCompleteAsync</span><span class="params">(BiConsumer&lt;? <span class="built_in">super</span> T,? <span class="built_in">super</span> Throwable&gt; action)</span></span><br><span class="line"><span class="keyword">public</span> CompletableFuture&lt;T&gt; <span class="title function_">whenCompleteAsync</span><span class="params">(BiConsumer&lt;? <span class="built_in">super</span> T,? <span class="built_in">super</span> Throwable&gt; action, Executor executor)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>Action</code>çš„ç±»å‹æ˜¯<code>BiConsumer&lt;? super T,? super Throwable&gt;</code>ï¼Œå®ƒå¯ä»¥å¤„ç†æ­£å¸¸çš„è®¡ç®—ç»“æœï¼Œæˆ–è€…å¼‚å¸¸æƒ…å†µã€‚<br>æ–¹æ³•ä¸ä»¥<code>Async</code>ç»“å°¾ï¼Œæ„å‘³ç€<code>Action</code>ä½¿ç”¨ç›¸åŒçš„çº¿ç¨‹æ‰§è¡Œï¼Œè€Œ<code>Async</code>å¯èƒ½ä¼šä½¿ç”¨å…¶å®ƒçš„çº¿ç¨‹å»æ‰§è¡Œ(å¦‚æœä½¿ç”¨ç›¸åŒçš„çº¿ç¨‹æ± ï¼Œä¹Ÿå¯èƒ½ä¼šè¢«åŒä¸€ä¸ªçº¿ç¨‹é€‰ä¸­æ‰§è¡Œ)ã€‚<br>è¿™å‡ ä¸ªæ–¹æ³•éƒ½ä¼šè¿”å›<code>CompletableFuture</code>ï¼Œå½“<code>Action</code>æ‰§è¡Œå®Œæ¯•åå®ƒçš„ç»“æœè¿”å›åŸå§‹çš„<code>CompletableFuture</code>çš„è®¡ç®—ç»“æœæˆ–è€…è¿”å›å¼‚å¸¸ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">CompletableFuture&lt;String&gt; future = CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        TimeUnit.SECONDS.sleep(<span class="number">1</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">Random</span>().nextInt(<span class="number">10</span>) % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">12</span> / <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(<span class="string">&quot;æ‰§è¡Œç»“æŸï¼&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;test&quot;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// ä»»åŠ¡å®Œæˆæˆ–å¼‚å¸¸æ–¹æ³•å®Œæˆæ—¶æ‰§è¡Œè¯¥æ–¹æ³•</span></span><br><span class="line"><span class="comment">// å¦‚æœå‡ºç°äº†å¼‚å¸¸,ä»»åŠ¡ç»“æœä¸ºnull</span></span><br><span class="line">future.whenComplete(<span class="keyword">new</span> <span class="title class_">BiConsumer</span>&lt;String, Throwable&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">accept</span><span class="params">(String t, Throwable action)</span> &#123;</span><br><span class="line">        System.out.println(t+<span class="string">&quot; æ‰§è¡Œå®Œæˆï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// å‡ºç°å¼‚å¸¸æ—¶å…ˆæ‰§è¡Œè¯¥æ–¹æ³•</span></span><br><span class="line">future.exceptionally(<span class="keyword">new</span> <span class="title class_">Function</span>&lt;Throwable, String&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">apply</span><span class="params">(Throwable t)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰§è¡Œå¤±è´¥ï¼š&quot;</span> + t.getMessage());</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;å¼‚å¸¸xxxx&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">future.get();</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç å½“å‡ºç°å¼‚å¸¸æ—¶ï¼Œè¾“å‡ºç»“æœå¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ‰§è¡Œå¤±è´¥ï¼šjava.lang.ArithmeticException: / by zero</span><br><span class="line">null æ‰§è¡Œå®Œæˆï¼</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> åç«¯ </tag>
            
            <tag> Future </tag>
            
            <tag> FutureTask </tag>
            
            <tag> å¹¶å‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ³•å¾‹å‚ç±»å¤§æ¨¡å‹DISC-LawGPTçš„éƒ¨ç½²è¿è¡Œå’Œå¯¹æ¯”</title>
      <link href="/2024/08/07/2024-08-07-%E6%B3%95%E5%BE%8B%E5%9E%82%E7%B1%BB%E5%A4%A7%E6%A8%A1%E5%9E%8BDISC-LawGPT%E7%9A%84%E9%83%A8%E7%BD%B2%E8%BF%90%E8%A1%8C%E5%92%8C%E5%AF%B9%E6%AF%94/"/>
      <url>/2024/08/07/2024-08-07-%E6%B3%95%E5%BE%8B%E5%9E%82%E7%B1%BB%E5%A4%A7%E6%A8%A1%E5%9E%8BDISC-LawGPT%E7%9A%84%E9%83%A8%E7%BD%B2%E8%BF%90%E8%A1%8C%E5%92%8C%E5%AF%B9%E6%AF%94/</url>
      
        <content type="html"><![CDATA[<h1 id="æ³•å¾‹å‚ç±»å¤§æ¨¡å‹DISC-LawGPTçš„éƒ¨ç½²è¿è¡Œå’Œå¯¹æ¯”"><a href="#æ³•å¾‹å‚ç±»å¤§æ¨¡å‹DISC-LawGPTçš„éƒ¨ç½²è¿è¡Œå’Œå¯¹æ¯”" class="headerlink" title="æ³•å¾‹å‚ç±»å¤§æ¨¡å‹DISC-LawGPTçš„éƒ¨ç½²è¿è¡Œå’Œå¯¹æ¯”"></a>æ³•å¾‹å‚ç±»å¤§æ¨¡å‹DISC-LawGPTçš„éƒ¨ç½²è¿è¡Œå’Œå¯¹æ¯”</h1><h2 id="éƒ¨ç½²å’Œè¿è¡Œ"><a href="#éƒ¨ç½²å’Œè¿è¡Œ" class="headerlink" title="éƒ¨ç½²å’Œè¿è¡Œ"></a>éƒ¨ç½²å’Œè¿è¡Œ</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">éƒ¨ç½²</span></span><br><span class="line">git clone https://github.com/FudanDISC/DISC-LawLLM.git</span><br><span class="line">cd DISC-LawLLM</span><br><span class="line">pip install -r requirements.txt</span><br><span class="line">mkdir ShengbinYue</span><br><span class="line">cd ShengbinYue</span><br><span class="line">git clone https://hf-mirror.com/ShengbinYue/DISC-LawLLM</span><br><span class="line">cd ..</span><br><span class="line">mkdir cache</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é‡åˆ°æŠ¥é”™ [Errno 13] Permission denied: <span class="string">&#x27;/data/.cache/huggingface/modules/transformers_modules/DISC-LawLLM&#x27;</span></span></span><br><span class="line">export HF_HOME=&quot;~/verticalLLM/lzjr/DISC-LawLLM/cache&quot; </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¦‚æœé‡åˆ°CUDA error: out of memory ç”¨ watch -n 0.5 nvidia-smiæŸ¥çœ‹æ˜¾å¡å ç”¨æƒ…å†µ å¦‚æœ<span class="built_in">kill</span>ä¸äº†ç›¸å…³è¿›ç¨‹ï¼Œå°±è¿è¡Œä¸‹é¢çš„æŒ‡ä»¤ï¼Œæ¯”å¦‚æœ‰ä¸‰å¼ å¡0,1,2,å…¶ä¸­2è¢«å¦ä¸€ä¸ªç¨‹åºå ç”¨äº†å¤§é‡æ˜¾å­˜ä¸”Killä¸äº†ï¼Œå°±ç”¨ä¸‹é¢çš„å‘½ä»¤</span></span><br><span class="line">export CUDA_VISIBLE_DEVICES=0,1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è¿è¡Œ</span></span><br><span class="line">python cli_demo.py</span><br></pre></td></tr></table></figure><p>è¿è¡ŒæˆåŠŸï¼š</p><p><img src="https://s2.loli.net/2024/08/07/oK1lrgLAFYdjhb3.png" alt="image-20240807123508410.png"></p><h2 id="æ€§èƒ½å¯¹æ¯”"><a href="#æ€§èƒ½å¯¹æ¯”" class="headerlink" title="æ€§èƒ½å¯¹æ¯”"></a>æ€§èƒ½å¯¹æ¯”</h2><ol><li><p>è¯·å¯¹ä»¥ä¸‹æ¡ˆä»¶åšå‡ºåˆ†æå¹¶ç»™å‡ºå¯èƒ½çš„åˆ¤å†³ï¼š2021å¹´11æœˆ9æ—¥ï¼ŒåŸå‘Šä¸è¢«å‘Šå—æ¹–å›½æ—…å…¬å¸ç­¾è®¢ã€Šç»¼åˆæˆä¿¡åè®®ã€‹ï¼Œçº¦å®šåŸå‘Šå‘è¢«å‘Šå—æ¹–å…¬å¸æä¾›æˆä¿¡é¢åº¦1000ä¸‡å…ƒã€‚åŒæ—¥ï¼ŒåŸå‘Šä¸è¢«å‘Šå—æ¹–å›½æ—…å…¬å¸ã€å—æ¹–ç²¤é€”å…¬å¸ã€ç‹å­å±±å…¬å¸ã€å¸ƒæŸã€éƒ­æŸã€éƒ‘æŸã€åˆ˜æŸã€å¾æŸã€èƒ¡æŸã€èµµæŸã€è®¸æŸç­¾è®¢ã€Šæœ€é«˜é¢ä¿è¯åˆåŒã€‹ï¼Œçº¦å®šä¸ºä¸Šè¿°å€ºåŠ¡æä¾›æœ€é«˜é¢ä¿è¯æ‹…ä¿ã€‚2021å¹´11æœˆ10æ—¥ï¼ŒåŸå‘Šä¸è¢«å‘Šå—æ¹–å›½æ—…å…¬å¸ç­¾è®¢ã€ŠæµåŠ¨èµ„é‡‘å€Ÿæ¬¾åˆåŒã€‹ï¼Œçº¦å®šè´·æ¬¾é‡‘é¢åˆ†åˆ«ä¸º1000ä¸‡å…ƒï¼Œ2021å¹´1æœˆ10æ—¥ï¼ŒåŸå‘Šä¾çº¦å‘æ”¾ä¸Šè¿°è´·æ¬¾ã€‚ä½†è¢«å‘Šå—æ¹–å›½æ—…å…¬å¸åœ¨åŸå‘Šå‘æ”¾è´·æ¬¾åçš„2ä¸ªæœˆå†…ï¼Œæ–°å¢æ•°åç¬”æ‰§è¡Œæ¡ˆä»¶ï¼Œä¸¥é‡å±åŠåŸå‘Šå€ºæƒï¼Œè¢«å‘Šå¸ƒæŸä½œä¸ºä¿è¯äººï¼Œä¹Ÿå‘ç”Ÿæ–°çš„é‡å¤§æ‰§è¡Œæ¡ˆä»¶ï¼Œä¸”åœ¨å‘ç”Ÿä¸Šè¿°æƒ…å†µåï¼Œå‡æœªåŠæ—¶ä¹¦é¢é€šçŸ¥åŸå‘Šã€‚</p><ul><li><p>DISC-LawGPTï¼š</p><p><img src="https://s2.loli.net/2024/08/07/eoKcCgHjTyqQDv9.png" alt="image-20240807131707454.png"></p></li><li><p>Kimi:</p><p><img src="https://s2.loli.net/2024/08/07/FwzhXucij3eyK5I.png" alt="image-20240807131726207.png"></p></li></ul></li><li><p>è¯·å¯¹ä»¥ä¸‹æ¡ˆä»¶åšå‡ºåˆ†æå¹¶ç»™å‡ºå¯èƒ½çš„åˆ¤å†³ï¼š2021å¹´4æœˆ17æ—¥ï¼Œåˆ˜æŸ1å‘åˆ˜æŸå‡ºå…·å€Ÿæ¡ä¸€ä»½ï¼Œå†…å®¹ä¸ºï¼šâ€œå€Ÿæ¡ä»Šå€Ÿåˆ°ç°é‡‘è´°æ‹¾ä¸‡å…ƒï¼ˆï¿¥200000.00ï¼‰å€Ÿæ¬¾äººï¼šåˆ˜æŸ1ï¼ˆæºå°ï¼‰2021.4æœˆ17å·â€åˆ˜æŸé€šè¿‡å¾®ä¿¡è½¬è´¦æ–¹å¼å‘åˆ˜æŸ1äº¤ä»˜å‡ºå€Ÿæ¬¾ï¼Œåˆ†åˆ«ä¸º2021å¹´4æœˆ17æ—¥è½¬è´¦30000å…ƒã€30000å…ƒã€30000å…ƒã€10000å…ƒï¼Œ2021å¹´5æœˆ29æ—¥è½¬è´¦30000å…ƒã€20000å…ƒã€30000å…ƒã€20000å…ƒï¼Œå…±è®¡200000å…ƒã€‚è‡³æœ¬æ¬¡è¯‰è®¼ï¼Œåˆ˜æŸ1é€šè¿‡å¾®ä¿¡è½¬è´¦è¿˜æ¬¾61500å…ƒï¼Œå°šæ¬ 138500å…ƒã€‚</p><ul><li><p>DISC-LawGPTï¼š</p><p><img src="https://s2.loli.net/2024/08/07/iqcLWBl2a9uysOx.png" alt="image-20240807132055034.png"></p></li><li><p>Kimi:</p><p><img src="https://s2.loli.net/2024/08/07/meUoVv8lhtfRnX2.png" alt="image-20240807132106568.png"></p></li></ul></li><li><p>åŠ³åŠ¨è€…ï¼ˆæ­£å¼å·¥ï¼‰æœªæå‰30æ—¥å‘ŠçŸ¥ç”¨äººå•ä½å³ç¦»èŒï¼Œéœ€è¦æ”¯ä»˜è¿çº¦é‡‘å—ï¼Ÿ</p><ul><li><p>DISC-LawGPT</p><p><img src="https://s2.loli.net/2024/08/07/ETL7JypSWdkaAbh.png" alt="image-20240807132306145.png"></p></li><li><p>Kimi:</p><p><img src="https://s2.loli.net/2024/08/07/46CNPuW38xb9QYZ.png" alt="image-20240807132324700.png"></p></li></ul></li><li><p>è¯·å¯¹ä»¥ä¸‹æ¡ˆä»¶åšå‡ºåˆ†æå¹¶ç»™å‡ºå¯èƒ½çš„åˆ¤å†³ï¼šåŸå‘Šä¸è¢«å‘Šäº2020å¹´8æœˆ11æ—¥ç­¾è®¢ã€Šå†…æ±Ÿå¸ˆèŒƒå­¦é™¢æ–°æ ¡åŒºå»ºè®¾å·¥ç¨‹é…ç”µç®±ä¹°å–åˆåŒã€‹ï¼ŒåŒæ–¹çº¦å®šç”±åŸå‘Šå‘è¢«å‘Šå†…æ±Ÿå¸ˆèŒƒå­¦é™¢æ–°æ ¡åŒºé¡¹ç›®æä¾›é…ç”µç®±è®¾å¤‡ï¼ŒåˆåŒæš‚å®šåˆè®¡1262676.36å…ƒï¼ŒåŒæ–¹å¹¶å°±ä¾›è´§æœŸé™ã€è¿è¾“åŠäº¤è´§æ–¹å¼ã€éªŒæ”¶ã€è´§æ¬¾æ”¯ä»˜ã€äº‰è®®è§£å†³ç­‰è¿›è¡Œçº¦å®šã€‚åˆåŒç­¾è®¢åï¼ŒåŸå‘Šä¾çº¦å±¥è¡Œï¼Œè‡³2021å¹´5æœˆ6æ—¥å®Œæˆå…¨éƒ¨ä¾›è´§ï¼Œå®é™…ä¾›è´§é‡‘é¢1164220.59å…ƒï¼Œå¹¶å·²å‘è¢«å‘Šå¼€å…·å…¨é¢å‘ç¥¨ã€‚ç°è¢«å‘Šå·²æ”¯ä»˜è´§æ¬¾695000å…ƒï¼Œå‰©ä½™è´§æ¬¾469220.59å…ƒæœªæ”¯ä»˜ã€‚å¦å¤–ï¼ŒåŸå‘Šäº2020å¹´8æœˆ31æ—¥å‘è¢«å‘Šç¼´çº³äº†è¯¥é¡¹ç›®å±¥çº¦ä¿è¯é‡‘63133å…ƒï¼Œè¢«å‘Šæœªäºˆé€€è¿˜ã€‚</p><ul><li><p>DISC-LawGPT:</p><p><img src="https://s2.loli.net/2024/08/07/5ZztM1dk8SrwAHq.png" alt="image-20240807132716297.png"></p></li><li><p>Kimi:</p><p><img src="https://s2.loli.net/2024/08/07/2SBbJ4cG5fxwpYT.png" alt="image-20240807132607039.png"></p></li></ul></li><li><p>ç½‘è´­å•†å“ç”¨å¿«é€’é€è¾¾ï¼Œå•†å“åœ¨å¿«é€’é€”ä¸­ã€ç­¾æ”¶ä¹‹å‰æ¯æŸçš„é£é™©è°æ‰¿æ‹…ï¼Ÿ</p><ul><li><p>DISC-LawGPT:</p><p><img src="https://s2.loli.net/2024/08/07/ta5LNwDUFjI7bCW.png" alt="image-20240807133036171.png"></p></li><li><p>Kimi:</p><p><img src="https://s2.loli.net/2024/08/07/aibWvgdDErx1ehN.png" alt="image-20240807132754350.png"></p></li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> å¤§æ¨¡å‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LLM </tag>
            
            <tag> DISC-LawGPTt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaçº¿ç¨‹ã€å¤šçº¿ç¨‹ä¸çº¿ç¨‹æ± æ€»ç»“</title>
      <link href="/2024/08/07/2024-08-07-Java%E7%BA%BF%E7%A8%8B%E3%80%81%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B%E6%B1%A0%E6%80%BB%E7%BB%93/"/>
      <url>/2024/08/07/2024-08-07-Java%E7%BA%BF%E7%A8%8B%E3%80%81%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8E%E7%BA%BF%E7%A8%8B%E6%B1%A0%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h1 id="Javaçº¿ç¨‹ã€å¤šçº¿ç¨‹ä¸çº¿ç¨‹æ± æ€»ç»“"><a href="#Javaçº¿ç¨‹ã€å¤šçº¿ç¨‹ä¸çº¿ç¨‹æ± æ€»ç»“" class="headerlink" title="Javaçº¿ç¨‹ã€å¤šçº¿ç¨‹ä¸çº¿ç¨‹æ± æ€»ç»“"></a>Javaçº¿ç¨‹ã€å¤šçº¿ç¨‹ä¸çº¿ç¨‹æ± æ€»ç»“</h1><h2 id="Javaåˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹æ³•"><a href="#Javaåˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹æ³•" class="headerlink" title="Javaåˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹æ³•"></a>Javaåˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹æ³•</h2><ol><li><p><strong>ç»§æ‰¿Threadç±»åˆ›å»ºçº¿ç¨‹ç±» ï¼ˆextendsï¼‰</strong></p><ol><li><p>å®šä¹‰Threadç±»çš„å­ç±»ï¼Œå¹¶é‡å†™è¯¥ç±»çš„runæ–¹æ³•ï¼Œè¯¥runæ–¹æ³•çš„æ–¹æ³•ä½“å°±ä»£è¡¨äº†çº¿ç¨‹è¦å®Œæˆçš„ä»»åŠ¡ã€‚å› æ­¤æŠŠrun()æ–¹æ³•ç§°ä¸ºæ‰§è¡Œä½“(çº¿ç¨‹ä½“)ã€‚</p></li><li><p>åˆ›å»ºThreadå­ç±»çš„å®ä¾‹ï¼Œå³åˆ›å»ºäº†çº¿ç¨‹å¯¹è±¡ã€‚</p></li><li><p>è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„start()æ–¹æ³•æ¥å¯åŠ¨è¯¥çº¿ç¨‹ã€‚ </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CreateThreadByExtendThread</span> <span class="keyword">extends</span> <span class="title class_">Thread</span>&#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (;i&lt;<span class="number">100</span>;i++)&#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName()+<span class="string">&quot;:&quot;</span>+i); <span class="comment">//è·å–æœ¬çº¿ç¨‹çš„åç§°</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[]args)</span>&#123;</span><br><span class="line">        <span class="type">CreateThreadByExtendThread</span> <span class="variable">c1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CreateThreadByExtendThread</span>();</span><br><span class="line">        <span class="type">CreateThreadByExtendThread</span> <span class="variable">c2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CreateThreadByExtendThread</span>();</span><br><span class="line">        c1.start();</span><br><span class="line">        c2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol></li><li><p><strong>é€šè¿‡Runnableæ¥å£åˆ›å»ºçº¿ç¨‹ç±»</strong></p><ol><li><p>å®šä¹‰runnableæ¥å£çš„å®ç°ç±»ï¼Œå¹¶é‡å†™è¯¥æ¥å£çš„run()æ–¹æ³•ï¼Œè¯¥run()æ–¹æ³•çš„æ–¹æ³•ä½“åŒæ ·æ˜¯è¯¥çº¿ç¨‹çš„çº¿ç¨‹æ‰§è¡Œä½“ã€‚</p></li><li><p>åˆ›å»º Runnableå®ç°ç±»çš„å®ä¾‹ï¼Œå¹¶ä»¥æ­¤å®ä¾‹ä½œä¸ºThreadçš„targetæ¥åˆ›å»ºThreadå¯¹è±¡ï¼Œè¯¥Threadå¯¹è±¡æ‰æ˜¯çœŸæ­£çš„çº¿ç¨‹å¯¹è±¡ã€‚</p></li><li><p>è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„start()æ–¹æ³•æ¥å¯åŠ¨è¯¥çº¿ç¨‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CreateThreadByImplementRunnable</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span>&#123;</span><br><span class="line">    <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(i&lt;<span class="number">100</span>)&#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName()+<span class="string">&quot;:&quot;</span>+i++);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        CreateThreadByImplementRunnable createThreadByImplementRunnable1=<span class="keyword">new</span> <span class="title class_">CreateThreadByImplementRunnable</span>();</span><br><span class="line">        CreateThreadByImplementRunnable createThreadByImplementRunnable2=<span class="keyword">new</span> <span class="title class_">CreateThreadByImplementRunnable</span>();</span><br><span class="line">        Thread thread1= <span class="keyword">new</span> <span class="title class_">Thread</span>(createThreadByImplementRunnable1,<span class="string">&quot;Thread-1&quot;</span>);</span><br><span class="line">        Thread thread2= <span class="keyword">new</span> <span class="title class_">Thread</span>(createThreadByImplementRunnable2,<span class="string">&quot;Thread-2&quot;</span>);</span><br><span class="line">        thread1.start();</span><br><span class="line">        thread2.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol></li><li><p><strong>é€šè¿‡Callableå’ŒFutureåˆ›å»ºçº¿ç¨‹</strong></p><p>callable-&gt;callableå®ç°ç±»-&gt;FutureTask&lt;&gt;(callableå®ç°ç±»å®ä¾‹)-&gt;Threadï¼ˆfuturetaskå®ä¾‹ï¼‰</p><ol><li><p>åˆ›å»ºCallableæ¥å£çš„å®ç°ç±»ï¼Œå¹¶å®ç°call()æ–¹æ³•ï¼Œè¯¥<em><strong>call()æ–¹æ³•å°†ä½œä¸ºçº¿ç¨‹æ‰§è¡Œä½“ï¼Œå¹¶ä¸”æœ‰è¿”å›å€¼</strong></em>ã€‚</p></li><li><p>åˆ›å»ºCallableå®ç°ç±»çš„å®ä¾‹ï¼Œä½¿ç”¨FutureTaskç±»æ¥åŒ…è£…Callableå¯¹è±¡ï¼Œè¯¥FutureTaskå¯¹è±¡å°è£…äº†è¯¥Callableå¯¹è±¡çš„call()æ–¹</p><p>æ³•çš„è¿”å›å€¼ã€‚ï¼ˆFutureTaskæ˜¯ä¸€ä¸ªåŒ…è£…å™¨ï¼Œå®ƒé€šè¿‡æ¥å—Callableæ¥åˆ›å»ºï¼Œå®ƒåŒæ—¶å®ç°äº†Futureå’ŒRunnableæ¥å£ï¼‰</p></li><li><p>ä½¿ç”¨FutureTaskå¯¹è±¡ä½œä¸ºThreadå¯¹è±¡çš„targetåˆ›å»ºå¹¶å¯åŠ¨æ–°çº¿ç¨‹ã€‚</p></li><li><p>è°ƒç”¨FutureTaskå¯¹è±¡çš„get()æ–¹æ³•æ¥è·å¾—å­çº¿ç¨‹æ‰§è¡Œç»“æŸåçš„è¿”å›å€¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.Callable;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.FutureTask;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CreateThreadByImplementCallable</span> <span class="keyword">implements</span> <span class="title class_">Callable</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">call</span><span class="params">()</span><span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(;i&lt;<span class="number">100</span>;i++)&#123;</span><br><span class="line">            System.out.println(Thread.currentThread().getName()+<span class="string">&quot; &quot;</span>+i);</span><br><span class="line">            Thread.sleep(<span class="number">100</span>); <span class="comment">// ä¼‘çœ 100ms</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[]args)</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;<span class="number">20</span>;i++)&#123;</span><br><span class="line">            <span class="type">CreateThreadByImplementCallable</span> <span class="variable">ct</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CreateThreadByImplementCallable</span>();</span><br><span class="line">            FutureTask&lt;Integer&gt; ft = <span class="keyword">new</span> <span class="title class_">FutureTask</span>&lt;&gt;(ct);</span><br><span class="line">            <span class="type">Thread</span> <span class="variable">t</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(ft);</span><br><span class="line">            t.start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol></li></ol><h2 id="Javaåˆ›å»ºçº¿ç¨‹æ± çš„äº”ç§æ–¹æ³•"><a href="#Javaåˆ›å»ºçº¿ç¨‹æ± çš„äº”ç§æ–¹æ³•" class="headerlink" title="Javaåˆ›å»ºçº¿ç¨‹æ± çš„äº”ç§æ–¹æ³•"></a>Javaåˆ›å»ºçº¿ç¨‹æ± çš„äº”ç§æ–¹æ³•</h2><p>ç»§æ‰¿çš„ExecutorServiceæ¥å£</p><ol><li><p><strong>newCachedThreadPool</strong>ï¼ˆæ²¡æœ‰ä¸Šé™çš„çº¿ç¨‹æ± ï¼‰ï¼Œå¦‚æœçº¿ç¨‹æ± é•¿åº¦è¶…è¿‡å¤„ç†éœ€è¦ï¼Œå¯çµæ´»å›æ”¶ç©ºé—²çº¿ç¨‹ï¼Œè‹¥æ— å¯å›æ”¶ï¼Œåˆ™æ–°å»ºçº¿ç¨‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ExecutorService</span> <span class="variable">cachedThreadPool</span> <span class="operator">=</span> Executors.newCachedThreadPool();</span><br><span class="line">cachedThreadPool.execute(<span class="keyword">new</span> <span class="title class_">Runnable</span>()&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰§è¡Œçº¿ç¨‹ä»»åŠ¡&quot;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p><strong>newFixdedThreadPool</strong>ï¼ˆæœ‰ä¸Šé™çš„çº¿ç¨‹æ± ï¼‰ï¼Œåˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œå¯æ§åˆ¶çº¿ç¨‹æœ€å¤§å¹¶å‘æ•°ï¼Œè¶…å‡ºçš„çº¿ç¨‹ä¼šåœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ExecutorService</span> <span class="variable">fixedThreadPool</span> <span class="operator">=</span> Executors.newFixedThreadPool(<span class="number">3</span>);</span><br><span class="line">fixedThreadPool.execute(<span class="keyword">new</span> <span class="title class_">Runnable</span>()&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ‰§è¡Œçº¿ç¨‹ä»»åŠ¡&quot;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p><strong>newScheduledThreadPool</strong>ï¼Œåˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œæ”¯æŒå®šæ—¶åŠå‘¨æœŸæ€§ä»»åŠ¡æ‰§è¡Œã€‚å»¶è¿Ÿæ‰§è¡Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ScheduledExecutorService</span> <span class="variable">scheduledThreadPool</span> <span class="operator">=</span> Executors.newScheduledThreadPool(<span class="number">5</span>);</span><br><span class="line">scheduledThreadPool.schedule(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;delay 3 seconds&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, <span class="number">3</span>, TimeUnit.SECONDS);<span class="comment">//å»¶è¿Ÿä¸‰ç§’æ‰§è¡Œ</span></span><br></pre></td></tr></table></figure></li><li><p><strong>newSingleThreadExecutor</strong>ï¼Œåˆ›å»ºä¸€ä¸ª<strong>å•çº¿ç¨‹åŒ–</strong>çš„çº¿ç¨‹æ± ï¼Œå®ƒåªä¼šç”¨å”¯ä¸€çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œä¿è¯æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§æŒ‡å®šé¡ºåº(FIFO, LIFO, ä¼˜å…ˆçº§)æ‰§è¡Œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ExecutorService</span> <span class="variable">executorService</span> <span class="operator">=</span> Executors.newSingleThreadExecutor();</span><br><span class="line">executorService.execute(<span class="keyword">new</span> <span class="title class_">Runnable</span>()&#123;</span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;æ‰§è¡Œçº¿ç¨‹ä»»åŠ¡&quot;</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li><li><p><strong>ThreadPoolExecutor</strong>ï¼ˆè‡ªå®šä¹‰åˆ›å»ºçº¿ç¨‹æ± ï¼‰</p><ul><li><p>å®ƒæœ€é•¿çš„æ„é€ æ–¹æ³•æœ‰ä¸ƒä¸ªå‚æ•°ã€‚</p><ol><li>æ ¸å¿ƒçº¿ç¨‹æ•°é‡â€”â€”åœ¨çº¿ç¨‹æ± å½“ä¸­æ— è®ºç©ºé—²å¤šä¹…éƒ½ä¸ä¼šè¢«åˆ é™¤çš„çº¿ç¨‹</li><li>çº¿ç¨‹æ± å½“ä¸­æœ€å¤§çš„çº¿ç¨‹æ•°é‡â€”â€”çº¿ç¨‹æ± å½“ä¸­æœ€å¤§èƒ½åˆ›å»ºçš„çº¿ç¨‹æ•°é‡</li><li>ç©ºé—²æ—¶é—´ï¼ˆæ•°å€¼ï¼‰â€”â€”ä¸´æ—¶çº¿ç¨‹ï¼ˆçº¿ç¨‹æ± ä¸­å‡ºæ ¸å¿ƒçº¿ç¨‹ä¹‹å¤–çš„çº¿ç¨‹ï¼‰ç©ºé—²äº†å¤šä¹…å°±ä¼šè¢«æ·˜æ±°çš„æ—¶é—´ã€‚</li><li>ç©ºé—²æ—¶é—´ï¼ˆå•ä½ï¼‰â€”â€”ä¸´æ—¶çº¿ç¨‹ç©ºé—²äº†å¤šä¹…å°±ä¼šè¢«æ·˜æ±°çš„æ—¶é—´å•ä½ï¼Œè¦ç”¨æšä¸¾ç±»TimeUnitç±»ä½œä¸ºå‚æ•°</li><li>é˜»å¡é˜Ÿåˆ—â€”â€”å°±æ˜¯åˆ›å»ºä¸€ä¸ªé˜»å¡é˜Ÿåˆ—ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œå°±æ˜¯å½“çº¿ç¨‹æ± å½“ä¸­çº¿ç¨‹æ•°é‡å·²ç»è¾¾åˆ°äº†æœ€å¤§çº¿ç¨‹æ•°é‡ï¼Œå…è®¸å¤šå°‘ä¸ªä»»åŠ¡æ’é˜Ÿè·å–çº¿ç¨‹ï¼Œå…¶ä½™çš„ç”¨å‚æ•°ä¸ƒé‚£ä¸ªæ–¹æ¡ˆæ¥å¤„ç†ã€‚</li><li>åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼â€”â€”ä¸æ˜¯newä¸€ä¸ªçº¿ç¨‹ï¼Œè€Œæ˜¯ä¼ å…¥ä¸€ä¸ªçº¿ç¨‹å·¥å‚ï¼ˆä¾‹å¦‚ï¼šExecutorså·¥å…·ç±»ä¸­çš„defaultThreadFactoryæ–¹æ³•è¿”å›çš„å°±æ˜¯ä¸€ä¸ªçº¿ç¨‹å·¥å‚ï¼‰</li><li>è¦æ‰§è¡Œçš„ä»»åŠ¡è¿‡å¤šæ—¶çš„è§£å†³æ–¹æ¡ˆâ€”â€”å½“ç­‰å¾…é˜Ÿåˆ—ä¸­ä¹Ÿæ’æ»¡æ—¶è¦æ€ä¹ˆå¤„ç†è¿™äº›ä»»åŠ¡(ä»»åŠ¡æ‹’ç»ç­–ç•¥)</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ä»£ç å®ç°</span></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¹‹å‰ç”¨å·¥å…·ç±»è¿›è¡Œåˆ›å»ºï¼Œæœ‰å¥½å¤šå‚æ•°ä¸èƒ½è‡ªå·±è®¾ç½®</span></span><br><span class="line"><span class="comment">     * å’±ç›´æ¥è‡ªå·±æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ï¼Œè‡ªå·±è®¾ç½®å‚æ•°</span></span><br><span class="line"><span class="comment">     * å‚æ•°ä¸€ï¼šæ ¸å¿ƒçº¿ç¨‹æ•°é‡                           ä¸èƒ½å°äº0</span></span><br><span class="line"><span class="comment">     * å‚æ•°äºŒï¼šæœ€å¤§çº¿ç¨‹æ•°                             ä¸èƒ½å°äº0ï¼Œæ•°å€¼å¤§äºç­‰äºæ ¸å¿ƒçº¿ç¨‹æ•°é‡</span></span><br><span class="line"><span class="comment">     * å‚æ•°ä¸‰ï¼šç©ºé—²ä¸´æ—¶çº¿ç¨‹æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆæ•°å€¼ï¼‰           ä¸èƒ½å°äº0</span></span><br><span class="line"><span class="comment">     * å‚æ•°å››ï¼šç©ºé—²ä¸´æ—¶çº¿ç¨‹æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆå•ä½ï¼‰            ç”¨TimeUnitè¿™ä¸ªæšä¸¾ç±»è¡¨ç¤º</span></span><br><span class="line"><span class="comment">     * å‚æ•°äº”ï¼šä»»åŠ¡é˜Ÿåˆ—ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå µå¡é˜Ÿåˆ—               ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">     * å‚æ•°å…­:åˆ›å»ºçº¿ç¨‹çš„å·¥å‚                            ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">     * å‚æ•°ä¸ƒï¼šä»»åŠ¡çš„æ‹’ç»ç­–ç•¥                             ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"> <span class="type">ThreadPoolExecutor</span> <span class="variable">threadPoolExecutor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(</span><br><span class="line">        <span class="number">3</span>,  <span class="comment">// æ ¸å¿ƒçº¿ç¨‹æ•°é‡</span></span><br><span class="line">        <span class="number">6</span>,              <span class="comment">//æœ€å¤§çº¿ç¨‹æ•°</span></span><br><span class="line">        <span class="number">60</span>,             <span class="comment">//ç©ºé—²ä¸´æ—¶çº¿ç¨‹æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆæ•°å€¼ï¼‰</span></span><br><span class="line">        TimeUnit.SECONDS,<span class="comment">//ç©ºé—²ä¸´æ—¶çº¿ç¨‹æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆå•ä½ï¼‰</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">ArrayBlockingQueue</span>&lt;&gt;(<span class="number">3</span>),<span class="comment">//ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå µå¡é˜Ÿåˆ—ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨LinkedBlockingQueueè¿™ä¸ªé˜»å¡é˜Ÿåˆ—</span></span><br><span class="line">        Executors.defaultThreadFactory(),<span class="comment">//ç”¨çº¿ç¨‹æ± å·¥å…·ç±»Executorsåˆ›å»ºçº¿ç¨‹çš„å·¥å‚</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>.AbortPolicy()<span class="comment">//ä»»åŠ¡çš„æ‹’ç»ç­–ç•¥ä¸­å…¶ä¸­ä¸€ä¸ªï¼Œä¸¢å¼ƒä»»åŠ¡å¹¶æŠ›å‡ºRejectedExecutionException</span></span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></li></ul></li></ol><p><img src="https://s2.loli.net/2024/08/04/fTsqWtGjBRbrVxS.png" alt="image-20240804205131842.png"></p><h2 id="ExecutorServiceçš„submitå’Œexecuteçš„åŒºåˆ«"><a href="#ExecutorServiceçš„submitå’Œexecuteçš„åŒºåˆ«" class="headerlink" title="ExecutorServiceçš„submitå’Œexecuteçš„åŒºåˆ«"></a>ExecutorServiceçš„submitå’Œexecuteçš„åŒºåˆ«</h2><p>åœ¨ Java ä¸­ï¼ŒExecutorService æ¥å£æ˜¯ç”¨äºç®¡ç†å’Œæ‰§è¡Œçº¿ç¨‹çš„æ¡†æ¶ï¼Œå®ƒå®šä¹‰äº†ä¸¤ä¸ªç”¨äºæäº¤ä»»åŠ¡çš„æ–¹æ³•ï¼šsubmit() å’Œ execute()ã€‚è¿™ä¸¤ç§æ–¹æ³•æœ‰ä¸€äº›åŒºåˆ«ï¼š</p><ol><li><p>è¿”å›å€¼ï¼š</p><ul><li>submit() æ–¹æ³•æ¥å— <strong>Callable</strong>ï¼ˆå› ä¸ºå®ç°Callableçš„callä¹Ÿæœ‰è¿”å›å€¼å˜›ï¼Œè€Œä¸”è¿˜è¦æŠ›å‡ºå¼‚å¸¸ï¼‰ æˆ– Runnable ä»»åŠ¡ï¼Œå¹¶è¿”å›ä¸€ä¸ª Future å¯¹è±¡ï¼Œå¯ä»¥ç”¨äºè·å–ä»»åŠ¡çš„æ‰§è¡Œç»“æœæˆ–å–æ¶ˆä»»åŠ¡çš„æ‰§è¡Œã€‚</li><li>execute() æ–¹æ³•æ¥å— Runnable ä»»åŠ¡ï¼Œä½†å®ƒæ²¡æœ‰è¿”å›å€¼ï¼Œå› æ­¤æ— æ³•è·å–ä»»åŠ¡çš„æ‰§è¡Œç»“æœã€‚</li></ul></li><li><p>å¼‚å¸¸å¤„ç†ï¼š</p><ul><li>submit() æ–¹æ³•å¯ä»¥æ•è·ä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­æŠ›å‡ºçš„å¼‚å¸¸ï¼Œå¹¶é€šè¿‡ Future å¯¹è±¡çš„ get() æ–¹æ³•æŠ›å‡ºï¼Œä»è€Œå®ç°å¯¹å¼‚å¸¸çš„å¤„ç†ã€‚</li><li>execute() æ–¹æ³•æ— æ³•æ•è·ä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­çš„å¼‚å¸¸ï¼Œå› ä¸ºå®ƒæ²¡æœ‰è¿”å›å€¼ã€‚</li></ul></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.ExecutorService;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Executors;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Future;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Callable;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubmitVsExecuteExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">ExecutorService</span> <span class="variable">executorService</span> <span class="operator">=</span> Executors.newSingleThreadExecutor();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä½¿ç”¨ submit() æäº¤ Callable ä»»åŠ¡</span></span><br><span class="line">        Future&lt;String&gt; future = executorService.submit(<span class="keyword">new</span> <span class="title class_">MyCallable</span>());</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> future.get();</span><br><span class="line">            System.out.println(<span class="string">&quot;Submit Result: &quot;</span> + result);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä½¿ç”¨ execute() æäº¤ Runnable ä»»åŠ¡</span></span><br><span class="line">        executorService.execute(<span class="keyword">new</span> <span class="title class_">MyRunnable</span>());</span><br><span class="line"></span><br><span class="line">        executorService.shutdown();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyCallable</span> <span class="keyword">implements</span> <span class="title class_">Callable</span>&lt;String&gt; &#123;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">call</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">            TimeUnit.SECONDS.sleep(<span class="number">2</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Callable task completed&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">MyRunnable</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Runnable task completed&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> åç«¯ </tag>
            
            <tag> çº¿ç¨‹æ±  </tag>
            
            <tag> å¤šçº¿ç¨‹ </tag>
            
            <tag> çº¿ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaé¢è¯•æ±‡æ€»</title>
      <link href="/2024/08/06/2024-08-06-Java%E9%9D%A2%E8%AF%95%E6%B1%87%E6%80%BB/"/>
      <url>/2024/08/06/2024-08-06-Java%E9%9D%A2%E8%AF%95%E6%B1%87%E6%80%BB/</url>
      
        <content type="html"><![CDATA[<h1 id="Javaé¢è¯•æ±‡æ€»"><a href="#Javaé¢è¯•æ±‡æ€»" class="headerlink" title="Javaé¢è¯•æ±‡æ€»"></a>Javaé¢è¯•æ±‡æ€»</h1><h2 id="é¡¹ç›®é—®é¢˜"><a href="#é¡¹ç›®é—®é¢˜" class="headerlink" title="é¡¹ç›®é—®é¢˜"></a>é¡¹ç›®é—®é¢˜</h2><h3 id="æ•°è”ç½‘äº¤æ¢æœº"><a href="#æ•°è”ç½‘äº¤æ¢æœº" class="headerlink" title="æ•°è”ç½‘äº¤æ¢æœº"></a>æ•°è”ç½‘äº¤æ¢æœº</h3><p><a href="https://blog.csdn.net/xiaojiejie_baby/article/details/136445150?ops_request_misc=%7B%22request_id%22:%22D9065D87-9E90-424F-8F26-052C345CCA28%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=D9065D87-9E90-424F-8F26-052C345CCA28&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-2-136445150-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=netty%E9%9D%A2%E7%BB%8F&spm=1018.2226.3001.4187">Nettyæ ¸å¿ƒé¢è¯•é¢˜20è¿é—®ï¼Œç”±æµ…å…¥æ·± åŠ©ä½ è½»æ¾åŠæ‰“é¢è¯•å®˜_nettyé¢è¯•é¢˜-CSDNåšå®¢</a></p><h3 id="programmer-club"><a href="#programmer-club" class="headerlink" title="programmer club"></a>programmer club</h3><p><a href="https://roger-lv.github.io/2024/07/21/2024-07-21-%E5%90%8E%E7%AB%AF%E5%BE%AE%E6%9C%8D%E5%8A%A1-programmer-club%E9%A1%B9%E7%9B%AE%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%E5%BF%83%E5%BE%97/">åç«¯å¾®æœåŠ¡-programmer-clubé¡¹ç›®çš„è®¾è®¡ä¸å®ç°å¿ƒå¾— | Roger-Lvâ€™s space</a></p><h4 id="é¡¹ç›®ä»‹ç»"><a href="#é¡¹ç›®ä»‹ç»" class="headerlink" title="é¡¹ç›®ä»‹ç»"></a>é¡¹ç›®ä»‹ç»</h4><p>â€‹å¥½çš„ï¼Œé¢è¯•å®˜ï¼Œæ¥ä¸‹æ¥æˆ‘æ¥é˜è¿°ä¸€ä¸ªè¿™ä¸ªé¡¹ç›®çš„ä¸šåŠ¡æ˜¯ä»€ä¹ˆã€‚è¿™ä¸ªé¡¹ç›®ä¸»è¦æ˜¯æˆ‘åœ¨å­¦æ ¡å’Œå‡ ä¸ªå°ä¼™ä¼´ä¸€èµ·æ¥åšçš„ï¼ŒèƒŒæ™¯ä¸»è¦æ˜¯æˆ‘ä»¬æ˜¯å­¦æ ¡çš„è½¯ä»¶å·¥ç¨‹ä¸“ä¸šï¼Œæœ¬ç§‘å­˜åœ¨â€œå·¥ä½œå®¤â€è¿™ä¹ˆä¸€ä¸ªæ¦‚å¿µçš„ç»„ç»‡ï¼Œç„¶åæ¯å¹´æˆ‘ä»¬å¤§ä¸‰ä¸‹éƒ½ä¼šæœ‰åŠå¹´çš„å®ä¹ æ—¶é—´ï¼Œå¤§å®¶åœ¨æ±‚èŒçš„è¿‡ç¨‹ä¸­ï¼Œå…ä¸äº†è¦è¿›è¡Œé¢è¯•é¢˜çš„å­¦ä¹ ï¼Œç½‘ä¸Šçš„pdf å¾ˆå¤šï¼Œå¤§å®¶ä¸€èˆ¬éƒ½æ˜¯åŸºäºæ­¤æ¥è¿›è¡ŒèƒŒè¯µæˆ–è€…æ”¶é›†ï¼Œé‡å¤çš„é¢˜ç›®åŠç­”æ¡ˆçš„è´¨é‡å‚å·®ä¸é½ï¼Œæˆ‘ä»¬å’Œè€å¸ˆå°±éƒ½æœ‰ä¸€ä¸ªæƒ³æ³•ï¼Œåšä¸€ä¸ªçº¿ä¸ŠåŒ–çš„é¢è¯•é¢˜ç½‘ç«™ï¼Œæ¥è¿›è¡Œèµ„æºæ•´åˆã€‚å­¦ä¹ é¢è¯•çš„åŒæ—¶ï¼Œå°†æ‰€å­¦ä¹ çš„æŠ€æœ¯ç»“åˆåˆ°ä¸€èµ·ã€‚æˆ‘ä»¬é‡‡ç”¨çš„æ˜¯ä¸»æµçš„å¾®æœåŠ¡æ¶æ„ alibabaï¼Œé…åˆä¸»æµçš„ä¸­é—´ä»¶ï¼Œå‰ç«¯ä¸»è¦æ˜¯ä»¥ react é…åˆ antdesiqn æ¥è¿›è¡Œï¼Œä»¥Cç«¯ä¸ºä¸»çš„ä¸€ä¸ªç½‘ç«™å½¢å¼ã€‚æˆ‘ä»¬å«ä»–programmer_club(è¯´ä½ è‡ªå·±èµ·çš„åå­—)ï¼Œæ•´ä½“ä¸ºä¸€ä¸ªç¤¾åŒºçš„å½¢å¼ï¼Œä¸»è¦å®ç°çš„åŠŸèƒ½æœ‰åˆ·é¢˜ï¼Œç»ƒé¢˜ï¼Œäº¤æµç¾¤ï¼Œæ¨¡æ‹Ÿé¢è¯•ã€‚æˆ‘åœ¨è¿™é‡Œé¢æ‰¿æ‹…çš„è§’è‰²æ˜¯è´Ÿè´£äººï¼Œä¸»è¦æ˜¯è¾“å‡ºæƒ³æ³•è®¾è®¡æŠ€æœ¯é€‰å‹ï¼Œæ¶æ„è®¾è®¡ï¼ŒåŠŸèƒ½çš„è®¾è®¡åŠè½åœ°ã€‚å…¶ä¸­åˆ·é¢˜æ¨¡å—ã€ç™»å½•æ³¨å†Œé‰´æƒç­‰æ¨¡å—ä»¥åŠä¼˜åŒ–ç­‰æ˜¯æˆ‘æ¥è¿›è¡Œä¸»è¦è½åœ°å®ç°çš„ã€‚é¡¹ç›®ä¸»è¦ä¸ºæˆ‘ä»¬è½¯ä»¶å­¦é™¢çš„äººæ¥æä¾›ä½¿ç”¨ï¼Œç›®å‰è¿™ä¸ªç½‘ç«™å·²ç»ç»™å­¦æ ¡å†…éƒ¨çš„åŒå­¦æ¥ä½¿ç”¨ï¼Œç”±å·¥ä½œå®¤å†…éƒ¨çš„åŒå­¦ç»§ç»­å»ä¼˜åŒ–ã€‚</p><h4 id="ä¸ºä»€ä¹ˆè¦é€‰ç”¨dddï¼ˆé¢†åŸŸé©±åŠ¨è®¾è®¡ï¼‰"><a href="#ä¸ºä»€ä¹ˆè¦é€‰ç”¨dddï¼ˆé¢†åŸŸé©±åŠ¨è®¾è®¡ï¼‰" class="headerlink" title="ä¸ºä»€ä¹ˆè¦é€‰ç”¨dddï¼ˆé¢†åŸŸé©±åŠ¨è®¾è®¡ï¼‰"></a>ä¸ºä»€ä¹ˆè¦é€‰ç”¨dddï¼ˆé¢†åŸŸé©±åŠ¨è®¾è®¡ï¼‰</h4><p>ä½¿ç”¨DDDï¼ˆé¢†åŸŸé©±åŠ¨è®¾è®¡)çš„åŸå› ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹:</p><ol><li>æé«˜å¯ç»´æŠ¤æ€§<ul><li>DDDé€šè¿‡å°†å¤æ‚çš„ä¸šåŠ¡åœºæ™¯åˆ’åˆ†ä¸ºç®€å•çš„é¢†åŸŸï¼Œæœ‰åˆ©äºä»£ç çš„é˜…è¯»å’Œç»´æŠ¤ã€‚è¿™æœ‰åŠ©äºå¼€å‘è€…æ›´å¥½åœ°ç»„ç»‡ä»£ç ï¼Œé™ä½ç³»ç»Ÿå¤æ‚åº¦ã€‚</li><li>é€šè¿‡æ˜ç¡®é¢†åŸŸè¾¹ç•Œå’Œæ¦‚å¿µï¼ŒDDDä½¿å¾—æ¯ä¸ªé¢†åŸŸçš„ä»£ç æ›´åŠ å†…èšï¼Œé™ä½äº†é¢†åŸŸä¹‹é—´çš„è€¦åˆï¼Œæé«˜äº†ä»£ç çš„å¯ç»´æŠ¤æ€§ã€‚</li></ul></li><li>æé«˜å¯æ‰©å±•æ€§:<ul><li>DDDå¼ºè°ƒä¸šåŠ¡é¢†åŸŸçš„åˆ’åˆ†å’Œå»ºæ¨¡ï¼Œé¢†åŸŸä¹‹é—´çš„è§£è€¦é™ä½äº†ç³»ç»Ÿé—´çš„åˆåº¦ï¼Œæœ‰åˆ©äºæœªæ¥çš„åŠŸèƒ½æ‰©å±•å’Œæ–°æŠ€æœ¯å¼•å…¥ã€‚</li><li>æ¸…æ™°çš„é¢†åŸŸæ¨¡å‹è®¾è®¡å¯ä»¥æ›´å®¹æ˜“åœ°æ”¯æŒæ–°åŠŸèƒ½çš„æ·»åŠ å’Œæ—§åŠŸèƒ½çš„ä¿®æ”¹ï¼Œè€Œä¸ä¼šå½±å“åˆ°å…¶ä»–ä¸ç›¸å…³çš„é¢†åŸŸã€‚</li></ul></li><li>æé«˜çµæ´»æ€§:<ul><li>åŸºäºé¢†åŸŸæ¨¡å‹çš„è®¾è®¡ä½¿å¾—ç³»ç»Ÿèƒ½å¤Ÿæ›´å¿«åœ°å“åº”ä¸šåŠ¡å˜åŒ–ï¼Œæé«˜é€‚åº”æ€§ã€‚</li><li>å½“ä¸šåŠ¡éœ€æ±‚å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒDDDçš„çµæ´»æ€§å…è®¸å¼€å‘è€…é€šè¿‡ä¿®æ”¹æˆ–æ‰©å±•é¢†åŸŸæ¨¡å‹æ¥åº”å¯¹è¿™äº›å˜åŒ–ï¼Œè€Œä¸éœ€è¦å¯¹æ•´ä¸ªç³»ç»Ÿè¿›è¡Œå¤§è§„æ¨¡çš„é‡æ„ã€‚</li></ul></li><li>ä¿ƒè¿›å›¢é˜Ÿæ²Ÿé€š:<ul><li>é€šè¿‡æ¸…æ™°åœ°å®šä¹‰é¢†åŸŸè¾¹ç•Œï¼ŒDDDæœ‰åŠ©äºå›¢é˜Ÿä¹‹é—´çš„äº¤æµå’Œåä½œã€‚æ¯ä¸ªå›¢é˜Ÿæˆå‘˜éƒ½å¯ä»¥æ›´åŠ ä¸“æ³¨äºè‡ªå·±æ‰€åœ¨çš„é¢†åŸŸï¼Œå‡å°‘è·¨é¢†åŸŸæ²Ÿé€šçš„æˆæœ¬ã€‚</li><li>æ¸…æ™°çš„é¢†åŸŸæ¨¡å‹è¿˜å¯ä»¥ä½œä¸ºå›¢é˜Ÿæˆå‘˜ä¹‹é—´çš„å…±åŒè¯­è¨€ï¼Œä¿ƒè¿›å¯¹ä¸šåŠ¡éœ€æ±‚å’Œç³»ç»Ÿè®¾è®¡çš„æ·±å…¥è®¨è®ºå’Œç†è§£ã€‚</li></ul></li><li>æ”¯æŒå¤æ‚ä¸šåŠ¡åœºæ™¯:<ul><li>å¯¹äºæ¶‰åŠå¤šä¸ªä¸šåŠ¡é¢†åŸŸç›®ä¸šåŠ¡é€»è¾‘å¤æ‚çš„é¡¹ç›®ï¼ŒDDDèƒ½å¤Ÿæ˜¾è‘—æé«˜ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§ã€å¯æ‰©å±•æ€§å’Œçµæ´»æ€§ã€‚å®ƒå¯ä»¥å¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°ç†è§£å’ŒæŠŠæ¡ä¸šåŠ¡éœ€æ±‚ï¼Œå®ç°é«˜è´¨é‡çš„è½¯ä»¶å¼€å‘ã€‚</li></ul></li><li>ä½¿ç”¨ä¸šåŠ¡å˜åŒ–ï¼š<ul><li>åœ¨ä¸šåŠ¡é¢†åŸŸå˜åŒ–é¢‘ç¹çš„æƒ…å†µä¸‹ï¼ŒDDDèƒ½å¤Ÿæ–¹ä¾¿åœ°è¿›è¡Œæ¨¡å‹çš„è°ƒæ•´å’Œä¼˜åŒ–ï¼Œä»¥é€‚åº”ä¸æ–­å˜åŒ–çš„ä¸šåŠ¡éœ€æ±‚ã€‚è¿™æœ‰åŠ©äºé™ä½å› ä¸šåŠ¡å˜åŠ¨å¯¼è‡´çš„å¼€å‘æˆæœ¬ï¼Œæé«˜ç³»ç»Ÿçš„é€‚åº”èƒ½åŠ›ã€‚</li></ul></li><li>æ”¯æŒå›¢é˜Ÿåä½œ:<ul><li>åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼ŒDDDæœ‰åŠ©äºæ˜ç¡®å„å›¢é˜Ÿçš„èŒè´£èŒƒå›´ï¼Œæé«˜å›¢é˜Ÿä¹‹é—´çš„æ²Ÿé€šåä½œæ•ˆç‡ã€‚é€šè¿‡å°†ç³»ç»Ÿåˆ’åˆ†ä¸ºä¸åŒçš„é¢†åŸŸï¼Œæ¯ä¸ªå›¢é˜Ÿå¯ä»¥ä¸“æ³¨äºè‡ªå·±æ‰€åœ¨é¢†åŸŸçš„å¼€å‘ï¼Œå‡å°‘äº†è·¨å›¢é˜Ÿçš„ä¾èµ–å’Œå†²çªã€‚</li></ul></li></ol><p>DDDé€šè¿‡å¼ºè°ƒä¸šåŠ¡é¢†åŸŸçš„åˆ’åˆ†å’Œå»ºæ¨¡ï¼Œæé«˜äº†è½¯ä»¶ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§ã€å¯æ‰©å±•æ€§å’Œçµæ´»æ€§ã€‚è¿™ä½¿å¾—DDDæˆä¸ºåº”å¯¹å¤æ‚ä¸šåŠ¡åœºæ™¯ã€å›¢é˜Ÿåä½œå’Œä¸šåŠ¡å˜åŒ–çš„æœ‰æ•ˆæ–¹æ³•è®ºã€‚ç„¶è€Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒDDDå¯¹å¼€å‘è€…ç»éªŒå’Œé¢†åŸŸçŸ¥è¯†è¦æ±‚è¾ƒé«˜ï¼Œå¼€å‘è€…éœ€è¦é¿å…è¿‡åº¦è®¾è®¡å’Œé™ä½å­¦ä¹ æˆæœ¬ã€‚</p><h4 id="æ˜¯æ€ä¹ˆåœ¨è¿™ä¸ªé¡¹ç›®é‡Œé¢ä½¿ç”¨satokençš„ï¼Ÿ"><a href="#æ˜¯æ€ä¹ˆåœ¨è¿™ä¸ªé¡¹ç›®é‡Œé¢ä½¿ç”¨satokençš„ï¼Ÿ" class="headerlink" title="æ˜¯æ€ä¹ˆåœ¨è¿™ä¸ªé¡¹ç›®é‡Œé¢ä½¿ç”¨satokençš„ï¼Ÿ"></a>æ˜¯æ€ä¹ˆåœ¨è¿™ä¸ªé¡¹ç›®é‡Œé¢ä½¿ç”¨satokençš„ï¼Ÿ</h4><p>â€‹è¿™ä¸ªé—®é¢˜ä»ä¸¤ä¸ªæ–¹é¢æ¥å›ç­”çš„å§ï¼š</p><ul><li>ä¸€æ–¹é¢æ˜¯æŠ€æœ¯é€‰å‹æ¶‰åŠçš„æˆæœ¬ï¼Œå¤§å®¶éƒ½çŸ¥é“æƒé™æ˜¯æ¯ä¸ªé¡¹ç›®éƒ½ç»•ä¸å¼€çš„ï¼Œå¦‚ä½•å¿«é€Ÿçš„æ¥å…¥ï¼Œå¹¶ä¸”å…·å¤‡è¾ƒå¥½çš„æ‰©å±•æ€§ï¼ŒåŠŸèƒ½å®Œå¤‡ï¼Œä½¿æˆ‘ä»¬æœ€å¼€å§‹éœ€è¦è€ƒè™‘çš„ä¸€ä¸ªä¸œè¥¿ï¼ŒSa-Tokenååˆ†è½»é‡ï¼ŒåŠŸèƒ½é½å…¨ï¼Œå­¦ä¹ æˆæœ¬ä½ï¼Œå¯ä»¥å¿«é€Ÿæ¥å…¥ã€‚</li><li>å¦ä¸€æ–¹é¢å°±æ˜¯å¤æ‚æ€§è€ƒè™‘: Sa-Token æ˜¯ä¸€ä¸ªè½»é‡çº§ Java æƒé™è®¤è¯æ¡†æ¶ï¼Œä¸»è¦è§£å†³:ç™»å½•è®¤è¯ã€æƒé™è®¤è¯ã€å•ç‚¹ç™»å½•ã€OAuth2.0ã€åˆ†å¸ƒå¼Sessionä¼šè¯ã€å¾®æœåŠ¡ç½‘å…³é‰´æƒ ç­‰ä¸€ç³»åˆ—æƒé™ç›¸å…³é—®é¢˜ï¼Œæ­£å¥½ç¬¦åˆæˆ‘ä»¬çš„å¾®æœåŠ¡åˆ†å¸ƒå¼é¡¹ç›®çš„åœºæ™¯ï¼Œæ— éœ€å®ç°ä»»ä½•æ¥å£ï¼Œæ— éœ€åˆ›å»ºä»»ä½•é…ç½®æ–‡ä»¶ï¼Œåªéœ€è¦ä¸€å¥é™æ€ä»£ç çš„è°ƒç”¨ï¼Œä¾¿å¯ä»¥å®Œæˆä¼šè¯ç™»å½•è®¤è¯ç›¸æ¯” Shiroã€SpringSecurity ç­‰æ¡†æ¶çš„å¤æ‚ï¼Œä½¿ç”¨ä¹‹åå°±çŸ¥é“ Sa-Token çš„ API è®¾è®¡æ˜¯å¤šä¹ˆçš„å¥½ç”¨,</li></ul><p>â€‹è¯´åˆ° token å¿…é¡»å…ˆè¯´ä¸€ä¸‹ cookieã€‚ä¼ ç»Ÿçš„å¸¸è§„çš„ä¸€èˆ¬æ˜¯ç”± cookie è¿›è¡Œå®Œæˆï¼ŒCookie æœ‰ä¸¤ä¸ªç‰¹æ€§:å¯ç”±åç«¯æ§åˆ¶å†™å…¥ï¼Œæ¯æ¬¡è¯·æ±‚è‡ªåŠ¨æäº¤ã€‚è¿™å°±ä½¿å¾—æˆ‘ä»¬åœ¨å‰ç«¯ä»£ç ä¸­ï¼Œæ— éœ€ä»»ä½•ç‰¹æ®Šæ“ä½œï¼Œå°±èƒ½å®Œæˆé‰´æƒçš„å…¨éƒ¨æµç¨‹ã€‚ä½†æ˜¯åœ¨appã€å°ç¨‹åºç­‰å‰åç«¯åˆ†ç¦»åœºæ™¯ä¸­ï¼Œä¸€èˆ¬æ˜¯æ²¡æœ‰ Cookie è¿™ä¸€åŠŸèƒ½çš„ã€‚æ‰€ä»¥æˆ‘ä»¬å°±å¼•å…¥ token çš„è¿™ä¸ªæ¦‚å¿µã€‚æ‹†è§£å‡ºæ¥ä¸»è¦æ˜¯ä¸¤æ­¥ï¼Œä¸€æ­¥æ˜¯ç™»å½•åï¼Œåç«¯è¿”å› tokenï¼Œå¦ä¸€éƒ¨æ˜¯å‰ç«¯è¯·æ±‚å¸¦ç€ tokenï¼Œå°† token æ”¾åˆ° header é‡Œé¢ã€‚å®ç°äº† token çš„ä¼ é€’ä¹‹åï¼Œtoken çš„ç”Ÿæˆè¿‡ç¨‹ï¼Œå¯ä»¥åŒ…å«å„ç§ä¿¡æ¯ï¼Œæ¯”å¦‚ç”¨æˆ·çš„ç”¨æˆ·åï¼Œç›¸å…³çš„æƒé™ï¼Œéƒ½å¯ä»¥åŒ…å«åœ¨é‡Œé¢ï¼Œè¿™æ ·ä¸€ä¸ª token å°±å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¸¦æ¥å¾ˆå¤šä¿¡æ¯ï¼Œé‰´æƒç­‰åŠŸèƒ½ä¹Ÿå°±éå¸¸å®¹æ˜“åšäº†ï¼ŒåŒæ—¶è¿˜è§£å†³äº†cookie é—®é¢˜ã€‚</p><p><a href="https://blog.csdn.net/weixin_42672802/article/details/132511713">sessionã€cookieå’Œtokençš„åŒºåˆ«_cookie,session,tokençš„åŒºåˆ«-CSDNåšå®¢</a></p><h4 id="ç™»å½•è®¤è¯æ˜¯æ€ä¹ˆåšçš„"><a href="#ç™»å½•è®¤è¯æ˜¯æ€ä¹ˆåšçš„" class="headerlink" title="ç™»å½•è®¤è¯æ˜¯æ€ä¹ˆåšçš„"></a>ç™»å½•è®¤è¯æ˜¯æ€ä¹ˆåšçš„</h4><ol><li><p>å¦‚ä½•å¯¹æ¥å…¬ä¼—å·ç™»å½•</p><p>å¯¹æ¥å…¬ä¼—å·ä¸»è¦æ˜¯å¸Œæœ›ç”¨å¾®ä¿¡çš„å”¯ä¸€çš„ openldï¼Œæ¥ä½œä¸ºå”¯ä¸€çš„æ ‡è¯†ï¼Œä¹Ÿæ–¹ä¾¿ç”¨æˆ·çš„ç™»å½•ã€‚</p><ul><li>æ•´ä½“æµç¨‹ä¸»è¦æ˜¯ç”¨æˆ·æ‰«å…¬ä¼—å·ç ã€‚ç„¶åå‘ä¸€æ¡æ¶ˆæ¯:éªŒè¯ç ã€‚</li><li>æˆ‘ä»¬é€šè¿‡ api å›å¤ä¸€ä¸ªéšæœºçš„ç ï¼Œå­˜å…¥redis çš„ä¸»è¦ç»“æ„ï¼Œkeyæ˜¯ä¸€ä¸ªå‰ç¼€+validCodeï¼Œvalueæ˜¯ OpenIdã€‚</li><li>ç”¨æˆ·åœ¨éªŒè¯ç æ¡†è¾“å…¥ä¹‹åï¼Œç‚¹å‡»ç™»å½•ï¼Œè¿›å…¥æˆ‘ä»¬çš„æ³¨å†Œæ¨¡å—ï¼ŒåŒæ—¶å…³è”è§’è‰²å’Œæƒé™(æ•°æ®åº“æ“ä½œ)ï¼Œå°±å®ç°äº†<strong>ç½‘å…³çš„ç»Ÿä¸€é‰´æƒ</strong>ï¼Œç”¨æˆ·å°±å¯ä»¥è¿›è¡Œæ“ä½œï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®ä¸ªäººçš„ openld æ¥ç»´æŠ¤ä¸ªäººä¿¡æ¯ã€‚</li><li>ç”¨æˆ·ç™»å½•æˆåŠŸä¹‹åï¼Œè¿”å› tokenï¼ˆsatokené€šè¿‡openIdè°ƒç”¨ä¸€ä¸ªè‡ªå¸¦çš„æ–¹æ³•ç™»å½•ï¼Œæœ‰ä¸€ä¸ªè‡ªå¸¦çš„æ–¹æ³•è¿”å›tokenï¼‰ï¼Œå‰ç«¯çš„æ‰€æœ‰è¯·æ±‚éƒ½å¸¦ç€ token å°±å¯ä»¥è®¿é—®ä»æœåŠ¡æ¶‰åŠä¸Šï¼Œæˆ‘ä»¬å¼€ä¸€ä¸ªæ–°æœåŠ¡ï¼Œä¸“é—¨ç”¨äºå¯¹æ¥æŸä¿¡çš„ api å’Œå¾®ä¿¡çš„æ¶ˆæ¯çš„å›è°ƒã€‚</li></ul></li><li><p>ä½ æ˜¯å¦‚ä½•ç›‘å¬ç”¨æˆ·å‘ç»™å…¬ä¼—å·çš„æ¶ˆæ¯çš„?</p><p>ä¸»è¦æ˜¯å¯¹æ¥å…¬ä¼—å·çš„å›è°ƒæ¶ˆæ¯å¹³å°é…ç½®ã€‚é‡ç‚¹ä¸»è¦åˆ†ä¸ºä¸‰æ­¥:å¡«å†™æœåŠ¡å™¨é…ç½®ï¼ŒéªŒè¯æœåŠ¡å™¨åœ°å€çš„æœ‰æ•ˆæ€§ï¼Œä¾æ®æ¥å£æ–‡æ¡£å®ç°ä¸šåŠ¡é€»è¾‘ã€‚</p><ul><li>åœ¨å…¬ä¼—å·é…ç½®ç•Œé¢å¡«å†™æœåŠ¡å™¨åœ°å€(URL)ã€Tokenå’ŒEncodingAESKeyã€‚<ul><li>å…¶ä¸­URLæ˜¯å¼€å‘è€…ç”¨æ¥æ¥æ”¶å¾®ä¿¡æ¶ˆæ¯å’Œäº‹ä»¶çš„æ¥å£URLã€‚</li><li>Tokenå¯ç”±å¼€å‘è€…å¯ä»¥ä»»æ„å¡«å†™ï¼Œ<strong>ç”¨ä½œç”Ÿæˆç­¾å</strong>(è¯¥Tokenä¼šå’Œæ¥å£URLä¸­åŒ…å«çš„Tokenè¿›è¡Œæ¯”å¯¹ï¼Œä»è€ŒéªŒè¯å®‰å…¨æ€§)ã€‚</li><li>EncodingAESKeyç”±å¼€å‘è€…æ‰‹åŠ¨å¡«å†™æˆ–éšæœºç”Ÿæˆï¼Œå°†ç”¨ä½œæ¶ˆæ¯ä½“åŠ è§£å¯†å¯†é’¥ã€‚</li></ul></li><li>éªŒè¯æ¶ˆæ¯çš„ç¡®æ¥è‡ªå¾®ä¿¡æœåŠ¡å™¨:æŸä¿¡æœåŠ¡å™¨å°†å‘é€GETè¯·æ±‚åˆ°å¡«å†™çš„æœåŠ¡å™¨åœ°å€URLä¸Šï¼ŒGETè¯·æ±‚æºå¸¦å‚æ•°æœ‰ç­¾åï¼Œå†…å®¹ï¼Œæ—¶é—´æˆ³ä¹‹ç±»çš„ï¼Œåå°æœåŠ¡è¦é€šè¿‡ä¸€æ ·çš„åŠ å¯†å½¢å¼æ¥è¿›è¡Œæ ¡éªŒã€‚</li><li>ä¾æ®æ¥å£æ–‡æ¡£å®ç°ä¸šåŠ¡é€»è¾‘:éªŒè¯URLæœ‰æ•ˆæ€§æˆåŠŸåå³æ¥å…¥ç”Ÿæ•ˆï¼Œç”¨æˆ·æ¯æ¬¡å‘å…¬ä¼—å·å‘é€æ¶ˆæ¯ï¼Œå¼€å‘è€…å¡«å†™çš„æœåŠ¡å™¨é…ç½®URLå°†å¾—åˆ°å¾®ä¿¡æœåŠ¡å™¨æ¨é€è¿‡æ¥çš„æ¶ˆæ¯å’Œäº‹ä»¶ï¼Œå¼€å‘è€…å¯ä»¥ä¾æ®è‡ªèº«ä¸šåŠ¡é€»è¾‘è¿›è¡Œå“åº”ï¼Œå¦‚å›å¤æ¶ˆæ¯ã€‚</li></ul></li><li><p>å›è°ƒæ¶ˆæ¯çš„éªŒè¯æ ¡éªŒæ˜¯å¦‚ä½•åšçš„ï¼Ÿ</p><p>å¼€å‘è€…é€šè¿‡æ£€éªŒsignatureå¯¹è¯·æ±‚è¿›è¡Œæ ¡éªŒã€‚è‹¥ç¡®è®¤æ­¤æ¬¡GETè¯·æ±‚æ¥è‡ªå¾®ä¿¡æœåŠ¡å™¨ï¼Œè¯·åŸæ ·è¿”å›echostrå‚æ•°å†…å®¹ï¼Œåˆ™æ¥å…¥ç”Ÿæ•ˆï¼Œæˆä¸ºå¼€å‘è€…æˆåŠŸï¼Œå¦åˆ™æ¥å…¥å¤±è´¥ã€‚åŠ å¯†&#x2F;æ ¡éªŒæµç¨‹å¦‚ä¸‹:</p><p>1)å°†tokenã€timestampã€nonceä¸‰ä¸ªå‚æ•°è¿›è¡Œå­—å…¸åºæ’åº</p><p>2)å°†ä¸‰ä¸ªå‚æ•°å­—ç¬¦ä¸²æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œsha1åŠ å¯†</p><p>3)å¼€å‘è€…è·å¾—åŠ å¯†åçš„å­—ç¬¦ä¸²å¯ä¸signatureå¯¹æ¯”ï¼Œæ ‡è¯†è¯¥è¯·æ±‚æ¥æºäºå¾®ä¿¡</p></li></ol><h4 id="gatewayç½‘å…³æ˜¯æ€ä¹ˆè®¾è®¡çš„"><a href="#gatewayç½‘å…³æ˜¯æ€ä¹ˆè®¾è®¡çš„" class="headerlink" title="gatewayç½‘å…³æ˜¯æ€ä¹ˆè®¾è®¡çš„"></a>gatewayç½‘å…³æ˜¯æ€ä¹ˆè®¾è®¡çš„</h4><p>â€‹gateway ç½‘å…³ï¼Œä½œä¸ºæˆ‘ä»¬é¡¹ç›®çš„æ•´ä¸ªæµé‡å…¥å£ï¼Œç›®å‰ä¸»è¦å®ç°äº†è·¯ç”±ï¼Œè´Ÿè½½ï¼Œç»Ÿä¸€é‰´æƒï¼Œå…¨å±€è¿‡æ»¤å™¨ï¼Œå¼‚å¸¸å¤„ç†è¿™äº›åŠŸèƒ½ã€‚è·¯ç”±å’Œè´Ÿè½½æ‰¿è½½äº†åå°å¾®æœåŠ¡çš„ ur è½¬å‘å’Œå‰ç¼€åŒ¹é…ã€‚ç»Ÿä¸€é‰´æƒä¸»è¦æ˜¯é…åˆ satokenï¼Œåœ¨ gateway é›†æˆ redisï¼ŒåŒæ—¶å®ç° satoken æä¾›çš„æƒé™è¯»å–æ¥å£ï¼Œåœ¨å…¶ä¸­è‡ªå®šä¹‰è¯»å–é€»è¾‘ï¼Œå®ç°é‰´æƒçš„æ ¡éªŒã€‚åœ¨å…¶ä¸­è¿˜å®ç°äº†ç™»å½•æ‹¦æˆªå™¨ï¼Œç”¨äºä¼ é€’ loginld åˆ°å¾®æœåŠ¡ä¸­ï¼Œå€ŸåŠ©äº† header çš„ä¼ é€’ã€‚</p><h4 id="åˆ†å¸ƒå¼ä¼šè¯çš„é‰´æƒåœ¨å¾®æœåŠ¡ä¸­æ˜¯æ€ä¹ˆåšçš„"><a href="#åˆ†å¸ƒå¼ä¼šè¯çš„é‰´æƒåœ¨å¾®æœåŠ¡ä¸­æ˜¯æ€ä¹ˆåšçš„" class="headerlink" title="åˆ†å¸ƒå¼ä¼šè¯çš„é‰´æƒåœ¨å¾®æœåŠ¡ä¸­æ˜¯æ€ä¹ˆåšçš„"></a>åˆ†å¸ƒå¼ä¼šè¯çš„é‰´æƒåœ¨å¾®æœåŠ¡ä¸­æ˜¯æ€ä¹ˆåšçš„</h4><p>â€‹åˆ†å¸ƒå¼ä¼šè¯é‰´æƒçš„é‡ç‚¹ä¸»è¦æ˜¯å¦‚ä½•è·å–åˆ°æƒé™æ•°æ®ï¼Œç„¶åè¿›è¡Œæ ¡éªŒå¤„ç†ï¼Œä¸€èˆ¬å…¶å®æœ‰ä¸‰ç§å½¢å¼ï¼š</p><ul><li>åœ¨ç½‘å…³å¤„é›†æˆORMæ¡†æ¶ï¼Œç›´æ¥ä»æ•°æ®åº“æŸ¥è¯¢æ•°æ®ã€‚</li><li>å…ˆä»Redisä¸­è·å–æ•°æ®ï¼Œè·å–ä¸åˆ°æ—¶èµ°ORMæ¡†æ¶æŸ¥è¯¢æ•°æ®åº“ã€‚</li><li>ä»Redisä¸­è·å–ç¼“å­˜æ•°æ®ã€‚</li></ul><p>â€‹æˆ‘ä»¬é‡‡å–çš„æ˜¯ç¬¬ä¸‰ç§ç›´æ¥ä»redis ä¸­è·å–ç¼“å­˜çš„æƒé™æ•°æ®ï¼Œè¿™æœ‰ä¸€ä¸ªè¦æ±‚ï¼Œå°±æ˜¯æˆ‘ä»¬çš„ redis çš„é«˜å¯ç”¨æ€§å¿…é¡»è¦é«˜ã€‚å› ä¸ºæˆ‘ä»¬æ˜¯å†…éƒ¨ä½¿ç”¨ï¼Œè¿™å—å¯ä»¥é‡‡å–åˆ·æ–°ç­‰æªæ–½ï¼Œæ¥å¤„ç†æç«¯å¼‚å¸¸æƒ…å†µï¼Œä¾‹å¦‚æƒé™ç¼“å­˜ä¸¢å¤±ã€‚å¦‚æœæƒ³è¦ä¿éšœçš„è¯ï¼Œå¯ä»¥é‡‡ç”¨ç¬¬äºŒç§æ–¹å¼ï¼Œä¹Ÿæ˜¯å¸¸è§çš„ç¼“å­˜æ²¡æœ‰æŸ¥æ•°æ®åº“ã€‚ä»è§’åº¦æ¥çœ‹ï¼Œä¸ªäººè§‰å¾—æˆ‘ä»¬è¿™ç§åœºæ™¯ä¸‹ï¼Œå†é›†æˆæ•°æ®åº“ orm å¯¼è‡´ç½‘å…³æœ‰ç‚¹é‡ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥ä¸ç¼“å­˜åšäº¤äº’ã€‚</p><h4 id="gatewayå¦‚ä½•å®ç°å…¨å±€å¼‚å¸¸å¤„ç†"><a href="#gatewayå¦‚ä½•å®ç°å…¨å±€å¼‚å¸¸å¤„ç†" class="headerlink" title="gatewayå¦‚ä½•å®ç°å…¨å±€å¼‚å¸¸å¤„ç†"></a>gatewayå¦‚ä½•å®ç°å…¨å±€å¼‚å¸¸å¤„ç†</h4><p>â€‹gateway çš„å…¨å±€å¼‚å¸¸å¤„ç†ä¸»è¦éœ€è¦æˆ‘ä»¬å®ç°ä¸€ä¸ªæ¥å£ErrorWebExceptionHandlerï¼Œå®ç°å…¶ä¸­çš„ handle æ–¹æ³•åœ¨æ–¹æ³•å†…ï¼Œæˆ‘ä»¬èƒ½è·å–åˆ°å…¶ä¸­requestä¸responseï¼Œwebhandler ä¼šå¸®åŠ©æˆ‘ä»¬æ‹¦ä½æ‰€æœ‰å¼‚å¸¸çš„æƒ…å†µã€‚ç„¶åæˆ‘ä»¬å¯ä»¥åœ¨é‡Œé¢åšæ‹¦æˆªçš„è¿›ä¸€æ­¥å¤„ç†ï¼Œæ›´æ”¹çŠ¶æ€ç ï¼ŒçŠ¶æ€é”™è¯¯ä¿¡æ¯ç­‰ç­‰ã€‚æœ€åé€šè¿‡ response å¯ä»¥å°†å…¶è¿”å›å‡ºå»ã€‚</p><h2 id="è®¾è®¡æ¨¡å¼"><a href="#è®¾è®¡æ¨¡å¼" class="headerlink" title="è®¾è®¡æ¨¡å¼"></a>è®¾è®¡æ¨¡å¼</h2><p><a href="https://blog.csdn.net/wangzhengjiushiwo/article/details/111370159">è®²è§£javaå•ä¾‹æ¨¡å¼ä¸­çš„é¥¿æ±‰æ¨¡å¼å’Œæ‡’æ±‰æ¨¡å¼çš„åŒºåˆ«ä¸ä½¿ç”¨_é¥¿æ±‰å¼å’Œæ‡’æ±‰å¼ç”¨é‚£ä¸ª-CSDNåšå®¢</a></p><h2 id="JavaåŸºç¡€"><a href="#JavaåŸºç¡€" class="headerlink" title="JavaåŸºç¡€"></a>JavaåŸºç¡€</h2><p><a href="https://blog.csdn.net/yyuggjggg/article/details/120803154?ops_request_misc=%7B%22request_id%22:%22F58045E8-7B9B-4B46-A20B-8787BDE2F55B%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=F58045E8-7B9B-4B46-A20B-8787BDE2F55B&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-120803154-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=arraylist%E5%92%8Clinkedlist%E5%BA%95%E5%B1%82&spm=1018.2226.3001.4187">ArrayListé›†åˆå’ŒLinkedListé›†åˆåº•å±‚åŸç†_linkedarrayliståº•å±‚-CSDNåšå®¢</a></p><h3 id="JVMã€JREã€JDKçš„å…³ç³»"><a href="#JVMã€JREã€JDKçš„å…³ç³»" class="headerlink" title="JVMã€JREã€JDKçš„å…³ç³»"></a>JVMã€JREã€JDKçš„å…³ç³»</h3><p>JVMã€JRE å’Œ JDK æ˜¯ Java ç”Ÿæ€ç³»ç»Ÿä¸­çš„ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶ï¼Œå®ƒä»¬åœ¨ Java å¼€å‘å’Œè¿è¡Œæ—¶ç¯å¢ƒä¸­æ‰®æ¼”ç€ä¸åŒçš„è§’è‰²ã€‚</p><p><strong>JVM (Java Virtual Machine)</strong></p><p><strong>Java è™šæ‹Ÿæœº</strong>æ˜¯ä¸€ç§æŠ½è±¡è®¡ç®—æœºï¼Œå®ƒä¸º Java ç¨‹åºæä¾›äº†è¿è¡Œç¯å¢ƒã€‚JM çš„ä¸»è¦èŒè´£æ˜¯æ‰§è¡Œ Java å­—èŠ‚ç ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºæœºå™¨ä»£ç ï¼Œä»¥ä¾¿åœ¨ç‰¹å®šå¹³å°ä¸Šè¿è¡Œã€‚JVM æ˜¯å®ç° Java å¹³å°æ— å…³æ€§çš„å…³é”®ç»„ä»¶ã€‚</p><ul><li>åŠŸèƒ½:<ul><li>å­—èŠ‚ç æ‰§è¡Œ: JVM è´Ÿè´£åŠ è½½ã€éªŒè¯å’Œæ‰§è¡ŒJava å­—èŠ‚ç ã€‚</li><li>å†…å­˜ç®¡ç†: JVM ç®¡ç†å †å†…å­˜å’Œæ ˆå†…å­˜ï¼Œå¹¶æ‰§è¡Œåƒåœ¾å›æ”¶(GarbageCollection)</li><li>å®‰å…¨æ€§: JVM æä¾›äº†å®‰å…¨æœºåˆ¶ï¼Œç¡®ä¿Java åº”ç”¨åœ¨å—æ§ç¯å¢ƒä¸­è¿è¡Œ</li></ul></li></ul><p><strong>JRE (Java Runtime Environment)</strong></p><p>Java è¿è¡Œæ—¶ç¯å¢ƒæ˜¯ä¸€ä¸ª<strong>è½¯ä»¶åŒ…</strong>ï¼Œå®ƒæä¾›äº†è¿è¡Œ Java åº”ç”¨ç¨‹åºæ‰€éœ€çš„æ‰€æœ‰ç»„ä»¶ã€‚JRE åŒ…å« JVM ä»¥åŠ Java ç±»åº“å’Œå…¶ä»–æ”¯æŒæ–‡ä»¶ã€‚JRE <strong>æ˜¯è¿è¡Œ Java åº”ç”¨ç¨‹åºçš„æœ€ä½è¦æ±‚ã€‚</strong></p><ul><li><p>ç»„æˆ:</p><ul><li>JVM:JRE<strong>åŒ…å« JVM</strong>ï¼Œç”¨äºæ‰§è¡Œ Java å­—èŠ‚ç ã€‚</li><li><strong>æ ¸å¿ƒç±»åº“:J</strong>RE åŒ…å« Java æ ‡å‡†ç±»åº“(å¦‚java.langã€java.utilç­‰)ï¼Œè¿™äº›ç±»åº“ä¸º Java åº”ç”¨æä¾›åŸºç¡€åŠŸèƒ½ã€‚</li><li>å…¶ä»–æ”¯æŒæ–‡ä»¶:åŒ…æ‹¬é…ç½®æ–‡ä»¶ã€èµ„æºæ–‡ä»¶ç­‰ã€‚</li></ul></li></ul><p><strong>JDK (Java Development Kit)</strong></p><p>Java å¼€å‘å·¥å…·åŒ…æ˜¯ä¸º Java å¼€å‘è€…æä¾›çš„å®Œæ•´å¼€å‘ç¯å¢ƒã€‚JDK åŒ…å« JRE ä»¥åŠå¼€å‘ Java åº”ç”¨ç¨‹åºæ‰€éœ€çš„å·¥å…·å’Œåº“ã€‚JDKæ˜¯å¼€å‘å’Œç¼–è¯‘ Java ç¨‹åºçš„å¿…å¤‡å·¥å…·ã€‚</p><ul><li><p>ç»„æˆ:</p><ul><li>JRE:JDK åŒ…å«ä¸€ä¸ªå®Œæ•´çš„ JRE ç¯å¢ƒã€‚</li><li>**å¼€å‘å·¥å…·:**åŒ…æ‹¬ç¼–è¯‘å™¨(javac)ã€è°ƒè¯•å™¨(jdb)ã€æ‰“åŒ…å·¥å…·(jar)ç­‰ï¼Œç”¨äºå¼€å‘ã€ç¼–è¯‘å’Œè°ƒè¯• Java ç¨‹åºã€‚</li><li>**é¢å¤–çš„åº“:**æä¾›äº†é¢å¤–çš„åº“å’Œå¤´æ–‡ä»¶ï¼Œç”¨äºå¼€å‘Java åº”ç”¨ç¨‹åºã€‚</li></ul></li></ul><p><strong>å…³ç³»</strong>ï¼š</p><ul><li>JVM æ˜¯JREçš„ä¸€éƒ¨åˆ†:JVM æ˜¯JREä¸­çš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£æ‰§è¡ŒJava å­—èŠ‚ç ã€‚</li><li>JRE æ˜¯ JDK çš„ä¸€éƒ¨åˆ†:JREæä¾›äº†è¿è¡Œ Java åº”ç”¨ç¨‹åºæ‰€éœ€çš„ç¯å¢ƒã€‚è€ŒJDKåˆ™åœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ äº†å¼€å‘å·¥å…·å’Œé¢å¤–çš„åº“ã€‚</li></ul><p><strong>æ€»ç»“ï¼š</strong></p><ul><li>JVM:æ‰§è¡Œ Java å­—èŠ‚ç çš„è™šæ‹Ÿæœºï¼Œæä¾›å†…å­˜ç®¡ç†å’Œå®‰å…¨æœºåˆ¶ã€‚</li><li>JRE:åŒ…å« JVM å’Œæ ¸å¿ƒç±»åº“ï¼Œæä¾›è¿è¡Œ Java åº”ç”¨ç¨‹åºçš„ç¯å¢ƒã€‚</li><li>JDK:åŒ…å« JRE å’Œå¼€å‘å·¥å…·ï¼Œæä¾›å¼€å‘ã€ç¼–è¯‘å’Œè°ƒè¯• Java åº”ç”¨ç¨‹åºçš„å®Œæ•´ç¯å¢ƒã€‚</li></ul><h3 id="Javaä¸‰å¤§ç‰¹æ€§"><a href="#Javaä¸‰å¤§ç‰¹æ€§" class="headerlink" title="Javaä¸‰å¤§ç‰¹æ€§"></a>Javaä¸‰å¤§ç‰¹æ€§</h3><p>Javaå¤§ç‰¹æ€§æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰çš„æ ¸å¿ƒæ¦‚å¿µ:å°è£…ã€ç»§æ‰¿å’Œå¤šæ€ã€‚è¿™äº›ç‰¹æ€§ä½¿å¾— Java ç¨‹åºå…·æœ‰è‰¯å¥½çš„ç»“æ„å’Œå¯ç»´æŠ¤æ€§ã€‚</p><ol><li><p><strong>å°è£…ï¼ˆEncapsulationï¼‰</strong></p><p>å°è£…æ˜¯å°†å¯¹è±¡çš„çŠ¶æ€(å±æ€§)å’Œè¡Œä¸º(æ–¹æ³•)ç»„åˆåœ¨ä¸€èµ·ï¼Œå¹¶å¯¹å¤–éšè—å¯¹è±¡çš„å†…éƒ¨ç»†èŠ‚ï¼Œåªæš´éœ²å¿…è¦çš„æ¥å£ã€‚é€šè¿‡å°è£…ï¼Œå¯ä»¥ä¿æŠ¤å¯¹è±¡çš„çŠ¶æ€ä¸è¢«å¤–éƒ¨ç›´æ¥ä¿®æ”¹ï¼Œå¢å¼ºäº†ä»£ç çš„å®‰å…¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p><ul><li>å®ç°æ–¹å¼ï¼š<ul><li>ä½¿ç”¨privateå…³é”®å­—å°†å±æ€§å£°æ˜ä¸ºç§æœ‰çš„ã€‚</li><li>æä¾›publicçš„ getter å’Œ setter æ–¹æ³•æ¥è®¿é—®å’Œä¿®æ”¹ç§æœ‰å±æ€§ã€‚</li></ul></li></ul></li><li><p><strong>ç»§æ‰¿ï¼ˆInheritanceï¼‰</strong></p><p>ç»§æ‰¿æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªæœºåˆ¶ï¼Œé€šè¿‡ç»§æ‰¿ï¼Œä¸€ä¸ªç±»å¯ä»¥ç»§æ‰¿å¦ä¸€ä¸ªç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œä»è€Œå®ç°ä»£ç çš„é‡ç”¨ã€‚è¢«ç»§æ‰¿çš„ç±»ç§°ä¸ºçˆ¶ç±»(è¶…ç±»)ï¼Œç»§æ‰¿çš„ç±»ç§°ä¸ºå­ç±»(æ´¾ç”Ÿç±»)ã€‚</p><ul><li>å®ç°æ–¹å¼:<ul><li>ä½¿ç”¨extendså…³é”®å­—æ¥å£°æ˜ä¸€ä¸ªç±»ç»§æ‰¿å¦ä¸€ä¸ªç±»</li></ul></li></ul></li><li><p><strong>å¤šæ€(Polymorphism)</strong></p><p>å¤šæ€æ˜¯æŒ‡åŒä¸€ä¸ªæ–¹æ³•åœ¨ä¸åŒå¯¹è±¡ä¸­å…·æœ‰ä¸åŒçš„å®ç°æ–¹å¼ã€‚å¤šæ€æ€§å…è®¸å¯¹è±¡åœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡ä¸­ä»¥ä¸åŒçš„å½¢å¼è¡¨ç°ã€‚å¤šæ€å¯ä»¥é€šè¿‡<strong>æ–¹æ³•é‡è½½(Overloading)å’Œæ–¹æ³•é‡å†™(Overriding)æ¥å®ç°</strong>ã€‚</p><ul><li>æ–¹æ³•é‡è½½:åœ¨åŒä¸€ä¸ªç±»ä¸­ï¼Œæ–¹æ³•åç›¸åŒä½†å‚æ•°åˆ—è¡¨ä¸åŒã€‚</li><li>æ–¹æ³•é‡å†™:åœ¨å­ç±»ä¸­é‡æ–°å®šä¹‰çˆ¶ç±»ä¸­çš„æ–¹æ³•ã€‚</li></ul></li></ol><p><strong>æ€»ç»“ï¼š</strong></p><ul><li>å°è£…:é€šè¿‡å°†æ•°æ®å’Œæ–¹æ³•å°è£…åœ¨ç±»ä¸­ï¼Œå¹¶ä½¿ç”¨è®¿é—®æ§åˆ¶ç¬¦æ¥ä¿æŠ¤æ•°æ®ã€‚</li><li>ç»§æ‰¿:é€šè¿‡ç»§æ‰¿æœºåˆ¶ï¼Œå®ç°ä»£ç çš„é‡ç”¨å’Œæ‰©å±•ã€‚</li><li>å¤šæ€:é€šè¿‡æ–¹æ³•é‡è½½å’Œæ–¹æ³•é‡å†™ï¼Œå®ç°åŒä¸€æ–¹æ³•åœ¨ä¸åŒå¯¹è±¡ä¸­çš„ä¸åŒè¡¨ç°ã€‚</li></ul><h3 id="ä»€ä¹ˆæ˜¯å°è£…ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å°è£…ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å°è£…ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯å°è£…ï¼Ÿ</h3><p>å°è£…(Encapsulation)æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹(OOP)ä¸­çš„ä¸€ä¸ªåŸºæœ¬æ¦‚å¿µã€‚å®ƒæ¶‰åŠåˆ°å°†å¯¹è±¡çš„çŠ¶æ€(å±æ€§)å’Œè¡Œä¸º(æ–¹æ³•)å°è£…åœ¨ä¸€ä¸ªç±»ä¸­ï¼Œå¹¶<strong>å¯¹å¤–éƒ¨éšè—å†…éƒ¨å®ç°ç»†èŠ‚ï¼Œåªæš´éœ²å¿…è¦çš„æ¥å£</strong>ã€‚è¿™ç§åšæ³•æœ‰åŠ©äºæé«˜ä»£ç çš„å®‰å…¨æ€§ã€å¯ç»´æŠ¤æ€§å’Œå¯é‡ç”¨æ€§ã€‚</p><ol><li><p>å±æ€§ç§æœ‰åŒ–</p><p>å°†ç±»çš„å±æ€§å£°æ˜ä¸ºç§æœ‰(private)ï¼Œä»¥é˜²æ­¢å¤–éƒ¨ç›´æ¥è®¿é—®å’Œä¿®æ”¹è¿™äº›å±æ€§</p></li><li><p>æä¾›å…¬å…±çš„è®¿é—®æ–¹æ³•</p><p>é€šè¿‡å…¬å…±(public)çš„ getter å’Œ setter æ–¹æ³•æ¥æ§åˆ¶å¯¹ç§æœ‰å±æ€§çš„è®¿é—®å’Œä¿®æ”¹ã€‚è¿™äº›æ–¹æ³•å…è®¸å¤–éƒ¨ä»£ç åœ¨å—æ§çš„æƒ…å†µä¸‹è¯»å–å’Œä¿®æ”¹å±æ€§å€¼ã€‚</p></li><li><p>éšè—å®ç°ç»†èŠ‚</p><p>å°è£…è¿˜åŒ…æ‹¬éšè—ç±»å†…éƒ¨çš„å®ç°ç»†èŠ‚ï¼Œåªæš´éœ²å¿…è¦çš„æ¥å£ç»™å¤–éƒ¨ä½¿ç”¨è€…ã€‚è¿™æœ‰åŠ©äºé™ä½ä»£ç çš„å¤æ‚æ€§ï¼Œæé«˜æ¨¡å—åŒ–ç¨‹åº¦</p></li></ol><p><strong>å°è£…çš„ä¼˜ç‚¹ï¼š</strong></p><ol><li>**æ•°æ®ä¿æŠ¤:**é€šè¿‡ç§æœ‰åŒ–å±æ€§ï¼Œå¯ä»¥é˜²æ­¢å¤–éƒ¨ä»£ç ç›´æ¥ä¿®æ”¹å¯¹è±¡çš„çŠ¶æ€ï¼Œä»è€Œä¿æŠ¤æ•°æ®çš„å®Œæ•´æ€§ç®€åŒ–æ¥å£:åªæš´éœ²å¿…è¦çš„æ–¹æ³•ï¼Œéšè—ä¸éœ€è¦çš„å®ç°ç»†èŠ‚ï¼Œä½¿å¾—ç±»çš„æ¥å£æ›´åŠ ç®€æ´æ˜äº†</li><li>**æé«˜å¯ç»´æŠ¤æ€§:**å°è£…ä½¿å¾—ç±»çš„å®ç°ç»†èŠ‚å¯ä»¥ç‹¬ç«‹äºå¤–éƒ¨ä»£ç è¿›è¡Œä¿®æ”¹ï¼Œåªè¦æ¥å£ä¸å˜ï¼Œå¤–éƒ¨ä»£ç ä¸éœ€è¦åšä»»ä½•æ”¹å˜ã€‚</li><li>**å¢å¼ºçµæ´»æ€§: **é€šè¿‡ getter å’Œ setter æ–¹æ³•ï¼Œå¯ä»¥åœ¨è®¿é—®æˆ–ä¿®æ”¹å±æ€§æ—¶æ·»åŠ é¢å¤–çš„é€»è¾‘ï¼Œæ¯”å¦‚æ•°æ®éªŒè¯æˆ–äº‹ä»¶è§¦å‘ã€‚</li></ol><h3 id="ä»€ä¹ˆæ˜¯ç»§æ‰¿"><a href="#ä»€ä¹ˆæ˜¯ç»§æ‰¿" class="headerlink" title="ä»€ä¹ˆæ˜¯ç»§æ‰¿"></a>ä»€ä¹ˆæ˜¯ç»§æ‰¿</h3><p>ç»§æ‰¿(Inheritance)æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹(OOP)ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µã€‚å®ƒå…è®¸ä¸€ä¸ªç±»(å­ç±»æˆ–æ´¾ç”Ÿç±»)ç»§æ‰¿å¦ä¸€ä¸ªç±»(çˆ¶ç±»æˆ–è¶…ç±»)çš„å±æ€§å’Œæ–¹æ³•ï¼Œä»è€Œå®ç°ä»£ç çš„é‡ç”¨å’Œæ‰©å±•ã€‚é€šè¿‡ç»§æ‰¿ï¼Œå­ç±»å¯ä»¥å¤ç”¨çˆ¶ç±»çš„ä»£ç ï¼Œå¹¶ä¸”å¯ä»¥æ–°å¢æˆ–é‡å†™(è¦†ç›–)çˆ¶ç±»çš„æ–¹æ³•ä»¥å®ç°ç‰¹å®šçš„åŠŸèƒ½ã€‚</p><p><strong>ç»§æ‰¿çš„åŸºæœ¬æ¦‚å¿µï¼š</strong></p><ul><li>**çˆ¶ç±»(Super Class):**è¢«ç»§æ‰¿çš„ç±»ï¼Œæä¾›å±æ€§å’Œæ–¹æ³•ã€‚</li><li>**å­ç±»(Sub Class):**ç»§æ‰¿çˆ¶ç±»çš„ç±»ï¼Œå¯ä»¥å¤ç”¨çˆ¶ç±»çš„ä»£ç ï¼Œå¹¶ä¸”å¯ä»¥æ–°å¢æˆ–é‡å†™çˆ¶ç±»çš„æ–¹æ³•ã€‚</li><li>**extendså…³é”®å­—:**ç”¨äºå£°æ˜ä¸€ä¸ªç±»ç»§æ‰¿å¦ä¸€ä¸ªç±»ã€‚</li></ul><p><strong>ç»§æ‰¿çš„ç‰¹ç‚¹ï¼š</strong></p><ol><li><strong>å•ç»§æ‰¿:</strong> Java åªæ”¯æŒå•ç»§æ‰¿ï¼Œå³ä¸€ä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªç›´æ¥çˆ¶ç±»ã€‚</li><li>**ç»§æ‰¿å±‚æ¬¡: **å­ç±»å¯ä»¥ç»§ç»­è¢«å…¶ä»–ç±»ç»§æ‰¿ï¼Œå½¢æˆç»§æ‰¿å±‚æ¬¡ç»“æ„ã€‚</li><li>**superå…³é”®å­—: **ç”¨äºå¼•ç”¨çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œç‰¹åˆ«æ˜¯åœ¨å­ç±»é‡å†™çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œå¯ä»¥é€šè¿‡superè°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ã€‚</li></ol><p><strong>ç»§æ‰¿çš„ä¼˜ç‚¹ï¼š</strong></p><ol><li><strong>ä»£ç é‡ç”¨:</strong> å­ç±»å¯ä»¥å¤ç”¨çˆ¶ç±»çš„ä»£ç ï¼Œå‡å°‘ä»£ç é‡å¤ã€‚</li><li><strong>ä»£ç æ‰©å±•:</strong> å­ç±»å¯ä»¥åœ¨ç»§æ‰¿çˆ¶ç±»çš„åŸºç¡€ä¸Šæ–°å¢å±æ€§å’Œæ–¹æ³•ï¼Œæ‰©å±•åŠŸèƒ½ã€‚</li><li>**å¤šæ€æ€§: **é€šè¿‡ç»§æ‰¿å’Œæ–¹æ³•é‡å†™ï¼Œå¯ä»¥å®ç°å¤šæ€æ€§ï¼Œä½¿å¾—åŒä¸€æ–¹æ³•åœ¨ä¸åŒå¯¹è±¡ä¸­å…·æœ‰ä¸åŒçš„å®ç°ã€‚</li></ol><p><strong>ç»§æ‰¿ä¸­çš„ä¸€äº›æ³¨æ„äº‹é¡¹</strong></p><ol><li>**æ„é€ æ–¹æ³•:**å­ç±»çš„æ„é€ æ–¹æ³•ä¼šè°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•ã€‚å¦‚æœçˆ¶ç±»æ²¡æœ‰æ— å‚æ„é€ æ–¹æ³•ï¼Œå­ç±»å¿…é¡»æ˜¾å¼è°ƒç”¨çˆ¶ç±»çš„æœ‰1å‚æ„é€ æ–¹æ³•ã€‚</li><li>**æ–¹æ³•é‡å†™(Overriding):**å­ç±»å¯ä»¥é‡å†™çˆ¶ç±»çš„æ–¹æ³•ï¼Œä»¥æä¾›ç‰¹å®šçš„å®ç°ã€‚é‡å†™çš„æ–¹æ³•å¿…é¡»å…·æœ‰ç›¸åŒçš„æ–¹æ³•2ç­¾å(æ–¹æ³•åã€å‚æ•°åˆ—è¡¨å’Œè¿”å›ç±»å‹)ã€‚</li><li>**superå…³é”®å­—:**ç”¨äºè°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•æˆ–çˆ¶ç±»çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œåœ¨å­ç±»çš„æ„é€ æ–¹æ³•ä¸­ä½¿ç”¨superè°ƒç”¨çˆ¶ç±»çš„æ„ã€‹é€ æ–¹æ³•ã€‚</li></ol><h3 id="ä»€ä¹ˆæ˜¯å¤šæ€ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å¤šæ€ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å¤šæ€ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯å¤šæ€ï¼Ÿ</h3><p>å¤šæ€(Polymorphism)æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹(OOP)ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒå…è®¸ç›¸åŒçš„æ“ä½œåœ¨ä¸åŒçš„å¯¹è±¡ä¸Šè¡¨ç°å‡ºä¸åŒçš„è¡Œä¸ºã€‚å¤šæ€æ€§ä½¿å¾—ä¸€ä¸ªæ¥å£å¯ä»¥æœ‰å¤šç§å®ç°ï¼Œä»è€Œæé«˜ä»£ç çš„çµæ´»æ€§å’Œå¯æ‰©å±•æ€§ã€‚</p><p><strong>å¤šæ€çš„ç±»å‹</strong></p><p>å¤šæ€ä¸»è¦æœ‰ä¸¤ç§å½¢å¼:</p><ol><li>ç¼–è¯‘æ—¶å¤šæ€(é™æ€å¤šæ€)):é€šè¿‡æ–¹æ³•é‡è½½(Method Overloading)å®ç°:</li><li>è¿è¡Œæ—¶å¤šæ€(åŠ¨æ€å¤šæ€):é€šè¿‡æ–¹æ³•é‡å†™(Method Overriding)å’Œæ¥å£å®ç°(InterfaceImplementation)å®ç°ã€‚</li></ol><p><strong>ç¼–è¯‘æ—¶å¤šæ€(æ–¹æ³•é‡è½½)</strong></p><p>ç¼–è¯‘æ—¶å¤šæ€æ˜¯é€šè¿‡<strong>æ–¹æ³•é‡è½½</strong>å®ç°çš„ï¼Œå³åŒä¸€ä¸ªç±»ä¸­å¤šä¸ªæ–¹æ³•å…·æœ‰ç›¸åŒçš„åç§°ï¼Œä½†å‚æ•°åˆ—è¡¨ä¸åŒã€‚ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶æ ¹æ®æ–¹æ³•çš„å‚æ•°åˆ—è¡¨æ¥å†³å®šè°ƒç”¨å“ªä¸ªæ–¹æ³•ã€‚</p><p><strong>è¿è¡Œæ—¶å¤šæ€(æ–¹æ³•é‡å†™)</strong></p><p>è¿è¡Œæ—¶å¤šæ€æ˜¯é€šè¿‡<strong>æ–¹æ³•é‡å†™</strong>å®ç°çš„ï¼Œå³å­ç±»é‡å†™çˆ¶ç±»çš„æ–¹æ³•ã€‚åœ¨è¿è¡Œæ—¶ï¼ŒJava è™šæ‹Ÿæœºæ ¹æ®å¯¹è±¡çš„å®é™…ç±»å‹è°ƒç”¨å¯¹åº”çš„æ–¹æ³•ã€‚</p><p><strong>æ¥å£å’ŒæŠ½è±¡ç±»çš„å¤šæ€æ€§</strong><br>å¤šæ€æ€§è¿˜å¯ä»¥é€šè¿‡æ¥å£å’ŒæŠ½è±¡ç±»å®ç°ã€‚å­ç±»æˆ–å®ç°ç±»å¯ä»¥æä¾›ä¸åŒçš„å®ç°ï¼Œä»è€Œå®ç°å¤šæ€æ€§ã€‚</p><p><strong>å¤šæ€çš„ä¼˜ç‚¹</strong></p><ol><li>**ä»£ç é‡ç”¨:**é€šè¿‡å¤šæ€æ€§ï¼Œå¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªæ¥å£æˆ–çˆ¶ç±»æ¥æ“ä½œä¸åŒçš„å¯¹è±¡ï¼Œå‡å°‘ä»£ç é‡å¤ã€‚</li><li>**çµæ´»æ€§å’Œå¯æ‰©å±•æ€§:**å¤šæ€æ€§ä½¿å¾—ä»£ç æ›´åŠ çµæ´»ï¼Œå¯ä»¥è½»æ¾åœ°æ‰©å±•æ–°çš„å­ç±»æˆ–å®ç°ç±»è€Œä¸å½±å“ç°æœ‰ä»£ç ã€‚</li><li>**ç®€åŒ–ä»£ç :**é€šè¿‡å¤šæ€æ€§ï¼Œå¯ä»¥ä½¿ç”¨ç»Ÿä¸€çš„æ¥å£æ¥å¤„ç†ä¸åŒçš„å¯¹è±¡ï¼Œç®€åŒ–ä»£ç é€»è¾‘ã€‚</li></ol><p><strong>æ€»ç»“</strong><br>å¤šæ€æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§ï¼Œå®ƒå…è®¸ç›¸åŒçš„æ“ä½œåœ¨ä¸åŒçš„å¯¹è±¡ä¸Šè¡¨ç°å‡ºä¸åŒçš„è¡Œä¸ºã€‚é€šè¿‡æ–¹æ³•é‡è½½å’Œæ–¹æ³•é‡å†™ï¼Œä»¥åŠæ¥å£å’ŒæŠ½è±¡ç±»çš„å®ç°ï¼Œå¤šæ€æ€§æé«˜äº†ä»£ç çš„çµæ´»æ€§ã€å¯æ‰©å±•æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p><h3 id="é‡è½½å’Œé‡å†™"><a href="#é‡è½½å’Œé‡å†™" class="headerlink" title="é‡è½½å’Œé‡å†™"></a>é‡è½½å’Œé‡å†™</h3><p>é‡è½½(Overoading)å’Œé‡å†™(Overriding)æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œå®ƒä»¬åœ¨æ–¹æ³•å®šä¹‰å’Œè°ƒç”¨æ—¶æœ‰ä¸åŒçš„ç”¨é€”å’Œè§„åˆ™ã€‚</p><p><strong>é‡è½½(Overloading)</strong></p><p><strong>å®šä¹‰:</strong> åœ¨åŒä¸€ä¸ªç±»ä¸­ï¼Œæ–¹æ³•åç§°ç›¸åŒï¼Œä½†å‚æ•°åˆ—è¡¨(å‚æ•°çš„ç±»å‹ã€æ•°é‡æˆ–é¡ºåº)ä¸åŒçš„å¤šä¸ªæ–¹æ³•ã€‚</p><p><strong>ç‰¹æ€§:</strong></p><ul><li>**æ–¹æ³•åç§°:**ç›¸åŒã€‚</li><li>**å‚æ•°åˆ—è¡¨:**å¿…é¡»ä¸åŒ(å‚æ•°çš„ç±»å‹ã€æ•°é‡ã€æˆ–é¡ºåº)ã€‚</li><li>**è¿”å›ç±»å‹:**å¯ä»¥ç›¸åŒä¹Ÿå¯ä»¥ä¸åŒã€‚</li><li>**è®¿é—®ä¿®é¥°ç¬¦:**å¯ä»¥ç›¸åŒä¹Ÿå¯ä»¥ä¸åŒã€‚</li><li>**é™æ€&#x2F;å®ä¾‹æ–¹æ³•:**éƒ½å¯ä»¥é‡è½½ã€‚</li><li>**ç¼–è¯‘æ—¶å†³å®š:**æ–¹æ³•çš„é€‰æ‹©åœ¨ç¼–è¯‘æ—¶ç”±ç¼–è¯‘å™¨æ ¹æ®å‚æ•°åˆ—è¡¨å†³å®šã€‚</li></ul><p><strong>é‡å†™(Overriding)</strong></p><p>**å®šä¹‰:**åœ¨å­ç±»ä¸­å®šä¹‰ä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¸çˆ¶ç±»ä¸­çš„æŸä¸ªæ–¹æ³•å…·æœ‰ç›¸åŒçš„æ–¹æ³•åç§°ã€å‚æ•°åˆ—è¡¨å’Œè¿”å›ç±»å‹ï¼Œä»¥ä¾¿åœ¨å­ç±»ä¸­æä¾›è¯¥æ–¹æ³•çš„å…·ä½“å®ç°ã€‚</p><p><strong>ç‰¹æ€§:</strong></p><ul><li>æ–¹æ³•åç§°:ç›¸åŒã€‚</li><li>å‚æ•°åˆ—è¡¨:å¿…é¡»ç›¸åŒã€‚</li><li>è¿”å›ç±»å‹:å¿…é¡»ç›¸åŒ(Java5åŠä»¥åå¯ä»¥æ˜¯åå˜è¿”å›ç±»å‹ï¼Œå³è¿”å›ç±»å‹å¯ä»¥æ˜¯çˆ¶ç±»æ–¹æ³•è¿”å›ç±»å‹çš„å­ç±»å‹)ã€‚</li><li>è®¿é—®ä¿®é¥°ç¬¦:è®¿é—®çº§åˆ«ä¸èƒ½æ¯”çˆ¶ç±»æ–¹æ³•æ›´ä¸¥æ ¼(å¯ä»¥æ›´å®½æ¾)ã€‚</li><li>é™æ€&#x2F;å®ä¾‹æ–¹æ³•:åªèƒ½é‡å†™å®ä¾‹æ–¹æ³•ï¼Œä¸èƒ½é‡å†™é™æ€æ–¹æ³•ã€‚</li><li>è¿è¡Œæ—¶å†³å®š:æ–¹æ³•çš„é€‰æ‹©åœ¨è¿è¡Œæ—¶ç”±JVM æ ¹æ®å¯¹è±¡çš„å®é™…ç±»å‹å†³å®š(åŠ¨æ€ç»‘å®š)ã€‚</li></ul><p><strong>æ€»ç»“</strong></p><ul><li><strong>é‡è½½:</strong><ul><li>å‘ç”Ÿåœ¨åŒä¸€ä¸ªç±»ä¸­ã€‚</li><li>æ–¹æ³•åç§°ç›¸åŒï¼Œå‚æ•°åˆ—è¡¨ä¸åŒã€‚</li><li>ç¼–è¯‘æ—¶å†³å®šè°ƒç”¨å“ªä¸ªæ–¹æ³•(é™æ€ç»‘å®š)ã€‚</li></ul></li><li><strong>é‡å†™ï¼š</strong><ul><li>å‘ç”Ÿåœ¨å­ç±»å’Œçˆ¶ç±»ä¹‹é—´ã€‚</li><li>æ–¹æ³•åç§°ã€å‚æ•°åˆ—è¡¨å’Œè¿”å›ç±»å‹å¿…é¡»ç›¸åŒ(æˆ–åå˜è¿”å›ç±»å‹ï¼‰ã€‚</li><li>è¿è¡Œæ—¶å†³å®šè°ƒç”¨å“ªä¸ªæ–¹æ³•(åŠ¨æ€ç»‘å®š)ã€‚</li></ul></li></ul><h3 id="æ„é€ å™¨èƒ½å¦è¢«é‡å†™ï¼Ÿ"><a href="#æ„é€ å™¨èƒ½å¦è¢«é‡å†™ï¼Ÿ" class="headerlink" title="æ„é€ å™¨èƒ½å¦è¢«é‡å†™ï¼Ÿ"></a>æ„é€ å™¨èƒ½å¦è¢«é‡å†™ï¼Ÿ</h3><p><strong>æ„é€ å™¨ä¸èƒ½è¢«é‡å†™</strong></p><p>**å®šä¹‰:**æ„é€ å™¨ä¸èƒ½è¢«é‡å†™(Overridden)ã€‚é‡å†™æ˜¯æŒ‡åœ¨å­ç±»ä¸­æä¾›ä¸€ä¸ªä¸çˆ¶ç±»æ–¹æ³•å…·æœ‰ç›¸åŒç­¾åçš„æ–¹æ³•ï¼Œä»¥ä¾¿åœ¨å­ç±»ä¸­æä¾›è¯¥æ–¹æ³•çš„å…·ä½“å®ç°ã€‚ä½†æ„é€ å™¨ä¸å±äºç±»çš„ç»§æ‰¿æˆå‘˜ï¼Œå› æ­¤ä¸èƒ½è¢«å­ç±»é‡å†™ã€‚</p><p><strong>åŸå› :</strong></p><ol><li>**æ„é€ å™¨çš„ä½œç”¨:**æ„é€ å™¨çš„ä¸»è¦ä½œç”¨æ˜¯åˆå§‹åŒ–å¯¹è±¡çš„çŠ¶æ€ã€‚æ¯ä¸ªç±»éƒ½æœ‰è‡ªå·±çš„æ„é€ å™¨ï¼Œç”¨äºåˆå§‹åŒ–è¯¥ç±»çš„å®ä¾‹ã€‚å­ç±»ä¸èƒ½ç›´æ¥ç»§æ‰¿çˆ¶ç±»çš„æ„é€ å™¨ï¼Œå› ä¸ºå­ç±»çš„åˆå§‹åŒ–è¿‡ç¨‹å¯èƒ½ä¸çˆ¶ç±»ä¸åŒã€‚</li><li>**æ–¹æ³•ç­¾åä¸åŒ:**é‡å†™è¦æ±‚æ–¹æ³•ç­¾å(åŒ…æ‹¬æ–¹æ³•åç§°å’Œå‚æ•°åˆ—è¡¨)ç›¸åŒï¼Œè€Œæ„é€ å™¨åœ¨å­ç±»ä¸­çš„åç§°ä¸çˆ¶ç±»ä¸åŒ2(æ„é€ å™¨åç§°å¿…é¡»ä¸ç±»åç›¸åŒ)ã€‚</li><li>**æ„é€ å™¨ä¸æ˜¯ç±»æˆå‘˜:**æ„é€ å™¨ä¸å±äºç±»çš„æˆå‘˜æ–¹æ³•ï¼Œå®ƒä»¬æ˜¯ç‰¹æ®Šçš„åˆå§‹åŒ–æ–¹æ³•ï¼Œä¸å‚ä¸ç»§æ‰¿æœºåˆ¶ã€‚</li></ol><p><strong>æ„é€ å™¨å¯ä»¥è¢«é‡è½½ï¼š</strong></p><p>è™½ç„¶æ„é€ å™¨ä¸èƒ½è¢«é‡å†™ï¼Œä½†å®ƒä»¬å¯ä»¥è¢«é‡è½½(Overloaded)ã€‚æ„é€ å™¨é‡è½½æ˜¯æŒ‡åœ¨åŒä¸€ä¸ªç±»ä¸­å®šä¹‰å¤šä¸ªæ„é€ å™¨ï¼Œè¿™äº›æ„é€ å™¨å…·æœ‰ç›¸åŒçš„åç§°(ç±»å)ï¼Œä½†å‚æ•°åˆ—è¡¨ä¸åŒã€‚</p><p><strong>ç»“è®ºï¼š</strong></p><ul><li>æ„é€ å™¨ä¸èƒ½è¢«é‡å†™:å› ä¸ºæ„é€ å™¨ä¸å±äºç±»çš„ç»§æ‰¿æˆå‘˜ï¼Œå¹¶ä¸”å®ƒä»¬çš„åç§°å¿…é¡»ä¸ç±»åç›¸åŒã€‚</li><li>æ„é€ å™¨å¯ä»¥è¢«é‡è½½:åœ¨åŒä¸€ä¸ªç±»ä¸­ï¼Œå¯ä»¥å®šä¹‰å¤šä¸ªæ„é€ å™¨ï¼Œåªè¦å®ƒä»¬çš„å‚æ•°åˆ—è¡¨ä¸åŒã€‚</li></ul><h3 id="Stringã€StringBuilderã€StringBufferçš„åŒºåˆ«"><a href="#Stringã€StringBuilderã€StringBufferçš„åŒºåˆ«" class="headerlink" title="Stringã€StringBuilderã€StringBufferçš„åŒºåˆ«"></a>Stringã€StringBuilderã€StringBufferçš„åŒºåˆ«</h3><ol><li><p><strong>String</strong></p><p><strong>ç‰¹æ€§:</strong></p><ul><li>ä¸å¯å˜æ€§:Stringå¯¹è±¡æ˜¯ä¸å¯å˜çš„ã€‚ä¸€æ—¦åˆ›å»ºï¼Œå­—ç¬¦ä¸²çš„å†…å®¹å°±ä¸èƒ½è¢«æ”¹å˜ã€‚ä»»ä½•å¯¹å­—ç¬¦ä¸²çš„ä¿®æ”¹éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„Stringå¯¹è±¡ã€‚</li><li>çº¿ç¨‹å®‰å…¨:ç”±äºStringå¯¹è±¡æ˜¯ä¸å¯å˜çš„ï¼Œå®ƒä»¬æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯ä»¥åœ¨å¤šä¸ªçº¿ç¨‹ä¸­å®‰å…¨åœ°å…±äº«ã€‚</li></ul><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><ul><li>é€‚ç”¨äºå­—ç¬¦ä¸²å†…å®¹ä¸ä¼šå‘ç”Ÿå˜åŒ–çš„åœºæ™¯ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²å¸¸é‡ã€å°‘é‡çš„å­—ç¬¦ä¸²æ“ä½œç­‰,</li></ul></li><li><p><strong>StringBuilder</strong></p><p><strong>ç‰¹æ€§:</strong></p><ul><li>å¯å˜æ€§:StringBuilderå¯¹è±¡æ˜¯å¯å˜çš„ï¼Œå¯ä»¥å¯¹å­—ç¬¦ä¸²å†…å®¹è¿›è¡Œä¿®æ”¹ï¼Œè€Œä¸ä¼šç”Ÿæˆæ–°çš„å¯¹è±¡ã€‚</li><li>éçº¿ç¨‹å®‰å…¨:StringBuilderä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå®ƒçš„æ–¹æ³•æ²¡æœ‰åŒæ­¥ï¼Œå› æ­¤åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ä½¿ç”¨æ—¶éœ€è¦é¢å¤–æ³¨æ„ã€‚</li></ul><p><strong>ä½¿ç”¨åœºæ™¯:</strong></p><ul><li>é€‚ç”¨äºåœ¨å•çº¿ç¨‹ç¯å¢ƒä¸­éœ€è¦é¢‘ç¹ä¿®æ”¹å­—ç¬¦ä¸²å†…å®¹çš„åœºæ™¯ï¼Œæ€§èƒ½æ¯”StringBufferæ›´é«˜ã€‚</li></ul></li><li><p><strong>StringBuffer</strong></p><p><strong>ç‰¹æ€§:</strong></p><ul><li><strong>å¯å˜æ€§:</strong> StringBufferå¯¹è±¡æ˜¯å¯å˜çš„ï¼Œå¯ä»¥å¯¹å­—ç¬¦ä¸²å†…å®¹è¿›è¡Œä¿®æ”¹ï¼Œè€Œä¸ä¼šç”Ÿæˆæ–°çš„å¯¹è±¡ã€‚</li><li><strong>çº¿ç¨‹å®‰å…¨:</strong> StringBufferæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå®ƒçš„æ–¹æ³•æ˜¯åŒæ­¥çš„ï¼Œå¯ä»¥åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­å®‰å…¨ä½¿ç”¨ã€‚</li></ul><p><strong>ä½¿ç”¨åœºæ™¯:</strong></p><ul><li>é€‚ç”¨äºåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­éœ€è¦é¢‘ç¹ä¿®æ”¹å­—ç¬¦ä¸²å†…å®¹çš„åœºæ™¯ã€‚</li></ul><p><strong>çº¿ç¨‹å®‰å…¨çš„åŸå› ï¼š</strong></p><ul><li>åœ¨è¯¸å¤šæ–¹æ³•ä¸ŠåŠ äº†åŒæ­¥é”<code>synchronized</code>ã€‚</li></ul></li></ol><h3 id="JDK1-8çš„å­—ç¬¦ä¸²å¸¸é‡æ‹¼æ¥æ˜¯æ€æ ·çš„è¿‡ç¨‹ï¼Ÿ"><a href="#JDK1-8çš„å­—ç¬¦ä¸²å¸¸é‡æ‹¼æ¥æ˜¯æ€æ ·çš„è¿‡ç¨‹ï¼Ÿ" class="headerlink" title="JDK1.8çš„å­—ç¬¦ä¸²å¸¸é‡æ‹¼æ¥æ˜¯æ€æ ·çš„è¿‡ç¨‹ï¼Ÿ"></a>JDK1.8çš„å­—ç¬¦ä¸²å¸¸é‡æ‹¼æ¥æ˜¯æ€æ ·çš„è¿‡ç¨‹ï¼Ÿ</h3><p><strong>ç¼–è¯‘æ—¶ä¼˜åŒ–ï¼š</strong></p><ol><li><p><strong>ç¼–è¯‘æ—¶å¸¸é‡æŠ˜å :</strong><br>å¯¹äºç¼–è¯‘æ—¶å·²çŸ¥çš„å­—ç¬¦ä¸²å¸¸é‡ï¼ŒJava ç¼–è¯‘å™¨ä¼šè¿›è¡Œå¸¸é‡æŠ˜å (Constant Folding)ã€‚è¿™æ„å‘³ç€åœ¨ç¼–è¯‘é˜¶æ®µï¼Œç¼–è¯‘å™¨ä¼šç›´æ¥è®¡ç®—å‡ºæ‹¼æ¥ç»“æœï¼Œå¹¶å°†å…¶ä½œä¸ºä¸€ä¸ªå•ä¸€çš„å­—ç¬¦ä¸²å¸¸é‡å­˜å‚¨åœ¨.classæ–‡ä»¶ä¸­ã€‚ä¾‹å¦‚:åœ¨ç¼–è¯‘æ—¶ï¼Œè¿™æ®µä»£ç ä¼šè¢«ä¼˜åŒ–ä¸º:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="string">&quot;Hello &quot;</span> + <span class="string">&quot;World!&quot;</span>;</span><br><span class="line"><span class="comment">// ç­‰åŒäº</span></span><br><span class="line"><span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="string">&quot;Hello World!&quot;</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>éå¸¸é‡è¡¨è¾¾å¼:</strong><br>å¦‚æœæ‹¼æ¥çš„å­—ç¬¦ä¸²åŒ…å«å˜é‡æˆ–æ–¹æ³•è°ƒç”¨ï¼Œç¼–è¯‘å™¨ä¸èƒ½åœ¨ç¼–è¯‘æ—¶ç¡®å®šç»“æœï¼Œå› æ­¤éœ€è¦åœ¨è¿è¡Œæ—¶è¿›è¡Œæ‹¼æ¥åœ¨ JDK 1.8 ä¸­ï¼Œç¼–è¯‘å™¨ä¼šå°†è¿™äº›æ‹¼æ¥æ“ä½œ<strong>è½¬æ¢ä¸ºä½¿ç”¨StringBuilderçš„ä»£ç </strong>ã€‚ä¾‹å¦‚:åœ¨ç¼–è¯‘æ—¶ï¼Œè¿™æ®µä»£ç ä¼šè¢«è½¬æ¢ä¸º:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">str1</span> <span class="operator">=</span> <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">str2</span> <span class="operator">=</span> <span class="string">&quot;World!&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> s1 + <span class="string">&quot; &quot;</span> + s2;</span><br><span class="line"><span class="comment">//ç­‰åŒäº</span></span><br><span class="line"><span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">sb.append(str1);</span><br><span class="line">sb.append(<span class="string">&quot; &quot;</span>);</span><br><span class="line">sb.append(str2);</span><br><span class="line"><span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> sb.toString();</span><br></pre></td></tr></table></figure></li></ol><p><strong>è¿è¡Œæ—¶å¤„ç†ï¼š</strong></p><ol><li><p><strong>StringBuilderçš„ä½¿ç”¨:</strong></p><p>åœ¨è¿è¡Œæ—¶ï¼Œå¯¹äºéå¸¸é‡çš„å­—ç¬¦ä¸²æ‹¼æ¥ï¼ŒStringBuilderè¢«ç”¨æ¥æ„å»ºæœ€ç»ˆçš„å­—ç¬¦ä¸²ã€‚StringBuilderæ˜¯å¯å˜çš„ï¼Œå› æ­¤å¯ä»¥é«˜æ•ˆåœ°è¿›è¡Œå­—ç¬¦ä¸²çš„æ‹¼æ¥æ“ä½œã€‚</p><p>ä¾‹å¦‚:åœ¨è¿è¡Œæ—¶ï¼ŒStringBuilderä¼šä¾æ¬¡è°ƒç”¨appendæ–¹æ³•ï¼Œå°†å„ä¸ªéƒ¨åˆ†æ‹¼æ¥èµ·æ¥ï¼Œå¹¶æœ€ç»ˆè°ƒç”¨toStringæ–¹æ³•ç”Ÿæˆç»“æœå­—ç¬¦ä¸²ã€‚</p><p><strong>æ€§èƒ½ä¼˜åŒ–ï¼š</strong></p><ul><li><p>å¾ªç¯æ‹¼æ¥ä¸€ä¸ªé•¿å­—ç¬¦ä¸²ï¼Œå»ºè®®ä½¿ç”¨StringBuilderï¼Œè™½ç„¶â€œ+â€æ‹¼æ¥å­—ç¬¦ä¸²ç¼–è¯‘åä¹Ÿä¼šå˜æˆStringBuilderï¼Œä½†æ˜¯æ¯æ¬¡å¾ªç¯å¤„ç†éƒ½ä¼šnewä¸€ä¸ªStringBuilderå¯¹è±¡ï¼Œè€—æ—¶ä¼šå¤§å¤§å¢åŠ ã€‚è€Œç›´æ¥ä½¿ç”¨StringBuilderï¼Œnewä¸€æ¬¡å°±å¯ä»¥äº†ï¼Œæ•ˆç‡ç›¸å¯¹é«˜ã€‚</p><p>ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¾ªç¯ä½¿ç”¨+æ‹¼æ¥å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testLoopStringConcatenation03ByPlus</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">10000</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> <span class="string">&quot;testLoopStringConcatenation03ByPlus:&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; count; i++) &#123;</span><br><span class="line">        str = str + <span class="string">&quot;-&quot;</span> + i;</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(str);</span><br><span class="line">    <span class="type">long</span> <span class="variable">endTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">    System.out.println(<span class="string">&quot;testLoopStringConcatenation03ByPlusï¼Œæ‹¼æ¥å­—ç¬¦ä¸²&quot;</span> + count + <span class="string">&quot;æ¬¡ï¼ŒèŠ±è´¹&quot;</span> + (endTime - startTime) + <span class="string">&quot;ç§’&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æµ‹è¯•å¾ªç¯ä½¿ç”¨StringBuilderæ‹¼æ¥å­—ç¬¦ä¸²è€—æ—¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testLoopStringConcatenation04ByStringBuilder</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">100000</span>;</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">stringBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="string">&quot;testLoopStringConcatenation04ByStringBuilder:&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; count; i++) &#123;</span><br><span class="line">        stringBuilder.append(<span class="string">&quot;-&quot;</span>);</span><br><span class="line">        stringBuilder.append(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> stringBuilder.toString();</span><br><span class="line">    System.out.println(str);</span><br><span class="line">    <span class="type">long</span> <span class="variable">endTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">    System.out.println(<span class="string">&quot;testLoopStringConcatenation04ByStringBuilderï¼Œæ‹¼æ¥å­—ç¬¦ä¸²&quot;</span> + count + <span class="string">&quot;æ¬¡ï¼ŒèŠ±è´¹&quot;</span> + (endTime - startTime) + <span class="string">&quot;ç§’&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>testLoopStringConcatenation03ByPlus</code>ï¼Œæ‹¼æ¥å­—ç¬¦ä¸²10000æ¬¡ï¼ŒèŠ±è´¹463ç§’ã€‚</p><p><code>testLoopStringConcatenation04ByStringBuilder</code>ï¼Œæ‹¼æ¥å­—ç¬¦ä¸²10000æ¬¡ï¼ŒèŠ±è´¹13ç§’ã€‚</p><p>å¯ä»¥çœ‹å‡ºï¼Œå·®å¼‚æ˜æ˜¾ï¼Œä¸åœ¨ä¸€ä¸ªé‡çº§äº†ã€‚</p></li></ul></li></ol><p><strong>æ€»ç»“ï¼š</strong></p><p>åœ¨ JDK 1.8 ä¸­ï¼Œå­—ç¬¦ä¸²å¸¸é‡çš„æ‹¼æ¥è¿‡ç¨‹åŒ…æ‹¬ç¼–è¯‘æ—¶çš„å¸¸é‡æŠ˜å å’Œè¿è¡Œæ—¶çš„StringBuilderä¼˜åŒ–ã€‚å¸¸é‡æŠ˜å åœ¨ç¼–è¯‘æ—¶å®Œæˆï¼Œè€Œå¯¹äºåŒ…å«å˜é‡æˆ–æ–¹æ³•è°ƒç”¨çš„æ‹¼æ¥ï¼Œç¼–è¯‘å™¨ä¼šå°†å…¶è½¬æ¢ä¸ºStringBuilderæ“ä½œï¼Œä»¥æé«˜è¿è¡Œæ—¶çš„æ€§èƒ½ã€‚</p><h3 id="é”"><a href="#é”" class="headerlink" title="é”"></a>é”</h3><p><a href="https://blog.csdn.net/qq_31129841/article/details/134800508?ops_request_misc=&request_id=&biz_id=102&utm_term=java%E9%94%81&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-134800508.142%5Ev100%5Epc_search_result_base8&spm=1018.2226.3001.4187">Javaä¸­æ¶‰åŠåˆ°çš„é”_javaçš„é”-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/w8y56f/article/details/89554060?ops_request_misc=%7B%22request_id%22:%226AC14F77-B54A-40E2-BC9B-B5E43E80DDE1%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=6AC14F77-B54A-40E2-BC9B-B5E43E80DDE1&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-89554060-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=%E5%8F%AF%E9%87%8D%E5%85%A5%E9%94%81&spm=1018.2226.3001.4187">å¯é‡å…¥é”è¯¦è§£ï¼ˆä»€ä¹ˆæ˜¯å¯é‡å…¥ï¼‰-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/qq_15002323/article/details/78299615?ops_request_misc=%7B%22request_id%22:%22189C86F7-3A36-4590-84CA-80D0EE05EA8B%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=189C86F7-3A36-4590-84CA-80D0EE05EA8B&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-78299615-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=synchronized%E5%92%8Cwait&spm=1018.2226.3001.4187">æµ…è°ˆsynchronizedã€waitã€notifyå’ŒnotifyAll_synchronized,wait,notify-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/qq_45795744/article/details/123493673?ops_request_misc=%7B%22request_id%22:%22757F3D0D-BE29-47FB-B090-2CC888215371%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=757F3D0D-BE29-47FB-B090-2CC888215371&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-123493673-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=java%E9%94%81%E5%8D%87%E7%BA%A7&spm=1018.2226.3001.4187">Javaä¸­çš„é”å‡çº§_java é”å‡çº§-CSDNåšå®¢</a></p><h3 id="AQS"><a href="#AQS" class="headerlink" title="AQS"></a>AQS</h3><p><a href="https://blog.csdn.net/agonie201218/article/details/128150609?ops_request_misc=%7B%22request_id%22:%2246413ADA-D970-4C57-A5F8-AF3CEAC5C857%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=46413ADA-D970-4C57-A5F8-AF3CEAC5C857&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-128150609-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=AQS&spm=1018.2226.3001.4187">è°ˆè°ˆJavaå¤šçº¿ç¨‹ç¦»ä¸å¼€çš„AQS_java aqs-CSDNåšå®¢</a></p><h3 id="CountDownLatch"><a href="#CountDownLatch" class="headerlink" title="CountDownLatch"></a>CountDownLatch</h3><p><a href="https://blog.csdn.net/qq_45871274/article/details/130223673?ops_request_misc=%7B%22request_id%22:%22C245A664-AD37-4411-9C27-8D08BC787897%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=C245A664-AD37-4411-9C27-8D08BC787897&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-130223673-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=countdownlatch&spm=1018.2226.3001.4187">CountDownLatchä»‹ç»å’Œä½¿ç”¨ã€Javaå¤šçº¿ç¨‹å¿…å¤‡ã€‘-CSDNåšå®¢</a></p><h3 id="sleepå’Œwait"><a href="#sleepå’Œwait" class="headerlink" title="sleepå’Œwait"></a>sleepå’Œwait</h3><p><a href="https://blog.csdn.net/jiaomubai/article/details/125235039?ops_request_misc=%7B%22request_id%22:%22C7E88F95-1EE1-4572-90A8-5A2C87D9DDC6%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=C7E88F95-1EE1-4572-90A8-5A2C87D9DDC6&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-1-125235039-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=sleep%E5%92%8Cwait&spm=1018.2226.3001.4187">çº¿ç¨‹çš„ sleep() æ–¹æ³•ä¸ wait() æ–¹æ³•çš„åŒºåˆ«_çº¿ç¨‹sleepå’Œwaitçš„åŒºåˆ«-CSDNåšå®¢</a></p><h2 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h2><p><a href="https://www.cnblogs.com/kismetv/p/10331633.html">æ·±å…¥å­¦ä¹ MySQLäº‹åŠ¡ï¼šACIDç‰¹æ€§çš„å®ç°åŸç† - ç¼–ç¨‹è¿·æ€ - åšå®¢å›­ (cnblogs.com)</a></p><h2 id="æ–¹æ³•è®º"><a href="#æ–¹æ³•è®º" class="headerlink" title="æ–¹æ³•è®º"></a>æ–¹æ³•è®º</h2><h3 id="å¦‚ä½•ç›‘æ§æ…¢SQL"><a href="#å¦‚ä½•ç›‘æ§æ…¢SQL" class="headerlink" title="å¦‚ä½•ç›‘æ§æ…¢SQL"></a>å¦‚ä½•ç›‘æ§æ…¢SQL</h3><ol><li><p><strong>å¯ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—</strong></p><p>æ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯ MySQL å†…ç½®çš„ä¸€ç§åŠŸèƒ½ï¼Œç”¨äºè®°å½•æ‰§è¡Œæ—¶é—´è¶…è¿‡æŒ‡å®šé˜ˆå€¼çš„ SQL æŸ¥è¯¢ã€‚</p><p><strong>é…ç½® MySQL é…ç½®æ–‡ä»¶(my.cnf æˆ– my.ini)</strong></p><p>åœ¨ MySQL é…ç½®æ–‡ä»¶ä¸­æ·»åŠ æˆ–ä¿®æ”¹ä»¥ä¸‹å‚æ•°:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line"></span><br><span class="line">slow_query_log=1</span><br><span class="line"></span><br><span class="line">slow_query_log_file=/var/log/mysql/slow-query.log</span><br><span class="line"></span><br><span class="line">long_query_time =2</span><br><span class="line"></span><br><span class="line">log queries not using indexes =1</span><br></pre></td></tr></table></figure><ul><li>slow_query_log: å¯ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—ã€‚</li><li>slow_query_log_file: æŒ‡å®šæ…¢æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„ã€‚</li><li>long_query_time: å®šä¹‰æ…¢æŸ¥è¯¢çš„é˜ˆå€¼(å•ä½:ç§’)ã€‚</li><li>Â·log_queries_not _using_indexes: è®°å½•æœ«ä½¿ç”¨ç´¢å¼•çš„æŸ¥è¯¢ã€‚</li></ul><p><strong>é‡å¯ MySQLæœåŠ¡</strong></p><p>ä¿®æ”¹é…ç½®æ–‡ä»¶åï¼Œé‡å¯ MySQLæœåŠ¡ä»¥ä½¿é…ç½®ç”Ÿæ•ˆ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart mysql</span><br></pre></td></tr></table></figure></li><li><p><strong>ä½¿ç”¨ MySQLå†…ç½®çš„æ€§èƒ½æ¨¡å¼(Performance Schema)</strong></p><p>Performance Schemaæ˜¯ MySQL å†…ç½®çš„ä¸€ä¸ªå·¥å…·ï¼Œç”¨äºæ”¶é›†æ•°æ®åº“å†…éƒ¨çš„è¿è¡Œæ—¶ç»Ÿè®¡ä¿¡æ¯ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤å¯ç”¨å’Œä½¿ç”¨ Performance Schema:</p><p><strong>å¯ç”¨Performance Scheme</strong></p><p>åœ¨MySQLé…ç½®æ–‡ä»¶ä¸­æ·»åŠ æˆ–ä¿®æ”¹ä»¥ä¸‹å‚æ•°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">performance_schema =ON</span><br></pre></td></tr></table></figure><p><strong>é‡å¯MySQLæœåŠ¡</strong></p><p>ä¿®æ”¹é…ç½®æ–‡ä»¶åï¼Œé‡å¯MySQLæœåŠ¡ä»¥ä½¿é…ç½®ç”Ÿæ•ˆï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart mysql</span><br></pre></td></tr></table></figure><p><strong>æŸ¥è¯¢æ…¢æŸ¥è¯¢ä¿¡æ¯</strong></p><p>ä½¿ç”¨ä»¥ä¸‹SQLè¯­å¥æŸ¥è¯¢æ…¢æŸ¥è¯¢ä¿¡æ¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM performance_schema.events_statements_summary_by_digest ORDER BY SUM_TIMER_WAIT DESC LIMIT 10</span><br></pre></td></tr></table></figure></li><li><p><strong>ä½¿ç”¨ MySQL ä¼ä¸šç›‘æ§å·¥å…·</strong></p><p>MySQLæä¾›äº†ä¼ä¸šç‰ˆçš„ç›‘æ§å·¥å…·ï¼Œå¦‚ MySQL Enterprise Monitorï¼Œå®ƒå¯ä»¥è‡ªåŠ¨æ”¶é›†ã€åˆ†æå’ŒæŠ¥å‘Šæ…¢æŸ¥è¯¢ä¿¡æ¯ã€‚</p><p>è¿™ä¸ªå·¥å…·é€‚åˆä¼ä¸šç¯å¢ƒä¸‹çš„å…¨é¢ç›‘æ§å’Œç®¡ç†ã€‚</p></li><li><p><strong>ä½¿ç”¨ç¬¬ä¸‰æ–¹ç›‘æ§å·¥å…·</strong></p><p>æœ‰è®¸å¤šç¬¬ä¸‰æ–¹ç›‘æ§å·¥å…·å¯ä»¥å¸®åŠ©ä½ ç›‘æ§ MySQLçš„æ€§èƒ½ï¼ŒåŒ…æ‹¬æ…¢æŸ¥è¯¢ã€‚è¿™äº›å·¥å…·é€šå¸¸æä¾›æ›´ä¸°å¯Œçš„åŠŸèƒ½å’Œæ›´å‹å¥½çš„ç•Œé¢ã€‚å¸¸è§çš„ç¬¬ä¸‰æ–¹å·¥å…·åŒ…æ‹¬:</p><ul><li>**Percona Monitoring and Management (PMM):**ä¸€ä¸ªå¼€æºçš„ç›‘æ§å’Œç®¡ç†å·¥å…·ï¼Œä¸“ä¸º MySQLå’ŒMongoDB è®¾è®¡ã€‚</li><li>**New Relic:**ä¸€ä¸ªå¼ºå¤§çš„åº”ç”¨æ€§èƒ½ç›‘æ§å·¥å…·ï¼Œæ”¯æŒ MySQL å’Œå…¶ä»–æ•°æ®åº“ã€‚</li><li>**Datadog:**ä¸€ä¸ªç»¼åˆæ€§çš„ç›‘æ§å¹³å°ï¼Œæ”¯æŒ MySQL å’Œå…¶ä»–æ•°æ®åº“ã€‚</li></ul></li><li><p>ä½¿ç”¨ SQLåˆ†æå·¥å…·</p><p>MySQLæä¾›äº†EXPLAINè¯­å¥ï¼Œç”¨äºåˆ†æ SQLæŸ¥è¯¢çš„æ‰§è¡Œè®¡åˆ’ã€‚é€šè¿‡åˆ†ææ‰§è¡Œè®¡åˆ’ï¼Œå¯ä»¥è¯†åˆ«å’Œä¼˜åŒ–æ…¢æŸ¥è¯¢</p><p><strong>ä½¿ç”¨EXPLAINåˆ†ææŸ¥è¯¢</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN SELECT * FROM your_table WHERE your_condition;</span><br></pre></td></tr></table></figure><p>EXPLAINçš„è¾“å‡ºç»“æœåŒ…å«äº†æŸ¥è¯¢æ‰§è¡Œçš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä½¿ç”¨çš„ç´¢å¼•ã€æ‰«æçš„è¡Œæ•°ç­‰ã€‚é€šè¿‡åˆ†æè¿™äº›ä¿¡æ¯ï¼Œå¯ä»¥æ‰¾å‡ºæŸ¥è¯¢çš„æ€§èƒ½ç“¶é¢ˆå¹¶è¿›è¡Œä¼˜åŒ–ã€‚</p></li></ol><p><strong>æ€»ç»“</strong></p><p>ç›‘æ§æ…¢ SQLæ˜¯ä¸€ä¸ªæŒç»­çš„è¿‡ç¨‹ï¼Œéœ€è¦ç»“åˆå¤šç§å·¥å…·å’Œæ–¹æ³•ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç»¼åˆçš„ç›‘æ§ç­–ç•¥:</p><ol><li>å¯ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—:è®°å½•æ‰§è¡Œæ—¶é—´è¶…è¿‡é˜ˆå€¼çš„æŸ¥è¯¢ã€‚</li><li>ä½¿ç”¨ Performance Schema:æ”¶é›†å’Œåˆ†æè¯¦ç»†çš„è¿è¡Œæ—¶ç»Ÿè®¡ä¿¡æ¯ã€‚</li><li>ä½¿ç”¨ä¼ä¸šç›‘æ§å·¥å…·:å¦‚ MySQLEnterprise Monitorï¼Œè¿›è¡Œå…¨é¢çš„ç›‘æ§å’Œç®¡ç†ã€‚</li><li>ä½¿ç”¨ç¬¬ä¸‰æ–¹ç›‘æ§å·¥å…·:å¦‚ Percona Monitoring and Management(PMM)ã€New Relicã€Datadog ç­‰ã€‚</li><li>ä½¿ç”¨ SQL åˆ†æå·¥å…·:å¦‚EXPLAINï¼Œåˆ†æå’Œä¼˜åŒ–æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ã€‚</li></ol><h3 id="MySQLå¸¸ç”¨ç›‘æ§æŒ‡æ ‡"><a href="#MySQLå¸¸ç”¨ç›‘æ§æŒ‡æ ‡" class="headerlink" title="MySQLå¸¸ç”¨ç›‘æ§æŒ‡æ ‡"></a>MySQLå¸¸ç”¨ç›‘æ§æŒ‡æ ‡</h3><ol><li><p>QPS: æ•°æ®åº“æ¯ç§’å¤„ç†çš„è¯·æ±‚æ•°é‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global status where variable_name in(&#x27;Queries&quot;,&#x27;uptime&#x27;);</span><br></pre></td></tr></table></figure><p>QPS &#x3D;(Queries2 -Queries1)&#x2F;(uptime2 -uptime1)</p></li><li><p>TPS: æ•°æ®åº“æ¯ç§’å¤„ç†çš„äº‹åŠ¡æ•°é‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global status where variable name in(&#x27;com insert&#x27;,com delete&#x27;,com update&#x27;,&#x27;uptime&#x27;);</span><br></pre></td></tr></table></figure><p>äº‹åŠ¡æ•°TC  â‰ˆ â€˜com_insertâ€™,â€™com_deleteâ€™,â€™com_updateâ€™</p><p>TPS â‰ˆ (TC2 -TC1)&#x2F;(uptime2 -uptime1)</p></li><li><p>å¹¶å‘æ•°ï¼šæ•°æ®åº“å®ä¾‹å½“å‰å¹¶è¡Œå¤„ç†çš„ä¼šè¯æ•°é‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global status like &#x27;Threads_running&#x27;;</span><br></pre></td></tr></table></figure></li><li><p>è¿æ¥æ•°ï¼šè¿æ¥åˆ°æ•°æ®åº“ä¼šè¯çš„æ•°é‡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global status like &#x27;Threads connected&#x27;;</span><br></pre></td></tr></table></figure></li><li><p>ç¼“å­˜å‘½ä¸­ç‡ï¼šæŸ¥è¯¢å‘½ä¸­ç¼“å­˜çš„æ¯”ä¾‹</p><p>innodbç¼“å†²æ± æŸ¥è¯¢æ€»æ•°:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global status like &#x27;innodb_buffer_pool_read_requests&#x27;;</span><br></pre></td></tr></table></figure><p>innodbä»ç£ç›˜æŸ¥è¯¢æ•°:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show global status like &#x27;innodb_buffer_pool_reads&#x27;;</span><br></pre></td></tr></table></figure><p>ç”Ÿäº§ä¸­é…ç½®æŠ¥è­¦é˜ˆå€¼:innodb buffer pool read requests &#x2F;(innodb buffer pool read requests +innodb buffer pool reads)&gt;0.95</p></li><li><p>å¯ç”¨æ€§:æ•°æ®åº“æ˜¯å¦å¯ä»¥æ­£å¸¸å¯¹å¤–æœåŠ¡</p><p>å‘¨æœŸæ€§è¿æ¥æ•°æ®åº“å¹¶æ‰§è¡Œ <strong>select @@version;</strong></p></li><li><p>é˜»å¡ï¼šå½“å‰é˜»å¡çš„ä¼šè¯æ•°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select waiting_pid as &#x27;è¢«é˜³å¡çº¿ç¨‹&#x27;,</span><br><span class="line">waiting_query as &#x27;è¢«é˜»å¡SQL&#x27;,</span><br><span class="line">blocking_pid as &#x27;é˜»å¡çº¿ç¨‹&#x27;,</span><br><span class="line">blocking_query as &#x27;é˜»å¡SQL&#x27;,</span><br><span class="line">wait_age as &#x27;é˜»å¡æ—¶é—´â€™,</span><br><span class="line">sql_ki1l_blocking_query as&#x27;å»ºè®®æ“ä½œ&#x27;</span><br><span class="line">from sys.innodb_lock_waits</span><br><span class="line">where(unix_timestamp()-unix_timestamp(wait started))&gt;é˜»å¡ç§’æ•°</span><br></pre></td></tr></table></figure></li><li><p>æ…¢æŸ¥è¯¢ï¼šæ…¢æŸ¥è¯¢æƒ…å†µ</p><p>å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ã€‚my.inf</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">slow_query_log=on</span><br><span class="line">slow_query_log_file=å­˜æ”¾ç›®å½•long_query_time=0.1ç§’</span><br><span class="line">log_queries_not_using_indexes=on</span><br></pre></td></tr></table></figure></li></ol><h3 id="æ…¢sqlä¼˜åŒ–æ–¹å‘"><a href="#æ…¢sqlä¼˜åŒ–æ–¹å‘" class="headerlink" title="æ…¢sqlä¼˜åŒ–æ–¹å‘"></a>æ…¢sqlä¼˜åŒ–æ–¹å‘</h3><ol><li>æ£€æŸ¥æŸ¥è¯¢è¯­å¥æœ¬èº«ã€‚ç¡®ä¿ä½¿ç”¨äº†åˆé€‚çš„ç´¢å¼•ï¼Œé¿å…å…¨è¡¨æ‰«æã€‚æ¯”å¦‚ï¼Œåœ¨WHEREã€JOINæˆ–ORDER BYå­å¥ä¸­æ¶‰åŠçš„åˆ—ä¸Šåˆ›å»ºç´¢å¼•ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§æå‡æŸ¥è¯¢é€Ÿåº¦ã€‚</li><li>ä¼˜åŒ–æ•°æ®åº“è®¾è®¡ã€‚æ¯”å¦‚ï¼Œä½¿ç”¨è¡¨åˆ†åŒºæ¥å¤„ç†å¤§è¡¨ï¼Œæˆ–è€…æ ¹æ®å®é™…éœ€è¦åœ¨è§„èŒƒåŒ–å’Œåè§„èŒƒåŒ–ä¹‹é—´åšå‡ºå¹³è¡¡ï¼Œä»¥å‡å°‘å¤æ‚çš„JOINæ“ä½œã€‚</li><li>è°ƒæ•´ MVSQLçš„é…ç½®å‚æ•°ã€‚æ¯”å¦‚ï¼Œå¢åŠ  InnoDB ç¼“å†²æ± çš„å¤§å°ï¼Œè®©æ›´å¤šçš„æ•°æ®å¯ä»¥ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œå‡å°‘ç£ç›˜ &#x2F;&#x2F;O æ“ä½œã€‚åŒæ—¶ï¼Œæ ¹æ®éœ€è¦è°ƒæ•´æŸ¥è¯¢ç¼“å­˜çš„å¤§å°ã€‚</li><li>ä½¿ç”¨ä¸€äº›æ€§èƒ½åˆ†æå·¥å…·ï¼Œæ¯”å¦‚EXPLAINï¼Œæ¥åˆ†ææŸ¥è¯¢çš„æ‰§è¡Œè®¡åˆ’ï¼Œæ‰¾å‡ºæ€§èƒ½ç“¶é¢ˆã€‚PerformanceSchema ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æ”¶é›†è¯¦ç»†çš„æ€§èƒ½æ•°æ®ã€‚</li><li>æŒç»­çš„ç›‘æ§å’Œè°ƒä¼˜æ˜¯å¿…ä¸å¯å°‘çš„ã€‚ä½¿ç”¨ä¸€äº›ç›‘æ§å·¥å…·ï¼Œæ¯”å¦‚Percona Monitoring and Management(PMM) æˆ– Datadogï¼Œæ¥å®æ—¶ç›‘æ§æ•°æ®åº“çš„æ€§èƒ½ï¼Œå¹¶å®šæœŸå®¡æŸ¥å’Œä¼˜åŒ–æ…¢æŸ¥è¯¢ï¼Œç¡®ä¿æ•°æ®åº“å§‹ç»ˆä¿æŒé«˜æ•ˆã€‚</li></ol><p><strong>è¯¦ç»†è§£è¯»ï¼š</strong></p><ol><li><p><strong>ä¼˜åŒ–æŸ¥è¯¢è¯­å¥</strong></p><p><strong>ä½¿ç”¨é€‚å½“çš„ç´¢å¼•</strong></p><ul><li><p><strong>åˆ›å»ºç´¢å¼•</strong>: ç¡®ä¿æŸ¥è¯¢ä½¿ç”¨äº†é€‚å½“çš„ç´¢å¼•ã€‚å¯¹é¢‘ç¹å‡ºç°åœ¨WHEREã€JOINã€ORDER BYå’ŒGROUP BYå­å¥ä¸­çš„åˆ—åˆ›å»ºç´¢å¼•ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX idx_column_name <span class="keyword">on</span> table_name(column_name);</span><br></pre></td></tr></table></figure></li><li><p><strong>å¤åˆç´¢å¼•</strong>ï¼šå¯¹äºå¤šåˆ—æŸ¥è¯¢ï¼Œè€ƒè™‘ä½¿ç”¨å¤åˆç´¢å¼•(å¤šåˆ—ç´¢å¼•)ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX idx_columns <span class="keyword">ON</span> table_ name(column1,column2);</span><br></pre></td></tr></table></figure></li></ul><p><strong>é¿å…å…¨è¡¨æ‰«æ</strong></p><ul><li><p><strong>ä½¿ç”¨åˆé€‚çš„è¿‡æ»¤æ¡ä»¶</strong>: ç¡®ä¿WHEREå­å¥ä¸­çš„æ¡ä»¶èƒ½å¤Ÿæœ‰æ•ˆåœ°åˆ©ç”¨ç´¢å¼•ï¼Œé¿å…å…¨è¡¨æ‰«æã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> index_colum <span class="operator">=</span> <span class="string">&#x27;value&#x27;</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>é™åˆ¶è¿”å›çš„è¡Œæ•°</strong>ï¼šä½¿ç”¨LIMITå­—å¥é™åˆ¶è¿”å›çš„è¡Œæ•°ï¼Œå‡å°‘æ•°æ®åº“çš„è´Ÿæ‹…ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">table</span> name <span class="keyword">WHERE</span> <span class="keyword">condition</span> LIMIT <span class="number">10</span>;</span><br></pre></td></tr></table></figure></li></ul><p><strong>ä¼˜åŒ–JOINæ“ä½œ</strong></p><ul><li><p><strong>ä½¿ç”¨å°è¡¨é©±åŠ¨å¤§è¡¨</strong>ï¼šåœ¨JOINæ“ä½œä¸­ï¼Œç¡®ä¿å°è¡¨åœ¨å‰ï¼Œå¤§è¡¨åœ¨åã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> small_table ST <span class="keyword">JOIN</span> <span class="keyword">large</span></span><br><span class="line">_table LT <span class="keyword">on</span> ST.id<span class="operator">=</span>LT.id;</span><br></pre></td></tr></table></figure></li></ul><p><strong>é¿å…ä¸å¿…è¦çš„å¤æ‚æŸ¥è¯¢</strong></p><ul><li><p><strong>ç®€åŒ–æŸ¥è¯¢</strong>ï¼šå°½é‡ç®€åŒ–æŸ¥è¯¢ï¼Œé¿å…ä½¿ç”¨ä¸å¿…è¦çš„å­æŸ¥è¯¢å’ŒåµŒå¥—æŸ¥è¯¢ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># é¿å…å¤æ‚çš„åµŒå¥—æŸ¥è¯¢</span><br><span class="line"><span class="keyword">SELECT</span><span class="operator">*</span><span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> id <span class="keyword">IN</span>(<span class="keyword">SELECT</span> id <span class="keyword">FROM</span> another_table <span class="keyword">WHERE</span> <span class="keyword">condition</span>);</span><br><span class="line"># ä½¿ç”¨<span class="keyword">JOIN</span>æ›¿ä»£</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> table_name <span class="keyword">JOIN</span> another_table <span class="keyword">ON</span> table_name.id <span class="operator">=</span> another_table.id <span class="keyword">WHERE</span> <span class="keyword">condition</span>;  </span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>ä¼˜åŒ–æ•°æ®åº“è®¾è®¡</strong></p><p><strong>è§„èŒƒåŒ–ä¸åè§„èŒƒåŒ–</strong></p><ul><li><strong>è§„èŒƒåŒ–</strong>:ç¡®ä¿æ•°æ®åº“è®¾è®¡ç¬¦åˆç¬¬ä¸‰èŒƒå¼ï¼Œå‡å°‘æ•°æ®å‡ ä½™ï¼Œ</li><li><strong>åè§„èŒƒåŒ–</strong>:åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸ºäº†æ€§èƒ½ï¼Œå¯ä»¥é€‚åº¦åè§„èŒƒåŒ–ï¼Œå‡å°‘å¤æ‚çš„JOINæ“ä½œã€‚</li></ul><p><strong>åˆ†åŒºè¡¨</strong></p><ul><li><p>è¡¨åˆ†åŒº:å¯¹äºéå¸¸å¤§çš„è¡¨ï¼Œå¯ä»¥ä½¿ç”¨è¡¨åˆ†åŒºï¼Œå°†æ•°æ®åˆ†æˆæ›´å°çš„éƒ¨åˆ†ï¼Œæé«˜æŸ¥è¯¢æ€§èƒ½ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CREATETABLE orders</span><br><span class="line"><span class="keyword">order</span> id <span class="type">INT</span>,</span><br><span class="line"><span class="keyword">order</span> <span class="type">date</span> <span class="type">DATE</span>,</span><br><span class="line">...</span><br><span class="line">)PARTITIONBYRANGE(<span class="keyword">YEAR</span>(<span class="keyword">order</span> <span class="type">date</span>))(<span class="keyword">PARTITION</span> PO <span class="keyword">VALUES</span> LESS THAN(<span class="number">2020</span>),</span><br><span class="line"><span class="keyword">PARTITION</span> PI <span class="keyword">VALUES</span> LESS THAN(<span class="number">2021</span>),</span><br><span class="line"><span class="keyword">PARTITION</span> P2 <span class="keyword">VALUES</span> LESS THAN(<span class="number">2022</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>ä¼˜åŒ–æœåŠ¡å™¨é…ç½®</strong></p><p><strong>è°ƒæ•´ MySQL é…ç½®å‚æ•°</strong></p><ul><li><p>**è°ƒæ•´ç¼“å†²æ± å¤§å°:**å¯¹äºInnoDB å­˜å‚¨å¼•æ“ï¼Œè°ƒæ•´innodb_buffer_pool_sizeå‚æ•°ï¼Œä½¿å…¶å°½é‡å¤§(ä½†ä¸è¦è¶…è¿‡ç‰©ç†å†…å­˜çš„ 70-80%)ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]innodb_buffer_pool_size = 4G</span><br></pre></td></tr></table></figure></li><li><p>**è°ƒæ•´æŸ¥è¯¢ç¼“å­˜:**æ ¹æ®åº”ç”¨éœ€æ±‚ï¼Œè°ƒæ•´æŸ¥è¯¢ç¼“å­˜å¤§å°ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]query_cache_size =64M</span><br></pre></td></tr></table></figure></li></ul><p><strong>ä½¿ç”¨åˆé€‚çš„å­˜å‚¨å¼•æ“ï¼š</strong></p><ul><li>é€‰æ‹©é€‚å½“çš„å­˜å‚¨å¼•æ“:æ ¹æ®åº”ç”¨éœ€æ±‚é€‰æ‹©åˆé€‚çš„å­˜å‚¨å¼•è­¦(å¦‚InnoDBã€MyISAM)ã€‚</li></ul></li><li><p><strong>ä½¿ç”¨æ€§èƒ½åˆ†æå·¥å…·</strong></p><p><strong>ä½¿ç”¨EXPLAINåˆ†ææŸ¥è¯¢</strong></p><ul><li><p><strong>åˆ†ææ‰§è¡Œè®¡åˆ’ï¼š</strong>ä½¿ç”¨EXPLAINåˆ†ææŸ¥è¯¢çš„æ‰§è¡Œè®¡åˆ’ï¼Œè¯†åˆ«æ€§èƒ½ç“¶é¢ˆã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN SELECT*FROM your table WHERE your condition;</span><br></pre></td></tr></table></figure></li></ul><p><strong>ä½¿ç”¨æ€§èƒ½æ¨¡å¼ï¼ˆPerformance Schemaï¼‰</strong></p><ul><li><p>æ”¶é›†æ€§èƒ½æ•°æ®:ä½¿ç”¨ Performance Schema æ”¶é›†è¯¦ç»†çš„æ€§èƒ½æ•°æ®ï¼Œåˆ†ææ…¢æŸ¥è¯¢ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span><span class="operator">*</span><span class="keyword">FROM</span> performance_schema.events_statements_summary_by_digest <span class="keyword">ORDER</span> <span class="keyword">BY</span> SUM_TIMER_WAIT <span class="keyword">DESC</span> LIMIT <span class="number">10</span>;</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>ç›‘æ§å’Œè°ƒä¼˜</strong></p><p><strong>æŒç»­ç›‘æ§</strong></p><ul><li>**ä½¿ç”¨ç›‘æ§å·¥å…·:**ä½¿ç”¨ MySQLEnterprise Monitorã€Percona Monitoring and Management (PMM)ã€New Relicã€Datadog ç­‰å·¥å…·æŒç»­ç›‘æ§æ•°æ®åº“æ€§èƒ½ã€‚</li></ul><p><strong>å®šæœŸè°ƒä¼˜</strong></p><ul><li>**å®šæœŸå®¡æŸ¥æŸ¥è¯¢:**å®šæœŸå®¡æŸ¥å’Œä¼˜åŒ–æ…¢æŸ¥è¯¢ï¼Œç¡®ä¿æ•°æ®åº“æ€§èƒ½æŒç»­æå‡ã€‚</li></ul></li></ol><h2 id="JVM"><a href="#JVM" class="headerlink" title="JVM"></a>JVM</h2><h3 id="JVMçš„ä¸»è¦ç»„æˆéƒ¨åˆ†"><a href="#JVMçš„ä¸»è¦ç»„æˆéƒ¨åˆ†" class="headerlink" title="JVMçš„ä¸»è¦ç»„æˆéƒ¨åˆ†"></a>JVMçš„ä¸»è¦ç»„æˆéƒ¨åˆ†</h3><ol><li><p>ç±»åŠ è½½å­ç³»ç»Ÿï¼ˆäº”æ­¥ï¼‰</p><ul><li>æè¿°:ç±»åŠ è½½å­ç³»ç»Ÿè´Ÿè´£å°† .class æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¹¶è¿›è¡ŒéªŒè¯ã€å‡†å¤‡ã€è§£æå’Œåˆå§‹åŒ–ã€‚</li><li>ä¸»è¦åŠŸèƒ½:<ul><li>åŠ è½½:ä»æ–‡ä»¶ç³»ç»Ÿæˆ–ç½‘ç»œä¸­è¯»å– .class æ–‡ä»¶ã€‚</li><li>éªŒè¯:ç¡®ä¿å­—èŠ‚ç æ–‡ä»¶çš„æ­£ç¡®æ€§å’Œå®‰å…¨æ€§ã€‚</li><li>å‡†å¤‡:ä¸ºç±»çš„é™æ€å˜é‡åˆ†é…å†…å­˜å¹¶è®¾ç½®é»˜è®¤åˆå§‹å€¼ã€‚</li><li>è§£æ:å°†ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨ã€‚</li><li>åˆå§‹åŒ–:æ‰§è¡Œç±»çš„é™æ€åˆå§‹åŒ–å—å’Œé™æ€å˜é‡çš„åˆå§‹åŒ–ã€‚</li></ul></li></ul></li><li><p>è¿è¡Œæ—¶æ•°æ®åŒºï¼ˆäº”éƒ¨åˆ†ï¼‰</p><p>JVM åœ¨è¿è¡Œæ—¶å°†å†…å­˜åˆ’åˆ†ä¸ºå¤šä¸ªä¸åŒçš„æ•°æ®åŒºåŸŸï¼Œæ¯ä¸ªåŒºåŸŸéƒ½æœ‰ç‰¹å®šçš„ç”¨é€”ã€‚</p><ul><li><strong>æ–¹æ³•åŒº(Method Area)</strong>: å­˜å‚¨å·²åŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰ã€‚</li><li><strong>å †(Heap)</strong>: å­˜å‚¨æ‰€æœ‰å¯¹è±¡å®ä¾‹å’Œæ•°ç»„ï¼Œæ˜¯åƒåœ¾æ”¶é›†çš„ä¸»è¦åŒºåŸŸã€‚</li><li><strong>Java æ ˆ(Java Stacks)</strong>: æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„ Java æ ˆï¼Œå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•è¿”å›åœ°å€ç­‰ä¿¡æ¯ã€‚</li><li><strong>æœ¬åœ°æ–¹æ³•æ ˆ(Native Method stacks)</strong>: ä¸ºæœ¬åœ°æ–¹æ³•è°ƒç”¨æœåŠ¡ï¼Œå­˜å‚¨æœ¬åœ°æ–¹æ³•è°ƒç”¨çš„çŠ¶æ€ã€‚</li><li><strong>ç¨‹åºè®¡æ•°å™¨(Program Counter Register)</strong>:æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨ï¼ŒæŒ‡ç¤ºå½“å‰çº¿ç¨‹æ‰§è¡Œçš„å­—èŠ‚ç è¡Œå·ã€‚</li></ul></li><li><p>æ‰§è¡Œå¼•æ“ï¼ˆä¸‰éƒ¨åˆ†ï¼‰</p><ul><li><strong>æè¿°:</strong> æ‰§è¡Œå¼•æ“è´Ÿè´£æ‰§è¡Œå­—èŠ‚ç æŒ‡ä»¤,</li><li><strong>ä¸»è¦ç»„ä»¶:</strong><ul><li><strong>è§£é‡Šå™¨(Interpreter)</strong>: é€æ¡è§£é‡Šæ‰§è¡Œå­—èŠ‚ç æŒ‡ä»¤ï¼Œé€Ÿåº¦è¾ƒæ…¢ã€‚</li><li><strong>å³æ—¶ç¼–è¯‘å™¨(Just-In-Time Compiler, JIT)</strong>: å°†çƒ­ç‚¹ä»£ç (é¢‘ç¹æ‰§è¡Œçš„ä»£ç )ç¼–è¯‘ä¸ºæœ¬åœ°æœºå™¨ç ï¼Œæé«˜æ‰§è¡Œé€Ÿåº¦ã€‚</li><li>**åƒåœ¾æ”¶é›†å™¨(Garbage Colector, GC):**è‡ªåŠ¨ç®¡ç†å†…å­˜ï¼Œå›æ”¶ä¸å†ä½¿ç”¨çš„å¯¹è±¡ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚</li></ul></li></ul></li><li><p>æœ¬åœ°æ¥å£</p><ul><li>**æè¿°:**æœ¬åœ°æ¥å£(é€šå¸¸æ˜¯Java Native Interface,JNI)å…è®¸Java ä»£ç ä¸æœ¬åœ°(éJava)ä»£ç è¿›è¡Œäº¤äº’ã€‚</li><li>ä¸»è¦åŠŸèƒ½:<ul><li>è°ƒç”¨æœ¬åœ°æ–¹æ³•(é€šå¸¸æ˜¯ç”¨Cæˆ–C++ç¼–å†™çš„)ã€‚</li><li>å…è®¸ Java ä»£ç ä½¿ç”¨æ“ä½œç³»ç»Ÿç‰¹æ€§æˆ–è®¿é—®ç¡¬ä»¶ã€‚</li></ul></li></ul></li><li><p>æœ¬åœ°æ–¹æ³•åº“</p><ul><li>æè¿°:æœ¬åœ°æ–¹æ³•åº“æ˜¯å­˜å‚¨æœ¬åœ°æ–¹æ³•å®ç°çš„åŠ¨æ€é“¾æ¥åº“(å¦‚.d æ–‡ä»¶æˆ–.so æ–‡ä»¶)ã€‚</li><li>ä¸»è¦åŠŸèƒ½:<ul><li>æä¾›æœ¬åœ°æ–¹æ³•çš„å…·ä½“å®ç°ã€‚</li><li>ç”±æœ¬åœ°æ¥å£è°ƒç”¨ä»¥æ‰§è¡Œæœ¬åœ°ä»£ç ã€‚</li></ul></li></ul></li></ol><p><strong>æ€»ç»“ï¼š</strong></p><ul><li><strong>ç±»åŠ è½½å­ç³»ç»Ÿ</strong>: è´Ÿè´£åŠ è½½ã€éªŒè¯ã€å‡†å¤‡ã€è§£æå’Œåˆå§‹åŒ–ç±»ã€‚</li><li><strong>è¿è¡Œæ—¶æ•°æ®åŒº:</strong> åŒ…æ‹¬æ–¹æ³•åŒºã€å †ã€Java æ ˆã€æœ¬åœ°æ–¹æ³•æ ˆå’Œç¨‹åºè®¡æ•°å™¨ã€‚</li><li><strong>æ‰§è¡Œå¼•æ“:</strong> åŒ…æ‹¬è§£é‡Šå™¨ã€å³æ—¶ç¼–è¯‘å™¨å’Œåƒåœ¾æ”¶é›†å™¨ã€‚</li><li><strong>æœ¬åœ°æ¥å£:</strong> å…è®¸ Java ä»£ç ä¸æœ¬åœ°ä»£ç äº¤äº’ã€‚</li><li><strong>æœ¬åœ°æ–¹æ³•åº“:</strong> å­˜å‚¨æœ¬åœ°æ–¹æ³•å®ç°çš„åŠ¨æ€é“¾æ¥åº“ã€‚</li></ul><h3 id="JVMå †çš„å†…éƒ¨ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#JVMå †çš„å†…éƒ¨ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="JVMå †çš„å†…éƒ¨ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ"></a>JVMå †çš„å†…éƒ¨ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>â€‹JVM å †æ˜¯ Java è™šæ‹Ÿæœºç”¨äºå­˜å‚¨å¯¹è±¡å®ä¾‹å’Œæ•°ç»„çš„å†…å­˜åŒºåŸŸã€‚å †å†…å­˜æ˜¯ JVM ç®¡ç†çš„ä¸»è¦å†…å­˜åŒºåŸŸä¹‹ä¸€ï¼Œå †å†…å­˜çš„ç®¡ç†å’Œä¼˜åŒ–å¯¹ Java åº”ç”¨ç¨‹åºçš„æ€§èƒ½è‡³å…³é‡è¦ã€‚å †å†…å­˜çš„å†…éƒ¨ç»“æ„é€šå¸¸åˆ†ä¸ºå‡ ä¸ªä¸åŒçš„åŒºåŸŸï¼Œä»¥ä¾¿æ›´é«˜æ•ˆåœ°è¿›è¡Œå†…å­˜åˆ†é…å’Œåƒåœ¾å›æ”¶ã€‚</p><ol><li><p><strong>æ–°ç”Ÿä»£(Young Generation)</strong></p><p>æ–°ç”Ÿä»£ç”¨äºå­˜å‚¨æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚å¤§å¤šæ•°å¯¹è±¡åœ¨æ–°ç”Ÿä»£ä¸­åˆ›å»ºï¼Œå¹¶ä¸”å¾ˆå¿«å°±ä¼šè¢«åƒåœ¾å›æ”¶ã€‚æ–°ç”Ÿä»£è¿›ä¸€æ­¥åˆ†ä¸ºä¸‰ä¸ªåŒºåŸŸï¼š</p><ul><li>**Eden åŒº(Eden Space): **å¤§å¤šæ•°æ–°å¯¹è±¡é¦–å…ˆåˆ†é…åœ¨ Eden åŒºã€‚å½“ Eden åŒºå¡«æ»¡æ—¶ï¼Œä¼šè§¦å‘ä¸€æ¬¡è½»é‡çº§çš„åƒåœ¾å›æ”¶(Minor GC)ã€‚</li><li>**å¹¸å­˜è€…åŒº(Survivor Spaces): **æ–°ç”Ÿä»£ä¸­æœ‰ä¸¤ä¸ªå¹¸å­˜è€…åŒºï¼Œç§°ä¸ºS0(Survivor0)å’ŒS1(Survivor 1)ã€‚åœ¨ä¸€æ¬¡ Minor GCä¹‹åï¼Œä»ç„¶å­˜æ´»çš„å¯¹è±¡ä¼šä» Eden åŒºå’Œå½“å‰çš„å¹¸å­˜è€…åŒºå¤åˆ¶åˆ°å¦ä¸€ä¸ªå¹¸å­˜è€…åŒºï¼ˆæ ‡è®°å¤åˆ¶ï¼‰ã€‚ä¸¤ä¸ªå¹¸å­˜è€…åŒºä¼šåœ¨æ¯æ¬¡ GC åäº¤æ›¿ä½¿ç”¨ã€‚</li></ul></li><li><p><strong>è€å¹´ä»£(Old Generation)</strong></p><p>è€å¹´ä»£ç”¨äºå­˜å‚¨ç”Ÿå‘½å‘¨æœŸè¾ƒé•¿çš„å¯¹è±¡ã€‚é‚£äº›åœ¨æ–°ç”Ÿä»£ç»å†äº†å¤šæ¬¡åƒåœ¾ï¼ˆé»˜è®¤15æ¬¡ï¼‰å›æ”¶ä»ç„¶å­˜æ´»çš„å¯¹è±¡ä¼šè¢«ç§»åŠ¨åˆ°è€å¹´ä»£ã€‚è€å¹´ä»£çš„åƒåœ¾å›æ”¶ç›¸å¯¹è¾ƒå°‘ï¼Œä½†æ¯æ¬¡å›æ”¶çš„æ—¶é—´è¾ƒé•¿ï¼Œç§°ä¸º Major GC æˆ– FuI GCã€‚</p></li><li><p><strong>æ°¸ä¹…ä»£(Permanent Generation)å’Œå…ƒç©ºé—´(Metaspace)</strong></p><ul><li>**æ°¸ä¹…ä»£(Permanent Generation): **åœ¨JDK8ä¹‹å‰ï¼Œæ°¸ä¹…ä»£ç”¨äºå­˜å‚¨ç±»çš„å…ƒæ•°æ®ã€å¸¸é‡æ± ã€æ–¹æ³•ä¿¡æ¯ç­‰ã€‚æ°¸ä¹…ä»£çš„å¤§å°æ˜¯å›ºå®šçš„ï¼Œå®¹æ˜“å¯¼è‡´OutOfMemoryErroré”™è¯¯ã€‚</li><li>**å…ƒç©ºé—´(Metaspace): **ä»JDK8å¼€å§‹ï¼Œæ°¸ä¹…ä»£è¢«å…ƒç©ºé—´å–ä»£ã€‚å…ƒç©ºé—´ä¸åœ¨JVMå †ä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨æœ¬åœ°å†…å­˜ã€‚å…ƒç©ºé—´çš„å¤§å°å¯ä»¥åŠ¨æ€è°ƒæ•´ï¼Œå‡å°‘äº†OutOfMemoryErrorçš„é£é™©ã€‚</li></ul></li></ol><h3 id="JVMå †å’Œæ ˆçš„åŒºåˆ«"><a href="#JVMå †å’Œæ ˆçš„åŒºåˆ«" class="headerlink" title="JVMå †å’Œæ ˆçš„åŒºåˆ«"></a>JVMå †å’Œæ ˆçš„åŒºåˆ«</h3><p>â€‹åœ¨ JVM(Java Virtual Machine)ä¸­ï¼Œå †(Heap)å’Œæ ˆ(Stack)æ˜¯ä¸¤ç§ä¸åŒçš„å†…å­˜åŒºåŸŸï¼Œå®ƒä»¬åœ¨å†…å­˜ç®¡ç†å’Œç¨‹åºæ‰§è¡Œä¸­æ‰®æ¼”ç€ä¸åŒçš„è§’è‰²ã€‚ä»¥ä¸‹æ˜¯å®ƒä»¬çš„ä¸»è¦åŒºåˆ«:</p><ol><li><p><strong>å­˜å‚¨å†…å®¹</strong></p><ul><li><strong>å †ï¼š</strong><ul><li>ç”¨äºå­˜å‚¨æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹å’Œæ•°ç»„ã€‚</li><li>æ‰€æœ‰å¯¹è±¡å®ä¾‹å’Œæ•°ç»„éƒ½åœ¨å †ä¸­åˆ†é…å†…å­˜ã€‚</li></ul></li><li><strong>æ ˆï¼š</strong><ul><li>ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•è¿”å›åœ°å€)ã€‚</li><li>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„æ ˆï¼Œæ ˆä¸­çš„æ•°æ®ä¸çº¿ç¨‹â€“å¯¹åº”ã€‚</li></ul></li></ul></li><li><p><strong>å†…å­˜ç®¡ç†æ–¹å¼</strong></p><ul><li><strong>å †ï¼š</strong><ul><li>ç”±åƒåœ¾æ”¶é›†å™¨(Garbage Collector)è¿›è¡Œè‡ªåŠ¨ç®¡ç†ï¼Œè´Ÿè´£åˆ†é…å’Œå›æ”¶å¯¹è±¡å†…å­˜ã€‚</li><li>å †å†…å­˜æ˜¯å…¨å±€å…±äº«çš„ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½å¯ä»¥è®¿é—®å †ä¸­çš„å¯¹è±¡ã€‚</li></ul></li><li><strong>æ ˆï¼š</strong><ul><li>ç”±ç¼–è¯‘å™¨è‡ªåŠ¨ç®¡ç†ï¼Œå†…å­˜åˆ†é…å’Œé‡Šæ”¾æŒ‰ç…§æ–¹æ³•è°ƒç”¨çš„é¡ºåºè¿›è¡Œ(LIFOï¼Œåè¿›å…ˆå‡º)ã€‚</li><li>æ ˆå†…å­˜æ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„æ ˆï¼Œäº’ä¸å¹²æ‰°ã€‚</li></ul></li></ul></li><li><p><strong>ç”Ÿå‘½å‘¨æœŸï¼š</strong></p><ul><li>å †ï¼š<ul><li>å¯¹è±¡åœ¨å †ä¸­çš„ç”Ÿå‘½å‘¨æœŸç”±åƒåœ¾æ”¶é›†å™¨å†³å®šï¼Œåªè¦æœ‰å¼•ç”¨æŒ‡å‘å¯¹è±¡ï¼Œå¯¹è±¡å°±ä¼šå­˜åœ¨å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå¯ä»¥è·¨è¶Šå¤šä¸ªæ–¹æ³•è°ƒç”¨ï¼Œç›´åˆ°æ²¡æœ‰å¼•ç”¨æŒ‡å‘å®ƒæ—¶æ‰ä¼šè¢«åƒåœ¾æ”¶é›†å™¨å›æ”¶ã€‚</li></ul></li><li>æ ˆï¼š<ul><li>å±€éƒ¨å˜é‡çš„ç”Ÿå‘½å‘¨æœŸä¸æ–¹æ³•è°ƒç”¨çš„ç”Ÿå‘½å‘¨æœŸä¸€è‡´ï¼Œæ–¹æ³•è°ƒç”¨ç»“æŸæ—¶ï¼Œæ ˆå¸§è¢«é”€æ¯ï¼Œå±€éƒ¨å˜é‡ä¹Ÿéšä¹‹é”€æ¯ã€‚</li><li>æ ˆä¸­çš„æ•°æ®åœ¨æ–¹æ³•è°ƒç”¨ç»“æŸåç«‹å³é‡Šæ”¾ã€‚</li></ul></li></ul></li><li><p><strong>å†…å­˜å¤§å°:</strong></p><ul><li><strong>å †ï¼š</strong><ul><li>é€‚åˆå­˜å‚¨éœ€è¦è¾ƒé•¿ç”Ÿå‘½å‘¨æœŸçš„å¤§é‡å¯¹è±¡ã€‚</li><li>é€šå¸¸è¾ƒå¤§ï¼Œå¯ä»¥é€šè¿‡ JVM å‚æ•°(å¦‚-Xmså’Œ-Xmx)è¿›è¡Œé…ç½®ã€‚</li></ul></li><li><strong>æ ˆï¼š</strong><ul><li>é€šå¸¸è¾ƒå°ï¼Œæ¯ä¸ªçº¿ç¨‹çš„æ ˆå¤§å°å¯ä»¥é€šè¿‡ JVM å‚æ•°(å¦‚-Xss)è¿›è¡Œé…ç½®ã€‚</li><li>é€‚åˆå­˜å‚¨çŸ­ç”Ÿå‘½å‘¨æœŸçš„å°æ•°æ®ã€‚</li></ul></li></ul></li><li><p><strong>çº¿ç¨‹å®‰å…¨</strong></p><ul><li><strong>å †ï¼š</strong><ul><li>ç”±äºæ˜¯å…¨å±€å…±äº«çš„ï¼Œå †ä¸­çš„å¯¹è±¡åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹éœ€è¦è¿›è¡ŒåŒæ­¥æ§åˆ¶ï¼Œä»¥é¿å…çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</li></ul></li><li><strong>æ ˆï¼š</strong><ul><li>ç”±äºæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œæ ˆä¸­çš„æ•°æ®å¤©ç„¶æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¸éœ€è¦é¢å¤–çš„åŒæ­¥æ§åˆ¶ã€‚</li></ul></li></ul></li><li><p><strong>è®¿é—®é€Ÿåº¦</strong></p><ul><li><strong>å †ï¼š</strong><ul><li>è®¿é—®é€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢ï¼Œå› ä¸ºéœ€è¦é€šè¿‡å¼•ç”¨è¿›è¡Œè®¿é—®ï¼Œå¹¶ä¸”æ¶‰åŠåˆ°åƒåœ¾æ”¶é›†å™¨çš„ç®¡ç†ã€‚</li></ul></li><li><strong>æ ˆï¼š</strong><ul><li>è®¿é—®é€Ÿåº¦ç›¸å¯¹è¾ƒå¿«ï¼Œå› ä¸ºæ ˆä¸­æ•°æ®ç›´æ¥é€šè¿‡æ ˆå¸§è¿›è¡Œè®¿é—®ï¼Œä¸”ä¸”æ ˆçš„å†…å­˜åˆ†é…å’Œé‡Šæ”¾æ•ˆç‡é«˜ã€‚</li></ul></li></ul></li><li><p>å†…å­˜æº¢å‡º</p><ul><li><strong>å †ï¼š</strong><ul><li>å¦‚æœå †å†…å­˜ä¸è¶³ï¼Œä¼šæŠ›å‡ºOutOfMemoryError(å¦‚java.lang.OutOfMemoryError: Java heap space)ã€‚</li></ul></li><li><strong>æ ˆï¼š</strong><ul><li>å¦‚æœæ ˆå†…å­˜ä¸è¶³ï¼Œä¼šæŠ›å‡ºStackOverflowError(å¦‚java.lang.StackOverflowError)ã€‚</li></ul></li></ul></li></ol><p>æ€»ç»“</p><ul><li><strong>å †:</strong> ç”¨äºå­˜å‚¨å¯¹è±¡å®ä¾‹å’Œæ•°ç»„ï¼Œç”±åƒåœ¾æ”¶é›†å™¨ç®¡ç†ï¼Œç”Ÿå‘½å‘¨æœŸè¾ƒé•¿ï¼Œå†…å­˜è¾ƒå¤§ï¼Œçº¿ç¨‹å…±äº«ã€‚</li><li><strong>æ ˆ:</strong> ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡å’Œæ–¹æ³•è°ƒç”¨ä¿¡æ¯ï¼Œç”±ç¼–è¯‘å™¨ç®¡ç†ï¼Œç”Ÿå‘½å‘¨æœŸçŸ­ï¼Œå†…å­˜è¾ƒå°ï¼Œçº¿ç¨‹ç§æœ‰ã€‚</li></ul><h3 id="JVMè¿è¡Œæ—¶çš„æ•°æ®åŒºåŸŸå¦‚ä½•ç†è§£ï¼Ÿ"><a href="#JVMè¿è¡Œæ—¶çš„æ•°æ®åŒºåŸŸå¦‚ä½•ç†è§£ï¼Ÿ" class="headerlink" title="JVMè¿è¡Œæ—¶çš„æ•°æ®åŒºåŸŸå¦‚ä½•ç†è§£ï¼Ÿ"></a>JVMè¿è¡Œæ—¶çš„æ•°æ®åŒºåŸŸå¦‚ä½•ç†è§£ï¼Ÿ</h3><p>Java è™šæ‹Ÿæœº(JM)åœ¨è¿è¡Œæ—¶å°†å†…å­˜åˆ’åˆ†ä¸ºè‹¥å¹²ä¸åŒçš„æ•°æ®åŒºåŸŸï¼Œæ¯ä¸ªåŒºåŸŸéƒ½æœ‰ç‰¹å®šçš„ç”¨é€”ã€‚</p><p><strong>JVM è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ</strong></p><p>JVM è¿è¡Œæ—¶æ•°æ®åŒºåŸŸä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†:</p><ol><li>æ–¹æ³•åŒº(Method Area)</li><li>å †(Heap)</li><li>Java æ ˆ(Java Stacks)</li><li>æœ¬åœ°æ–¹æ³•æ ˆ(Native Method Stacks)</li><li>ç¨‹åºè®¡æ•°å™¨(Program Counter Register)</li></ol><p><strong>æ–¹æ³•åŒº(Method Area)</strong></p><ul><li><strong>æè¿°:</strong> æ–¹æ³•åŒºæ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸï¼Œç”¨äºå­˜å‚¨å·²è¢« JVM åŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€å³æ—¶ç¼–è¯‘å™¨é™æ€å˜é‡ã€ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚</li><li><strong>åŠŸèƒ½:</strong><ul><li>å­˜å‚¨ç±»çš„ç»“æ„ä¿¡æ¯(å¦‚ç±»çš„åç§°ã€è®¿é—®ä¿®é¥°ç¬¦ã€å­—æ®µæè¿°ã€æ–¹æ³•æè¿°ç­‰)ã€‚</li><li>åŒ…æ‹¬å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ã€‚å­˜å‚¨è¿è¡Œæ—¶å¸¸é‡æ± ã€‚</li><li>å­˜å‚¨é™æ€å˜é‡</li><li>å­˜å‚¨ç¼–è¯‘åçš„ä»£ç ã€‚</li></ul></li><li>åœ¨ HotSpot JVM ä¸­ï¼Œæ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†å®ç°ä¸ºæ°¸ä¹…ä»£(PermGen)ï¼Œåœ¨ Java8 åŠä»¥åç‰ˆæœ¬ä¸­è¢«ç§°ä¸ºå…ƒç©ºé—´(Metaspace)ã€‚</li></ul><p><strong>å †(Heap)</strong></p><ul><li><strong>æè¿°:</strong> å †æ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸï¼Œç”¨äºå­˜å‚¨æ‰€æœ‰å¯¹è±¡å®ä¾‹å’Œæ•°ç»„ã€‚</li><li><strong>åŠŸèƒ½:</strong><ul><li>åŠ¨æ€åˆ†é…å¯¹è±¡å†…å­˜ã€‚</li><li>åƒåœ¾æ”¶é›†å™¨ä¸»è¦åœ¨å †ä¸Šå·¥ä½œï¼Œå›æ”¶ä¸å†ä½¿ç”¨çš„å¯¹è±¡å†…å­˜ã€‚</li></ul></li><li>å †é€šå¸¸åˆ†ä¸ºå¹´è½»ä»£(Young Generation)å’Œè€å¹´ä»£(Old Generation)ï¼Œå¹´è½»ä»£åˆè¿›ä¸€æ­¥åˆ’åˆ†ä¸º Eden åŒºå’Œä¸¤ä¸ªSurvivoråŒº(S0å’ŒS1)ã€‚</li></ul><p><strong>Java æ ˆ(Java Stacks)</strong></p><ul><li><strong>æè¿°:</strong> æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„ Java æ ˆï¼Œæ ˆå¸§(Stack Frame)åœ¨æ ˆä¸­æŒ‰é¡ºåºå­˜å‚¨ã€‚</li><li><strong>åŠŸèƒ½:</strong><ul><li>å­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•è¿”å›åœ°å€ç­‰ä¿¡æ¯ã€‚</li><li>æ¯è°ƒç”¨ä¸€ä¸ªæ–¹æ³•ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ ˆå¸§ï¼Œæ–¹æ³•æ‰§è¡Œå®Œæ¯•åæ ˆå¸§è¢«é”€æ¯ã€‚</li></ul></li><li>æ ˆå¸§åŒ…æ‹¬:<ul><li>å±€éƒ¨å˜é‡è¡¨:å­˜å‚¨æ–¹æ³•çš„å±€éƒ¨å˜é‡ï¼Œä¸ªåŒ…æ‹¬å‚æ•°å’Œæ–¹æ³•å†…éƒ¨çš„å±€éƒ¨å˜é‡</li><li>æ“ä½œæ•°æ ˆ:ç”¨äºæ“ä½œæ•°çš„ä¸´æ—¶å­˜å‚¨ã€‚</li><li>åŠ¨æ€é“¾æ¥:æŒ‡å‘å¸¸é‡æ± çš„æ–¹æ³•å¼•ç”¨ï¼Œ</li><li>æ–¹æ³•è¿”å›åœ°å€:æ–¹æ³•è°ƒç”¨åçš„è¿”å›åœ°å€ï¼Œ</li></ul></li></ul><p><strong>æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stacksï¼‰</strong></p><ul><li><p>**æè¿°:**æœ¬åœ°æ–¹æ³•æ ˆä¸ Java æ ˆç±»ä¼¼ï¼Œä½†å®ƒä¸ºæœ¬åœ°(Native)æ–¹æ³•æœåŠ¡ã€‚</p></li><li><p><strong>åŠŸèƒ½:</strong></p><ul><li>å­˜å‚¨æœ¬åœ°æ–¹æ³•è°ƒç”¨çš„çŠ¶æ€ã€‚</li><li>ä¸€äº› JVM ä½¿ç”¨ C æ ˆæ¥æ”¯æŒæœ¬åœ°æ–¹æ³•è°ƒç”¨ã€‚</li></ul></li></ul><p><strong>ç¨‹åºè®¡æ•°å™¨(Program Counter Register)</strong></p><ul><li>**æè¿°:**æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå°çš„å†…å­˜åŒºåŸŸã€‚</li><li><strong>åŠŸèƒ½:</strong><ul><li>å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ã€‚</li><li>å¦‚æœå½“å‰æ‰§è¡Œçš„æ˜¯æœ¬åœ°æ–¹æ³•ï¼Œè¿™ä¸ªè®¡æ•°å™¨å€¼ä¸ºç©º(Undefined)ã€‚</li></ul></li></ul><p><strong>æ€»ç»“</strong></p><ul><li><strong>æ–¹æ³•åŒº:</strong> å­˜å‚¨ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘ä»£ç ã€‚</li><li><strong>å †:</strong> å­˜å‚¨å¯¹è±¡å®ä¾‹å’Œæ•°ç»„ï¼Œæ˜¯åƒåœ¾æ”¶é›†çš„ä¸»è¦åŒºåŸŸã€‚</li><li><strong>Java æ ˆ:</strong> æ¯ä¸ªçº¿ç¨‹æœ‰ä¸€ä¸ªï¼Œå­˜å‚¨æ–¹æ³•è°ƒç”¨çš„å¸§ã€‚</li><li><strong>æœ¬åœ°æ–¹æ³•æ ˆ:</strong> å­˜å‚¨æœ¬åœ°æ–¹æ³•è°ƒç”¨çš„çŠ¶æ€ã€‚</li><li><strong>ç¨‹åºè®¡æ•°å™¨:</strong> å­˜å‚¨å½“å‰çº¿ç¨‹æ‰§è¡Œçš„å­—èŠ‚ç è¡Œå·</li></ul><h3 id="ä¸ºä»€ä¹ˆè¦åˆ†Edenå’ŒSurvivor"><a href="#ä¸ºä»€ä¹ˆè¦åˆ†Edenå’ŒSurvivor" class="headerlink" title="ä¸ºä»€ä¹ˆè¦åˆ†Edenå’ŒSurvivor?"></a>ä¸ºä»€ä¹ˆè¦åˆ†Edenå’ŒSurvivor?</h3><p>åœ¨JVM ä¸­å°†æ–°ç”Ÿä»£(Young Generation)åˆ†ä¸º Eden åŒºå’Œä¸¤ä¸ªSurvivoråŒº(S0å’ŒS1)çš„ä¸»è¦åŸå› æ˜¯ä¸ºäº†ä¼˜åŒ–åƒåœ¾å›æ”¶çš„æ•ˆç‡å’Œæ€§èƒ½ã€‚è¿™ç§åˆ†åŒºç­–ç•¥åŸºäºå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç‰¹ç‚¹ï¼Œåˆ©ç”¨å¤åˆ¶ç®—æ³•æ¥å‡å°‘å†…å­˜ç¢ç‰‡å’Œæé«˜åƒåœ¾å›æ”¶çš„æ•ˆç‡ã€‚</p><ol><li><p><strong>ä¼˜åŒ–åƒåœ¾å›æ”¶æ•ˆç‡</strong></p><p>æ–°ç”Ÿä»£çš„åƒåœ¾å›æ”¶é€šå¸¸ä½¿ç”¨å¤åˆ¶ç®—æ³•(Copying Algorithm)ï¼Œè¿™ç§ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†å­˜æ´»çš„å¯¹è±¡ä»ä¸€ä¸ªåŒºåŸŸå¤åˆ¶åˆ°å¦ä¸€ä¸ªåŒºåŸŸï¼Œè€Œä¸æ˜¯åœ¨åŸåœ°è¿›è¡Œæ ‡è®°å’Œæ¸…é™¤ã€‚å¤åˆ¶ç®—æ³•çš„æ­¥éª¤å¦‚ä¸‹:</p><ul><li>**å¯¹è±¡åˆ†é…:**æ–°åˆ›å»ºçš„å¯¹è±¡é¦–å…ˆåˆ†é…åœ¨ Eden åŒºã€‚ã€‚</li><li>**Minor GC è§¦å‘:**å½“ Eden åŒºå¡«æ»¡æ—¶ï¼Œä¼šè§¦å‘ä¸€æ¬¡ Minor GC</li><li>**å¯¹è±¡å¤åˆ¶:**åœ¨ Minor GC è¿‡ç¨‹ä¸­ï¼Œå­˜æ´»çš„å¯¹è±¡ä¼šä» Eden åŒºå’Œå½“å‰ä½¿ç”¨çš„ Survivor åŒº(ä¾‹å¦‚ S0)å¤åˆ¶åˆ°å¦ä¸€ä¸ª Survivor åŒº(ä¾‹å¦‚ S1)ã€‚å¤åˆ¶å®Œæˆåï¼ŒEden åŒºå’Œå½“å‰ä½¿ç”¨çš„ Survivor åŒºå°†è¢«æ¸…ç©ºã€‚</li><li>**åŒºåŸŸäº¤æ¢:**ä¸¤ä¸ª Survivor åŒºåœ¨æ¯æ¬¡ GC åäº¤æ›¿ä½¿ç”¨ã€‚</li></ul><p>è¿™ç§ç®—æ³•çš„ä¼˜ç‚¹æ˜¯:</p><ul><li>**å‡å°‘å†…å­˜ç¢ç‰‡: **å¤åˆ¶ç®—æ³•é€šè¿‡å°†å­˜æ´»å¯¹è±¡ç´§å¯†æ’åˆ—åœ¨ä¸€èµ·ï¼Œé¿å…äº†å†…å­˜ç¢ç‰‡çš„é—®é¢˜ã€‚</li><li>**æé«˜å›æ”¶é€Ÿåº¦:**å¤åˆ¶ç®—æ³•åªéœ€è¦éå†å­˜æ´»å¯¹è±¡ï¼Œè€Œä¸éœ€è¦éå†æ•´ä¸ªå†…å­˜åŒºåŸŸï¼Œè¿™ä½¿å¾—åƒåœ¾å›æ”¶çš„é€Ÿåº¦æ›´å¿«ã€‚</li></ul></li><li><p><strong>ä¼˜åŒ–å†…å­˜åˆ†é…</strong></p><p>å°†æ–°ç”Ÿä»£åˆ†ä¸º Eden åŒºå’Œä¸¤ä¸ª Survivor åŒºï¼Œèƒ½å¤Ÿæ›´å¥½åœ°ç®¡ç†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ</p><ul><li><p><strong>å¤§å¤šæ•°å¯¹è±¡ç”Ÿå‘½å‘¨æœŸçŸ­</strong>: å¤§å¤šæ•°æ–°åˆ›å»ºçš„å¯¹è±¡å¾ˆå¿«å°±ä¼šå˜å¾—ä¸å¯è¾¾å¹¶è¢«å›æ”¶ã€‚Eden åŒºä¸“é—¨ç”¨äºå­˜å‚¨è¿™äº›çŸ­ç”Ÿå‘½å‘¨æœŸå¯¹è±¡ï¼Œæé«˜äº†å†…å­˜åˆ†é…å’Œå›æ”¶çš„æ•ˆç‡ã€‚</p></li><li><p>**å¹¸å­˜è€…å¯¹è±¡ç®¡ç†:**é‚£äº›åœ¨ä¸€æ¬¡æˆ–å¤šæ¬¡ Minor GCåä»ç„¶å­˜æ´»çš„å¯¹è±¡ä¼šè¢«å¤åˆ¶åˆ° Survivor åŒºã€‚é€šè¿‡åœ¨ä¸¤ä¸ªSurvivor åŒºä¹‹é—´å¤åˆ¶å’Œäº¤æ¢ï¼Œå¯ä»¥æœ‰æ•ˆç®¡ç†è¿™äº›å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œç›´åˆ°å®ƒä»¬è¢«æå‡åˆ°è€å¹´ä»£ã€‚</p></li></ul></li><li><p><strong>å‡å°‘GCåœé¡¿æ—¶é—´ï¼š</strong></p><p>å¤åˆ¶ç®—æ³•å’Œåˆ†åŒºç­–ç•¥æœ‰åŠ©äºå‡å°‘ GC åœé¡¿æ—¶é—´(GC Pause Time)ï¼Œæé«˜åº”ç”¨ç¨‹åºçš„å“åº”é€Ÿåº¦:</p><ul><li><strong>Minor GC æ›´å¿«é€Ÿ:</strong> ç”±äºæ–°ç”Ÿä»£é€šå¸¸è¾ƒå°ï¼Œå¹¶ä¸”å¤åˆ¶ç®—æ³•åªå¤„ç†å­˜æ´»å¯¹è±¡ï¼ŒMinor GC çš„åœé¡¿æ—¶é—´é€šå¸¸è¾ƒçŸ­ã€‚</li><li>**è€å¹´ä»£ GCå‡å°‘:**é€šè¿‡æœ‰æ•ˆç®¡ç†æ–°ç”Ÿä»£çš„å¯¹è±¡ï¼Œå‡å°‘äº†è€å¹´ä»£çš„å¯¹è±¡æ•°é‡å’Œåƒåœ¾å›æ”¶é¢‘ç‡ï¼Œä»è€Œå‡å°‘äº†Major GC æˆ– Ful GC çš„æ¬¡æ•°å’Œåœé¡¿æ—¶é—´ã€‚</li></ul></li></ol><p><strong>ç¤ºä¾‹</strong>ï¼š</p><ul><li>å‡è®¾æœ‰ä¸€ä¸ªæ–°ç”Ÿä»£å¤§å°ä¸º1GBï¼Œå…¶ä¸­EdenåŒºå 80%(800MB)ï¼Œä¸¤ä¸ªSurvivor åŒºå„å  10%(100 MB)ã€‚å¯¹è±¡é¦–å…ˆåˆ†é…åœ¨ Eden åŒºï¼Œå½“ Eden åŒºå¡«æ»¡æ—¶ï¼Œè§¦å‘ Minor Gcï¼Œå°†å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°ä¸€ä¸ª Survivor åŒºã€‚ä¸‹æ¬¡ GCæ—¶ï¼Œå†å°†å­˜æ´»å¯¹è±¡ä»å½“å‰ Survivor åŒºå¤åˆ¶åˆ°å¦ä¸€ä¸ª Survivor åŒºã€‚</li></ul><p><strong>æ€»ç»“</strong>ï¼š</p><ul><li>å°†æ–°ç”Ÿä»£åˆ†ä¸º Eden åŒºå’Œä¸¤ä¸ª Survivor åŒºçš„ä¸»è¦ç›®çš„æ˜¯ä¼˜åŒ–åƒåœ¾å›æ”¶çš„æ•ˆç‡å’Œæ€§èƒ½ã€‚é€šè¿‡åˆ©ç”¨å¤åˆ¶ç®—æ³•ï¼Œå¯ä»¥å‡å°‘å†…å­˜ç¢ç‰‡ï¼Œæé«˜åƒåœ¾å›æ”¶é€Ÿåº¦ï¼Œå¹¶æœ‰æ•ˆç®¡ç†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œä»è€Œå‡å°‘GCåœé¡¿æ—¶é—´ï¼Œæé«˜åº”ç”¨ç¨‹åºçš„å“åº”é€Ÿåº¦ã€‚è¿™ç§åˆ†åŒºç­–ç•¥æ˜¯ JVM å†…å­˜ç®¡ç†çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå¸®åŠ©æé«˜Java åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œç¨³å®šæ€§ã€‚</li></ul><h3 id="ä»€ä¹ˆæ˜¯JVMæ–¹æ³•åŒºï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯JVMæ–¹æ³•åŒºï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯JVMæ–¹æ³•åŒºï¼Ÿ"></a>ä»€ä¹ˆæ˜¯JVMæ–¹æ³•åŒºï¼Ÿ</h3><p>JVM æ–¹æ³•åŒº(Method Area)æ˜¯ JVM è¿è¡Œæ—¶æ•°æ®åŒºçš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºå­˜å‚¨ä¸ç±»å’Œæ–¹æ³•ç›¸å…³çš„å…ƒæ•°æ®ã€‚å®ƒæ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸï¼ŒåŒ…å«äº† JVM åŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰ã€‚æ–¹æ³•åŒºçš„å†…å®¹åœ¨JVM å¯åŠ¨æ—¶åˆ›å»ºï¼Œå¹¶åœ¨ JVM è¿è¡ŒæœŸé—´åŠ¨æ€æ‰©å±•æˆ–æ”¶ç¼©ã€‚</p><p><strong>æ–¹æ³•åŒºçš„ä¸»è¦å†…å®¹ï¼š</strong></p><ol><li>**ç±»ä¿¡æ¯:**åŒ…æ‹¬ç±»åã€çˆ¶ç±»åã€è®¿é—®ä¿®é¥°ç¬¦ã€æ¥å£åˆ—è¡¨ç­‰çš„å…ƒæ•°æ®ã€‚</li><li>**è¿è¡Œæ—¶å¸¸é‡æ± :**å­˜å‚¨ç¼–è¯‘æœŸç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ï¼Œè¿™äº›å¼•ç”¨åœ¨ç±»åŠ è½½åè¢«è§£æä¸ºç›´æ¥å¼•ç”¨ã€‚</li><li>**é™æ€å˜é‡:**ç±»çš„é™æ€å­—æ®µï¼Œå­˜å‚¨ç±»çº§åˆ«çš„å˜é‡ã€‚</li><li>**å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç :**å³æ—¶ç¼–è¯‘å™¨(JIT)å°†çƒ­ç‚¹ä»£ç ç¼–è¯‘ä¸ºæœ¬åœ°æœºå™¨ç ï¼Œå­˜å‚¨åœ¨æ–¹æ³•åŒºä¸­ã€‚</li><li>**å­—æ®µå’Œæ–¹æ³•ä¿¡æ¯:**åŒ…æ‹¬å­—æ®µæè¿°ã€æ–¹æ³•æè¿°ã€æ–¹æ³•å­—èŠ‚ç ã€æ–¹æ³•çš„è®¿é—®ä¿®é¥°ç¬¦ç­‰ã€‚</li></ol><p><strong>æ–¹æ³•åŒºåœ¨ä¸åŒ JVM å®ç°ä¸­çš„å·®å¼‚ï¼š</strong></p><p>åœ¨ä¸åŒçš„ JVM å®ç°ä¸­ï¼Œæ–¹æ³•åŒºçš„å…·ä½“å®ç°å’Œç®¡ç†æ–¹å¼å¯èƒ½æœ‰æ‰€ä¸åŒã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„ JVM å®ç°æ–¹å¼:</p><ul><li>HotSpot JVM(Java7åŠä¹‹å‰):æ–¹æ³•åŒºå®ç°ä¸º<strong>æ°¸ä¹…ä»£</strong>(Permanent Generationï¼Œ<strong>PermGen</strong>)ã€‚æ°¸ä¹…ä»£çš„å†…å­˜ç©ºé—´å›ºå®šï¼Œå®¹æ˜“**å¯¼è‡´å†…å­˜æº¢å‡º(OutOfMemoryError)**ã€‚</li><li>HotSpot JVM (Java8åŠä¹‹å):æ–¹æ³•åŒºå®ç°ä¸º<strong>å…ƒç©ºé—´</strong>(Metaspace)ã€‚å…ƒç©ºé—´ä½¿ç”¨<strong>æœ¬åœ°å†…å­˜(Native Memory)<strong>ï¼Œé»˜è®¤æƒ…å†µä¸‹å¯ä»¥æ ¹æ®éœ€è¦åŠ¨æ€æ‰©å±•ï¼Œ</strong>å‡å°‘äº†å†…å­˜æº¢å‡ºçš„é£é™©</strong>ã€‚</li></ul><p><strong>æ–¹æ³•åŒºçš„å†…å­˜ç®¡ç†ï¼š</strong></p><p>æ–¹æ³•åŒºçš„å†…å­˜ç®¡ç†ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ–¹é¢:</p><ol><li><strong>ç±»åŠ è½½:</strong> å½“ä¸€ä¸ªç±»è¢«åŠ è½½æ—¶ï¼Œå…¶ç›¸å…³ä¿¡æ¯ä¼šè¢«å­˜å‚¨åœ¨<strong>æ–¹æ³•åŒºä¸­ã€‚</strong></li><li><strong>ç±»å¸è½½</strong>ï¼šå½“ä¸€ä¸ªç±»<strong>ä¸å†è¢«ä½¿ç”¨ä¸”æ²¡æœ‰ä»»ä½•å¼•ç”¨æ—¶</strong>ï¼Œ<strong>åƒåœ¾æ”¶é›†å™¨</strong>å¯ä»¥å›æ”¶æ–¹æ³•åŒºä¸­çš„ç±»å…ƒæ•°æ®ã€‚</li><li><strong>åƒåœ¾æ”¶é›†:</strong> æ–¹æ³•åŒºçš„åƒåœ¾æ”¶é›†ä¸»è¦é’ˆå¯¹åºŸå¼ƒçš„<strong>ç±»å…ƒæ•°æ®</strong>å’Œå¸¸é‡æ± ä¸­çš„<strong>æ— ç”¨å¸¸é‡</strong>ã€‚ç›¸æ¯”å †å†…å­˜çš„åƒåœ¾æ”¶é›†ï¼Œ<strong>æ–¹æ³•åŒºçš„åƒåœ¾æ”¶é›†é¢‘ç‡è¾ƒä½</strong>ã€‚</li></ol><p><strong>æ–¹æ³•åŒºç›¸å…³çš„å¼‚å¸¸</strong>ï¼š</p><p>ç”±äºæ–¹æ³•åŒºå­˜å‚¨äº†å¤§é‡çš„ç±»å…ƒæ•°æ®å’Œå¸¸é‡ï¼Œå¯èƒ½ä¼šå‡ºç°ä»¥ä¸‹å¼‚å¸¸:</p><ul><li>OutOfMemoryError: PermGen space: åœ¨Java7åŠä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œæ°¸ä¹…ä»£ç©ºé—´ä¸è¶³æ—¶ä¼šæŠ›å‡ºæ­¤å¼‚å¸¸ã€‚</li><li>OutOfMemoryError: Metaspace:åœ¨ Java8 åŠä¹‹åçš„ç‰ˆæœ¬ä¸­ï¼Œå…ƒç©ºé—´å†…å­˜ä¸è¶³æ—¶ä¼šæŠ›å‡ºæ­¤å¼‚å¸¸ã€‚</li></ul><p><strong>æ€»ç»“ï¼š</strong></p><ul><li>æ–¹æ³•åŒºæ˜¯ JVM è¿è¡Œæ—¶æ•°æ®åŒºçš„ä¸€éƒ¨åˆ†ï¼Œç”¨äº<strong>å­˜å‚¨ç±»å’Œæ–¹æ³•çš„å…ƒæ•°æ®</strong>ã€‚</li><li>æ–¹æ³•åŒºå­˜å‚¨ç±»ä¿¡æ¯ã€è¿è¡Œæ—¶å¸¸é‡æ± ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ä»¥åŠå­—æ®µå’Œæ–¹æ³•ä¿¡æ¯ã€‚</li><li>åœ¨ä¸åŒçš„ JVM å®ç°ä¸­ï¼Œæ–¹æ³•åŒºçš„ç®¡ç†æ–¹å¼å¯èƒ½ä¸åŒï¼Œä¾‹å¦‚ HotSpot JVM åœ¨ Java8 ä¹‹å‰ä½¿ç”¨æ°¸ä¹…ä»£(PermGen)ï¼Œåœ¨Java8ä¹‹åä½¿ç”¨å…ƒç©ºé—´(Metaspace)ã€‚</li><li>æ–¹æ³•åŒºçš„å†…å­˜ç®¡ç†åŒ…æ‹¬<strong>ç±»åŠ è½½ã€ç±»å¸è½½å’Œåƒåœ¾æ”¶é›†</strong>ã€‚</li><li>å¸¸è§çš„å¼‚å¸¸åŒ…æ‹¬<strong>OutOfMemoryError</strong>: PermGen spaceå’Œ<strong>OutOfMemoryError</strong>: Metaspace.</li></ul><h3 id="JavaåŒäº²å§”æ´¾æœºåˆ¶æ˜¯ä»€ä¹ˆ"><a href="#JavaåŒäº²å§”æ´¾æœºåˆ¶æ˜¯ä»€ä¹ˆ" class="headerlink" title="JavaåŒäº²å§”æ´¾æœºåˆ¶æ˜¯ä»€ä¹ˆ"></a>JavaåŒäº²å§”æ´¾æœºåˆ¶æ˜¯ä»€ä¹ˆ</h3><p>JVM çš„åŒäº²å§”æ´¾æœºåˆ¶(Parent Delegation Model)æ˜¯ä¸€ç§<strong>ç±»åŠ è½½æœºåˆ¶</strong>ï¼Œç”¨äº<strong>ç¡®ä¿ Java ç±»åŠ è½½è¿‡ç¨‹çš„å®‰å…¨æ€§å’Œä¸€è‡´æ€§</strong>ã€‚</p><p>å®ƒçš„ä¸»è¦æ€æƒ³æ˜¯:æ¯ä¸ªç±»åŠ è½½å™¨åœ¨åŠ è½½ç±»æ—¶ï¼Œé¦–å…ˆå°†<strong>è¯·æ±‚å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨</strong>ï¼Œ<strong>åªæœ‰å½“çˆ¶ç±»åŠ è½½å™¨æ— æ³•å®ŒæˆåŠ è½½æ—¶ï¼Œæ‰ç”±å½“å‰ç±»åŠ è½½å™¨å°è¯•åŠ è½½ç±»</strong>ã€‚</p><p><strong>åŒäº²å§”æ´¾æœºåˆ¶çš„å·¥ä½œæµç¨‹ï¼š</strong></p><ol><li><strong>å¯åŠ¨ç±»åŠ è½½å™¨</strong>(Bootstrap ClassLoader): è´Ÿè´£åŠ è½½Java æ ¸å¿ƒåº“(ä½äºJAVA HOME&#x2F;libç›®å½•ä¸‹çš„ç±»åº“ï¼Œå¦‚rt.jar)ã€‚</li><li><strong>æ‰©å±•ç±»åŠ è½½å™¨</strong>(Extension ClassLoader): è´Ÿè´£åŠ è½½Java æ‰©å±•åº“(ä½äºJAVA HOME&#x2F;ib&#x2F;extç›®å½•ä¸‹çš„ç±»åº“)ã€‚</li><li><strong>åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨</strong>(Application ClassLoader): è´Ÿè´£åŠ è½½åº”ç”¨ç¨‹åºç±»è·¯å¾„(classpath)ä¸Šçš„ç±»ã€‚</li></ol><p>å¯åŠ¨-&gt;æ‰©å±•-&gt;åº”ç”¨ç¨‹åºç±»</p><p><strong>åŠ è½½ç±»çš„å…·ä½“æ­¥éª¤å¦‚ä¸‹:</strong></p><ol><li>å½“å‰ç±»åŠ è½½å™¨æ”¶åˆ°ç±»åŠ è½½è¯·æ±‚:å½“ä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°åŠ è½½ç±»çš„è¯·æ±‚æ—¶ï¼Œå®ƒä¸ä¼šç«‹å³å°è¯•åŠ è½½è¯¥ç±»ã€‚</li><li>å°†è¯·æ±‚å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨:å½“å‰ç±»åŠ è½½å™¨é¦–å…ˆå°†åŠ è½½è¯·æ±‚å§”æ´¾ç»™çˆ¶ç±»åŠ è½½å™¨ã€‚</li><li>çˆ¶ç±»åŠ è½½å™¨å¤„ç†è¯·æ±‚:<ul><li>å¦‚æœçˆ¶ç±»åŠ è½½å™¨å­˜åœ¨ï¼Œåˆ™çˆ¶ç±»åŠ è½½å™¨ä¼šç»§ç»­å°†è¯·æ±‚å‘ä¸Šå§”æ´¾ï¼Œç›´åˆ°åˆ°è¾¾å¯åŠ¨ç±»åŠ è½½å™¨ã€‚</li><li>å¯åŠ¨ç±»åŠ è½½å™¨å°è¯•åŠ è½½ç±»ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™è¿”å›ç±»çš„å¼•ç”¨ã€‚</li></ul></li><li>çˆ¶ç±»åŠ è½½å™¨æ— æ³•åŠ è½½ç±»:å¦‚æœå¯åŠ¨ç±»åŠ è½½å™¨æ— æ³•åŠ è½½è¯¥ç±»ï¼ŒåŠ è½½å¤±è´¥è¿”å›åˆ°å­ç±»åŠ è½½å™¨ã€‚</li><li>å½“å‰ç±»åŠ è½½å™¨å°è¯•åŠ è½½ç±»:å¦‚æœçˆ¶ç±»åŠ è½½å™¨æ— æ³•åŠ è½½è¯¥ç±»ï¼Œåˆ™ç”±å½“å‰ç±»åŠ è½½å™¨å°è¯•åŠ è½½ã€‚</li></ol><p>é€šè¿‡è¿™ç§æœºåˆ¶ï¼Œå¯ä»¥ç¡®ä¿æ ¸å¿ƒç±»åº“ä¸ä¼šè¢«ç¯¡æ”¹ï¼Œé¿å…äº†ç±»çš„é‡å¤åŠ è½½å’Œç±»çš„å†²çªé—®é¢˜ã€‚</p><p>ï¼ˆå§”æ´¾æ˜¯å‘ä¸Šå§”æ´¾çš„ï¼Œæ‰§è¡Œæ˜¯ä»ä¸Šåˆ°ä¸‹çš„ã€‚ï¼‰</p><p><strong>åŒäº²å§”æ´¾æœºåˆ¶çš„ä¼˜ç‚¹ï¼š</strong></p><ol><li><p>å®‰å…¨æ€§:é€šè¿‡å°†ç±»åŠ è½½è¯·æ±‚é€çº§å‘ä¸Šå§”æ´¾ï¼Œå¯ä»¥é¿å…æ ¸å¿ƒç±»åº“è¢«ç¯¡æ”¹æˆ–æ›¿æ¢ï¼Œç¡®ä¿ç³»ç»Ÿå®‰å…¨ã€‚</p></li><li><p>é¿å…ç±»çš„é‡å¤åŠ è½½:ç¡®ä¿æ¯ä¸ªç±»åªè¢«åŠ è½½ä¸€æ¬¡ï¼Œé¿å…ç±»çš„é‡å¤åŠ è½½å’Œç±»çš„å†²çªé—®é¢˜ã€‚</p></li><li><p>æé«˜åŠ è½½æ•ˆç‡:é€šè¿‡å§”æ´¾æœºåˆ¶ï¼Œå¯ä»¥åˆ©ç”¨å·²ç»åŠ è½½çš„ç±»ï¼Œæé«˜ç±»åŠ è½½çš„æ•ˆç‡ã€‚</p></li></ol><p><strong>åŒäº²å§”æ´¾æœºåˆ¶çš„ä¾‹å¤–ï¼ˆè‡ªå®šä¹‰ç±»åŠ è½½å™¨å’Œä¸€äº›æ¡†æ¶ä¸­ï¼‰ï¼š</strong></p><p>å°½ç®¡åŒäº²å§”æ´¾æœºåˆ¶æ˜¯ Java ç±»åŠ è½½çš„æ ‡å‡†æœºåˆ¶ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™ä¸€æœºåˆ¶ä¼šè¢«æ‰“ç ´ã€‚ä¾‹å¦‚:</p><ul><li>è‡ªå®šä¹‰ç±»åŠ è½½å™¨:æŸäº›è‡ªå®šä¹‰ç±»åŠ è½½å™¨å¯èƒ½ä¼šè¦†ç›–é»˜è®¤çš„åŒäº²å§”æ´¾æœºåˆ¶ï¼Œç›´æ¥åŠ è½½ç±»ã€‚</li><li>OSGi æ¡†æ¶:OSGi æ¡†æ¶ä¸­ï¼Œç±»åŠ è½½æœºåˆ¶æ›´åŠ å¤æ‚ï¼Œå¯èƒ½ä¼šæ‰“ç ´åŒäº²å§”æ´¾æœºåˆ¶ã€‚</li><li>SPl(Service Provider Interface):åœ¨æŸäº›æœåŠ¡æä¾›è€…æ¥å£çš„å®ç°ä¸­ï¼Œå¯èƒ½éœ€è¦æ‰“ç ´åŒäº²å§”æ´¾æœºåˆ¶æ¥åŠ è½½æœåŠ¡å®ç°ç±»ã€‚</li></ul><p><strong>æ€»ç»“ï¼š</strong></p><ul><li>åŒäº²å§”æ´¾æœºåˆ¶æ˜¯ Java ç±»åŠ è½½è¿‡ç¨‹ä¸­çš„ä¸€ä¸ªé‡è¦æœºåˆ¶ï¼Œé€šè¿‡å°†ç±»åŠ è½½è¯·æ±‚é€çº§å‘ä¸Šå§”æ´¾ï¼Œç¡®ä¿äº†ç±»åŠ è½½çš„å®‰å…¨æ€§å’Œä¸€è‡´æ€§ã€‚</li></ul><h3 id="JavaåŒäº²å§”æ´¾æœºåˆ¶çš„ä½œç”¨"><a href="#JavaåŒäº²å§”æ´¾æœºåˆ¶çš„ä½œç”¨" class="headerlink" title="JavaåŒäº²å§”æ´¾æœºåˆ¶çš„ä½œç”¨"></a>JavaåŒäº²å§”æ´¾æœºåˆ¶çš„ä½œç”¨</h3><ol><li><p>ä¿è¯ Java æ ¸å¿ƒåº“çš„å®‰å…¨æ€§<br>é€šè¿‡åŒäº²å§”æ´¾æœºåˆ¶ï¼ŒJava æ ¸å¿ƒåº“(å¦‚java.lang.Objectç­‰)ç”±å¯åŠ¨ç±»åŠ è½½å™¨(Bootstrap ClassLoader)åŠ è½½ã€‚ç”±äºå¯åŠ¨ç±»åŠ è½½å™¨æ˜¯åœ¨ JVM å¯åŠ¨æ—¶ç”±æœ¬åœ°ä»£ç å®ç°çš„ï¼Œå¹¶ä¸”å®ƒåŠ è½½çš„ç±»è·¯å¾„æ˜¯å›ºå®šçš„ç³»ç»Ÿæ ¸å¿ƒåº“è·¯å¾„ï¼Œå› æ­¤å¯ä»¥ç¡®å‘†è¿™äº›æ ¸å¿ƒç±»ä¸ä¼šè¢«ç¯¡æ”¹æˆ–æ›¿æ¢ã€‚è¿™æ ·ï¼Œç³»ç»Ÿçš„å®‰å…¨æ€§å’Œç¨³å®šæ€§å¾—åˆ°äº†ä¿éšœã€‚</p></li><li><p>é¿å…ç±»çš„é‡å¤åŠ è½½</p><p>åŒäº²å§”æ´¾æœºåˆ¶ç¡®ä¿äº†æ¯ä¸ªç±»åªä¼šè¢«åŠ è½½ä¸€æ¬¡ã€‚å¦‚æœä¸€ä¸ªç±»å·²ç»è¢«çˆ¶ç±»åŠ è½½å™¨åŠ è½½è¿‡ï¼Œé‚£ä¹ˆå­ç±»åŠ è½½å™¨å°±ä¸ä¼šå†é‡å¤åŠ è½½è¿™ä¸ªç±»ã€‚è¿™æ ·å¯ä»¥é¿å…ç±»çš„é‡å¤åŠ è½½ï¼Œæé«˜ç±»åŠ è½½çš„æ•ˆç‡ï¼Œå¹¶å‡å°‘å†…å­˜æ¶ˆè€—ã€‚</p></li><li><p>ä¿è¯ç±»åŠ è½½çš„ä¸€è‡´æ€§</p><p>é€šè¿‡åŒäº²å§”æ´¾æœºåˆ¶ï¼Œå¯ä»¥ç¡®ä¿åŒä¸€ä¸ªç±»åœ¨æ•´ä¸ª JVM ä¸­åªæœ‰ä¸€ä¸ªå®šä¹‰ã€‚è¿™æ ·å¯ä»¥é¿å…ç±»çš„å†²çªå’Œä¸ä¸€è‡´é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåº”ç”¨ç¨‹åºå’Œç¬¬ä¸‰æ–¹åº“ä¸­éƒ½å®šä¹‰äº†ä¸€ä¸ªç›¸åŒçš„ç±»åï¼Œé€šè¿‡åŒäº²å§”æ´¾æœºåˆ¶å¯ä»¥ç¡®ä¿æœ€ç»ˆåŠ è½½çš„æ˜¯ä½äºæ›´é«˜å±‚æ¬¡çš„ç±»åŠ è½½å™¨ä¸­çš„ç±»ï¼Œä»è€Œé¿å…å†²çªã€‚</p></li><li><p>æé«˜ç±»åŠ è½½çš„æ•ˆç‡</p><p>åŒäº²å§”æ´¾æœºåˆ¶é€šè¿‡å°†ç±»åŠ è½½è¯·æ±‚é€çº§å‘ä¸Šå§”æ´¾ï¼Œå¯ä»¥åˆ©ç”¨å·²ç»åŠ è½½çš„ç±»ï¼Œæé«˜ç±»åŠ è½½çš„æ•ˆç‡ã€‚çˆ¶ç±»åŠ è½½å™¨åœ¨åŠ è½½ç±»æ—¶ï¼Œå¦‚æœè¯¥ç±»<strong>å·²ç»è¢«åŠ è½½è¿‡ï¼Œé‚£ä¹ˆç›´æ¥è¿”å›è¯¥ç±»çš„å¼•ç”¨</strong>ï¼Œä»è€Œå‡å°‘äº†é‡å¤åŠ è½½çš„å¼€é”€ã€‚</p></li><li><p>æ”¯æŒåŠ¨æ€æ‰©å±•</p><p>åŒäº²å§”æ´¾æœºåˆ¶å…è®¸åœ¨ä¸åŒçš„ç±»åŠ è½½å™¨ä¸­åŠ è½½ä¸åŒçš„ç±»ï¼Œä»è€Œæ”¯æŒåŠ¨æ€æ‰©å±•ã€‚ä¾‹å¦‚ï¼Œåº”ç”¨ç¨‹åºç±»åŠ è½½å™¨(Application ClassLoader)å¯ä»¥åŠ è½½åº”ç”¨ç¨‹åºç‰¹å®šçš„ç±»ï¼Œè€Œæ‰©å±•ç±»åŠ è½½å™¨(Extension ClassLoader)å¯ä»¥åŠ è½½æ‰©å±•åº“ä¸­çš„ç±»ï¼Œè¿™æ ·å¯ä»¥æ–¹ä¾¿åœ°è¿›è¡Œ<strong>åŠ¨æ€æ‰©å±•</strong>å’Œæ¨¡å—åŒ–å¼€å‘ã€‚</p></li></ol><p><strong>æ€»ç»“ï¼š</strong></p><p>å®‰å…¨æ€§-&gt;é¿å…é‡å¤åŠ è½½-&gt;é¿å…å†²çªä¿æŒä¸€è‡´æ€§-&gt;æé«˜åŠ è½½æ•ˆç‡-&gt;æ”¯æŒåŠ¨æ€æ‰©å±•ã€‚</p><h2 id="Spring-MVC"><a href="#Spring-MVC" class="headerlink" title="Spring MVC"></a>Spring MVC</h2><h3 id="ä»€ä¹ˆæ˜¯Spring-MVC"><a href="#ä»€ä¹ˆæ˜¯Spring-MVC" class="headerlink" title="ä»€ä¹ˆæ˜¯Spring MVC"></a>ä»€ä¹ˆæ˜¯Spring MVC</h3><p>Spring MVCæ˜¯ Spring æ¡†æ¶ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œç”¨äºæ„å»ºåŸºäº Web çš„åº”ç”¨ç¨‹åºã€‚å®ƒéµå¾ª Model-View-Controler(MVC)è®¾è®¡æ¨¡å¼ï¼Œå°†ä¸šåŠ¡é€»è¾‘ã€ç”¨æˆ·ç•Œé¢å’Œæ•°æ®åˆ†ç¦»ï¼Œä»¥ä¿ƒè¿›ä»£ç çš„å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§ã€‚</p><ol><li>æ¨¡å‹(Model)<br>æ¨¡å‹ä»£è¡¨åº”ç”¨ç¨‹åºçš„æ•°æ®å’Œä¸šåŠ¡é€»è¾‘ã€‚å®ƒé€šå¸¸åŒ…å«æ•°æ®å¯¹è±¡(å¦‚POJO)å’ŒæœåŠ¡å±‚(å¦‚ Spring æœåŠ¡)æ¥å¤„ç†ä¸šåŠ¡é€»è¾‘ã€‚æ¨¡å‹è´Ÿè´£ä»æ•°æ®åº“æˆ–å…¶ä»–æ•°æ®æºè·å–æ•°æ®ï¼Œå¹¶å°†æ•°æ®ä¼ é€’ç»™è§†å›¾ä»¥æ˜¾ç¤ºç»™ç”¨æˆ·ã€‚</li><li>è§†å›¾(View)<br>è§†å›¾è´Ÿè´£å±•ç¤ºæ•°æ®ï¼Œé€šå¸¸æ˜¯ HTML é¡µé¢æˆ–å…¶ä»–ç±»å‹çš„ç”¨æˆ·ç•Œé¢ã€‚Spring MVCæ”¯æŒå¤šç§è§†å›¾æŠ€æœ¯ï¼ŒåŒ…æ‹¬ JSPã€Thymeleafã€FreeMarker ç­‰ã€‚è§†å›¾ä»æ¨¡å‹è·å–æ•°æ®å¹¶å°†å…¶å‘ˆç°ç»™ç”¨æˆ·ã€‚</li><li>æ§åˆ¶å™¨(Controller)<br>æ§åˆ¶å™¨å¤„ç†ç”¨æˆ·è¯·æ±‚å¹¶å†³å®šå°†æ•°æ®ä¼ é€’ç»™å“ªä¸ªè§†å›¾ã€‚å®ƒæ¥æ”¶ç”¨æˆ·è¾“å…¥ï¼Œè°ƒç”¨æ¨¡å‹è¿›è¡Œå¤„ç†ï¼Œå¹¶é€‰æ‹©åˆé€‚çš„è§†å›¾æ¥æ˜¾ç¤ºç»“æœã€‚æ§åˆ¶å™¨é€šå¸¸ä½¿ç”¨@Controller æ³¨è§£æ¥æ ‡è¯†ï¼Œå¹¶ä½¿ç”¨ @RequestMapping æ³¨è§£æ¥æ˜ å°„ URL è¯·æ±‚ã€‚</li></ol><p><strong>Spring MVC çš„å·¥ä½œæµç¨‹</strong></p><ol><li><strong>ç”¨æˆ·è¯·æ±‚:</strong> ç”¨æˆ·é€šè¿‡æµè§ˆå™¨å‘é€ HTTP è¯·æ±‚åˆ°æœåŠ¡å™¨ã€‚</li><li><strong>å‰ç«¯æ§åˆ¶å™¨(DispatcherServlet):</strong> Spring MVCçš„å‰ç«¯æ§åˆ¶å™¨ DispatcherServlet æ‹¦æˆªæ‰€æœ‰è¯·æ±‚å¹¶è¿›è¡Œåˆ†å‘ã€‚</li><li><strong>å¤„ç†å™¨æ˜ å°„(Handler Mapping):</strong> æ ¹æ®è¯·æ±‚ URLï¼ŒDispatcherServlet æŸ¥æ‰¾ç›¸åº”çš„æ§åˆ¶å™¨ã€‚</li><li><strong>æ§åˆ¶å™¨å¤„ç†:</strong> æ§åˆ¶å™¨å¤„ç†è¯·æ±‚ï¼Œè°ƒç”¨æœåŠ¡å±‚æˆ–æ•°æ®è®¿é—®å±‚ä»¥è·å–æ•°æ®ï¼Œå¹¶å°†æ•°æ®å°è£…åˆ°å‹ä¸­ã€‚</li><li><strong>è§†å›¾è§£æå™¨(View Resolver):</strong> æ§åˆ¶å™¨è¿”å›è§†å›¾åç§°ï¼Œ DispatcherServlet ä½¿ç”¨è§†å›¾è§£æå™¨å°†è§†å›¾åç§°è§£æä¸ºå®é™…çš„è§†å›¾å¯¹è±¡ã€‚</li><li><strong>è§†å›¾æ¸²æŸ“:</strong> è§†å›¾å¯¹è±¡è´Ÿè´£å°†æ¨¡å‹æ•°æ®æ¸²æŸ“ä¸ºç”¨æˆ·ç•Œé¢ï¼Œé€šå¸¸æ˜¯ HTMLé¡µé¢ã€‚</li><li><strong>å“åº”è¿”å›:</strong> æ¸²æŸ“åçš„è§†å›¾è¿”å›ç»™ DispatcherServletï¼ŒDispatcherServlet å°†æœ€ç»ˆçš„å“åº”å‘é€å›ç”¨æˆ·æµè§ˆå™¨ã€‚</li></ol><p><strong>æ ¸å¿ƒç»„ä»¶</strong></p><ol><li>**DispatcherServlet:**å‰ç«¯æ§åˆ¶å™¨ï¼Œè´Ÿè´£æ¥æ”¶å¹¶åˆ†å‘è¯·æ±‚</li><li>**Controller:**å¤„ç†ç”¨æˆ·è¯·æ±‚ï¼ŒåŒ…å«ä¸šåŠ¡é€»è¾‘ã€‚</li><li><strong>ModelAndView</strong>: åŒ…å«æ¨¡å‹æ•°æ®å’Œè§†å›¾åç§°çš„å¯¹è±¡ã€‚</li><li>**View Resolver:**å°†è§†å›¾åç§°è§£æä¸ºå®é™…çš„è§†å›¾å¯¹è±¡ã€‚</li><li>**Handler Mapping:**æ ¹æ®è¯·æ±‚ URL æŸ¥æ‰¾ç›¸åº”çš„æ§åˆ¶å™¨ã€‚</li></ol><h3 id="SpringMVCçš„åŸç†åŠæ‰§è¡Œæµç¨‹"><a href="#SpringMVCçš„åŸç†åŠæ‰§è¡Œæµç¨‹" class="headerlink" title="SpringMVCçš„åŸç†åŠæ‰§è¡Œæµç¨‹"></a>SpringMVCçš„åŸç†åŠæ‰§è¡Œæµç¨‹</h3><p><strong>ç»„ä»¶</strong><br>Spring MVCæ˜¯ä¸€ä¸ªåŸºäºJavaçš„å®ç°äº†MVCè®¾è®¡æ¨¡å¼çš„è¯·æ±‚é©±åŠ¨ç±»å‹çš„è½»é‡çº§Webæ¡†æ¶ï¼Œå®ƒå¤§é‡ä½¿ç”¨äº†Springæ¡†æ¶ä¸­æä¾›çš„è®¾è®¡æ¨¡å¼ã€‚Spring MVCæ¡†æ¶çš„æ ¸å¿ƒç»„ä»¶åŒ…æ‹¬:</p><ol><li>DispatcherServet:å‰ç«¯æ§åˆ¶å™¨ï¼Œè´Ÿè´£æ¥æ”¶è¯·æ±‚å¹¶æ ¹æ®æ˜ å°„å…³ç³»è°ƒç”¨ç›¸åº”çš„æ§åˆ¶å™¨</li><li>HandlerMapping:è´Ÿè´£æ ¹æ®è¯·æ±‚çš„URLåˆ°HandlerMappingä¸­æ‰¾åˆ°æ˜ å°„çš„å¤„ç†å™¨(Controller)ã€‚</li><li>HandlerAdapter:è´Ÿè´£æ ¹æ®å¤„ç†å™¨ï¼Œç”Ÿæˆå¤„ç†å™¨é€‚é…å™¨ï¼Œé€šè¿‡é€‚é…å™¨è°ƒç”¨å®é™…çš„å¤„ç†å™¨ã€‚</li><li>Controller:å¤„ç†å™¨ï¼Œæ‰§è¡Œç›¸åº”çš„ä¸šåŠ¡é€»è¾‘æ“ä½œï¼Œå¹¶è¿”å›ModelAndViewå¯¹è±¡ã€‚</li><li>ModelAndView:åŒ…å«äº†è§†å›¾é€»è¾‘åå’Œæ¨¡å‹æ•°æ®çš„å¯¹è±¡ï¼Œæ˜¯è¿æ¥æ§åˆ¶å™¨å’Œè§†å›¾çš„æ¡¥æ¢ã€‚</li><li>ViewResolver:è´Ÿè´£è§£æè§†å›¾ååˆ°å…·ä½“è§†å›¾å®ç°ç±»çš„æ˜ å°„ï¼Œæ ¹æ®è§†å›¾åç§°æ‰¾åˆ°å¯¹åº”çš„è§†å›¾å®ç°ç±»ã€‚</li><li>View:è§†å›¾ï¼Œè´Ÿè´£æ¸²æŸ“æ•°æ®å¹¶å±•ç¤ºç»™ç”¨æˆ·ã€‚</li></ol><p><strong>æ‰§è¡Œæµç¨‹</strong><br>Spring MVC çš„æ‰§è¡Œæµç¨‹å¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤</p><ol><li><strong>å‘é€è¯·æ±‚åˆ°DispatcherServlet:</strong> ç”¨æˆ·å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œè¯·æ±‚è¢«DispatcherServletæ•è·ã€‚</li><li><strong>æŸ¥æ‰¾Handler:</strong> DispatcherServletæ ¹æ®è¯·æ±‚URLåˆ°HandlerMappingä¸­æŸ¥æ‰¾æ˜ å°„çš„å¤„ç†å™¨(Controller)ã€‚</li><li><strong>è°ƒç”¨HandlerAdapter:</strong> DispatcherServletæ ¹æ®å¤„ç†å™¨ï¼Œåˆ°HandlerAdapterä¸­æ‰¾åˆ°å¯¹åº”çš„å¤„ç†å™¨é€‚é…å™¨ã€‚</li><li><strong>æ‰§è¡ŒController:</strong> å¤„ç†å™¨é€‚é…å™¨è°ƒç”¨å®é™…çš„å¤„ç†å™¨(Controler)æ‰§è¡Œä¸šåŠ¡é€»è¾‘æ“ä½œï¼Œå¹¶è¿”å›ModelAndViewå¯¹è±¡ã€‚</li><li><strong>å¤„ç†ModelAndView:</strong> DispatcherServletæ ¹æ®ModelAndViewä¸­çš„è§†å›¾åç§°ï¼Œåˆ°ViewResolverä¸­æ‰¾åˆ°å¯¹åº”çš„è§†å›¾å®ç°ç±»ã€‚</li><li><strong>æ¸²æŸ“è§†å›¾:</strong> è§†å›¾å®ç°ç±»æ ¹æ®ModelAndViewä¸­çš„æ•°æ®å’Œè§†å›¾æ¨¡æ¿æ¸²æŸ“è§†å›¾ã€‚</li><li><strong>è¿”å›å“åº”åˆ°å®¢æˆ·ç«¯:</strong> DispatcherServetå°†æ¸²æŸ“åçš„è§†å›¾è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li></ol><h3 id="ä»€ä¹ˆæ˜¯DispatcherServlet"><a href="#ä»€ä¹ˆæ˜¯DispatcherServlet" class="headerlink" title="ä»€ä¹ˆæ˜¯DispatcherServlet"></a>ä»€ä¹ˆæ˜¯DispatcherServlet</h3><p>DispatcherServlet å……å½“å‰ç«¯æ§åˆ¶å™¨(Front Controller)ï¼Œè´Ÿè´£æ¥æ”¶æ‰€æœ‰è¿›å…¥çš„ HTTP è¯·æ±‚å¹¶å°†å®ƒä»¬åˆ†æ´¾ç»™é€‚å½“çš„å¤„ç†å™¨è¿›è¡Œå¤„ç†ã€‚ DispatcherServlet æ˜¯å®ç° MVC æ¨¡å¼çš„å…³é”®éƒ¨åˆ†ï¼Œè´Ÿè´£åè°ƒæ•´ä¸ªè¯·æ±‚å¤„ç†æµç¨‹ã€‚</p><p><strong>ä¸»è¦èŒè´£</strong></p><ol><li>**è¯·æ±‚æ¥æ”¶å’Œåˆ†æ´¾:**æ‹¦æˆªæ‰€æœ‰è¿›å…¥çš„ HTTP è¯·æ±‚å¹¶å°†å®ƒä»¬åˆ†æ´¾ç»™é€‚å½“çš„æ§åˆ¶å™¨(Controller)</li><li>**å¤„ç†å™¨æ˜ å°„:**æ ¹æ®è¯·æ±‚ URLï¼ŒæŸ¥æ‰¾ç›¸åº”çš„å¤„ç†å™¨(é€šå¸¸æ˜¯æ§åˆ¶å™¨æ–¹æ³•)ã€‚</li><li>**è§†å›¾è§£æ:**å°†æ§åˆ¶å™¨è¿”å›çš„è§†å›¾åç§°è§£æä¸ºå®é™…çš„è§†å›¾å¯¹è±¡ã€‚</li><li>**è¯·æ±‚å¤„ç†:**è°ƒç”¨å¤„ç†å™¨è¿›è¡Œè¯·æ±‚å¤„ç†ï¼Œå¹¶å°†å¤„ç†ç»“æœå°è£…åˆ°æ¨¡å‹ä¸­ã€‚</li><li>**è§†å›¾æ¸²æŸ“:**å°†æ¨¡å‹æ•°æ®ä¼ é€’ç»™è§†å›¾å¯¹è±¡è¿›è¡Œæ¸²æŸ“ï¼Œå¹¶ç”Ÿæˆæœ€ç»ˆçš„å“åº”ã€‚</li></ol><p><strong>å·¥ä½œæµç¨‹</strong></p><p>ä»¥ä¸‹æ˜¯ DispatcherServlet çš„è¯¦ç»†å·¥ä½œæµç¨‹:</p><ol><li><strong>åˆå§‹åŒ–:</strong><ul><li>åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œ DispatcherServletè¢«åˆå§‹åŒ–ã€‚å®ƒåŠ è½½ Spring åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ï¼Œé…ç½®å¤„ç†å™¨æ˜ å°„ã€è§†å›¾è§£æå™¨ç­‰ç»„ä»¶ã€‚</li></ul></li><li><strong>æ¥æ”¶è¯·æ±‚:</strong><ul><li>ç”¨æˆ·é€šè¿‡æµè§ˆå™¨å‘é€ HTTP è¯·æ±‚åˆ°æœåŠ¡å™¨ã€‚</li><li>DispatcherServlet æ‹¦æˆªæ‰€æœ‰ç¬¦åˆé…ç½®çš„ URL æ¨¡å¼çš„è¯·æ±‚ã€‚</li></ul></li><li><strong>å¤„ç†å™¨æ˜ å°„:</strong><ul><li>DispatcherServlet ä½¿ç”¨å¤„ç†å™¨æ˜ å°„å™¨(Handler Mapping)æ ¹æ®è¯·æ±‚ URL æŸ¥æ‰¾ç›¸åº”çš„å¤„ç†å™¨(Controller)ã€‚</li></ul></li><li><strong>è°ƒç”¨å¤„ç†å™¨:</strong><ul><li>æ‰¾åˆ°å¤„ç†å™¨åï¼Œ Dispatcherservlet è°ƒç”¨å¤„ç†å™¨çš„æ–¹æ³•è¿›è¡Œè¯·æ±‚å¤„ç†ã€‚</li><li>å¤„ç†å™¨æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œé€šå¸¸ä¼šè°ƒç”¨æœåŠ¡å±‚æˆ–æ•°æ®è®¿é—®å±‚è·å–æ•°æ®ï¼Œå¹¶å°†æ•°æ®å°è£…åˆ°å‹ä¸­ã€‚</li></ul></li><li><strong>è§†å›¾è§£æï¼š</strong><ul><li>å¤„ç†å™¨å¤„ç†å®Œè¯·æ±‚åï¼Œè¿”å›ä¸€ä¸ªåŒ…å«è§†å›¾åç§°å’Œæ¨¡å‹æ•°æ®çš„ModelAndview å¯¹è±¡ã€‚</li><li>DispatcherServlet ä½¿ç”¨è§†å›¾è§£æå™¨(View Resolver)å°†è§†å›¾åç§°è§£æä¸ºå®é™…çš„è§†å›¾å¯¹è±¡ã€‚</li></ul></li><li><strong>è§†å›¾æ¸²æŸ“:</strong><ul><li>è§†å›¾å¯¹è±¡è´Ÿè´£å°†æ¨¡å‹æ•°æ®æ¸²æŸ“ä¸ºç”¨æˆ·ç•Œé¢ï¼Œé€šå¸¸æ˜¯ HTML é¡µé¢ã€‚</li></ul></li><li><strong>å“åº”è¿”å›:</strong><ul><li>æ¸²æŸ“åçš„è§†å›¾è¿”å›ç»™ DispatcherServletï¼ŒDispatcherservlet å°†æœ€ç»ˆçš„å“åº”å‘é€å›ç”¨æˆ·æµè§ˆå™¨ã€‚</li></ul></li></ol><h3 id="ä»€ä¹ˆæ˜¯Handler-Mapping"><a href="#ä»€ä¹ˆæ˜¯Handler-Mapping" class="headerlink" title="ä»€ä¹ˆæ˜¯Handler Mapping"></a>ä»€ä¹ˆæ˜¯Handler Mapping</h3><p>Handler Mapping è´Ÿè´£å°† HTTP è¯·æ±‚æ˜ å°„åˆ°ç›¸åº”çš„å¤„ç†å™¨(é€šå¸¸æ˜¯æ§åˆ¶å™¨æ–¹æ³•)ã€‚å½“DispatcherServletæ¥æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œå®ƒä¼šä½¿ç”¨ Handler Mapping æ¥ç¡®å®šå“ªä¸ªå¤„ç†å™¨åº”è¯¥å¤„ç†è¿™ä¸ªè¯·æ±‚ã€‚</p><p><strong>ä¸»è¦èŒè´£</strong></p><ol><li>**è¯·æ±‚æ˜ å°„:**æ ¹æ®è¯·æ±‚çš„ URLã€HTTP æ–¹æ³•ã€è¯·æ±‚å‚æ•°ç­‰ä¿¡æ¯ï¼ŒæŸ¥æ‰¾å¹¶ç¡®å®šç›¸åº”çš„å¤„ç†å™¨ã€‚</li><li>**å¤„ç†å™¨è¿”å›:**è¿”å›ä¸€ä¸ªåŒ…å«å¤„ç†å™¨å¯¹è±¡å’Œå¤„ç†å™¨æ‹¦æˆªå™¨é“¾çš„ HandlerExecutionchain å¯¹è±¡ã€‚</li></ol><p><strong>å·¥ä½œæµç¨‹</strong></p><ol><li><strong>è¯·æ±‚åˆ°è¾¾Dispatcherservlet</strong>:å½“ä¸€ä¸ªHTTP è¯·æ±‚åˆ°è¾¾ DispatcherServlet æ—¶ï¼Œå®ƒä¼šé¦–å…ˆäº¤ç»™ Handler Mapping è¿›è¡Œå¤„ç†ã€‚</li><li>**æŸ¥æ‰¾å¤„ç†å™¨:**Handler Mappingæ ¹æ®è¯·æ±‚çš„ URLã€HTTP æ–¹æ³•ç­‰ä¿¡æ¯æŸ¥æ‰¾åŒ¹é…çš„å¤„ç†å™¨ã€‚</li><li><strong>è¿”å›å¤„ç†å™¨:</strong> Handler Mapping è¿”å›ä¸€ä¸ª <strong>HandlerExecutionchain</strong> å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«<strong>å¤„ç†å™¨</strong>(é€šå¸¸æ˜¯æ§åˆ¶å™¨æ–¹æ³•)å’Œ<strong>å¤„ç†å™¨æ‹¦æˆªå™¨é“¾</strong>ã€‚</li><li><strong>å¤„ç†è¯·æ±‚:</strong> DispatcherServlet ä½¿ç”¨æ‰¾åˆ°çš„å¤„ç†å™¨æ¥å¤„ç†è¯·æ±‚ï¼Œå¹¶ç”Ÿæˆå“åº”ã€‚</li></ol><p><strong>å¸¸è§çš„ Handler Mapping å®ç°</strong></p><ol><li><strong>BeanNameUrlHandlerMappingï¼š</strong><ul><li>é€šè¿‡ bean çš„åç§°æ¥æ˜ å°„å¤„ç†å™¨ã€‚</li><li>ä¾‹å¦‚ï¼Œbean åç§°ä¸º&#x2F;hello çš„å¤„ç†å™¨ä¼šå¤„ç† &#x2F;hello è¯·æ±‚ã€‚</li></ul></li><li><strong>SimpleUrlHandlerMappingï¼š</strong><ul><li>é€šè¿‡æ˜¾å¼é…ç½®çš„ URL è·¯å¾„æ¥æ˜ å°„å¤„ç†å™¨ã€‚</li><li>å¯ä»¥åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­æŒ‡å®š URL åˆ°å¤„ç†å™¨çš„æ˜ å°„å…³ç³»ã€‚</li></ul></li><li><strong>DefaultAnnotationHandlerMapping(è¿‡æ—¶):</strong><ul><li>é€šè¿‡æ³¨è§£(å¦‚ @RequestMapping )æ¥æ˜ å°„å¤„ç†å™¨ã€‚</li><li>åœ¨è¾ƒæ–°çš„ Spring ç‰ˆæœ¬ä¸­è¢« RequestMappingHandlerMapping å–ä»£ã€‚</li></ul></li><li><strong>RequestMappingHandlerMapping</strong><ul><li>è¿™æ˜¯æœ€å¸¸ç”¨çš„ Handler Mapping å®ç°ã€‚</li><li>é€šè¿‡æ³¨è§£(å¦‚ <strong>@RequestMappingã€@GetMappingã€@PostMapping</strong> ç­‰)æ¥æ˜ å°„å¤„ç†å™¨æ”¯æŒå¤æ‚çš„è¯·æ±‚æ˜ å°„è§„åˆ™ï¼ŒåŒ…æ‹¬è·¯å¾„å˜é‡ã€è¯·æ±‚å‚æ•°ã€è¯·æ±‚å¤´ç­‰ã€‚</li></ul></li></ol><p><strong>æ€»ç»“</strong><br>Handler Mapping è´Ÿè´£å°† HTTP è¯·æ±‚æ˜ å°„åˆ°ç›¸åº”çš„å¤„ç†å™¨ã€‚é€šè¿‡ä½¿ç”¨ä¸åŒçš„ Handler Mapping å®ç°ï¼Œå¼€å‘è€…å¯ä»¥çµæ´»åœ°é…ç½®è¯·æ±‚æ˜ å°„è§„åˆ™ï¼Œä»¥æ»¡è¶³å„ç§åº”ç”¨éœ€æ±‚ã€‚æœ€å¸¸ç”¨çš„ Handler Mapping å®ç°æ˜¯ RequestMappingHandlerMappingï¼Œå®ƒé€šè¿‡æ³¨è§£æä¾›äº†å¼ºå¤§çš„è¯·æ±‚æ˜ å°„åŠŸèƒ½ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯Handler-Adapter"><a href="#ä»€ä¹ˆæ˜¯Handler-Adapter" class="headerlink" title="ä»€ä¹ˆæ˜¯Handler Adapter"></a>ä»€ä¹ˆæ˜¯Handler Adapter</h3><p>Handler Adapter è´Ÿè´£å°†<strong>å¤„ç†å™¨(Handler)é€‚é…ä¸ºå…·ä½“çš„å¤„ç†æ–¹æ³•</strong>ã€‚ Handler Adapter çš„ä¸»è¦ä½œç”¨æ˜¯<strong>æ ¹æ®å¤„ç†å™¨çš„ç±»å‹å’Œå…·ä½“å®ç°ï¼Œæ‰§è¡Œç›¸åº”çš„å¤„ç†é€»è¾‘</strong>ã€‚Handler Adapteræ˜¯ DispatcherServlet å’Œå…·ä½“å¤„ç†å™¨ä¹‹é—´çš„æ¡¥æ¢ã€‚</p><p><strong>ä¸»è¦èŒè´£</strong></p><ol><li>å¤„ç†å™¨æ‰§è¡Œ:è°ƒç”¨å¤„ç†å™¨çš„æ–¹æ³•æ¥å¤„ç†è¯·æ±‚ã€‚</li><li>è¿”å›æ¨¡å‹å’Œè§†å›¾:å¤„ç†å®Œè¯·æ±‚åï¼Œè¿”å›ä¸€ä¸ªModelAndView å¯¹è±¡ï¼ŒåŒ…å«è§†å›¾åç§°å’Œæ¨¡å‹æ•°æ®ã€‚</li></ol><p><strong>å·¥ä½œæµç¨‹</strong></p><ol><li><strong>è¯·æ±‚åˆ°è¾¾ DispatcherServletï¼š</strong>å½“ä¸€ä¸ª HTTP è¯·æ±‚åˆ°è¾¾ DispatcherServlet æ—¶ï¼Œå®ƒä¼šå…ˆé€šè¿‡HandlerMapping æ‰¾åˆ°å¯¹åº”çš„å¤„ç†å™¨ã€‚</li><li><strong>é€‰æ‹© Handler Adapter:</strong> DispatcherServletæ ¹æ®å¤„ç†å™¨çš„ç±»å‹é€‰æ‹©åˆé€‚çš„ Handler Adapter ã€‚</li><li><strong>æ‰§è¡Œå¤„ç†å™¨:</strong> Handler Adapter è°ƒç”¨å¤„ç†å™¨çš„æ–¹æ³•æ¥å¤„ç†è¯·æ±‚ã€‚</li><li>**è¿”å›ç»“æœ:**å¤„ç†å®Œè¯·æ±‚åï¼ŒHandler Adapterè¿”å›ä¸€ä¸ª ModelAndView å¯¹è±¡ï¼ŒDispatcherServletã€‚<br>å†æ ¹æ®è¿™ä¸ªå¯¹è±¡ç”Ÿæˆæœ€ç»ˆçš„å“åº”ã€‚</li></ol><p><strong>å¸¸è§çš„ Handler Adapter å®ç°</strong></p><ol><li>HttpRequestHandlerAdapter<ul><li>ç”¨äºå¤„ç†å®ç° HttpRequestHandler æ¥å£çš„å¤„ç†å™¨ã€‚</li><li>ä¾‹å¦‚å®ç°äº† HttpRequestHandleræ¥å£çš„å¤„ç†å™¨ã€‚</li></ul></li><li>SimpleControllerHandlerAdapter<ul><li>ç”¨äºå¤„ç†å®ç°Controller æ¥å£çš„å¤„ç†å™¨ã€‚</li><li>ä¾‹å¦‚å®ç°äº† Controlleræ¥å£çš„å¤„ç†å™¨ã€‚</li></ul></li><li>RequestMappingHandlerAdapter<ul><li>æœ€å¸¸ç”¨çš„ Handler Adapter å®ç°ã€‚</li><li>ç”¨äºå¤„ç†ä½¿ç”¨ @RequestMapping æ³¨è§£çš„æ§åˆ¶å™¨æ–¹æ³•ã€‚</li><li>æ”¯æŒå¤æ‚çš„è¯·æ±‚æ˜ å°„è§„åˆ™å’Œæ•°æ®ç»‘å®šã€‚</li></ul></li></ol><p><strong>æ€»ç»“</strong><br><code>Handler Adapter</code> è´Ÿè´£å°†å¤„ç†å™¨é€‚é…ä¸ºå…·ä½“çš„å¤„ç†æ–¹æ³•ã€‚é€šè¿‡ä½¿ç”¨ä¸åŒçš„ <code>Handler Adapter</code> å®ç°ï¼Œ<code>SpringMVC</code>å¯ä»¥çµæ´»åœ°æ”¯æŒå¤šç§ç±»å‹çš„å¤„ç†å™¨ã€‚æœ€å¸¸ç”¨çš„ <code>Handler Adapter</code> å®ç°æ˜¯<code> RequestMappingHandlerAdapter</code>å®ƒæ”¯æŒé€šè¿‡æ³¨è§£å®šä¹‰çš„æ§åˆ¶å™¨æ–¹æ³•ï¼Œå¹¶æä¾›äº†å¼ºå¤§çš„è¯·æ±‚å¤„ç†åŠŸèƒ½ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯View-Resolver"><a href="#ä»€ä¹ˆæ˜¯View-Resolver" class="headerlink" title="ä»€ä¹ˆæ˜¯View Resolver"></a>ä»€ä¹ˆæ˜¯View Resolver</h3><p><code>View Resolver</code> è´Ÿè´£å°†é€»è¾‘è§†å›¾åç§°è§£æä¸ºå…·ä½“çš„è§†å›¾å¯¹è±¡(å¦‚<code>JSPã€Thymeleaf</code> æ¨¡æ¿ç­‰)ã€‚<code>ViewResolver</code>çš„ä¸»è¦ä½œç”¨æ˜¯æ ¹æ®æ§åˆ¶å™¨è¿”å›çš„è§†å›¾åç§°ï¼Œæ‰¾åˆ°ç›¸åº”çš„è§†å›¾èµ„æºï¼Œå¹¶å°†å…¶æ¸²æŸ“æˆæœ€ç»ˆçš„ <code>HTML</code> å“åº”ã€‚</p><p><strong>ä¸»è¦èŒè´£</strong></p><ol><li><strong>è§†å›¾åç§°è§£æ:</strong> å°†æ§åˆ¶å™¨è¿”å›çš„é€»è¾‘è§†å›¾åç§°è§£æä¸ºå…·ä½“çš„è§†å›¾å¯¹è±¡ã€‚</li><li><strong>è§†å›¾å¯¹è±¡è¿”å›:</strong> è¿”å›ä¸€ä¸ª view å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¯ä»¥ç”¨æ¥æŸ“æ¨¡å‹æ•°æ®</li></ol><p><strong>å·¥ä½œæµç¨‹</strong></p><ol><li>**æ§åˆ¶å™¨å¤„ç†è¯·æ±‚: **å½“ä¸€ä¸ªHTTP è¯·æ±‚åˆ°è¾¾ DispatcherServlet æ—¶ï¼Œå®ƒä¼šé€šè¿‡ Handler Adapter è°ƒç”¨æ§åˆ¶å™¨çš„æ–¹æ³•æ¥å¤„ç†è¯·æ±‚ã€‚</li><li>**è¿”å›è§†å›¾åç§°: **æ§åˆ¶å™¨æ–¹æ³•å¤„ç†å®Œè¯·æ±‚åï¼Œä¼šè¿”å›ä¸€ä¸ªåŒ…å«è§†å›¾åç§°å’Œæ¨¡å‹æ•°æ®çš„ ModelAndView å¯¹è±¡ã€‚</li><li><strong>è§†å›¾åç§°è§£æ:</strong> DispatcherServletä½¿ç”¨ View Resolver å°†é€»è¾‘è§†å›¾åç§°è§£æä¸ºå…·ä½“çš„è§†å›¾å¯¹è±¡ã€‚</li><li><strong>æ¸²æŸ“è§†å›¾:</strong> view å¯¹è±¡ä½¿ç”¨æ¨¡å‹æ•°æ®æ¥æ¸²æŸ“æœ€ç»ˆçš„ HTML å“åº”ã€‚</li></ol><h3 id="Spring-MVC-ä¸­çš„-Controlleræ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨"><a href="#Spring-MVC-ä¸­çš„-Controlleræ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨" class="headerlink" title="Spring MVC ä¸­çš„@Controlleræ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨"></a>Spring MVC ä¸­çš„@Controlleræ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨</h3><p><code>@controller</code> æ³¨è§£ç”¨äºæ ‡è®°ä¸€ä¸ªç±»ä½œä¸ºæ§åˆ¶å™¨ç»„ä»¶ã€‚æ§åˆ¶å™¨æ˜¯å¤„ç† HTTP è¯·æ±‚çš„æ ¸å¿ƒç»„ä»¶ï¼Œå®ƒè´Ÿè´£æ¥æ”¶è¯·æ±‚å¤„ç†ä¸šåŠ¡é€»è¾‘å¹¶è¿”å›è§†å›¾æˆ–æ•°æ®å“åº”ã€‚</p><p><strong>ä¸»è¦ä½œç”¨</strong></p><ol><li>æ ‡è¯†æ§åˆ¶å™¨ç±»: @contro1ler æ³¨è§£å‘Šè¯‰ Spring è¯¥ç±»æ˜¯ä¸€ä¸ªæ§åˆ¶å™¨ï¼Œåº”è¯¥ç”± Spring å®¹å™¨ç®¡ç†ã€‚</li><li>å¤„ç†è¯·æ±‚:æ§åˆ¶å™¨ç±»ä¸­çš„æ–¹æ³•é€šè¿‡æ˜ å°„æ³¨è§£(å¦‚ @RequestMappingã€@GetMappingã€@PostMappingç­‰)å¤„ç† HTTP è¯·æ±‚ã€‚</li></ol><p><strong>ç›¸å…³æ³¨è§£</strong></p><p>åœ¨Spring MVCä¸­ï¼Œé™¤äº† @controllerï¼Œè¿˜æœ‰ä¸€äº›å¸¸ç”¨çš„æ³¨è§£ç”¨äºå¤„ç†è¯·æ±‚</p><ol><li>@RequestMapping<ul><li>ç”¨äºå®šä¹‰è¯·æ±‚ URL å’Œ HTTP æ–¹æ³•çš„æ˜ å°„ã€‚</li><li>å¯ä»¥åº”ç”¨äºç±»çº§åˆ«å’Œæ–¹æ³•çº§åˆ«ã€‚</li></ul></li><li>@PutMapping@DeleteMapping@GetMappingã€@PostMapping<ul><li>åˆ†åˆ«ç”¨äºå¤„ç†GETã€POSTã€PUTDELETE è¯·æ±‚ã€‚</li><li>æ˜¯ @RequestMapping çš„å¿«æ·æ–¹å¼ã€‚</li></ul></li><li>@RequestParam<ul><li>ç”¨äºç»‘å®šè¯·æ±‚å‚æ•°åˆ°æ–¹æ³•å‚æ•°ã€‚</li><li>å¯ä»¥æŒ‡å®šå‚æ•°åç§°ã€æ˜¯å¦å¿…éœ€ä»¥åŠé»˜è®¤å€¼ã€‚</li></ul></li><li>@PathVariable<ul><li>ç”¨äºç»‘å®š URL è·¯å¾„ä¸­çš„å˜é‡åˆ°æ–¹æ³•å‚æ•°ã€‚</li></ul></li><li>@ModelAttribute<ul><li>ç”¨äºå°†è¯·æ±‚å‚æ•°ç»‘å®šåˆ°æ¨¡å‹å¯¹è±¡ï¼Œå¹¶å°†æ¨¡å‹å¯¹è±¡æ·»åŠ åˆ°æ¨¡å‹ä¸­ã€‚</li></ul></li><li>@ResponseBody<ul><li>ç”¨äºå°†æ–¹æ³•çš„è¿”å›å€¼ç›´æ¥ä½œä¸º HTTP å“åº”ä½“ã€‚</li><li>å¸¸ç”¨äºè¿”å› JSON æˆ– XML æ•°æ®ã€‚</li></ul></li></ol><p><strong>æ€»ç»“</strong></p><p>@controller æ³¨è§£åœ¨ Spring MVC ä¸­ç”¨äºæ ‡è®°ä¸€ä¸ªç±»ä¸ºæ§åˆ¶å™¨ç»„ä»¶ï¼Œæ§åˆ¶å™¨è´Ÿè´£å¤„ç† HTTP è¯·æ±‚å¹¶è¿”å›è§†å›¾æˆ–æ•°æ®å“åº”ã€‚é€šè¿‡ç»“åˆä½¿ç”¨å„ç§æ˜ å°„æ³¨è§£(å¦‚ @RequestMappingã€@GetMapping ç­‰)å’Œå‚æ•°ç»‘å®šæ³¨è§£(å¦‚ @RequestParam@PathVariable ç­‰)ï¼Œå¯ä»¥çµæ´»åœ°å¤„ç†ä¸åŒç±»å‹çš„è¯·æ±‚å’Œå‚æ•°ã€‚</p><h3 id="Spring-MVC-ä¸­çš„-RequestMapping-æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨"><a href="#Spring-MVC-ä¸­çš„-RequestMapping-æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨" class="headerlink" title="Spring MVC ä¸­çš„ @RequestMapping æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨?"></a>Spring MVC ä¸­çš„ @RequestMapping æ³¨è§£æœ‰ä»€ä¹ˆä½œç”¨?</h3>]]></content>
      
      
      <categories>
          
          <category> åšå®¢ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> åç«¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çº¿ç¨‹æ± æ•°é‡åˆ°åº•å¦‚ä½•é…ç½®ï¼Ÿ</title>
      <link href="/2024/08/06/2024-08-06-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E6%95%B0%E9%87%8F%E5%88%B0%E5%BA%95%E5%A6%82%E4%BD%95%E9%85%8D%E7%BD%AE%EF%BC%9F/"/>
      <url>/2024/08/06/2024-08-06-%E7%BA%BF%E7%A8%8B%E6%B1%A0%E6%95%B0%E9%87%8F%E5%88%B0%E5%BA%95%E5%A6%82%E4%BD%95%E9%85%8D%E7%BD%AE%EF%BC%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="çº¿ç¨‹æ± æ•°é‡åˆ°åº•å¦‚ä½•é…ç½®ï¼Ÿ"><a href="#çº¿ç¨‹æ± æ•°é‡åˆ°åº•å¦‚ä½•é…ç½®ï¼Ÿ" class="headerlink" title="çº¿ç¨‹æ± æ•°é‡åˆ°åº•å¦‚ä½•é…ç½®ï¼Ÿ"></a>çº¿ç¨‹æ± æ•°é‡åˆ°åº•å¦‚ä½•é…ç½®ï¼Ÿ</h1><p>å¯èƒ½å¾ˆå¤šäººéƒ½çœ‹åˆ°è¿‡ä¸€ä¸ªçº¿ç¨‹æ•°è®¾ç½®çš„ç†è®º:</p><ol><li>CPU å¯†é›†å‹çš„ç¨‹åº-æ ¸å¿ƒæ•° +1</li><li>1&#x2F;0 å¯†é›†å‹çš„ç¨‹åº-æ ¸å¿ƒæ•°*2</li></ol><p>ä¸ä¼šå§ï¼Œä¸ä¼šå§ï¼ŒçœŸçš„æœ‰äººæŒ‰ç…§è¿™ä¸ªç†è®ºè§„åˆ’çº¿ç¨‹æ•°?</p><h2 id="çº¿ç¨‹æ•°å’ŒCPUåˆ©ç”¨ç‡çš„å°æµ‹è¯•"><a href="#çº¿ç¨‹æ•°å’ŒCPUåˆ©ç”¨ç‡çš„å°æµ‹è¯•" class="headerlink" title="çº¿ç¨‹æ•°å’ŒCPUåˆ©ç”¨ç‡çš„å°æµ‹è¯•"></a>çº¿ç¨‹æ•°å’ŒCPUåˆ©ç”¨ç‡çš„å°æµ‹è¯•</h2><p>æŠ›å¼€ä¸€äº›æ“ä½œç³»ç»Ÿï¼Œè®¡ç®—æœºåŸç†ä¸è°ˆï¼Œè¯´ä¸€ä¸ªåŸºæœ¬çš„ç†è®º(ä¸ç”¨çº ç»“æ˜¯å¦ä¸¥è°¨ï¼Œåªä¸ºå¥½ç†è§£)ï¼š</p><p>ä¸€ä¸ªCPUæ ¸å¿ƒï¼Œå•ä½æ—¶é—´å†…åªèƒ½æ‰§è¡Œä¸€ä¸ªçº¿ç¨‹çš„æŒ‡ä»¤é‚£ä¹ˆç†è®ºä¸Šï¼Œæˆ‘ä¸€ä¸ªçº¿ç¨‹åªéœ€è¦ä¸åœçš„æ‰§è¡ŒæŒ‡ä»¤ï¼Œå°±å¯ä»¥è·‘æ»¡ä¸€ä¸ªæ ¸å¿ƒçš„åˆ©ç”¨ç‡ã€‚</p><p>æ¥å†™ä¸ªæ­»å¾ªç¯ç©ºè·‘çš„ä¾‹å­éªŒè¯ä¸€ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CPUUtilizationTest</span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;<span class="comment">//æ­»å¾ªç¯ï¼Œä»€ä¹ˆéƒ½ä¸åš</span></span><br><span class="line"><span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•CPUï¼š6æ ¸å¿ƒ12çº¿ç¨‹</strong></p><p>ç°åœ¨çš„CPUåˆ©ç”¨ç‡ï¼š</p><p><img src="https://s2.loli.net/2024/08/06/sLo7DeAqTgkKSr1.png" alt="image-20240806173358143.png"></p><p>ä»å›¾ä¸Šå¯ä»¥çœ‹åˆ°ï¼Œ3å·æ ¸å¿ƒåˆ©ç”¨ç‡å·²ç»è¢«è·‘æ»¡äº†</p><p>åŸºäºä¸Šé¢çš„ç†è®ºï¼Œå¤šå¼€å‡ ä¸ªçº¿ç¨‹è¯•è¯•å‘¢?</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CPUUtilizationTest</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[]args)</span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">6</span>;j++)&#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Thread</span>(newRunnable()&#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span>&#123;</span><br><span class="line">                    <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">                        </span><br><span class="line">                    &#125;).start();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å†çœ‹CPUåˆ©ç”¨ç‡ï¼Œ1&#x2F;2&#x2F;5&#x2F;7&#x2F;9&#x2F;11 å‡ ä¸ªæ ¸å¿ƒçš„åˆ©ç”¨ç‡å·²ç»è¢«è·‘æ»¡ã€‚</p><p><img src="https://s2.loli.net/2024/08/06/9IkQRx5giadfSte.png" alt="image-20240806173823732.png"></p><p>é‚£å¦‚æœå¼€12ä¸ªçº¿ç¨‹å‘¢ï¼Œæ˜¯ä¸æ˜¯ä¼šæŠŠæ‰€æœ‰æ ¸å¿ƒçš„åˆ©ç”¨ç‡éƒ½è·‘æ»¡?ç­”æ¡ˆä¸€å®šæ˜¯ä¼šçš„:</p><p>å¦‚æœæ­¤æ—¶æˆ‘æŠŠä¸Šé¢ä¾‹å­çš„çº¿ç¨‹æ•°ç»§ç»­å¢åŠ åˆ°24ä¸ªçº¿ç¨‹ï¼Œä¼šå‡ºç°ä»€ä¹ˆç»“æœå‘¢?</p><p><img src="https://s2.loli.net/2024/08/06/BJuykt4adLPg7M5.png" alt="image-20240806174134976.png"></p><p>ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼ŒCPUåˆ©ç”¨ç‡å’Œä¸Šä¸€æ­¥ä¸€æ ·ï¼Œè¿˜æ˜¯æ‰€æœ‰æ ¸å¿ƒ100%ï¼Œä¸è¿‡æ­¤æ—¶è´Ÿè½½å·²ç»ä»11.xå¢åŠ åˆ°äº†22.xï¼ˆload averageè§£é‡Šå‚è€ƒ<a href="https://scoutapm.com/blog/understanding-load-averages%EF%BC%89%EF%BC%8C%E8%AF%B4%E6%98%8E%E6%AD%A4%E6%97%B6CPU%E6%9B%B4%E7%B9%81%E5%BF%99%EF%BC%8C%E7%BA%BF%E7%A8%8B%E7%9A%84%E4%BB%BB%E5%8A%A1%E6%97%A0%E6%B3%95%E5%8F%8A%E6%97%B6%E6%89%A7%E8%A1%8C%E3%80%82">https://scoutapm.com/blog/understanding-load-averagesï¼‰ï¼Œè¯´æ˜æ­¤æ—¶CPUæ›´ç¹å¿™ï¼Œçº¿ç¨‹çš„ä»»åŠ¡æ— æ³•åŠæ—¶æ‰§è¡Œã€‚</a></p><p>ç°ä»£CPUåŸºæœ¬éƒ½æ˜¯å¤šæ ¸å¿ƒçš„ï¼Œæ¯”å¦‚æˆ‘è¿™é‡Œæµ‹è¯•ç”¨çš„AMD 3600ï¼Œ6æ ¸å¿ƒ12çº¿ç¨‹ï¼ˆè¶…çº¿ç¨‹ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„è®¤ä¸ºå®ƒå°±æ˜¯12æ ¸å¿ƒCPUã€‚é‚£ä¹ˆæˆ‘è¿™ä¸ªCPUå°±å¯ä»¥åŒæ—¶åš12ä»¶äº‹ï¼Œäº’ä¸æ‰“æ‰°ã€‚</p><p>å¦‚æœè¦æ‰§è¡Œçš„çº¿ç¨‹å¤§äºæ ¸å¿ƒæ•°ï¼Œé‚£ä¹ˆå°±éœ€è¦é€šè¿‡æ“ä½œç³»ç»Ÿçš„è°ƒåº¦äº†ã€‚æ“ä½œç³»ç»Ÿç»™æ¯ä¸ªçº¿ç¨‹åˆ†é…CPUæ—¶é—´ç‰‡èµ„æºï¼Œç„¶åä¸åœçš„åˆ‡æ¢ï¼Œä»è€Œå®ç°â€œå¹¶è¡Œâ€æ‰§è¡Œçš„æ•ˆæœã€‚</p><p>ä½†æ˜¯è¿™æ ·çœŸçš„æ›´å¿«å—ï¼Ÿä»ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œ<strong>ä¸€ä¸ªçº¿ç¨‹</strong>å°±å¯ä»¥æŠŠ<strong>ä¸€ä¸ªæ ¸å¿ƒ</strong>çš„åˆ©ç”¨ç‡è·‘æ»¡ã€‚å¦‚æœæ¯ä¸ªçº¿ç¨‹éƒ½å¾ˆâ€œéœ¸é“â€ï¼Œä¸åœçš„æ‰§è¡ŒæŒ‡ä»¤ï¼Œä¸ç»™CPUç©ºé—²çš„æ—¶é—´ï¼Œå¹¶ä¸”åŒæ—¶æ‰§è¡Œçš„çº¿ç¨‹æ•°å¤§äºCPUçš„æ ¸å¿ƒæ•°ï¼Œå°±ä¼šå¯¼è‡´æ“ä½œç³»ç»Ÿ<strong>æ›´é¢‘ç¹çš„æ‰§è¡Œåˆ‡æ¢çº¿ç¨‹æ‰§è¡Œ</strong>ï¼Œä»¥ç¡®ä¿æ¯ä¸ªçº¿ç¨‹éƒ½å¯ä»¥å¾—åˆ°æ‰§è¡Œã€‚</p><p>ä¸è¿‡åˆ‡æ¢æ˜¯æœ‰ä»£ä»·çš„ï¼Œ<strong>æ¯æ¬¡åˆ‡æ¢ä¼šä¼´éšç€å¯„å­˜å™¨æ•°æ®æ›´æ–°ï¼Œå†…å­˜é¡µè¡¨æ›´æ–°ç­‰æ“ä½œ</strong>ã€‚è™½ç„¶ä¸€æ¬¡åˆ‡æ¢çš„ä»£ä»·å’ŒI&#x2F;Oæ“ä½œæ¯”èµ·æ¥å¾®ä¸è¶³é“ï¼Œä½†å¦‚æœçº¿ç¨‹è¿‡å¤šï¼Œçº¿ç¨‹åˆ‡æ¢çš„è¿‡äºé¢‘ç¹ï¼Œç”šè‡³åœ¨å•ä½æ—¶é—´å†…åˆ‡æ¢çš„è€—æ—¶å·²ç»å¤§äºç¨‹åºæ‰§è¡Œçš„æ—¶é—´ï¼Œå°±ä¼šå¯¼è‡´CPUèµ„æºè¿‡å¤šçš„æµªè´¹åœ¨ä¸Šä¸‹æ–‡åˆ‡æ¢ä¸Šï¼Œè€Œä¸æ˜¯åœ¨æ‰§è¡Œç¨‹åºï¼Œå¾—ä¸å¿å¤±ã€‚</p><p>ä¸Šé¢æ­»å¾ªç¯ç©ºè·‘çš„ä¾‹å­ï¼Œæœ‰ç‚¹è¿‡äºæç«¯äº†ï¼Œæ­£å¸¸æƒ…å†µä¸‹ä¸å¤ªå¯èƒ½æœ‰è¿™ç§ç¨‹åºã€‚</p><p>å¤§å¤šç¨‹åºåœ¨è¿è¡Œæ—¶éƒ½ä¼šæœ‰ä¸€äº› I&#x2F;Oæ“ä½œï¼Œå¯èƒ½æ˜¯è¯»å†™æ–‡ä»¶ï¼Œç½‘ç»œæ”¶å‘æŠ¥æ–‡ç­‰ï¼Œè¿™äº› I&#x2F;O æ“ä½œåœ¨è¿›è¡Œæ—¶æ—¶éœ€è¦ç­‰å¾…åé¦ˆçš„ã€‚æ¯”å¦‚ç½‘ç»œè¯»å†™æ—¶ï¼Œéœ€è¦ç­‰å¾…æŠ¥æ–‡å‘é€æˆ–è€…æ¥æ”¶åˆ°ï¼Œåœ¨è¿™ä¸ªç­‰å¾…è¿‡ç¨‹ä¸­ï¼Œçº¿ç¨‹æ˜¯ç­‰å¾…çŠ¶æ€ï¼ŒCPUæ²¡æœ‰å·¥ä½œã€‚æ­¤æ—¶æ“ä½œç³»ç»Ÿå°±ä¼šè°ƒåº¦CPUå»æ‰§è¡Œå…¶ä»–çº¿ç¨‹çš„æŒ‡ä»¤ï¼Œè¿™æ ·å°±å®Œç¾åˆ©ç”¨äº†CPUè¿™æ®µç©ºé—²æœŸï¼Œæé«˜äº†CPUçš„åˆ©ç”¨ç‡ã€‚</p><p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç¨‹åºä¸åœçš„å¾ªç¯ä»€ä¹ˆéƒ½ä¸åšï¼ŒCPUè¦ä¸åœçš„æ‰§è¡ŒæŒ‡ä»¤ï¼Œå‡ ä¹æ²¡æœ‰å•¥ç©ºé—²çš„æ—¶é—´ã€‚å¦‚æœæ’å…¥ä¸€æ®µI&#x2F;Oæ“ä½œå‘¢ï¼ŒI&#x2F;O æ“ä½œæœŸé—´ CPUæ˜¯ç©ºé—²çŠ¶æ€ï¼ŒCPUçš„åˆ©ç”¨ç‡ä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿå…ˆçœ‹çœ‹å•çº¿ç¨‹ä¸‹çš„ç»“æœï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CPUUtilizationTest</span>&#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> InterruptedException&#123;</span><br><span class="line"> <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span><span class="number">0</span>; n &lt;<span class="number">1</span>; n++)&#123;</span><br><span class="line"> <span class="keyword">new</span> <span class="title class_">Thread</span>(newRunnable()&#123;</span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span>&#123;</span><br><span class="line"> <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line"> <span class="comment">//æ¯æ¬¡ç©ºå¾ªç¯ 1äº¿ æ¬¡åï¼Œsleep 50msï¼Œæ¨¡æ‹Ÿ I/Oç­‰å¾…ã€åˆ‡æ¢</span></span><br><span class="line"> <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span><span class="number">0</span>; i &lt;<span class="number">100_000_000l</span>; i++)&#123; </span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">try</span>&#123;</span><br><span class="line"> Thread.sleep(<span class="number">50</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">catch</span>(InterruptedException e)&#123;</span><br><span class="line"> e.printStackTrace();</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;).start();</span><br><span class="line"> &#125;</span><br><span class="line"> &#125;&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/08/06/2w67tqmhY9yc3e8.png" alt="image-20240806174442221.png"></p><p>å”¯ä¸€æœ‰åˆ©ç”¨ç‡çš„9å·æ ¸å¿ƒï¼Œåˆ©ç”¨ç‡ä¹Ÿæ‰50%ï¼Œå’Œå‰é¢æ²¡æœ‰sleepçš„100%ç›¸æ¯”ï¼Œå·²ç»ä½äº†ä¸€åŠäº†ã€‚ç°åœ¨æŠŠçº¿ç¨‹æ•°è°ƒæ•´åˆ°12ä¸ªçœ‹çœ‹ï¼š</p><p><img src="https://s2.loli.net/2024/08/06/ws8vjbpZtcMQm3D.png" alt="image-20240806174542836.png"></p><p>å•ä¸ªæ ¸å¿ƒçš„åˆ©ç”¨ç‡60å·¦å³ï¼Œå’Œåˆšæ‰çš„å•çº¿ç¨‹ç»“æœå·®è·ä¸å¤§ï¼Œè¿˜æ²¡æœ‰æŠŠCPUåˆ©ç”¨ç‡è·‘æ»¡ï¼Œç°åœ¨å°†çº¿ç¨‹æ•°å¢åŠ åˆ°18ï¼š</p><p><img src="https://s2.loli.net/2024/08/06/oKWOwCY3QHD5ImL.png" alt="image-20240806174701639.png"></p><p>æ­¤æ—¶å•æ ¸å¿ƒåˆ©ç”¨ç‡ï¼Œå·²ç»æ¥è¿‘100%äº†ã€‚ç”±æ­¤å¯è§ï¼Œå½“çº¿ç¨‹ä¸­æœ‰ I&#x2F;O ç­‰æ“ä½œä¸å ç”¨CPUèµ„æºæ—¶ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥è°ƒåº¦CPUå¯ä»¥åŒæ—¶æ‰§è¡Œæ›´å¤šçš„çº¿ç¨‹ã€‚</p><p>ç°åœ¨å°†I&#x2F;Oäº‹ä»¶çš„é¢‘ç‡è°ƒé«˜çœ‹çœ‹å‘¢ï¼ŒæŠŠå¾ªç¯æ¬¡æ•°å‡åˆ°ä¸€åŠï¼Œ50_000_000ï¼ŒåŒæ ·æ˜¯18ä¸ªçº¿ç¨‹ï¼šæ­¤æ—¶æ¯ä¸ªæ ¸å¿ƒçš„åˆ©ç”¨ç‡ï¼Œå¤§æ¦‚åªæœ‰70%å·¦å³äº†ã€‚</p><h2 id="çº¿ç¨‹æ•°å’ŒCPUåˆ©ç”¨ç‡çš„å°æ€»ç»“"><a href="#çº¿ç¨‹æ•°å’ŒCPUåˆ©ç”¨ç‡çš„å°æ€»ç»“" class="headerlink" title="çº¿ç¨‹æ•°å’ŒCPUåˆ©ç”¨ç‡çš„å°æ€»ç»“"></a>çº¿ç¨‹æ•°å’ŒCPUåˆ©ç”¨ç‡çš„å°æ€»ç»“</h2><p>ä¸Šé¢çš„ä¾‹å­ï¼Œåªæ˜¯è¾…åŠ©ï¼Œä¸ºäº†æ›´å¥½çš„ç†è§£çº¿ç¨‹æ•°&#x2F;ç¨‹åºè¡Œä¸º&#x2F;CPUçŠ¶æ€çš„å…³ç³»ï¼Œæ¥ç®€å•æ€»ç»“ä¸€ä¸‹ï¼š</p><ol><li>ä¸€ä¸ªæç«¯çš„çº¿ç¨‹ï¼ˆä¸åœæ‰§è¡Œâ€œè®¡ç®—â€å‹æ“ä½œæ—¶ï¼‰ï¼Œå°±å¯ä»¥æŠŠå•ä¸ªæ ¸å¿ƒçš„åˆ©ç”¨ç‡è·‘æ»¡ï¼Œå¤šæ ¸å¿ƒCPUæœ€å¤šåªèƒ½åŒæ—¶æ‰§è¡Œç­‰äºæ ¸å¿ƒæ•°çš„â€œæç«¯â€çº¿ç¨‹æ•°</li><li>å¦‚æœæ¯ä¸ªçº¿ç¨‹éƒ½è¿™ä¹ˆâ€œæç«¯â€ï¼Œä¸”åŒæ—¶æ‰§è¡Œçš„çº¿ç¨‹æ•°è¶…è¿‡æ ¸å¿ƒæ•°ï¼Œä¼šå¯¼è‡´ä¸å¿…è¦çš„åˆ‡æ¢ï¼Œé€ æˆè´Ÿè½½è¿‡é«˜ï¼Œåªä¼šè®©æ‰§è¡Œæ›´æ…¢</li><li>I&#x2F;O ç­‰æš‚åœç±»æ“ä½œæ—¶ï¼ŒCPUå¤„äºç©ºé—²çŠ¶æ€ï¼Œæ“ä½œç³»ç»Ÿè°ƒåº¦CPUæ‰§è¡Œå…¶ä»–çº¿ç¨‹ï¼Œå¯ä»¥æé«˜CPUåˆ©ç”¨ç‡ï¼ŒåŒæ—¶æ‰§è¡Œæ›´å¤šçš„çº¿ç¨‹</li><li>I&#x2F;O äº‹ä»¶çš„é¢‘ç‡é¢‘ç‡è¶Šé«˜ï¼Œæˆ–è€…ç­‰å¾…&#x2F;æš‚åœæ—¶é—´è¶Šé•¿ï¼ŒCPUçš„ç©ºé—²æ—¶é—´ä¹Ÿå°±æ›´é•¿ï¼Œåˆ©ç”¨ç‡è¶Šä½ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥è°ƒåº¦CPUæ‰§è¡Œæ›´å¤šçš„çº¿ç¨‹</li></ol><h2 id="çº¿ç¨‹æ•°è§„åˆ’çš„å…¬å¼"><a href="#çº¿ç¨‹æ•°è§„åˆ’çš„å…¬å¼" class="headerlink" title="çº¿ç¨‹æ•°è§„åˆ’çš„å…¬å¼"></a>çº¿ç¨‹æ•°è§„åˆ’çš„å…¬å¼</h2><p>å‰é¢çš„é“ºå«ï¼Œéƒ½æ˜¯ä¸ºäº†å¸®åŠ©ç†è§£ï¼Œç°åœ¨æ¥çœ‹çœ‹ä¹¦æœ¬ä¸Šçš„å®šä¹‰ã€‚ã€ŠJava å¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹ä»‹ç»äº†ä¸€ä¸ªçº¿ç¨‹æ•°è®¡ç®—çš„å…¬å¼ï¼š</p><p><img src="https://s2.loli.net/2024/08/06/4PQCYBlo3ifDqE7.png" alt="image-20240806174901883.png"></p><p>å¦‚æœå¸Œæœ›ç¨‹åºè·‘åˆ°CPUçš„ç›®æ ‡åˆ©ç”¨ç‡ï¼Œéœ€è¦çš„çº¿ç¨‹æ•°å…¬å¼ä¸ºï¼š</p><p><img src="https://s2.loli.net/2024/08/06/GdKOFxktpgzoAbw.png" alt="image-20240806174957005.png"></p><p>å…¬å¼å¾ˆæ¸…æ™°ï¼Œç°åœ¨æ¥å¸¦å…¥ä¸Šé¢çš„ä¾‹å­è¯•è¯•çœ‹ï¼š</p><p>å¦‚æœæˆ‘æœŸæœ›ç›®æ ‡åˆ©ç”¨ç‡ä¸º90%ï¼ˆå¤šæ ¸90ï¼‰ï¼Œé‚£ä¹ˆéœ€è¦çš„çº¿ç¨‹æ•°ä¸ºï¼š</p><p>æ ¸å¿ƒæ•°12 * åˆ©ç”¨ç‡0.9 * (1 + 50(sleepæ—¶é—´)&#x2F;50(å¾ªç¯50_000_000è€—æ—¶)) â‰ˆ 22</p><p>ç°åœ¨æŠŠçº¿ç¨‹æ•°è°ƒåˆ°22ï¼Œçœ‹çœ‹ç»“æœï¼š</p><p><img src="https://s2.loli.net/2024/08/06/xCRQJ57aUgdtFoy.png" alt="image-20240806175037385.png"></p><p>ç°åœ¨CPUåˆ©ç”¨ç‡å¤§æ¦‚80+ï¼Œå’Œé¢„æœŸæ¯”è¾ƒæ¥è¿‘äº†ï¼Œç”±äºçº¿ç¨‹æ•°è¿‡å¤šï¼Œè¿˜æœ‰äº›ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ï¼Œå†åŠ ä¸Šæµ‹è¯•ç”¨ä¾‹ä¸å¤Ÿä¸¥è°¨ï¼Œæ‰€ä»¥å®é™…åˆ©ç”¨ç‡ä½ä¸€äº›ä¹Ÿæ­£å¸¸ã€‚</p><p>æŠŠå…¬å¼å˜ä¸ªå½¢ï¼Œè¿˜å¯ä»¥é€šè¿‡çº¿ç¨‹æ•°æ¥è®¡ç®—CPUåˆ©ç”¨ç‡ï¼š</p><p><img src="https://s2.loli.net/2024/08/06/OdADxL96P3E2BQv.png" alt="image-20240806175054548.png"></p><p>çº¿ç¨‹æ•°22 &#x2F; (æ ¸å¿ƒæ•°12 * (1 + 50(sleepæ—¶é—´)&#x2F;50(å¾ªç¯50_000_000è€—æ—¶))) â‰ˆ 0.9</p><p>è™½ç„¶å…¬å¼å¾ˆå¥½ï¼Œä½†åœ¨çœŸå®çš„ç¨‹åºä¸­ï¼Œ<strong>ä¸€èˆ¬å¾ˆéš¾è·å¾—å‡†ç¡®çš„ç­‰å¾…æ—¶é—´å’Œè®¡ç®—æ—¶é—´ï¼Œå› ä¸ºç¨‹åºå¾ˆå¤æ‚ï¼Œä¸åªæ˜¯â€œè®¡ç®—â€</strong>ã€‚ä¸€æ®µä»£ç ä¸­ä¼šæœ‰å¾ˆå¤šçš„å†…å­˜è¯»å†™ï¼Œè®¡ç®—ï¼ŒI&#x2F;O ç­‰å¤åˆæ“ä½œï¼Œç²¾ç¡®çš„è·å–è¿™ä¸¤ä¸ªæŒ‡æ ‡å¾ˆéš¾ï¼Œæ‰€ä»¥å…‰é å…¬å¼è®¡ç®—çº¿ç¨‹æ•°è¿‡äºç†æƒ³åŒ–ã€‚</p><h2 id="çœŸå®ç¨‹åºä¸­çš„çº¿ç¨‹æ•°"><a href="#çœŸå®ç¨‹åºä¸­çš„çº¿ç¨‹æ•°" class="headerlink" title="çœŸå®ç¨‹åºä¸­çš„çº¿ç¨‹æ•°"></a>çœŸå®ç¨‹åºä¸­çš„çº¿ç¨‹æ•°</h2><p>é‚£ä¹ˆåœ¨å®é™…çš„ç¨‹åºä¸­ï¼Œæˆ–è€…è¯´ä¸€äº›Javaçš„ä¸šåŠ¡ç³»ç»Ÿä¸­ï¼Œçº¿ç¨‹æ•°ï¼ˆçº¿ç¨‹æ± å¤§å°ï¼‰è§„åˆ’å¤šå°‘åˆé€‚å‘¢ï¼Ÿ</p><p><strong>å…ˆè¯´ç»“è®ºï¼šæ²¡æœ‰å›ºå®šç­”æ¡ˆï¼Œå…ˆè®¾å®šé¢„æœŸï¼Œæ¯”å¦‚æˆ‘æœŸæœ›çš„CPUåˆ©ç”¨ç‡åœ¨å¤šå°‘ï¼Œè´Ÿè½½åœ¨å¤šå°‘ï¼ŒGCé¢‘ç‡å¤šå°‘ä¹‹ç±»çš„æŒ‡æ ‡åï¼Œå†é€šè¿‡æµ‹è¯•ä¸æ–­çš„è°ƒæ•´åˆ°ä¸€ä¸ªåˆç†çš„çº¿ç¨‹æ•°</strong></p><p>æ¯”å¦‚ä¸€ä¸ªæ™®é€šçš„ï¼ŒSpringBoot ä¸ºåŸºç¡€çš„ä¸šåŠ¡ç³»ç»Ÿï¼Œé»˜è®¤Tomcatå®¹å™¨+HikariCPè¿æ¥æ± +G1å›æ”¶å™¨ï¼Œå¦‚æœæ­¤æ—¶é¡¹ç›®ä¸­ä¹Ÿéœ€è¦ä¸€ä¸ªä¸šåŠ¡åœºæ™¯çš„å¤šçº¿ç¨‹ï¼ˆæˆ–è€…çº¿ç¨‹æ± ï¼‰æ¥å¼‚æ­¥&#x2F;å¹¶è¡Œæ‰§è¡Œä¸šåŠ¡æµç¨‹ã€‚</p><p>æ­¤æ—¶æˆ‘æŒ‰ç…§ä¸Šé¢çš„å…¬å¼æ¥è§„åˆ’çº¿ç¨‹æ•°çš„è¯ï¼Œè¯¯å·®ä¸€å®šä¼šå¾ˆå¤§ã€‚å› ä¸ºæ­¤æ—¶è¿™å°ä¸»æœºä¸Šï¼Œå·²ç»æœ‰å¾ˆå¤šè¿è¡Œä¸­çš„çº¿ç¨‹äº†ï¼ŒTomcatæœ‰è‡ªå·±çš„çº¿ç¨‹æ± ï¼ŒHikariCPä¹Ÿæœ‰è‡ªå·±çš„åå°çº¿ç¨‹ï¼ŒJVMä¹Ÿæœ‰ä¸€äº›ç¼–è¯‘çš„çº¿ç¨‹ï¼Œè¿G1éƒ½æœ‰è‡ªå·±çš„åå°çº¿ç¨‹ã€‚è¿™äº›çº¿ç¨‹ä¹Ÿæ˜¯è¿è¡Œåœ¨å½“å‰è¿›ç¨‹ã€å½“å‰ä¸»æœºä¸Šçš„ï¼Œä¹Ÿä¼šå ç”¨CPUçš„èµ„æºã€‚</p><p><strong>æ‰€ä»¥å—ç¯å¢ƒå¹²æ‰°ä¸‹ï¼Œå•é å…¬å¼å¾ˆéš¾å‡†ç¡®çš„è§„åˆ’çº¿ç¨‹æ•°ï¼Œä¸€å®šè¦é€šè¿‡æµ‹è¯•æ¥éªŒè¯ã€‚</strong></p><p><strong>æµç¨‹ä¸€èˆ¬æ˜¯è¿™æ ·ï¼š</strong></p><ol><li>åˆ†æå½“å‰ä¸»æœºä¸Šï¼Œæœ‰æ²¡æœ‰å…¶ä»–è¿›ç¨‹å¹²æ‰°</li><li>åˆ†æå½“å‰JVMè¿›ç¨‹ä¸Šï¼Œæœ‰æ²¡æœ‰å…¶ä»–è¿è¡Œä¸­æˆ–å¯èƒ½è¿è¡Œçš„çº¿ç¨‹</li><li>è®¾å®šç›®æ ‡</li><li>ç›®æ ‡CPUåˆ©ç”¨ç‡ - æˆ‘æœ€é«˜èƒ½å®¹å¿æˆ‘çš„CPUé£™åˆ°å¤šå°‘ï¼Ÿ</li><li>ç›®æ ‡GCé¢‘ç‡&#x2F;æš‚åœæ—¶é—´ - å¤šçº¿ç¨‹æ‰§è¡Œåï¼ŒGCé¢‘ç‡ä¼šå¢é«˜ï¼Œæœ€å¤§èƒ½å®¹å¿åˆ°ä»€ä¹ˆé¢‘ç‡ï¼Œæ¯æ¬¡æš‚åœæ—¶é—´å¤šå°‘ï¼Ÿ</li><li>æ‰§è¡Œæ•ˆç‡ - æ¯”å¦‚æ‰¹å¤„ç†æ—¶ï¼Œæˆ‘å•ä½æ—¶é—´å†…è¦å¼€å¤šå°‘çº¿ç¨‹æ‰èƒ½åŠæ—¶å¤„ç†å®Œæ¯•</li><li>â€¦â€¦</li><li>æ¢³ç†é“¾è·¯å…³é”®ç‚¹ï¼Œæ˜¯å¦æœ‰å¡è„–å­çš„ç‚¹ï¼Œå› ä¸ºå¦‚æœçº¿ç¨‹æ•°è¿‡å¤šï¼Œé“¾è·¯ä¸ŠæŸäº›èŠ‚ç‚¹èµ„æºæœ‰é™å¯èƒ½ä¼šå¯¼è‡´å¤§é‡çš„çº¿ç¨‹åœ¨ç­‰å¾…èµ„æºï¼ˆæ¯”å¦‚ä¸‰æ–¹æ¥å£é™æµï¼Œè¿æ¥æ± æ•°é‡æœ‰é™ï¼Œä¸­é—´ä»¶å‹åŠ›è¿‡å¤§æ— æ³•æ”¯æ’‘ç­‰ï¼‰</li><li>ä¸æ–­çš„å¢åŠ &#x2F;å‡å°‘çº¿ç¨‹æ•°æ¥æµ‹è¯•ï¼ŒæŒ‰æœ€é«˜çš„è¦æ±‚å»æµ‹è¯•ï¼Œæœ€ç»ˆè·å¾—ä¸€ä¸ªâ€œæ»¡è¶³è¦æ±‚â€çš„çº¿ç¨‹æ•°**</li></ol><p><strong>è€Œä¸”è€Œä¸”è€Œä¸”ï¼ä¸åŒåœºæ™¯ä¸‹çš„çº¿ç¨‹æ•°ç†å¿µä¹Ÿæœ‰æ‰€ä¸åŒï¼š</strong></p><ol><li>Tomcatä¸­çš„maxThreadsï¼Œåœ¨Blocking I&#x2F;Oå’ŒNo-Blocking I&#x2F;Oä¸‹å°±ä¸ä¸€æ ·</li><li>Dubbo é»˜è®¤è¿˜æ˜¯å•è¿æ¥å‘¢ï¼Œä¹Ÿæœ‰I&#x2F;Oçº¿ç¨‹ï¼ˆæ± ï¼‰å’Œä¸šåŠ¡çº¿ç¨‹ï¼ˆæ± ï¼‰çš„åŒºåˆ†ï¼ŒI&#x2F;Oçº¿ç¨‹ä¸€èˆ¬ä¸æ˜¯ç“¶é¢ˆï¼Œæ‰€ä»¥ä¸å¿…å¤ªå¤šï¼Œä½†ä¸šåŠ¡çº¿ç¨‹å¾ˆå®¹æ˜“ç§°ä¸ºç“¶é¢ˆ</li><li>Redis 6.0ä»¥åä¹Ÿæ˜¯å¤šçº¿ç¨‹äº†ï¼Œä¸è¿‡å®ƒåªæ˜¯I&#x2F;O å¤šçº¿ç¨‹ï¼Œâ€œä¸šåŠ¡â€å¤„ç†è¿˜æ˜¯å•çº¿ç¨‹</li></ol><p><strong>æ‰€ä»¥ï¼Œä¸è¦çº ç»“è®¾ç½®å¤šå°‘çº¿ç¨‹äº†ã€‚æ²¡æœ‰æ ‡å‡†ç­”æ¡ˆï¼Œä¸€å®šè¦ç»“åˆåœºæ™¯ï¼Œå¸¦ç€ç›®æ ‡ï¼Œé€šè¿‡æµ‹è¯•å»æ‰¾åˆ°ä¸€ä¸ªæœ€åˆé€‚çš„çº¿ç¨‹æ•°ã€‚</strong></p><p>å¯èƒ½ä¼šæœ‰ç–‘é—®ï¼šâ€œæˆ‘ä»¬ç³»ç»Ÿä¹Ÿæ²¡å•¥å‹åŠ›ï¼Œä¸éœ€è¦é‚£ä¹ˆåˆé€‚çš„çº¿ç¨‹æ•°ï¼Œåªæ˜¯ä¸€ä¸ªç®€å•çš„å¼‚æ­¥åœºæ™¯ï¼Œä¸å½±å“ç³»ç»Ÿå…¶ä»–åŠŸèƒ½å°±å¯ä»¥â€</p><p>å¾ˆæ­£å¸¸ï¼Œå¾ˆå¤šçš„å†…éƒ¨ä¸šåŠ¡ç³»ç»Ÿï¼Œå¹¶ä¸éœ€è¦å•¥æ€§èƒ½ï¼Œç¨³å®šå¥½ç”¨ç¬¦åˆéœ€æ±‚å°±å¯ä»¥äº†ã€‚é‚£ä¹ˆæˆ‘çš„æ¨èçš„çº¿ç¨‹æ•°æ˜¯ï¼š<strong>CPUæ ¸å¿ƒæ•°</strong></p><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><h3 id="Java-è·å–CPUæ ¸å¿ƒæ•°"><a href="#Java-è·å–CPUæ ¸å¿ƒæ•°" class="headerlink" title="Java è·å–CPUæ ¸å¿ƒæ•°"></a>Java è·å–CPUæ ¸å¿ƒæ•°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Runtime.getRuntime().availableProcessors()<span class="comment">//è·å–é€»è¾‘æ ¸å¿ƒæ•°ï¼Œå¦‚6æ ¸å¿ƒ12çº¿ç¨‹ï¼Œé‚£ä¹ˆè¿”å›çš„æ˜¯12</span></span><br></pre></td></tr></table></figure><h3 id="Linux-è·å–CPUæ ¸å¿ƒæ•°"><a href="#Linux-è·å–CPUæ ¸å¿ƒæ•°" class="headerlink" title="Linux è·å–CPUæ ¸å¿ƒæ•°"></a>Linux è·å–CPUæ ¸å¿ƒæ•°</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ€»æ ¸æ•° = ç‰©ç†CPUä¸ªæ•° X æ¯é¢—ç‰©ç†CPUçš„æ ¸æ•°</span> </span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ€»é€»è¾‘CPUæ•° = ç‰©ç†CPUä¸ªæ•° X æ¯é¢—ç‰©ç†CPUçš„æ ¸æ•° X è¶…çº¿ç¨‹æ•°</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹ç‰©ç†CPUä¸ªæ•°</span></span><br><span class="line">cat /proc/cpuinfo|grep&quot;physical id&quot;|sort|uniq|wc-l</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹æ¯ä¸ªç‰©ç†CPUä¸­coreçš„ä¸ªæ•°(å³æ ¸æ•°)</span></span><br><span class="line">cat /proc/cpuinfo|grep&quot;cpu cores&quot;|uniq</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹é€»è¾‘CPUçš„ä¸ªæ•°</span></span><br><span class="line">cat /proc/cpuinfo|grep&quot;processor&quot;|wc-l</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> åç«¯ </tag>
            
            <tag> çº¿ç¨‹æ±  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŒ»ç–—å‚ç›´é¢†åŸŸå¤§æ¨¡å‹WiNGPT2çš„éƒ¨ç½²å’Œæ€§èƒ½å¯¹æ¯”</title>
      <link href="/2024/08/06/2024-08-06-WiNGPT2%E7%9A%84%E9%83%A8%E7%BD%B2%E5%92%8C%E6%80%A7%E8%83%BD%E5%AF%B9%E6%AF%94/"/>
      <url>/2024/08/06/2024-08-06-WiNGPT2%E7%9A%84%E9%83%A8%E7%BD%B2%E5%92%8C%E6%80%A7%E8%83%BD%E5%AF%B9%E6%AF%94/</url>
      
        <content type="html"><![CDATA[<h1 id="åŒ»ç–—å‚ç›´é¢†åŸŸå¤§æ¨¡å‹WiNGPT2çš„éƒ¨ç½²å’Œæ€§èƒ½å¯¹æ¯”"><a href="#åŒ»ç–—å‚ç›´é¢†åŸŸå¤§æ¨¡å‹WiNGPT2çš„éƒ¨ç½²å’Œæ€§èƒ½å¯¹æ¯”" class="headerlink" title="åŒ»ç–—å‚ç›´é¢†åŸŸå¤§æ¨¡å‹WiNGPT2çš„éƒ¨ç½²å’Œæ€§èƒ½å¯¹æ¯”"></a>åŒ»ç–—å‚ç›´é¢†åŸŸå¤§æ¨¡å‹WiNGPT2çš„éƒ¨ç½²å’Œæ€§èƒ½å¯¹æ¯”</h1><h2 id="WiNGPT2éƒ¨ç½²å’Œè¿è¡Œ"><a href="#WiNGPT2éƒ¨ç½²å’Œè¿è¡Œ" class="headerlink" title="WiNGPT2éƒ¨ç½²å’Œè¿è¡Œ"></a>WiNGPT2éƒ¨ç½²å’Œè¿è¡Œ</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/winninghealth/WiNGPT2.git</span><br><span class="line">cd WiNGPT2</span><br><span class="line">mkdir winninghealth</span><br><span class="line">cd winninghealth</span><br><span class="line">git clone https://hf-mirror.com/winninghealth/WiNGPT2-7B-Chat</span><br><span class="line">cd ..</span><br></pre></td></tr></table></figure><p>è‹¥æ²¡æœ‰ä»¥ä¸‹è¿™ä¸‰ä¸ªåº“ï¼Œåˆ™å®‰è£…gradioã€tiktokenã€pip install einops flash_attn</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip install gradio</span><br><span class="line">pip install tiktoken</span><br><span class="line">pip install einops flash_attn</span><br></pre></td></tr></table></figure><p>é€‰ä¸€ä¸ªç›®å½•ä½œä¸ºcacheï¼ˆå‰ææ˜¯è¿™ä¸ªç›®å½•å·²ç»å­˜åœ¨ä¸”æœ‰æƒé™è¯»å†™ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é‡åˆ°æŠ¥é”™ [Errno 13] Permission denied: <span class="string">&#x27;/data/.cache/huggingface/modules/transformers_modules/WiNGPT2-7B-Chat&#x27;</span></span></span><br><span class="line">export HF_HOME=&quot;/home/bjtc/verticalLLM/lzrj/WiNGPT2/cache&quot;</span><br></pre></td></tr></table></figure><p>å®‰è£…frpc_linux_amd64</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https://hf-mirror.com/lalazzz/frpc_linux_amd64_v0.2</span><br><span class="line">Rename the downloaded file to: frpc_linux_amd64_v0.2</span><br><span class="line">cp  frpc_linux_amd64_v0.2 /home/bjtc/miniconda3/lib/python3.12/site-packages/gradio</span><br><span class="line">chmod +x /home/bjtc/miniconda3/lib/python3.12/site-packages/gradio/frpc_linux_amd64_v0.2</span><br></pre></td></tr></table></figure><p>set <code>share=True</code>ï¼Œå¹¶è¿è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vi demo.py</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æŒ‰ç…§å¦‚ä¸‹å†…å®¹æ›´æ”¹</span></span><br><span class="line">if __name__ == &quot;__main__&quot;:</span><br><span class="line">    demo.launch(share=True)</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">è¿è¡Œ</span></span><br><span class="line">python demo.py</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/08/06/nEsR3gvLPUS9Kd2.png" alt="image-20240806232203488.png"></p><p>åœ¨public URL: <a href="https://76d07266e8096cd673.gradio.live/">https://76d07266e8096cd673.gradio.live</a> å¯è®¿é—®è¯¥æ¨¡å‹</p><p><img src="https://s2.loli.net/2024/08/06/Y7VUzEtJ3muobBH.png" alt="image-20240806232432361.png"></p><h2 id="æ€§èƒ½å¯¹æ¯”"><a href="#æ€§èƒ½å¯¹æ¯”" class="headerlink" title="æ€§èƒ½å¯¹æ¯”"></a>æ€§èƒ½å¯¹æ¯”</h2><ol><li><p>å‡ºç°æ€¥æ€§å¿ƒè‚Œæ¢—æ­»ä¸€èˆ¬å¯¹èº«ä½“å¸¦æ¥å“ªäº›ä¼¤å®³</p><ul><li>WiNGPT2</li></ul><p>ä¸€ã€åŸºç¡€å¿ƒè¡€ç®¡ç—…å˜ï¼š(1)å† çŠ¶åŠ¨è„‰ç²¥æ ·ç¡¬åŒ–æ–‘å—å½¢æˆï¼šé•¿æœŸçš„è¡€ç®¡å†…çš®ç»†èƒæŸä¼¤å’Œè„‚è´¨ä»£è°¢ç´Šä¹±ä»¥åŠè¡€æ¶²æˆåˆ†æ”¹å˜å¼•èµ·åŠ¨è„‰å£è„‚è‚ªæ²‰ç§¯ï¼Œä½¿ç®¡å£å¢åšå˜ç¡¬ï¼Œå¼¹æ€§å‡å¼±ï¼Œå¹³æ»‘è‚Œç»†èƒåŠç»“ç¼”ç»„ç»‡å¢ç”Ÿï¼Œè¡€å°æ¿åœ¨å±€éƒ¨é»é™„èšé›†ï¼Œé‡Šæ”¾ä¸€ç³»åˆ—å‡è¡€å› å­è€Œå¯¼è‡´è¡€æ “å½¢æˆï¼Œè‡´ä½¿ç®¡è…”ç‹­çª„ã€‚æ ¹æ®è¡€è„‚å‡é«˜çš„ç¨‹åº¦ã€è¡€æ¶²é»æ»åº¦çš„é«˜ä½å’Œå¾®å¾ªç¯éšœç¢æƒ…å†µä¸åŒï¼Œä»¥å·¦å‰é™æ”¯ä¸ºä¾‹ï¼Œä»…5%ï½10%æœ‰ä¸´åºŠç—‡çŠ¶ï¼Œä¸»è¦è¡¨ç°èƒ¸é—·ã€æ°”çŸ­ã€å¿ƒç»ç—›ï¼Œè¿˜æœ‰å¿ƒå¾‹å¤±å¸¸ã€é«˜è¡€å‹ç­‰ã€‚è€Œå¤§çº¦50%å·¦å³çš„ç—…äººæ²¡æœ‰ç—‡çŠ¶ï¼Œè¿™äº›æ‚£è€…åœ¨ç¼ºè¡€å‘ä½œæ—¶ï¼Œå¾ˆéš¾å‡†ç¡®åœ°ä¼°è®¡åˆ°æ˜¯å¿ƒè‚Œä¾›æ°§ä¸è¶³å¯¼è‡´çš„ï¼Œå¸¸å¸¸è®¤ä¸ºè‡ªå·±æ˜¯åœ¨è¿‡åº¦åŠ³ç´¯ã€‚ä¸€éƒ¨åˆ†æ‚£è€…ä»…ä»…è¡¨ç°ä¸ºä¸ç¨³å®šå‹å¿ƒç»ç—›ï¼Œæˆ–æ˜¯æ— ç—›æ€§å¿ƒè‚Œæ¢—æ­»ï¼Œå› ä¸ºè¿™ç±»æ‚£è€…æœ‰å¾®è¡€ç®¡åŠŸèƒ½ä¸å…¨ã€‚è¿˜æœ‰å°‘éƒ¨åˆ†äººåœ¨å‘ç”Ÿå¿ƒè‚Œæ¢—æ­»åè¿˜æ²¡æœ‰è¯Šæ–­å‡ºã€‚(2)å¿ƒè‚Œæ¯›ç»†è¡€ç®¡å¯†åº¦ç›¸å¯¹è¾ƒä½ï¼šæœ‰äººæ›¾åšè¿‡æµ‹å®šï¼Œå‘ç°äººç±»ä¸çµé•¿ç±»åŠ¨ç‰©ä¹‹é—´çš„å¿ƒè‚Œæ¯›ç»†è¡€ç®¡åˆ†å¸ƒè¾ƒæ’å®šï¼Œå…¶ä»–å“ºä¹³åŠ¨ç‰©å¦‚çŠ¬ã€çŒªç­‰åˆ™ä¸ºå¤šå€ï¼Œè€Œçˆ¬è¡Œç±»åŠé¸Ÿç±»åŠ¨ç‰©åˆ™æ˜¯è¾ƒå°‘çš„ï¼Œè¿™è¯´æ˜äº†åŠ¨ç‰©è¿›åŒ–è¿‡ç¨‹ä¸­å¿ƒè„çš„åŠŸèƒ½æœ‰æ‰€é™ä½ï¼Œä¸»è¦æ˜¯ç”±äºå¿ƒè‚Œä¸­æ¯›ç»†è¡€ç®¡åˆ†å¸ƒæ‰€å†³å®šçš„ã€‚å› æ­¤ï¼Œå¿ƒè„å¯¹ç¼ºè¡€è€å—èƒ½åŠ›å·®ã€‚(3)ä¾§æ”¯å¾ªç¯å‘è‚²ä¸è‰¯ï¼šæ‚£å† å¿ƒç—…åï¼Œå¯ä¿ƒä½¿ä»£å¿æ€§çš„ä¾§æ”¯å¾ªç¯å»ºç«‹ï¼Œä»¥å¢åŠ å¿ƒè‚Œä¾›æ°§ã€‚ä½†æ˜¯ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¿ƒè‚Œå†…çš„è¡€æµä¾›åº”åªæ˜¯å‡å°‘ï¼Œè€Œä¸æ˜¯åƒäººä»¬æƒ³è±¡çš„é‚£æ ·é€šè¿‡ä¾§æ”¯å¾ªç¯å¾—ä»¥æ”¹å–„ã€‚å› æ­¤å¯ä»¥è¯´ï¼Œåœ¨å¿ƒè‚Œç¼ºè¡€çš„åŒæ—¶ï¼Œä¹Ÿå¢åŠ äº†å¿ƒè‚Œæ¢—æ­»çš„å±é™©æ€§ã€‚(4)å¾®è¡€ç®¡å µå¡ï¼šå„ç§åŸå› å¼•èµ·çš„å¿ƒè‚Œç¼ºè¡€éƒ½ä¼šå¯¼è‡´æ— å¤æµç°è±¡ã€‚å…¶ä¸­ä¸»è¦åŸå› æ˜¯å¾®è¡€ç®¡å µå¡æ‰€è‡´ã€‚å¦‚æœä¸èƒ½å¾ˆå¿«æ¢å¤ï¼Œå°±å¯èƒ½å¯¼è‡´ç¼ºè¡€éƒ¨ä½åæ­»ï¼Œä»è€Œå½¢æˆé™ˆæ—§æ€§ç˜¢ç—•ã€‚äºŒã€å¿ƒè„ä»¥å¤–çš„å› ç´ ï¼šä¸»è¦ä¸å¿ƒå®¤é¡ºåº”æ€§é™ä½æœ‰å…³ã€‚æ€¥æ€§æœŸåœ¨èˆ’å¼ æ—©æœŸå¼€å§‹ä½å®¹ç§¯å‹åŠ›è´Ÿè·ã€‚éƒ¨åˆ†æ‚£è€…è¿˜åŒæ—¶åˆå¹¶å¤–å‘¨è¡€ç®¡é˜»åŠ›æ˜æ˜¾å¢é«˜ï¼Œåˆ™åœ¨èˆ’å¼ æ—©æœŸå°±å‡ºç°é«˜å®¹ä½å‹è´Ÿè·çŠ¶æ€ã€‚åœ¨å¤šæ•°æ…¢æ€§æœŸæ‚£è€…ï¼Œèˆ’å¼ æ—©æœŸåˆ™ä¸ºæ­£å¸¸çš„ä½å®¹ä½å‹è´Ÿè·çŠ¶æ€ï¼Œè€Œåœ¨æ™šæœŸå¾€å¾€åˆè½¬ä¸ºæ­£å¸¸é«˜å®¹ä½å‹æˆ–é«˜å®¹é«˜å‹è´Ÿè·ã€‚ä¸‰ã€åŸå‘æ€§å’Œç»§å‘æ€§å› ç´ ï¼šåŸå‘æ€§å¿ƒè‚ŒæŸå®³åŒ…æ‹¬è‚¾ä¸Šè…ºç´ èƒ½å¼‚å¸¸ã€å„¿èŒ¶é…šèƒºæ€§æŸå®³ã€ä½“åŠ›è¡°ç«­ã€å†…åˆ†æ³Œç–¾æ‚£ã€é«˜é¾„ç­‰ã€‚è€Œç»§å‘æ€§å¿ƒè‚ŒæŸå®³å¸¸è§äºæ€¥æ€§å¿ƒè‚Œç‚ã€é«˜è¡€å‹ç—…ã€ç³–å°¿ç—…ã€å„ç§ç‚ç—‡å¼•èµ·çš„å‘çƒ­æ€§ç–¾ç—…ã€æ‰‹æœ¯åˆ›ä¼¤ã€äººå·¥ç“£è†œç½®æ¢æœ¯ååŠè¯ç‰©ä¸­æ¯’ç­‰æƒ…å†µã€‚å››ã€å…¨èº«å…¶ä»–å™¨å®˜ç³»ç»Ÿçš„ç›¸äº’å½±å“ï¼šå„ç§å¼•èµ·ä¼‘å…‹ã€æ„ŸæŸ“ã€å¿ƒåŠ›è¡°ç«­ã€ä¸¥é‡è´«è¡€å’Œç”µè§£è´¨ç´Šä¹±çš„æƒ…å†µéƒ½å¯èƒ½åŠ é‡å¿ƒè‚Œç¼ºè¡€çš„ç¨‹åº¦ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé™¤ä¸¥é‡æ„ŸæŸ“æ€§ä¼‘å…‹æˆ–ç»ˆæœ«æœŸè¡°ç«­ç­‰åŸå› ä¹‹å¤–ï¼Œå½“å…¶ä»–é‡è¦å™¨å®˜çš„åŠŸèƒ½å¼‚å¸¸å¾—ä¸åˆ°åŠæ—¶çº æ­£æ—¶ï¼Œå¾€å¾€å¯¼è‡´æ­»äº¡ç‡çš„å‡é«˜ã€‚äº”ã€å±é™©å› ç´ çš„ç›¸äº’ä½œç”¨ï¼šä¸åŒç—…äººå¼•èµ·å¿ƒè‚Œæ¢—æ­»çš„å±é™©å› ç´ çš„ç»„åˆæ˜¯ä¸åŒçš„ã€‚é™¤äº†ä¸ªä½“çš„ä¸åŒä»¥å¤–ï¼Œè®¸å¤šå±é™©å› ç´ è¿˜å¯ä»¥äº’ç›¸ä½œç”¨ã€‚ä¾‹å¦‚ï¼Œè‚¥èƒ–å¯ä»¥é€šè¿‡åŠ é€Ÿèƒ°å²›ç´ åˆ†æ³Œæ°´å¹³å¹¶ä¿ƒè¿›è‚Œè‚‰æ‘„å–è‘¡è„ç³–çš„èƒ½åŠ›å¢å¼ºæ¥æŠµæ¶ˆä½“åŠ›æ´»åŠ¨æ‰€å¢åŠ çš„èƒ½é‡æ¶ˆè€—ï¼ŒåŒæ—¶è¿˜å¯èƒ½åŠ é‡å…¶ä»–å±é™©å› ç´ çš„å±å®³ç¨‹åº¦ï¼Œå¦‚é«˜è¡€å‹ç­‰ã€‚åŒæ ·ï¼Œä½“åŠ›æ´»åŠ¨ä¹Ÿå¯ä»¥å‡è½»ä¸€äº›å…¶ä»–å±é™©å› ç´ çš„å½±å“ï¼Œå¦‚è½»åº¦è¶…é‡è€…é€šè¿‡å¢åŠ ä½“åŠ›æ´»åŠ¨å¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢ä½“è„‚è¿‡é‡çš„å †ç§¯ã€‚äº”ã€ç¥ç»ä½“æ¶²å› ç´ ï¼šæ— è®ºæ˜¯åŠ¨è„‰è¡€å‹å‡é«˜è¿˜æ˜¯é™ä½éƒ½ä¼šä½¿å† è„‰è¡€æµä¸‹é™ã€‚å‹åŠ›æ„Ÿå—å™¨å¯ä»¥è¿…é€Ÿé€šè¿‡è°ƒæ•´è‡ªä¸»ç¥ç»å¼ åŠ›å’Œå¿ƒç‡æ¥å¹³è¡¡åŠ¨è„‰è¡€å‹çš„å˜åŒ–ï¼Œè€Œé™è„‰ç³»ç»Ÿåˆ™ç¼ºä¹è¿™æ ·çš„åé¦ˆæœºåˆ¶ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´åå°„æ€§å¿ƒåŠ¨è¿‡ç¼“ã€‚ä¸ƒã€å¿ƒå®¤é‡æ„ï¼šç”±äºå† å¿ƒç—…æ‚£è€…çš„ç‰¹æ®Šç—…ç†ç”Ÿç†å˜åŒ–ï¼Œéšç€ç—…ç¨‹è¿›å±•ï¼Œä¼šå‡ºç°å¿ƒè‚Œèˆ’ç¼©æ€§èƒ½å‡å¼±ï¼Œè¿›è€Œå¿ƒè„é€æ¸æ‰©å¤§ï¼Œæœ€ç»ˆå‘å±•æˆä¸ºæ”¶ç¼©åŠŸèƒ½ä¸‹é™ç›´è‡³è¡°ç«­ã€‚è¿™ä¸€è¿‡ç¨‹è¢«ç§°ä¸ºâ€œå¿ƒå®¤é‡æ„â€ï¼Œè¿™ä¸€ç—…ç†å˜åŒ–ä¸ºæœ¬ç—‡çš„ç‰¹å¾ä¹‹ä¸€ã€‚ç›®å‰ç ”ç©¶å·²è¯æ˜ï¼Œå¿ƒè‚Œé‡æ„ä¸ä»…æ˜¯å¿ƒè‚Œç¼ºè¡€çš„ä¸€ç§åæœï¼Œè€Œä¸”ä¹Ÿæ˜¯å¤šç§ç–¾ç—…è¿‡ç¨‹ä¸­çš„å…±åŒé€šè·¯ã€‚æ€»ä¹‹ï¼Œæ€¥æ€§å¿ƒè‚Œæ¢—æ­»èµ·ç—…æ€¥éª¤ï¼Œç—…æƒ…å‡¶é™©ï¼Œä¸ç»æ²»ç–—ï¼Œå¹³å‡ç”Ÿå­˜æœŸä»…ä¸º1.76å°æ—¶ã€‚å› æ­¤è¯´æŠ¢æ•‘å¿ƒè‚Œæ¢—æ­»æ˜¯å¿ƒè„ç§‘æ€¥è¯Šçš„é‡è¦å†…å®¹ä¹‹ä¸€ï¼Œè€Œæ€¥æ€§å¿ƒè‚Œæ¢—æ­»å¹¶å‘å¿ƒæºæ€§ä¼‘å…‹ä¹Ÿæ˜¯å±é‡ç—‡åŒ»å­¦é¢†åŸŸæœ€å›°éš¾ã€æœ€é‡è¦çš„åŒ»ç–—æ€¥æ•‘è¯¾é¢˜ä¹‹ä¸€ã€‚</p><p><img src="https://s2.loli.net/2024/08/06/jT8b6EnBw9OuKy4.png" alt="image-20240806232937097.png"></p><ul><li><p>Kimi:</p><p>æ€¥æ€§å¿ƒè‚Œæ¢—æ­»æ˜¯ä¸€ç§ä¸¥é‡çš„å¿ƒè„ç—…ï¼Œé€šå¸¸ç”±å† çŠ¶åŠ¨è„‰è¡€ç®¡å‘ç”ŸåŠ¨è„‰ç²¥æ ·ç¡¬åŒ–ç—…å˜è€Œå¼•èµ·è¡€ç®¡è…”ç‹­çª„æˆ–é˜»å¡ï¼Œé€ æˆå¿ƒè‚Œç¼ºè¡€ã€ç¼ºæ°§æˆ–åæ­»ã€‚è¿™ç§ç—…ç—‡å¯¹èº«ä½“å¸¦æ¥çš„ä¼¤å®³ä¸»è¦åŒ…æ‹¬ï¼š</p><ol><li><p><strong>å¿ƒè‚ŒæŸä¼¤</strong>ï¼šç”±äºå¿ƒè‚Œç»†èƒå¯¹ç¼ºæ°§éå¸¸æ•æ„Ÿï¼Œä¸€æ—¦è¡€æ¶²ä¾›åº”ä¸­æ–­ï¼Œå¿ƒè‚Œç»†èƒä¼šè¿…é€Ÿå—æŸå¹¶å¯èƒ½å‘ç”Ÿåæ­»ã€‚</p></li><li><p><strong>å¿ƒè„åŠŸèƒ½ä¸‹é™</strong>ï¼šå¿ƒè‚Œæ¢—æ­»åï¼Œå¿ƒè„çš„æ³µè¡€èƒ½åŠ›å¯èƒ½å‡å¼±ï¼Œå¯¼è‡´å¿ƒåŠ›è¡°ç«­ï¼Œå½±å“å…¨èº«è¡€æ¶²å¾ªç¯ã€‚</p></li><li><p><strong>å¿ƒå¾‹å¤±å¸¸</strong>ï¼šå¿ƒè‚Œæ¢—æ­»å¯èƒ½å¯¼è‡´å¿ƒè„ç”µç”Ÿç†æ´»åŠ¨å¼‚å¸¸ï¼Œå¼•èµ·å„ç§å¿ƒå¾‹å¤±å¸¸ï¼Œå¦‚å®¤æ€§å¿ƒåŠ¨è¿‡é€Ÿæˆ–å¿ƒå®¤é¢¤åŠ¨ï¼Œè¿™äº›æƒ…å†µå¯èƒ½å±åŠç”Ÿå‘½ã€‚</p></li><li><p><strong>å¿ƒæºæ€§ä¼‘å…‹</strong>ï¼šå¤§é¢ç§¯å¿ƒè‚Œæ¢—æ­»å¯èƒ½å¯¼è‡´å¿ƒè„æ³µè¡€åŠŸèƒ½ä¸¥é‡ä¸è¶³ï¼Œå¼•èµ·å¿ƒæºæ€§ä¼‘å…‹ï¼Œè¿™æ˜¯ä¸€ç§ç”Ÿå‘½å¨èƒçš„ç´§æ€¥æƒ…å†µã€‚</p></li><li><p><strong>å¿ƒç†å½±å“</strong>ï¼šå¿ƒè‚Œæ¢—æ­»ä¸ä»…å¯¹èº«ä½“é€ æˆå½±å“ï¼Œè¿˜å¯èƒ½å¯¹æ‚£è€…çš„å¿ƒç†é€ æˆé‡å¤§å‹åŠ›ï¼Œå¯¼è‡´ç„¦è™‘å’ŒæŠ‘éƒç­‰æƒ…ç»ªé—®é¢˜ã€‚</p></li><li><p><strong>ç”Ÿæ´»è´¨é‡ä¸‹é™</strong>ï¼šå¿ƒè‚Œæ¢—æ­»åï¼Œæ‚£è€…å¯èƒ½éœ€è¦é•¿æœŸæœç”¨è¯ç‰©ï¼Œæ”¹å˜ç”Ÿæ´»æ–¹å¼ï¼Œå¹¶ä¸”å¯èƒ½æ— æ³•æ¢å¤åˆ°ç—…å‰çš„æ´»åŠ¨æ°´å¹³ï¼Œè¿™ä¼šå½±å“æ‚£è€…çš„ç”Ÿæ´»è´¨é‡ã€‚</p></li><li><p><strong>ç»æµè´Ÿæ‹…</strong>ï¼šæ²»ç–—å¿ƒè‚Œæ¢—æ­»éœ€è¦å¤§é‡çš„åŒ»ç–—èµ„æºå’Œé•¿æœŸç®¡ç†ï¼Œè¿™å¯èƒ½ç»™æ‚£è€…åŠå…¶å®¶åº­å¸¦æ¥ç»æµè´Ÿæ‹…ã€‚</p></li><li><p><strong>æ­»äº¡é£é™©</strong>ï¼šå¦‚æœå¿ƒè‚Œæ¢—æ­»æœªå¾—åˆ°åŠæ—¶å’Œé€‚å½“çš„æ²»ç–—ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ‚£è€…æ­»äº¡ã€‚</p></li></ol><p>æ€¥æ€§å¿ƒè‚Œæ¢—æ­»æ˜¯ä¸€ç§éœ€è¦ç´§æ€¥åŒ»ç–—å¹²é¢„çš„ç—…ç—‡ï¼ŒåŠæ—¶è¯†åˆ«ç—‡çŠ¶å¹¶å¯»æ±‚ä¸“ä¸šåŒ»ç–—å¸®åŠ©è‡³å…³é‡è¦ã€‚</p><p><img src="https://s2.loli.net/2024/08/06/OU68iMy9TNA2IqV.png" alt="image-20240806233018948.png"></p></li></ul></li><li><p>è‚è‚¿ç˜¤æŒ‡æ ‡é«˜å°±æ˜¯ç™Œç—‡å—</p><ul><li><p>WiNGPT2</p><p>æœ‰çš„è‚è‚¿ç˜¤æŒ‡æ ‡é«˜å¹¶ä¸ä¸€å®šæ˜¯ç™Œç—‡ï¼Œç™Œç—‡å³æ¶æ€§è‚¿ç˜¤ï¼Œå®ƒæ˜¯æœºä½“åœ¨å„ç§è‡´ç˜¤&#x2F;ä¿ƒç˜¤å› ç´ ä½œç”¨ä¸‹ï¼Œå±€éƒ¨ç»„ç»‡çš„æŸä¸€ä¸ªç»†èƒåœ¨åŸºå› æ°´å¹³ä¸Šå¤±å»å¯¹å…¶ç”Ÿé•¿çš„æ­£å¸¸è°ƒæ§ï¼Œå¯¼è‡´å…¶å…‹éš†æ€§å¼‚å¸¸å¢ç”Ÿè€Œå½¢æˆçš„ç—…å˜ã€‚å­¦ç•Œä¸€èˆ¬å°†ç™Œæœªæ»¡å¹´é¾„é™å®šï¼Œæˆ–ä»è‰¯æ€§å‘æ¶æ€§è½¬å˜é˜¶æ®µçš„è‚¿ç˜¤ç»Ÿç§°ä¸ºâ€œç˜¤â€ï¼Œé€šå¸¸æŒ‡è‚‰çœ¼å¯è§çš„èƒ½å¤Ÿé’»å­”åˆ°è¾¾æµ†è†œé¢çš„é™å±€æ€§ç—…å˜ï¼Œä½†äº¦æœ‰ä¾‹å¤–æƒ…å†µï¼Œä¾‹å¦‚ä¸€äº›è‰¯æ€§ç”²çŠ¶è…ºè‚¿å—åœ¨è‚‰çœ¼è§‚å¯Ÿä¼¼ä¹å¹¶æ— æ·±éƒ¨ä¾µè¢­æ€§ï¼Œä½†æ˜¾å¾®é•œä¸‹å´æœ‰å¯èƒ½æµ¸æ¶¦è‡³é‚»è¿‘ç»„ç»‡æ·±å¤„ï¼›åˆå¦‚å±€é™æ€§çš„è†€èƒ±ä¹³å¤´çŠ¶ç˜¤ç»ç”µç¼åï¼Œå¯åœ¨å½±åƒå­¦ä¸Šæ®‹ç•™å°‘é‡è‚¿ç˜¤ç—•è¿¹ï¼Œå¾…å…¶å¢å¤§åè‚‰çœ¼å¯è§ï¼Œå¹¶èƒ½ä¾µå…¥æ·±å±‚ç»„ç»‡ã€‚ä½“æ£€æ£€æŸ¥ä¸­ä¸€äº›é¡¹ç›®çš„å¼‚å¸¸å¯èƒ½ä¸ç™Œç—‡æœ‰å…³ï¼Œéœ€è¦è¿›ä¸€æ­¥åšç›¸å…³ç­›æŸ¥ç¡®è¯Šã€‚ä¸€èˆ¬æ¥è¯´è‚è‚¿ç˜¤æ ‡å¿—ç‰©é«˜çš„æƒ…å†µä¸‹ä¸èƒ½ç¡®è¯Šæ‚£è€…æ˜¯ä¸æ˜¯æ‚£æœ‰è‚ç™Œï¼Œåªæ˜¯ä¸€ç§è¾…åŠ©è¯Šæ–­çš„å‚è€ƒæŒ‡æ ‡ã€‚å…¶å®ƒè¾…åŠ©æ£€æŸ¥æ¯”å¦‚Bè¶…ã€CTç­‰éœ€è¦ç»“åˆåœ¨ä¸€èµ·çœ‹ã€‚å¾ˆå¤šæ£€æŸ¥éœ€è¦å¤šæ¬¡å¤æŸ¥æ‰æœ‰æ„ä¹‰ï¼Œéœ€é—´éš”ä¸€æ®µæ—¶é—´ï¼Œæ‰èƒ½äº†è§£æ¯”è¾ƒç»“æœæ˜¯å¦æœ‰è¾ƒå¤§å˜åŒ–ã€‚ç¡®è¯Šæ˜¯å¦ä¸ºç™Œç—‡å°šéœ€ä¾é ç—…ç†æ´»æ£€å…ç–«ç»„åŒ–æ˜ç¡®è¯Šæ–­ã€‚æœ‰äº›è‚ç—…æ˜¯é—ä¼ æ€§çš„ï¼Œå®¶æ—å²é‡Œæœ‰è¿™ä¸ªç—…æ‚£è€…ï¼Œé‚£ä¹ˆä¸‹ä¸€ä»£æ˜¯æœ‰ä¸€å®šæ¦‚ç‡ä¹Ÿä¼šå¾—çš„ï¼Œå°±å¦‚ä¹™è‚å¤§ä¸‰é˜³ã€å°ä¸‰é˜³ã€‚å‘ç—…æ—©ï¼šè‚ç—…å‘ç—…æ¯”è¾ƒéšè”½ï¼Œåˆšå¼€å§‹ä¸æ˜“å‘ç°ï¼Œä½†æ˜¯åˆ°äº†åæœŸçš„æ—¶å€™ï¼Œå°±ä¼šå˜å¾—å¾ˆå‰å®³ã€‚å¾ˆå®¹æ˜“å½¢æˆè‚è…¹æ°´ï¼Œè¿™ä¸ªæ—¶å€™ç—…æƒ…å·²ç»å¾ˆä¸¥é‡äº†ã€‚å±å®³äºŒï¼šä¼ æŸ“æ€§é«˜ï¼šä¹™è‚ã€ä¸™è‚ç­‰è‚ç—…å…·æœ‰å¾ˆå¼ºçš„ä¼ æŸ“æ€§ï¼Œè€Œä¸”æ˜“æ¼”å˜ä¸ºæ…¢æ€§ã€éš¾æ²»æ€§è‚ç‚ã€‚å±å®³ä¸‰ï¼šæ¶åŒ–é€Ÿåº¦å¿«ï¼šå› ä¸ºç—…æ¯’å¤åˆ¶ä¸æ–­åˆºæ¿€è‚è„ï¼Œæ—¶é—´ä¹…äº†ä¼šå¼•èµ·è‚è„çš„ç‚ç—‡ååº”ï¼Œå¯¼è‡´è‚è„çº¤ç»´åŒ–ï¼Œè¿™æ˜¯å±äºä¸€ç§ç—…ç†æ”¹å˜ï¼Œçº¤ç»´åŒ–çš„å‡ºç°è¡¨ç¤ºç—…æƒ…æ­£åœ¨æœç€è‚ç¡¬åŒ–çš„æ–¹å‘è½¬å˜ï¼Œæ­¤æ—¶è‹¥æ˜¯ä¸èƒ½å¤ŸåŠæ—¶æ§åˆ¶ç—…æƒ…ï¼Œé‚£å°†æ˜¯è‚ç¡¬åŒ–æˆ–è€…æ˜¯è‚ç™Œï¼Œè¿™ä¸¤ä¸ªç–¾ç—…çš„å‡ºç°ç”Ÿå‘½å°†ä¼šå—åˆ°å¨èƒã€‚</p><p><img src="https://s2.loli.net/2024/08/06/IkUxnHtwQKEWB6f.png" alt="image-20240806233149164.png"></p></li><li><p>Kimi:</p><p>è‚è‚¿ç˜¤æŒ‡æ ‡é«˜å¹¶ä¸ä¸€å®šæ„å‘³ç€æ‚£æœ‰ç™Œç—‡ã€‚è‚¿ç˜¤æŒ‡æ ‡ï¼Œä¹Ÿç§°ä¸ºè‚¿ç˜¤æ ‡å¿—ç‰©ï¼Œæ˜¯ç”¨äºè¯„ä¼°è‚¿ç˜¤å­˜åœ¨å¯èƒ½æ€§çš„ä¸€ç±»ç‰©è´¨ï¼Œå®ƒä»¬å¯èƒ½ç”±è‚¿ç˜¤ç»†èƒåˆæˆé‡Šæ”¾ï¼Œæˆ–åœ¨æœºä½“å¯¹è‚¿ç˜¤ç»†èƒååº”æ—¶å‡é«˜ã€‚ç„¶è€Œï¼Œè‚¿ç˜¤æ ‡å¿—ç‰©çš„å‡é«˜ä¹Ÿå¯è§äºéè‚¿ç˜¤æ€§ç–¾ç—…ï¼Œä¾‹å¦‚ç‚ç—‡ã€æ„ŸæŸ“ï¼Œç”šè‡³ç”Ÿæ´»ä¹ æƒ¯å¦‚ç†¬å¤œã€é…—é…’ç­‰éƒ½å¯èƒ½å¯¼è‡´è‚¿ç˜¤æ ‡å¿—ç‰©å‡é«˜6ã€‚å› æ­¤ï¼Œå•çº¯ä¾æ®è‚¿ç˜¤æ ‡å¿—ç‰©çš„å‡é«˜æ¥è‡ªæˆ‘è¯Šæ–­è‚¿ç˜¤æ˜¯ä¸ç§‘å­¦çš„ã€‚</p><p>åœ¨ä½“æ£€æˆ–èº«ä½“æ£€æŸ¥ä¸­ï¼Œå¦‚æœå‘ç°è‚è„æœ‰è‚¿ç˜¤ï¼Œä¹Ÿä¸ä¸€å®šå°±æ˜¯è‚ç™Œã€‚è‚¿ç˜¤æœ‰è‰¯æ€§å’Œæ¶æ€§ä¹‹åˆ†ï¼Œè‚è„è‚¿ç˜¤å¯ä»¥æ˜¯è‰¯æ€§ç—…å˜ï¼Œå¦‚è‚è¡€ç®¡ç˜¤ã€è‚å›Šè‚¿ç­‰ï¼Œå¹¶ä¸ä¸€å®šä»£è¡¨è‚ç™Œ7ã€‚å½“å‘ç°è‚è„æœ‰è‚¿ç˜¤æ—¶ï¼ŒåŠæ—¶è¿›è¡Œæ˜ç¡®è¯Šæ–­æ˜¯éå¸¸é‡è¦çš„ã€‚</p><p>å¯¹äºè‚è„è‚¿ç˜¤çš„è¯Šæ–­ï¼Œé™¤äº†è‚¿ç˜¤æ ‡å¿—ç‰©ï¼Œè¿˜éœ€è¦ç»“åˆä¸´åºŠç—‡çŠ¶ã€å½±åƒå­¦æ£€æŸ¥ï¼ˆå¦‚è…¹éƒ¨å½©è¶…ã€CTã€MRIï¼‰ç­‰å…¶ä»–æ£€æŸ¥ç»“æœæ¥ç»¼åˆåˆ¤æ–­8ã€‚å¦‚æœå½±åƒå­¦æ£€æŸ¥å‘ç°è‚è„æœ‰å¼‚å¸¸å ä½ï¼Œå¹¶ä¸”è‚¿ç˜¤æ ‡å¿—ç‰©å‡é«˜ï¼ŒåŒ»ç”Ÿä¼šæ ¹æ®å…·ä½“æƒ…å†µå¯èƒ½å»ºè®®è¿›ä¸€æ­¥çš„æ£€æŸ¥ï¼Œå¦‚è‚è„ç©¿åˆºæ´»æ£€ç­‰ï¼Œä»¥è·å¾—ç—…ç†è¯Šæ–­ï¼Œå› ä¸ºç—…ç†è¯Šæ–­æ˜¯ç™Œç—‡è¯Šæ–­çš„é‡‘æ ‡å‡†8ã€‚</p><p>æ­¤å¤–ï¼Œå¯¹äºè‚¿ç˜¤æ ‡å¿—ç‰©çš„æ£€æµ‹ï¼Œè¿ç»­è§‚å¯Ÿå…¶åŠ¨æ€å˜åŒ–æ›´æœ‰æ„ä¹‰ã€‚çªç„¶çš„å‡é«˜å€¼å¾—æ³¨æ„ï¼Œä½†è‚¿ç˜¤æ ‡å¿—ç‰©å‡é«˜æ—¶ä¸å¯è½»æ˜“è¯Šæ–­ä¸ºæ¶æ€§è‚¿ç˜¤ï¼Œéƒ½éœ€è¦ç»“åˆå…¶ä»–ç›¸å…³æ£€æŸ¥ã€ä¸´åºŠç—‡çŠ¶ã€ä½“æ ¼æ£€æŸ¥ç­‰ç»¼åˆåˆ¤æ–­9ã€‚å¦‚æœä¸å±äºé«˜å±äººç¾¤ï¼Œèº«ä½“ä¹Ÿæ²¡æœ‰ä»»ä½•ä¸é€‚ï¼Œè‚¿ç˜¤æ ‡å¿—ç‰©åªæ˜¯è½»åº¦å‡é«˜ï¼Œå¯ä»¥é€‰æ‹©æ”¹å–„ç”Ÿæ´»æ–¹å¼åå†æ¬¡å¤æŸ¥è‚¿ç˜¤æ ‡å¿—ç‰©ï¼Œå¿…è¦æ—¶å¯ä»¥å®Œå–„ç›¸å…³æ£€æŸ¥10ã€‚</p><p>å› æ­¤ï¼Œå¦‚æœä½“æ£€å‘ç°è‚è‚¿ç˜¤æŒ‡æ ‡å‡é«˜ï¼Œå»ºè®®åŠæ—¶å’¨è¯¢ä¸“ä¸šåŒ»ç”Ÿï¼Œè¿›è¡Œè¿›ä¸€æ­¥çš„æ£€æŸ¥å’Œè¯Šæ–­ã€‚åŒæ—¶ï¼Œä¿æŒè‰¯å¥½çš„ç”Ÿæ´»ä¹ æƒ¯ï¼Œé¿å…è¿‡åº¦ç„¦è™‘å’Œææ…Œï¼Œå› ä¸ºè¿™äº›æƒ…ç»ªæœ¬èº«ä¹Ÿå¯èƒ½å½±å“èº«ä½“å¥åº·ã€‚</p><p><img src="https://s2.loli.net/2024/08/06/cYg97nA6fF84klT.png" alt="image-20240806233210994.png"></p></li></ul></li><li><p>ç»å¸¸æ‘‡åŠ¨å©´å„¿ç¡è§‰ä¼šæœ‰ä»€ä¹ˆä¸è‰¯ååº”å—</p><ul><li><p>WiNGPT2</p><p>æœ‰äº›å¦ˆå¦ˆä¸ºäº†è®©å®å®èƒ½æ›´å¿«å…¥ç¡ï¼Œå°±å–œæ¬¢æ‘‡æ™ƒç€å®å®å…¥ç¡ï¼Œå¯¹äºæ²¡ç»éªŒçš„æ–°æ‰‹å¦ˆå¦ˆæ¥è¯´ï¼Œçœ‹åˆ°å®å®å“­é—¹å°±ä¼šä¸‹æ„è¯†çš„å»æ‘‡æ™ƒï¼Œç»“æœå°±æˆäº†ä¹ æƒ¯ï¼Œæ‘‡æ™ƒå®å®ç¡è§‰æ˜¯æœ‰å¾ˆå¤šå±å®³çš„ã€‚ç»å¸¸æ‘‡æ™ƒå®å®ç¡è§‰çš„äº”å¤§å±å®³1ã€å®¹æ˜“è®©å®å®æ‚£ä¸Šè„‘éœ‡è¡å½“ç”¨åŠ›æ‘‡æ™ƒå®å®æ—¶å€™ï¼Œå®å®çš„å¤§è„‘ä¼šå¤„äºè‡ªç”±åŸºæ”»å‡»çš„çŠ¶æ€ï¼Œå®å®é¢…å†…çš„å¤§è„‘æ¯å¤©éƒ½åœ¨ä¸åœå¿«é€Ÿéœ‡åŠ¨ï¼Œè¿™ç§éœ‡åŠ¨ä¼šè®©å®å®å‡ºç°è„‘éœ‡è¡ç”šè‡³è„‘æŸä¼¤çš„ç—‡çŠ¶ã€‚åŒæ—¶è¿˜ä¼šè®©å®å®æ‚£ä¸Šæš‚æ—¶æ€§å¤±èªæˆ–è€…è€³è‹ç­‰ç—‡çŠ¶ï¼Œä¸¥é‡çš„ç”šè‡³ä¼šç•™ä¸‹åé—ç—‡ï¼Œå½±å“å­©å­çš„ä¸€ç”Ÿã€‚2ã€å®¹æ˜“è®©å®å®æ‚£ä¸Šèƒƒå‡ºè¡€å¦‚æœå®¶é•¿æ‘‡æ™ƒå®å®çš„åŠ›åº¦è¿‡å¤§ï¼Œä¼šè®©å®å®åœ¨ç¡çœ è¿‡ç¨‹ä¸­çª’æ¯åˆ°å¼•èµ·æƒŠå¥ã€‚å¼ºçƒˆéœ‡è¡è¿˜ä¼šå¯¼è‡´å®å®å‘•åï¼Œä¸€æ—¦å®å®å‘•åç‰©è¯¯å¸å…¥å‘¼å¸é“ï¼Œå¯èƒ½ä¼šé˜»å¡å®å®å‘¼å¸é€šé“ï¼Œå®å®å‘¼å¸ä¸ç•…å°±ä¼šæŒ£æ‰ã€è¸¢è…¿ï¼Œæœ‰å¯èƒ½ä¼šæŠŠè‡ªå·±çš„è„¸ã€å˜´å·´ã€çœ¼ç›ç­‰æŒ¤ä¼¤æ“¦ä¼¤ï¼Œè¿˜ææœ‰å¯èƒ½ä¼šä½¿å®å®å‡ºç°èƒƒå‡ºè¡€çš„ç—‡çŠ¶ï¼Œè¿™äº›éƒ½æ˜¯å› ä¸ºåœ¨å‰§çƒˆæ‘‡æ™ƒçš„æ—¶å€™ï¼Œå„éƒ¨ä½ä¹‹é—´çš„ç¢°æ’å¼•èµ·çš„ã€‚3ã€å®¹æ˜“è®©å®å®æ‚£ä¸Šå‘¼å¸æš‚åœç»¼åˆå¾å®å®åœ¨ç¡çœ ä¸­çªç„¶è¢«å‰§çƒˆæ‘‡æ™ƒåï¼Œå¤§è„‘å°±ä¼šè¢«å¼ºåˆ¶æ€§æ‹‰æ‰¯ï¼Œè¿™æ ·å°±ä¼šå¢åŠ å¤§è„‘ä¾›è¡€é‡ï¼Œèƒ¸å»“ã€è‚ºã€è¡€æ¶²ä¹‹é—´ä¸ºäº†æ»¡è¶³éœ€æ±‚ä¼šå‘ç”ŸçŸ­æš‚çš„ä¸åè°ƒï¼Œå°±ä¼šå¯¼è‡´å®å®åœ¨ç¡çœ ä¸­çª’æ¯ã€‚è‹¥å®å®å› æŸäº›å› ç´ å­˜åœ¨å‘¼å¸é“ä¸é€šç•…ï¼Œå°±ä¼šå¼•èµ·æ˜æ˜¾çš„æ°”æµå µå¡ï¼Œé€ æˆå®å®å‘¼å¸æš‚åœï¼Œå› ä¸ºå­©å­å‘¼å¸ä¸­æ¢å…´å¥‹æ€§è¾ƒä½ï¼ŒæŠ‘åˆ¶ç¨‹åº¦è¾ƒé«˜ï¼Œç¨æœ‰ç¼ºæ°§ï¼Œå°±è¢«å¤§è„‘æ„ŸçŸ¥åˆ°ï¼Œå¹¶å¼•å‘å‘¼å¸æš‚åœã€‚å³ä½¿ä¸€æ¬¡å‘¼å¸åœæ­¢ä¹Ÿåªæœ‰å‡ ç§’ï¼Œä¸å¤Ÿé•¿çš„æ—¶é—´ä¹Ÿä¸ä¼šäº§ç”Ÿä»»ä½•ç—‡çŠ¶ï¼Œä½†å¦‚æœæŒç»­æ—¶é—´è¾ƒé•¿ï¼Œä¸€åˆ†é’Ÿä»¥ä¸Šå°±ä¼šå‡ºç°ç¼ºæ°§ã€‚æ¯æ¬¡ç¡è§‰å‡ä¼šå‘ç”Ÿå‘¼å¸æš‚åœï¼Œé•¿æ­¤ä»¥å¾€ï¼Œå°±ä¼šå¯¹å®å®çš„èº«ä½“å¥åº·é€ æˆå·¨å¤§çš„ä¼¤å®³ã€‚4ã€å®¹æ˜“å¯¼è‡´å®å®æ‚£ä¸Šç¡çœ éšœç¢ç°åœ¨è®¸å¤šå®¶åº­éƒ½æ˜¯ç‹¬ç”Ÿå­å¥³ï¼Œçˆ¶æ¯éƒ½æ˜¯ååˆ†å® çˆ±å­©å­ï¼Œä»»ç”±å­©å­æƒ³æ€æ ·å°±æ€æ ·ï¼Œå…¶ä¸­å°±æœ‰ä¸å°‘å®¶é•¿å°±å–œæ¬¢æŠ±ç€å®å®ç¡è§‰ï¼Œæ„Ÿè§‰å®å®ç¡ç€äº†å†æ”¾ä¸‹ï¼Œæ®Šä¸çŸ¥æ­£æ˜¯è¿™ä¹ˆåšçš„ä¸å¯¹è¡Œä¸ºï¼Œç»™å®å®å…»æˆäº†é”™è¯¯çš„ä¹ æƒ¯ï¼Œè€Œä¸”åœ¨å©´å„¿æ—¶æœŸå°±å¾—å‡ºäº†â€œæŠ±ç¡â€çš„ç»“è®ºã€‚è€Œä¸”æŠ±ç¡ä¼šä¸¥é‡å½±å“å®å®è‡ªèº«çš„æƒ…ç»ªã€è‡ªèº«è‚¢ä½“çš„æ­£å¸¸å‘è‚²ã€å…¥ç¡æ—¶ä¼´éšçš„æ‰‹èˆè¶³è¹ˆç­‰åŠ¨ä½œéƒ½ä¼šå¹²æ‰°å®å®å¤§è„‘çš„æ­£å¸¸å·¥ä½œã€‚è€Œä¸”æ‘‡æ™ƒç¡è§‰ä¹Ÿä¸æ˜¯ä¸€ä¸ªå¥½çš„åŠæ³•ï¼Œå®å®ç¡è§‰å¯ä»¥ç”¨è¢«å­æŠŠå®å®åŒ…è£¹èµ·æ¥ï¼Œå¤´éƒ¨ç¨å¾®éœ²å‡ºäº›ï¼Œä¸ä½†ä¿æš–è¿˜èƒ½å¸®åŠ©å®å®è¿›å…¥ç¡çœ çŠ¶æ€ã€‚</p><p><img src="https://s2.loli.net/2024/08/06/VrXnFIdNemwayuD.png" alt="image-20240806233306765.png"></p></li><li><p>Kimi:</p><p>ç»å¸¸æ‘‡åŠ¨å©´å„¿ç¡è§‰å¯èƒ½ä¼šå¯¹å®å®çš„å¥åº·å’Œå‘è‚²é€ æˆä¸è‰¯å½±å“ã€‚é¦–å…ˆï¼Œç”±äºå©´å„¿çš„å¤§è„‘å’Œé¢ˆéƒ¨è‚Œè‚‰å°šæœªå®Œå…¨å‘è‚²ï¼Œå‰§çƒˆæˆ–è¿‡åº¦çš„æ‘‡æ™ƒå¯èƒ½å¯¼è‡´æ‰€è°“çš„â€œæ‘‡æ™ƒå©´å„¿ç»¼åˆå¾â€ï¼Œè¿™å¯èƒ½ä¼šå¼•èµ·å¤§è„‘æŸä¼¤ã€è¡€ç®¡æ’•è£‚å’Œè„‘ç¥ç»çº¤ç»´å—æŸï¼Œä¸¥é‡æ—¶ç”šè‡³å¯èƒ½å¯¼è‡´ç˜«ç—ªã€æ­»äº¡æˆ–é—ç•™å‘è‚²è¿Ÿç¼“ã€æ™ºåŠ›ä½ä¸‹ç­‰é—®é¢˜ã€‚æ­¤å¤–ï¼Œè¿‡åº¦ä¾èµ–æ‘‡æ™ƒæ¥å¸®åŠ©å©´å„¿å…¥ç¡ï¼Œå¯èƒ½ä¼šå½±å“å©´å„¿å­¦ä¹ è‡ªä¸»å…¥ç¡çš„èƒ½åŠ›ï¼Œä»è€Œåœ¨æ²¡æœ‰æ‘‡æ™ƒçš„æƒ…å†µä¸‹éš¾ä»¥å…¥ç¡ã€‚</p><p>å¯¹äºå©´å„¿çš„ç¡çœ ç¯å¢ƒï¼Œå»ºè®®æä¾›ä¼˜è´¨çš„ç¡çœ æ¡ä»¶ï¼ŒåŒ…æ‹¬é€‚å®œçš„å£°éŸ³ã€å…‰çº¿ã€ç©ºæ°”ã€æ¸©åº¦å’Œæ¹¿åº¦ï¼Œä»¥å¸®åŠ©å®å®å®‰ç¨³å…¥ç¡ã€‚åŒæ—¶ï¼Œå®¶é•¿åº”é¿å…åœ¨å©´å„¿ç¡å‰è®©ä»–ä»¬ç©å¾—è¿‡äºå…´å¥‹ï¼Œå¸®åŠ©å®å®å…»æˆè§„å¾‹çš„ç¡çœ ä¹ æƒ¯ã€‚å¦‚æœå®å®å·²ç»ä¹ æƒ¯äº†è¢«æ‘‡æ™ƒæ‰èƒ½å…¥ç¡ï¼Œå¯ä»¥å°è¯•é€æ¸å‡å°‘æ‘‡æ™ƒçš„å¼ºåº¦å’Œé¢‘ç‡ï¼Œæˆ–è€…é‡‡å–å…¶ä»–å®‰æŠšæ–¹å¼ï¼Œæ¯”å¦‚è½»è½»æ‹æ‹ã€è¯­è¨€å®‰æŠšæˆ–ä½¿ç”¨å®‰æŠšå·¾ç­‰ï¼Œä»¥å¸®åŠ©å®å®é€æ¸é€‚åº”ä¸ä¾èµ–æ‘‡æ™ƒçš„å…¥ç¡æ–¹å¼ã€‚</p><p>æ€»ä¹‹ï¼Œè™½ç„¶é€‚åº¦çš„æ‘‡æ™ƒæœ‰æ—¶å¯ä»¥å®‰æŠšå©´å„¿ï¼Œä½†ä¸ºäº†é¿å…æ½œåœ¨çš„é£é™©å’ŒåŸ¹å…»è‰¯å¥½çš„ç¡çœ ä¹ æƒ¯ï¼Œå®¶é•¿åº”è°¨æ…ä½¿ç”¨æ‘‡æ™ƒçš„æ–¹å¼ï¼Œå¹¶è€ƒè™‘é‡‡å–å…¶ä»–æ›´å®‰å…¨çš„å®‰æŠšå’Œå…¥ç¡æ–¹æ³•ã€‚</p><p><img src="https://s2.loli.net/2024/08/06/7GK1nFXwSupmvZb.png" alt="image-20240806233329074.png"></p></li></ul></li><li><p>å®å®15ä¸ªæœˆ37.3åº¦ç®—å‘çƒ§å—ï¼Ÿ</p><ul><li><p>WiNGPT2</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œå©´å„¿çš„æ­£å¸¸ä½“æ¸©åœ¨36.5â„ƒ-37.5â„ƒä¹‹é—´ã€‚è€Œå½“å®å®çš„ä½“æ¸©è¶…è¿‡38â„ƒæ—¶ï¼Œåˆ™è¢«è®¤ä¸ºæ˜¯å‘çƒ§ã€‚æ‰€ä»¥æ ¹æ®å®å®çš„ä½“æ¸©æµ‹é‡ç»“æœæ¥çœ‹ï¼Œ37.3â„ƒå¤„äºè½»å¾®å‘çƒ­çŠ¶æ€ï¼Œå±äºè½»åº¦çš„å‘çƒ§ã€‚ä¸è¿‡ï¼Œè¦è€ƒè™‘åˆ°å®å®çš„ä¸ªä½“å·®å¼‚å’Œç¯å¢ƒå› ç´ çš„å½±å“ï¼Œå¦‚æœå®å®æ²¡æœ‰å…¶ä»–ä¸é€‚ç—‡çŠ¶å¹¶ä¸”ç²¾ç¥çŠ¶æ€è‰¯å¥½ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆè§‚å¯Ÿä¸€æ®µæ—¶é—´ï¼Œæ³¨æ„ä¿æŒå®¤å†…é€šé£ï¼Œé€‚å½“ç»™äºˆä¸€äº›ç‰©ç†é™æ¸©çš„æ–¹æ³•ï¼Œæ¯”å¦‚ç”¨æ¸©æ°´æ“¦æ‹­å®å®çš„æ‰‹å¿ƒã€è„šå¿ƒç­‰éƒ¨ä½æ¥å¸®åŠ©æ•£çƒ­ã€‚</p><p><img src="https://s2.loli.net/2024/08/06/lzRXZaHYrC7h8A2.png" alt="image-20240806233418357.png"></p></li><li><p>Kimi:</p><p>å®å®çš„æ­£å¸¸ä½“æ¸©èŒƒå›´é€šå¸¸æ˜¯36.0Â°Cè‡³37.2Â°Cï¼Œè¿™å–å†³äºæµ‹é‡æ–¹æ³•å’Œå®å®çš„å¹´é¾„ã€‚å¯¹äº15ä¸ªæœˆå¤§çš„å®å®æ¥è¯´ï¼Œ37.3Â°Cçš„ä½“æ¸©ç•¥é«˜äºæ­£å¸¸èŒƒå›´çš„ä¸Šé™ï¼Œä½†å¹¶ä¸ä¸€å®šæ„å‘³ç€å®å®å‘çƒ§ã€‚ä½“æ¸©å¯èƒ½ä¼šå› ä¸ºå¤šç§å› ç´ è€Œæ³¢åŠ¨ï¼Œä¾‹å¦‚è¿åŠ¨ã€å“­é—¹ã€åˆšåƒå®Œé¥­æˆ–ç¯å¢ƒæ¸©åº¦ç­‰ã€‚å¦‚æœå®å®çš„ä½“æ¸©è¾¾åˆ°37.3Â°Cï¼Œå¹¶ä¼´æœ‰å…¶ä»–ç—‡çŠ¶ï¼Œå¦‚å¤´ç—›ã€æ— åŠ›ã€è‚Œè‚‰é…¸ç—›ã€å’³å—½ã€æµé¼»æ¶•ç­‰ä¸é€‚æ—¶ï¼Œåˆ™å¯èƒ½æ˜¯å‘çƒ§ï¼Œéœ€è¦åŠæ—¶å°±åŒ»æ²»ç–—ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé€šå¸¸è®¤ä¸ºä½“æ¸©è¶…è¿‡38.5Â°Cæ—¶ï¼Œå¯ä»¥ç»™å­©å­ä½¿ç”¨é€€çƒ§è¯ï¼Œä½†è¿™å¹¶ä¸æ˜¯å”¯ä¸€çš„åˆ¤æ–­æ ‡å‡†ã€‚å¦‚æœå­©å­ä½“æ¸©ä¸åˆ°38.5Â°Cï¼Œä½†å·²ç»å‡ºç°äº†ç²¾ç¥ä¸æŒ¯ã€æ‰“è”«ã€è‚Œè‚‰é…¸ç—›ç­‰è¡¨ç°ï¼Œä¹Ÿå¯ä»¥ç»™å­©å­ä½¿ç”¨é€€çƒ§è¯ã€‚</p><p>å¦‚æœå®å®ä½“æ¸©ç•¥é«˜ä½†æ²¡æœ‰å…¶ä»–ä¸é€‚ç—‡çŠ¶ï¼Œå¯ä»¥å…ˆè§‚å¯Ÿå®å®çš„ä¸€èˆ¬è¡Œä¸ºå’Œååº”ï¼Œç¡®ä¿å®å®æœ‰å……è¶³çš„ä¼‘æ¯å’Œæ°´åˆ†ï¼Œå¦‚æœä½“æ¸©æŒç»­å‡é«˜æˆ–å‡ºç°å…¶ä»–ç—‡çŠ¶ï¼Œåº”åŠæ—¶å’¨è¯¢åŒ»ç”Ÿã€‚</p><p><img src="https://s2.loli.net/2024/08/06/VsyUd7zwaPQIS1e.png" alt="image-20240806233509288.png"></p></li></ul></li><li><p>æ³›å‘å‹ç™½ç™œé£çš„ç—‡çŠ¶è¡¨ç°</p><ul><li><p>WiNGPT2</p><p>çš®æŸä¸ºä¹³ç™½è‰²ï¼Œç™½æ–‘ç•Œé™æ¸…æ¥šï¼Œè‰²ç´ åè§æ¯›å­”ç¼©å°ã€çš®è‚¤èç¼©ç­‰ç—…å˜ã€‚è€Œä¸”æ‚£ç—…çš„éƒ¨ä½ç™½æ–‘å¯é€æ¸æ‰©å¤§æˆ–è€…ç›¸äº’èåˆï¼Œè¿æˆå¤§ç‰‡çš„ä¸è§„åˆ™å½¢çŠ¶ï¼Œä¸¥é‡æ—¶æ¯³æ¯›åŠæ¯›å‘è„±è½ï¼Œæ±—è…ºæ¯›å­”ä¹Ÿéšä¹‹é—­å¡ï¼Œå¤å­£å®¹æ˜“å—åˆ°ç´«å¤–çº¿å¼ºçƒˆç…§å°„ï¼Œäº§ç”Ÿç—‡çŠ¶ä¼šæ›´åŠ ä¸¥é‡ã€‚ç”šè‡³æœ‰çš„æ‚£è€…ä¼šå› æ­¤è€Œæœ‰æ–‘ç§ƒæˆ–è€…å…¨ç§ƒçš„ç°è±¡å‡ºç°ã€‚æ³›å‘å‹ç™½ç™œé£æ˜¯çš®è‚¤ç—…ä¸­å¸¸è§å¤šå‘çš„ç–¾ç—…ä¹‹ä¸€ï¼Œæ—©æœŸæ²¡æœ‰å¾—åˆ°æœ‰æ•ˆçš„æ²»ç–—ä¼šæœ‰ä¸¥é‡çš„å±å®³æ€§ã€‚ä¸¥é‡çš„è¯ä¼šå½±å“è‡ªèº«å½¢è±¡ç¾è§‚ï¼Œç”šè‡³å¯¼è‡´äº”å®˜å¤–è²Œã€æ’å°¿æ„Ÿè§‰ã€ç¥ç»éšœç¢ã€å¹¶å‘ç—‡ç­‰ã€‚é¦–å…ˆç™½ç™œé£æœ€å…¸å‹çš„ç—‡çŠ¶å°±æ˜¯çš®æŸå¯ä»¥å‘ç”Ÿåœ¨å…¨èº«ä»»ä½•éƒ¨ä½ï¼Œä¼šå‘ˆå¯¹ç§°åˆ†å¸ƒã€‚ä¸€èˆ¬æ— è‡ªè§‰ç—‡çŠ¶ï¼Œä½†æ˜¯éƒ¨åˆ†æ‚£è€…çš„å‘ç—…è¿‡ç¨‹ä¼šç›¸å¯¹æ¯”è¾ƒæ…¢ï¼Œä¼šåœ¨ä¸€å¹´å·¦å³ï¼Œæœ‰çš„ç—…æƒ…ä¸¥é‡çš„æ‚£è€…ç”šè‡³å‡ å¹´å°±å¯ä»¥å‘ç”Ÿå…¨èº«çš„å˜ç™½ã€‚é€šå¸¸ä¸ºå¤§å°ä¸ä¸€çš„å±€é™æ€§è„±å¤±æ–‘ï¼Œæ‚£å¤„çš„æ¯›å‘å¯æ­£å¸¸ï¼Œä¹Ÿå¯å˜ç™½ã€‚æ­¤ç§ç–¾ç—…ä¸€èˆ¬å‘ç”Ÿåœ¨æ˜“å—æ‘©æ“¦åŠé˜³å…‰ç…§æ™’çš„æš´éœ²éƒ¨ä½è¾ƒå¤šï¼Œç‰¹åˆ«æ˜¯é¢œé¢éƒ¨ã€é¢ˆéƒ¨ã€è…°è…¹éƒ¨ã€éª¶å°¾å¤„ã€å‰è‡‚ä¼¸é¢ä¸æ‰‹æŒ‡èƒŒéƒ¨ç­‰å¤„ã€‚å…¶æ¬¡æ˜¯çš±è¤¶åŠçš±è¥éƒ¨å¤šå‘ã€‚çš®æŸå¯è§äºå¾ˆå¤šéƒ¨ä½ï¼Œå•ä¾§çš„ç™½æ–‘ä¹Ÿå¯èƒ½ç”±ç¥ç»å› ç´ æ‰€è‡´ï¼Œä»»ä½•å¹´é¾„å‡å¯å‘ç—…ï¼Œä½†ä»¥é’å°‘å¹´ä¸ºä¸»ã€‚æ­¤å¤–æ³›å‘æ€§ç™½ç™œé£çš®æŸå‘ˆçº¯ç™½è‰²åœ†å½¢æˆ–ä¸è§„åˆ™çš„è„±å¤±æ–‘ï¼Œè¡¨é¢å…‰æ»‘ï¼Œè¾¹ç•Œæ¸…æ¥šï¼Œè¾¹ç¼˜è‰²ç´ å¢å¤šã€‚å˜ç™½çš„çš®è‚¤å¯¹æ—¥å…‰è¾ƒæ­£å¸¸çš®è‚¤æ•æ„Ÿï¼Œç¨æ™’å¤ªé˜³å³å‘çº¢ã€‚æ­¤ç—…ä¸€èˆ¬ä¸ä¼šå¼•èµ·ç”²äº¢ã€‚æœ¬ç—…ä¸€èˆ¬æ— è‡ªè§‰ç—‡çŠ¶ï¼Œå°‘æ•°ç—…äººåœ¨å‘ç—…å‰æˆ–åŒæ—¶æœ‰æ‚£å¤„å±€éƒ¨ç˜™ç—’æ„Ÿã€‚ç™½ç™œé£å¸¸ä¼´å…¶ä»–è‡ªèº«å…ç–«æ€§ç–¾ç—…ï¼Œå¦‚ç³–å°¿ç—…ã€ç”²çŠ¶è…ºç–¾ç—…ã€è‚¾ä¸Šè…ºåŠŸèƒ½ä¸å…¨ã€ç¡¬çš®ç—…ã€å¼‚ä½æ€§çš®ç‚ã€æ–‘ç§ƒç­‰å¦‚ä½•é¢„é˜²ï¼šç”±äºç™½ç™œé£åˆèµ·ä¸ºä¸€å°ç‰‡è‰²ç´ å‡é€€æ–‘ï¼Œæ•…è€Œæœ‰æ—¶éš¾ä»¥åŠæ—¶å‘ç°ã€‚ä¸€æ—¦æ‰©æ•£ï¼Œè¯´æ˜ç—…æƒ…å·²è¾ƒä¸ºä¸¥é‡ã€‚æ­¤æ—¶åº”é…åˆåŒ»ç”Ÿï¼Œå°½å¿«åˆ†æç—…å› ï¼Œæ£€æŸ¥å‡ºè‡ªå·±çš„è¿‡æ•åŸï¼Œå¹¶ç§¯æå¯»æ±‚æ²»ç–—æ–¹æ³•ï¼Œå®šæœŸéšè®¿è§‚å¯Ÿã€‚</p><p><img src="https://s2.loli.net/2024/08/06/4CVpq8XGdFeY2MW.png" alt="image-20240806233655111.png"></p></li><li><p>Kimi:</p><p>æ³›å‘å‹ç™½ç™œé£æ˜¯ç™½ç™œé£çš„ä¸€ç§ç±»å‹ï¼Œå…¶ä¸»è¦ç—‡çŠ¶è¡¨ç°ä¸ºçš®è‚¤ä¸Šå‡ºç°å¤šå¤„ç™½æ–‘ï¼Œè¿™äº›ç™½æ–‘çš„æ€»é¢ç§¯é€šå¸¸è¶…è¿‡ä½“è¡¨çš®è‚¤çš„50%ä»¥ä¸Šã€‚è¿™äº›ç™½æ–‘å¯ä»¥å‘ç”Ÿåœ¨èº«ä½“çš„ä»»ä½•éƒ¨ä½ï¼Œå½¢çŠ¶å¯èƒ½æ˜¯åœ†å½¢ã€æ¤­åœ†å½¢æˆ–ä¸è§„åˆ™å½¢ï¼Œé¢œè‰²é€šå¸¸ä¸ºä¹³ç™½è‰²æˆ–ç“·ç™½è‰²ï¼Œè¾¹ç•Œæ¸…æ¥šã€‚æ‚£è€…é€šå¸¸æ— è‡ªè§‰ç—‡çŠ¶ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå‘ç—…å‰æˆ–å‘ç—…åˆæœŸå¯èƒ½ä¼šæœ‰ç‚ç—‡è¡¨ç°ï¼Œå¦‚æ¹¿ç–¹æ ·æˆ–ä½“ç™£æ ·ï¼Œè¿›å±•æœŸå¯èƒ½æœ‰çŸ­æ—¶ç˜™ç—’ã€‚æ³›å‘å‹ç™½ç™œé£çš„ç™½æ–‘åˆ†å¸ƒå¹¿æ³›ï¼Œé€šå¸¸ä»¥ç‰‡çŠ¶å½¢å¼å­˜åœ¨ï¼Œä¸ä¼šå•ä¸ªå­˜åœ¨ï¼Œå¾€å¾€è¿æˆä¸€ç‰‡ï¼Œå½¢çŠ¶ä¸è§„åˆ™ï¼Œçš®æŸå…·æœ‰å¯¹ç§°æ€§ã€‚æ­¤å¤–ï¼Œæ³›å‘å‹ç™½ç™œé£æ‚£è€…å¸¸ä¼´æœ‰æ¯›å‘å˜ç™½ï¼Œå› ä¸ºé»‘è‰²ç´ ç»†èƒå—æŸç¨‹åº¦æ›´ä¸¥é‡ã€‚</p><p>æ³›å‘å‹ç™½ç™œé£çš„å‘ç—…æœºåˆ¶å¤æ‚ï¼Œå¯èƒ½ä¸è‡ªèº«å…ç–«ã€ç²¾ç¥ç¥ç»ã€å†…åˆ†æ³Œç­‰å› ç´ æœ‰å…³ã€‚ç—…ç¨‹è¾ƒé•¿ï¼Œå¤šæ•°æ‚£è€…çš„ç—…æƒ…å¤„äºè¿›å±•æœŸï¼Œæ²»ç–—å¯èƒ½è¾ƒä¸ºå›°éš¾ã€‚å› æ­¤ï¼Œå¯¹æ³›å‘å‹ç™½ç™œé£çš„æ²»ç–—åº”ç»¼åˆåˆ†æå…¶ç—…å› ç—…åŠ¿ï¼Œå°½é‡å¯»æ‰¾å¹¶ç¥›é™¤å¯èƒ½çš„è¯±å‘å› ç´ ã€‚</p><p>åœ¨æ²»ç–—æ–¹é¢ï¼Œæ³›å‘å‹ç™½ç™œé£çš®æŸè¾ƒå°‘è€…å¯ä»¥éµåŒ»å˜±åº”ç”¨ç³–çš®è´¨æ¿€ç´ ã€é’™è°ƒç£·é…¸é…¶æŠ‘åˆ¶å‰‚ã€ç»´ç”Ÿç´ D3è¡ç”Ÿç‰©ç­‰è¯ç‰©æ²»ç–—ï¼Œä¹Ÿå¯ä½¿ç”¨308mmå‡†åˆ†å­æ¿€å…‰æ²»ç–—ï¼Œå‡æœ‰ä¸€å®šçš„ç–—æ•ˆã€‚å¦‚æœçš®æŸè¶…è¿‡ä½“è¡¨é¢ç§¯çš„95%ï¼Œå¯ä»¥è€ƒè™‘ç”¨è„±è‰²æ–¹æ³•æ²»ç–—ï¼Œä½¿è‰²ç´ è„±å¤±ã€‚æ‚£è€…åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­è¿˜éœ€æ³¨æ„é¿å…å¤ªé˜³æš´æ™’ï¼Œä»¥å…å¯¼è‡´ç—…æƒ…åŠ é‡ã€‚</p><p><img src="https://s2.loli.net/2024/08/06/kF4naOV3dwlsS2r.png" alt="image-20240806233723417.png"></p></li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> å¤§æ¨¡å‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> LLM </tag>
            
            <tag> WiNGPT2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ©ç”¨ollamaä¸€é”®å¼éƒ¨ç½²SoulChatå’Œæ€§èƒ½å¯¹æ¯”</title>
      <link href="/2024/08/05/2024-08-05-%E5%88%A9%E7%94%A8ollama%E4%B8%80%E9%94%AE%E5%BC%8F%E9%83%A8%E7%BD%B2SoulChat%E5%92%8C%E6%80%A7%E8%83%BD%E5%AF%B9%E6%AF%94/"/>
      <url>/2024/08/05/2024-08-05-%E5%88%A9%E7%94%A8ollama%E4%B8%80%E9%94%AE%E5%BC%8F%E9%83%A8%E7%BD%B2SoulChat%E5%92%8C%E6%80%A7%E8%83%BD%E5%AF%B9%E6%AF%94/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆ©ç”¨ollamaä¸€é”®å¼éƒ¨ç½²SoulChatå’Œæ€§èƒ½å¯¹æ¯”"><a href="#åˆ©ç”¨ollamaä¸€é”®å¼éƒ¨ç½²SoulChatå’Œæ€§èƒ½å¯¹æ¯”" class="headerlink" title="åˆ©ç”¨ollamaä¸€é”®å¼éƒ¨ç½²SoulChatå’Œæ€§èƒ½å¯¹æ¯”"></a>åˆ©ç”¨ollamaä¸€é”®å¼éƒ¨ç½²SoulChatå’Œæ€§èƒ½å¯¹æ¯”</h1><p><a href="https://github.com/scutcyr/SoulChat">scutcyr&#x2F;SoulChat: ä¸­æ–‡é¢†åŸŸå¿ƒç†å¥åº·å¯¹è¯å¤§æ¨¡å‹SoulChat (github.com)</a></p><p><a href="https://ollama.com/liutechs/soulchatfa">liutechs&#x2F;soulchatfa (ollama.com)</a></p><h2 id="éƒ¨ç½²è¿‡ç¨‹"><a href="#éƒ¨ç½²è¿‡ç¨‹" class="headerlink" title="éƒ¨ç½²è¿‡ç¨‹"></a>éƒ¨ç½²è¿‡ç¨‹</h2><p>é‡‡ç”¨ollamaè¿›è¡Œä¸€é”®å¼éƒ¨ç½²ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ssh bjtc@162.105.16.236</span><br><span class="line">password: 000000</span><br><span class="line">curl -fsSL https://ollama.com/install.sh | sh //ä¸‹è½½ollma</span><br><span class="line">ollama run liutechs/soulchatfa //åˆ©ç”¨ollmaä¸‹è½½SoulChat</span><br></pre></td></tr></table></figure><h2 id="è¿è¡Œå’Œå¯¹æ¯”"><a href="#è¿è¡Œå’Œå¯¹æ¯”" class="headerlink" title="è¿è¡Œå’Œå¯¹æ¯”"></a>è¿è¡Œå’Œå¯¹æ¯”</h2><ol><li><p>å¤±æ‹</p><ul><li><p>SoulChat:</p><p><img src="https://s2.loli.net/2024/08/05/QVSv965RDmeuCgE.png" alt="image-20240805212554946.png"></p></li><li><p>Kimi:</p><p><img src="https://s2.loli.net/2024/08/05/nwCEM1Uhxe8msaF.png" alt="image-20240805213002471.png">2.</p></li></ul></li><li><p>å®¿èˆå…³ç³»</p><ul><li><p>SoulChat:</p><p><img src="https://s2.loli.net/2024/08/05/XGvL31IQ2iPJz5d.png" alt="image-20240805213701972.png"></p></li><li><p>Kimi:</p><p><img src="https://s2.loli.net/2024/08/05/vriSUn8OMwlc2eg.png" alt="image-20240805213927208.png"></p></li></ul></li><li><p>æœŸæœ«è€ƒè¯•</p><ul><li><p>SoulChat</p><p><img src="https://s2.loli.net/2024/08/05/IGpqnC3yHfb5jOs.png" alt="image-20240805214119743.png"></p></li><li><p>Kimi:</p><p><img src="https://s2.loli.net/2024/08/05/F8HajPdV3GYM7wT.png" alt="image-20240805214257800.png"></p></li></ul></li><li><p>ç§‘ç ”å‹åŠ›</p><ul><li><p>SoulChat</p><p><img src="https://s2.loli.net/2024/08/05/p5cPGSdTMiOgyaF.png" alt="image-20240805214426460.png"></p></li><li><p>Kimi:</p><p><img src="https://s2.loli.net/2024/08/05/jJMGLoigN4OBqTX.png" alt="image-20240805214628846.png"></p></li></ul></li><li><p>å®ä¹ å·¥ä½œ</p><ul><li><p>SoulChat</p><p><img src="https://s2.loli.net/2024/08/05/GgFRuD6ezp2Ooqb.png" alt="image-20240805214753078.png"></p></li><li><p>Kimi:</p><p><img src="https://s2.loli.net/2024/08/05/4B5YLU2vWHsVaJ1.png" alt="image-20240805214848335.png"></p></li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> å¤§æ¨¡å‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HuatuoGPT2 </tag>
            
            <tag> Ollama </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RPCå’ŒHttpè¯·æ±‚çš„åŒºåˆ«</title>
      <link href="/2024/08/01/2024-08-01-RPC%E5%92%8CHttp%E8%AF%B7%E6%B1%82%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
      <url>/2024/08/01/2024-08-01-RPC%E5%92%8CHttp%E8%AF%B7%E6%B1%82%E7%9A%84%E5%8C%BA%E5%88%AB/</url>
      
        <content type="html"><![CDATA[<h1 id="RPCå’ŒHttpè¯·æ±‚çš„åŒºåˆ«"><a href="#RPCå’ŒHttpè¯·æ±‚çš„åŒºåˆ«" class="headerlink" title="RPCå’ŒHttpè¯·æ±‚çš„åŒºåˆ«"></a>RPCå’ŒHttpè¯·æ±‚çš„åŒºåˆ«</h1><p>çœ‹è¿™ä¸ªï¼š<a href="https://blog.csdn.net/u013310119/article/details/102566051?ops_request_misc=%7B%22request_id%22:%22172247792816800227491776%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=172247792816800227491776&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-15-102566051-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=rpc%E4%B8%8E%E6%99%AE%E9%80%9Aapi%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%8C%BA%E5%88%AB&spm=1018.2226.3001.4187">RPCç®€ä»‹åŠæ¡†æ¶é€‰æ‹©ï¼ŒRPCä¸RESTçš„åŒºåˆ«_rpcæ§åˆ¶client, clientè¿”å›ä¸»æœºæµ‹è¯•ç»“æœå’ŒçŠ¶æ€-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/huojiao2006/article/details/82186389?ops_request_misc=%7B%22request_id%22:%22172247792816800207041687%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172247792816800207041687&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-82186389-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=rpc%E4%B8%8E%E6%99%AE%E9%80%9Aapi%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%8C%BA%E5%88%AB&spm=1018.2226.3001.4187">RPCã€REST APIæ·±å…¥ç†è§£_rpcä¸æ™®é€šapiæ¥å£çš„åŒºåˆ«-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/gzl0524/article/details/88226215?ops_request_misc=&request_id=&biz_id=102&utm_term=rpc%E4%B8%8E%E6%99%AE%E9%80%9Aapi%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%8C%BA%E5%88%AB&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-88226215.142%5Ev100%5Epc_search_result_base8&spm=1018.2226.3001.4187">å¼„æ¸…æ¥šè¿™äº›æ¥å£(http,https,api,RPC,webservice,Restful api ,OpenAPIï¼‰_rpcæ¥å£å’Œapiæ¥å£-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/qq_35813265/article/details/81945646?ops_request_misc=%7B%22request_id%22:%22172247792816800227491776%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=172247792816800227491776&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-8-81945646-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=rpc%E4%B8%8E%E6%99%AE%E9%80%9Aapi%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%8C%BA%E5%88%AB&spm=1018.2226.3001.4187">restful APIã€SOAPã€RPCçš„åŒºåˆ«_soap apiå’Œrestful apiä¼˜ç¼ºç‚¹-CSDNåšå®¢</a></p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> RPC </tag>
            
            <tag> http </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‚ç±»å¿ƒç†å¥åº·å’¨è¯¢å¤§æ¨¡å‹MeChatçš„éƒ¨ç½²å’Œæ€§èƒ½å¯¹æ¯”</title>
      <link href="/2024/08/01/MeChat/"/>
      <url>/2024/08/01/MeChat/</url>
      
        <content type="html"><![CDATA[<h1 id="å‚ç±»å¿ƒç†å¥åº·å’¨è¯¢å¤§æ¨¡å‹MeChatçš„éƒ¨ç½²å’Œæ€§èƒ½å¯¹æ¯”"><a href="#å‚ç±»å¿ƒç†å¥åº·å’¨è¯¢å¤§æ¨¡å‹MeChatçš„éƒ¨ç½²å’Œæ€§èƒ½å¯¹æ¯”" class="headerlink" title="å‚ç±»å¿ƒç†å¥åº·å’¨è¯¢å¤§æ¨¡å‹MeChatçš„éƒ¨ç½²å’Œæ€§èƒ½å¯¹æ¯”"></a>å‚ç±»å¿ƒç†å¥åº·å’¨è¯¢å¤§æ¨¡å‹MeChatçš„éƒ¨ç½²å’Œæ€§èƒ½å¯¹æ¯”</h1><h2 id="éƒ¨ç½²å’Œè¿è¡Œ"><a href="#éƒ¨ç½²å’Œè¿è¡Œ" class="headerlink" title="éƒ¨ç½²å’Œè¿è¡Œ"></a>éƒ¨ç½²å’Œè¿è¡Œ</h2><p><a href="https://github.com/qiuhuachuan/smile">qiuhuachuan&#x2F;smile: SMILE: Single-turn to Multi-turn Inclusive Language Expansion via ChatGPT for Mental Health Support (github.com)</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/qiuhuachuan/smile.git //å¦‚æœç½‘ç»œä¸è¡Œå°±git clontåˆ°æœ¬åœ°å†scpåˆ°æœåŠ¡å™¨ dataç›®å½•å¯ä»¥å¿½ç•¥æ‰</span><br><span class="line">curl --proto &#x27;=https&#x27; --tlsv1.2 -sSf https://sh.rustup.rs | sh //rust complier ç„¶åè¦é‡æ–°æ‰“å¼€ç»ˆç«¯ å·²æœ‰rust complierå³å¿½ç•¥è¿™æ¡å‘½ä»¤</span><br><span class="line">RUSTUP_TOOLCHAIN=1.72.0 pip install tokenizers==0.13.2 </span><br><span class="line">/*æ‰§è¡Œä¸Šé¢è¿™æ¡å‘½ä»¤ï¼Œå¦‚æœä¸è¿™æ ·åšä¼šæŠ¥é”™ï¼šæŠ¥é”™ï¼šERROR: Could not build wheels for tokenizers, which is required to install pyproject.toml-based projectsæŠ¥é”™ï¼š error: casting `&amp;T` to `&amp;mut T` is undefined behavior, even if the reference is unused, consider instead using an `UnsafeCell`*/</span><br><span class="line">vi requirements.txt </span><br><span class="line">//ä¿®æ”¹requirements.txtä¸­çš„torchç‰ˆæœ¬ä¸º2.2.0ï¼Œè®¾ç½®å®Œå:wq!é€€å‡º</span><br><span class="line">pip install -r requirements.txt .0</span><br><span class="line">export HF_HOME=&quot;~/verticalLLM/lzjr/smile/cache&quot; </span><br><span class="line">export HF_ENDPOINT=https://hf-mirror.com //ä¸´æ—¶æ¢æº</span><br><span class="line">export HF_HUB_OFFLINE=0 //è®¾ç½®çº¿ä¸Šçš„</span><br><span class="line">echo $HF_ENDPOINT</span><br><span class="line">echo $HF_HUB_OFFLINE</span><br><span class="line">/*æ³¨æ„è¿™ä¸ªç›®å½•æ˜¯è¦æœ‰æƒé™æ“ä½œçš„ï¼Œè¿™ä¸€æ­¥çš„ç›®çš„æ˜¯å¦‚æœä¸è¿™æ ·æ“ä½œç›´æ¥è¿è¡ŒMechat.pyä¼šæŠ¥é”™ï¼šæŠ¥é”™ï¼šPermissionError: [Errno 13] Permission denied: &#x27;/data/.cache/huggingface/modules/transformers_modules/THUDM&#x27;*/</span><br><span class="line">python MeChat.py</span><br></pre></td></tr></table></figure><p>å¼€å§‹ä¸‹è½½äº†</p><p><img src="https://s2.loli.net/2024/08/05/wh2Zz8PKacsDitj.png" alt="image-20240801144851595.png"></p><p>åŠ è½½å®Œä¹‹åï¼Œå¼€å§‹è¿è¡Œ</p><p><img src="C:\Users\11505\AppData\Roaming\Typora\typora-user-images\image-20240801150509713.png" alt="image-20240801150509713"></p><h2 id="è¡¨ç°å¯¹æ¯”"><a href="#è¡¨ç°å¯¹æ¯”" class="headerlink" title="è¡¨ç°å¯¹æ¯”"></a>è¡¨ç°å¯¹æ¯”</h2><p>å¯ä»¥çœ‹åˆ°Mechatæ‰©å±•çœŸå®çš„å¿ƒç†äº’åŠ© QAä¸ºå¤šè½®çš„å¿ƒç†å¥åº·æ”¯æŒå¤šè½®å¯¹è¯ï¼Œæé«˜äº†é€šç”¨è¯­è¨€å¤§æ¨¡å‹<strong>åœ¨å¿ƒç†å¥åº·æ”¯æŒé¢†åŸŸèƒ½åŠ›çš„è¡¨ç°</strong>ï¼Œæ›´åŠ ç¬¦åˆåœ¨é•¿ç¨‹å¤šè½®å¯¹è¯çš„åº”ç”¨åœºæ™¯ï¼›è€Œé€šç”¨å¤§æ¨¡å‹å¹¶ä¸èƒ½åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><ol><li><p>äººåˆ°è€å¹´ä¼¼ä¹è¶Šæ¥è¶Šå­¤ç‹¬ï¼Œå­¤ç‹¬ç»ˆè€ä¼šä¸ä¼šå¾ˆå¯æ€œ?</p><ul><li>Mechat</li></ul><p><img src="https://s2.loli.net/2024/08/05/xTKI5NJ7nAYLrkl.png" alt="image-20240801151229766.png"></p><ul><li><p>Kimi</p><p><img src="https://s2.loli.net/2024/08/05/pht1bLAgjqX9eo5.png" alt="image-20240801150931128.png"></p></li></ul></li><li><p>å¼ºè¿«æ€ç»´ä¸¥é‡å½±å“åˆ°æˆ‘çš„å­¦ä¹ ä¸ç”Ÿæ´»è¯¥æ€ä¹ˆåŠï¼Ÿ</p><ul><li><p>Mechat</p><p><img src="https://s2.loli.net/2024/08/05/7W9UflpPNhFoHxv.png" alt="image-20240801151935573.png"></p></li><li><p>Kimi</p><p><img src="https://s2.loli.net/2024/08/05/MAPZIKYgwbr8VFJ.png" alt="image-20240801152555811.png"></p></li></ul></li><li><p>å¥³å„¿10å²åŒå­¦ä¸å’Œå¥¹ç©ï¼Œå¥³å„¿å°±åŠ¨æ‰‹ç…½äº†åŒå­¦çš„è„¸ï¼Ÿå·²ç»æ˜¯ç¬¬äºŒæ¬¡åŠ¨æ‰‹æ‰“äººå®¶ï¼Œä¸Šä¸€æ¬¡ä¹Ÿæ˜¯å› ä¸ºä¸å’Œå¥¹ç©å­©å­æ˜¯ä¸æ˜¯æœ‰å¿ƒç†é—®é¢˜ï¼Ÿ</p><ul><li><p>Mechat</p><p><img src="https://s2.loli.net/2024/08/05/gifxI5j1BqSR87K.png" alt="image-20240801152846135.png"></p></li><li><p>Kimi</p><p><img src="https://s2.loli.net/2024/08/05/hcFbpsLSBrDAQZe.png" alt="image-20240801152902059.png"></p></li></ul></li><li><p>ä¸è®ºç¡å¤šä¹…ï¼Œåªè¦å¼€ä¼šå°±çŠ¯å›°ï¼Œä¸ºä»€ä¹ˆï¼Ÿå·¥ä½œä»¥æ¥ï¼Œå¯¹äºé‚£ç§ä¸æ˜¯åœ¨è§£å†³é—®é¢˜ï¼Œæˆ–è€…æ˜¯æµæ°´è´¦çš„ä¼šè®®ï¼Œå°±ä¸€å®šä¼šçŠ¯å›°ï¼ŒåšæŒä¸è¿‡30åˆ†é’Ÿã€‚æ–°å•ä½æƒ³è½¬æ­£ï¼Œè¯•ç”¨æœŸå¼€ä¼šä¸‰æ¬¡æ‰“ç›¹ä¸‰æ¬¡ï¼Œä½†å®åœ¨æ˜¯å¤ªæ— èŠã€‚æ¯æ¬¡å¼€ä¼šå°±ä¼šç‰¹åˆ«å›°(à®‡Ğ´à®‡; )ï¼Œæ— è¯­ëˆˆ_ëˆˆï¼Œå›°æ­»äº†(à¹‘Ã³ï¹Ã²à¹‘)</p><ul><li><p>Mechat</p><p><img src="https://s2.loli.net/2024/08/05/UPua1j5f6BLteKF.png" alt="image-20240801153110626.png"></p></li><li><p>Kimi</p><p><img src="https://s2.loli.net/2024/08/05/lhbsFokZKade39q.png" alt="image-20240801153232783.png"></p></li></ul></li><li><p>è¿˜æœ‰50å¤©è€ƒç ”éå¸¸æ²¡ä¿¡å¿ƒï¼Œè§‰å¾—æœªæ¥æ¨¡ç³Šå¯¹ä¸èµ·çˆ¶æ¯</p><ul><li><p>Mechat</p><p><img src="https://s2.loli.net/2024/08/05/D9JkYeI2UpzNiZK.png" alt="image-20240801153443487.png"></p></li><li><p>Kimi</p><p><img src="https://s2.loli.net/2024/08/05/SrA5IMCOtQZvkRm.png" alt="image-20240801153555469.png"></p></li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> å¤§æ¨¡å‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MeChat </tag>
            
            <tag> LLM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringBoot Transactionalå’Œ@Transaction</title>
      <link href="/2024/07/31/2024-07-31-SpringBoot-Transactional%E5%92%8C@Transaction/"/>
      <url>/2024/07/31/2024-07-31-SpringBoot-Transactional%E5%92%8C@Transaction/</url>
      
        <content type="html"><![CDATA[<h1 id="SpringBoot-Transactionalå’Œ-Transaction"><a href="#SpringBoot-Transactionalå’Œ-Transaction" class="headerlink" title="SpringBoot Transactionalå’Œ@Transaction"></a>SpringBoot Transactionalå’Œ@Transaction</h1><p><code>TransactionTemplate</code> å’Œ <code>@Transactional</code> éƒ½æ˜¯Springæ¡†æ¶æä¾›ç”¨äºäº‹åŠ¡ç®¡ç†çš„å·¥å…·ï¼Œä½†å®ƒä»¬åœ¨ä½¿ç”¨æ–¹å¼å’Œé€‚ç”¨åœºæ™¯ä¸Šå­˜åœ¨ä¸€äº›åŒºåˆ«ï¼š</p><ol><li><p><strong>ä½¿ç”¨æ–¹å¼</strong>ï¼š</p><ul><li><code>TransactionTemplate</code> æ˜¯ä¸€ä¸ªSpringæ¨¡æ¿ç±»ï¼Œå®ƒæä¾›äº†ä¸€ç§ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†çš„æ–¹æ³•ã€‚ä½¿ç”¨ <code>TransactionTemplate</code> æ—¶ï¼Œä½ éœ€è¦æ˜¾å¼åœ°ç¼–å†™ä»£ç æ¥æ§åˆ¶äº‹åŠ¡çš„å¼€å§‹ã€æäº¤å’Œå›æ»šã€‚</li><li><code>@Transactional</code> æ˜¯ä¸€ä¸ªæ³¨è§£ï¼Œå®ƒæä¾›äº†å£°æ˜å¼äº‹åŠ¡ç®¡ç†çš„æ–¹å¼ã€‚é€šè¿‡åœ¨æ–¹æ³•æˆ–ç±»ä¸Šæ·»åŠ  <code>@Transactional</code> æ³¨è§£ï¼ŒSpring å®¹å™¨ä¼šåœ¨æ–¹æ³•æ‰§è¡Œå‰åè‡ªåŠ¨å¤„ç†äº‹åŠ¡çš„å¼€å§‹å’Œæäº¤ã€‚å¦‚æœæ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œé»˜è®¤æƒ…å†µä¸‹äº‹åŠ¡å°†å›æ»šã€‚</li></ul></li><li><p><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š</p><ul><li><code>TransactionTemplate</code> æ›´é€‚åˆäºé‚£äº›éœ€è¦æ›´ç»†ç²’åº¦æ§åˆ¶äº‹åŠ¡çš„åœºæ™¯ï¼Œä¾‹å¦‚ï¼Œä½ å¯èƒ½éœ€è¦åœ¨äº‹åŠ¡çš„æŸä¸ªé˜¶æ®µæ‰§è¡Œä¸€äº›ç‰¹å®šçš„æ“ä½œï¼Œæˆ–è€…éœ€è¦åœ¨äº‹åŠ¡ä¸­åµŒå¥—ä½¿ç”¨ä¸åŒçš„äº‹åŠ¡ç®¡ç†å™¨ã€‚</li><li><code>@Transactional</code> æ›´é€‚åˆäºå¤§å¤šæ•°ç®€å•çš„ç”¨ä¾‹ï¼Œå…¶ä¸­äº‹åŠ¡çš„è¾¹ç•Œæ¸…æ™°ï¼Œå¹¶ä¸”ä¸éœ€è¦ç¼–ç¨‹å¼çš„äº‹åŠ¡æ§åˆ¶ã€‚</li></ul></li><li><p><strong>ä¾µå…¥æ€§</strong>ï¼š</p><ul><li>ä½¿ç”¨ <code>TransactionTemplate</code> æ—¶ï¼Œäº‹åŠ¡ç®¡ç†ä»£ç ä¸ä¸šåŠ¡é€»è¾‘ä»£ç æ··åˆåœ¨ä¸€èµ·ï¼Œå¯èƒ½ä¼šå¢åŠ ä¸šåŠ¡ä»£ç çš„å¤æ‚æ€§ã€‚</li><li><code>@Transactional</code> ä½œä¸ºæ³¨è§£ï¼Œä¸ä¸šåŠ¡é€»è¾‘åˆ†ç¦»ï¼Œä¿æŒäº†ä»£ç çš„æ¸…æ™°å’Œè§£è€¦ã€‚</li></ul></li><li><p><strong>å¯é‡ç”¨æ€§</strong>ï¼š</p><ul><li><code>TransactionTemplate</code> å¯ä»¥å®ä¾‹åŒ–å¹¶åœ¨å¤šä¸ªåœ°æ–¹é‡ç”¨ï¼Œä¸ºä¸åŒçš„ä¸šåŠ¡é€»è¾‘æä¾›äº‹åŠ¡ç®¡ç†ã€‚</li><li><code>@Transactional</code> ä¸€æ—¦å®šä¹‰ï¼Œå°±å¯ä»¥å¾ˆå®¹æ˜“åœ°åº”ç”¨åˆ°å¤šä¸ªæ–¹æ³•æˆ–æ•´ä¸ªç±»ä¸Šï¼Œæé«˜äº†ä»£ç çš„å¤ç”¨æ€§ã€‚</li></ul></li><li><p><strong>é…ç½®å¤æ‚æ€§</strong>ï¼š</p><ul><li><code>TransactionTemplate</code> éœ€è¦æ›´å¤šçš„é…ç½®å’Œç¼–ç å·¥ä½œæ¥è®¾ç½®äº‹åŠ¡å‚æ•°ï¼Œå¦‚éš”ç¦»çº§åˆ«ã€ä¼ æ’­è¡Œä¸ºç­‰ã€‚</li><li><code>@Transactional</code> å¯ä»¥é€šè¿‡ç®€å•çš„å±æ€§é…ç½®å®ç°å¤æ‚çš„äº‹åŠ¡è®¾ç½®ï¼Œå¦‚ <code>propagation</code>, <code>isolation</code>, <code>timeout</code> ç­‰ã€‚</li></ul></li><li><p><strong>é”™è¯¯å¤„ç†</strong>ï¼š</p><ul><li>ä½¿ç”¨ <code>TransactionTemplate</code> æ—¶ï¼Œå¼€å‘è€…éœ€è¦è‡ªå·±ç®¡ç†äº‹åŠ¡çš„å¼‚å¸¸å’Œé”™è¯¯å¤„ç†ã€‚</li><li><code>@Transactional</code> å…è®¸å¼€å‘è€…é€šè¿‡æ³¨è§£çš„ <code>rollbackFor</code> å’Œ <code>noRollbackFor</code> å±æ€§æ¥æŒ‡å®šå“ªäº›å¼‚å¸¸ç±»å‹ä¼šè§¦å‘äº‹åŠ¡å›æ»šã€‚</li></ul></li><li><p><strong>ä¸Springçš„é›†æˆ</strong>ï¼š</p><ul><li><code>TransactionTemplate</code> ä½œä¸ºSpringæ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œéœ€è¦ä¸Springçš„ApplicationContextç´§å¯†é›†æˆã€‚</li><li><code>@Transactional</code> ä¸Springçš„AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰é›†æˆï¼Œåˆ©ç”¨ä»£ç†æœºåˆ¶æ¥å®ç°äº‹åŠ¡ç®¡ç†ã€‚</li></ul></li></ol><p>æ€»ç»“æ¥è¯´ï¼Œ<code>TransactionTemplate</code> æä¾›äº†æ›´ç»†ç²’åº¦çš„æ§åˆ¶å’Œçµæ´»æ€§ï¼Œé€‚åˆå¤æ‚çš„äº‹åŠ¡åœºæ™¯ï¼Œè€Œ <code>@Transactional</code> æä¾›äº†ä¸€ç§æ›´ç®€å•ã€æ›´å£°æ˜å¼çš„æ–¹æ³•æ¥ç®¡ç†äº‹åŠ¡ï¼Œé€‚åˆå¤§å¤šæ•°æ ‡å‡†ç”¨ä¾‹ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œé€‰æ‹©å“ªä¸€ç§å–å†³äºå…·ä½“éœ€æ±‚å’Œåå¥½ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> SpringBoot </tag>
            
            <tag> äº‹åŠ¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQLåˆ·é¢˜</title>
      <link href="/2024/07/30/2024-07-30-SQL%E5%88%B7%E9%A2%98/"/>
      <url>/2024/07/30/2024-07-30-SQL%E5%88%B7%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h1 id="SQLåˆ·é¢˜"><a href="#SQLåˆ·é¢˜" class="headerlink" title="SQLåˆ·é¢˜"></a>SQLåˆ·é¢˜</h1><p><a href="https://blog.csdn.net/m0_70325779/article/details/132165862?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_utm_term~default-0-132165862-blog-102724773.235%5Ev43%5Epc_blog_bottom_relevance_base7&spm=1001.2101.3001.4242.1&utm_relevant_index=1">æ•°æ®åº“SQLæŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œé¡ºåºæ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ_sqlæŸ¥è¯¢é¡ºåº-CSDNåšå®¢</a></p><h2 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h2><h3 id="whereå’Œhaving"><a href="#whereå’Œhaving" class="headerlink" title="whereå’Œhaving"></a>whereå’Œhaving</h3><p>â€œWhereâ€æ˜¯ä¸€ä¸ªçº¦æŸå£°æ˜ï¼Œåœ¨æŸ¥è¯¢æ•°æ®åº“çš„ç»“æœè¿”å›ä¹‹å‰å¯¹æ•°æ®åº“ä¸­çš„æŸ¥è¯¢æ¡ä»¶è¿›è¡Œçº¦æŸï¼Œå³åœ¨ç»“æœè¿”å›ä¹‹å‰èµ·ä½œç”¨ï¼Œä¸”whereåé¢ä¸èƒ½ä½¿ç”¨â€œèšåˆå‡½æ•°â€ï¼›</p><p>â€œHavingâ€æ˜¯ä¸€ä¸ªè¿‡æ»¤å£°æ˜ï¼Œæ‰€è°“è¿‡æ»¤æ˜¯åœ¨æŸ¥è¯¢æ•°æ®åº“çš„ç»“æœè¿”å›ä¹‹åè¿›è¡Œè¿‡æ»¤ï¼Œå³åœ¨ç»“æœè¿”å›ä¹‹åèµ·ä½œç”¨ï¼Œå¹¶ä¸”havingåé¢å¯ä»¥ä½¿ç”¨â€œèšåˆå‡½æ•°â€ã€‚</p><ul><li><p>ä½¿ç”¨çš„è§’åº¦ï¼š</p><ul><li><p>whereåé¢ä¹‹æ‰€ä»¥ä¸èƒ½ä½¿ç”¨èšåˆå‡½æ•°æ˜¯å› ä¸ºwhereçš„æ‰§è¡Œé¡ºåºåœ¨èšåˆå‡½æ•°ä¹‹å‰ï¼Œ</p><p>å¦‚ä¸‹é¢è¿™ä¸ªsqlè¯­å¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  <span class="built_in">sum</span>(score) <span class="keyword">from</span> student  <span class="keyword">group</span> <span class="keyword">by</span> student.sex <span class="keyword">where</span> <span class="built_in">sum</span>(student.age)<span class="operator">&gt;</span><span class="number">100</span>;</span><br></pre></td></tr></table></figure></li><li><p>havingæ—¢ç„¶æ˜¯å¯¹æŸ¥å‡ºæ¥çš„ç»“æœè¿›è¡Œè¿‡æ»¤ï¼Œé‚£ä¹ˆå°±ä¸èƒ½å¯¹æ²¡æœ‰æŸ¥å‡ºæ¥çš„å€¼ä½¿ç”¨havingï¼Œ</p><p>å¦‚ä¸‹é¢è¿™ä¸ªsqlè¯­å¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span>  student.id,student.name <span class="keyword">from</span> student <span class="keyword">having</span> student.score <span class="operator">&gt;</span><span class="number">90</span>;</span><br></pre></td></tr></table></figure></li></ul></li></ul><p>åœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­èšåˆè¯­å¥(sum,min,max,avg,count)è¦æ¯”havingå­å¥ä¼˜å…ˆæ‰§è¡Œï¼Œè€Œwhereå­å¥åœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­æ‰§è¡Œä¼˜å…ˆçº§åˆ«ä¼˜å…ˆäºèšåˆè¯­å¥(sum,min,max,avg,count)ã€‚<br>ç®€å•è¯´æ¥ï¼š<br>whereå­å¥ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(num) <span class="keyword">as</span> rmb <span class="keyword">from</span> <span class="keyword">order</span> <span class="keyword">where</span> id<span class="operator">&gt;</span><span class="number">10</span></span><br></pre></td></tr></table></figure><p>&#x2F;&#x2F;åªæœ‰å…ˆæŸ¥è¯¢å‡ºidå¤§äº10çš„è®°å½•æ‰èƒ½è¿›è¡Œèšåˆè¯­å¥</p><h3 id="å‡åºé™åº"><a href="#å‡åºé™åº" class="headerlink" title="å‡åºé™åº"></a>å‡åºé™åº</h3><p>å‡åºï¼šasc(ascend)</p><p>é™åºï¼šdesc(descend)</p><h3 id="Union"><a href="#Union" class="headerlink" title="Union"></a>Union</h3><p>[sqlè¯­å¥ä¸­unionçš„ç”¨æ³•_sql union-CSDNåšå®¢](<a href="https://blog.csdn.net/weixin_42383680/article/details/119858753?ops_request_misc=%7B%22request_id%22:%22172242275016800222833310%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172242275016800222833310&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-119858753-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=SQL">https://blog.csdn.net/weixin_42383680/article/details/119858753?ops_request_misc=%7B%22request%5Fid%22%3A%22172242275016800222833310%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172242275016800222833310&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-119858753-null-null.142^v100^pc_search_result_base8&amp;utm_term=SQL</a> union&amp;spm&#x3D;1018.2226.3001.4187)</p><p>unionè”åˆçš„ç»“æœé›†ä¸ä¼šæœ‰é‡å¤å€¼ï¼Œå¦‚æœè¦æœ‰é‡å¤å€¼ï¼Œåˆ™ä½¿ç”¨union all</p><p> unionä¼šè‡ªåŠ¨å‹ç¼©å¤šä¸ªç»“æœé›†åˆä¸­é‡å¤çš„ç»“æœï¼Œä½¿ç»“æœä¸ä¼šæœ‰é‡å¤è¡Œï¼Œunion all ä¼šå°†æ‰€æœ‰çš„ç»“æœå…±å…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥ï¼Œä¸ç®¡æ˜¯ä¸æ˜¯é‡å¤ã€‚</p><p> unionï¼šä¼šå¯¹ä¸¤ä¸ªç»“æœé›†è¿›è¡Œå¹¶é›†æ“ä½œï¼Œä¸åŒ…æ‹¬é‡å¤è¡Œï¼ŒåŒæ—¶è¿›è¡Œé»˜è®¤è§„åˆ™çš„æ’åºã€‚</p><p> union allï¼šå¯¹ä¸¤ä¸ªç»“æœé›†è¿›è¡Œå¹¶é›†æ“ä½œï¼ŒåŒ…æ‹¬é‡å¤è¡Œï¼Œä¸ä¼šå¯¹ç»“æœè¿›è¡Œæ’åºã€‚</p><h3 id="count"><a href="#count" class="headerlink" title="count"></a>count</h3><p>[SQLä¸­COUNT()å‡½æ•°çš„ç”¨æ³•_sqlcountå‡½æ•°çš„ä½¿ç”¨æ–¹æ³•-CSDNåšå®¢](<a href="https://blog.csdn.net/fdggdg/article/details/118757777?ops_request_misc=%7B%22request_id%22:%22172242334216800211564239%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172242334216800211564239&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-118757777-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=sql">https://blog.csdn.net/fdggdg/article/details/118757777?ops_request_misc=%7B%22request%5Fid%22%3A%22172242334216800211564239%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172242334216800211564239&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-118757777-null-null.142^v100^pc_search_result_base8&amp;utm_term=sql</a> count&amp;spm&#x3D;1018.2226.3001.4187)</p><h2 id="177-ç¬¬Né«˜çš„è–ªæ°´"><a href="#177-ç¬¬Né«˜çš„è–ªæ°´" class="headerlink" title="177. ç¬¬Né«˜çš„è–ªæ°´"></a>177. ç¬¬Né«˜çš„è–ªæ°´</h2><p>æ³¨æ„å£°æ˜å‡½æ•°ï¼Œå˜é‡ï¼Œsetçš„è¿‡ç¨‹ï¼Œlimitçš„ç”¨æ³•ï¼Œdistinctçš„ç”¨æ³•ã€‚</p><p>è¿™é‡Œå˜é‡ä¸èƒ½ç›´æ¥N-1å¸¦è¿›å»ï¼Œå¿…é¡»é‡æ–°å£°æ˜ä¸€ä¸ªå˜é‡ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> getNthHighestSalary(N <span class="type">INT</span>) <span class="keyword">RETURNS</span> <span class="type">INT</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"><span class="keyword">DECLARE</span> M <span class="type">INT</span>; </span><br><span class="line">    <span class="keyword">SET</span> M <span class="operator">=</span> N<span class="number">-1</span>; </span><br><span class="line">  <span class="keyword">RETURN</span> (</span><br><span class="line">      <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> salary</span><br><span class="line">      <span class="keyword">FROM</span> Employee</span><br><span class="line">      <span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span></span><br><span class="line">      LIMIT M, <span class="number">1</span></span><br><span class="line">  );</span><br><span class="line"><span class="keyword">END</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="180-è¿ç»­å‡ºç°çš„æ•°å­—"><a href="#180-è¿ç»­å‡ºç°çš„æ•°å­—" class="headerlink" title="180.è¿ç»­å‡ºç°çš„æ•°å­—"></a>180.è¿ç»­å‡ºç°çš„æ•°å­—</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> l1.num <span class="keyword">as</span> ConsecutiveNums</span><br><span class="line"> <span class="keyword">from</span> Logs l1,Logs l2,Logs l3</span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">    l1.id<span class="operator">=</span>l2.id<span class="number">-1</span> </span><br><span class="line">    <span class="keyword">and</span> l1.num<span class="operator">=</span>l2.num</span><br><span class="line">    <span class="keyword">and</span> l1.id<span class="operator">=</span>l3.id<span class="number">-2</span> <span class="keyword">and</span> l1.num<span class="operator">=</span>l3.num</span><br></pre></td></tr></table></figure><h2 id="602-å¥½å‹ç”³è¯·â‘¡ï¼šè°æœ‰æœ€å¤šçš„å¥½å‹"><a href="#602-å¥½å‹ç”³è¯·â‘¡ï¼šè°æœ‰æœ€å¤šçš„å¥½å‹" class="headerlink" title="602.å¥½å‹ç”³è¯·â‘¡ï¼šè°æœ‰æœ€å¤šçš„å¥½å‹"></a>602.å¥½å‹ç”³è¯·â‘¡ï¼šè°æœ‰æœ€å¤šçš„å¥½å‹</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Write your MySQL query statement below</span><br><span class="line"><span class="keyword">select</span> id,num <span class="keyword">from</span></span><br><span class="line">(<span class="keyword">select</span> ids <span class="keyword">as</span> id,<span class="built_in">count</span>(ids) <span class="keyword">as</span> num <span class="keyword">from</span></span><br><span class="line">(<span class="keyword">select</span> requester_id <span class="keyword">as</span> ids  <span class="keyword">from</span> RequestAccepted </span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line"><span class="keyword">select</span> accepter_id <span class="keyword">as</span> ids  <span class="keyword">from</span> RequestAccepted )<span class="keyword">as</span> table1 <span class="keyword">group</span> <span class="keyword">by</span> ids)<span class="keyword">as</span> table2</span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> num <span class="keyword">desc</span> limit <span class="number">0</span>,<span class="number">1</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åšå®¢ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rediså¸¸ç”¨æ“ä½œ</title>
      <link href="/2024/07/29/2024-07-21-Redis%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/"/>
      <url>/2024/07/29/2024-07-21-Redis%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h1 id="Rediså¸¸ç”¨æ“ä½œ"><a href="#Rediså¸¸ç”¨æ“ä½œ" class="headerlink" title="Rediså¸¸ç”¨æ“ä½œ"></a>Rediså¸¸ç”¨æ“ä½œ</h1><table><thead><tr><th>æ•°æ®ç±»å‹</th><th>æ“ä½œ</th><th>é”®ï¼ˆkeyï¼‰ä½ç½®</th><th>å€¼ï¼ˆvalueï¼‰ä½ç½®</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>String</td><td>GET</td><td>ç›´æ¥ä½¿ç”¨é”®å</td><td>é”®å¯¹åº”çš„å­—ç¬¦ä¸²å€¼</td><td><code>GET mykey</code></td></tr><tr><td></td><td>SET</td><td>ç›´æ¥ä½¿ç”¨é”®å</td><td>è¦è®¾ç½®çš„å­—ç¬¦ä¸²å€¼</td><td><code>SET mykey &quot;Hello World&quot;</code></td></tr><tr><td></td><td>DEL</td><td>ç›´æ¥ä½¿ç”¨é”®å</td><td>æ— ï¼ˆæ“ä½œæ˜¯åˆ é™¤ï¼‰</td><td><code>DEL mykey</code></td></tr><tr><td></td><td>INCR</td><td>ç›´æ¥ä½¿ç”¨é”®å</td><td>é”®çš„æ•´æ•°å€¼ï¼ˆè‡ªåŠ¨å¢åŠ 1ï¼‰</td><td><code>INCR mykey</code></td></tr><tr><td></td><td>DECR</td><td>ç›´æ¥ä½¿ç”¨é”®å</td><td>é”®çš„æ•´æ•°å€¼ï¼ˆè‡ªåŠ¨å‡å°‘1ï¼‰</td><td><code>DECR mykey</code></td></tr><tr><td>Hash</td><td>HGET</td><td>å“ˆå¸Œå</td><td>å“ˆå¸Œå­—æ®µå</td><td><code>HGET myhash field1</code></td></tr><tr><td></td><td>HSET</td><td>å“ˆå¸Œå</td><td>å“ˆå¸Œå­—æ®µåå’Œå€¼</td><td><code>HSET myhash field1 &quot;value1&quot;</code></td></tr><tr><td></td><td>HDEL</td><td>å“ˆå¸Œå</td><td>å“ˆå¸Œå­—æ®µå</td><td><code>HDEL myhash field1</code></td></tr><tr><td></td><td>HGETALL</td><td>å“ˆå¸Œå</td><td>æ— ï¼ˆè¿”å›æ‰€æœ‰å­—æ®µå’Œå€¼ï¼‰</td><td><code>HGETALL myhash</code></td></tr><tr><td>List</td><td>LPUSH</td><td>åˆ—è¡¨å</td><td>è¦æ¨å…¥çš„å€¼</td><td><code>LPUSH mylist &quot;item1&quot;</code></td></tr><tr><td></td><td>RPUSH</td><td>åˆ—è¡¨å</td><td>è¦æ¨å…¥çš„å€¼</td><td><code>RPUSH mylist &quot;item1&quot;</code></td></tr><tr><td></td><td>LPOP</td><td>åˆ—è¡¨å</td><td>æ— ï¼ˆæ“ä½œæ˜¯å¼¹å‡ºï¼‰</td><td><code>LPOP mylist</code></td></tr><tr><td></td><td>RPOP</td><td>åˆ—è¡¨å</td><td>æ— ï¼ˆæ“ä½œæ˜¯å¼¹å‡ºï¼‰</td><td><code>RPOP mylist</code></td></tr><tr><td></td><td>LRANGE</td><td>åˆ—è¡¨å</td><td>èµ·å§‹å’Œç»“æŸç´¢å¼•</td><td><code>LRANGE mylist 0 2</code></td></tr><tr><td>Set</td><td>SADD</td><td>é›†åˆå</td><td>è¦æ·»åŠ çš„å…ƒç´ </td><td><code>SADD myset item1</code></td></tr><tr><td></td><td>SREM</td><td>é›†åˆå</td><td>è¦åˆ é™¤çš„å…ƒç´ </td><td><code>SREM myset item1</code></td></tr><tr><td></td><td>SMEMBERS</td><td>é›†åˆå</td><td>æ— ï¼ˆè¿”å›æ‰€æœ‰å…ƒç´ ï¼‰</td><td><code>SMEMBERS myset</code></td></tr><tr><td></td><td>SISMEMBER</td><td>é›†åˆåå’Œå…ƒç´ </td><td>æ— ï¼ˆæ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨ï¼‰</td><td><code>SISMEMBER myset item1</code></td></tr><tr><td>Sorted Set</td><td>ZADD</td><td>æœ‰åºé›†åˆå</td><td>æˆå‘˜å’Œåˆ†æ•°</td><td><code>ZADD myzset 3.0 item1</code></td></tr><tr><td></td><td>ZREM</td><td>æœ‰åºé›†åˆå</td><td>è¦åˆ é™¤çš„æˆå‘˜</td><td><code>ZREM myzset item1</code></td></tr><tr><td></td><td>ZRANGE</td><td>æœ‰åºé›†åˆå</td><td>èµ·å§‹å’Œç»“æŸç´¢å¼•</td><td><code>ZRANGE myzset 0 2</code></td></tr><tr><td></td><td>ZREVRANGE</td><td>æœ‰åºé›†åˆå</td><td>èµ·å§‹å’Œç»“æŸç´¢å¼•</td><td><code>ZREVRANGE myzset 0 2</code></td></tr><tr><td></td><td>ZSCORE</td><td>æœ‰åºé›†åˆå</td><td>æˆå‘˜å</td><td><code>ZSCORE myzset item1</code></td></tr></tbody></table><h3 id="è¯´æ˜ï¼š"><a href="#è¯´æ˜ï¼š" class="headerlink" title="è¯´æ˜ï¼š"></a>è¯´æ˜ï¼š</h3><ul><li><strong>String</strong>ï¼šç®€å•çš„å­—ç¬¦ä¸²é”®å€¼å¯¹ã€‚</li><li><strong>Hash</strong>ï¼šé”®å€¼å¯¹é›†åˆï¼Œå…¶ä¸­é”®æ˜¯å“ˆå¸Œåï¼Œå€¼æ˜¯å­—æ®µåå’Œå­—æ®µå€¼ã€‚</li><li><strong>List</strong>ï¼šæœ‰åºé›†åˆï¼Œé”®æ˜¯åˆ—è¡¨åï¼Œå€¼æ˜¯åˆ—è¡¨ä¸­çš„å…ƒç´ ã€‚</li><li><strong>Set</strong>ï¼šæ— åºé›†åˆï¼Œé”®æ˜¯é›†åˆåï¼Œå€¼æ˜¯é›†åˆä¸­çš„å…ƒç´ ã€‚</li><li><strong>Sorted Set</strong>ï¼šæœ‰åºé›†åˆï¼Œé”®æ˜¯æœ‰åºé›†åˆåï¼Œå€¼æ˜¯æˆå‘˜å’Œæˆå‘˜çš„åˆ†æ•°ã€‚</li></ul><p>è¿™äº›æ“ä½œå’Œç¤ºä¾‹å¯ä»¥å¸®åŠ©ä½ ç†è§£å¦‚ä½•åœ¨ Redis ä¸­ä½¿ç”¨ä¸åŒçš„æ•°æ®ç±»å‹è¿›è¡ŒåŸºæœ¬æ“ä½œã€‚</p><p>åœ¨ Redis çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œç‰¹åˆ«æ˜¯åœ¨ Hash æ•°æ®ç±»å‹çš„æ“ä½œä¸­ï¼Œâ€fieldâ€ æŒ‡çš„æ˜¯å“ˆå¸Œè¡¨ä¸­çš„å­—æ®µåï¼Œå®ƒä¸ â€œvalueâ€ï¼ˆå€¼ï¼‰ä¸€èµ·æ„æˆäº†å“ˆå¸Œè¡¨ä¸­çš„ä¸€ä¸ªé”®å€¼å¯¹ã€‚Hash ç±»å‹åœ¨ Redis ä¸­ç”¨äºå­˜å‚¨å¯¹è±¡æˆ–è€…æ˜ å°„ï¼ˆmapï¼‰ï¼Œå…¶ä¸­æ¯ä¸ªå¯¹è±¡æˆ–æ˜ å°„é¡¹ç”±ä¸€ä¸ªå­—æ®µåå’Œå¯¹åº”çš„å€¼ç»„æˆã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€äº› Hash æ•°æ®ç±»å‹çš„æ“ä½œç¤ºä¾‹ï¼Œä»¥å±•ç¤º â€œfieldâ€ çš„ä½¿ç”¨ï¼š</p><ul><li><p><code>HSET myhash username &quot;JohnDoe&quot;</code>ï¼šåœ¨è¿™ä¸ªæ“ä½œä¸­ï¼Œ<code>myhash</code> æ˜¯å“ˆå¸Œåï¼ˆkeyï¼‰ï¼Œ<code>username</code> æ˜¯å­—æ®µåï¼ˆfieldï¼‰ï¼Œ<code>&quot;JohnDoe&quot;</code> æ˜¯ä¸å­—æ®µåç›¸å…³è”çš„å€¼ï¼ˆvalueï¼‰ã€‚</p></li><li><p><code>HGET myhash username</code>ï¼šè¿™é‡Œï¼Œ<code>myhash</code> æ˜¯å“ˆå¸Œåï¼Œ<code>username</code> æ˜¯æˆ‘ä»¬è¦è·å–çš„å­—æ®µåã€‚æ“ä½œçš„ç›®çš„æ˜¯è·å–ä¸ <code>username</code> å­—æ®µåå…³è”çš„å€¼ã€‚</p></li><li><p><code>HDEL myhash username</code>ï¼šåœ¨è¿™ä¸ªåˆ é™¤æ“ä½œä¸­ï¼Œ<code>myhash</code> æ˜¯å“ˆå¸Œåï¼Œ<code>username</code> æ˜¯è¦åˆ é™¤çš„å­—æ®µåã€‚</p></li><li><p><code>HGETALL myhash</code>ï¼šè¿™ä¸ªæ“ä½œè¿”å›å“ˆå¸Œ <code>myhash</code> ä¸­æ‰€æœ‰çš„å­—æ®µå’Œå€¼ã€‚è¿”å›çš„ç»“æœæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œå…¶ä¸­æ¯ä¸ªå­—æ®µåå’Œå€¼äº¤æ›¿å‡ºç°ã€‚</p></li></ul><p>åœ¨ Hash æ•°æ®ç±»å‹ä¸­ï¼Œå­—æ®µåï¼ˆfieldï¼‰å¯ä»¥æ˜¯å­—ç¬¦ä¸²ï¼Œè€Œä¸”ä¸€ä¸ªå“ˆå¸Œå¯ä»¥åŒ…å«å¤šä¸ªè¿™æ ·çš„å­—æ®µå’Œå€¼å¯¹ã€‚è¿™ä½¿å¾— Hash æˆä¸ºå­˜å‚¨å…·æœ‰å¤šä¸ªå±æ€§çš„å¯¹è±¡ï¼ˆå¦‚ç”¨æˆ·ä¿¡æ¯ã€é…ç½®è®¾ç½®ç­‰ï¼‰çš„ç†æƒ³é€‰æ‹©ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> Redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åç«¯ </tag>
            
            <tag> å¾®æœåŠ¡ </tag>
            
            <tag> Redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Dockerå‘½ä»¤_å„ç§å‚æ•°ç®€ä»‹</title>
      <link href="/2024/07/27/Docker%E5%91%BD%E4%BB%A4_%E5%90%84%E7%A7%8D%E5%8F%82%E6%95%B0%E7%AE%80%E4%BB%8B/"/>
      <url>/2024/07/27/Docker%E5%91%BD%E4%BB%A4_%E5%90%84%E7%A7%8D%E5%8F%82%E6%95%B0%E7%AE%80%E4%BB%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="Dockerå‘½ä»¤-å„ç§å‚æ•°ç®€ä»‹"><a href="#Dockerå‘½ä»¤-å„ç§å‚æ•°ç®€ä»‹" class="headerlink" title="Dockerå‘½ä»¤_å„ç§å‚æ•°ç®€ä»‹"></a>Dockerå‘½ä»¤_å„ç§å‚æ•°ç®€ä»‹</h1><h2 id="run"><a href="#run" class="headerlink" title="run"></a>run</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">docker run [OPTIONS] IMAGE [COMMOND] [ARGS...]</span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">OPTIONS è¯´æ˜</span></span><br><span class="line">--name=&quot;å®¹å™¨æ–°åå­—&quot;: ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåç§°ï¼›</span><br><span class="line">-d: åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨IDï¼Œä¹Ÿå³å¯åŠ¨å®ˆæŠ¤å¼å®¹å™¨ï¼›</span><br><span class="line">-iï¼šä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸ -t åŒæ—¶ä½¿ç”¨ï¼›</span><br><span class="line">-tï¼šä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸ -i åŒæ—¶ä½¿ç”¨ï¼›</span><br><span class="line">-P: éšæœºç«¯å£æ˜ å°„ï¼›</span><br><span class="line">-p: æŒ‡å®šç«¯å£æ˜ å°„ï¼Œæœ‰ä»¥ä¸‹å››ç§æ ¼å¼</span><br><span class="line">      ip:hostPort:containerPort</span><br><span class="line">      ip::containerPort</span><br><span class="line">      hostPort:containerPort</span><br><span class="line">      containerPort</span><br><span class="line">    -w: æŒ‡å®šå‘½ä»¤æ‰§è¡Œæ—¶ï¼Œæ‰€åœ¨çš„è·¯å¾„</span><br><span class="line"> </span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">IMAGE</span></span><br><span class="line">XXX_IMAGE_NAME:XXX_IMAGE_VER</span><br><span class="line"> </span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">COMAND</span></span><br><span class="line">ä¾‹ï¼šmvn -Duser.home=xxx -B clean package -Dmaven.test.skip=true</span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¸¸ç”¨OPTIONSè¡¥è¶³ï¼š</span></span><br><span class="line">--nameï¼šå®¹å™¨åå­—</span><br><span class="line">--networkï¼šæŒ‡å®šç½‘ç»œ</span><br><span class="line">--rmï¼šå®¹å™¨åœæ­¢è‡ªåŠ¨åˆ é™¤å®¹å™¨</span><br><span class="line"> </span><br><span class="line">-iï¼š--interactive,äº¤äº’å¼å¯åŠ¨</span><br><span class="line">-tï¼š--ttyï¼Œåˆ†é…ç»ˆç«¯</span><br><span class="line">-vï¼š--volume,æŒ‚åœ¨æ•°æ®å·</span><br><span class="line">-dï¼š--detachï¼Œåå°è¿è¡Œ</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åœ¨å·²è¿è¡Œçš„å®¹å™¨ä¸­è¿è¡Œå‘½ä»¤</span></span><br><span class="line">docker exec [OPTIONS] CONTAINER COMMAND [ARGâ€¦]</span><br><span class="line">å¸¸ç”¨é€‰é¡¹ï¼š</span><br><span class="line">  -dï¼š--detach ï¼Œåå°è¿è¡Œå‘½ä»¤</span><br><span class="line">  -e, --env list             è®¾ç½®env</span><br><span class="line">  -i, --interactive         å¯ç”¨äº¤äº’å¼</span><br><span class="line">  -t, --tty                     å¯ç”¨ç»ˆç«¯</span><br><span class="line">  -u, --user string        æŒ‡å®šç”¨æˆ· (æ ¼å¼: &lt;name|uid&gt;[:&lt;group|gid&gt;])</span><br><span class="line">  -w, --workdir string       æŒ‡å®šå·¥ä½œç›®å½•</span><br></pre></td></tr></table></figure><h2 id="docker-v-æŒ‚è½½"><a href="#docker-v-æŒ‚è½½" class="headerlink" title="docker -v æŒ‚è½½"></a>docker -v æŒ‚è½½</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">è­¬å¦‚æˆ‘è¦å¯åŠ¨ä¸€ä¸ªcentoså®¹å™¨ï¼Œå®¿ä¸»æœºçš„/testç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„/softç›®å½•ï¼Œå¯é€šè¿‡ä»¥ä¸‹æ–¹å¼æŒ‡å®šï¼š</span></span><br><span class="line"> </span><br><span class="line">docker run -it -v /test:/soft centos /bin/bash</span><br><span class="line"><span class="meta prompt_"> </span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å†’å·<span class="string">&quot;:&quot;</span>å‰é¢çš„ç›®å½•æ˜¯å®¿ä¸»æœºç›®å½•ï¼Œåé¢çš„ç›®å½•æ˜¯å®¹å™¨å†…ç›®å½•ã€‚</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="å…¶ä»–å¸¸ç”¨"><a href="#å…¶ä»–å¸¸ç”¨" class="headerlink" title="å…¶ä»–å¸¸ç”¨"></a>å…¶ä»–å¸¸ç”¨</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">================================</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æŸ¥çœ‹dockeræœåŠ¡è¿è¡ŒçŠ¶å†µ</span></span><br><span class="line"></span><br><span class="line">ps -el | grep -i docker</span><br><span class="line"></span><br><span class="line">-</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">åœæ­¢DockeræœåŠ¡</span></span><br><span class="line">service docker stop</span><br><span class="line"></span><br><span class="line">-</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">å¯åŠ¨dockeræœåŠ¡</span></span><br><span class="line"></span><br><span class="line">service docker start</span><br><span class="line"></span><br><span class="line">================================</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æŸ¥çœ‹æœ‰å“ªäº›é•œåƒ</span></span><br><span class="line">docker search yourAppName</span><br><span class="line"></span><br><span class="line">-</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">è·å–é•œåƒ</span></span><br><span class="line">docker pull imageName</span><br><span class="line"></span><br><span class="line">-</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æŸ¥çœ‹å®‰è£…äº†çš„é•œåƒ</span></span><br><span class="line">docker images</span><br><span class="line"></span><br><span class="line">-</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æŸ¥çœ‹è¿è¡Œçš„å®¹å™¨</span></span><br><span class="line">docker ps</span><br><span class="line"></span><br><span class="line">-</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æŸ¥çœ‹æ‰€æœ‰çš„å®¹å™¨</span></span><br><span class="line">docker ps -a</span><br><span class="line"></span><br><span class="line">-</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">åœæ­¢å®¹å™¨è¿è¡Œ</span></span><br><span class="line">docker stop &lt;container_id&gt;</span><br><span class="line"></span><br><span class="line">-</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">é‡æ–°å¯åŠ¨å®¹å™¨</span></span><br><span class="line">docker resatart &lt;container_id&gt;</span><br><span class="line"></span><br><span class="line">-</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">åˆ é™¤å®¹å™¨</span></span><br><span class="line">docker rm yourContainerID </span><br><span class="line"></span><br><span class="line">-</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">åˆ é™¤é•œåƒ</span></span><br><span class="line">docker rmi yourImageName</span><br><span class="line"></span><br><span class="line">-</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æŸ¥çœ‹å®¹å™¨å¼€å¯æ—¶çš„<span class="built_in">log</span></span></span><br><span class="line">docker logs -f yourContainerName</span><br><span class="line"></span><br><span class="line">-</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">è¿›å…¥å®¹å™¨å†…éƒ¨æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line">docker exec -it yourContainerID bash</span><br><span class="line"></span><br><span class="line">ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æŸ¥çœ‹Log</span></span><br><span class="line">docker logs -f &lt;image_name&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ©ç”¨ollamaä¸€é”®å¼éƒ¨ç½²HuatuoGPT2å’Œä½¿ç”¨</title>
      <link href="/2024/07/26/HuatuoGPT2/"/>
      <url>/2024/07/26/HuatuoGPT2/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆ©ç”¨ollamaä¸€é”®å¼éƒ¨ç½²HuatuoGPT2å’Œä½¿ç”¨"><a href="#åˆ©ç”¨ollamaä¸€é”®å¼éƒ¨ç½²HuatuoGPT2å’Œä½¿ç”¨" class="headerlink" title="åˆ©ç”¨ollamaä¸€é”®å¼éƒ¨ç½²HuatuoGPT2å’Œä½¿ç”¨"></a>åˆ©ç”¨ollamaä¸€é”®å¼éƒ¨ç½²HuatuoGPT2å’Œä½¿ç”¨</h1><p><a href="https://ollama.com/killgfat/huatuogpt2">killgfat&#x2F;huatuogpt2 (ollama.com)</a></p><h2 id="éƒ¨ç½²è¿‡ç¨‹"><a href="#éƒ¨ç½²è¿‡ç¨‹" class="headerlink" title="éƒ¨ç½²è¿‡ç¨‹"></a>éƒ¨ç½²è¿‡ç¨‹</h2><p>é‡‡ç”¨ollamaè¿›è¡Œä¸€é”®å¼éƒ¨ç½²ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ssh bjtc@162.105.16.236</span><br><span class="line">password: 000000</span><br><span class="line">curl -fsSL https://ollama.com/install.sh | sh //ä¸‹è½½ollma</span><br><span class="line">ollama run killgfat/huatuogpt2 //åˆ©ç”¨ollmaä¸‹è½½huatuogpt2</span><br></pre></td></tr></table></figure><h2 id="è¿è¡Œå’Œå¯¹æ¯”"><a href="#è¿è¡Œå’Œå¯¹æ¯”" class="headerlink" title="è¿è¡Œå’Œå¯¹æ¯”"></a>è¿è¡Œå’Œå¯¹æ¯”</h2><p>å°†ç¦»çº¿çŠ¶æ€ä¸‹æˆåŠŸéƒ¨ç½²çš„huatuogpt2ä¸Kimiï¼ˆæœˆä¹‹æš—é¢å¤§æ¨¡å‹ï¼‰å„è‡ªè¯¢é—®äº”ä¸ªåŒ»å­¦é¢†åŸŸçš„é—®é¢˜ï¼Œå„è‡ªçš„å›ç­”å¯¹æ¯”ç»“æœå¦‚ä¸‹ã€‚</p><ol><li><p>ä»20å¹´å…ƒæ—¦å‘çƒ§å¥½äº†ä»¥åï¼Œå°å­©æ¯å¤©æ™šä¸Šå–ŠåŒè†ç›–å¥½ç´¯åˆ°ç°åœ¨ï¼Œåº”è¯¥æ˜¯é…¸ç—›ï¼Œç™½å¤©åŸºæœ¬æ²¡äº‹ï¼Œç›®å‰èµ°è·¯æ­£å¸¸ï¼Œæ— è‚¿èƒ€ã€‚å·²åˆ°äººæ°‘åŒ»é™¢æ£€æŸ¥æ ¸ç£å…±æŒ¯æ£€æŸ¥æ˜¾ç¤ºå…³èŠ‚æœ‰å°‘è®¸ç§¯æ¶²ï¼Œè¯·é—®è¿™æ˜¯ä»€ä¹ˆç—…ï¼Œæ€ä¹ˆæ²»ç–—ï¼Œèƒ½ä¸èƒ½ç»™æˆ‘å¼€è¯ï¼Ÿ</p><p><strong>HuatuoGPT2:</strong></p><p><img src="https://s2.loli.net/2024/08/05/PBVdU3zL7TA8w4Z.png" alt="image-20240801104516064.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">æ ¹æ®æ‚¨çš„æè¿°å’ŒåŒ»é™¢çš„æ£€æŸ¥ç»“æœï¼Œè¿™å¯èƒ½æ˜¯å­©å­çš„è†å…³èŠ‚å‡ºç°äº†ä¸€äº›é—®é¢˜ã€‚å…·ä½“çš„åŸå› å¯èƒ½æ˜¯å¤šç§å¤šæ ·çš„ï¼Œæ¯”å¦‚è¿‡åº¦ä½¿ç”¨ã€å—ä¼¤æˆ–è€…</span><br><span class="line">æ˜¯æŸç§ç–¾ç—…çš„è¡¨ç°ã€‚ä½†æ˜¯ï¼Œå…·ä½“çš„è¯Šæ–­è¿˜éœ€è¦ç”±åŒ»ç”Ÿæ ¹æ®è¯¦ç»†çš„ç—…å²å’Œå…¶ä»–ç›¸å…³çš„åŒ»å­¦ä¿¡æ¯æ¥åšå‡ºã€‚</span><br><span class="line"></span><br><span class="line">å…³äºå…³èŠ‚ç§¯æ¶²çš„é—®é¢˜ï¼Œè¿™å¯èƒ½æ˜¯ç”±äºç‚ç—‡æˆ–è€…å…¶ä»–åŸå› å¯¼è‡´çš„ã€‚å¦‚æœæ˜¯ç”±äºç‚ç—‡çš„è¯ï¼Œé‚£ä¹ˆå¯èƒ½æ˜¯ç”±äºæŸç§ç–¾ç—…çš„ç—‡çŠ¶ï¼Œæ¯”å¦‚è¯´ç±»é£</span><br><span class="line">æ¹¿å…³èŠ‚ç‚æˆ–è€…æ˜¯å› ä¸ºå…¶ä»–çš„ä¸€äº›ç–¾ç—…å¼•èµ·çš„ã€‚å¦‚æœæ˜¯ç”±äºå…¶ä»–çš„åŸå› ï¼Œæ¯”å¦‚è¿‡åº¦ä½¿ç”¨æˆ–è€…æ˜¯å—ä¼¤çš„è¯ï¼Œé‚£ä¹ˆæ²»ç–—çš„æ–¹æ³•ä¹Ÿä¼šæœ‰æ‰€ä¸åŒ</span><br><span class="line">ã€‚</span><br><span class="line"></span><br><span class="line">æ²»ç–—æ–¹æ³•å¯èƒ½åŒ…æ‹¬ç‰©ç†ç–—æ³•ã€è¯ç‰©æ²»ç–—ä»¥åŠå…¶ä»–çš„æ²»ç–—æ–¹æ³•ã€‚å…·ä½“çš„æ²»ç–—æ–¹æ¡ˆéœ€è¦ç”±åŒ»ç”Ÿæ ¹æ®å­©å­çš„å…·ä½“æƒ…å†µæ¥åˆ¶å®šã€‚è¯ç‰©æ²»ç–—å¯èƒ½</span><br><span class="line">ä¼šåŒ…æ‹¬éå¤„æ–¹è¯ç‰©ï¼Œæ¯”å¦‚ç”¨æ¥ç¼“è§£ç–¼ç—›å’Œç‚ç—‡çš„è¯ç‰©ï¼Œä¹Ÿå¯èƒ½ä¼šåŒ…æ‹¬å¤„æ–¹è¯ç‰©ï¼Œæ¯”å¦‚è¯´å¦‚æœéœ€è¦æ§åˆ¶ç‚ç—‡æˆ–è€…æ˜¯ä¸ºäº†æ²»ç–—æŸç§ç–¾ç—…çš„</span><br><span class="line">è¯ã€‚</span><br><span class="line"></span><br><span class="line">ä½†æ˜¯ï¼Œæˆ‘å¿…é¡»å¼ºè°ƒï¼Œä»¥ä¸Šçš„æ‰€æœ‰çš„ä¿¡æ¯éƒ½æ˜¯åŸºäºæ‚¨æä¾›çš„ä¿¡æ¯å’Œæˆ‘æ‰€äº†è§£çš„åŒ»å­¦çŸ¥è¯†ï¼Œå…·ä½“çš„è¯Šæ–­å’Œæ²»ç–—è¿˜éœ€è¦ç”±åŒ»ç”Ÿæ¥å†³å®šã€‚æˆ‘å»º</span><br><span class="line">è®®æ‚¨å°½å¿«å¸¦å­©å­å»çœ‹åŒ»ç”Ÿï¼Œç”±ä¸“ä¸šçš„åŒ»ç”Ÿæ¥è¿›è¡Œè¯¦ç»†çš„æ£€æŸ¥å’Œè¯„ä¼°ï¼Œä»¥ä¾¿èƒ½å¤Ÿå¾—åˆ°æœ€å‡†ç¡®çš„è¯Šæ–­å’Œæœ€é€‚åˆçš„æ²»ç–—æ–¹æ¡ˆã€‚</span><br></pre></td></tr></table></figure><p><strong>Kimi:</strong></p><p><img src="https://s2.loli.net/2024/08/05/9dEsWaYHiU8c5Kf.png" alt="image-20240801104635774.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">æ ¹æ®æ‚¨æè¿°çš„æƒ…å†µï¼Œå­©å­æ™šä¸ŠåŒè†ç›–æ„Ÿåˆ°é…¸ç—›ï¼Œä½†ç™½å¤©èµ°è·¯æ­£å¸¸ä¸”æ— è‚¿èƒ€ï¼Œæ ¸ç£å…±æŒ¯æ£€æŸ¥æ˜¾ç¤ºå…³èŠ‚æœ‰å°‘è®¸ç§¯æ¶²ã€‚è¿™å¯èƒ½æ˜¯ç”±å¤šç§åŸå› å¼•èµ·çš„ï¼Œä¾‹å¦‚è¿‡åº¦ç–²åŠ³ã€è½»å¾®çš„å…³èŠ‚æŸä¼¤æˆ–æ˜¯æ—©æœŸçš„å…³èŠ‚ç‚ç—‡ç­‰ã€‚ä¸è¿‡ï¼Œå…·ä½“çš„è¯Šæ–­éœ€è¦ç”±ä¸“ä¸šåŒ»ç”Ÿæ ¹æ®è¯¦ç»†çš„ç—…å²ã€ä½“æ£€å’Œè¾…åŠ©æ£€æŸ¥ç»“æœæ¥ç¡®å®šã€‚</span><br><span class="line"></span><br><span class="line">å¯¹äºè†ç›–çš„é…¸ç—›ï¼Œä¸€äº›å¸¸è§çš„æ²»ç–—æ–¹æ³•åŒ…æ‹¬ï¼š</span><br><span class="line">1. ä¼‘æ¯å’Œå‡å°‘æ´»åŠ¨é‡ï¼Œå°¤å…¶æ˜¯å‡å°‘å¯èƒ½åŠ å¤§è†å…³èŠ‚è´Ÿæ‹…çš„æ´»åŠ¨ï¼Œå¦‚è·‘è·³ã€é•¿æ—¶é—´è¡Œèµ°æˆ–çˆ¬æ¥¼æ¢¯ ã€‚</span><br><span class="line">2. å†°æ•·å¯ä»¥å‡è½»ç–¼ç—›å’Œè‚¿èƒ€ï¼Œå»ºè®®åœ¨ç–¼ç—›çš„ç¬¬ä¸€å¤©æ¯å°æ—¶å†°æ•·15åˆ†é’Ÿï¼Œä¹‹åå‡ å¤©æ¯å¤©4æ¬¡ ã€‚</span><br><span class="line">3. ä½¿ç”¨æŠ¤è†æ¥ä¿æŠ¤å’Œè¾…åŠ©è†å…³èŠ‚è¿åŠ¨ ã€‚</span><br><span class="line">4. å¦‚æœç–¼ç—›è¾ƒä¸ºä¸¥é‡ï¼Œå¯ä»¥åœ¨åŒ»ç”Ÿçš„æŒ‡å¯¼ä¸‹ä½¿ç”¨éç”¾ä½“æŠ—ç‚è¯ç‰©ï¼ˆå¦‚å¸ƒæ´›èŠ¬ã€å¡æ¥æ˜”å¸ƒç­‰ï¼‰æ¥ç¼“è§£ç–¼ç—› ã€‚</span><br><span class="line">5. åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒåŒ»ç”Ÿå¯èƒ½ä¼šå»ºè®®è¿›è¡Œç‰©ç†æ²»ç–—æˆ–åº·å¤è®­ç»ƒï¼Œä»¥å¢å¼ºè†å…³èŠ‚å‘¨å›´çš„è‚Œè‚‰å¹¶æ”¹å–„å…³èŠ‚åŠŸèƒ½ ã€‚</span><br><span class="line"></span><br><span class="line">é‡è¦çš„æ˜¯ï¼Œå¦‚æœå­©å­çš„è†ç›–ç–¼ç—›æŒç»­å­˜åœ¨æˆ–æœ‰åŠ é‡çš„è¶‹åŠ¿ï¼Œåº”è¯¥åŠæ—¶å¸¦å­©å­å»åŒ»é™¢å°±è¯Šï¼Œæ˜ç¡®ç—…å› ï¼Œå¹¶æ ¹æ®åŒ»ç”Ÿçš„å»ºè®®è¿›è¡Œé’ˆå¯¹æ€§æ²»ç–—ã€‚æ­¤å¤–ï¼Œå¦‚æœæ ¸ç£å…±æŒ¯æ£€æŸ¥æ˜¾ç¤ºå…³èŠ‚æœ‰ç§¯æ¶²ï¼ŒåŒ»ç”Ÿå¯èƒ½ä¼šå»ºè®®è¿›ä¸€æ­¥çš„æ£€æŸ¥æˆ–æ²»ç–—ï¼Œå¦‚å…³èŠ‚ç©¿åˆºæŠ½æ¶²ç­‰ï¼Œä»¥æ’é™¤å…¶ä»–æ½œåœ¨çš„ç–¾ç—… ã€‚</span><br><span class="line"></span><br><span class="line">è¯·æ³¨æ„ï¼Œæˆ‘ä¸èƒ½ä¸ºæ‚¨å¼€è¯ï¼Œå› ä¸ºæˆ‘ä¸æ˜¯åŒ»ç”Ÿï¼Œä¹Ÿæ— æ³•è¿›è¡Œé¢å¯¹é¢çš„è¯Šæ–­ã€‚ä¸Šè¿°å»ºè®®ä»…ä¾›å‚è€ƒï¼Œå…·ä½“æ²»ç–—æ–¹æ¡ˆè¿˜éœ€å’¨è¯¢ä¸“ä¸šåŒ»ç”Ÿã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>æ‚¨å¥½ï¼Œæˆ‘æ‚£æœ‰å¤§æ‹‡æŒ‡è…±é˜ç‚å·²ç»æœ‰13å¹´äº†ï¼Œç—‡çŠ¶åŒ…æ‹¬å³æ‰‹å¤§æ‹‡æŒ‡æ˜æ˜¾æ¯”å·¦æ‰‹ç²—å¤§ï¼Œä¼¸ä¸ç›´ï¼Œä½¿åŠ²ä¼¸ç›´æœ‰å“å£°ï¼Œä¸çµæ´»ã€‚è¿™ä¸ªç—…ä¸¥é‡å½±å“äº†æˆ‘çš„å·¥ä½œå’Œç”Ÿæ´»ã€‚æˆ‘æƒ³çŸ¥é“å®¿å·è¿™è¾¹æœ‰æ²¡æœ‰çœ‹è¿™ä¸ªç—…çš„åŒ»é™¢ï¼Œèƒ½å¦æ¨èä¸€ä¸ªå¥½ä¸€ç‚¹çš„åŒ»é™¢ç»™æˆ‘ï¼Ÿå¦‚æœéœ€è¦æ‰‹æœ¯ï¼Œæˆ‘ä¹Ÿæ„¿æ„å°è¯•ï¼Œåªå¸Œæœ›èƒ½å°½å¿«è§£å†³è¿™ä¸ªç—›è‹¦ã€‚è°¢è°¢ï¼</p><p><strong>HuatuoGPT2:</strong></p><p><img src="https://s2.loli.net/2024/08/05/Zz3GA4PlbIJyaKQ.png" alt="image-20240801104829750.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">å¾ˆæŠ±æ­‰å¬åˆ°æ‚¨çš„ç—…æƒ…ã€‚å¤§æ‹‡æŒ‡è…±é˜ç‚æ˜¯ä¸€ç§å¸¸è§çš„ç–¾ç—…ï¼Œä¸»è¦æ˜¯ç”±äºé•¿æœŸè¿‡åº¦ä½¿ç”¨æˆ–è€…å—ä¼¤å¯¼è‡´çš„å¤§æ‹‡æŒ‡å±ˆä¼¸è‚Œè…±å‘ç‚å¼•èµ·çš„ã€‚è¿™ç§</span><br><span class="line">ç—…ç—‡å¯èƒ½ä¼šå¯¼è‡´æ‰‹æŒ‡åŠŸèƒ½éšœç¢ï¼Œä¸¥é‡çš„è¯å¯èƒ½ä¼šå½±å“æ—¥å¸¸ç”Ÿæ´»å’Œå·¥ä½œã€‚</span><br><span class="line"></span><br><span class="line">åœ¨å®¿å·åœ°åŒºï¼Œæˆ‘å»ºè®®æ‚¨å¯ä»¥è€ƒè™‘å»å®¿å·å¸‚äººæ°‘åŒ»é™¢çš„éª¨ç§‘è¿›è¡Œå’¨è¯¢å’Œæ²»ç–—ã€‚ä»–ä»¬æœ‰ä¸“ä¸šçš„åŒ»ç”Ÿå’Œè®¾å¤‡å¯ä»¥è¿›è¡Œç›¸å…³çš„æ£€æŸ¥å’Œæ²»ç–—ã€‚å¦‚</span><br><span class="line">æœæ‚¨éœ€è¦æ‰‹æœ¯ï¼Œä»–ä»¬ä¹Ÿå¯ä»¥ä¸ºæ‚¨æä¾›ç›¸åº”çš„æœåŠ¡ã€‚åŒæ—¶ï¼Œæ‚¨ä¹Ÿå¯ä»¥åœ¨åœ¨çº¿åŒ»ç–—å¹³å°ä¸Šå’¨è¯¢ä¸€äº›åŒ»ç”Ÿï¼Œçœ‹çœ‹ä»–ä»¬å¯¹æ‚¨çš„ç—…æƒ…æœ‰ä»€ä¹ˆå»ºè®®</span><br><span class="line">ã€‚</span><br><span class="line"></span><br><span class="line">åœ¨æ²»ç–—æ–¹é¢ï¼Œé™¤äº†æ‰‹æœ¯ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›éæ‰‹æœ¯çš„æ²»ç–—æ–¹æ³•ï¼Œæ¯”å¦‚ç‰©ç†ç–—æ³•ã€è¯ç‰©æ²»ç–—ç­‰ã€‚å…·ä½“çš„æ²»ç–—æ–¹æ¡ˆè¿˜éœ€è¦æ ¹æ®æ‚¨çš„å…·ä½“ç—…æƒ…æ¥</span><br><span class="line">ç¡®å®šã€‚å¸Œæœ›æ‚¨èƒ½æ—©æ—¥åº·å¤ï¼</span><br></pre></td></tr></table></figure><p><strong>Kimi:</strong></p><p><img src="https://s2.loli.net/2024/08/05/SJVdHAf7U1EikT5.png" alt="image-20240801105048130.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">æ‚¨å¥½ï¼Œæ ¹æ®æœç´¢ç»“æœï¼Œå®¿å·å¸‚ç«‹åŒ»é™¢æ˜¯å®¿å·åœ°åŒºæ²»ç–—è…±é˜ç‚æ’åé å‰çš„åŒ»é™¢ï¼Œå®ƒæ˜¯ä¸€å®¶ä¸‰çº§ç”²ç­‰ç»¼åˆåŒ»é™¢ï¼Œå…·æœ‰æ‚ ä¹…çš„å†å²å’Œè‰¯å¥½çš„å£ç¢‘ ã€‚åŒ»é™¢æœ‰å¤šä½æ“…é•¿éª¨ç§‘ç–¾ç—…çš„ä¸»ä»»åŒ»å¸ˆï¼Œä¾‹å¦‚ç¨‹é“¶æ ‘ä¸»ä»»åŒ»å¸ˆï¼Œä»–æ“…é•¿è„ŠæŸ±å¸¸è§ç—…ã€å¤šå‘ç—…åŠç–‘éš¾æ‚ç—‡çš„è¯Šæ²»ï¼Œç†Ÿç»ƒæ“ä½œäººå·¥å…¨é«‹å…³èŠ‚ç½®æ¢æœ¯ã€äººå·¥å…¨è†å…³èŠ‚ç½®æ¢æœ¯ä»¥åŠå„ç±»éª¨ç§‘åˆ›ä¼¤æ•´å¤å†…å›ºå®šæ‰‹æœ¯ ã€‚æ­¤å¤–ï¼Œå´å¥ç”Ÿä¸»ä»»åŒ»å¸ˆå’Œåˆ˜ä½“å½¬ä¸»ä»»åŒ»å¸ˆä¹Ÿéƒ½åœ¨éª¨ç§‘é¢†åŸŸæœ‰ä¸°å¯Œçš„ç»éªŒï¼Œæ“…é•¿è„ŠæŸ±ã€å››è‚¢ã€äººå·¥å…³èŠ‚ç½®æ¢åŠå°å„¿ç•¸å½¢çš„çŸ«æ­£æ²»ç–—ç­‰ ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœæ‚¨è€ƒè™‘æ‰‹æœ¯æ²»ç–—è…±é˜ç‚ï¼Œå®¿å·å¸‚ç«‹åŒ»é™¢æ˜¯ä¸€ä¸ªå€¼å¾—è€ƒè™‘çš„é€‰æ‹©ã€‚å»ºè®®æ‚¨æ ¹æ®è‡ªå·±çš„å¥åº·éœ€æ±‚ï¼Œé€‰æ‹©åˆé€‚çš„åŒ»ç”Ÿè¿›è¡Œè¿›ä¸€æ­¥çš„å’¨è¯¢å’Œæ²»ç–—ã€‚æ‚¨å¯ä»¥é€šè¿‡åŒ»é™¢çš„é¢„çº¦æŒ‚å·æœåŠ¡æˆ–å›¾æ–‡é—®è¯Šã€ç”µè¯å’¨è¯¢æœåŠ¡æ¥äº†è§£æ›´å¤šä¿¡æ¯å’Œå®‰æ’å°±è¯Š ã€‚ç¥æ‚¨æ—©æ—¥åº·å¤ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>æˆ‘æœ€è¿‘å‡ºç°äº†ä¸€äº›ç—‡çŠ¶ï¼Œæƒ³å‘æ‚¨å’¨è¯¢ä¸€ä¸‹ã€‚æˆ‘ç«™å§¿æˆ–åå§¿æ—¶è„–å­åä¾§æ„Ÿåˆ°æ¶¨ç—›ï¼Œå¤´ä¹Ÿæ¶¨ç—›ï¼Œä½†æ˜¯å¹³èººæ—¶å°±æ²¡äº‹äº†ã€‚è¿™ç§æƒ…å†µæ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿ</p><p><strong>HuatuoGPT2:</strong></p><p><img src="https://s2.loli.net/2024/08/05/5SsJgBOnx19HuTN.png" alt="image-20240801105112242.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">é¦–å…ˆï¼Œæˆ‘è¦æ¾„æ¸…ä¸€ç‚¹ï¼Œæˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½æ¨¡å‹ï¼Œè™½ç„¶æˆ‘å¯ä»¥æä¾›åŒ»å­¦çŸ¥è¯†å’Œå»ºè®®ï¼Œä½†æˆ‘ä¸èƒ½è¿›è¡Œå®é™…çš„è¯Šæ–­å’Œæ²»ç–—ã€‚æ‚¨çš„ç—‡çŠ¶å¯èƒ½ç”±</span><br><span class="line">å¤šç§åŸå› å¼•èµ·ï¼Œæˆ‘ä¼šå°½åŠ›å¸®åŠ©æ‚¨ç†è§£å¯èƒ½çš„è§£é‡Šå’Œå¯èƒ½çš„åŸå› ã€‚</span><br><span class="line"></span><br><span class="line">æ ¹æ®æ‚¨çš„æè¿°ï¼Œæ‚¨åœ¨ç«™ç«‹æˆ–åç€æ—¶æ„Ÿåˆ°è„–å­åéƒ¨æ¶¨ç—›ï¼Œå¤´éƒ¨ä¹Ÿæœ‰ç±»ä¼¼çš„æ„Ÿè§‰ã€‚è¿™ç§æƒ…å†µå¯èƒ½æ˜¯ç”±äºé¢ˆæ¤è‚Œè‚‰ç´§å¼ å¼•èµ·çš„ï¼Œè¿™åœ¨é•¿æ—¶é—´</span><br><span class="line">ä¿æŒä¸è‰¯å§¿åŠ¿ï¼ˆå¦‚åç«‹ä¸åŠ¨æˆ–ä½¿ç”¨ç”µè„‘ï¼‰çš„æƒ…å†µä¸‹å¾ˆå¸¸è§ã€‚è¿™å¯èƒ½å¯¼è‡´é¢ˆéƒ¨å’Œä¸ŠèƒŒéƒ¨è‚Œè‚‰çš„ç´§å¼ ï¼Œä»è€Œå¼•èµ·ç–¼ç—›å’Œä¸é€‚ã€‚æ­¤å¤–ï¼ŒæŸäº›</span><br><span class="line">ç–¾ç—…å’ŒçŠ¶å†µï¼Œå¦‚é¢ˆæ¤ç—…ã€é¢ˆéƒ¨åŠ³æŸã€è‚Œè‚‰ç—‰æŒ›æˆ–å…¶ä»–ç¥ç»ç³»ç»Ÿé—®é¢˜ä¹Ÿå¯èƒ½å¯¼è‡´ç±»ä¼¼çš„ç—‡çŠ¶ã€‚</span><br><span class="line"></span><br><span class="line">æˆ‘å»ºè®®æ‚¨ï¼š</span><br><span class="line">1. å°è¯•æ”¹å˜æ‚¨çš„åå§¿æˆ–ç«™å§¿ï¼Œé¿å…é•¿æ—¶é—´ä¿æŒåŒä¸€å§¿åŠ¿ï¼›</span><br><span class="line">2. å®šæœŸä¼‘æ¯å’Œæ´»åŠ¨èº«ä½“ï¼Œä»¥å¸®åŠ©ç¼“è§£è‚Œè‚‰çš„ç´§å¼ ï¼›</span><br><span class="line">3. ä½¿ç”¨å†·çƒ­æ•·ç–—æ³•æ¥ç¼“è§£ç–¼ç—›å’Œä¸é€‚ï¼›</span><br><span class="line">4. å¦‚æœç—‡çŠ¶æŒç»­æˆ–åŠ é‡ï¼Œæˆ–è€…ä¼´æœ‰å…¶ä»–ä¸¥é‡ç—‡çŠ¶ï¼ˆå¦‚éº»æœ¨ã€æ— åŠ›ç­‰ï¼‰ï¼Œè¯·å°½å¿«å°±åŒ»è¿›è¡Œä¸“ä¸šè¯„ä¼°å’Œæ²»ç–—ã€‚</span><br></pre></td></tr></table></figure><p><strong>Kimi:</strong></p><p><img src="https://s2.loli.net/2024/08/05/kMEqRnFgy6Y4HrK.png" alt="image-20240801105215572.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">æ‚¨æè¿°çš„ç—‡çŠ¶å¯èƒ½ä¸å¤šç§å› ç´ æœ‰å…³ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</span><br><span class="line"></span><br><span class="line">1. **é¢ˆæ¤ç—…**ï¼šé•¿æ—¶é—´ä¿æŒä¸è‰¯å§¿åŠ¿ï¼Œå¦‚é•¿æ—¶é—´ä½å¤´çœ‹æ‰‹æœºæˆ–ç”µè„‘ï¼Œå¯èƒ½å¯¼è‡´é¢ˆæ¤å‹åŠ›å¢åŠ ï¼Œå¼•èµ·è„–å­å’Œå¤´éƒ¨çš„ä¸é€‚ã€‚</span><br><span class="line"></span><br><span class="line">2. **è‚Œè‚‰ç´§å¼ **ï¼šé¢ˆéƒ¨å’Œè‚©éƒ¨è‚Œè‚‰é•¿æ—¶é—´ç´§å¼ æˆ–ç–²åŠ³ï¼Œå¯èƒ½å¯¼è‡´è‚Œè‚‰åƒµç¡¬å’Œç–¼ç—›ã€‚</span><br><span class="line"></span><br><span class="line">3. **å§¿åŠ¿ä¸è‰¯**ï¼šä¸æ­£ç¡®çš„åå§¿æˆ–ç«™å§¿å¯èƒ½å¯¼è‡´é¢ˆéƒ¨å’ŒèƒŒéƒ¨è‚Œè‚‰æ‰¿å—é¢å¤–å‹åŠ›ã€‚</span><br><span class="line"></span><br><span class="line">4. **å‹åŠ›æˆ–ç„¦è™‘**ï¼šå¿ƒç†å‹åŠ›å’Œç„¦è™‘æœ‰æ—¶ä¼šå¯¼è‡´è‚Œè‚‰ç´§å¼ ï¼ŒåŒ…æ‹¬é¢ˆéƒ¨å’Œè‚©éƒ¨è‚Œè‚‰ã€‚</span><br><span class="line"></span><br><span class="line">5. **çœ¼ç›ç–²åŠ³**ï¼šé•¿æ—¶é—´æ³¨è§†å±å¹•æˆ–é˜…è¯»å¯èƒ½å¯¼è‡´çœ¼ç›ç–²åŠ³ï¼Œè¿›è€Œå¼•èµ·å¤´ç—›ã€‚</span><br><span class="line"></span><br><span class="line">6. **è„±æ°´**ï¼šè„±æ°´æœ‰æ—¶ä¹Ÿä¼šå¯¼è‡´å¤´ç—›ã€‚</span><br><span class="line"></span><br><span class="line">7. **ç¡çœ ä¸è¶³**ï¼šç¡çœ ä¸è¶³æˆ–ç¡çœ è´¨é‡å·®ä¹Ÿå¯èƒ½å¯¼è‡´å¤´ç—›å’Œé¢ˆéƒ¨ä¸é€‚ã€‚</span><br><span class="line"></span><br><span class="line">8. **å…¶ä»–å¥åº·é—®é¢˜**ï¼šå¦‚é«˜è¡€å‹ã€è´«è¡€ç­‰ä¹Ÿå¯èƒ½å¼•èµ·å¤´ç—›ã€‚</span><br><span class="line"></span><br><span class="line">ç”±äºæˆ‘æ— æ³•æä¾›è¯Šæ–­ï¼Œå»ºè®®æ‚¨å’¨è¯¢åŒ»ç”Ÿæˆ–ä¸“ä¸šçš„åŒ»ç–—äººå‘˜ä»¥è·å¾—å‡†ç¡®çš„è¯Šæ–­å’Œæ²»ç–—å»ºè®®ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œæ‚¨å¯ä»¥å°è¯•ä»¥ä¸‹ä¸€äº›ç¼“è§£æªæ–½ï¼š</span><br><span class="line"></span><br><span class="line">- ä¿æŒè‰¯å¥½çš„å§¿åŠ¿ï¼Œé¿å…é•¿æ—¶é—´ä¿æŒåŒä¸€å§¿åŠ¿ã€‚</span><br><span class="line">- å®šæœŸä¼‘æ¯å¹¶åšä¸€äº›é¢ˆéƒ¨å’Œè‚©éƒ¨çš„ä¼¸å±•è¿åŠ¨ã€‚</span><br><span class="line">- ç¡®ä¿å……è¶³çš„ç¡çœ ã€‚</span><br><span class="line">- ä¿æŒé€‚å½“çš„æ°´åˆ†æ‘„å…¥ã€‚</span><br><span class="line">- å¦‚æœæ˜¯çœ¼ç›ç–²åŠ³ï¼Œå°è¯•æ¯éš”ä¸€æ®µæ—¶é—´è¿œç¦»å±å¹•ï¼Œè®©çœ¼ç›ä¼‘æ¯ã€‚</span><br><span class="line">- å¦‚æœç—‡çŠ¶æŒç»­æˆ–åŠ é‡ï¼Œè¯·åŠæ—¶å°±åŒ»ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœæ‚¨éœ€è¦æ›´å¤šå¸®åŠ©ï¼Œæ¯”å¦‚å¯»æ‰¾é™„è¿‘çš„åŒ»ç–—æœºæ„æˆ–ä¸“å®¶ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>æˆ‘æœ€è¿‘å‡ºç°äº†å°¿ä¸­æœ‰äº›è¡€çš„æƒ…å†µï¼Œå·²ç»æŒç»­ä¸‰å¤©äº†ã€‚æˆ‘ä¹‹å‰åšè¿‡å‰åˆ—è…ºå¢ç”Ÿæ‰‹æœ¯ï¼Œç°åœ¨ä¸æƒ³å†å»åŒ»é™¢ï¼Œæƒ³åœ¨å®¶é‡Œä¿å®ˆæ²»ç–—ã€‚æ‚¨èƒ½ç»™æˆ‘ä¸€äº›å»ºè®®å—ï¼Ÿ</p><p><strong>HuatuoGPT2:</strong></p><p><img src="https://s2.loli.net/2024/08/05/XyQL7mSewt9dqal.png" alt="image-20240801105254020.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">é¦–å…ˆï¼Œæˆ‘è¦æé†’æ‚¨çš„æ˜¯ï¼Œå°¿æ¶²å¼‚å¸¸å¯èƒ½æ˜¯èº«ä½“å†…éƒ¨é—®é¢˜çš„ä¿¡å·ï¼Œç‰¹åˆ«æ˜¯å¦‚æœä¼´éšå…¶ä»–ç—‡çŠ¶å¦‚ç–¼ç—›ã€å‘çƒ­ç­‰ï¼Œåº”åŠæ—¶å°±åŒ»ä»¥è·å¾—æ­£ç¡®çš„</span><br><span class="line">è¯Šæ–­å’Œæ²»ç–—ã€‚å¯¹äºæ‚¨çš„å°¿ä¸­æƒ…å†µï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å¯èƒ½çš„å»ºè®®ï¼š</span><br><span class="line"></span><br><span class="line">1. å¤šå–æ°´ï¼šä¿æŒå……è¶³çš„æ°´åˆ†æ‘„å…¥æœ‰åŠ©äºç¨€é‡Šå°¿æ¶²ï¼Œå‡å°‘åˆºæ¿€å°¿è·¯çš„å¯èƒ½æ€§ã€‚</span><br><span class="line">2. é¥®é£Ÿè°ƒæ•´ï¼šé¿å…æ‘„å…¥åˆºæ¿€æ€§é£Ÿç‰©å’Œé¥®æ–™ï¼Œå¦‚å’–å•¡ã€é…’ç²¾ã€è¾›è¾£é£Ÿç‰©ç­‰ï¼Œè¿™äº›å¯èƒ½ä¼šåŠ é‡ç—‡çŠ¶ã€‚åŒæ—¶å¢åŠ æ‘„å…¥çº¤ç»´ä¸°å¯Œçš„æ°´æœå’Œè”¬</span><br><span class="line">èœï¼Œæœ‰åŠ©äºé¢„é˜²ä¾¿ç§˜ï¼ˆå¦‚æœå­˜åœ¨ï¼‰åŠé™ä½å°¿è·¯æ„ŸæŸ“çš„é£é™©ã€‚</span><br><span class="line">3. å°¿ä¸­è¡€å°¿å¯èƒ½æ˜¯æ³Œå°¿ç³»ç»Ÿç–¾ç—…çš„è¡¨ç°ï¼Œä¾‹å¦‚è†€èƒ±ç‚ã€è‚¾è„ç—…æˆ–å‰åˆ—è…ºé—®é¢˜ã€‚è™½ç„¶æ‚¨å·²ç»åšè¿‡å‰åˆ—è…ºæ‰‹æœ¯ï¼Œä½†ä»æœ‰å¯èƒ½å‘ç”Ÿå¤å‘æˆ–</span><br><span class="line">å…¶ä»–é—®é¢˜ã€‚å› æ­¤ï¼Œæˆ‘å¼ºçƒˆå»ºè®®æ‚¨å°½å¿«å’¨è¯¢åŒ»ç”Ÿä»¥è·å–ä¸“ä¸šæ„è§å’Œå¿…è¦çš„æ£€æŸ¥ã€‚</span><br><span class="line">4. åœ¨ç­‰å¾…å°±åŒ»æœŸé—´ï¼Œæ‚¨å¯ä»¥å°è¯•ä¸€äº›è‡ªæˆ‘æŠ¤ç†æªæ–½æ¥ç¼“è§£ç—‡çŠ¶ã€‚ä¾‹å¦‚ï¼Œé¿å…é•¿æ—¶é—´åç«‹ä¸åŠ¨ï¼Œç»å¸¸è¿›è¡Œé€‚é‡çš„è¿åŠ¨æœ‰åŠ©äºä¿ƒè¿›è¡€æ¶²</span><br><span class="line">å¾ªç¯ï¼›æ³¨æ„ä¸ªäººå«ç”Ÿï¼Œä¿æŒå¤–é˜´æ¸…æ´å¹²ç‡¥ï¼Œä»¥å‡å°‘ç»†èŒæ„ŸæŸ“çš„å¯èƒ½æ€§ç­‰ã€‚ç„¶è€Œï¼Œè¿™äº›åªèƒ½ä½œä¸ºä¸´æ—¶ç¼“è§£çš„æ–¹æ³•ï¼Œä¸èƒ½æ›¿ä»£åŒ»ç”Ÿçš„è¯Šæ–­</span><br><span class="line">å’Œæ²»ç–—å»ºè®®ã€‚</span><br><span class="line"></span><br><span class="line">è¯·è®°ä½ï¼Œæˆ‘æä¾›çš„å»ºè®®ä»…ä¾›å‚è€ƒï¼Œå¹¶ä¸èƒ½æ›¿ä»£ä¸“ä¸šåŒ»ç–—æ„è§ã€‚å¦‚æœæ‚¨çš„å°¿ä¸­è¡€çš„æƒ…å†µæŒç»­å­˜åœ¨æˆ–åŠ é‡ï¼Œæˆ–è€…æ‚¨æœ‰å…¶ä»–ä¸é€‚ç—‡çŠ¶ï¼Œè¯·å°½</span><br><span class="line">å¿«å°±åŒ»å¯»æ±‚ä¸“ä¸šçš„åŒ»ç–—å¸®åŠ©ã€‚</span><br></pre></td></tr></table></figure><p><strong>Kimi:</strong></p><p><img src="https://s2.loli.net/2024/08/05/w8PkSIDdnj4Rgv6.png" alt="image-20240801105347105.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">å°¿æ¶²ä¸­å‡ºç°è¡€è¿¹ï¼ˆåŒ»å­¦ä¸Šç§°ä¸ºè¡€å°¿ï¼‰å¯èƒ½æ˜¯ç”±å¤šç§åŸå› å¼•èµ·çš„ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºæ³Œå°¿ç³»ç»Ÿæ„ŸæŸ“ã€ç»“çŸ³ã€è‚¾è„ç–¾ç—…ã€å‰åˆ—è…ºé—®é¢˜ç­‰ã€‚è€ƒè™‘åˆ°æ‚¨ä¹‹å‰åšè¿‡å‰åˆ—è…ºå¢ç”Ÿæ‰‹æœ¯ï¼Œè¡€å°¿å¯èƒ½ä¸æ­¤æœ‰å…³ï¼Œä½†ä¹Ÿå¯èƒ½æ˜¯å…¶ä»–åŸå› å¼•èµ·çš„ã€‚</span><br><span class="line"></span><br><span class="line">**é‡è¦æç¤º**ï¼šè¡€å°¿æ˜¯ä¸€ä¸ªéœ€è¦åŒ»ç”Ÿè¯„ä¼°çš„ç—‡çŠ¶ï¼Œå› ä¸ºå®ƒå¯èƒ½æ˜¯ä¸€äº›ä¸¥é‡ç–¾ç—…çš„æ—©æœŸä¿¡å·ã€‚å°½ç®¡æ‚¨ä¸æƒ³å»åŒ»é™¢ï¼Œä½†æˆ‘å¼ºçƒˆå»ºè®®æ‚¨è‡³å°‘é€šè¿‡ç”µè¯æˆ–åœ¨çº¿å’¨è¯¢çš„æ–¹å¼è”ç³»åŒ»ç”Ÿï¼Œä»¥ç¡®ä¿å¾—åˆ°æ­£ç¡®çš„è¯Šæ–­å’Œæ²»ç–—ã€‚</span><br><span class="line"></span><br><span class="line">åœ¨æ‚¨èƒ½å¤Ÿè”ç³»åŒ»ç”Ÿä¹‹å‰ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å»ºè®®ï¼Œå¯èƒ½æœ‰åŠ©äºç¼“è§£ç—‡çŠ¶æˆ–å‡å°‘æ½œåœ¨çš„é£é™©ï¼š</span><br><span class="line"></span><br><span class="line">1. **å¢åŠ æ°´åˆ†æ‘„å…¥**ï¼šå–è¶³å¤Ÿçš„æ°´å¯ä»¥å¸®åŠ©å†²æ´—æ³Œå°¿ç³»ç»Ÿï¼Œå‡å°‘æ„ŸæŸ“çš„é£é™©ï¼Œå¹¶å¯èƒ½å¸®åŠ©æ’å‡ºå°çš„ç»“çŸ³ã€‚</span><br><span class="line"></span><br><span class="line">2. **é¿å…åˆºæ¿€æ€§é£Ÿç‰©å’Œé¥®æ–™**ï¼šå’–å•¡ã€é…’ç²¾å’Œè¾›è¾£é£Ÿç‰©å¯èƒ½ä¼šåˆºæ¿€æ³Œå°¿é“ï¼Œåº”é€‚é‡å‡å°‘ã€‚</span><br><span class="line"></span><br><span class="line">3. **é€‚å½“ä¼‘æ¯**ï¼šé¿å…å‰§çƒˆè¿åŠ¨å’Œé‡ä½“åŠ›åŠ³åŠ¨ï¼Œå‡å°‘å¯¹æ³Œå°¿ç³»ç»Ÿçš„å‹åŠ›ã€‚</span><br><span class="line"></span><br><span class="line">4. **è§‚å¯Ÿç—‡çŠ¶**ï¼šè®°å½•è¡€å°¿çš„æƒ…å†µï¼ŒåŒ…æ‹¬é¢œè‰²ã€é¢‘ç‡å’Œä»»ä½•ä¼´éšç—‡çŠ¶ï¼Œè¿™æœ‰åŠ©äºåŒ»ç”Ÿè¿›è¡Œè¯Šæ–­ã€‚</span><br><span class="line"></span><br><span class="line">5. **ä½¿ç”¨éå¤„æ–¹æ­¢ç—›è¯**ï¼šå¦‚æœæ„Ÿåˆ°ç–¼ç—›ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨éå¤„æ–¹çš„æ­¢ç—›è¯ï¼Œå¦‚å¸ƒæ´›èŠ¬ï¼Œä½†è¯·éµå¾ªè¯ç‰©è¯´æ˜ï¼Œå¹¶æ³¨æ„ä¸è¦é•¿æœŸè¿‡é‡ä½¿ç”¨ã€‚</span><br><span class="line"></span><br><span class="line">6. **ä¿æŒè‰¯å¥½çš„ä¸ªäººå«ç”Ÿ**ï¼šè¿™æœ‰åŠ©äºå‡å°‘æ³Œå°¿ç³»ç»Ÿæ„ŸæŸ“çš„é£é™©ã€‚</span><br><span class="line"></span><br><span class="line">7. **é¿å…æ€§è¡Œä¸º**ï¼šå¦‚æœè¡€å°¿ä¸å‰åˆ—è…ºæœ‰å…³ï¼Œæ€§è¡Œä¸ºå¯èƒ½ä¼šåŠ é‡ç—‡çŠ¶ã€‚</span><br><span class="line"></span><br><span class="line">ç„¶è€Œï¼Œæˆ‘å¿…é¡»å†æ¬¡å¼ºè°ƒï¼Œè¡€å°¿æ˜¯ä¸€ä¸ªéœ€è¦ä¸“ä¸šåŒ»ç–—è¯„ä¼°çš„ç—‡çŠ¶ã€‚å¦‚æœè¡€å°¿æŒç»­æˆ–ä¼´æœ‰å…¶ä»–ç—‡çŠ¶ï¼ˆå¦‚å‘çƒ­ã€è…°ç—›ã€æ’å°¿å›°éš¾ç­‰ï¼‰ï¼Œæ‚¨åº”è¯¥å°½å¿«å°±åŒ»ã€‚è¯·ä¸è¦å¿½è§†è¿™äº›ç—‡çŠ¶ï¼Œå› ä¸ºåŠæ—¶çš„è¯Šæ–­å’Œæ²»ç–—å¯¹äºé¢„é˜²å¹¶å‘ç—‡éå¸¸é‡è¦ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>åŒ»ç”Ÿæ‚¨å¥½ã€‚æˆ‘æƒ³å’¨è¯¢ä¸€ä¸‹å…³äºæˆ‘å­©å­çš„ç—…æƒ…ã€‚å¥¹ç°åœ¨2å²3ä¸ªæœˆï¼Œå‡ ä¸ªæœˆå‰æˆ‘å‘ç°å¥¹çš„è†å…³èŠ‚å‰æ–¹å‡ºç°äº†ä¸€å—ç¡¬ç—‚ï¼Œå¼€å§‹ä»¥ä¸ºæ˜¯çš®çº¹ï¼Œä½†æ˜¯åæ¥è¶Šæ¥è¶Šç¡¬ï¼Œå¹¶ä¸”æœ‰å‡¸èµ·çš„æ„Ÿè§‰ã€‚å¥¹æ²¡æœ‰ç–¼ç—›æˆ–è€…ç—’çš„æ„Ÿè§‰ï¼Œä¹Ÿæ²¡æœ‰å¤–ä¼¤å²ã€‚æˆ‘æƒ³çŸ¥é“è¿™æ˜¯ä»€ä¹ˆç—…ï¼Œæ˜¯å¦ä¼šæ‰©å¤§ï¼Œæ˜¯å¦éœ€è¦å»åŒ»é™¢ã€‚è°¢è°¢æ‚¨çš„å¸®åŠ©ï¼</p><p><strong>HuatuoGPT2:</strong></p><p><img src="https://s2.loli.net/2024/08/05/AcE6FMiuQO3blv8.png" alt="image-20240801105441331.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">æ‚¨å¥½ï¼Œæ ¹æ®æ‚¨çš„æè¿°ï¼Œå­©å­çš„è†ç›–éƒ¨ä½å‡ºç°çš„ç¡¬æ€§å‡¸èµ·å¯èƒ½æ˜¯ç”±äºå‡ ç§æƒ…å†µå¼•èµ·çš„ï¼š</span><br><span class="line"></span><br><span class="line">1. éª¨ç–£ï¼ˆåˆç§°ä¸ºéª¨ç˜¤æˆ–éª¨è´¨å¢ç”Ÿï¼‰ï¼šè¿™æ˜¯ä¸€ç§å¸¸è§çš„è‰¯æ€§éª¨è‚¿ç˜¤ï¼Œé€šå¸¸åœ¨éª¨éª¼ç”Ÿé•¿çš„åœ°æ–¹å‡ºç°ï¼Œå°¤å…¶æ˜¯åœ¨è†å…³èŠ‚å‘¨å›´ã€‚å®ƒä»¬é€šå¸¸æ˜¯</span><br><span class="line">æ— ç—›çš„ï¼Œå¯ä»¥ç§»åŠ¨ï¼Œå¹¶ä¸”éšç€æ—¶é—´çš„æ¨ç§»å¯èƒ½ä¼šå˜å¤§æˆ–è€…å˜ç¡¬ã€‚</span><br><span class="line"></span><br><span class="line">2. æ»‘è†œå›Šè‚¿ï¼šè¿™æ˜¯ç”±äºå…³èŠ‚å†…éƒ¨çš„æ¶²ä½“ç§¯èšå½¢æˆçš„å›Šè‚¿ã€‚è¿™äº›å›Šè‚¿é€šå¸¸ä¸ç—›ï¼Œä½†æ˜¯å¯èƒ½ä¼šå¯¼è‡´è‚¿èƒ€å’Œç¡¬åº¦ã€‚</span><br><span class="line"></span><br><span class="line">3. è‚Œè…±é˜å›Šè‚¿ï¼šè¿™æ˜¯ä¸€ç§åœ¨è‚Œè…±é™„è¿‘å‡ºç°çš„è‚¿å—ï¼Œé€šå¸¸æ˜¯ç”±äºæ»‘æ¶²ç§¯èšå¼•èµ·çš„ã€‚</span><br><span class="line"></span><br><span class="line">4. éª¨åˆºæˆ–éª¨è´¨å¢ç”Ÿï¼šè¿™å¯èƒ½æ˜¯ç”±äºéª¨éª¼çš„è¿‡åº¦ä½¿ç”¨æˆ–è€…ç£¨æŸå¼•èµ·çš„ã€‚</span><br><span class="line"></span><br><span class="line">è¦ç¡®å®šå…·ä½“çš„ç—…å› ï¼Œæœ€å¥½çš„åšæ³•æ˜¯å¸¦å­©å­å»åŒ»é™¢è¿›è¡Œæ£€æŸ¥ã€‚åŒ»ç”Ÿå¯èƒ½ä¼šå»ºè®®è¿›è¡ŒXå…‰æ£€æŸ¥æˆ–è€…å…¶ä»–å½±åƒå­¦æ£€æŸ¥æ¥ç¡®å®šè‚¿å—çš„æ€§è´¨å’Œå¤§</span><br><span class="line">å°ã€‚å¦‚æœéœ€è¦çš„è¯ï¼Œå¯èƒ½è¿˜ä¼šå»ºè®®è¿›è¡Œæ´»æ£€ä»¥è¿›ä¸€æ­¥ç¡®å®šè¯Šæ–­ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœè‚¿å—æ²¡æœ‰å¼•èµ·ä»»ä½•ç—‡çŠ¶ï¼ˆå¦‚ç–¼ç—›ã€è‚¿èƒ€æˆ–æ´»åŠ¨å—é™ï¼‰å¹¶ä¸”æ²¡æœ‰ç»§ç»­å¢å¤§ï¼Œé‚£ä¹ˆå¯èƒ½ä¸éœ€è¦ç«‹å³è¿›è¡Œæ²»ç–—ã€‚ä½†æ˜¯ï¼Œæˆ‘å»ºè®®æ‚¨å¸¦å­©å­</span><br><span class="line">å»åŒ»é™¢è¿›è¡Œæ£€æŸ¥ï¼Œä»¥ç¡®ä¿æ²¡æœ‰å…¶ä»–æ½œåœ¨çš„é—®é¢˜ã€‚åŒæ—¶ï¼Œä¹Ÿå¯ä»¥è®©å­©å­é¿å…åœ¨è‚¿å—ä¸Šæ–½åŠ è¿‡å¤šçš„å‹åŠ›æˆ–è€…æ‘©æ“¦ï¼Œä»¥é˜²æ­¢è¿›ä¸€æ­¥çš„æŸä¼¤æˆ–</span><br><span class="line">è€…ç‚ç—‡ã€‚</span><br></pre></td></tr></table></figure><p><strong>Kimi:</strong></p><p><img src="https://s2.loli.net/2024/08/05/MyZUbLpRJsIjr83.png" alt="image-20240801111946130.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">æ‚¨å¥½ï¼Œæ ¹æ®æ‚¨æè¿°çš„æƒ…å†µï¼Œå­©å­è†å…³èŠ‚å‰æ–¹å‡ºç°çš„ç¡¬ç—‚å¯èƒ½æœ‰å¤šç§åŸå› ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºä»¥ä¸‹å‡ ç§å¯èƒ½æ€§ï¼š</span><br><span class="line"></span><br><span class="line">1. **éª¨è½¯éª¨ç˜¤**ï¼šè¿™æ˜¯ä¸€ç§è‰¯æ€§éª¨è‚¿ç˜¤ï¼Œé€šå¸¸è¡¨ç°ä¸ºéª¨è¡¨é¢å‡ºç°çš„ç¡¬æ€§çªèµ·ï¼Œå¯èƒ½éšç€æ—¶é—´æ…¢æ…¢å¢å¤§ã€‚</span><br><span class="line"></span><br><span class="line">2. **éª¨è´¨å¢ç”Ÿ**ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œéª¨è´¨å¯èƒ½å¼‚å¸¸å¢ç”Ÿï¼Œå½¢æˆç¡¬ç»“ã€‚</span><br><span class="line"></span><br><span class="line">3. **çš®è‚¤ç—…å˜**ï¼šæŸäº›çš®è‚¤ç—…ä¹Ÿå¯èƒ½åœ¨å…³èŠ‚é™„è¿‘å½¢æˆç¡¬ç—‚æˆ–ç»“èŠ‚ã€‚</span><br><span class="line"></span><br><span class="line">4. **å›Šè‚¿**ï¼šå¦‚è…±é˜å›Šè‚¿ï¼Œå¯èƒ½åœ¨å…³èŠ‚é™„è¿‘å½¢æˆè‚¿å—ã€‚</span><br><span class="line"></span><br><span class="line">5. **å…¶ä»–åŸå› **ï¼šåŒ…æ‹¬æŸäº›æ„ŸæŸ“æˆ–ç‚ç—‡æ€§ç–¾ç—…ã€‚</span><br><span class="line"></span><br><span class="line">ç”±äºç¡¬ç—‚æ²¡æœ‰ç–¼ç—›æˆ–ç˜™ç—’ï¼Œå­©å­å¯èƒ½ä¸ä¼šè¡¨ç°å‡ºä¸é€‚ï¼Œä½†è¿™å¹¶ä¸æ„å‘³ç€ä¸éœ€è¦å…³æ³¨ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œå¦‚æœç¡¬ç—‚ç»§ç»­å¢å¤§æˆ–å‡ºç°å…¶ä»–ç—‡çŠ¶ï¼Œå¯èƒ½éœ€è¦è¿›ä¸€æ­¥çš„è¯„ä¼°ã€‚</span><br><span class="line"></span><br><span class="line">**å»ºè®®**ï¼š</span><br><span class="line"></span><br><span class="line">- **è§‚å¯Ÿ**ï¼šæ³¨æ„ç¡¬ç—‚æ˜¯å¦æœ‰å˜åŒ–ï¼Œå¦‚å¤§å°ã€å½¢çŠ¶ã€é¢œè‰²æˆ–æ˜¯å¦å‡ºç°ç–¼ç—›ã€çº¢è‚¿ç­‰ç—‡çŠ¶ã€‚</span><br><span class="line">- **è®°å½•**ï¼šè®°å½•ç¡¬ç—‚çš„å˜åŒ–æƒ…å†µï¼ŒåŒ…æ‹¬ä»»ä½•æ–°å‡ºç°çš„ç—‡çŠ¶ã€‚</span><br><span class="line">- **å’¨è¯¢åŒ»ç”Ÿ**ï¼šå°½ç®¡æ‚¨å¯èƒ½ä¸æƒ³ç«‹å³å»åŒ»é™¢ï¼Œä½†è€ƒè™‘åˆ°ç¡¬ç—‚çš„æ€§è´¨å’Œå¯èƒ½çš„å¢é•¿ï¼Œå»ºè®®æ‚¨è‡³å°‘é€šè¿‡ç”µè¯æˆ–åœ¨çº¿å’¨è¯¢çš„æ–¹å¼è”ç³»å„¿ç§‘åŒ»ç”Ÿæˆ–éª¨ç§‘åŒ»ç”Ÿï¼Œä»¥è·å¾—ä¸“ä¸šæ„è§ã€‚</span><br><span class="line">- **å¿…è¦æ—¶å°±åŒ»**ï¼šå¦‚æœç¡¬ç—‚æœ‰ä»»ä½•å˜åŒ–æˆ–æ‚¨æ„Ÿåˆ°æ‹…å¿§ï¼Œåº”è¯¥å¸¦å­©å­å»åŒ»é™¢è¿›è¡Œè¿›ä¸€æ­¥çš„æ£€æŸ¥ï¼Œå¯èƒ½åŒ…æ‹¬Xå…‰ã€è¶…å£°æˆ–å…¶ä»–å½±åƒå­¦æ£€æŸ¥ï¼Œä»¥ç¡®å®šç¡¬ç—‚çš„æ€§è´¨ã€‚</span><br><span class="line"></span><br><span class="line">è¯·è®°ä½ï¼Œæˆ‘æä¾›çš„ä¿¡æ¯ä¸èƒ½ä»£æ›¿ä¸“ä¸šåŒ»ç–—å»ºè®®ã€‚å­©å­çš„å¥åº·éå¸¸é‡è¦ï¼Œå› æ­¤åŠæ—¶çš„è¯„ä¼°å’Œé€‚å½“çš„åŒ»ç–—å¹²é¢„æ˜¯éå¸¸å…³é”®çš„ã€‚å¸Œæœ›å­©å­èƒ½å¤Ÿå°½å¿«å¾—åˆ°æ­£ç¡®çš„è¯Šæ–­å’Œæ²»ç–—ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> å¤§æ¨¡å‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HuatuoGPT2 </tag>
            
            <tag> Ollama </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åç«¯å¾®æœåŠ¡-programmer-clubé¡¹ç›®çš„è®¾è®¡ä¸å®ç°å¿ƒå¾—</title>
      <link href="/2024/07/21/2024-07-21-%E5%90%8E%E7%AB%AF%E5%BE%AE%E6%9C%8D%E5%8A%A1-programmer-club%E9%A1%B9%E7%9B%AE%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%E5%BF%83%E5%BE%97/"/>
      <url>/2024/07/21/2024-07-21-%E5%90%8E%E7%AB%AF%E5%BE%AE%E6%9C%8D%E5%8A%A1-programmer-club%E9%A1%B9%E7%9B%AE%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0%E5%BF%83%E5%BE%97/</url>
      
        <content type="html"><![CDATA[<h1 id="åç«¯å¾®æœåŠ¡-programmer-clubé¡¹ç›®çš„è®¾è®¡ä¸å®ç°å¿ƒå¾—"><a href="#åç«¯å¾®æœåŠ¡-programmer-clubé¡¹ç›®çš„è®¾è®¡ä¸å®ç°å¿ƒå¾—" class="headerlink" title="åç«¯å¾®æœåŠ¡-programmer-clubé¡¹ç›®çš„è®¾è®¡ä¸å®ç°å¿ƒå¾—"></a>åç«¯å¾®æœåŠ¡-programmer-clubé¡¹ç›®çš„è®¾è®¡ä¸å®ç°å¿ƒå¾—</h1><h2 id="å¼€å‘å·¥å…·"><a href="#å¼€å‘å·¥å…·" class="headerlink" title="å¼€å‘å·¥å…·"></a>å¼€å‘å·¥å…·</h2><p>åç«¯ï¼šIDEA</p><p>å‰ç«¯ï¼šVSCode</p><p>é¡¹ç›®ç®¡ç†ï¼šgit</p><p>åŒ…ä¾èµ–ç®¡ç†ï¼šMaven3.6.0</p><p>æ•°æ®åº“ï¼šMysql5.7</p><p>æ•°æ®åº“è¿æ¥æ± å’Œç›‘æ§åº“ï¼šDruid</p><p>æ¡†æ¶ï¼šSpringboot 2.4.2</p><p>æ•°æ®åº“å›¾å½¢åŒ–ï¼šNavicat</p><p>æ¥å£ç®¡ç†å·¥å…·ï¼šAPIPost7</p><p>Redisæ¡Œé¢å·¥å…·ï¼šRedisDesktop</p><p>è¡¨å»ºæ¨¡ï¼šPDManager</p><p>åŸå‹è®¾è®¡ï¼šaxure8</p><p>åŸå‹ç»„ä»¶åº“: antdesign</p><p>ä»£ç ç”Ÿæˆå™¨ï¼šeasycodeï¼ˆideaçš„pluginå¸‚åœºï¼‰</p><p>ä¸€äº›æ’ä»¶ï¼šmybatisï¼ˆç±»-&gt;dao-&gt;æ•°æ®åº“ï¼‰ï¼Œeasycodeï¼ˆç”±æ•°æ®åº“è¡¨ç”Ÿæˆç›¸åº”ä»£ç ï¼‰, preconditionsï¼ˆå‚æ•°æ ¡éªŒï¼‰</p><p>node.js</p><p>é˜¿é‡Œäº‘è„šæ‰‹æ¶ç”¨äºç»„ä»¶&#x2F;ç‰ˆæœ¬çš„é€‰æ‹©å…¼å®¹ï¼Œéå¸¸æ–¹ä¾¿: <a href="">start.aliyun.com</a></p><h2 id="æ¶æ„è®¾è®¡"><a href="#æ¶æ„è®¾è®¡" class="headerlink" title="æ¶æ„è®¾è®¡"></a>æ¶æ„è®¾è®¡</h2><h3 id="ä¼ ç»Ÿé¡¹ç›®"><a href="#ä¼ ç»Ÿé¡¹ç›®" class="headerlink" title="ä¼ ç»Ÿé¡¹ç›®"></a>ä¼ ç»Ÿé¡¹ç›®</h3><p>[SpringMVCæ¡†æ¶ï¼ˆè¯¦è§£ï¼‰-CSDNåšå®¢](<a href="https://blog.csdn.net/H20031011/article/details/131511482?ops_request_misc=%7B%22request_id%22:%22172145077916800222810035%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172145077916800222810035&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-131511482-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=spring">https://blog.csdn.net/H20031011/article/details/131511482?ops_request_misc=%7B%22request%5Fid%22%3A%22172145077916800222810035%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172145077916800222810035&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-131511482-null-null.142^v100^pc_search_result_base8&amp;utm_term=spring</a> mvcæ¶æ„&amp;spm&#x3D;1018.2226.3001.4187)</p><p>ä¸€èˆ¬çš„mvcï¼šmodelï¼Œviewï¼Œcontroller</p><p>SpringMVCï¼šcontroller(view+controller)ï¼Œserviceï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰ï¼Œdaoï¼ˆæ•°æ®åº“ï¼‰</p><p><img src="https://s2.loli.net/2024/07/10/IkmcCyEaiVK8jvT.png" alt="image-20240710175347652.png"></p><p><img src="https://s2.loli.net/2024/07/20/4xSwLQAW6PBKqYI.png" alt="image-20240720125604514.png"></p><h3 id="ç°æœ‰çš„æ¶æ„"><a href="#ç°æœ‰çš„æ¶æ„" class="headerlink" title="ç°æœ‰çš„æ¶æ„"></a>ç°æœ‰çš„æ¶æ„</h3><p><a href="https://blog.csdn.net/qq_49619863/article/details/127836283?ops_request_misc=%7B%22request_id%22:%22172060612716800222827668%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172060612716800222827668&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-127836283-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=ddd%E6%9E%B6%E6%9E%84&spm=1018.2226.3001.4187">DDDæ¶æ„-CSDNåšå®¢</a></p><p>[æµ…è°ˆæ¶æ„è®¾è®¡ï¼šMVCæ¶æ„ä¸DDDæ¶æ„ã€å¼€å‘å®è·µã€‘_dddæ¶æ„å’Œmvcæ¶æ„åŒºåˆ«-CSDNåšå®¢](<a href="https://blog.csdn.net/qq_40656637/article/details/137344153?ops_request_misc=%7B%22request_id%22:%22172145093416800184184571%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=172145093416800184184571&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-137344153-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=spring">https://blog.csdn.net/qq_40656637/article/details/137344153?ops_request_misc=%7B%22request%5Fid%22%3A%22172145093416800184184571%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D&amp;request_id=172145093416800184184571&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-137344153-null-null.142^v100^pc_search_result_base8&amp;utm_term=spring</a> mvcæ¶æ„å’Œdddæ¶æ„&amp;spm&#x3D;1018.2226.3001.4187)</p><p>ddd æ¶æ„</p><p><img src="https://s2.loli.net/2024/07/10/6L8j9VMkRHxWOga.png" alt="cbc3530efc1e41d6b6a94455d804d3d3[1].png"></p><ul><li>ç”¨æˆ·æ¥å£å±‚ï¼ˆUser Interface ï¼‰ï¼šè´Ÿè´£å‘ç”¨æˆ·æ˜¾ç¤ºä¿¡æ¯å’Œè§£é‡Šç”¨æˆ·æŒ‡ä»¤ï¼ˆæ˜¯DDDæ¶æ„ä¸­çš„è¡¨ç°å±‚ï¼‰ï¼ˆè¡¨ç°å±‚æ˜¯è§†å›¾å±‚çš„è¶…é›†ï¼Œæ¦‚å¿µæœ‰æ‰€åŒºåˆ«ï¼ŒçŸ¥é“æœ€ä¸Šå±‚å°±æ˜¯è¡¨ç°å±‚å³å¯ï¼‰</li><li>åº”ç”¨å±‚ï¼ˆApplicationï¼‰ï¼šå¾ˆâ€œè–„â€çš„ä¸€å±‚ï¼Œç†è®ºä¸Šä¸åº”è¯¥æœ‰ä¸šåŠ¡è§„åˆ™æˆ–é€»è¾‘ï¼Œä¸»è¦é¢å‘ç”¨ä¾‹å’Œæµç¨‹ç›¸å…³çš„æ“ä½œã€‚åœ¨åº”ç”¨å±‚åè°ƒå¤šä¸ªæœåŠ¡å’Œé¢†åŸŸå¯¹è±¡å®ŒæˆæœåŠ¡çš„ç»„åˆå’Œç¼–æ’ï¼Œåä½œå®Œæˆä¸šåŠ¡æ“ä½œã€‚æ­¤å¤–ï¼Œåº”ç”¨å±‚ä¹Ÿæ˜¯å¾®æœåŠ¡ä¹‹é—´äº¤äº’çš„é€šé“ï¼Œå®ƒå¯ä»¥è°ƒç”¨å…¶å®ƒå¾®æœåŠ¡çš„åº”ç”¨æœåŠ¡ï¼Œå®Œæˆå¾®æœåŠ¡ä¹‹é—´æœåŠ¡çš„ç»„åˆå’Œç¼–æ’</li><li>é¢†åŸŸå±‚ï¼ˆDomainï¼‰ï¼šæ˜¯å®ç°ä¼ä¸šæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œé€šè¿‡å„ç§æ ¡éªŒæ‰‹æ®µä¿è¯ä¸šåŠ¡çš„æ­£ç¡®æ€§ã€‚é¢†åŸŸå±‚ä¸»è¦ä½“ç°é¢†åŸŸæ¨¡å‹çš„ä¸šåŠ¡èƒ½åŠ›ï¼Œå®ƒç”¨æ¥è¡¨è¾¾ä¸šåŠ¡æ¦‚å¿µã€ä¸šåŠ¡çŠ¶æ€å’Œä¸šåŠ¡è§„åˆ™ã€‚é¢†åŸŸå±‚åŒ…å«èšåˆæ ¹ã€å®ä½“ã€å€¼å¯¹è±¡ã€é¢†åŸŸæœåŠ¡ç­‰é¢†åŸŸæ¨¡å‹ä¸­çš„é¢†åŸŸå¯¹è±¡</li><li>åŸºç¡€å±‚ï¼ˆInfrastructureï¼‰ï¼šè´¯ç©¿æ‰€æœ‰å±‚ï¼Œä¸ºå…¶å®ƒå±‚æä¾›é€šç”¨çš„æŠ€æœ¯å’ŒåŸºç¡€æœåŠ¡ï¼ŒåŒ…æ‹¬ç¬¬ä¸‰æ–¹å·¥å…·ã€é©±åŠ¨ã€æ¶ˆæ¯ä¸­é—´ä»¶ã€ç½‘å…³ã€æ–‡ä»¶ã€ç¼“å­˜ä»¥åŠæ•°æ®åº“ç­‰</li><li>ä¸ªäººç†è§£ï¼šå°†serviceå±‚æ‹†åˆ†ä¸ºäº†åº”ç”¨å±‚å’Œé¢†åŸŸå±‚ã€‚å…¶ä¸­åº”ç”¨å±‚å…³æ³¨äºç”¨ä¾‹å’Œæµç¨‹ï¼Œä¸æ¶‰åŠä¸šåŠ¡è§„åˆ™æˆ–é€»è¾‘ï¼Œé€šè¿‡ç»„åˆå’Œç¼–æ’ä¸‹å±‚çš„é¢†åŸŸå±‚æ¥å®Œæˆä¸šåŠ¡æ“ä½œã€‚è€Œé¢†åŸŸå±‚ç”¨äºå°è£…å…·ä½“çš„ä¸šåŠ¡è§„åˆ™æˆ–é€»è¾‘ï¼Œæ‹†åˆ†å‡ºæ¥çš„é¢†åŸŸå±‚ä¸å†å’Œå…·ä½“æµç¨‹å…³è”ï¼Œå®ç°äº†é«˜å†…èšå’Œä½è€¦åˆï¼Œè¿˜æé«˜äº†é¢†åŸŸå±‚çš„å¯å¤ç”¨æ€§ã€‚ç”¨æˆ·æ¥å£å±‚å’ŒåŸºç¡€å±‚åˆ™ä¸ºåŸæ¥çš„è§†å›¾å±‚å’Œdaoå±‚çš„æ‰©å±•ï¼Œæ–°å¢äº†éƒ¨åˆ†èŒè´£åŠŸèƒ½ã€‚</li></ul><p><img src="https://s2.loli.net/2024/07/10/eTX5pdGHV3OrFIB.png" alt="image-20240710175452746.png"></p><ol><li><p><strong>APIï¼ˆå¯¹å¤–æ¥å£å±‚ï¼‰</strong>ï¼šè¿™ä¸€å±‚è´Ÿè´£å®šä¹‰å¯¹å¤–æä¾›çš„æœåŠ¡æ¥å£ï¼Œé€šå¸¸ç”¨äºä¸å®¢æˆ·ç«¯æˆ–å…¶ä»–æœåŠ¡è¿›è¡Œäº¤äº’ã€‚</p></li><li><p><strong>Controller</strong>ï¼šåœ¨ä¼ ç»Ÿçš„MVCæ¶æ„ä¸­ï¼Œæ§åˆ¶å™¨ç”¨äºå¤„ç†ç”¨æˆ·çš„è¯·æ±‚ã€‚åœ¨è¿™é‡Œï¼Œå®ƒç”¨äºæ¥æ”¶APIå±‚çš„è¯·æ±‚ï¼Œå¹¶å°†è¯·æ±‚è½¬æ¢ä¸ºåº”ç”¨å±‚å¯ä»¥ç†è§£çš„æ ¼å¼ã€‚</p></li><li><p><strong>DTOï¼ˆData Transfer Objectï¼‰</strong>ï¼š</p><p>ä»£è¡¨æ•°æ®ä¼ è¾“å¯¹è±¡çš„æ„æ€</p><p>æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ä¹‹é—´ä¼ è¾“æ•°æ®çš„è½¯ä»¶åº”ç”¨ç³»ç»Ÿï¼Œæ•°æ®ä¼ è¾“ç›®æ ‡å¾€å¾€æ˜¯æ•°æ®è®¿é—®å¯¹è±¡ä»æ•°æ®åº“ä¸­æ£€ç´¢æ•°æ®</p><p>æ•°æ®ä¼ è¾“å¯¹è±¡ä¸æ•°æ®äº¤äº’å¯¹è±¡æˆ–æ•°æ®è®¿é—®å¯¹è±¡ä¹‹é—´çš„å·®å¼‚æ˜¯ä¸€ä¸ªä»¥ä¸å…·ä»»ä½•è¡Œä¸ºé™¤äº†å­˜å‚¨å’Œæ£€ç´¢çš„æ•°æ®ï¼ˆè®¿é—®å’Œå­˜å–å™¨ï¼‰</p><p>ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯<strong>æ¥å£ä¹‹é—´ä¼ é€’çš„æ•°æ®å°è£…</strong></p><p>è¡¨é‡Œé¢æœ‰åå‡ ä¸ªå­—æ®µï¼šidï¼Œnameï¼Œgenderï¼ˆM&#x2F;F)ï¼Œageâ€¦â€¦</p><p>é¡µé¢éœ€è¦å±•ç¤ºä¸‰ä¸ªå­—æ®µï¼šnameï¼Œgender(ç”·&#x2F;å¥³)ï¼Œage</p><p>DTOç”±æ­¤äº§ç”Ÿï¼Œä¸€æ˜¯èƒ½æé«˜æ•°æ®ä¼ è¾“çš„é€Ÿåº¦(å‡å°‘äº†ä¼ è¾“å­—æ®µ)ï¼ŒäºŒèƒ½éšè—åç«¯è¡¨ç»“æ„ã€‚</p></li><li><p><strong>BOï¼ˆBusiness Objectï¼‰</strong>ï¼š</p><p>ä»£è¡¨ä¸šåŠ¡å¯¹è±¡çš„æ„æ€ï¼ŒBoå°±æ˜¯æŠŠä¸šåŠ¡é€»è¾‘å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼ˆæ³¨æ„æ˜¯é€»è¾‘ï¼Œä¸šåŠ¡é€»è¾‘ï¼‰ï¼Œè¿™ä¸ªå¯¹è±¡å¯ä»¥åŒ…æ‹¬ä¸€ä¸ªæˆ–å¤šä¸ªå…¶å®ƒçš„å¯¹è±¡ã€‚é€šè¿‡è°ƒç”¨Daoæ–¹æ³•ï¼Œç»“åˆPoæˆ–Voè¿›è¡Œä¸šåŠ¡æ“ä½œã€‚</p><p>å½¢è±¡æè¿°ä¸ºä¸€ä¸ªå¯¹è±¡çš„å½¢ä¸ºå’ŒåŠ¨ä½œï¼Œå½“ç„¶ä¹Ÿæœ‰æ¶‰åŠåˆ°åŸºå®ƒå¯¹è±¡çš„ä¸€äº›å½¢ä¸ºå’ŒåŠ¨ä½œã€‚æ¯”å¦‚å¤„ç†ä¸€ä¸ªäººçš„ä¸šåŠ¡é€»è¾‘ï¼Œè¯¥äººä¼šç¡è§‰ï¼Œåƒé¥­ï¼Œå·¥ä½œï¼Œä¸Šç­ç­‰ç­‰è¡Œä¸ºï¼Œè¿˜æœ‰å¯èƒ½å’Œåˆ«äººå‘å…³ç³»çš„è¡Œä¸ºï¼Œå¤„ç†è¿™æ ·çš„ä¸šåŠ¡é€»è¾‘æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥é’ˆå¯¹BOå»å¤„ç†ã€‚</p><p>å†æ¯”å¦‚æŠ•ä¿äººæ˜¯ä¸€ä¸ªPOï¼Œè¢«ä¿é™©äººæ˜¯ä¸€ä¸ªPOï¼Œé™©ç§ä¿¡æ¯ä¹Ÿæ˜¯ä¸€ä¸ªPOç­‰ç­‰ï¼Œä»–ä»¬ç»„åˆèµ·æ¥å°±æ˜¯ä¸€å¼ ä¿å•çš„BOã€‚</p></li><li><p><strong>PO&#x2F;DO: Persistent Object &#x2F; Data Objectï¼ŒæŒä¹…å¯¹è±¡ &#x2F; æ•°æ®å¯¹è±¡ã€‚</strong></p><p>å®ƒè·ŸæŒä¹…å±‚ï¼ˆé€šå¸¸æ˜¯å…³ç³»å‹æ•°æ®åº“ï¼‰çš„æ•°æ®ç»“æ„å½¢æˆä¸€ä¸€å¯¹åº”çš„æ˜ å°„å…³ç³»ï¼Œå¦‚æœæŒä¹…å±‚æ˜¯å…³ç³»å‹æ•°æ®åº“ï¼Œé‚£ä¹ˆï¼Œæ•°æ®è¡¨ä¸­çš„æ¯ä¸ªå­—æ®µï¼ˆæˆ–è‹¥å¹²ä¸ªï¼‰å°±å¯¹åº”POçš„ä¸€ä¸ªï¼ˆæˆ–è‹¥å¹²ä¸ªï¼‰å±æ€§ã€‚</p></li><li><p><strong>VO: View Object, è§†å›¾æ¨¡å‹ï¼Œå±•ç¤ºå±‚å¯¹è±¡</strong>:</p><p>å¯¹åº”é¡µé¢æ˜¾ç¤ºï¼ˆwebé¡µé¢&#x2F;ç§»åŠ¨ç«¯H5&#x2F;Nativeè§†å›¾ï¼‰çš„æ•°æ®å¯¹è±¡ã€‚</p></li><li><p><strong>Applicationå±‚ï¼ˆåº”ç”¨å±‚ï¼‰</strong>ï¼šè¿™ä¸€å±‚åŒ…å«åº”ç”¨æœåŠ¡ï¼Œå®ƒä»¬åè°ƒé¢†åŸŸå¯¹è±¡æ¥å®Œæˆä¸šåŠ¡é€»è¾‘ã€‚å®ƒè¿˜åŒ…å«ä¸€äº›ä¸šåŠ¡é€»è¾‘çš„è½¬æ¢é€»è¾‘ï¼Œå¦‚DTOåˆ°BOçš„è½¬æ¢ã€‚</p></li><li><p><strong>Interceptor</strong>ï¼šæ‹¦æˆªå™¨ï¼Œç”¨äºåœ¨è¯·æ±‚å¤„ç†è¿‡ç¨‹ä¸­è¿›è¡Œä¸€äº›å‰ç½®æˆ–åç½®å¤„ç†ï¼Œä¾‹å¦‚æ—¥å¿—è®°å½•ã€æƒé™éªŒè¯ç­‰ã€‚</p></li><li><p><strong>Application-MQï¼ˆæ¶ˆè´¹è€…ï¼‰&#x2F; Application-Job</strong>ï¼šè¿™æŒ‡çš„æ˜¯åº”ç”¨å±‚ä¸­å¤„ç†æ¶ˆæ¯é˜Ÿåˆ—æ¶ˆæ¯çš„ç»„ä»¶ï¼Œæˆ–è€…å®šæ—¶ä»»åŠ¡çš„å¤„ç†ã€‚</p></li><li><p><strong>Domainå±‚ï¼ˆé¢†åŸŸå±‚ï¼‰</strong>ï¼šè¿™æ˜¯DDDä¸­çš„æ ¸å¿ƒå±‚ï¼ŒåŒ…å«ä¸šåŠ¡é€»è¾‘å’Œé¢†åŸŸæ¨¡å‹ã€‚é¢†åŸŸå±‚ä¸“æ³¨äºä¸šåŠ¡è§„åˆ™å’Œä¸šåŠ¡å®ä½“ã€‚</p></li><li><p><strong>Service</strong>ï¼šé¢†åŸŸæœåŠ¡ï¼Œæ‰§è¡Œé¢†åŸŸé€»è¾‘ä½†ä¸è‡ªç„¶å±äºä»»ä½•å®ä½“æˆ–å€¼å¯¹è±¡çš„æ“ä½œã€‚</p></li><li><p><strong>Entity&#x2F;POï¼ˆPersistent Objectï¼‰</strong>ï¼šæŒä¹…åŒ–å¯¹è±¡ï¼Œé€šå¸¸ä¸æ•°æ®åº“å­˜å‚¨ç›¸å…³ï¼Œä»£è¡¨æ•°æ®åº“ä¸­çš„è®°å½•ã€‚</p></li><li><p><strong>Mapper</strong>ï¼šæ•°æ®è®¿é—®å¯¹è±¡ï¼Œç”¨äºå°†é¢†åŸŸå¯¹è±¡æ˜ å°„åˆ°æ•°æ®åº“è¡¨ã€‚</p></li><li><p><strong>Infraå±‚ï¼ˆåŸºç¡€è®¾æ–½å±‚ï¼‰</strong>ï¼šæä¾›æŠ€æœ¯å®ç°ï¼Œå¦‚æ•°æ®åº“è®¿é—®ã€æ¶ˆæ¯ä¼ é€’ã€å¤–éƒ¨æœåŠ¡è°ƒç”¨ç­‰ã€‚</p></li><li><p><strong>RPC</strong>ï¼šè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œç”¨äºæœåŠ¡ä¹‹é—´çš„é€šä¿¡ã€‚</p></li><li><p><strong>MGï¼ˆç”Ÿäº§è€…ï¼‰</strong>ï¼šæŒ‡çš„æ˜¯æ¶ˆæ¯ç”Ÿæˆè€…ï¼Œè´Ÿè´£ç”Ÿæˆå¹¶å‘é€æ¶ˆæ¯åˆ°æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p></li><li><p><strong>Starterï¼ˆå¯åŠ¨å±‚ï¼‰</strong>ï¼šæŒ‡çš„æ˜¯æœåŠ¡å¯åŠ¨æ—¶éœ€è¦è‡ªåŠ¨æ‰§è¡Œçš„ä»£ç æˆ–é…ç½®ã€‚</p></li><li><p><strong>Aggressiveï¼ˆèšåˆå±‚ï¼‰</strong>ï¼šèšåˆå±‚ï¼Œå°†å¤šä¸ªé¢†åŸŸå¯¹è±¡èšåˆæˆä¸€ä¸ªæ›´å¤§çš„ä¸šåŠ¡å®ä½“ã€‚</p></li><li><p><strong>Config</strong>ï¼šé…ç½®å±‚ï¼Œç”¨äºå­˜å‚¨å’Œè®¿é—®é…ç½®ä¿¡æ¯ã€‚</p></li><li><p><strong>Dictï¼ˆå­—å…¸ï¼‰</strong>ï¼šæŒ‡çš„æ˜¯æ•°æ®å­—å…¸ï¼Œç”¨äºå­˜å‚¨ä¸€äº›å›ºå®šçš„æ•°æ®æˆ–æ˜ å°„å…³ç³»ã€‚</p></li><li><p><strong>Commonï¼ˆå…¬å…±å±‚ï¼‰</strong>ï¼šåŒ…å«æ•´ä¸ªåº”ç”¨ä¸­å¤šä¸ªåœ°æ–¹ä¼šç”¨åˆ°çš„é€šç”¨ä»£ç æˆ–å·¥å…·ã€‚</p></li><li><p><strong>Enums</strong>ï¼šæšä¸¾ï¼Œç”¨äºå®šä¹‰ä¸€ç»„å‘½åçš„å¸¸é‡ã€‚</p></li><li><p><strong>Utils</strong>ï¼šå·¥å…·ç±»ï¼Œæä¾›ä¸€äº›é€šç”¨çš„è¾…åŠ©åŠŸèƒ½ã€‚</p></li></ol><p>req-&gt;dto-&gt;do-&gt;bo-&gt;entity-&gt;po</p><p><img src="https://s2.loli.net/2024/07/10/vcwy8WMZKz7pNSe.jpg" alt="UBWaSonlxTkZyGs[1].jpg"></p><h3 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h3><p><img src="https://s2.loli.net/2024/07/17/YwcR1HeWvrqD72s.png" alt="image-20240717163452115.png"></p><h4 id="åç«¯é¡¹ç›®ç›®å½•ï¼ˆbackendï¼‰"><a href="#åç«¯é¡¹ç›®ç›®å½•ï¼ˆbackendï¼‰" class="headerlink" title="åç«¯é¡¹ç›®ç›®å½•ï¼ˆbackendï¼‰"></a>åç«¯é¡¹ç›®ç›®å½•ï¼ˆbackendï¼‰</h4><ul><li><p><strong>asyncTool</strong>: åŒ…å«å¼‚æ­¥å¤„ç†å·¥å…·æˆ–åº“ï¼Œç”¨äºå¤„ç†å¼‚æ­¥ä»»åŠ¡ã€‚</p></li><li><p><strong>doc</strong>: å­˜æ”¾é¡¹ç›®æ–‡æ¡£ï¼Œå¦‚APIæ–‡æ¡£ã€æŠ€æœ¯è§„èŒƒç­‰ã€‚</p></li><li><p><strong>jc-club-auth</strong>: è®¤è¯æœåŠ¡ï¼Œè´Ÿè´£ç”¨æˆ·è®¤è¯å’Œæˆæƒã€‚</p></li><li><p><strong>jc-club-circle</strong>: å¯èƒ½ä¸ç¤¾åŒºåœˆå­æˆ–ç”¨æˆ·ç»„ç›¸å…³åŠŸèƒ½ã€‚</p></li><li><p><strong>jc-club-common-starter</strong>: é€šç”¨å¯åŠ¨å™¨æˆ–å·¥å…·ç±»ï¼Œæä¾›é¡¹ç›®é€šç”¨åŠŸèƒ½ã€‚</p></li><li><p><strong>jc-club-gateway</strong>: ç½‘å…³æœåŠ¡ï¼Œè´Ÿè´£è¯·æ±‚è·¯ç”±ã€è´Ÿè½½å‡è¡¡ç­‰ã€‚</p></li><li><p><strong>jc-club-gen</strong>: ä»£ç ç”Ÿæˆå·¥å…·ï¼Œå¯èƒ½ç”¨äºå¿«é€Ÿç”Ÿæˆé¡¹ç›®ä»£ç ã€‚</p></li><li><p><strong>jc-club-interview</strong>: é¢è¯•ç›¸å…³åŠŸèƒ½ï¼Œå¯èƒ½åŒ…å«é¢è¯•é¢˜åº“æˆ–æ¨¡æ‹Ÿé¢è¯•ã€‚</p></li><li><p><strong>jc-club-oss</strong>: å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼Œç”¨äºç®¡ç†æ–‡ä»¶å­˜å‚¨ã€‚</p><ul><li><a href="https://blog.csdn.net/Java_Mr_Jin/article/details/125643455?ops_request_misc=%7B%22request_id%22:%22172205057816800211579712%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172205057816800211579712&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-125643455-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=minio&spm=1018.2226.3001.4187">minioå®‰è£…éƒ¨ç½²åŠä½¿ç”¨-CSDNåšå®¢</a></li></ul></li><li><p><strong>jc-club-practice</strong>: å®è·µé¡¹ç›®æˆ–ç¤ºä¾‹ä»£ç ã€‚</p></li><li><p><strong>jc-club-subject</strong>: ä¸»é¢˜æˆ–è¯¾ç¨‹ç›¸å…³åŠŸèƒ½ï¼Œå¯èƒ½ç”¨äºæ•™è‚²æˆ–åŸ¹è®­ã€‚</p></li><li><p><strong>jc-club-wx</strong>: å¾®ä¿¡ç›¸å…³åŠŸèƒ½ï¼Œå¯èƒ½åŒ…å«å¾®ä¿¡å…¬ä¼—å·æ¥å£æˆ–å°ç¨‹åºæ”¯æŒã€‚</p></li></ul><h2 id="æŠ€æœ¯é€‰å‹"><a href="#æŠ€æœ¯é€‰å‹" class="headerlink" title="æŠ€æœ¯é€‰å‹"></a>æŠ€æœ¯é€‰å‹</h2><p>[Springå’ŒSpring Bootä¹‹é—´çš„åŒºåˆ«ï¼ˆå°ç»“ï¼‰_springå’Œspringbootçš„åŒºåˆ«-CSDNåšå®¢](<a href="https://blog.csdn.net/mengxin_chen/article/details/116240326?ops_request_misc=%7B%22request_id%22:%22172145220016800227442776%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172145220016800227442776&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-116240326-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=spring%E5%92%8Cspring">https://blog.csdn.net/mengxin_chen/article/details/116240326?ops_request_misc=%7B%22request%5Fid%22%3A%22172145220016800227442776%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172145220016800227442776&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-116240326-null-null.142^v100^pc_search_result_base8&amp;utm_term=springå’Œspring</a> bootåŒºåˆ«&amp;spm&#x3D;1018.2226.3001.4187)</p><p><img src="https://s2.loli.net/2024/07/10/SRyfeJV49ksGvNl.png" alt="image-20240710163626898.png"></p><h2 id="SpringBootç›¸å…³"><a href="#SpringBootç›¸å…³" class="headerlink" title="SpringBootç›¸å…³"></a>SpringBootç›¸å…³</h2><h3 id="SpringBootæ³¨è§£"><a href="#SpringBootæ³¨è§£" class="headerlink" title="SpringBootæ³¨è§£"></a>SpringBootæ³¨è§£</h3><p><a href="https://blog.csdn.net/weixin_45797022/article/details/120896184?ops_request_misc=%7B%22request_id%22:%22172161940916800222815761%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172161940916800222815761&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-120896184-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=autowired&spm=1018.2226.3001.4187">@Autowiredç”¨æ³•è¯¦è§£-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/qq_28289405/article/details/82185676?ops_request_misc=%7B%22request_id%22:%22172161976516800227461344%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172161976516800227461344&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-82185676-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=RestController%E6%B3%A8%E8%A7%A3&spm=1018.2226.3001.4187">@RestController æ³¨è§£_@restcontrolleræ³¨è§£-CSDNåšå®¢</a></p><p>Mybatis:<a href="https://blog.csdn.net/weixin_46369022/article/details/122755858?ops_request_misc=%7B%22request_id%22:%22172162002416800178517757%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172162002416800178517757&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-1-122755858-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=@Mapper%E6%B3%A8%E8%A7%A3&spm=1018.2226.3001.4187">@Mapperæ³¨è§£-CSDNåšå®¢</a> ç»™Daoç”¨çš„</p><p>mapstructï¼š[MAPSTRUCT(@Mapperç”¨æ³•)_org.mapstruct.mapper maven-CSDNåšå®¢](<a href="https://blog.csdn.net/qq_43459184/article/details/103372740?ops_request_misc=%7B%22request_id%22:%22172259704016800180642299%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172259704016800180642299&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-103372740-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=mapstruct">https://blog.csdn.net/qq_43459184/article/details/103372740?ops_request_misc=%7B%22request%5Fid%22%3A%22172259704016800180642299%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172259704016800180642299&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-103372740-null-null.142^v100^pc_search_result_base8&amp;utm_term=mapstruct</a> @mapper&amp;spm&#x3D;1018.2226.3001.4187)</p><p><a href="https://blog.csdn.net/weixin_47872288/article/details/138509834?ops_request_misc=%7B%22request_id%22:%22172162036516800226577013%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172162036516800226577013&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-138509834-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=@Service%E6%B3%A8%E8%A7%A3&spm=1018.2226.3001.4187">è¯¦ç»†åˆ†æJavaä¸­çš„@Serviceæ³¨è§£-CSDNåšå®¢</a></p><p>[ä»‹ç»@Componentï¼Œ@Beanï¼Œ@serviceï¼Œ@Autowire å’Œ @Resourceç­‰_@service @bean-CSDNåšå®¢](<a href="https://blog.csdn.net/weixin_38002126/article/details/122977500?ops_request_misc=%7B%22request_id%22:%22172162091816800186516004%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172162091816800186516004&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-122977500-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=@service%E5%92%8C@component">https://blog.csdn.net/weixin_38002126/article/details/122977500?ops_request_misc=%7B%22request%5Fid%22%3A%22172162091816800186516004%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172162091816800186516004&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-122977500-null-null.142^v100^pc_search_result_base8&amp;utm_term=@serviceå’Œ@component</a> @bean @a&amp;spm&#x3D;1018.2226.3001.4187)</p><h3 id="SpringBoot-ioc-aop"><a href="#SpringBoot-ioc-aop" class="headerlink" title="SpringBoot ioc aop"></a>SpringBoot ioc aop</h3><p>[æ·±å…¥ç†è§£Springä¸¤å¤§ç‰¹æ€§ï¼šIoCå’ŒAOP-CSDNåšå®¢](<a href="https://blog.csdn.net/dkbnull/article/details/87219562?ops_request_misc=%7B%22request_id%22:%22172243396116800182129949%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172243396116800182129949&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-87219562-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=SPRING">https://blog.csdn.net/dkbnull/article/details/87219562?ops_request_misc=%7B%22request%5Fid%22%3A%22172243396116800182129949%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172243396116800182129949&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-87219562-null-null.142^v100^pc_search_result_base8&amp;utm_term=SPRING</a> BOOT AOP ioc&amp;spm&#x3D;1018.2226.3001.4187)</p><p><a href="https://blog.csdn.net/u013190145/article/details/109171013?ops_request_misc=%7B%22request_id%22:%22172243433616800213010408%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172243433616800213010408&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-109171013-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=%E8%BF%9E%E6%8E%A5%E7%82%B9%E5%92%8C%E5%88%87%E5%85%A5%E7%82%B9%E7%9A%84%E5%8C%BA%E5%88%AB&spm=1018.2226.3001.4187">AOPçš„è¿æ¥ç‚¹ä¸åˆ‡ç‚¹åŒºåˆ«ï¼Œè¿æ¥ç‚¹ï¼Œåˆ‡ç‚¹ï¼Œåˆ‡é¢çš„åŸºç¡€æ¦‚å¿µ_aopè¿æ¥ç‚¹-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/weixin_42649617/article/details/109997718?ops_request_misc=&request_id=&biz_id=102&utm_term=%E8%BF%9E%E6%8E%A5%E7%82%B9%E5%92%8C%E5%88%87%E5%85%A5%E7%82%B9%E7%9A%84%E5%8C%BA%E5%88%AB&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-109997718.142%5Ev100%5Epc_search_result_base8&spm=1018.2226.3001.4187">Spring AOPæœ¯è¯­ï¼šè¿æ¥ç‚¹å’Œåˆ‡ç‚¹çš„åŒºåˆ«ã€‚_åˆ‡å…¥ç‚¹ è¿æ¥ç‚¹ åŒºåˆ«-CSDNåšå®¢</a></p><h2 id="Mybatis"><a href="#Mybatis" class="headerlink" title="Mybatis"></a>Mybatis</h2><p><a href="https://blog.csdn.net/Bb15070047748/article/details/107188167/?ops_request_misc=&request_id=&biz_id=102&utm_term=&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-107188167.nonecase&spm=1018.2226.3001.4187#{}&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-107188167.nonecase">å½»åº•ææ‡‚MyBaitsä¸­#{}å’Œ${}çš„åŒºåˆ«_mybatis #{}-CSDNåšå®¢</a></p><p>[mybatisä¸­resultMapçš„ç†è§£_result map-CSDNåšå®¢](<a href="https://blog.csdn.net/u012843873/article/details/80198185?ops_request_misc=%7B%22request_id%22:%22172259150816800178584486%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172259150816800178584486&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-80198185-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=mybatic">https://blog.csdn.net/u012843873/article/details/80198185?ops_request_misc=%7B%22request%5Fid%22%3A%22172259150816800178584486%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172259150816800178584486&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-80198185-null-null.142^v100^pc_search_result_base8&amp;utm_term=mybatic</a> resultmap&amp;spm&#x3D;1018.2226.3001.4187)</p><p><a href="https://blog.csdn.net/libusi001/article/details/134155913?ops_request_misc=&request_id=&biz_id=102&utm_term=mybatis%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-4-134155913.142%5Ev100%5Epc_search_result_base8&spm=1018.2226.3001.4187">ã€Mybatisã€‘xmlå¸¸ç”¨æ€»ç»“ï¼ˆæŒç»­æ›´æ–°ï¼‰_mybatis xml-CSDNåšå®¢</a></p><p>[SpringBoot+MyBatisé¡¹ç›®Daoå±‚æœ€ç®€å•å†™æ³•_springboot daoå±‚æ€ä¹ˆå†™-CSDNåšå®¢](<a href="https://blog.csdn.net/iiiliuyang/article/details/104162463?ops_request_misc=&request_id=&biz_id=102&utm_term=springboot">https://blog.csdn.net/iiiliuyang/article/details/104162463?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=springboot</a> dao.xmlå†™æ³•&amp;utm_medium&#x3D;distribute.pc_search_result.none-task-blog-2<del>all</del>sobaiduweb~default-2-104162463.142^v100^pc_search_result_base8&amp;spm&#x3D;1018.2226.3001.4187)</p><p>[Spring Bootä¸“æ å…­ï¼šåœ¨Dao.xmlæ–‡ä»¶ä¸­å†™Mybatisè¯­å¥_springboot dao xml-CSDNåšå®¢](<a href="https://blog.csdn.net/DTDanteDong/article/details/112606910?ops_request_misc=%7B%22request_id%22:%22172243518216800222895850%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172243518216800222895850&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-112606910-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=springboot">https://blog.csdn.net/DTDanteDong/article/details/112606910?ops_request_misc=%7B%22request%5Fid%22%3A%22172243518216800222895850%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172243518216800222895850&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-112606910-null-null.142^v100^pc_search_result_base8&amp;utm_term=springboot</a> dao.xmlå†™æ³•&amp;spm&#x3D;1018.2226.3001.4187)</p><p>[Mybatisä¸­åŠ¨æ€Sqlçš„ifã€forå’Œforeachä½¿ç”¨_mybatis foreach if open-CSDNåšå®¢](<a href="https://blog.csdn.net/wflsyf/article/details/112984282?ops_request_misc=%7B%22request_id%22:%22172259182216800226531598%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172259182216800226531598&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-112984282-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=mybatis">https://blog.csdn.net/wflsyf/article/details/112984282?ops_request_misc=%7B%22request%5Fid%22%3A%22172259182216800226531598%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172259182216800226531598&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-112984282-null-null.142^v100^pc_search_result_base8&amp;utm_term=mybatis</a> if test foreach&amp;spm&#x3D;1018.2226.3001.4187)</p><p>daoçš„æ¥å£æ”¾åœ¨mapperåŒ…ä¸‹ï¼Œåœ¨å¯åŠ¨ç±»å‰è¦åŠ @MapperScan(â€œcom.**.mapperâ€)ï¼Œä¾¿äºå‘ç°ï¼š<a href="https://blog.csdn.net/zzxcvbnm19/article/details/103275920?ops_request_misc=%7B%22request_id%22:%22172259218016800226519050%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=172259218016800226519050&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-103275920-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=mapperscan%E5%92%8Cdao&spm=1018.2226.3001.4187">blog.csdn.net&#x2F;zzxcvbnm19&#x2F;article&#x2F;details&#x2F;103275920?ops_request_misc&#x3D;%257B%2522request%255Fid%2522%253A%2522172259218016800226519050%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id&#x3D;172259218016800226519050&amp;biz_id&#x3D;0&amp;utm_medium&#x3D;distribute.pc_search_result.none-task-blog-2<del>all</del>first_rank_ecpm_v1~rank_v31_ecpm-1-103275920-null-null.142^v100^pc_search_result_base8&amp;utm_term&#x3D;mapperscanå’Œdao&amp;spm&#x3D;1018.2226.3001.4187</a></p><p>[springå’ŒMybatisä¸­çš„æ‹¦æˆªå™¨_mybatis handlerinterceptor-CSDNåšå®¢](<a href="https://blog.csdn.net/qq_59612674/article/details/121027506?ops_request_misc=%7B%22request_id%22:%22172388427716800178552460%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=172388427716800178552460&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-2-121027506-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=mybatis">https://blog.csdn.net/qq_59612674/article/details/121027506?ops_request_misc=%7B%22request%5Fid%22%3A%22172388427716800178552460%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D&amp;request_id=172388427716800178552460&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-2-121027506-null-null.142^v100^pc_search_result_base8&amp;utm_term=mybatis</a> innovation&amp;spm&#x3D;1018.2226.3001.4187)</p><h2 id="Javaç›¸å…³"><a href="#Javaç›¸å…³" class="headerlink" title="Javaç›¸å…³"></a>Javaç›¸å…³</h2><h3 id="Stream"><a href="#Stream" class="headerlink" title="Stream"></a>Stream</h3><p>[è®²é€JAVA Streamçš„collectç”¨æ³•ä¸åŸç†ï¼Œè¿œæ¯”ä½ æƒ³è±¡çš„æ›´å¼ºå¤§_stream.collection-CSDNåšå®¢](<a href="https://blog.csdn.net/veezean/article/details/125857074?ops_request_misc=%7B%22request_id%22:%22172258578116800227423214%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172258578116800227423214&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-125857074-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=Java">https://blog.csdn.net/veezean/article/details/125857074?ops_request_misc=%7B%22request%5Fid%22%3A%22172258578116800227423214%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172258578116800227423214&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-125857074-null-null.142^v100^pc_search_result_base8&amp;utm_term=Java</a> stream collect&amp;spm&#x3D;1018.2226.3001.4187)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ„å»ºç¼“å­˜key</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">buildKey</span><span class="params">(String... strObjs)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Stream.of(strObjs).collect(Collectors.joining(CACHE_KEY_SEPARATOR));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>[Javaâ€“Streamæµè¯¦è§£_java stream-CSDNåšå®¢](<a href="https://blog.csdn.net/MinggeQingchun/article/details/123184273?ops_request_misc=%7B%22request_id%22:%22172258592916800182196501%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172258592916800182196501&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-123184273-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=Java">https://blog.csdn.net/MinggeQingchun/article/details/123184273?ops_request_misc=%7B%22request%5Fid%22%3A%22172258592916800182196501%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172258592916800182196501&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-123184273-null-null.142^v100^pc_search_result_base8&amp;utm_term=Java</a> streamæµ&amp;spm&#x3D;1018.2226.3001.4187)</p><p>streamçš„åˆ›å»ºï¼š</p><ol><li>Stream.of(1,2,3,4)    ï¼ˆè¿™é‡Œé¢çš„1,2,3,4å…¶å®æ˜¯Arrayçš„ç±»å‹ï¼‰</li><li>list.stream()</li></ol><p>æ“ä½œç¬¦</p><ol><li>ä¸­é—´æ“ä½œç¬¦<ol><li>filterï¼šç”¨äºè¿‡æ»¤ <ul><li>list.stream().filter(number-&gt;number&gt;&#x3D;2).collect(Collectors.toList());</li></ul></li><li>mapï¼šç”¨äºæ˜ å°„ <ul><li>list.stream().(str-&gt;str+â€-ITâ€).collect(Collectors.toList());</li></ul></li><li>dinstinct:  ç”¨äºå»é‡ <ul><li>numbers.stream().filter(i -&gt; i % 2 &#x3D;&#x3D; 0).distinct().forEach(System.out::println);<a href="https://blog.csdn.net/qq_36929361/article/details/84926277?ops_request_misc=%7B%22request_id%22:%22172258713216800188592335%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172258713216800188592335&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-84926277-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=System.out::println&spm=1018.2226.3001.4187&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT1TeXN0ZW0ub3V0JTNBJTNBcHJpbnRsbiZ0PSZ1PSZ1cnc9">æ•™ä½ çœ‹æ‡‚System.out::println-CSDNåšå®¢</a></li></ul></li><li>sorted: ç”¨äºæ’åº  <ul><li>strings1.stream().sorted().collect(Collectors.toList());</li></ul></li></ol></li><li>ç»ˆç«¯æ“ä½œç¬¦<ol><li>collect: æ”¶é›†å™¨ï¼Œå°†æµè½¬æ¢ä¸ºå…¶ä»–å½¢å¼ <ul><li>strings.stream().collect(Collectors.toSet()); </li><li>strings.stream().collect(Collectors.toList());</li></ul></li><li>forEach:éå†æµ<ul><li>strings.stream().forEach(s -&gt; out.println(s));</li></ul></li></ol></li></ol><h3 id="Lamdaè¡¨è¾¾å¼"><a href="#Lamdaè¡¨è¾¾å¼" class="headerlink" title="Lamdaè¡¨è¾¾å¼"></a>Lamdaè¡¨è¾¾å¼</h3><p><a href="https://blog.csdn.net/m0_64102491/article/details/127272988?ops_request_misc=%7B%22request_id%22:%22172258673416800213030674%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172258673416800213030674&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-127272988-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=lamda%E8%A1%A8%E8%BE%BE%E5%BC%8F&spm=1018.2226.3001.4187&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDEuMjEwMS4zMDAxLjQ0OTgmcT1sYW1kYSVFOCVBMSVBOCVFOCVCRSVCRSVFNSVCQyU4RiZ0PSZ1PQ==">Lambdaè¡¨è¾¾å¼è¯¦è§£_lamdaè¡¨è¾¾å¼-CSDNåšå®¢</a></p><p>å½¢å¦‚ä»¥ä¸‹ï¼š</p><blockquote><p>(o1,o2) -&gt; Integer.compare(o1,o2)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å·¦è¾¹-&gt;å³è¾¹</span><br></pre></td></tr></table></figure></blockquote><ul><li><code>-&gt;</code> è¢«ç§°ä¸ºlambdaæ“ä½œç¬¦æˆ–ç®­å¤´æ“ä½œç¬¦</li><li><code>å·¦è¾¹</code>ï¼šlambdaå½¢å‚åˆ—è¡¨ï¼ˆå…¶å®å°±æ˜¯æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•çš„å½¢å‚åˆ—è¡¨ï¼‰</li><li><code>å³è¾¹</code>ï¼šlambdaä½“ ï¼ˆå…¶å®å°±æ˜¯é‡å†™çš„æŠ½è±¡æ–¹æ³•çš„æ–¹æ³•ä½“ï¼‰</li></ul><h3 id="çº¿ç¨‹æ± "><a href="#çº¿ç¨‹æ± " class="headerlink" title="çº¿ç¨‹æ± "></a>çº¿ç¨‹æ± </h3><p>[javaçº¿ç¨‹æ± ï¼ˆç®€å•æ˜“æ‡‚ï¼‰-CSDNåšå®¢](<a href="https://blog.csdn.net/qq_64680177/article/details/131445798?ops_request_misc=%7B%22request_id%22:%22172277205216800186576272%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=172277205216800186576272&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-2-131445798-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=java%E7%BA%BF%E7%A8%8B%E6%B1%A0">https://blog.csdn.net/qq_64680177/article/details/131445798?ops_request_misc=%7B%22request%5Fid%22%3A%22172277205216800186576272%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D&amp;request_id=172277205216800186576272&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-2-131445798-null-null.142^v100^pc_search_result_base8&amp;utm_term=javaçº¿ç¨‹æ± </a> ç®€å•æ˜“æ‡‚&amp;spm&#x3D;1018.2226.3001.4187)</p><p><a href="https://blog.csdn.net/zhaofuqiangmycomm/article/details/83029165?ops_request_misc=%7B%22request_id%22:%22172277227416800182718329%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172277227416800182718329&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-83029165-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=newCachedThreadPool&spm=1018.2226.3001.4187">Javaå››ç§çº¿ç¨‹æ± newCachedThreadPool,newFixedThreadPool,newScheduledThreadPool,newSingle-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/leilei1366615/article/details/131330243?ops_request_misc=%7B%22request_id%22:%22172277262116800222879851%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172277262116800222879851&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-131330243-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=%E7%BA%BF%E7%A8%8B%E6%B1%A0submit%E5%92%8Cexcute&spm=1018.2226.3001.4187">JAVAçº¿ç¨‹æ± submitè¯¦è§£ ï¼Œexecuteå’Œsubmitæäº¤ä»»åŠ¡çš„åŒºåˆ«_executor.submit-CSDNåšå®¢</a></p><p>ç»§æ‰¿çš„ExecutorServiceæ¥å£</p><ul><li><p><strong>newCachedThreadPool</strong>ï¼ˆæ²¡æœ‰ä¸Šé™çš„çº¿ç¨‹æ± ï¼‰ï¼Œå¦‚æœçº¿ç¨‹æ± é•¿åº¦è¶…è¿‡å¤„ç†éœ€è¦ï¼Œå¯çµæ´»å›æ”¶ç©ºé—²çº¿ç¨‹ï¼Œè‹¥æ— å¯å›æ”¶ï¼Œåˆ™æ–°å»ºçº¿ç¨‹ã€‚</p><ul><li><pre><code class="java">ExecutorService cachedThreadPool = Executors.newCachedThreadPool();cachedThreadPool.execute(new Runnable()&#123;    @Override    public void run() &#123;        System.out.println(&quot;æ‰§è¡Œçº¿ç¨‹ä»»åŠ¡&quot;);&#125;)<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- **newFixdedThreadPool**ï¼ˆæœ‰ä¸Šé™çš„çº¿ç¨‹æ± ï¼‰ï¼Œåˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œå¯æ§åˆ¶çº¿ç¨‹æœ€å¤§å¹¶å‘æ•°ï¼Œè¶…å‡ºçš„çº¿ç¨‹ä¼šåœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚</span><br><span class="line"></span><br><span class="line">  - ```</span><br><span class="line">    ExecutorService fixedThreadPool = Executors.newFixedThreadPool(3);</span><br><span class="line">    fixedThreadPool.execute(new Runnable()&#123;</span><br><span class="line">        @Override</span><br><span class="line">        public void run() &#123;</span><br><span class="line">            System.out.println(&quot;æ‰§è¡Œçº¿ç¨‹ä»»åŠ¡&quot;);</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure></code></pre></li></ul></li><li><p><strong>newScheduledThreadPool</strong>ï¼Œåˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œæ”¯æŒå®šæ—¶åŠå‘¨æœŸæ€§ä»»åŠ¡æ‰§è¡Œã€‚å»¶è¿Ÿæ‰§è¡Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><ul><li><pre><code class="java">ScheduledExecutorService scheduledThreadPool = Executors.newScheduledThreadPool(5);scheduledThreadPool.schedule(new Runnable() &#123;    @Override    public void run() &#123;        System.out.println(&quot;delay 3 seconds&quot;);    &#125;&#125;, 3, TimeUnit.SECONDS);//å»¶è¿Ÿä¸‰ç§’æ‰§è¡Œ<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- **newSingleThreadExecutor**ï¼Œåˆ›å»ºä¸€ä¸ª**å•çº¿ç¨‹åŒ–**çš„çº¿ç¨‹æ± ï¼Œå®ƒåªä¼šç”¨å”¯ä¸€çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œä¿è¯æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§æŒ‡å®šé¡ºåº(FIFO, LIFO, ä¼˜å…ˆçº§)æ‰§è¡Œã€‚</span><br><span class="line"></span><br><span class="line">- **ThreadPoolExecutor**ï¼ˆè‡ªå®šä¹‰åˆ›å»ºçº¿ç¨‹æ± ï¼‰</span><br><span class="line"></span><br><span class="line">  - å®ƒæœ€é•¿çš„æ„é€ æ–¹æ³•æœ‰ä¸ƒä¸ªå‚æ•°ã€‚</span><br><span class="line"></span><br><span class="line">    1. æ ¸å¿ƒçº¿ç¨‹æ•°é‡â€”â€”åœ¨çº¿ç¨‹æ± å½“ä¸­æ— è®ºç©ºé—²å¤šä¹…éƒ½ä¸ä¼šè¢«åˆ é™¤çš„çº¿ç¨‹</span><br><span class="line">    2. çº¿ç¨‹æ± å½“ä¸­æœ€å¤§çš„çº¿ç¨‹æ•°é‡â€”â€”çº¿ç¨‹æ± å½“ä¸­æœ€å¤§èƒ½åˆ›å»ºçš„çº¿ç¨‹æ•°é‡</span><br><span class="line">    3. ç©ºé—²æ—¶é—´ï¼ˆæ•°å€¼ï¼‰â€”â€”ä¸´æ—¶çº¿ç¨‹ï¼ˆçº¿ç¨‹æ± ä¸­å‡ºæ ¸å¿ƒçº¿ç¨‹ä¹‹å¤–çš„çº¿ç¨‹ï¼‰ç©ºé—²äº†å¤šä¹…å°±ä¼šè¢«æ·˜æ±°çš„æ—¶é—´ã€‚</span><br><span class="line">    4. ç©ºé—²æ—¶é—´ï¼ˆå•ä½ï¼‰â€”â€”ä¸´æ—¶çº¿ç¨‹ç©ºé—²äº†å¤šä¹…å°±ä¼šè¢«æ·˜æ±°çš„æ—¶é—´å•ä½ï¼Œè¦ç”¨æšä¸¾ç±»TimeUnitç±»ä½œä¸ºå‚æ•°</span><br><span class="line">    5. é˜»å¡é˜Ÿåˆ—â€”â€”å°±æ˜¯åˆ›å»ºä¸€ä¸ªé˜»å¡é˜Ÿåˆ—ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œå°±æ˜¯å½“çº¿ç¨‹æ± å½“ä¸­çº¿ç¨‹æ•°é‡å·²ç»è¾¾åˆ°äº†æœ€å¤§çº¿ç¨‹æ•°é‡ï¼Œå…è®¸å¤šå°‘ä¸ªä»»åŠ¡æ’é˜Ÿè·å–çº¿ç¨‹ï¼Œå…¶ä½™çš„ç”¨å‚æ•°ä¸ƒé‚£ä¸ªæ–¹æ¡ˆæ¥å¤„ç†ã€‚</span><br><span class="line">    6. åˆ›å»ºçº¿ç¨‹çš„æ–¹å¼â€”â€”ä¸æ˜¯newä¸€ä¸ªçº¿ç¨‹ï¼Œè€Œæ˜¯ä¼ å…¥ä¸€ä¸ªçº¿ç¨‹å·¥å‚ï¼ˆä¾‹å¦‚ï¼šExecutorså·¥å…·ç±»ä¸­çš„defaultThreadFactoryæ–¹æ³•è¿”å›çš„å°±æ˜¯ä¸€ä¸ªçº¿ç¨‹å·¥å‚ï¼‰</span><br><span class="line">    7. è¦æ‰§è¡Œçš„ä»»åŠ¡è¿‡å¤šæ—¶çš„è§£å†³æ–¹æ¡ˆâ€”â€”å½“ç­‰å¾…é˜Ÿåˆ—ä¸­ä¹Ÿæ’æ»¡æ—¶è¦æ€ä¹ˆå¤„ç†è¿™äº›ä»»åŠ¡(ä»»åŠ¡æ‹’ç»ç­–ç•¥)</span><br><span class="line"></span><br><span class="line">  - ```java</span><br><span class="line">    </span><br><span class="line">    //ä»£ç å®ç°</span><br><span class="line">       /**</span><br><span class="line">         * ä¹‹å‰ç”¨å·¥å…·ç±»è¿›è¡Œåˆ›å»ºï¼Œæœ‰å¥½å¤šå‚æ•°ä¸èƒ½è‡ªå·±è®¾ç½®</span><br><span class="line">         * å’±ç›´æ¥è‡ªå·±æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ï¼Œè‡ªå·±è®¾ç½®å‚æ•°</span><br><span class="line">         * å‚æ•°ä¸€ï¼šæ ¸å¿ƒçº¿ç¨‹æ•°é‡                           ä¸èƒ½å°äº0</span><br><span class="line">         * å‚æ•°äºŒï¼šæœ€å¤§çº¿ç¨‹æ•°                             ä¸èƒ½å°äº0ï¼Œæ•°å€¼å¤§äºç­‰äºæ ¸å¿ƒçº¿ç¨‹æ•°é‡</span><br><span class="line">         * å‚æ•°ä¸‰ï¼šç©ºé—²ä¸´æ—¶çº¿ç¨‹æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆæ•°å€¼ï¼‰           ä¸èƒ½å°äº0</span><br><span class="line">         * å‚æ•°å››ï¼šç©ºé—²ä¸´æ—¶çº¿ç¨‹æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆå•ä½ï¼‰            ç”¨TimeUnitè¿™ä¸ªæšä¸¾ç±»è¡¨ç¤º</span><br><span class="line">         * å‚æ•°äº”ï¼šä»»åŠ¡é˜Ÿåˆ—ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå µå¡é˜Ÿåˆ—               ä¸èƒ½ä¸ºnull</span><br><span class="line">         * å‚æ•°å…­:åˆ›å»ºçº¿ç¨‹çš„å·¥å‚                            ä¸èƒ½ä¸ºnull</span><br><span class="line">         * å‚æ•°ä¸ƒï¼šä»»åŠ¡çš„æ‹’ç»ç­–ç•¥                             ä¸èƒ½ä¸ºnull</span><br><span class="line">         */</span><br><span class="line">     ThreadPoolExecutor threadPoolExecutor = new ThreadPoolExecutor(</span><br><span class="line">            3,  // æ ¸å¿ƒçº¿ç¨‹æ•°é‡</span><br><span class="line">            6,              //æœ€å¤§çº¿ç¨‹æ•°</span><br><span class="line">            60,             //ç©ºé—²ä¸´æ—¶çº¿ç¨‹æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆæ•°å€¼ï¼‰</span><br><span class="line">            TimeUnit.SECONDS,//ç©ºé—²ä¸´æ—¶çº¿ç¨‹æœ€å¤§å­˜æ´»æ—¶é—´ï¼ˆå•ä½ï¼‰</span><br><span class="line">            new ArrayBlockingQueue&lt;&gt;(3),//ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå µå¡é˜Ÿåˆ—ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨LinkedBlockingQueueè¿™ä¸ªé˜»å¡é˜Ÿåˆ—</span><br><span class="line">            Executors.defaultThreadFactory(),//ç”¨çº¿ç¨‹æ± å·¥å…·ç±»Executorsåˆ›å»ºçº¿ç¨‹çš„å·¥å‚</span><br><span class="line">            new ThreadPoolExecutor.AbortPolicy()//ä»»åŠ¡çš„æ‹’ç»ç­–ç•¥ä¸­å…¶ä¸­ä¸€ä¸ªï¼Œä¸¢å¼ƒä»»åŠ¡å¹¶æŠ›å‡ºRejectedExecutionException</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>![image-20240804205131842.png](https://s2.loli.net/2024/08/04/fTsqWtGjBRbrVxS.png)</code></pre></li></ul></li></ul><h3 id="é”"><a href="#é”" class="headerlink" title="é”"></a>é”</h3><p><a href="https://blog.csdn.net/qq_31129841/article/details/134800508?ops_request_misc=&request_id=&biz_id=102&utm_term=java%E9%94%81&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-134800508.142%5Ev100%5Epc_search_result_base8&spm=1018.2226.3001.4187">Javaä¸­æ¶‰åŠåˆ°çš„é”_javaçš„é”-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/w8y56f/article/details/89554060?ops_request_misc=%7B%22request_id%22:%226AC14F77-B54A-40E2-BC9B-B5E43E80DDE1%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=6AC14F77-B54A-40E2-BC9B-B5E43E80DDE1&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-89554060-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=%E5%8F%AF%E9%87%8D%E5%85%A5%E9%94%81&spm=1018.2226.3001.4187">å¯é‡å…¥é”è¯¦è§£ï¼ˆä»€ä¹ˆæ˜¯å¯é‡å…¥ï¼‰-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/qq_15002323/article/details/78299615?ops_request_misc=%7B%22request_id%22:%22189C86F7-3A36-4590-84CA-80D0EE05EA8B%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=189C86F7-3A36-4590-84CA-80D0EE05EA8B&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-78299615-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=synchronized%E5%92%8Cwait&spm=1018.2226.3001.4187">æµ…è°ˆsynchronizedã€waitã€notifyå’ŒnotifyAll_synchronized,wait,notify-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/qq_45795744/article/details/123493673?ops_request_misc=%7B%22request_id%22:%22757F3D0D-BE29-47FB-B090-2CC888215371%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=757F3D0D-BE29-47FB-B090-2CC888215371&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-123493673-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=java%E9%94%81%E5%8D%87%E7%BA%A7&spm=1018.2226.3001.4187">Javaä¸­çš„é”å‡çº§_java é”å‡çº§-CSDNåšå®¢</a></p><h2 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h2><p><a href="https://blog.csdn.net/promsing/article/details/112793260?ops_request_misc=%7B%22request_id%22:%22172278251216800227438114%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172278251216800227438114&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-112793260-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=%E5%8F%B2%E4%B8%8A%E8%B6%85%E5%BC%BA%E6%9C%80%E5%B8%B8%E7%94%A8sql&spm=1018.2226.3001.4187">å²ä¸Šè¶…å¼ºæœ€å¸¸ç”¨SQLè¯­å¥å¤§å…¨-CSDNåšå®¢</a></p><p><a href="https://www.cnblogs.com/blogtech/p/18006730">mysqlæ•°æ®åº“â€“è¡Œçº§é”ï¼Œé—´éš™é”å’Œä¸´é”®é”è¯¦è§£ - èœé¸Ÿçš„å¥‹æ–—ä¹‹è·¯ - åšå®¢å›­ (cnblogs.com)</a></p><h2 id="å¼€å‘å¯ç¤ºï¼š"><a href="#å¼€å‘å¯ç¤ºï¼š" class="headerlink" title="å¼€å‘å¯ç¤ºï¼š"></a>å¼€å‘å¯ç¤ºï¼š</h2><p>æ—¥å¿—æ˜¯log4j+slf4jï¼š<a href="https://blog.csdn.net/madness1010/article/details/128332275?ops_request_misc=%7B%22request_id%22:%22172161994516800178531628%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172161994516800178531628&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-128332275-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=slf4j%E5%92%8Clog4j%E5%92%8Clogback%E5%8C%BA%E5%88%AB&spm=1018.2226.3001.4187">æœ€é€šä¿—æ˜“æ‡‚çš„ JAVA slf4j,log4j,log4j2,logback å…³ç³»ä¸åŒºåˆ«ä»¥åŠå®Œæ•´é›†æˆæ¡ˆä¾‹_slf4j log4j2-CSDNåšå®¢</a></p><p>druidç”¨äºæ§åˆ¶æ•°æ®åº“è¿æ¥æ± ç­‰é…ç½®ï¼Œå¯ä»¥ç”Ÿæˆå…¬é’¥æ¥å¯¹æ•°æ®åº“å¯†ç åŠ å¯†</p><p>navicatè¿MySQL</p><p>eazycodeæ˜¯åœ¨åˆ©ç”¨ideaä¸æ•°æ®åº“è¿æ¥åç‚¹å‡»å…·ä½“çš„è¡¨ç”Ÿæˆçš„ç›¸å…³çš„ä»£ç ï¼Œ<code>template</code>é€‰æ‹©<code>mapper.xml.vm, dao.java.vm, entity.java.vm, service.java.vm, serviceImpl.java.vm</code></p><p>Controllerå±‚æ˜¯è®¿é—®çš„å…¥å£ï¼Œå…¶éœ€è¦<code>@RestController</code>æ³¨è§£ï¼Œå¯ä»¥å°†è¿”å›ç»“æœä»¥æ­£ç¡®çš„å½¢å¼å‘ˆç°ï¼›ç„¶ååœ¨æ¯ä¸ªæ¥å£(add,deleteç­‰)ï¼Œä½¿ç”¨<code>@RestMapping</code>æ³¨è§£ï¼Œå°†æ­£ç¡®çš„è·¯ç”±æ˜ å°„ã€‚</p><p>DTO-&gt;BOçš„BO-&gt;å®é™…ç±»çš„è½¬æ¢çš„converteræ˜¯æ¥å£+mapstructçš„<code>@Mapper</code>å®ç°çš„ï¼Œè¦è¿›è¡Œconvertæ—¶è®°å¾—åœ¨converterå‰åŠ @Mapper ï¼š[Mapstruct @Mapper @Mapping ä½¿ç”¨ä»‹ç»ä»¥åŠæ€»ç»“-CSDNåšå®¢](<a href="https://blog.csdn.net/weixin_44131922/article/details/126232977?ops_request_misc=%7B%22request_id%22:%22172163217516800227461233%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=172163217516800227461233&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-11-126232977-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=@mapper">https://blog.csdn.net/weixin_44131922/article/details/126232977?ops_request_misc=%7B%22request%5Fid%22%3A%22172163217516800227461233%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D&amp;request_id=172163217516800227461233&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-11-126232977-null-null.142^v100^pc_search_result_base8&amp;utm_term=@mapper</a> convert&amp;spm&#x3D;1018.2226.3001.4187)</p><ul><li>ç”¨äºå„ä¸ªå¯¹è±¡å®ä½“é—´çš„ç›¸äº’è½¬æ¢ï¼Œä¾‹å¦‚æ•°æ®åº“åº•å±‚å®ä½“ è½¬ä¸ºé¡µé¢å¯¹è±¡ï¼ŒModel è½¬ä¸º DTOï¼ˆdata transfer object æ•°æ®è½¬æ¢å®ä½“ï¼‰, DTO è½¬ä¸ºå…¶ä»–ä¸­é—´å¯¹è±¡ï¼Œ VO ç­‰ç­‰ï¼Œç›¸å…³è½¬æ¢ä»£ç ä¸ºç¼–è¯‘æ—¶è‡ªåŠ¨äº§ç”Ÿçš„æ–°æ–‡ä»¶å’Œä»£ç ã€‚</li><li>MapStructä¼šæ ¹æ®æºå¯¹è±¡å’Œç›®æ ‡å¯¹è±¡çš„å±æ€§åç§°è¿›è¡Œè‡ªåŠ¨æ˜ å°„ã€‚å¦‚æœéœ€è¦è‡ªå®šä¹‰æ˜ å°„é€»è¾‘ï¼Œå¯ä»¥åœ¨æ¥å£ä¸­å®šä¹‰æ˜ å°„æ–¹æ³•æˆ–ä½¿ç”¨é…ç½®æ–‡ä»¶ã€‚</li><li>ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´ç›¸åŒå±æ€§åçš„ä¼šè¢«è‡ªåŠ¨è½¬æ¢ï¼ŒæŒ‡å®šç‰¹æ®Šæƒ…å†µæ—¶éœ€è¦é€šè¿‡æ³¨è§£åœ¨æŠ½è±¡æ–¹æ³•ä¸Šè¯´æ˜ä¸åŒå±æ€§ä¹‹é—´çš„è½¬æ¢ã€‚</li></ul><p><code>domain</code>å±‚çš„æ¥å£å’Œå®ç°æ˜¯å…·ä½“çš„ä¸šåŠ¡ï¼Œä¼šæ·»åŠ <code>Service</code>æ³¨è§£ ï¼Œä¼šç”¨åˆ°infraå±‚çš„æ¥å£å’Œå®ç°ï¼Œä¹Ÿä¼šæ·»åŠ <code>Service</code>æ³¨è§£ </p><p>åˆ°infraå±‚çš„å¯¹æ•°æ®åº“çš„å®é™…è®¿é—®æ˜¯ç”±dao+dao.xmlå®ç°çš„ï¼Œåœ¨dao.xmlä¸­æœ‰å…·ä½“çš„SQLè¯­å¥</p><p>controller-&gt;domain serviceImpl-&gt;infra serviceImpl</p><p>åœ¨serviceImplä¸­ï¼Œå˜é‡ä¼šä½¿ç”¨<code>@Resource</code>æ³¨è§£</p><p>å¾®æœåŠ¡ä¹‹é—´çš„è°ƒç”¨ï¼š<a href="https://blog.csdn.net/weixin_45863010/article/details/136506796?spm=1001.2014.3001.5502">SpringCloud Feignå®ç°å¾®æœåŠ¡é—´çš„è¿œç¨‹è°ƒç”¨ï¼ˆé»‘é©¬å¤´æ¡Day04ï¼‰_feign è¿œç¨‹è¿‡ç¨‹è°ƒç”¨-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/lw_jack/article/details/140419716?ops_request_misc=&request_id=&biz_id=102&utm_term=@EnableFeignClients&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-140419716.142%5Ev100%5Epc_search_result_base8&spm=1018.2226.3001.4187">EnableFeignClientsè¯¦è§£-CSDNåšå®¢</a></p><h3 id="åˆ·é¢˜æ¨¡å—"><a href="#åˆ·é¢˜æ¨¡å—" class="headerlink" title="åˆ·é¢˜æ¨¡å—"></a>åˆ·é¢˜æ¨¡å—</h3><p>å¯¹äºé¢˜ç›®æ¨¡å—ï¼ˆå››ç§é¢˜ç›®ï¼‰ï¼Œå…±æ€§çš„å¯ä»¥æå‡ºæ¥ï¼Œä¸åŒçš„å°±è®¾ç½®handleré€šè¿‡æ ‡å¿—ä½è¿›è¡Œåˆ¤æ–­é¢˜ç›®ç±»å‹ï¼ˆ<strong>å·¥å‚+ç­–ç•¥æ¨¡å¼</strong>ï¼‰ï¼Œè¿›è¡Œå¤„ç†ï¼Œç„¶åè¿”å›ç»“æœ</p><p>æŸ¥è¯¢é¢˜ç›®ï¼Œåˆ†é¡µæŸ¥è¯¢ï¼š<a href="https://blog.csdn.net/qq_47900752/article/details/134583693?ops_request_misc=&request_id=&biz_id=102&utm_term=%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-134583693.142%5Ev100%5Epc_search_result_base8&spm=1018.2226.3001.4187">mysqlåŸºç¡€ | 10.åˆ†é¡µæŸ¥è¯¢ã€è”åˆæŸ¥è¯¢_mysqlåˆ†é¡µè¯­å¥-CSDNåšå®¢</a></p><p><strong>SQLæ‹¦æˆªå™¨è‡ªåŠ¨ç¿»è¯‘ï¼ˆmybatisæä¾›çš„ï¼‰</strong>ï¼Œç”¨äºæ‰“å°å±•ç¤ºinfraå±‚ä¸æ•°æ®åº“çš„äº¤äº’ï¼Œä¾¿äºå‘ç°é”™è¯¯</p><ul><li><p>SqlStatementInterceptor ä¸»è¦ä½œç”¨æ˜¯ç›‘æ§MyBatisçš„SQLæ‰§è¡Œæ—¶é—´ï¼Œå¹¶æ ¹æ®ä¸åŒçš„æ‰§è¡Œæ—¶é—´è®°å½•ä¸åŒçº§åˆ«çš„æ—¥å¿—</p><p>MybatisPlusAllSqlLogè¿™ä¸ªç±»å®ç°äº†<code>InnerInterceptor</code>æ¥å£ï¼Œå®ƒæ˜¯MyBatis-Plusæ¡†æ¶æä¾›çš„ä¸€ä¸ªå†…éƒ¨æ‹¦æˆªå™¨æ¥å£ï¼Œç”¨äºæ‹¦æˆªSQLçš„æ‰§è¡Œã€‚è¿™ä¸ªç±»æœ‰ä¸¤ä¸ªä¸»è¦çš„é‡å†™æ–¹æ³•ï¼š</p><ul><li><code>beforeQuery</code>: åœ¨æŸ¥è¯¢æ‰§è¡Œå‰è°ƒç”¨ï¼Œè®°å½•SQLä¿¡æ¯ã€‚</li><li><code>beforeUpdate</code>: åœ¨æ›´æ–°æ‰§è¡Œå‰è°ƒç”¨ï¼Œè®°å½•SQLä¿¡æ¯ã€‚</li></ul></li></ul><p><a href="https://blog.csdn.net/Bb15070047748/article/details/107188167/?ops_request_misc=&request_id=&biz_id=102&utm_term=&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-107188167.nonecase&spm=1018.2226.3001.4187#{}&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-107188167.nonecase">å½»åº•ææ‡‚MyBaitsä¸­#{}å’Œ${}çš„åŒºåˆ«_mybatis #{}-CSDNåšå®¢</a></p><p>[mybatisä¸­resultMapçš„ç†è§£_result map-CSDNåšå®¢](<a href="https://blog.csdn.net/u012843873/article/details/80198185?ops_request_misc=%7B%22request_id%22:%22172259150816800178584486%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172259150816800178584486&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-80198185-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=mybatic">https://blog.csdn.net/u012843873/article/details/80198185?ops_request_misc=%7B%22request%5Fid%22%3A%22172259150816800178584486%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172259150816800178584486&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-80198185-null-null.142^v100^pc_search_result_base8&amp;utm_term=mybatic</a> resultmap&amp;spm&#x3D;1018.2226.3001.4187)</p><p><a href="https://blog.csdn.net/libusi001/article/details/134155913?ops_request_misc=&request_id=&biz_id=102&utm_term=mybatis%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-4-134155913.142%5Ev100%5Epc_search_result_base8&spm=1018.2226.3001.4187">ã€Mybatisã€‘xmlå¸¸ç”¨æ€»ç»“ï¼ˆæŒç»­æ›´æ–°ï¼‰_mybatis xml-CSDNåšå®¢</a></p><p>minioæ¨¡å—ï¼šcontroller-&gt;service-&gt;adaperï¼ˆé˜¿é‡Œ&#x2F;minioï¼Œ<strong>é€‚é…å™¨æ¨¡å¼</strong>ï¼Œä¸ç”¨å·¥å‚ï¼‹ç­–ç•¥çš„æ˜¯å› ä¸ºå·¥å‚+ç­–ç•¥çš„ä¼ å…¥çš„å‚æ•°ä¹‹ç±»çš„å·®ä¸å¤šï¼Œæ‰€ä»¥ç”¨é€‚é…å™¨ï¼‰-&gt;å…·ä½“æ“ä½œã€‚<strong>nacos ä½œä¸ºé…ç½®ä¸­å¿ƒ</strong>ï¼Œå¯ä»¥å®ç°åŠ¨æ€é…ç½®ï¼Œé€‚ç”¨äºæ¯”å¦‚åŠ¨æ€æ•°æ®æºåˆ‡æ¢ï¼ŒåŠ¨æ€åˆ‡æ¢ ossã€‚<strong>è¿™é‡Œè¦é…åˆ<code>RefreshScope</code>æ³¨è§£å»ä½¿ç”¨</strong>ï¼Œå®ç°åŠ¨æ€åˆ·æ–°ï¼ˆminio-&gt;aliï¼‰ã€‚</p><p>å‚æ•°æ ¡éªŒPreconditions:checkNotNull&#x2F;checkArgument</p><p><a href="https://blog.csdn.net/m0_71777195/article/details/126319418?ops_request_misc=%7B%22request_id%22:%22172205984816800185890242%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172205984816800185890242&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-1-126319418-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=RefreshScope&spm=1018.2226.3001.4187">ä¸€æ–‡å¸¦ä½ ç†è§£@RefreshScopeæ³¨è§£å®ç°åŠ¨æ€åˆ·æ–°åŸç†-CSDNåšå®¢</a></p><p>nacos: å¯é€šè¿‡**@Configuration**æ³¨è§£çš„<code>Storage.java</code>ä¸­çš„<code>@Beanã€@RefreshScope</code>æ³¨è§£çš„storageServiceæ–¹æ³•ï¼Œåœ¨<code>@Value</code>æ³¨è§£æ‹¿åˆ°é…ç½®æ–‡ä»¶ä¸­çš„å€¼æ—¶ï¼Œä¼šåˆ‡æ¢é€‚é…å™¨çš„å¯¹åº”çš„StorageAdapterï¼Œæ‹¿åˆ°minio&#x2F;é˜¿é‡Œäº‘çš„ossæœåŠ¡ã€‚</p><p>é˜¿é‡Œäº‘è„šæ‰‹æ¶ç”¨äºç»„ä»¶&#x2F;ç‰ˆæœ¬çš„é€‰æ‹©å…¼å®¹ï¼Œéå¸¸æ–¹ä¾¿: <a href="">start.aliyun.com</a></p><p>åˆ†ç±»æ ‡ç­¾æ€§èƒ½ä¼˜åŒ–ï¼š<a href="https://blog.csdn.net/qq_45721579/article/details/131384231?ops_request_misc=&request_id=&biz_id=102&utm_term=CompletableFuture.supplyAsync&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-131384231.nonecase&spm=1018.2226.3001.4187">ã€Java 8 æ–°ç‰¹æ€§ã€‘Java CompletableFuture supplyAsync()è¯¦è§£_completablefuture.supplyasync-CSDNåšå®¢</a></p><h3 id="ç™»å½•é‰´æƒæ¨¡å—"><a href="#ç™»å½•é‰´æƒæ¨¡å—" class="headerlink" title="ç™»å½•é‰´æƒæ¨¡å—"></a>ç™»å½•é‰´æƒæ¨¡å—</h3><p>æ‰«ç å¾®ä¿¡-&gt;å¾®ä¿¡å‘é€æ¶ˆæ¯åˆ°æœåŠ¡å™¨ï¼Œæ ¡éªŒç­¾åç¡®ä¿æ¥è‡ªå¾®ä¿¡ï¼ˆgetï¼‰-&gt;æœåŠ¡å™¨å†æŠŠæ¶ˆæ¯è¿›è¡ŒåŒ…è£…ï¼Œ é€šè¿‡å‰ç¼€+éªŒè¯ç ï¼ˆä¸€ä¸ªéšæœºæ•°ï¼‰ä½œä¸ºredis keyï¼ŒfromUserName(openId)ä½œä¸ºvalueå­˜åˆ°redisï¼Œå¹¶æŠŠåŒ…å«éªŒè¯ç çš„æ¶ˆæ¯å‘é€åˆ°å¾®ä¿¡-&gt;ç”¨æˆ·éªŒè¯ç ï¼ˆå¾®ä¿¡ï¼‰,ä»redisæ‹¿åˆ°openIdï¼ˆå³ç”¨æˆ·åï¼‰-&gt;ç”¨satokenç”¨openIdè¿›è¡Œç™»å½•ï¼Œç„¶ååˆ©ç”¨satokenè¿”å›ä¸€ä¸ªtokenï¼Œåç»­ç™»å½•å°±ä¼šå¸¦ä¸Šè¿™ä¸ªtoken</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> SaTokenInfo <span class="title function_">doLogin</span><span class="params">(String validCode)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">loginKey</span> <span class="operator">=</span> redisUtil.buildKey(LOGIN_PREFIX, validCode);</span><br><span class="line">    <span class="type">String</span> <span class="variable">openId</span> <span class="operator">=</span> redisUtil.get(loginKey);</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(openId)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">AuthUserBO</span> <span class="variable">authUserBO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthUserBO</span>();</span><br><span class="line">    authUserBO.setUserName(openId);</span><br><span class="line">    <span class="built_in">this</span>.register(authUserBO); <span class="comment">//æ ¡éªŒæ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨ç›´æ¥è¿”å›ï¼Œä¸å­˜åœ¨å°±æ³¨å†Œ</span></span><br><span class="line">    StpUtil.login(openId);</span><br><span class="line">    <span class="type">SaTokenInfo</span> <span class="variable">tokenInfo</span> <span class="operator">=</span> StpUtil.getTokenInfo();</span><br><span class="line">    <span class="keyword">return</span> tokenInfo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://sa-token.cc/doc.html#/?id=sa-token-%E5%8A%9F%E8%83%BD%E4%B8%80%E8%A7%88">Sa-Token åŠŸèƒ½ä¸€è§ˆ</a></p><p><strong>å…¨å±€å¼‚å¸¸æ‹¦æˆª</strong>ï¼šç»§æ‰¿<code>ErrorWebExceptionHandler</code>é‡å†™<code>handle</code>æ–¹æ³•è¿”å›<code>Mono</code>ç±»å‹ï¼ˆå¼‚æ­¥çš„ï¼‰ï¼Œè¿”å›ç»“æœ<code>Result</code>ä¹Ÿå°è£…å’Œæšä¸¾äº†ã€‚</p><p><a href="https://blog.csdn.net/aofengdaxia/article/details/129265983?ops_request_misc=%7B%22request_id%22:%22172223483416800182161820%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172223483416800182161820&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-129265983-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=ErrorWebExceptionHandler&spm=1018.2226.3001.4187">æ·±å…¥å­¦ä¹ ErrorWebExceptionHandler-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/crazymakercircle/article/details/124120506?ops_request_misc=%7B%22request_id%22:%22172223509816800186538079%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172223509816800186538079&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-124120506-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=mono&spm=1018.2226.3001.4187">Fluxã€Monoã€Reactor å®æˆ˜ï¼ˆå²ä¸Šæœ€å…¨ï¼‰_reactor mono-CSDNåšå®¢</a></p><p>gatewayå®ç°redisæ•°æ®æ‹‰å–ï¼šRedisTemplate-&gt;RedisConfig(é‡å†™åºåˆ—åŒ–ï¼Œ@Beanåˆ›å»ºRedisTemplate bean)-&gt;RedisUtil(å°è£…å¯¹redisçš„æ“ä½œï¼Œå…·ä½“æ˜¯ç”¨redistemplateæ¥æ“ä½œçš„)</p><p><a href="https://blog.csdn.net/m0_69519887/article/details/140610469?ops_request_misc=%7B%22request_id%22:%2207845892-42D0-4649-93B6-193BB633E1BA%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=07845892-42D0-4649-93B6-193BB633E1BA&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-140610469-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=RedisTemplate&spm=1018.2226.3001.4187">ã€Redisç³»åˆ—ã€‘RedisTemplateçš„ä½¿ç”¨ä¸æ³¨æ„äº‹é¡¹-CSDNåšå®¢</a></p><p>ä¸ºä»€ä¹ˆé‡å†™redistemplate?</p><ul><li>è¿™é‡Œä¸é‡æ–°ä»–çš„ä¸€ä¸ªåºåˆ—åŒ–ä¼šé€ æˆä¸€ä¸ªä¹±ç çš„é—®é¢˜ï¼Œé‡å†™äº†RedisTemplate:<ul><li>objectMapper-&gt;Jackson2jsonRedisSerializer-&gt;redisTemplateï¼Œæ³¨æ„@Beanæ³¨è§£è¿”å›é‡å†™RedisTemplateçš„æ–¹æ³•</li></ul></li></ul><p>[RedisTemplate æ¦‚è¿° ä¸ æ“ä½œ Redis 5 ç§æ•°æ®ç±»å‹ã€äº‹åŠ¡-CSDNåšå®¢](<a href="https://blog.csdn.net/wangmx1993328/article/details/103253479?ops_request_misc=%7B%22request_id%22:%22172225212216800178583631%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172225212216800178583631&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-2-103253479-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=redis">https://blog.csdn.net/wangmx1993328/article/details/103253479?ops_request_misc=%7B%22request%5Fid%22%3A%22172225212216800178583631%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172225212216800178583631&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-2-103253479-null-null.142^v100^pc_search_result_base8&amp;utm_term=redis</a> template&amp;spm&#x3D;1018.2226.3001.4187)</p><p><a href="https://blog.csdn.net/qq_42623400/article/details/115791984?ops_request_misc=%7B%22request_id%22:%22172225253916800225574987%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=172225253916800225574987&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-115791984-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=redistemplate%E5%92%8Cjackson&spm=1018.2226.3001.4187">Spring date-redisä¸­RedisTemplateçš„Jacksonåºåˆ—åŒ–è®¾ç½®_redistemplateåºåˆ—åŒ–æ—¶dateå¸¦æœ‰ç±»å‹ä¿¡æ¯-CSDNåšå®¢</a></p><p>[Redis åŸºæœ¬å‘½ä»¤â€”â€” è¶…è¯¦ç»†æ“ä½œæ¼”ç¤ºï¼ï¼ï¼_redis æ“ä½œ-CSDNåšå®¢](<a href="https://blog.csdn.net/weixin_43412762/article/details/133934585?ops_request_misc=%7B%22request_id%22:%22172225344516800227425617%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172225344516800227425617&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-133934585-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=redis">https://blog.csdn.net/weixin_43412762/article/details/133934585?ops_request_misc=%7B%22request%5Fid%22%3A%22172225344516800227425617%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172225344516800227425617&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-133934585-null-null.142^v100^pc_search_result_base8&amp;utm_term=redis</a> æ“ä½œ&amp;spm&#x3D;1018.2226.3001.4187)</p><h3 id="ç”¨æˆ·-è§’è‰²-ç”¨æˆ·è§’è‰²å…³è”"><a href="#ç”¨æˆ·-è§’è‰²-ç”¨æˆ·è§’è‰²å…³è”" class="headerlink" title="ç”¨æˆ·&#x2F;è§’è‰²&#x2F;ç”¨æˆ·è§’è‰²å…³è”"></a>ç”¨æˆ·&#x2F;è§’è‰²&#x2F;ç”¨æˆ·è§’è‰²å…³è”</h3><p>ç”¨æˆ·æ³¨å†Œæ—¶å¯†ç çš„åŠ å¯†ï¼šsatokenå®ç°çš„md5+saltï¼ŒHashæ•£åˆ—</p><p>è¿›è¡Œç”¨æˆ·è§’è‰²å…³è”ç”¨åˆ°rediså’Œæ•°æ®åº“æ—¶ï¼Œä½¿ç”¨äº†@Transactionalæ³¨è§£ï¼š<a href="https://blog.csdn.net/minghao0508/article/details/124374637?ops_request_misc=%7B%22request_id%22:%22172243354616800175766334%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172243354616800175766334&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-124374637-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=@Transactional&spm=1018.2226.3001.4187">Springâ€”â€”äº‹åŠ¡æ³¨è§£@Transactionalã€å»ºè®®æ”¶è—ã€‘-CSDNåšå®¢</a></p><h3 id="æƒé™å¼€å‘ä¸è§’è‰²æƒé™å…³è”æ¨¡å—"><a href="#æƒé™å¼€å‘ä¸è§’è‰²æƒé™å…³è”æ¨¡å—" class="headerlink" title="æƒé™å¼€å‘ä¸è§’è‰²æƒé™å…³è”æ¨¡å—"></a>æƒé™å¼€å‘ä¸è§’è‰²æƒé™å…³è”æ¨¡å—</h3><p><code>AuthPermissionDao.xml</code></p><ul><li><code>type</code>, <code>show</code>ï¼šè¿™äº›åˆ—åä½¿ç”¨äº†åå¼•å·ï¼Œå› ä¸º <code>type</code> å’Œ <code>show</code> æ˜¯ MySQL çš„ä¿ç•™å­—ã€‚åœ¨ SQL ä¸­ï¼Œä¿ç•™å­—æ˜¯å…·æœ‰ç‰¹å®šæ„ä¹‰çš„å…³é”®å­—ï¼Œå¦‚æœç”¨ä½œåˆ—åæˆ–è¡¨åï¼Œéœ€è¦ç”¨åå¼•å·æ‹¬èµ·æ¥ï¼Œä»¥é¿å…è¯­æ³•é”™è¯¯ã€‚</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ–°å¢æ‰€æœ‰åˆ—--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insert&quot;</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span> <span class="attr">useGeneratedKeys</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    insert into auth_permission(name, parent_id, `type`, menu_url, status, `show`, icon, permission_key, created_by, created_time, update_by, update_time, is_deleted)</span><br><span class="line">    values (#&#123;name&#125;, #&#123;parentId&#125;, #&#123;type&#125;, #&#123;menuUrl&#125;, #&#123;status&#125;, #&#123;show&#125;, #&#123;icon&#125;, #&#123;permissionKey&#125;, #&#123;createdBy&#125;, #&#123;createdTime&#125;, #&#123;updateBy&#125;, #&#123;updateTime&#125;, #&#123;isDeleted&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="æ•°æ®ä¸ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜"><a href="#æ•°æ®ä¸ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜" class="headerlink" title="æ•°æ®ä¸ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜"></a>æ•°æ®ä¸ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜</h3><p>è¾©è¯ä¸¤ä¸ªæƒ…å†µ</p><p>1ã€ç›´æ¥å’Œç¼“å­˜åšäº¤äº’ï¼Œå®Œå…¨ä¿¡ä»»ç¼“å­˜</p><p>2ã€å’Œç¼“å­˜åšäº¤äº’ï¼Œå¦‚æœç¼“å­˜æ²¡æœ‰ï¼Œåˆ™å»å’Œæ•°æ®åº“æŸ¥</p><p><img src="https://s2.loli.net/2024/08/02/vgMZ7Fy3fRPnJj6.jpg" alt="1699108963209-2ec4047e-03ee-4f39-99ed-9210e4efc363[1].jpeg"></p><p>æ ¹æ®ä»¥ä¸Šçš„æµç¨‹æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯å½“æ•°æ®å˜æ›´çš„æ—¶å€™ï¼Œå¦‚ä½•æŠŠç¼“å­˜å˜åˆ°æœ€æ–°ï¼Œä½¿æˆ‘ä»¬ä¸‹é¢è¦è®¨è®ºçš„é—®é¢˜ã€‚</p><ol><li><p>æ›´æ–°äº†æ•°æ®åº“ï¼Œå†æ›´æ–°ç¼“å­˜</p><p>å‡è®¾æ•°æ®åº“æ›´æ–°æˆåŠŸï¼Œç¼“å­˜æ›´æ–°å¤±è´¥ï¼Œåœ¨ç¼“å­˜å¤±æ•ˆå’Œè¿‡æœŸçš„æ—¶å€™ï¼Œè¯»å–åˆ°çš„éƒ½æ˜¯è€æ•°æ®ç¼“å­˜ã€‚</p></li><li><p>æ›´æ–°ç¼“å­˜ï¼Œæ›´æ–°æ•°æ®åº“</p><p>ç¼“å­˜æ›´æ–°æˆåŠŸäº†ï¼Œæ•°æ®åº“æ›´æ–°å¤±è´¥ï¼Œæ˜¯ä¸æ˜¯è¯»å–çš„ç¼“å­˜çš„éƒ½æ˜¯é”™è¯¯çš„ã€‚</p></li></ol><p>ä»¥ä¸Šä¸¤ç§ï¼Œå…¨éƒ½ä¸æ¨èã€‚</p><ol start="3"><li><p>å…ˆåˆ é™¤ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“</p><p>æœ‰ä¸€å®šçš„ä½¿ç”¨é‡ã€‚å³ä½¿æ•°æ®åº“æ›´æ–°å¤±è´¥ã€‚ç¼“å­˜ä¹Ÿå¯ä»¥ä¼šåˆ·ã€‚</p><p>å­˜åœ¨çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>é«˜å¹¶å‘æƒ…å†µä¸‹ï¼ï¼</p><p>æ¯”å¦‚è¯´æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªæ˜¯ A çº¿ç¨‹ï¼Œä¸€ä¸ªæ˜¯ B çº¿ç¨‹ã€‚</p><p>A çº¿ç¨‹æŠŠæ•°æ®åˆ äº†ï¼Œæ­£åœ¨æ›´æ–°æ•°æ®åº“ï¼Œè¿™ä¸ªæ—¶å€™ B çº¿ç¨‹æ¥äº†ï¼Œå‘ç°ç¼“å­˜æ²¡äº†ï¼ŒåˆæŸ¥æ•°æ®ï¼Œåˆæ”¾å…¥ç¼“å­˜ã€‚ç¼“å­˜é‡Œé¢å­˜çš„å°±ä¸€ç›´æ˜¯è€æ•°æ®äº†ã€‚</p></li></ol><p><strong>å»¶è¿ŸåŒåˆ ï¼š</strong>:star:</p><ul><li>**å»¶æ—¶æ˜¯ç¡®ä¿ **ä¿®æ”¹æ•°æ®åº“ -&gt; æ¸…ç©ºç¼“å­˜å‰ï¼Œå…¶ä»–äº‹åŠ¡çš„æ›´æ”¹ç¼“å­˜æ“ä½œå·²ç»æ‰§è¡Œå®Œã€‚<a href="https://blog.csdn.net/qq_35890572/article/details/108538712?ops_request_misc=%7B%22request_id%22:%22172258242116800222864858%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172258242116800222864858&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-108538712-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=%E7%BC%93%E5%AD%98%E5%8F%8C%E5%88%A0&spm=1018.2226.3001.4187&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=">redisç¼“å­˜ä¸ºä»€ä¹ˆè¦å»¶æ—¶åŒåˆ -CSDNåšå®¢</a></li></ul><p><strong>æ‰©å±•æ€è·¯</strong></p><ol><li><p>æ¶ˆæ¯é˜Ÿåˆ—è¡¥å¿</p><p>åˆ é™¤å¤±è´¥çš„ç¼“å­˜ï¼Œä½œä¸ºæ¶ˆæ¯æ‰“å…¥ mqï¼Œmq æ¶ˆè´¹è€…è¿›è¡Œç›‘å¬ï¼Œå†æ¬¡è¿›è¡Œé‡è¯•åˆ·ç¼“å­˜ã€‚</p></li><li><p>canal</p><p>ç›‘å¬æ•°æ®åº“çš„å˜åŒ–ï¼Œåšä¸€ä¸ªå…¬å…±æœåŠ¡ï¼Œä¸“é—¨æ¥å¯¹æ¥ç¼“å­˜åˆ·æ–°ã€‚ä¼˜ç‚¹ä¸šåŠ¡è§£è€¦ï¼Œé¿å…ä¸šåŠ¡å¤ªå¤šå†—ä½™ä»£ç å¤æ‚åº¦ã€‚</p></li></ol><h3 id="ç™»å½•æ¨¡å—"><a href="#ç™»å½•æ¨¡å—" class="headerlink" title="ç™»å½•æ¨¡å—"></a>ç™»å½•æ¨¡å—</h3><p>å†…ç½‘ç©¿é€ï¼šnatapp</p><p>å…¨æµç¨‹ï¼šæ‰«ç å¾®ä¿¡-&gt;å¾®ä¿¡å‘é€æ¶ˆæ¯åˆ°æœåŠ¡å™¨ï¼Œæ ¡éªŒç­¾åç¡®ä¿æ¥è‡ªå¾®ä¿¡ï¼ˆgetï¼‰-&gt;æœåŠ¡å™¨å†æŠŠæ¶ˆæ¯è¿›è¡ŒåŒ…è£…ï¼Œ é€šè¿‡å‰ç¼€+éªŒè¯ç ï¼ˆä¸€ä¸ªéšæœºæ•°ï¼‰ä½œä¸ºredis keyï¼ŒfromUserName(openId)ä½œä¸ºvalueå­˜åˆ°redisï¼Œå¹¶æŠŠåŒ…å«éªŒè¯ç çš„æ¶ˆæ¯å‘é€åˆ°å¾®ä¿¡-&gt;ç”¨æˆ·éªŒè¯ç ï¼ˆå¾®ä¿¡ï¼‰,ä»redisæ‹¿åˆ°openIdï¼ˆå³ç”¨æˆ·åï¼‰-&gt;ç”¨satokenç”¨openIdè¿›è¡Œç™»å½•ï¼Œç„¶ååˆ©ç”¨satokenè¿”å›ä¸€ä¸ªtokenï¼Œåç»­ç™»å½•å°±ä¼šå¸¦ä¸Šè¿™ä¸ªtoken</p><h3 id="ç”¨æˆ·ä¸Šä¸‹æ–‡æ‰“é€š"><a href="#ç”¨æˆ·ä¸Šä¸‹æ–‡æ‰“é€š" class="headerlink" title="ç”¨æˆ·ä¸Šä¸‹æ–‡æ‰“é€š"></a>ç”¨æˆ·ä¸Šä¸‹æ–‡æ‰“é€š</h3><p>å…¨å±€æ‹¦æˆªå™¨ï¼šå®ç°<code>GlobalFilter</code>æ¥å£<a href="https://blog.csdn.net/feiying0canglang/article/details/124476416?ops_request_misc=%7B%22request_id%22:%22172344317916800185844782%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172344317916800185844782&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-1-124476416-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=GlobalFilter&spm=1018.2226.3001.4187">Spring Cloud Gatewayâ€“å…¨å±€è¿‡æ»¤å™¨(GlobalFilter)â€“ä½œç”¨&#x2F;ä½¿ç”¨_gateway globalfilter-CSDNåšå®¢</a></p><p><code>Loginfilter</code>(å®ç°<code>Globalfilteræ¥å£</code>ï¼Œé€šè¿‡filteræ‹¿åˆ°tokenï¼Œè§£æå‡º<strong>loginId</strong>ï¼Œç„¶åä¼ åˆ°åé¢çš„è¿‡æ»¤é“¾ä¸­)</p><p>-&gt;<code>LoginInterceptor</code>(å®ç°<code>HandlerInterceptor</code>ï¼Œæ£€éªŒ<strong>loginId</strong>æ˜¯å¦å­˜åœ¨ä¸”éç©ºï¼Œå¦‚æœå­˜åœ¨ï¼Œå°†å…¶ä¿å­˜åˆ°è‡ªå®šä¹‰çš„çº¿ç¨‹å±€éƒ¨å˜é‡ä¸Šä¸‹æ–‡LoginContextHolderä¸­ï¼Œé€šè¿‡<code>InheritableThreadLocal</code>æ¥å®ç°)</p><p>[ThreadLocalã€InheritableThreadLocalã€TransmittableThreadLocal-CSDNåšå®¢](<a href="https://blog.csdn.net/weixin_37862824/article/details/121177025?ops_request_misc=%7B%22request_id%22:%22172344566516800186560849%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172344566516800186560849&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-121177025-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=ThreadLocal">https://blog.csdn.net/weixin_37862824/article/details/121177025?ops_request_misc=%7B%22request%5Fid%22%3A%22172344566516800186560849%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172344566516800186560849&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-121177025-null-null.142^v100^pc_search_result_base8&amp;utm_term=ThreadLocal</a> inheritablethreadlocal&amp;spm&#x3D;1018.2226.3001.4187)</p><p>[å²ä¸Šæœ€å…¨ThreadLocal è¯¦è§£ï¼ˆä¸€ï¼‰-CSDNåšå®¢](<a href="https://blog.csdn.net/u010445301/article/details/111322569?ops_request_misc=%7B%22request_id%22:%22172344571016800184113290%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172344571016800184113290&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-111322569-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=ThreadLocal">https://blog.csdn.net/u010445301/article/details/111322569?ops_request_misc=%7B%22request%5Fid%22%3A%22172344571016800184113290%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172344571016800184113290&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-111322569-null-null.142^v100^pc_search_result_base8&amp;utm_term=ThreadLocal</a> &amp;spm&#x3D;1018.2226.3001.4187)</p><p><a href="https://blog.csdn.net/yexiguafu/article/details/103900568?ops_request_misc=%7B%22request_id%22:%22172344903416800207094300%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172344903416800207094300&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-103900568-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=inheritablethreadlocal&spm=1018.2226.3001.4187">InheritableThreadLocalè¯¦è§£-CSDNåšå®¢</a></p><h3 id="è·¨å¾®æœåŠ¡è°ƒç”¨"><a href="#è·¨å¾®æœåŠ¡è°ƒç”¨" class="headerlink" title="è·¨å¾®æœåŠ¡è°ƒç”¨"></a>è·¨å¾®æœåŠ¡è°ƒç”¨</h3><p><a href="https://blog.csdn.net/w55935/article/details/124567299?ops_request_misc=%7B%22request_id%22:%22172346209516800225560323%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172346209516800225560323&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-124567299-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=%E6%8B%A6%E6%88%AA%E5%99%A8%E5%92%8C%E8%BF%87%E6%BB%A4%E5%99%A8%E7%9A%84%E9%A1%BA%E5%BA%8F&spm=1018.2226.3001.4187">springMVCä¸­æ‹¦æˆªå™¨æ‰§è¡Œæ—¶æœºå’Œæ‰§è¡Œé¡ºåºåˆ†æ_æ‹¦æˆªå™¨åœ¨ä»€ä¹ˆæ—¶å€™æ‰§è¡Œ-CSDNåšå®¢</a></p><p>[SpringBootå¸¸ç”¨æ‹¦æˆªå™¨ï¼ˆHandlerInterceptorï¼ŒClientHttpRequestInterceptorï¼ŒRequestInterceptorï¼‰_springboot handlerinterceptor-CSDNåšå®¢](<a href="https://blog.csdn.net/weixin_41979002/article/details/124778961?ops_request_misc=%7B%22request_id%22:%22172346204716800226593841%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172346204716800226593841&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-124778961-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=HandlerInterceptor">https://blog.csdn.net/weixin_41979002/article/details/124778961?ops_request_misc=%7B%22request%5Fid%22%3A%22172346204716800226593841%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172346204716800226593841&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-124778961-null-null.142^v100^pc_search_result_base8&amp;utm_term=HandlerInterceptor</a> RequestInterceptor&amp;spm&#x3D;1018.2226.3001.4187)</p><p><a href="https://blog.csdn.net/qq_50652600/article/details/127250413?ops_request_misc=%7B%22request_id%22:%22172346200216800207096802%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172346200216800207096802&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-2-127250413-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=HandlerInterceptor&spm=1018.2226.3001.4187">æ‹¦æˆªå™¨ï¼ˆHandlerInterceptorï¼‰-CSDNåšå®¢</a></p><h3 id="æœ¬åœ°ç¼“å­˜"><a href="#æœ¬åœ°ç¼“å­˜" class="headerlink" title="æœ¬åœ°ç¼“å­˜"></a>æœ¬åœ°ç¼“å­˜</h3><p>caffiene &amp;&amp; guava</p><p><a href="https://blog.csdn.net/zhangyunfeihhhh/article/details/108105928?ops_request_misc=%7B%22request_id%22:%22172346273516800182136994%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=172346273516800182136994&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-3-108105928-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=guava%E5%92%8Ccaffiene&spm=1018.2226.3001.4187">Caffeineä¸Guavaå¯¹æ¯”_caffeine guava å¯¹æ¯”-CSDNåšå®¢</a></p><h3 id="å…¨æ–‡æ£€ç´¢"><a href="#å…¨æ–‡æ£€ç´¢" class="headerlink" title="å…¨æ–‡æ£€ç´¢"></a>å…¨æ–‡æ£€ç´¢</h3><p><strong>ES:</strong></p><p>å…¨ç§° elasticsearchã€‚</p><p>éš¶å±äº elsastic stackã€‚<a href="https://www.elastic.co/cn/">å®˜ç½‘åœ°å€ï¼šhttps://www.elastic.co/cn/</a></p><p>å…¶ä¸­åŒ…å«æˆ‘ä»¬çš„ elasticsearchï¼ˆå­˜å‚¨ã€è®¡ç®—ã€æœç´¢æ•°æ®ï¼‰ï¼Œkibana(æ•°æ®å¯è§†åŒ–)ï¼Œbeatsï¼ˆæ•°æ®æŠ“å–ï¼‰ï¼Œlogstashï¼ˆæ•°æ®æŠ“å–ï¼‰ã€‚ï¼ˆELKï¼‰ã€‚</p><p>es ä¸»è¦æ˜¯å¯¹æ•°æ®è¿›è¡Œæœç´¢ï¼Œåˆ†æï¼Œå€’æ’ã€‚ä»–æ˜¯ä¸€ä¸ªå¼€æºçš„é«˜æ‰©å±•çš„åˆ†å¸ƒå¼å…¨æ–‡æœç´¢å¼•æ“ã€‚è¿‘å®æ—¶çš„æœç´¢ã€‚æ‰©å±•æ€§é«˜ã€‚å¤„ç† PB çº§åˆ«çš„æ•°æ®ã€‚</p><p>ä¸ºä»€ä¹ˆä¸ç”¨ mysql åšå‘¢ï¼Ÿ</p><p>es çš„ç‰¹ç‚¹ï¼š</p><p>1ã€æœç´¢çš„æ•°æ®å¯¹è±¡å¤§é‡çš„éç»“æ„åŒ–çš„æ–‡æœ¬</p><p>2ã€å€’æ’ç´¢å¼•</p><p>3ã€æ¯ä¸ªå­—æ®µéƒ½å¯ä»¥è¢«ç´¢å¼•å’Œæœç´¢</p><p>4ã€è¿‘å®æ—¶åˆ†æï¼Œè¿˜å¯ä»¥åšèšåˆï¼Œæ”¯æŒå„ç§æŸ¥è¯¢</p><p><a href="https://blog.csdn.net/qq_47387991/article/details/129349790?ops_request_misc=%7B%22request_id%22:%22172354172816800222897865%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172354172816800222897865&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-2-129349790-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=elasticsearch&spm=1018.2226.3001.4187">ELasticsearchåŸºæœ¬ä½¿ç”¨â€”â€”åŸºç¡€ç¯‡_elasticsearchä½¿ç”¨-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/JENREY/article/details/81290535?ops_request_misc=%7B%22request_id%22:%22172354172816800222897865%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172354172816800222897865&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-81290535-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=elasticsearch&spm=1018.2226.3001.4187">ElasticSearchä»å…¥é—¨åˆ°ç²¾é€šï¼Œå²ä¸Šæœ€å…¨ï¼ˆæŒç»­æ›´æ–°ï¼Œæœªå®Œå¾…ç»­ï¼Œæ¯å¤©ä¸€ç‚¹ç‚¹ï¼‰_elasticsearchä»å…¥é—¨åˆ°ç²¾é€š,å²ä¸Šæœ€å…¨-CSDNåšå®¢</a></p><p>esä¸å¸¸è§„ç»“æ„åŒ–æ•°æ®æ•°æ®åº“æ¦‚å¿µå¯¹ç…§ï¼š</p><p>index-&gt;database</p><p>type-&gt;table</p><p>document-&gt;row</p><p>Field-&gt;column</p><p>[é€šè¿‡HTTPçš„æ–¹å¼æ“ä½œES-CSDNåšå®¢](<a href="https://blog.csdn.net/sss294438204/article/details/122884953?ops_request_misc=%7B%22request_id%22:%22172355571716800211536069%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172355571716800211536069&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-122884953-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=es">https://blog.csdn.net/sss294438204/article/details/122884953?ops_request_misc=%7B%22request%5Fid%22%3A%22172355571716800211536069%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172355571716800211536069&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-122884953-null-null.142^v100^pc_search_result_base8&amp;utm_term=es</a> http&amp;spm&#x3D;1018.2226.3001.4187)</p><p>ESé›†ç¾¤å®¢æˆ·ç«¯ï¼šhashmap+RestHighLevelClientï¼Œkeyä¸ºé›†ç¾¤åï¼Œvalueä¸ºRestHighLevelClientï¼Œé…ç½®é¡¹-&gt;è§£ææˆHttpHostçš„list-&gt;é€šè¿‡HttpHostå»åˆ›å»ºRestHighLevelClientã€‚æ ¹æ®RestHighLevelClientåº•å±‚çš„APIå»ä½¿ç”¨ã€‚</p><p><a href="https://blog.csdn.net/weixin_40482816/article/details/126955661?ops_request_misc=%7B%22request_id%22:%22172361783716800222854039%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172361783716800222854039&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-2-126955661-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=RestHighLevelClient&spm=1018.2226.3001.4187">elasticsearchå­¦ä¹ ï¼ˆä¸ƒï¼‰ï¼šeså®¢æˆ·ç«¯RestHighLevelClient-CSDNåšå®¢</a></p><p>æ‰§è¡ŒElasticsearchæœç´¢ï¼Œæ”¯æŒå¤æ‚çš„æŸ¥è¯¢æ¡ä»¶ã€å­—æ®µé€‰æ‹©:<a href="https://blog.csdn.net/mingyonghu/article/details/109758236?ops_request_misc=%7B%22request_id%22:%22172362055016800182140452%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172362055016800182140452&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-109758236-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=BoolQueryBuilder&spm=1018.2226.3001.4187">ESæ„å»ºqueryBuilderæ¡ä»¶æŸ¥è¯¢_es querybuilder-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/u011507134/article/details/128470306?ops_request_misc=%7B%22request_id%22:%22172362055016800182140452%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172362055016800182140452&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-2-128470306-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=BoolQueryBuilder&spm=1018.2226.3001.4187">Javaä¸­ä½¿ç”¨esæ¡ä»¶æ„é€ å™¨BoolQueryBuilder-CSDNåšå®¢</a> javaä¸­ï¼š 1. æ„é€ è¯·æ±‚çš„Builderï¼ˆSearchSourceBuilderå’ŒBoolQueryBuilderï¼‰2. ç»™BoolQueryBuilderè®¾ç½®æŸ¥è¯¢æ¡ä»¶ï¼ˆMatchQueryBuilderï¼Œmust&#x2F;shouldï¼ŒminimumShouldMatchï¼‰ 3. å°†BoolQueryBuilderå¯¹è±¡è®¾ç½®åˆ°SearchSourceBuilderå¯¹è±¡ä¸­ 4. å°è£…åˆ°SearchRequestä¸­ï¼šsearchRequest.source(searchSourceBuilder);5.  RestHighLevelClientåˆ©ç”¨SearchRequestè¿›è¡ŒæŸ¥è¯¢</p><p><a href="https://blog.csdn.net/qq_44165076/article/details/88189188">Javaå­¦ä¹ ç¬”è®°____ElasticSearchè¿›é˜¶(ä¸€)_searchhits-CSDNåšå®¢</a></p><p>è¿™ä¸ªå¯ä»¥ï¼š<a href="https://www.cnblogs.com/shangyunlin/p/12541416.html">ElasticSearchçŸ¥è¯†æ±‡æ€» - èµŸéºŸ - åšå®¢å›­ (cnblogs.com)</a></p><h3 id="Mybatiså…¨æ–‡æ‹¦æˆªå™¨ï¼ˆcreateTimeå­—æ®µç­‰ï¼‰"><a href="#Mybatiså…¨æ–‡æ‹¦æˆªå™¨ï¼ˆcreateTimeå­—æ®µç­‰ï¼‰" class="headerlink" title="Mybatiså…¨æ–‡æ‹¦æˆªå™¨ï¼ˆcreateTimeå­—æ®µç­‰ï¼‰"></a>Mybatiså…¨æ–‡æ‹¦æˆªå™¨ï¼ˆcreateTimeå­—æ®µç­‰ï¼‰</h3><p>æ³¨æ„<code>Field</code>ç±»</p><p>[getsuperclass_Javaç±»ç±»getSuperClassï¼ˆï¼‰æ–¹æ³•åŠç¤ºä¾‹-CSDNåšå®¢](<a href="https://blog.csdn.net/cumt30111/article/details/107766525?ops_request_misc=%7B%22request_id%22:%22172388481816800186530090%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=172388481816800186530090&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-107766525-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=Java">https://blog.csdn.net/cumt30111/article/details/107766525?ops_request_misc=%7B%22request%5Fid%22%3A%22172388481816800186530090%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D&amp;request_id=172388481816800186530090&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-107766525-null-null.142^v100^pc_search_result_base8&amp;utm_term=Java</a> ç±» getSuperclass&amp;spm&#x3D;1018.2226.3001.4187)</p><p>é€šè¿‡classè·å–åˆ°ç±»ï¼Œç„¶åè·å–ç±»çš„æ‰€æœ‰Fieldsï¼šwhileå¾ªç¯è°ƒç”¨getSuperClasså»æŠŠæ‰€æœ‰çš„ç±»çš„è¶…ç±»ä»¥åŠè¶…ç±»çš„è¶…ç±»ç»™æ‹¿åˆ°fieldsã€‚</p><p>æ ¹æ®å­—æ®µåç§°ï¼Œè¿›è¡Œå¯¹åº”çš„è®¾ç½®å’Œsqlæ“ä½œ</p><h3 id="æ’è¡Œæ¦œ"><a href="#æ’è¡Œæ¦œ" class="headerlink" title="æ’è¡Œæ¦œ"></a>æ’è¡Œæ¦œ</h3><h4 id="å¸¸è§„mysqlå®ç°"><a href="#å¸¸è§„mysqlå®ç°" class="headerlink" title="å¸¸è§„mysqlå®ç°"></a>å¸¸è§„mysqlå®ç°</h4><p>ç›´æ¥selectè¯­å¥å®ç°å°±è¡Œ</p><h4 id="é€šè¿‡redisçš„zsetè¿›è¡Œæ’åˆ—"><a href="#é€šè¿‡redisçš„zsetè¿›è¡Œæ’åˆ—" class="headerlink" title="é€šè¿‡redisçš„zsetè¿›è¡Œæ’åˆ—"></a>é€šè¿‡redisçš„zsetè¿›è¡Œæ’åˆ—</h4><p><a href="https://blog.csdn.net/fuzhijieabc/article/details/123805608?ops_request_misc=%7B%22request_id%22:%22172447209416800188585058%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172447209416800188585058&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-123805608-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=reverseRangeWithScores&spm=1018.2226.3001.4187">redisâ€”â€”Zsetæœ‰åºé›†åˆä¹‹reverseRangeWithScoreå‡½æ•°ä½¿ç”¨_reverserangewithscores-CSDNåšå®¢</a></p><h4 id="xxljob"><a href="#xxljob" class="headerlink" title="xxljob"></a>xxljob</h4><p><a href="https://blog.csdn.net/qq_53847859/article/details/140483614?ops_request_misc=&request_id=&biz_id=102&utm_term=xxljob&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-140483614.142%5Ev100%5Epc_search_result_base8&spm=1018.2226.3001.4187">XXL-JOBï¼šå®šæ—¶ä»»åŠ¡æ¡†æ¶çš„å®æˆ˜åº”ç”¨ä¸è°ƒåº¦æ–¹å¼è¯¦è§£-CSDNåšå®¢</a></p><p><a href="https://roger-lv.github.io/2024/08/25/2024-08-25-xxl-job%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">xxl-jobå­¦ä¹ ç¬”è®° | Roger-Lvâ€™s space</a></p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> åç«¯ </tag>
            
            <tag> å¾®æœåŠ¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windows11ä¸‹å®‰è£…WSL</title>
      <link href="/2024/07/19/Windows11%E4%B8%8B%E5%AE%89%E8%A3%85WSL/"/>
      <url>/2024/07/19/Windows11%E4%B8%8B%E5%AE%89%E8%A3%85WSL/</url>
      
        <content type="html"><![CDATA[<h1 id="Windows11ä¸‹å®‰è£…WSL"><a href="#Windows11ä¸‹å®‰è£…WSL" class="headerlink" title="Windows11ä¸‹å®‰è£…WSL"></a>Windows11ä¸‹å®‰è£…WSL</h1><h2 id="ä¸€ã€WSLæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ä¸€ã€WSLæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ä¸€ã€WSLæ˜¯ä»€ä¹ˆï¼Ÿ"></a>ä¸€ã€WSLæ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>å¼€å‘äººå‘˜å¯ä»¥åœ¨ Windows è®¡ç®—æœºä¸ŠåŒæ—¶è®¿é—® Windows å’Œ Linux çš„å¼ºå¤§åŠŸèƒ½ã€‚ é€šè¿‡é€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿ (WSL)ï¼Œå¼€å‘äººå‘˜å¯ä»¥å®‰è£… Linux å‘è¡Œç‰ˆï¼ˆä¾‹å¦‚ Ubuntuã€OpenSUSEã€Kaliã€Debianã€Arch Linux ç­‰ï¼‰ï¼Œå¹¶ç›´æ¥åœ¨ Windows ä¸Šä½¿ç”¨ Linux åº”ç”¨ç¨‹åºã€å®ç”¨ç¨‹åºå’Œ Bash å‘½ä»¤è¡Œå·¥å…·ï¼Œä¸ç”¨è¿›è¡Œä»»ä½•ä¿®æ”¹ï¼Œä¹Ÿæ— éœ€æ‰¿æ‹…ä¼ ç»Ÿè™šæ‹Ÿæœºæˆ–åŒå¯åŠ¨è®¾ç½®çš„è´¹ç”¨ã€‚</p><h2 id="äºŒã€å®‰è£…æ­¥éª¤"><a href="#äºŒã€å®‰è£…æ­¥éª¤" class="headerlink" title="äºŒã€å®‰è£…æ­¥éª¤"></a>äºŒã€å®‰è£…æ­¥éª¤</h2><ol><li><p>ç¡®ä¿ç”µè„‘è™šæ‹ŸåŒ–å¼€å¯</p><ol><li><p>æ§åˆ¶é¢æ¿-&gt;ç¨‹åº-&gt;å¯ç”¨æˆ–å…³é—­ windows åŠŸèƒ½ï¼Œå¼€å¯ Windows è™šæ‹ŸåŒ–å’Œ Linux å­ç³»ç»Ÿï¼ˆWSL2)ä»¥åŠHyper-Vã€‚ç”±äºåœ¨Windows11ä¸­å¹¶æ²¡æœ‰Hyper-Vï¼Œéœ€è¦è¿›è¡Œæ‰‹åŠ¨é…ç½®</p><p><img src="https://s2.loli.net/2024/07/19/A3LuWHaFGxiN1Xp.png" alt="image-20240719174041320.png"></p></li><li><p>é…ç½®Hyper-V</p><p>å®¶åº­ç‰ˆwindows11æ²¡æœ‰Hyper-Vï¼Œéœ€è¦é…ç½®Hyper-Vã€‚æ‰“å¼€vs codeåˆ›å»ºHyper-7.cmdï¼Œå¤åˆ¶ä»¥ä¸‹å†…å®¹å¹¶ä¿å­˜åæ‰§è¡Œã€‚</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">pushd</span> &quot;%~dp0&quot;</span><br><span class="line"><span class="built_in">dir</span> /b <span class="variable">%SystemRoot%</span>\servicing\Packages\*Hyper-V*.mum &gt;hyper-v.txt</span><br><span class="line"><span class="keyword">for</span> /f <span class="variable">%%i</span> <span class="keyword">in</span> (&#x27;<span class="built_in">findstr</span> /i . hyper-v.txt <span class="number">2</span>^&gt;<span class="built_in">nul</span>&#x27;) <span class="keyword">do</span> dism /online /norestart /add-package:&quot;<span class="variable">%SystemRoot%</span>\servicing\Packages\<span class="variable">%%i</span>&quot;</span><br><span class="line"><span class="built_in">del</span> hyper-v.txt</span><br><span class="line">Dism /online /enable-feature /featurename:Microsoft-Hyper-V-All /LimitAccess /ALL</span><br></pre></td></tr></table></figure></li></ol></li><li><p>ç³»ç»Ÿå®‰è£…<br>win11 ä½¿ç”¨ WSL2 å®‰è£… linux å­ç³»ç»Ÿ ubuntu å‡ºç°é”™è¯¯ï¼šæ— æ³•è§£ææœåŠ¡å™¨çš„åç§°æˆ–åœ°å€ã€‚åŸæœ¬æ˜¾ç¤ºæŠ¥é”™ï¼šConnectionError: Couldnâ€™t reach <a href="https://raw.githubusercontent.com/huggingfac">https://raw.githubusercontent.com/huggingfac</a><br>æ— æ³•è®¿é—®ã€‚</p><p>è§£å†³æ–¹æ³•ï¼š</p><ol><li><p>ä¿®æ”¹ æœ¬åœ° host æ–‡ä»¶ã€‚<br>è®°äº‹æœ¬æ‰“å¼€ C:\Windows\System32\drivers\etc\hosts æ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹è§£æåœ°å€ï¼ˆ4ä¸ªä¸­æœ‰ä¸€ä¸ªå¥½ç”¨å°±æ·»åŠ å®ƒï¼‰</p><p>åœ¨<a href="https://www.ipaddress.comè¿™ä¸ªç½‘ç«™ä¸­çš„æŸ¥è¯¢æ¡†ä¸­è¾“å…¥ï¼šraw.githubusercontent.com">https://www.ipaddress.comè¿™ä¸ªç½‘ç«™ä¸­çš„æŸ¥è¯¢æ¡†ä¸­è¾“å…¥ï¼šraw.githubusercontent.com</a><br>åœ¨é‡Œé¢æ‰¾åˆ°ç›¸åº”çš„çš„ipv4åœ°å€ï¼Œè¿™å››ä¸ªåœ°å€éšä¾¿é€‰ä¸€ä¸ªå³å¯ï¼ˆå¥½ç”¨çš„ï¼‰ï¼š</p><blockquote><p>185.199.108.133 raw.githubusercontent.com<br>185.199.109.133 raw.githubusercontent.com<br>185.199.110.133 raw.githubusercontent.com<br>185.199.111.133 raw.githubusercontent.com</p></blockquote></li></ol></li><li><p>åœ¨CMDä¸­åˆ·æ–° DNS è§£æç¼“å­˜<br>ipconfig &#x2F;flushdns</p></li><li><p>å†æ¬¡è¿è¡ŒæŸ¥çœ‹æˆ–å®‰è£…å‘½ä»¤<br>æŸ¥çœ‹å¯å®‰è£…çš„ WSL</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl -l -o</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/07/19/L9XK5m1WUuCFagJ.png" alt="image-20240719174714709.png"></p></li><li><p>åˆ—å‡ºå·²å®‰è£…ç‰ˆæœ¬</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl -l -v</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/07/19/EMauckZm7XIsgbH.png" alt="image-20240719174508599.png"></p></li><li><p>wsl â€“install -d(å®‰è£…):</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --install -d Ubuntu-<span class="number">22</span>.<span class="number">04</span></span><br></pre></td></tr></table></figure></li><li><p>wsl -d (è¿è¡Œ)ï¼š</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl -d Ubuntu-<span class="number">22</span>.<span class="number">04</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/07/19/Qc8HYLlKUgT4Noy.png" alt="image-20240719174849821.png"></p></li><li><p>ä¿®æ”¹åˆ°Dç›˜</p><p>ç”±äºé»˜è®¤æ˜¯åˆ°Cç›˜ï¼Œç°ä¿®æ”¹åˆ°Cç›˜ã€‚</p><ol><li><p>å…³é—­å­ç³»ç»Ÿ</p><p>å…³é—­ç•Œé¢&#x2F;è¾“å…¥å¦‚ä¸‹å‘½ä»¤å…³é—­å­ç³»ç»Ÿã€‚</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --shutdown Ubuntu-<span class="number">22</span>.<span class="number">04</span></span><br></pre></td></tr></table></figure></li><li><p>å¯¼å‡ºå­ç³»ç»Ÿ</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --export Ubuntu-<span class="number">22</span>.<span class="number">04</span> D:/WSL/Ubuntu22.<span class="number">04</span>.tar</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/07/19/sxLkiu6fzeMSnt8.png" alt="image-20240719175252993.png"></p></li><li><p>æ³¨é”€åŸå­ç³»ç»Ÿ</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --unregister Ubuntu-<span class="number">22</span>.<span class="number">04</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/07/19/VeGrK5x89pNmEUC.png" alt="image-20240719175312011.png"></p><p><img src="https://s2.loli.net/2024/07/19/ay8BjvmsLEM6zbO.png" alt="image-20240719175322005.png"></p></li><li><p>ä»Dç›˜å¯¼å…¥</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --import Ubuntu-<span class="number">22</span>.<span class="number">04</span> D:/WSL/Ubuntu-<span class="number">22</span>.<span class="number">04</span>.tar</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/07/19/vVk7RUDGqZlPOC5.png" alt="image-20240719175344296.png"></p><p><img src="https://s2.loli.net/2024/07/19/Nylr6I5Esx3kUch.png" alt="image-20240719175359321.png"></p></li><li><p>å†æ¬¡è¿è¡Œå¯¼å…¥å¥½çš„ç³»ç»Ÿ</p><p><img src="https://s2.loli.net/2024/07/19/Tx1PuMZdCLiYVEf.png" alt="image-20240719175427475.png"></p></li></ol></li></ol>]]></content>
      
      
      <categories>
          
          <category> WSL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WSL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linuxç³»ç»Ÿä¸­å¸è½½anaconda</title>
      <link href="/2024/07/19/2024-07-19-Linux%E7%B3%BB%E7%BB%9F%E4%B8%AD%E5%8D%B8%E8%BD%BDanaconda/"/>
      <url>/2024/07/19/2024-07-19-Linux%E7%B3%BB%E7%BB%9F%E4%B8%AD%E5%8D%B8%E8%BD%BDanaconda/</url>
      
        <content type="html"><![CDATA[<h1 id="Linuxç³»ç»Ÿä¸­å¸è½½anaconda"><a href="#Linuxç³»ç»Ÿä¸­å¸è½½anaconda" class="headerlink" title="Linuxç³»ç»Ÿä¸­å¸è½½anaconda"></a>Linuxç³»ç»Ÿä¸­å¸è½½anaconda</h1><p>è¦åœ¨Linuxç³»ç»Ÿä¸­å¸è½½Anacondaï¼Œä½ éœ€è¦æ‰§è¡Œä¸€ç³»åˆ—çš„å‘½ä»¤ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªé€šç”¨çš„æ­¥éª¤æŒ‡å—ï¼š</p><ol><li><p>æ‰¾åˆ°Anacondaå®‰è£…è„šæœ¬ï¼š<br>åœ¨å®‰è£…Anacondaæ—¶ï¼Œå®ƒä¼šåœ¨ä½ çš„ä¸»ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªåä¸ºanaconda3çš„æ–‡ä»¶å¤¹ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä½ åœ¨å®‰è£…æ—¶é€‰æ‹©äº†ä¸åŒçš„åç§°æˆ–ä½ç½®ï¼Œè¯·ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„è·¯å¾„ï¼‰ã€‚</p></li><li><p>è¿è¡ŒAnacondaå¸è½½ç¨‹åºï¼š<br>Anacondaæä¾›äº†ä¸€ä¸ªå¸è½½ç¨‹åºanaconda-cleanï¼Œå¯ä»¥å¸®åŠ©ä½ åˆ é™¤Anacondaçš„é…ç½®æ–‡ä»¶ã€‚åœ¨ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda install anaconda-clean</span><br><span class="line">anaconda-clean --yes</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‘½ä»¤å°†åˆ é™¤Anacondaçš„é…ç½®æ–‡ä»¶ï¼Œå¹¶ä¸”å¯ä»¥é€‰æ‹©åˆ›å»ºä¸€ä¸ªå¤‡ä»½ã€‚ä½¿ç”¨â€“yesé€‰é¡¹å¯ä»¥é¿å…åœ¨åˆ é™¤æ¯ä¸ªé¡¹ç›®æ—¶éƒ½è¦æ±‚ç¡®è®¤ã€‚</p></li><li><p>åˆ é™¤Anacondaå®‰è£…ç›®å½•ï¼š<br>æ¥ä¸‹æ¥ï¼Œä½ éœ€è¦æ‰‹åŠ¨åˆ é™¤Anacondaçš„å®‰è£…ç›®å½•ã€‚å¦‚æœä½ çš„å®‰è£…ç›®å½•æ˜¯é»˜è®¤çš„~&#x2F;anaconda3ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -rf ~/anaconda3</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ çš„å®‰è£…ç›®å½•ä¸æ˜¯é»˜è®¤çš„ï¼Œè¯·ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„è·¯å¾„ã€‚</p></li><li><p>ç¼–è¾‘.bashrcæˆ–å…¶ä»–å¯åŠ¨è„šæœ¬ï¼š<br>Anacondaå®‰è£…è¿‡ç¨‹ä¸­ä¼šåœ¨~&#x2F;.bashrcæ–‡ä»¶ä¸­æ·»åŠ åˆå§‹åŒ–ä»£ç ã€‚ä½ éœ€è¦æ‰‹åŠ¨ç¼–è¾‘è¿™ä¸ªæ–‡ä»¶å¹¶åˆ é™¤ä¸Anacondaç›¸å…³çš„è¡Œã€‚ä½ å¯ä»¥ä½¿ç”¨nanoã€vimæˆ–ä½ å–œæ¬¢çš„ä»»ä½•æ–‡æœ¬ç¼–è¾‘å™¨æ¥åšè¿™ä»¶äº‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ ä½¿ç”¨nanoï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano ~/.bashrc</span><br></pre></td></tr></table></figure><p>ç„¶åæ‰¾åˆ°å¹¶åˆ é™¤ä»¥ä¸‹è¡Œï¼ˆæˆ–ç±»ä¼¼å†…å®¹ï¼‰ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">added by Anaconda3 installer</span></span><br><span class="line">export PATH=&quot;/home/username/anaconda3/bin:$PATH&quot;</span><br></pre></td></tr></table></figure><p>ä¿å­˜å¹¶å…³é—­æ–‡ä»¶ã€‚ä¸ºäº†è®©è¿™äº›æ›´æ”¹ç”Ÿæ•ˆï¼Œä½ éœ€è¦é‡æ–°åŠ è½½.bashrcæ–‡ä»¶æˆ–é‡å¯ä½ çš„ç»ˆç«¯ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure><p>æˆ–è€…ï¼Œå¦‚æœä½ åœ¨å›¾å½¢ç•Œé¢ä¸­ï¼Œä½ å¯ä»¥ç®€å•åœ°å…³é—­å¹¶é‡æ–°æ‰“å¼€ä½ çš„ç»ˆç«¯çª—å£ã€‚</p></li><li><p>æ£€æŸ¥å¹¶åˆ é™¤ä»»ä½•å‰©ä½™çš„Anacondaæ–‡ä»¶ï¼š<br>ä¸ºäº†ç¡®ä¿æ‰€æœ‰ä¸Anacondaç›¸å…³çš„æ–‡ä»¶éƒ½è¢«åˆ é™¤ï¼Œä½ å¯ä»¥ä½¿ç”¨findå‘½ä»¤æ¥æœç´¢å®ƒä»¬ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find ~ -type d -name &#x27;*anaconda*&#x27; -or -name &#x27;*conda*&#x27; -or -name &#x27;*miniconda*&#x27;</span><br></pre></td></tr></table></figure><p>ç„¶åä½ å¯ä»¥æ‰‹åŠ¨åˆ é™¤æ‰¾åˆ°çš„ä»»ä½•ç›¸å…³ç›®å½•ã€‚</p></li><li><p>æ£€æŸ¥å¹¶æ›´æ–°ç¯å¢ƒå˜é‡ï¼š<br>å¦‚æœä½ åœ¨å…¶ä»–åœ°æ–¹ï¼ˆå¦‚.profileæˆ–.bash_profileï¼‰æ·»åŠ äº†Anacondaåˆ°ä½ çš„PATHç¯å¢ƒå˜é‡ï¼Œä½ éœ€è¦æ›´æ–°è¿™äº›æ–‡ä»¶å¹¶åˆ é™¤ç›¸å…³çš„è¡Œã€‚</p></li></ol><p>æŒ‰ç…§è¿™äº›æ­¥éª¤æ“ä½œåï¼ŒAnacondaåº”è¯¥å·²ç»ä»ä½ çš„Linuxç³»ç»Ÿä¸­å®Œå…¨å¸è½½ã€‚è¯·è®°å¾—åœ¨æ‰§è¡Œåˆ é™¤æ“ä½œæ—¶è¦å°å¿ƒï¼Œç¡®ä¿ä¸è¦é”™è¯¯åœ°åˆ é™¤éAnacondaç›¸å…³çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> anaconda </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çŠ¶å‹DPç®—æ³•</title>
      <link href="/2024/07/18/2024-06-24-%E7%8A%B6%E5%8E%8BDP%E7%AE%97%E6%B3%95/"/>
      <url>/2024/07/18/2024-06-24-%E7%8A%B6%E5%8E%8BDP%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="çŠ¶å‹DP"><a href="#çŠ¶å‹DP" class="headerlink" title="çŠ¶å‹DP"></a>çŠ¶å‹DP</h1><h2 id="ä½¿ç”¨çŠ¶å‹DPçš„åŸå› "><a href="#ä½¿ç”¨çŠ¶å‹DPçš„åŸå› " class="headerlink" title="ä½¿ç”¨çŠ¶å‹DPçš„åŸå› "></a>ä½¿ç”¨çŠ¶å‹DPçš„åŸå› </h2><p>æˆ‘ä»¬çŸ¥é“çŠ¶æ€å‹ç¼©ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯éœ€è¦è€ƒè™‘çš„çŠ¶æ€éå¸¸å¤šï¼Œæˆ‘ä»¬å¦‚æœç”¨å¹³å¸¸çš„æ€æƒ³å»è¡¨ç¤ºçŠ¶æ€ï¼Œé‚£æ˜¯éå¸¸ä¸ç°å®çš„ï¼Œåœ¨æ—¶é—´å’Œç©ºé—´ä¸Šéƒ½ä¸å…è®¸ï¼Œæˆ‘ä»¬ä½¿ç”¨æŸç§æ–¹æ³•ï¼Œä»¥æœ€å°çš„ä»£ä»·è¡¨ç¤ºæŸç§çŠ¶æ€ã€‚ é‚£ä¹ˆï¼Œè¿™é€šå¸¸æ˜¯ç”¨è¿›åˆ¶æ¥è¡¨ç¤ºçŠ¶æ€çš„ï¼Œè€Œé€‰æ‹©å‡ è¿›åˆ¶åˆ™æ ¹æ®è¦æ±‚ä½¿ç”¨çš„å¯¹è±¡çš„ç‚¹çš„çŠ¶æ€æœ‰å‡ ç§ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåªæœ‰0å’Œ1ï¼Œæˆ‘ä»¬åˆ™æ˜¯ç”¨äºŒè¿›åˆ¶æ¥è¡¨ç¤ºï¼Œå½“ç„¶ä¹Ÿæœ‰å…¶ä»–è¿›åˆ¶çš„é¢˜ï¼Œåœ¨ä¾‹é¢˜ä¸­ä¼šåˆ—ä¸¾ï¼Œéœ€è¦æˆ‘ä»¬çµæ´»å˜é€šï¼Œä¸»è¦è°ˆäºŒè¿›åˆ¶ã€‚</p><p>é‚£ä¹ˆå¦‚ä½•ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºçŠ¶æ€å‘¢ï¼Ÿæˆ‘ä»¬å‘ç°ï¼ŒäºŒè¿›åˆ¶ä¸Šæ˜¯æŒ‰ä½åˆ†çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¯ä¸€ä½å¯ä»¥çœ‹æˆä¸€ä¸ªç‚¹ï¼Œè€Œç‚¹ä¸Šçš„å–å€¼åˆ™ä¸ºè¯¥ç‚¹çš„çŠ¶æ€æˆ–è€…é€‰æ‹©ã€‚ä¾‹å¦‚00001001è¿™ä¸ªçŠ¶æ€åˆ™è¡¨ç¤ºç¬¬ä¸€ä¸ªç‚¹å’Œç¬¬å››ä¸ªç‚¹çŠ¶æ€ä¸º1ï¼Œå…¶ä½™çš„ç‚¹çŠ¶æ€ä¸º0ã€‚æ‰€ä»¥æŒ‰ç…§è¿™ç§æ€æƒ³ï¼Œèƒ½æŠ½è±¡çš„è¡¨ç¤ºå‡ºä¸€ä¸ªå¾ˆå¤æ‚çš„çŠ¶æ€ï¼Œå®ç°äº†æ—¶é—´å’Œç©ºé—´çš„ä¼˜åŒ–ã€‚</p><h2 id="çŠ¶å‹DPçš„é€‚ç”¨æ¡ä»¶"><a href="#çŠ¶å‹DPçš„é€‚ç”¨æ¡ä»¶" class="headerlink" title="çŠ¶å‹DPçš„é€‚ç”¨æ¡ä»¶"></a>çŠ¶å‹DPçš„é€‚ç”¨æ¡ä»¶</h2><p><strong>çŠ¶æ€å‹ç¼©å…¶å®æ˜¯æœ‰é€‚ç”¨ç¯å¢ƒçš„ï¼š</strong></p><ol><li>çŠ¶æ€éœ€è¦æœ‰ä¸€å®šçš„çŠ¶æ€å•å…ƒã€‚ å³ä¸€ä¸ªçŠ¶æ€åº”è¯¥æ˜¯ä¿å­˜ä¸€ä¸ªé›†åˆï¼Œå…¶ä¸­çš„å…ƒç´ å€¼å¯¹åº”ç€0æˆ–1ï¼Œä¾‹å¦‚æˆ‘ä»¬å¸¸è§çš„æ£‹ç›˜ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨0æˆ–1æ¥è¡¨ç¤ºæ£‹å­çš„æ”¾ç½®çŠ¶æ€ã€‚è€Œæ•´ä¸ªé›†åˆå³æ˜¯ä¸€ä¸ª01ä¸²ï¼Œå³äºŒè¿›åˆ¶æ•°ï¼Œæˆ‘ä»¬é€šå¸¸ç”¨åè¿›åˆ¶è¡¨ç¤ºã€‚é‚£ä¹ˆæˆ‘ä»¬å†è¿›è¡ŒçŠ¶æ€è½¬ç§»æˆ–è€…åˆ¤æ–­çš„æ—¶å€™ï¼Œéœ€è¦å…ˆå°†åè¿›åˆ¶è½¬åŒ–ä¸ºäºŒè¿›åˆ¶ï¼Œå†å°†äºŒè¿›åˆ¶è½¬åŒ–ä¸ºåè¿›åˆ¶ã€‚</li><li>é¢˜ç›®ä¸­é™åˆ¶çš„é›†åˆå¤§å°ä¸ä¼šè¶…è¿‡20ã€‚ è¿™æ˜¯æœ€æ˜¾è‘—çš„ç‰¹å¾ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“å¦‚æœç”¨äºŒè¿›åˆ¶è¡¨ç¤ºçŠ¶æ€ï¼Œé‚£ä¹ˆé›†åˆå¤§å°ä¸º20çš„äºŒè¿›åˆ¶çŠ¶æ€æœ‰2^{20} - 1å·²ç»è¾¾åˆ°1e7çš„æ•°é‡çº§äº†ã€‚</li><li>å…·æœ‰åŠ¨æ€è§„åˆ’çš„ç‰¹æ€§ã€‚ å¯¹äºåŠ¨æ€è§„åˆ’ï¼Œä¸€èˆ¬éƒ½æ˜¯è¦æ±‚æœ€ä¼˜åŒ–æŸä¸ªå€¼ï¼Œå…·æœ‰æœ€ä¼˜å­ç»“æ„çš„æ€§è´¨ã€‚åŒæ—¶ä¹Ÿéœ€è¦æ»¡è¶³çŠ¶æ€è½¬ç§»çš„ç‰¹æ€§ï¼Œè€Œä¸æ˜¯å‰ä¸€ä¸ªçŠ¶æ€æ¯«æ— å…³ç³»çš„ã€‚</li></ol><p>é€‚ç”¨ç¯å¢ƒæ€»ç»“ï¼š</p><ol><li>äºŒè¿›åˆ¶</li><li>é›†åˆ&#x2F;çŠ¶æ€å¤§å°å—é™ï¼ˆæ¯”å¦‚ä¸ä¼šå¤§äºintç±»å‹èƒ½è¡¨ç¤ºçš„æœ€å¤§æ•°ï¼‰</li><li>æ»¡è¶³åŠ¨æ€è§„åˆ’ç‰¹æ€§</li></ol><h2 id="çŠ¶å‹DPçš„æ¿å­"><a href="#çŠ¶å‹DPçš„æ¿å­" class="headerlink" title="çŠ¶å‹DPçš„æ¿å­"></a>çŠ¶å‹DPçš„æ¿å­</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> maxn = <span class="number">1</span> &lt;&lt; n;<span class="comment">//æ€»çŠ¶æ€æ•°ã€‚</span></span><br><span class="line"><span class="comment">//æšä¸¾å·²æœ‰çš„é›†åˆæ•°ã€‚æŒ‰ç…§çŠ¶æ€è½¬ç§»çš„é¡ºåºï¼Œä¸€èˆ¬ä»å°ç¼–å·åˆ°å¤§ç¼–å·ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; ++ i)&#123;</span><br><span class="line">    <span class="comment">//æšä¸¾å½“å‰é›†åˆä¸­çš„çŠ¶æ€ã€‚</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; maxn; ++ j)&#123;</span><br><span class="line">        <span class="comment">//åˆ¤æ–­å½“å‰é›†åˆæ˜¯å¦å¤„äºåˆæ³•çŠ¶æ€ï¼Œé€šå¸¸æˆ‘ä»¬éœ€ç”¨ä¸€ä¸ªæ•°ç»„æå‰å¤„ç†å¥½ã€‚å¦‚gæ•°ç»„;</span></span><br><span class="line">        <span class="keyword">if</span>(å½“å‰çŠ¶æ€æ˜¯å¦åˆæ ¼)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; maxn; ++ k)&#123;</span><br><span class="line">                <span class="comment">//æšä¸¾ä¸Šä¸€ä¸ªé›†åˆçš„çŠ¶æ€ã€‚</span></span><br><span class="line">                <span class="keyword">if</span>(ä¸Šä¸€ä¸ªé›†åˆçš„çŠ¶æ€æ˜¯å¦åˆæ ¼ + ä¸Šä¸€ä¸ªé›†åˆçš„çŠ¶æ€å’Œå½“å‰çŠ¶æ€çš„é›†åˆæ˜¯å¦äº§ç”Ÿäº†å†²çª)&#123;</span><br><span class="line">                    åˆ—å†™çŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€‚</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h3 id="USACO06NOV-Corn-Fields-G"><a href="#USACO06NOV-Corn-Fields-G" class="headerlink" title=" USACO06NOV Corn Fields G"></a><a href="https://www.luogu.com.cn/problem/P1879"> USACO06NOV Corn Fields G</a></h3><p>å†œåœºä¸»Johnæ–°ä¹°äº†ä¸€å—é•¿æ–¹å½¢çš„æ–°ç‰§åœºï¼Œè¿™å—ç‰§åœºè¢«åˆ’åˆ†æˆMè¡ŒNåˆ—(1 â‰¤ M â‰¤ 12; 1 â‰¤ N â‰¤ 12)ï¼Œæ¯ä¸€æ ¼éƒ½æ˜¯ä¸€å—æ­£æ–¹å½¢çš„åœŸåœ°ã€‚Johnæ‰“ç®—åœ¨ç‰§åœºä¸Šçš„æŸå‡ æ ¼é‡Œç§ä¸Šç¾å‘³çš„è‰ï¼Œä¾›ä»–çš„å¥¶ç‰›ä»¬äº«ç”¨ã€‚</p><p>é—æ†¾çš„æ˜¯ï¼Œæœ‰äº›åœŸåœ°ç›¸å½“è´«ç˜ ï¼Œä¸èƒ½ç”¨æ¥ç§è‰ã€‚å¹¶ä¸”ï¼Œå¥¶ç‰›ä»¬å–œæ¬¢ç‹¬å ä¸€å—è‰åœ°çš„æ„Ÿè§‰ï¼Œäºæ˜¯Johnä¸ä¼šé€‰æ‹©ä¸¤å—ç›¸é‚»çš„åœŸåœ°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ²¡æœ‰å“ªä¸¤å—è‰åœ°æœ‰å…¬å…±è¾¹ã€‚</p><p>Johnæƒ³çŸ¥é“ï¼Œå¦‚æœä¸è€ƒè™‘è‰åœ°çš„æ€»å—æ•°ï¼Œé‚£ä¹ˆï¼Œä¸€å…±æœ‰å¤šå°‘ç§ç§æ¤æ–¹æ¡ˆå¯ä¾›ä»–é€‰æ‹©ï¼Ÿï¼ˆå½“ç„¶ï¼ŒæŠŠæ–°ç‰§åœºå®Œå…¨è’åºŸä¹Ÿæ˜¯ä¸€ç§æ–¹æ¡ˆï¼‰</p><p>è¾“å…¥æ ¼å¼</p><p>ç¬¬ä¸€è¡Œï¼šä¸¤ä¸ªæ•´æ•°Må’ŒNï¼Œç”¨ç©ºæ ¼éš”å¼€ã€‚</p><p>ç¬¬2åˆ°ç¬¬M+1è¡Œï¼šæ¯è¡ŒåŒ…å«Nä¸ªç”¨ç©ºæ ¼éš”å¼€çš„æ•´æ•°ï¼Œæè¿°äº†æ¯å—åœŸåœ°çš„çŠ¶æ€ã€‚ç¬¬i+1è¡Œæè¿°äº†ç¬¬iè¡Œçš„åœŸåœ°ï¼Œæ‰€æœ‰æ•´æ•°å‡ä¸º0æˆ–1ï¼Œæ˜¯1çš„è¯ï¼Œè¡¨ç¤ºè¿™å—åœŸåœ°è¶³å¤Ÿè‚¥æ²ƒï¼Œ0åˆ™è¡¨ç¤ºè¿™å—åœŸåœ°ä¸é€‚åˆç§è‰ã€‚</p><p>è¾“å‡ºæ ¼å¼</p><p>ä¸€ä¸ªæ•´æ•°ï¼Œå³ç‰§åœºåˆ†é…æ€»æ–¹æ¡ˆæ•°é™¤ä»¥100,000,000çš„ä½™æ•°ã€‚</p><p>è¾“å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2 3</span><br><span class="line">1 1 1</span><br><span class="line">0 1 0</span><br></pre></td></tr></table></figure><p>è¾“å‡º</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">9</span><br></pre></td></tr></table></figure><p>æ€è·¯ï¼š</p><p>æˆ‘ä»¬å…ˆä½œå‡ºè§„å®šï¼Œå®šä¹‰nä»£è¡¨çš„æ˜¯è¡Œï¼Œmä»£è¡¨çš„æ˜¯åˆ—ã€‚é‚£ä¹ˆç‰§åœºå¤§å°å°±æ˜¯n Ã— mã€‚æˆ‘ä»¬çœ‹åˆ°æ•°æ®èŒƒå›´,n , méƒ½ç‰¹åˆ«å°ï¼ŒåŒæ—¶æ‰€æ±‚ä¸ºæ–¹æ¡ˆæ•°ï¼Œè¿™å¾ˆç¬¦åˆçŠ¶å‹DPçš„é€‚ç”¨æ¡ä»¶ã€‚é‚£ä¹ˆå¯¹äºæ¯ä¸€è¡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹æˆä¸€ä¸ªæœªçŸ¥é›†åˆï¼Œè€Œé›†åˆçš„å¤§å°è‡ªç„¶å°±æ˜¯åˆ—mã€‚å¯¹äºæ¯ä¸€ä¸ªå•å…ƒï¼Œå…¶å–å€¼èŒƒå›´ä¸º0 , 1ï¼Œè€Œ1ä»£è¡¨æ”¾ç½®å¥¶ç‰›ï¼Œ0ä»£è¡¨ä¸æ”¾ç½®å¥¶ç‰›ï¼Œæ‰€ä»¥æˆ‘ä»¬è‡ªç„¶å¯ä»¥ç”¨äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œé‚£ä¹ˆçŠ¶æ€æ€»æ•°å°±æ˜¯( 1 &lt; &lt; m ) âˆ’ 1ã€‚ </p><ol><li>å¯¹äºæ¯ä¸€ä¸ªçŠ¶æ€ï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­æ˜¯å¦åˆæ ¼ï¼Œè€Œå…¶ä¸­æ˜ç¡®ä¸èƒ½é€‰æ‹©ä¸¤å—ç›¸é‚»çš„åœŸåœ°ï¼Œåœ¨é›†åˆå†…ï¼Œå³ç›¸é‚»ä½ä¸èƒ½å…¨ä¸º1ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é¢„å¤„ç†<strong>gæ•°ç»„</strong>ï¼Œå¤„ç†æ–¹å¼å³ä¸º:g[i] &#x3D; !(i &amp; (i &lt;&lt; 1))ï¼ˆè¿™é‡Œçš„içš„å–å€¼ä»0åˆ°æ‰€æœ‰çš„çŠ¶æ€ï¼‰ï¼›</li><li>åŒæ ·ï¼Œæˆ‘ä»¬è¿˜åº”è¯¥çŸ¥æ™“åœŸåœ°çš„çŠ¶å†µï¼Œå› ä¸ºæ¯•ç«Ÿåªæœ‰åœŸåœ°è‚¥æ²ƒæ‰å¯ä»¥æ”¾ç½®å¥¶ç‰›ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªstæ•°ç»„åˆ¤æ–­ï¼Œé›†åˆä¸é›†åˆä¹‹é—´ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦è€ƒè™‘ç›¸é‚»ä½ä¸èƒ½å…¨ä¸º1ï¼Œæ‰€ä»¥åœ¨æšä¸¾ä¸Šä¸€ä¸ªé›†åˆçš„çŠ¶æ€ä¹Ÿéœ€è¦ä¸¥æ ¼åˆ¤æ–­ã€‚</li><li>å¯¹äºçŠ¶æ€å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨f [ i ] [ j ]è¡¨ç¤ºç¬¬iè¡Œä¸”çŠ¶æ€ä¸ºjçš„æ–¹æ¡ˆæ•°ã€‚</li><li>å¯¹äºçŠ¶æ€è½¬ç§»ï¼Œå‡è®¾ä¸Šä¸€è¡ŒçŠ¶æ€ä¸ºkï¼Œåˆ™çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸ºï¼šf [ i ] [ j ] + &#x3D; f [ i âˆ’ 1 ] [ k ]</li></ol><p>ç­”æ¡ˆï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">10</span> + <span class="number">5</span>,M = <span class="number">10</span> + <span class="number">5</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> P = <span class="number">1e8</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m;<span class="comment">//nè¡Œmåˆ—çš„åœŸåœ°ã€‚</span></span><br><span class="line"><span class="type">int</span> a[N][M],st[N];<span class="comment">//aä»£è¡¨åœŸåœ°ï¼Œstä»£è¡¨æ¯ä¸€è¡Œçš„åœŸåœ°çŠ¶å†µã€‚</span></span><br><span class="line"><span class="type">bool</span> g[<span class="number">1</span> &lt;&lt; N];<span class="comment">//gå¾—åˆ°æ‰€æœ‰çŠ¶æ€ä¸­çš„åˆæ³•çŠ¶æ€ã€‚</span></span><br><span class="line"><span class="type">int</span> f[N][<span class="number">1</span> &lt;&lt; N];<span class="comment">//f[i][j]è¡¨ç¤ºçš„åˆ™æ˜¯ç¬¬iè¡Œä¸”çŠ¶æ€ä¸ºjçš„æ–¹æ¡ˆæ•°ï¼Œæ˜¯ç”±ä¸Šä¸€è¡Œè½¬ç§»è¿‡æ¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å®šä¹‰ä¸Šä¸€è¡Œçš„çŠ¶æ€ä¸ºkã€‚</span></span><br><span class="line"><span class="comment">//åˆ™çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸ºf[i][j] += f[i - 1][k];//å…¶ä¸­jå’Œkå¿…é¡»æ»¡è¶³æ¡ä»¶ã€‚</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++ i)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; ++ j)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¾—åˆ°æ¯ä¸€è¡Œçš„åœŸåœ°çŠ¶å†µã€‚</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++ i)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>; j &lt;= m; ++ j)&#123;</span><br><span class="line">            st[i] = (st[i] &lt;&lt; <span class="number">1</span>) + a[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¾—åˆ°æ‰€æœ‰çŠ¶æ€ä¸­çš„åˆæ³•çŠ¶æ€ã€‚</span></span><br><span class="line">    <span class="type">int</span> maxn = <span class="number">1</span> &lt;&lt; m;<span class="comment">//æ€»çŠ¶æ€ã€‚</span></span><br><span class="line">    f[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;<span class="comment">//åˆå§‹åŒ–ï¼Œè¿™ç§ä¹Ÿç®—ä¸€ç§ã€‚</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; maxn; ++ i)&#123;</span><br><span class="line">        g[i] = !( i &amp; (i &lt;&lt; <span class="number">1</span>));<span class="comment">//ç”±äºä¸èƒ½ç›¸é‚»ï¼Œæ‰€ä»¥æˆ‘ä»¬å·¦ç§»åˆ¤æ–­æ˜¯å¦ç¬¦åˆæ¡ä»¶ã€‚ </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; ++ i)&#123;</span><br><span class="line">        <span class="comment">//æšä¸¾æ¯ä¸€è¡Œã€‚</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; maxn; ++ j)&#123;</span><br><span class="line">            <span class="comment">//æšä¸¾æ¯ä¸€è¡Œçš„çŠ¶æ€ï¼Œåˆ¤æ–­æ­¤çŠ¶æ€æ˜¯å¦ç¬¦åˆæ¡ä»¶ã€‚1.ä¸èƒ½ç›¸é‚»ã€‚2.æ˜¯å…¨éƒ¨çŠ¶æ€çš„å­é›†ã€‚</span></span><br><span class="line">            <span class="keyword">if</span>(g[j] &amp;&amp; (j &amp; st[i]) == j)&#123;</span><br><span class="line">                <span class="comment">//å¦‚æœç¬¦åˆæ¡ä»¶ã€‚åˆ™æˆ‘ä»¬å»åˆ¤æ–­ä¸Šä¸€è¡Œæ˜¯å¦ç¬¦åˆã€‚</span></span><br><span class="line">                <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>; k &lt; maxn; ++ k)&#123;</span><br><span class="line">                    <span class="comment">//æšä¸¾ä¸Šä¸€è¡ŒçŠ¶æ€ã€‚æ³¨æ„ï¼Œè¿™é‡Œæˆ‘ä»¬æ— éœ€åˆ¤æ–­ä¸Šä¸€è¡ŒçŠ¶æ€æ˜¯å¦å­˜åœ¨ï¼Œå› ä¸ºä¸å­˜åœ¨å³ä¸º0.</span></span><br><span class="line">                    <span class="comment">//åªéœ€è¦åˆ¤æ–­jå’Œkæ˜¯å¦å­˜åœ¨ç›¸é‚»è‰åœ°ã€‚</span></span><br><span class="line">                    <span class="keyword">if</span>(!(j &amp; k))&#123;</span><br><span class="line">                        f[i][j] = (f[i][j] + f[i - <span class="number">1</span>][k]) % P;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>; j &lt; maxn; ++ j)&#123;</span><br><span class="line">        ans = (ans + f[n][j]) % P;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ans);</span><br><span class="line">    <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ç³–æœ"><a href="#ç³–æœ" class="headerlink" title="ç³–æœ"></a>ç³–æœ</h3><p>ã€é—®é¢˜æè¿°ã€‘<br>ç³–æœåº—çš„è€æ¿ä¸€å…±æœ‰ M ç§å£å‘³çš„ç³–æœå‡ºå”®ã€‚ä¸ºäº†æ–¹ä¾¿æè¿°ï¼Œæˆ‘ä»¬å°†Mç§å£å‘³ç¼–å·1~Mã€‚<br>å°æ˜å¸Œæœ›èƒ½å“å°åˆ°æ‰€æœ‰å£å‘³çš„ç³–æœã€‚é—æ†¾çš„æ˜¯è€æ¿å¹¶ä¸å•ç‹¬å‡ºå”®ç³–æœï¼Œè€Œæ˜¯Ké¢—ä¸€åŒ…æ•´åŒ…å‡ºå”®ã€‚<br>å¹¸å¥½ç³–æœåŒ…è£…ä¸Šæ³¨æ˜äº†å…¶ä¸­Ké¢—ç³–æœçš„å£å‘³ï¼Œæ‰€ä»¥å°æ˜å¯ä»¥åœ¨ä¹°ä¹‹å‰å°±çŸ¥é“æ¯åŒ…å†…çš„ç³–æœå£å‘³ã€‚<br>ç»™å®šNåŒ…ç³–æœï¼Œè¯·ä½ è®¡ç®—å°æ˜æœ€å°‘ä¹°å‡ åŒ…ï¼Œå°±å¯ä»¥å“å°åˆ°æ‰€æœ‰å£å‘³çš„ç³–æœ<br>ã€è¾“å…¥æ ¼å¼ã€‘<br>ç¬¬ä¸€è¡ŒåŒ…å«ä¸‰ä¸ªæ•´æ•° Nã€M å’Œ Kã€‚<br>æ¥ä¸‹æ¥ N è¡Œæ¯è¡Œ Kä¸ªæ•´æ•° T1,T2,â€¦.TÎºï¼Œä»£è¡¨ä¸€åŒ…ç³–æœçš„å£å‘³ã€‚<br>ã€è¾“å‡ºæ ¼å¼ã€‘<br>ä¸€ä¸ªæ•´æ•°è¡¨ç¤ºç­”æ¡ˆã€‚å¦‚æœå°æ˜æ— æ³•å“å°æ‰€æœ‰å£å‘³ï¼Œè¾“å‡º-1ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"><span class="type">Scanner</span> <span class="variable">sc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">    <span class="type">int</span> n=sc.nextInt();</span><br><span class="line">    <span class="type">int</span> m=sc.nextInt();</span><br><span class="line">    <span class="type">int</span> k=sc.nextInt();</span><br><span class="line">    <span class="type">int</span>[][] a = <span class="keyword">new</span> <span class="title class_">int</span>[n][k];</span><br><span class="line">    <span class="type">int</span>[] sta = <span class="keyword">new</span> <span class="title class_">int</span>[n];</span><br><span class="line">    <span class="type">int</span>[] dp = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">1</span>&lt;&lt;k];</span><br><span class="line">    Arrays.fill(dp, -<span class="number">1</span>);</span><br><span class="line">    dp[<span class="number">0</span>]=<span class="number">0</span>;<span class="comment">// åŠ¨è§„æ•°ç»„åªæœ‰dp[0]ä¸º0ï¼Œå…¶ä½™å…¨éƒ¨åˆå§‹åŒ–-1</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>; j&lt;=k; j++)&#123;</span><br><span class="line">            a[i][j] = sc.nextInt(); <span class="comment">// è¯»å–æ•°æ®</span></span><br><span class="line">            <span class="comment">/* æ­¤å¤„ç”¨sta[i]åšäº†kæ¬¡æˆ–èµ‹å€¼ï¼Œè§£é‡Šå¦‚ä¸‹ã€‚ */</span></span><br><span class="line">            <span class="comment">/* å¯¹äºæ•°æ®a[i][j]ï¼Œæ„å‘³ç¬¬iä¸ªåŒ…è£¹ä¸­çš„ç¬¬jå—ç³–æœçš„ç§ç±» */</span></span><br><span class="line">            <span class="comment">/* æ¯”å¦‚a[i][j]æ˜¯ç¬¬4ç±»ç³–æœï¼Œé‚£ä¹ˆ1&lt;&lt;(a[i][j]-1)çš„å€¼ä¸ºäºŒè¿›åˆ¶çš„1000ï¼Œä¹Ÿå°±æ˜¯ç¬¬å››ç±»ç³–æœè¢«é€‰ä¸­ã€‚ */</span></span><br><span class="line">            <span class="comment">/* å½“sta[i]åšäº†kæ¬¡æˆ–èµ‹å€¼åï¼Œsta[i]çš„äºŒè¿›åˆ¶ä¸Šä¼šæœ‰è‹¥å¹²ä¸ª1ï¼Œè¡¨ç¤ºç¬¬iä¸ªåŒ…è£¹ä¸­æœ‰å“ªäº›ç±»åˆ«çš„ç³–æœã€‚ */</span></span><br><span class="line">            sta[i] |= <span class="number">1</span> &lt;&lt; (a[i][j] - <span class="number">1</span>);           </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* è¿™é‡Œè¯´æ˜ä¸€ä¸‹dpæ•°ç»„çš„å«ä¹‰ */</span></span><br><span class="line">        <span class="comment">/* dp[l] = kï¼Œè¡¨ç¤ºè¦æƒ³è·å¾—lçš„äºŒè¿›åˆ¶è¡¨ç¤ºçš„æ‰€æœ‰ç³–æœç§ç±»ï¼Œè‡³å°‘è¦é€‰å–kä¸ªåŒ…è£¹ã€‚ */</span></span><br><span class="line">        <span class="comment">/* ç”±äºæˆ‘ä»¬åˆšåˆšåˆå§‹åŒ–staæ•°ç»„ï¼Œé‚£ä¹ˆè¿™é‡Œè¡¨ç¤ºçš„å«ä¹‰å°±æ˜¯å¯¹äºæ¯ä¸€ä¸ªåŒ…è£¹ï¼Œè¦æƒ³è·å¾—è¿™ä¸ªåŒ…è£¹é‡Œçš„æ‰€æœ‰ç³–æœç§ç±»ï¼Œéœ€è¦1ä¸ªåŒ…è£¹ã€‚ */</span></span><br><span class="line">        dp[sta[i]] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/* æ¥ä¸‹æ¥å°±æ˜¯åŠ¨è§„å¾—å‡ºç­”æ¡ˆäº† */</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;=n; i++) &#123; <span class="comment">// ä¾æ¬¡è€ƒè™‘æ¯ä¸€ä¸ªåŒ…è£¹ï¼Œè·å–åŒ…è£¹åä¼šå¯¹dpæœ‰ä»€ä¹ˆå½±å“</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>; j&lt;(<span class="number">1</span>&lt;&lt;m); j++) &#123; <span class="comment">// åœ¨è€ƒè™‘åŒ…è£¹iæ—¶ï¼Œå¯¹æ‰€æœ‰å·²ç»å­˜åœ¨çš„çŠ¶æ€jéƒ½åšåˆ†æï¼Œçœ‹åŒ…è£¹iæ˜¯å¦å¯¹çŠ¶æ€jæœ‰æ‰€å½±å“</span></span><br><span class="line">            <span class="keyword">if</span> (dp[j] == -<span class="number">1</span>) <span class="keyword">continue</span>; <span class="comment">// çŠ¶æ€jä¸å­˜åœ¨ï¼Œè€ƒè™‘ä¸‹ä¸€ä¸ª</span></span><br><span class="line">            <span class="comment">/* åˆ†ä¸¤ç§æƒ…å†µ */</span></span><br><span class="line">            <span class="comment">/* çŠ¶æ€jå­˜åœ¨ï¼Œä½†æ‹¿åˆ°åŒ…è£¹iåï¼ŒçŠ¶æ€j|sta[i]ä¸å­˜åœ¨ï¼Œæ›´æ–°ä¹‹ */</span></span><br><span class="line">            <span class="comment">/* çŠ¶æ€jå­˜åœ¨ï¼Œæ‹¿åˆ°åŒ…è£¹iåçš„çŠ¶æ€ä¹Ÿå­˜åœ¨ï¼Œä½†åœ¨çŠ¶æ€jä¸‹æ‹¿åˆ°åŒ…è£¹iï¼Œæ¯”ä¹‹å‰çš„ä»£ä»·æ›´å°ï¼Œæ›´æ–°ä¹‹ */</span></span><br><span class="line">            <span class="keyword">if</span> (dp[j | sta[i]] == -<span class="number">1</span> || dp[j] + <span class="number">1</span> &lt; dp[j|sta[i]]) &#123;</span><br><span class="line">                dp[j | sta[i]] = dp[j] + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(dp[(<span class="number">1</span> &lt;&lt; m) - <span class="number">1</span>]); <span class="comment">// æœ€åè¾“å‡ºçš„æ˜¯è¦æ‹¿åˆ°æ‰€æœ‰ç³–æœç§ç±»éœ€è¦çš„æœ€å°‘åŒ…è£¹æ•°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åšå®¢ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
            <tag> Java </tag>
            
            <tag> C++ </tag>
            
            <tag> åŠ¨æ€è§„åˆ’ </tag>
            
            <tag> çŠ¶æ€å‹ç¼© </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rustä¸­çš„é”™è¯¯å¤„ç†</title>
      <link href="/2024/07/18/2024-07-18-Rust%E4%B8%AD%E7%9A%84%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86/"/>
      <url>/2024/07/18/2024-07-18-Rust%E4%B8%AD%E7%9A%84%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86/</url>
      
        <content type="html"><![CDATA[<h1 id="Rustä¸­çš„é”™è¯¯å¤„ç†"><a href="#Rustä¸­çš„é”™è¯¯å¤„ç†" class="headerlink" title="Rustä¸­çš„é”™è¯¯å¤„ç†"></a>Rustä¸­çš„é”™è¯¯å¤„ç†</h1><p>å¦‚æœä½ ä½¿ç”¨è¿‡å…¶ä»–ç¼–ç¨‹è¯­è¨€ï¼Œé‚£ä¹ˆå°±ä¼šçŸ¥é“Rustä¸­çš„é”™è¯¯å¤„ç†æ˜¯å®Œå…¨ä¸åŒçš„æ–¹æ³•ã€‚åƒJava,JS,Pythonç­‰ä½ å¸¸å¸¸ä¼šä½¿ç”¨<code>throw</code>å¤„ç†å¼‚å¸¸ï¼Œä»¥åŠ<code>return</code>æˆåŠŸçš„å€¼ã€‚ä½†åœ¨Rustä¸­ï¼Œä½ ä¼šè¿”å›ç»™è°ƒç”¨è€…ä¸€ä¸ª<code>Result</code></p><p><code>Result&lt;T, E&gt;</code>æ˜¯ä¸€ä¸ªæ‹¥æœ‰ä¸¤ä¸ªå€¼çš„æšä¸¾ç±»å‹ï¼Œå…¶ä¸­<code>Ok(T)</code>ç”¨æ¥è¿”å›æˆåŠŸå€¼ï¼Œ<code>Err(E)</code>ç”¨æ¥è¿”å›é”™è¯¯å€¼</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Result</span>&lt;T, E&gt; &#123;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(T),</span><br><span class="line">    <span class="title function_ invoke__">Err</span>(E),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿”å›é”™è¯¯è€Œä¸æ˜¯æŠ›å‡ºé”™è¯¯,è¿™æ˜¯ä¸€ç§ç¼–ç¨‹ä¹ æƒ¯çš„è½¬å˜ã€‚æ‰€ä»¥å¦‚æœä½ æ˜¯Rustçš„åˆå­¦è€…ï¼Œå¯èƒ½åˆšå¼€å§‹å­¦ä¹ èµ·æ¥è§‰å¾—å¾ˆéº»çƒ¦ï¼Œå› ä¸ºè¿™éœ€è¦ä½ ç”¨å»æ€è€ƒåœ¨ä¸åŒçš„åœºæ™¯ï¼Œåº”è¯¥ä½¿ç”¨ä»€ä¹ˆæ ·çš„æ–¹æ³•å»å¤„ç†é”™è¯¯ã€‚</p><p>åœ¨è¿™ç¯‡åšå®¢ä¸­ä¼šæœ‰é”™è¯¯å¤„ç†çš„ä¸€äº›èŒƒå¼ï¼Œä»¥åŠå®ƒä»¬åœ¨Rustä¸­æ˜¯å¦‚ä½•ä½“ç°çš„ï¼š</p><ul><li>å¿½ç•¥é”™è¯¯</li><li>ç›´æ¥ç»“æŸç¨‹åº</li><li>ä½¿ç”¨é»˜è®¤å€¼å¤„ç†</li><li>ä¼ é€’é”™è¯¯</li><li>ä¼ é€’å¤šä¸ªé”™è¯¯</li><li>æ¨¡å¼åŒ¹é…Boxedé”™è¯¯</li><li>ä½¿ç”¨åº“ or åº”ç”¨</li><li>åˆ›å»ºè‡ªå®šä¹‰é”™è¯¯</li><li>ä¼ é€’è‡ªå®šä¹‰é”™è¯¯</li><li>æ¨¡å¼åŒ¹é…è‡ªå®šä¹‰é”™è¯¯</li></ul><h2 id="å¿½ç•¥é”™è¯¯-unwrap"><a href="#å¿½ç•¥é”™è¯¯-unwrap" class="headerlink" title="å¿½ç•¥é”™è¯¯(unwrap())"></a><strong>å¿½ç•¥é”™è¯¯</strong>(unwrap())</h2><p>ï¼ˆå¦‚æœå‡ºç°é”™è¯¯ä¼šè§¦å‘panicï¼Œè®©è¯¥çº¿ç¨‹é€€å‡ºï¼‰</p><p>æœ€ç®€å•çš„å¤„ç†æ–¹æ³•å°±æ˜¯ç›´æ¥å¿½ç•¥è¿™ä¸ªé”™è¯¯ï¼Œè¿™å¬èµ·æ¥æ˜¯ä¸å¤ªå¥½çš„æƒ³æ³•ï¼Œä½†æ˜¯å¯ä»¥åœ¨ä»¥ä¸‹æƒ…å†µä½¿ç”¨ï¼š</p><ul><li>åˆšåˆšå¼€å§‹ç¼–å†™ä»£ç ï¼Œä¸æƒ³æµªè´¹å¤ªå¤šæ—¶é—´åœ¨é”™è¯¯å¤„ç†ä¸Šã€‚</li><li>åšå®šç¡®ä¿¡å½“å‰çš„æƒ…å†µä¸‹ï¼Œé”™è¯¯ä¸€å®šä¸ä¼šå‘ç”Ÿã€‚</li></ul><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::fs;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">content</span> = fs::<span class="title function_ invoke__">read_to_string</span>(<span class="string">&quot;./Cargo.toml&quot;</span>).<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, content)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å³ä½¿çŸ¥é“æ–‡ä»¶ä¼šå­˜åœ¨ï¼Œä½†æ˜¯ç¼–è¯‘å™¨ä¹Ÿæ— æ³•çŸ¥é“ã€‚å› æ­¤ï¼Œä½¿ç”¨<code>unwrap()</code>å…³é”®å­—è®©ç¼–è¯‘å™¨ä¿¡ä»»ï¼Œå¹¶è¿”å›å…¶ä¸­çš„å€¼ã€‚å¦‚æœ<code>read_to_string()</code>å‡½æ•°è¿”å›ä¸€ä¸ª<code>Ok()</code>ï¼Œunwrapå°†è·å–<code>Ok()</code>çš„å†…å®¹å¹¶å°†å…¶åˆ†é…ç»™contentå˜é‡ã€‚å¦‚æœå®ƒè¿”å›ä¸€ä¸ªé”™è¯¯ï¼Œé‚£ä¹ˆç¨‹åºä¼šé™·å…¥<code>panic</code>è¿™å›è®©å½“å‰ç¨‹åºçº¿ç¨‹é€€å‡ºã€‚</p><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯åœ¨è®¸å¤šRustç¤ºä¾‹ä»£ç ä¸­ä½¿ç”¨<code>unwrap</code>æ¥è·³è¿‡é”™è¯¯å¤„ç†ï¼Œä½†æ˜¯è¿™æ ·åšä¸»è¦æ˜¯ä¸ºäº†æ–¹ä¾¿ï¼Œä¸åº”è¯¥åœ¨å®é™…å¼€å‘ä¸­ä½¿ç”¨ã€‚</p></blockquote><h2 id="ç»“æŸç¨‹åº-expect"><a href="#ç»“æŸç¨‹åº-expect" class="headerlink" title="ç»“æŸç¨‹åº(expect())"></a><strong>ç»“æŸç¨‹åº</strong>(expect())</h2><p>æœ‰äº›é”™è¯¯æ— æ³•å¤„ç†æˆ–ä»ä¸­æ¢å¤ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œæœ€å¥½ç›´æ¥ç»ˆæ­¢ç¨‹åºã€‚ è®©ä½¿ç”¨ä¸ä¸Šé¢ç›¸åŒçš„ä¾‹å­â€”â€”æ­£åœ¨è¯»å–ä¸€ä¸ªæ–‡ä»¶ï¼Œè‚¯å®šä¼šçœ‹åˆ°å®ƒã€‚æƒ³è±¡ä¸€ä¸‹ï¼Œå¯¹äºè¿™ä¸ªç¨‹åºæ¥è¯´ï¼Œè¿™ä¸ªæ–‡ä»¶ç»å¯¹é‡è¦ï¼Œæ²¡æœ‰å®ƒå°±æ— æ³•æ­£å¸¸å·¥ä½œã€‚å¦‚æœç”±äºæŸç§åŸå› ï¼Œè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆæœ€å¥½åº”è¯¥ç›´æ¥ç»ˆæ­¢è¯¥ç¨‹åºã€‚</p><p>å¯ä»¥åƒä¹‹å‰ä¸€æ ·ä½¿ç”¨<code>unwrap</code>æˆ–è€…ä½¿ç”¨<code>expect</code>ï¼Œå®ƒå’Œ<code>unwrap</code>å·®ä¸å¤šï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯æ·»åŠ äº†é¢å¤–çš„é”™è¯¯ä¿¡æ¯ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::fs;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">content</span> = fs::<span class="title function_ invoke__">read_to_string</span>(<span class="string">&quot;./Cargo.toml&quot;</span>).<span class="title function_ invoke__">expect</span>(<span class="string">&quot;Can&#x27;t read Cargo.toml&quot;</span>);</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, content)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>äº†è§£å…³äºï¼š<code>panic!</code></p><h2 id="ä½¿ç”¨é»˜è®¤å€¼-unwrap-or"><a href="#ä½¿ç”¨é»˜è®¤å€¼-unwrap-or" class="headerlink" title="ä½¿ç”¨é»˜è®¤å€¼(unwrap_or())"></a><strong>ä½¿ç”¨é»˜è®¤å€¼</strong>(unwrap_or())</h2><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡è¿”å›é»˜è®¤å€¼æ¥å¤„ç†é”™è¯¯ã€‚</p><p>ä¾‹å¦‚æ­£åœ¨ç¼–å†™ä¸€ä¸ªæœåŠ¡å™¨ï¼Œå®ƒç›‘å¬çš„ç«¯å£å¯ä»¥ä½¿ç”¨ç¯å¢ƒå˜é‡è¿›è¡Œé…ç½®ã€‚å¦‚æœæ²¡æœ‰è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œåˆ™è®¿é—®è¯¥å€¼å°†å¯¼è‡´é”™è¯¯ã€‚ä½†å¯ä»¥é€šè¿‡è¿”å›é»˜è®¤å€¼æ¥è½»æ¾å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::env;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">port</span> = env::<span class="title function_ invoke__">var</span>(<span class="string">&quot;PORT&quot;</span>).<span class="title function_ invoke__">unwrap_or</span>(<span class="string">&quot;3000&quot;</span>.<span class="title function_ invoke__">to_string</span>());</span><br><span class="line">  <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, port);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œï¼Œä½¿ç”¨åœ¨è¿™é‡Œï¼Œä½¿ç”¨äº†ä¸€ç§ç§°ä¸º<code>unwrap_or</code>çš„<code>unwrap</code>å˜ä½“ï¼Œå®ƒå…è®¸æä¾›é»˜è®¤å€¼ã€‚</p><p>äº†è§£å…³äºï¼š <code>unwrap_or_else</code>, <code>unwrap_or_default</code></p><h2 id="ä¼ é€’é”™è¯¯ç»™è°ƒç”¨è€…"><a href="#ä¼ é€’é”™è¯¯ç»™è°ƒç”¨è€…" class="headerlink" title="ä¼ é€’é”™è¯¯ç»™è°ƒç”¨è€…"></a><strong>ä¼ é€’é”™è¯¯ç»™è°ƒç”¨è€…</strong></h2><p>å½“æ²¡æœ‰è¶³å¤Ÿçš„contextæ¥å¤„ç†é”™è¯¯æ—¶ï¼Œå¯ä»¥å°†é”™è¯¯å†’æ³¡ï¼ˆå‘ä¸Šä¼ æ’­ï¼‰åˆ°è°ƒç”¨è€…å‡½æ•°ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç²¾å¿ƒè®¾è®¡çš„ç¤ºä¾‹ï¼Œå®ƒä½¿ç”¨WebæœåŠ¡è·å–å½“å‰å¹´ä»½ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::collections::HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">  <span class="keyword">match</span> <span class="title function_ invoke__">get_current_date</span>() &#123;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(date) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;We&#x27;ve time travelled to &#123;&#125;!!&quot;</span>, date),</span><br><span class="line">    <span class="title function_ invoke__">Err</span>(e) =&gt; <span class="built_in">eprintln!</span>(<span class="string">&quot;Oh noes, we don&#x27;t know which era we&#x27;re in! :( \n  &#123;&#125;&quot;</span>, e),</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">get_current_date</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">String</span>, reqwest::Error&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">url</span> = <span class="string">&quot;https://postman-echo.com/time/object&quot;</span>;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">result</span> = reqwest::blocking::<span class="title function_ invoke__">get</span>(url);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> <span class="variable">response</span> = <span class="keyword">match</span> result &#123;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(res) =&gt; res,</span><br><span class="line">    <span class="title function_ invoke__">Err</span>(err) =&gt; <span class="keyword">return</span> <span class="title function_ invoke__">Err</span>(err),</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> <span class="variable">body</span> = response.json::&lt;HashMap&lt;<span class="type">String</span>, <span class="type">i32</span>&gt;&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> <span class="variable">json</span> = <span class="keyword">match</span> body &#123;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(json) =&gt; json,</span><br><span class="line">    <span class="title function_ invoke__">Err</span>(err) =&gt; <span class="keyword">return</span> <span class="title function_ invoke__">Err</span>(err),</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> <span class="variable">date</span> = json[<span class="string">&quot;years&quot;</span>].<span class="title function_ invoke__">to_string</span>();</span><br><span class="line"></span><br><span class="line">  <span class="title function_ invoke__">Ok</span>(date)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å—åœ¨<code>get_current_date</code>ä¸­æœ‰ä¸¤ä¸ªå‡½æ•°è°ƒç”¨(getå’Œjson)ä¼šè¿”å›Resultå€¼ã€‚å› ä¸ºget_current_dateå¹¶æ²¡æœ‰è¿”å›é”™è¯¯æ—¶è¦åšä»€ä¹ˆçš„ä¸Šä¸‹æ–‡ï¼Œæ‰€ä»¥ä½¿ç”¨æ¨¡å¼åŒ¹é…å°†é”™è¯¯ä¼ å›main.</p><p>æœ‰æ—¶å€™åœ¨ä½¿ç”¨æ¨¡å¼åŒ¹é…å»å¤„ç†ï¼Œå¤šä¸ªåµŒå¥—çš„é”™è¯¯å¤„ç†å¯èƒ½ä¼šè®©ä»£ç çœ‹èµ·æ¥éå¸¸æ··ä¹±ï¼Œæ‰€ä»¥å¯ä»¥å¼•å…¥<code>?</code>æ¥é‡å†™ä¸Šè¿°ä»£ç .</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::collections::HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">  <span class="keyword">match</span> <span class="title function_ invoke__">get_current_date</span>() &#123;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(date) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;We&#x27;ve time travelled to &#123;&#125;!!&quot;</span>, date),</span><br><span class="line">    <span class="title function_ invoke__">Err</span>(e) =&gt; <span class="built_in">eprintln!</span>(<span class="string">&quot;Oh noes, we don&#x27;t know which era we&#x27;re in! :( \n  &#123;&#125;&quot;</span>, e),</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">get_current_date</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">String</span>, reqwest::Error&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">url</span> = <span class="string">&quot;https://postman-echo.com/time/object&quot;</span>;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">res</span> = reqwest::blocking::<span class="title function_ invoke__">get</span>(url)?.json::&lt;HashMap&lt;<span class="type">String</span>, <span class="type">i32</span>&gt;&gt;()?;</span><br><span class="line">  <span class="keyword">let</span> <span class="variable">date</span> = res[<span class="string">&quot;years&quot;</span>].<span class="title function_ invoke__">to_string</span>();</span><br><span class="line"></span><br><span class="line">  <span class="title function_ invoke__">Ok</span>(date)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™çœ‹èµ·æ¥ç®€æ´æ˜äº†ã€‚å…¶ä¸­<code>?</code>æ“ä½œç¬¦ç±»ä¼¼äº<code>unwrap</code>ä½†æ˜¯åœ¨é‡åˆ°Erroræ—¶å¹¶ä¸ä¼šäº§ç”Ÿ<code>panic</code>ï¼Œè€Œæ˜¯ä¼šå°†é”™è¯¯è¿”å›ç»™è°ƒç”¨è€…å‡½æ•°ã€‚éœ€è¦è®°ä½çš„ä¸€ä»¶äº‹æƒ…æ˜¯åªæœ‰åœ¨å‡½æ•°è¿”å›<code>Option</code>å’Œ<code>Result</code>ç±»å‹æ—¶æ‰èƒ½ä½¿ç”¨<code>?</code>æ“ä½œç¬¦ã€‚</p><p><a href="https://blog.csdn.net/qq_45983373/article/details/133816439">Rustè¯­è¨€ä¸­Optionå’ŒResultä¸¤ç§ç±»å‹çš„ä½¿ç”¨_rust option result-CSDNåšå®¢</a></p><p><strong>æ³¨æ„Optionå’ŒResultï¼š</strong></p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="keyword">enum</span> <span class="title class_">Option</span>&lt;T&gt; &#123;</span><br><span class="line">    <span class="literal">None</span>,</span><br><span class="line">    <span class="title function_ invoke__">Some</span>(T),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">enum</span> <span class="title class_">Result</span>&lt;T, E&gt; &#123;</span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(T),</span><br><span class="line">    <span class="title function_ invoke__">Err</span>(E),</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…¶ä¸­Optionæ›´å¤šç”¨äºä¸€ä¸ªè¿”å›å€¼ä¸ç¡®å®šæ˜¯å¦å­˜åœ¨çš„æƒ…å†µä¸‹ï¼ˆå¯ä»¥ç†è§£ä¸ºå…¶ä»–è¯­è¨€ä¸­çš„NULLï¼‰ã€‚</p><p>è€ŒResultæ›´å¤šç”¨äºä¼šå‡ºç°é”™è¯¯è¿›è¡Œæ•æ‰çš„åœºæ™¯ã€‚</p><p>æ‰€ä»¥ä¼šçœ‹åˆ°å¾ˆå¤šå‡½æ•°åé¢çš„è¿”å›å€¼(å¯ä»¥returnï¼Œä¹Ÿå¯ä»¥ç›´æ¥None&#x2F;Some&#x2F;Ok&#x2F;Err)æ˜¯è¿™æ ·çš„ï¼Œç»™å‡ºå„è‡ªçš„ä¾‹å­ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä½¿ç”¨Optionå¤„ç†å¯èƒ½å­˜åœ¨æˆ–ä¸å­˜åœ¨çš„å€¼</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">find_element_index</span>(arr: &amp;[<span class="type">i32</span>], target: <span class="type">i32</span>) <span class="punctuation">-&gt;</span> <span class="type">Option</span>&lt;<span class="type">usize</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">for</span> (index, &amp;value) <span class="keyword">in</span> arr.<span class="title function_ invoke__">iter</span>().<span class="title function_ invoke__">enumerate</span>() &#123;</span><br><span class="line">        <span class="keyword">if</span> value == target &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_ invoke__">Some</span>(index);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="literal">None</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨Resultå¤„ç†å¯èƒ½çš„é”™è¯¯æƒ…å†µ</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">divide</span>(a: <span class="type">i32</span>, b: <span class="type">i32</span>) <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">i32</span>, &amp;<span class="symbol">&#x27;static</span> <span class="type">str</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">Err</span>(<span class="string">&quot;Cannot divide by zero&quot;</span>) <span class="comment">//è¿™é‡Œä¼šè¿”å›Resultä¸­çš„Errï¼Œå†…å®¹æ˜¯è¿™ä¸ªå­—ç¬¦ä¸²å­—é¢é‡</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(a / b) <span class="comment">//è¿™é‡Œä¼šè¿”å›Resultä¸­çš„Okï¼Œå†…å®¹å°±æ˜¯å®é™…é™¤æ³•å¾—åˆ°çš„ç»“æœ</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*è¿™é‡Œ &amp;&#x27;static str è¡¨ç¤ºé”™è¯¯ä¿¡æ¯æ˜¯ä¸€ä¸ªæŒ‡å‘ç¨‹åºç”Ÿå‘½å‘¨æœŸä¸ºæ•´ä¸ªç¨‹åºçš„å­—ç¬¦ä¸²å­—é¢é‡çš„å¼•ç”¨ã€‚ä½¿ç”¨ &amp;&#x27;static str è€Œä¸æ˜¯ String å¯ä»¥é¿å…åœ¨å †ä¸Šåˆ†é…å†…å­˜ï¼Œä»è€Œæé«˜æ•ˆç‡ã€‚</span></span><br><span class="line"><span class="comment">&amp;&#x27;static str è¡¨ç¤ºä¸€ä¸ªæŒ‡å‘å­—ç¬¦ä¸²å­—é¢é‡çš„å¼•ç”¨ï¼Œå…¶ç”Ÿå‘½å‘¨æœŸæ˜¯ &#x27;staticã€‚è¿™æ„å‘³ç€è¿™ä¸ªå­—ç¬¦ä¸²å­—é¢é‡åœ¨ç¨‹åºçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…éƒ½æ˜¯æœ‰æ•ˆçš„ã€‚</span></span><br><span class="line"><span class="comment">ä¸ºä»€ä¹ˆä½¿ç”¨ &#x27;static ç”Ÿå‘½å‘¨æœŸï¼Ÿ</span></span><br><span class="line"><span class="comment">é¿å…åŠ¨æ€å†…å­˜åˆ†é…ï¼šå­—ç¬¦ä¸²å­—é¢é‡å­˜å‚¨åœ¨ç¨‹åºçš„åªè¯»æ•°æ®æ®µä¸­ï¼Œä½¿ç”¨ &#x27;static ç”Ÿå‘½å‘¨æœŸå¯ä»¥é¿å…åœ¨å †ä¸Šä¸ºé”™è¯¯æ¶ˆæ¯åˆ†é…é¢å¤–çš„å†…å­˜ã€‚è¿™åœ¨å¤„ç†å¤§é‡é”™è¯¯æ—¶å°¤å…¶é‡è¦ï¼Œå› ä¸ºå®ƒå¯ä»¥å‡å°‘å†…å­˜æ¶ˆè€—ã€‚</span></span><br><span class="line"><span class="comment">ç®€åŒ–é”™è¯¯å¤„ç†ï¼šä½¿ç”¨é™æ€å­—ç¬¦ä¸²å¯ä»¥ç®€åŒ–é”™è¯¯å¤„ç†é€»è¾‘ï¼Œå› ä¸ºç¼–è¯‘å™¨å¯ä»¥ä¿è¯è¿™äº›å­—ç¬¦ä¸²åœ¨æ•´ä¸ªç¨‹åºç”Ÿå‘½å‘¨æœŸå†…éƒ½æ˜¯æœ‰æ•ˆçš„ï¼Œæ— éœ€æ‹…å¿ƒç”Ÿå‘½å‘¨æœŸé—®é¢˜ã€‚*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">numbers</span> = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä½¿ç”¨Option</span></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">index</span> = <span class="title function_ invoke__">find_element_index</span>(&amp;numbers, <span class="number">3</span>);</span><br><span class="line">    <span class="keyword">match</span> index &#123;</span><br><span class="line">        <span class="title function_ invoke__">Some</span>(i) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Element found at index: &#123;&#125;&quot;</span>, i),</span><br><span class="line">        <span class="literal">None</span> =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Element not found&quot;</span>),</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨Result</span></span><br><span class="line">    <span class="keyword">match</span> <span class="title function_ invoke__">divide</span>(<span class="number">10</span>, <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="title function_ invoke__">Ok</span>(result) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Result of division: &#123;&#125;&quot;</span>, result),</span><br><span class="line">        <span class="title function_ invoke__">Err</span>(error) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Error: &#123;&#125;&quot;</span>, error),</span><br><span class="line">    &#125;</span><br><span class="line"><span class="title function_ invoke__">divide</span>(<span class="number">10</span>,<span class="number">2</span>).<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line"><span class="title function_ invoke__">divide</span>(<span class="number">10</span>,<span class="number">2</span>).<span class="title function_ invoke__">expect</span>(<span class="string">&quot;defined by yourself&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¼ é€’å¤šä¸ªé”™è¯¯ç»™è°ƒç”¨è€…"><a href="#ä¼ é€’å¤šä¸ªé”™è¯¯ç»™è°ƒç”¨è€…" class="headerlink" title="ä¼ é€’å¤šä¸ªé”™è¯¯ç»™è°ƒç”¨è€…"></a><strong>ä¼ é€’å¤šä¸ªé”™è¯¯ç»™è°ƒç”¨è€…</strong></h2><p>åœ¨ä¹‹å‰çš„ä¾‹å­ä¸­ï¼Œ<code>get</code>å’Œ<code>json</code>å‡½æ•°è¿”å›äº†ä¸€ä¸ª<code>reqwest::Error</code>é”™è¯¯ã€‚ä½†æ˜¯å¦‚æœå·²ç»æœ‰äº†ä¸€ä¸ªåœ¨è°ƒç”¨å…¶ä»–çš„å‡½æ•°æ—¶è¿”å›çš„é”™è¯¯ç±»å‹ï¼Œé‚£ä¹ˆåº”è¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ</p><p>è®©é€šè¿‡è¿”å›æ ¼å¼åŒ–çš„æ—¥æœŸè€Œä¸æ˜¯å¹´ä»½æ¥æ‰©å±•ä¸Šä¸€ä¸ªç¤ºä¾‹ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">+ <span class="keyword">use</span> chrono::NaiveDate;</span><br><span class="line">  <span class="keyword">use</span> std::collections::HashMap;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">match</span> <span class="title function_ invoke__">get_current_date</span>() &#123;</span><br><span class="line">      <span class="title function_ invoke__">Ok</span>(date) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;We&#x27;ve time travelled to &#123;&#125;!!&quot;</span>, date),</span><br><span class="line">      <span class="title function_ invoke__">Err</span>(e) =&gt; <span class="built_in">eprintln!</span>(<span class="string">&quot;Oh noes, we don&#x27;t know which era we&#x27;re in! :( \n  &#123;&#125;&quot;</span>, e),</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">get_current_date</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">String</span>, reqwest::Error&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">url</span> = <span class="string">&quot;https://postman-echo.com/time/object&quot;</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">res</span> = reqwest::blocking::<span class="title function_ invoke__">get</span>(url)?.json::&lt;HashMap&lt;<span class="type">String</span>, <span class="type">i32</span>&gt;&gt;()?;</span><br><span class="line">-   <span class="keyword">let</span> <span class="variable">date</span> = res[<span class="string">&quot;years&quot;</span>].<span class="title function_ invoke__">to_string</span>();</span><br><span class="line">+   <span class="keyword">let</span> <span class="variable">formatted_date</span> = <span class="built_in">format!</span>(<span class="string">&quot;&#123;&#125;-&#123;&#125;-&#123;&#125;&quot;</span>, res[<span class="string">&quot;years&quot;</span>], res[<span class="string">&quot;months&quot;</span>] + <span class="number">1</span>, res[<span class="string">&quot;date&quot;</span>]);</span><br><span class="line">+   <span class="keyword">let</span> <span class="variable">parsed_date</span> = NaiveDate::<span class="title function_ invoke__">parse_from_str</span>(formatted_date.<span class="title function_ invoke__">as_str</span>(), <span class="string">&quot;%Y-%m-%d&quot;</span>)?;</span><br><span class="line">+   <span class="keyword">let</span> <span class="variable">date</span> = parsed_date.format(<span class="string">&quot;%Y %B %d&quot;</span>).<span class="title function_ invoke__">to_string</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(date)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°çš„ä»£ç æ˜¯ä¸èƒ½ç¼–è¯‘çš„ï¼Œç”±äºparse_from_strè¿”å›äº†ä¸€ä¸ª<code>chrono::format::ParseError</code>é”™è¯¯è€Œä¸æ˜¯<code>reqwest::Error</code></p><p>å¯ä»¥ä½¿ç”¨<code>Box</code>å…³é”®å­—æ¥è§£å†³è¿™ä¸ªé—®é¢˜</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">use</span> chrono::NaiveDate;</span><br><span class="line">  <span class="keyword">use</span> std::collections::HashMap;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">match</span> <span class="title function_ invoke__">get_current_date</span>() &#123;</span><br><span class="line">      <span class="title function_ invoke__">Ok</span>(date) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;We&#x27;ve time travelled to &#123;&#125;!!&quot;</span>, date),</span><br><span class="line">      <span class="title function_ invoke__">Err</span>(e) =&gt; <span class="built_in">eprintln!</span>(<span class="string">&quot;Oh noes, we don&#x27;t know which era we&#x27;re in! :( \n  &#123;&#125;&quot;</span>, e),</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">- <span class="keyword">fn</span> <span class="title function_">get_current_date</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">String</span>, reqwest::Error&gt; &#123;</span><br><span class="line">+ <span class="keyword">fn</span> <span class="title function_">get_current_date</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">String</span>, <span class="type">Box</span>&lt;<span class="keyword">dyn</span> std::error::Error&gt;&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">url</span> = <span class="string">&quot;https://postman-echo.com/time/object&quot;</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">res</span> = reqwest::blocking::<span class="title function_ invoke__">get</span>(url)?.json::&lt;HashMap&lt;<span class="type">String</span>, <span class="type">i32</span>&gt;&gt;()?;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">formatted_date</span> = <span class="built_in">format!</span>(<span class="string">&quot;&#123;&#125;-&#123;&#125;-&#123;&#125;&quot;</span>, res[<span class="string">&quot;years&quot;</span>], res[<span class="string">&quot;months&quot;</span>] + <span class="number">1</span>, res[<span class="string">&quot;date&quot;</span>]);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">parsed_date</span> = NaiveDate::<span class="title function_ invoke__">parse_from_str</span>(formatted_date.<span class="title function_ invoke__">as_str</span>(), <span class="string">&quot;%Y-%m-%d&quot;</span>)?;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">date</span> = parsed_date.format(<span class="string">&quot;%Y %B %d&quot;</span>).<span class="title function_ invoke__">to_string</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(date)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>å½“æƒ³è¦å‘è¿”å›å¤šä¸ªä¸åŒçš„é”™è¯¯æ—¶ï¼Œè¿”å›ä¸€ä¸ªç‰¹å¾å¯¹è±¡ <code>Box&lt;dyn std::error::Error&gt;</code>æ˜¯ä¸€ç§ä¾¿åˆ©çš„å¤„ç†æ–¹æ³•ã€‚</p><p>äº†è§£æ›´å¤šå…³äºï¼š <code>anyhow</code>, <code>eyre</code></p><h2 id="æ¨¡å¼åŒ¹é…Boxedé”™è¯¯"><a href="#æ¨¡å¼åŒ¹é…Boxedé”™è¯¯" class="headerlink" title="æ¨¡å¼åŒ¹é…Boxedé”™è¯¯"></a><strong>æ¨¡å¼åŒ¹é…Boxedé”™è¯¯</strong></h2><p>ç›®å‰ä¸ºæ­¢ï¼Œåªåœ¨mainä¸­æ‰“å°é”™è¯¯ï¼Œè€Œä¸æ˜¯çœŸæ­£åœ°å»å¤„ç†å®ƒä»¬ã€‚å¦‚æœæƒ³å¤„ç†å’Œæ¢å¤Boxé”™è¯¯ï¼Œéœ€è¦â€œdowncastâ€å®ƒä»¬ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">use</span> chrono::NaiveDate;</span><br><span class="line">  <span class="keyword">use</span> std::collections::HashMap;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">match</span> <span class="title function_ invoke__">get_current_date</span>() &#123;</span><br><span class="line">      <span class="title function_ invoke__">Ok</span>(date) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;We&#x27;ve time travelled to &#123;&#125;!!&quot;</span>, date),</span><br><span class="line">-     <span class="title function_ invoke__">Err</span>(e) =&gt; <span class="built_in">eprintln!</span>(<span class="string">&quot;Oh noes, we don&#x27;t know which era we&#x27;re in! :( \n  &#123;&#125;&quot;</span>, e),</span><br><span class="line">+     <span class="title function_ invoke__">Err</span>(e) =&gt; &#123;</span><br><span class="line">+       <span class="built_in">eprintln!</span>(<span class="string">&quot;Oh noes, we don&#x27;t know which era we&#x27;re in! :(&quot;</span>);</span><br><span class="line">+       <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(err) = e.downcast_ref::&lt;reqwest::Error&gt;() &#123;</span><br><span class="line">+         <span class="built_in">eprintln!</span>(<span class="string">&quot;Request Error: &#123;&#125;&quot;</span>, err)</span><br><span class="line">+       &#125; <span class="keyword">else</span> <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(err) = e.downcast_ref::&lt;chrono::format::ParseError&gt;() &#123;</span><br><span class="line">+         <span class="built_in">eprintln!</span>(<span class="string">&quot;Parse Error: &#123;&#125;&quot;</span>, err)</span><br><span class="line">+       &#125;</span><br><span class="line">+     &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">get_current_date</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">String</span>, <span class="type">Box</span>&lt;<span class="keyword">dyn</span> std::error::Error&gt;&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">url</span> = <span class="string">&quot;https://postman-echo.com/time/object&quot;</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">res</span> = reqwest::blocking::<span class="title function_ invoke__">get</span>(url)?.json::&lt;HashMap&lt;<span class="type">String</span>, <span class="type">i32</span>&gt;&gt;()?;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">formatted_date</span> = <span class="built_in">format!</span>(<span class="string">&quot;&#123;&#125;-&#123;&#125;-&#123;&#125;&quot;</span>, res[<span class="string">&quot;years&quot;</span>], res[<span class="string">&quot;months&quot;</span>] + <span class="number">1</span>, res[<span class="string">&quot;date&quot;</span>]);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">parsed_date</span> = NaiveDate::<span class="title function_ invoke__">parse_from_str</span>(formatted_date.<span class="title function_ invoke__">as_str</span>(), <span class="string">&quot;%Y-%m-%d&quot;</span>)?;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">date</span> = parsed_date.format(<span class="string">&quot;%Y %B %d&quot;</span>).<span class="title function_ invoke__">to_string</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(date)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¿…é¡»çŸ¥é“get_current_dateçš„å®ç°ç»†èŠ‚ï¼ˆå…¶ä¸­åŒ…å«çš„ä¸åŒé”™è¯¯ï¼‰ï¼Œæ‰èƒ½å¤Ÿåœ¨mainä¸­å¯¹å…¶è¿›è¡Œdowncastã€‚</p><p>äº†è§£æ›´å¤šå…³äº: <code>downcast</code>, <code>downcast_mut</code></p><h2 id="åº“-vs-åº”ç”¨"><a href="#åº“-vs-åº”ç”¨" class="headerlink" title="åº“ vs åº”ç”¨"></a><strong>åº“ vs åº”ç”¨</strong></h2><p>å¦‚å‰é¢æ‰€è¿°ï¼Œä½¿ç”¨Boxå¸¦æ¥çš„é—®é¢˜æ˜¯ï¼šå¦‚æœæƒ³è¦å¤„ç†åº•å±‚é”™è¯¯ï¼Œå¿…é¡»äº†è§£å‡½æ•°çš„å®ç°ç»†èŠ‚ã€‚å½“ä»¥<code>Box&lt; dyn std::error::Error&gt;</code>å½¢å¼è¿”å›æŸä¸ªå†…å®¹æ—¶ï¼Œå…·ä½“çš„ç±»å‹ä¿¡æ¯å°†ä¼šä¸¢å¤±ã€‚ä¸ºäº†ä»¥ä¸åŒæ–¹å¼å¤„ç†ä¸åŒçš„é”™è¯¯ï¼Œéœ€è¦å°†å®ƒä»¬å‘ä¸‹è½¬æ¢ä¸ºæŸä¸ªå…·ä½“ç±»å‹ï¼Œè¿™ç§è½¬æ¢å¯èƒ½ä¼šåœ¨è¿è¡Œæ—¶å¤±è´¥ã€‚</p><p>ç„¶è€Œï¼Œè„±ç¦»ä¸Šä¸‹æ–‡ï¼Œè°ˆè®ºå¥½åå¹¶ä¸æ˜¯å¾ˆæœ‰ç”¨ã€‚ä¸€ä¸ªå¾ˆå¥½çš„ç»éªŒæ³•åˆ™æ˜¯æ€è€ƒå½“å‰æ­£åœ¨ç¼–å†™çš„ä»£ç æ˜¯ä¸€ä¸ªâ€œApplicationâ€è¿˜æ˜¯â€œLibraryâ€ï¼š</p><h3 id="Applicationåº”ç”¨"><a href="#Applicationåº”ç”¨" class="headerlink" title="Applicationåº”ç”¨"></a><strong>Applicationåº”ç”¨</strong></h3><ul><li>æ‚¨æ­£åœ¨ç¼–å†™çš„ä»£ç å°†ç”±æœ€ç»ˆç”¨æˆ·ä½¿ç”¨ã€‚</li><li>å¤§å¤šæ•°ç”±åº”ç”¨ç¨‹åºä»£ç ç”Ÿæˆçš„é”™è¯¯ä¸ä¼šè¢«å¤„ç†ï¼Œè€Œæ˜¯è®°å½•æˆ–æŠ¥å‘Šç»™ç”¨æˆ·ã€‚</li><li>å¯ä»¥ä½¿ç”¨boxé”™è¯¯ã€‚</li></ul><h3 id="Libraryåº“"><a href="#Libraryåº“" class="headerlink" title="Libraryåº“"></a><strong>Libraryåº“</strong></h3><ul><li>æ‚¨æ­£åœ¨ç¼–å†™çš„ä»£ç å°†è¢«å…¶ä»–ä»£ç ä½¿ç”¨ã€‚ä¸€ä¸ªâ€œåº“â€å¯ä»¥æ˜¯å¼€æºcrateï¼Œå†…éƒ¨libraryç­‰ã€‚</li><li>é”™è¯¯æ˜¯åº“çš„APIçš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤åº“çš„ä½¿ç”¨è€…çŸ¥é“åº”è¯¥æœŸæœ›å¹¶ä»ä¸­æ¢å¤å“ªäº›é”™è¯¯ã€‚</li><li>åº“ä¸­çš„é”™è¯¯é€šå¸¸ç”±ç”¨æˆ·å¤„ç†ï¼Œå› æ­¤å®ƒä»¬éœ€è¦ç»“æ„åŒ–ä¸”æ˜“äºæ‰§è¡Œ<a href="%5Bhttps://doc.rust-lang.org/1.30.0/book/2018-edition/ch06-02-match.html#matches-are-exhaustive%5D(https://link.zhihu.com/?target=https://doc.rust-lang.org/1.30.0/book/2018-edition/ch06-02-match.html#matches-are-exhaustive)">exhaustive match</a></li><li>å¦‚æœæ‚¨è¿”å›Boxé”™è¯¯ï¼Œé‚£ä¹ˆåº“çš„ä½¿ç”¨è€…éœ€è¦çŸ¥é“ç”±ä»£ç ã€ä¾èµ–é¡¹ç­‰åˆ›å»ºçš„é”™è¯¯ç±»å‹ï¼</li><li>å¯ä»¥è¿”å›è‡ªå®šä¹‰é”™è¯¯ï¼Œè€Œä¸æ˜¯Boxé”™è¯¯ã€‚</li></ul><h2 id="åˆ›å»ºè‡ªå®šä¹‰é”™è¯¯"><a href="#åˆ›å»ºè‡ªå®šä¹‰é”™è¯¯" class="headerlink" title="åˆ›å»ºè‡ªå®šä¹‰é”™è¯¯"></a><strong>åˆ›å»ºè‡ªå®šä¹‰é”™è¯¯</strong></h2><p>å¯¹äºlibraryä»£ç ï¼Œå¯ä»¥å°†æ‰€æœ‰é”™è¯¯è½¬æ¢ä¸ºè‡ªå®šä¹‰çš„é”™è¯¯ç±»å‹ï¼Œå¹¶è¿”å›å®ƒï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç‰¹å¾å¯¹è±¡<code>box</code>ã€‚åœ¨çš„ä¾‹å­ä¸­ï¼Œç›®å‰ç”±ä¸¤ä¸ªé”™è¯¯<code>reqwest::Error</code>å’Œ<code>chrono::format::ParseError</code>ã€‚å¯ä»¥å°†å®ƒä»¬åˆ†åˆ«è½¬æ¢ä¸º<code>MyCustomError::HttpError</code>å’Œ<code>MyCustomError::ParseError</code></p><p>é¦–å…ˆè¦åˆ›å»ºä¸€ä¸ªenumæ¥è£…çš„ä¸¤ä¸ªé”™è¯¯å˜é‡</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// error.rs</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">enum</span> <span class="title class_">MyCustomError</span> &#123;</span><br><span class="line">  HttpError,</span><br><span class="line">  ParseError,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Error</code>traitè§„å®šå®ç°å¿…é¡»<code>Debug</code>å’Œ<code>Display</code> traits:</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// error.rs</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> std::fmt;</span><br><span class="line"></span><br><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">enum</span> <span class="title class_">MyCustomError</span> &#123;</span><br><span class="line">  HttpError,</span><br><span class="line">  ParseError,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">std</span>::error::Error <span class="keyword">for</span> <span class="title class_">MyCustomError</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">fmt</span>::Display <span class="keyword">for</span> <span class="title class_">MyCustomError</span> &#123;</span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">fmt</span>(&amp;<span class="keyword">self</span>, f: &amp;<span class="keyword">mut</span> fmt::Formatter) <span class="punctuation">-&gt;</span> fmt::<span class="type">Result</span> &#123;</span><br><span class="line">    <span class="keyword">match</span> <span class="keyword">self</span> &#123;</span><br><span class="line">      MyCustomError::HttpError =&gt; <span class="built_in">write!</span>(f, <span class="string">&quot;HTTP Error&quot;</span>),</span><br><span class="line">      MyCustomError::ParseError =&gt; <span class="built_in">write!</span>(f, <span class="string">&quot;Parse Error&quot;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°±è¿™æ ·åˆ›å»ºçš„è‡ªå®šä¹‰é”™è¯¯ç±»å‹ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ä¾‹å­ï¼Œä½†æ˜¯æ²¡æœ‰åŒ…å«å¤ªå¤šå…³äºé”™è¯¯çš„ä¿¡æ¯ã€‚ä½†è¿™åº”è¯¥è¶³ä»¥ä½œä¸ºåˆ›å»ºæ›´å¤æ‚ã€æ›´ç°å®çš„è‡ªå®šä¹‰é”™è¯¯çš„èµ·ç‚¹ã€‚ä¸‹é¢æ˜¯ä¸€äº›å¸¸è§å¼€å‘ä¸­çš„è‡ªå®šä¹‰é”™è¯¯å¤„ç†çš„ä¾‹å­:<a href="https://link.zhihu.com/?target=https://github.com/BurntSushi/ripgrep/blob/12.1.1/crates/regex/src/error.rs">ripgrep</a>, <a href="https://link.zhihu.com/?target=https://github.com/seanmonstar/reqwest/blob/v0.10.7/src/error.rs">reqwest</a>, <a href="https://link.zhihu.com/?target=https://github.com/BurntSushi/rust-csv/blob/master/src/error.rs">csv</a> and <a href="https://link.zhihu.com/?target=https://github.com/serde-rs/json/blob/master/src/error.rs">serde_json</a></p><p>è¿˜æœ‰: <code>thiserror</code>, <code>snafu</code></p><h2 id="ä¼ é€’è‡ªå®šä¹‰é”™è¯¯"><a href="#ä¼ é€’è‡ªå®šä¹‰é”™è¯¯" class="headerlink" title="ä¼ é€’è‡ªå®šä¹‰é”™è¯¯"></a><strong>ä¼ é€’è‡ªå®šä¹‰é”™è¯¯</strong></h2><p>çœ‹çœ‹ä½¿ç”¨è‡ªå®šä¹‰é”™è¯¯ç±»å‹åå¯¹äºä¹‹å‰ç¨‹åºçš„ä¿®æ”¹</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">// main.rs</span></span><br><span class="line"></span><br><span class="line">+ <span class="keyword">mod</span> error;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">use</span> chrono::NaiveDate;</span><br><span class="line">+ <span class="keyword">use</span> error::MyCustomError;</span><br><span class="line">  <span class="keyword">use</span> std::collections::HashMap;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="comment">// skipped, will get back later</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">- <span class="keyword">fn</span> <span class="title function_">get_current_date</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">String</span>, <span class="type">Box</span>&lt;<span class="keyword">dyn</span> std::error::Error&gt;&gt; &#123;</span><br><span class="line">+ <span class="keyword">fn</span> <span class="title function_">get_current_date</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">String</span>, MyCustomError&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">url</span> = <span class="string">&quot;https://postman-echo.com/time/object&quot;</span>;</span><br><span class="line">-   <span class="keyword">let</span> <span class="variable">res</span> = reqwest::blocking::<span class="title function_ invoke__">get</span>(url)?.json::&lt;HashMap&lt;<span class="type">String</span>, <span class="type">i32</span>&gt;&gt;()?;</span><br><span class="line">+   <span class="keyword">let</span> <span class="variable">res</span> = reqwest::blocking::<span class="title function_ invoke__">get</span>(url)</span><br><span class="line">+     .<span class="title function_ invoke__">map_err</span>(|_| MyCustomError::HttpError)?</span><br><span class="line">+     .json::&lt;HashMap&lt;<span class="type">String</span>, <span class="type">i32</span>&gt;&gt;()</span><br><span class="line">+     .<span class="title function_ invoke__">map_err</span>(|_| MyCustomError::HttpError)?;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">formatted_date</span> = <span class="built_in">format!</span>(<span class="string">&quot;&#123;&#125;-&#123;&#125;-&#123;&#125;&quot;</span>, res[<span class="string">&quot;years&quot;</span>], res[<span class="string">&quot;months&quot;</span>] + <span class="number">1</span>, res[<span class="string">&quot;date&quot;</span>]);</span><br><span class="line">-   <span class="keyword">let</span> <span class="variable">parsed_date</span> = NaiveDate::<span class="title function_ invoke__">parse_from_str</span>(formatted_date.<span class="title function_ invoke__">as_str</span>(), <span class="string">&quot;%Y-%m-%d&quot;</span>)?;</span><br><span class="line">+   <span class="keyword">let</span> <span class="variable">parsed_date</span> = NaiveDate::<span class="title function_ invoke__">parse_from_str</span>(formatted_date.<span class="title function_ invoke__">as_str</span>(), <span class="string">&quot;%Y-%m-%d&quot;</span>)</span><br><span class="line">+     .<span class="title function_ invoke__">map_err</span>(|_| MyCustomError::ParseError)?;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">date</span> = parsed_date.format(<span class="string">&quot;%Y %B %d&quot;</span>).<span class="title function_ invoke__">to_string</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(date)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„åˆ°ä½¿ç”¨äº†<code>map_err</code>å°†ä¸€ä¸ªé”™è¯¯ç±»å‹è½¬æ¢ä¸ºå¦å¤–çš„é”™è¯¯ç±»å‹.</p><p>ä½†æ˜¯å¯ä»¥çœ‹åˆ°å¤ªå¤šçš„verboseä½œä¸ºç»“æœï¼Œçš„å‡½æ•°å……æ–¥ç€å¤ªå¤š<code>map_err</code>è°ƒç”¨ã€‚å¯ä»¥å®ç°<code>From</code> traitï¼Œè¿™æ ·å°±ä¼šå®Œæˆè‡ªåŠ¨é”™è¯¯ç±»å‹è½¬æ¢ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">// error.rs</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">use</span> std::fmt;</span><br><span class="line"></span><br><span class="line">  <span class="meta">#[derive(Debug)]</span></span><br><span class="line">  <span class="keyword">pub</span> <span class="keyword">enum</span> <span class="title class_">MyCustomError</span> &#123;</span><br><span class="line">    HttpError,</span><br><span class="line">    ParseError,</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">impl</span> <span class="title class_">std</span>::error::Error <span class="keyword">for</span> <span class="title class_">MyCustomError</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">impl</span> <span class="title class_">fmt</span>::Display <span class="keyword">for</span> <span class="title class_">MyCustomError</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">fmt</span>(&amp;<span class="keyword">self</span>, f: &amp;<span class="keyword">mut</span> fmt::Formatter) <span class="punctuation">-&gt;</span> fmt::<span class="type">Result</span> &#123;</span><br><span class="line">      <span class="keyword">match</span> <span class="keyword">self</span> &#123;</span><br><span class="line">        MyCustomError::HttpError =&gt; <span class="built_in">write!</span>(f, <span class="string">&quot;HTTP Error&quot;</span>),</span><br><span class="line">        MyCustomError::ParseError =&gt; <span class="built_in">write!</span>(f, <span class="string">&quot;Parse Error&quot;</span>),</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">+ <span class="keyword">impl</span> <span class="title class_">From</span>&lt;reqwest::Error&gt; <span class="keyword">for</span> <span class="title class_">MyCustomError</span> &#123;</span><br><span class="line">+   <span class="keyword">fn</span> <span class="title function_">from</span>(_: reqwest::Error) <span class="punctuation">-&gt;</span> <span class="keyword">Self</span> &#123;</span><br><span class="line">+     MyCustomError::HttpError</span><br><span class="line">+   &#125;</span><br><span class="line">+ &#125;</span><br><span class="line"></span><br><span class="line">+ <span class="keyword">impl</span> <span class="title class_">From</span>&lt;chrono::format::ParseError&gt; <span class="keyword">for</span> <span class="title class_">MyCustomError</span> &#123;</span><br><span class="line">+   <span class="keyword">fn</span> <span class="title function_">from</span>(_: chrono::format::ParseError) <span class="punctuation">-&gt;</span> <span class="keyword">Self</span> &#123;</span><br><span class="line">+     MyCustomError::ParseError</span><br><span class="line">+   &#125;</span><br><span class="line">+ &#125;</span><br><span class="line"> <span class="comment">// main.rs</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">mod</span> error;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">use</span> chrono::NaiveDate;</span><br><span class="line">  <span class="keyword">use</span> error::MyCustomError;</span><br><span class="line">  <span class="keyword">use</span> std::collections::HashMap;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="comment">// skipped, will get back later</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">get_current_date</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">String</span>, MyCustomError&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">url</span> = <span class="string">&quot;https://postman-echo.com/time/object&quot;</span>;</span><br><span class="line">-   <span class="keyword">let</span> <span class="variable">res</span> = reqwest::blocking::<span class="title function_ invoke__">get</span>(url)</span><br><span class="line">-     .<span class="title function_ invoke__">map_err</span>(|_| MyCustomError::HttpError)?</span><br><span class="line">-     .json::&lt;HashMap&lt;<span class="type">String</span>, <span class="type">i32</span>&gt;&gt;()</span><br><span class="line">-     .<span class="title function_ invoke__">map_err</span>(|_| MyCustomError::HttpError)?;</span><br><span class="line">+   <span class="keyword">let</span> <span class="variable">res</span> = reqwest::blocking::<span class="title function_ invoke__">get</span>(url)?.json::&lt;HashMap&lt;<span class="type">String</span>, <span class="type">i32</span>&gt;&gt;()?;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">formatted_date</span> = <span class="built_in">format!</span>(<span class="string">&quot;&#123;&#125;-&#123;&#125;-&#123;&#125;&quot;</span>, res[<span class="string">&quot;years&quot;</span>], res[<span class="string">&quot;months&quot;</span>] + <span class="number">1</span>, res[<span class="string">&quot;date&quot;</span>]);</span><br><span class="line">-   <span class="keyword">let</span> <span class="variable">parsed_date</span> = NaiveDate::<span class="title function_ invoke__">parse_from_str</span>(formatted_date.<span class="title function_ invoke__">as_str</span>(), <span class="string">&quot;%Y-%m-%d&quot;</span>)</span><br><span class="line">-     .<span class="title function_ invoke__">map_err</span>(|_| MyCustomError::ParseError)?;</span><br><span class="line">+   <span class="keyword">let</span> <span class="variable">parsed_date</span> = NaiveDate::<span class="title function_ invoke__">parse_from_str</span>(formatted_date.<span class="title function_ invoke__">as_str</span>(), <span class="string">&quot;%Y-%m-%d&quot;</span>)?;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">date</span> = parsed_date.format(<span class="string">&quot;%Y %B %d&quot;</span>).<span class="title function_ invoke__">to_string</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(date)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>åœ¨ç§»é™¤<code>map_err</code>åä»£ç å˜å¾—æ›´åŠ æ•´æ´äº†ã€‚</p><p>ç„¶è€Œ,<code>From</code>traitå¹¶ä¸æ˜¯ä¸€ç§èƒ½å‡å°‘ä½¿ç”¨<code>map_err</code>çš„é­”æ³•ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå°†ç±»å‹è½¬æ¢ä»<code>get_current_data</code>å‡½æ•°å†…éƒ¨ç§»åŠ¨åˆ°<code>From&lt;X&gt; for MyCustomError</code>å®ç°.é‚£ä¹ˆå¦‚æœä¸€ä¸ªé”™è¯¯æ²¡æœ‰åœ¨<code>MyCustomError</code>å‡ºç°è¿‡ï¼Œå°±ä¸èƒ½ä½¿ç”¨From traitï¼Œä»è€Œåªèƒ½ä½¿ç”¨<code>map_err</code></p><h2 id="æ¨¡å¼åŒ¹é…è‡ªå®šä¹‰é”™è¯¯"><a href="#æ¨¡å¼åŒ¹é…è‡ªå®šä¹‰é”™è¯¯" class="headerlink" title="æ¨¡å¼åŒ¹é…è‡ªå®šä¹‰é”™è¯¯"></a><strong>æ¨¡å¼åŒ¹é…è‡ªå®šä¹‰é”™è¯¯</strong></h2><p>ä¸€ç›´å¿½ç•¥äº†mainçš„å˜åŠ¨ï¼Œç°åœ¨è¦çœ‹çœ‹å¦‚ä½•å»å¤„ç†è‡ªå®šä¹‰é”™è¯¯ç±»å‹çš„æ¨¡å¼åŒ¹é…é—®é¢˜ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">// main.rs</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">mod</span> error;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">use</span> chrono::NaiveDate;</span><br><span class="line">  <span class="keyword">use</span> error::MyCustomError;</span><br><span class="line">  <span class="keyword">use</span> std::collections::HashMap;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">match</span> <span class="title function_ invoke__">get_current_date</span>() &#123;</span><br><span class="line">      <span class="title function_ invoke__">Ok</span>(date) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;We&#x27;ve time travelled to &#123;&#125;!!&quot;</span>, date),</span><br><span class="line">      <span class="title function_ invoke__">Err</span>(e) =&gt; &#123;</span><br><span class="line">        <span class="built_in">eprintln!</span>(<span class="string">&quot;Oh noes, we don&#x27;t know which era we&#x27;re in! :(&quot;</span>);</span><br><span class="line">-       <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(err) = e.downcast_ref::&lt;reqwest::Error&gt;() &#123;</span><br><span class="line">-         <span class="built_in">eprintln!</span>(<span class="string">&quot;Request Error: &#123;&#125;&quot;</span>, err)</span><br><span class="line">-       &#125; <span class="keyword">else</span> <span class="keyword">if</span> <span class="keyword">let</span> <span class="variable">Some</span>(err) = e.downcast_ref::&lt;chrono::format::ParseError&gt;() &#123;</span><br><span class="line">-         <span class="built_in">eprintln!</span>(<span class="string">&quot;Parse Error: &#123;&#125;&quot;</span>, err)</span><br><span class="line">-       &#125;</span><br><span class="line">+       <span class="keyword">match</span> e &#123;</span><br><span class="line">+         MyCustomError::HttpError =&gt; <span class="built_in">eprintln!</span>(<span class="string">&quot;Request Error: &#123;&#125;&quot;</span>, e),</span><br><span class="line">+         MyCustomError::ParseError =&gt; <span class="built_in">eprintln!</span>(<span class="string">&quot;Parse Error: &#123;&#125;&quot;</span>, e),</span><br><span class="line">+       &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">fn</span> <span class="title function_">get_current_date</span>() <span class="punctuation">-&gt;</span> <span class="type">Result</span>&lt;<span class="type">String</span>, MyCustomError&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">url</span> = <span class="string">&quot;https://postman-echo.com/time/object&quot;</span>;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">res</span> = reqwest::blocking::<span class="title function_ invoke__">get</span>(url)?.json::&lt;HashMap&lt;<span class="type">String</span>, <span class="type">i32</span>&gt;&gt;()?;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="variable">formatted_date</span> = <span class="built_in">format!</span>(<span class="string">&quot;&#123;&#125;-&#123;&#125;-&#123;&#125;&quot;</span>, res[<span class="string">&quot;years&quot;</span>], res[<span class="string">&quot;months&quot;</span>] + <span class="number">1</span>, res[<span class="string">&quot;date&quot;</span>]);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">parsed_date</span> = NaiveDate::<span class="title function_ invoke__">parse_from_str</span>(formatted_date.<span class="title function_ invoke__">as_str</span>(), <span class="string">&quot;%Y-%m-%d&quot;</span>)?;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">date</span> = parsed_date.format(<span class="string">&quot;%Y %B %d&quot;</span>).<span class="title function_ invoke__">to_string</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">Ok</span>(date)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>è¯·æ³¨æ„ï¼Œä¸Boxedé”™è¯¯ä¸åŒï¼Œå®é™…ä¸Šå¯ä»¥ç›´æ¥åŒ¹é…MyCustomError enumä¸­çš„å˜é‡ã€‚<a href="https://zhuanlan.zhihu.com/p/492292655"></a></p>]]></content>
      
      
      <categories>
          
          <category> Rust </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Rust </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rustæ„å»ºè‡ªå·±çš„ç¬¬ä¸€ä¸ªé¡¹ç›®</title>
      <link href="/2024/07/17/2024-07-17-Rust%E6%9E%84%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E9%A1%B9%E7%9B%AE/"/>
      <url>/2024/07/17/2024-07-17-Rust%E6%9E%84%E5%BB%BA%E8%87%AA%E5%B7%B1%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E9%A1%B9%E7%9B%AE/</url>
      
        <content type="html"><![CDATA[<h1 id="Rustæ„å»ºè‡ªå·±çš„ç¬¬ä¸€ä¸ªé¡¹ç›®"><a href="#Rustæ„å»ºè‡ªå·±çš„ç¬¬ä¸€ä¸ªé¡¹ç›®" class="headerlink" title="Rustæ„å»ºè‡ªå·±çš„ç¬¬ä¸€ä¸ªé¡¹ç›®"></a>Rustæ„å»ºè‡ªå·±çš„ç¬¬ä¸€ä¸ªé¡¹ç›®</h1><p>å‡ ä¸ªæ ¸å¿ƒå‘½ä»¤ï¼š</p><p>cargo new xxxï¼šç”¨äºæ–°å»ºé¡¹ç›®</p><p>cargo buildï¼šç”¨äºåœ¨Cargo.tomlä¸­æ·»åŠ dependenciesè¿›è¡Œä¾èµ–çš„ä¸‹è½½å’Œç¼–è¯‘</p><p>cargo runï¼šç”¨äºè¿è¡Œ</p><h2 id="æ–°å»ºé¡¹ç›®"><a href="#æ–°å»ºé¡¹ç›®" class="headerlink" title="æ–°å»ºé¡¹ç›®"></a>æ–°å»ºé¡¹ç›®</h2><p>åœ¨ç›®å½•ä¸‹è¾“å…¥ä¸‹åˆ—æŒ‡ä»¤ï¼Œä¾‹å¦‚è¦æ„å»ºä¸€ä¸ªå«åšhello-rustçš„é¡¹ç›®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo new hello-rust</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/07/17/EBDu3SwHjL1neC7.png" alt="image-20240717224533358.png"></p><p><code>Cargo</code> å·²ç»å¸®æˆ‘ä»¬åˆ›å»ºå¥½é»˜è®¤é¡¹ç›®äº†ï¼Œè¿˜åˆ›å»ºäº†ä¸ªgitçš„æœ¬åœ°ä»“åº“ï¼Œè¿˜æœ‰ä¸€äº›é…ç½®æ–‡ä»¶ï¼Œ <code>src/main.rs</code> ä¸ºç¼–å†™åº”ç”¨ä»£ç çš„åœ°æ–¹ã€‚</p><h2 id="è¿è¡Œé¡¹ç›®"><a href="#è¿è¡Œé¡¹ç›®" class="headerlink" title="è¿è¡Œé¡¹ç›®"></a>è¿è¡Œé¡¹ç›®</h2><p>ä½¿ç”¨cargo runå‘½ä»¤è¿è¡Œ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo run</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/07/17/mNL3feJjDEgQwSM.png" alt="image-20240717224940931.png"></p><p>å¯ä»¥çœ‹åˆ°ä¼šç»å†ä¸€ä¸ªç¼–è¯‘çš„è¿‡ç¨‹åï¼Œæ‰“å°å‡ºHello,worldï¼ä¿¡æ¯</p><h2 id="ç¼–å†™Hello-Rust"><a href="#ç¼–å†™Hello-Rust" class="headerlink" title="ç¼–å†™Hello-Rust"></a>ç¼–å†™Hello-Rust</h2><p>Cargo.tomlæ–‡ä»¶æ˜¯ä¸€ä¸ªç®¡ç†é¡¹ç›®é…ç½®çš„æ–‡ä»¶ï¼ŒåŒ…æ‹¬é¡¹ç›®ä¾èµ–ç­‰ç›¸å…³é…ç½®</p><p>æ·»åŠ é…ç½®åœ¨dependenciesä¸­ï¼š</p><p><img src="https://s2.loli.net/2024/07/17/f3v2g9nkEeCP1Bw.png" alt="image-20240717225346375.png"></p><p>åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo build</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/07/17/q5HyoCIZ3QMJfiS.png" alt="image-20240717225528135.png"></p><p>å¯ä»¥çœ‹åˆ°é™¤äº†æˆ‘ä»¬è‡ªå®šä¹‰æ·»åŠ çš„ferris-sayç‰ˆæœ¬çš„ä¾èµ–ï¼Œè¿˜ä¼šè‡ªåŠ¨æ·»åŠ å¥½ä¾èµ–çš„ä¾èµ–</p><p>æ¥ä¸‹æ¥å°±åœ¨ <code>src/main.rs</code> ä¸­å†™å…¥ä»¥ä¸‹å†…å®¹:</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> ferris_says::say; <span class="comment">// from the previous step</span></span><br><span class="line"><span class="keyword">use</span> std::io::&#123;stdout, BufWriter&#125;;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">stdout</span> = <span class="title function_ invoke__">stdout</span>();</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">message</span> = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Hello fellow Rustaceans!&quot;</span>);</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">width</span> = message.<span class="title function_ invoke__">chars</span>().<span class="title function_ invoke__">count</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">writer</span> = BufWriter::<span class="title function_ invoke__">new</span>(stdout.<span class="title function_ invoke__">lock</span>());</span><br><span class="line">    <span class="title function_ invoke__">say</span>(message.<span class="title function_ invoke__">as_bytes</span>(), width, &amp;<span class="keyword">mut</span> writer).<span class="title function_ invoke__">unwrap</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å†æ‰§è¡Œ</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cargo run</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/07/17/t3oD9w8rgWaKBeu.png" alt="image-20240717230124205.png"></p>]]></content>
      
      
      <categories>
          
          <category> Rust </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Rust </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaå…«è‚¡</title>
      <link href="/2024/07/10/2024-06-24-Java%E5%85%AB%E8%82%A1/"/>
      <url>/2024/07/10/2024-06-24-Java%E5%85%AB%E8%82%A1/</url>
      
        <content type="html"><![CDATA[<h1 id="Javaå…«è‚¡"><a href="#Javaå…«è‚¡" class="headerlink" title="Javaå…«è‚¡"></a>Javaå…«è‚¡</h1><p><a href="https://blog.csdn.net/leader_song/article/details/132094080?ops_request_misc=%7B%22request_id%22:%22171151104816800211548110%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=171151104816800211548110&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-132094080-null-null.142%5Ev100%5Epc_search_result_base2&utm_term=java%E9%9D%A2%E8%AF%95%E5%85%AB%E8%82%A1%E6%96%872023&spm=1018.2226.3001.4187">2024å¹´ Java é¢è¯•å…«è‚¡æ–‡ï¼ˆ20wå­—ï¼‰_javaå…«è‚¡æ–‡2023-CSDNåšå®¢</a></p><h2 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h2><p><a href="https://blog.csdn.net/qq_62124267/article/details/135418799?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_utm_term~default-0-135418799-blog-124295453.235%5Ev43%5Epc_blog_bottom_relevance_base7&spm=1001.2101.3001.4242.1&utm_relevant_index=1">é¢è¯•è¢«é—®äº†å‡ ç™¾éçš„ IOC å’Œ AOP ï¼Œä¸€ç¯‡æ–‡ç« å¸¦ä½ ææ¸…æ¥šï¼ï¼ï¼_iocå’Œaopçš„åŸç†é¢è¯•-CSDNåšå®¢</a></p><h2 id="Sentinel"><a href="#Sentinel" class="headerlink" title="Sentinel"></a>Sentinel</h2><p><a href="https://blog.csdn.net/crazymakercircle/article/details/125059491?ops_request_misc=%7B%22request_id%22:%22171164453116800225568300%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=171164453116800225568300&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-125059491-null-null.142%5Ev100%5Epc_search_result_base2&utm_term=sentinel&spm=1018.2226.3001.4187">sentinel ï¼ˆå²ä¸Šæœ€å…¨ï¼‰-CSDNåšå®¢</a></p><h2 id="Gradle-Maven"><a href="#Gradle-Maven" class="headerlink" title="Gradle&amp;Maven"></a>Gradle&amp;Maven</h2><p><a href="https://flydean.blog.csdn.net/article/details/113803536?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-1-113803536-blog-133955312.235%5Ev43%5Epc_blog_bottom_relevance_base7&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-1-113803536-blog-133955312.235%5Ev43%5Epc_blog_bottom_relevance_base7&utm_relevant_index=2">gradleä¸­çš„build scriptè¯¦è§£_gradle buildscript-CSDNåšå®¢</a></p><p>[Gradleå’ŒMavençš„åŒºåˆ«-CSDNåšå®¢](<a href="https://blog.csdn.net/weixin_45626288/article/details/131973787?ops_request_misc=%7B%22request_id%22:%22172024305816800185819613%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172024305816800185819613&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-131973787-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=gradle">https://blog.csdn.net/weixin_45626288/article/details/131973787?ops_request_misc=%7B%22request%5Fid%22%3A%22172024305816800185819613%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172024305816800185819613&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-131973787-null-null.142^v100^pc_search_result_base8&amp;utm_term=gradle</a> maven&amp;spm&#x3D;1018.2226.3001.4187)</p><h2 id="çº¿ç¨‹æ± å’Œé”"><a href="#çº¿ç¨‹æ± å’Œé”" class="headerlink" title="çº¿ç¨‹æ± å’Œé”"></a>çº¿ç¨‹æ± å’Œé”</h2><p><a href="https://blog.csdn.net/qq_54070103/article/details/124108541?ops_request_misc=%7B%22request_id%22:%22172024328716800184129598%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172024328716800184129598&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-124108541-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%92%8C%E9%94%81&spm=1018.2226.3001.4187">é¢è¯•+åŸºç¡€â€”â€“è¯¦ç»†è§£è¯»å¤šçº¿ç¨‹ï¼ˆçº¿ç¨‹æ± ã€é”ã€æ­»é”â€¦ï¼‰_å¤šçº¿ç¨‹äº•å‘ã€æ­»é”é—®é¢˜ã€çº¿ç¨‹æ± åŸç†ç­‰-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/u013541140/article/details/95225769?ops_request_misc=%7B%22request_id%22:%22172024532116800211519152%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172024532116800211519152&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-95225769-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=%E7%BA%BF%E7%A8%8B%E6%B1%A0&spm=1018.2226.3001.4187">Java å¤šçº¿ç¨‹ï¼šå½»åº•ææ‡‚çº¿ç¨‹æ± _javaçº¿ç¨‹æ± -CSDNåšå®¢</a></p><h2 id="Netty"><a href="#Netty" class="headerlink" title="Netty"></a>Netty</h2><p><a href="https://blog.csdn.net/qq_35190492/article/details/113174359?ops_request_misc=%7B%22request_id%22:%22172024555916800184190893%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172024555916800184190893&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-113174359-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=netty&spm=1018.2226.3001.4187">ã€ç¡¬æ ¸ã€‘è‚äº†ä¸€æœˆçš„NettyçŸ¥è¯†ç‚¹-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/qq_33384191/article/details/129187707?ops_request_misc=%7B%22request_id%22:%22172024555916800184190893%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172024555916800184190893&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-2-129187707-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=netty&spm=1018.2226.3001.4187">è¶…è¯¦ç»†Nettyå…¥é—¨ï¼Œçœ‹è¿™ç¯‡å°±å¤Ÿäº†ï¼_nettyæ¡†æ¶-CSDNåšå®¢</a></p><h2 id="JUnit"><a href="#JUnit" class="headerlink" title="JUnit"></a>JUnit</h2><p><a href="https://blog.csdn.net/qq_41317495/article/details/108553894?ops_request_misc=%7B%22request_id%22:%22172024618916800185817050%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172024618916800185817050&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-108553894-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=JUnit&spm=1018.2226.3001.4187">JUnitè¯¦è§£-CSDNåšå®¢</a></p><h2 id="Pytest"><a href="#Pytest" class="headerlink" title="Pytest"></a>Pytest</h2><p><a href="https://blog.csdn.net/lovedingd/article/details/98952868?ops_request_misc=%7B%22request_id%22:%22172024619416800226527972%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172024619416800226527972&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-98952868-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=pytest&spm=1018.2226.3001.4187">Pythonæµ‹è¯•æ¡†æ¶ä¹‹pytestè¯¦è§£_pytestæ¡†æ¶è¯¦è§£-CSDNåšå®¢</a></p><h2 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h2><p><a href="https://blog.csdn.net/m0_61503020/article/details/125456520?ops_request_misc=%7B%22request_id%22:%22172024335816800225519741%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172024335816800225519741&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-125456520-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=docker&spm=1018.2226.3001.4187">dockerå…¥é—¨ï¼Œè¿™ä¸€ç¯‡å°±å¤Ÿäº†ã€‚-CSDNåšå®¢</a></p><blockquote><p>docker run [å¯é€‰å‚æ•°] image å‘½ä»¤ #å¯åŠ¨å®¹å™¨ï¼ˆæ— é•œåƒä¼šå…ˆä¸‹è½½é•œåƒï¼‰<br>#å‚æ•°è¯´æ˜<br>â€“name &#x3D; â€œNameâ€   å®¹å™¨åå­—<br>-c   åé¢è·Ÿå¾…å®Œæˆçš„å‘½ä»¤<br>-d   ä»¥åå°æ–¹å¼è¿è¡Œå¹¶ä¸”è¿”å›IDï¼Œå¯åŠ¨å®ˆæŠ¤è¿›ç¨‹å¼å®¹å™¨<br>-i   ä½¿ç”¨äº¤äº’æ–¹å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸tåŒæ—¶ä½¿ç”¨<br>-t   ä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ã€‚ä¹Ÿå³å¯åŠ¨äº¤äº’å¼å®¹å™¨<br>-p   æŒ‡å®šå®¹å™¨ç«¯å£    -p å®¹å™¨ç«¯å£:ç‰©ç†æœºç«¯å£  æ˜ å°„ç«¯å£<br>-P   éšæœºæŒ‡å®šç«¯å£<br>-v   ç»™å®¹å™¨æŒ‚è½½å­˜å‚¨å·</p></blockquote><h2 id="JVM"><a href="#JVM" class="headerlink" title="JVM"></a>JVM</h2><p>[JAVAå†…å­˜åˆ†é…åŸç†è§£æâ€“æ ˆã€å †ã€å¸¸é‡æ± _å †,æ ˆ,å¸¸é‡æ± è¯¦è§£-CSDNåšå®¢](<a href="https://blog.csdn.net/gb702250823/article/details/92801716?ops_request_misc=%7B%22request_id%22:%22171151029816800225558425%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=171151029816800225558425&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-92801716-null-null.142%5Ev100%5Epc_search_result_base2&utm_term=java">https://blog.csdn.net/gb702250823/article/details/92801716?ops_request_misc=%7B%22request%5Fid%22%3A%22171151029816800225558425%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=171151029816800225558425&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-92801716-null-null.142^v100^pc_search_result_base2&amp;utm_term=java</a> å¸¸é‡æ±  æ ˆ å †&amp;spm&#x3D;1018.2226.3001.4187)</p><p><a href="https://blog.csdn.net/LJWfbj666/article/details/139120947?ops_request_misc=&request_id=&biz_id=102&utm_term=java%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-139120947.142%5Ev100%5Epc_search_result_base8&spm=1018.2226.3001.4187">javaçš„åƒåœ¾å›æ”¶(GC)è¯¦è§£_java gc-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/ZHHX666/article/details/124484199?ops_request_misc=%7B%22request_id%22:%22172025262616800182710898%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172025262616800182710898&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-124484199-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=java%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8&spm=1018.2226.3001.4187">Java - ç±»åŠ è½½å™¨_javaç±»åŠ è½½å™¨-CSDNåšå®¢</a></p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> å…«è‚¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åç«¯å¾®æœåŠ¡-programmer-clubé¡¹ç›®çš„è®¾è®¡ä¸å®ç°</title>
      <link href="/2024/07/10/2024-07-10-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%A4%BE%E5%8C%BA%E9%A1%B9%E7%9B%AE%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/"/>
      <url>/2024/07/10/2024-07-10-%E7%A8%8B%E5%BA%8F%E5%91%98%E7%A4%BE%E5%8C%BA%E9%A1%B9%E7%9B%AE%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="ç¨‹åºå‘˜ç¤¾åŒºé¡¹ç›®"><a href="#ç¨‹åºå‘˜ç¤¾åŒºé¡¹ç›®" class="headerlink" title="ç¨‹åºå‘˜ç¤¾åŒºé¡¹ç›®"></a>ç¨‹åºå‘˜ç¤¾åŒºé¡¹ç›®</h1><p><img src="https://s2.loli.net/2024/07/10/zbYgoZyvmxdwP3n.png" alt="image-20240710162449654.png"></p><h2 id="å¼€å‘æ¨¡å¼"><a href="#å¼€å‘æ¨¡å¼" class="headerlink" title="å¼€å‘æ¨¡å¼"></a>å¼€å‘æ¨¡å¼</h2><p>å‰åç«¯åˆ†ç¦»ï¼Œåç«¯è´Ÿè´£æ‰€æœ‰çš„è®¾è®¡ã€æ¥å£çš„å®šä¹‰ï¼Œåç«¯å…ˆè¡Œï¼Œå‰ç«¯ååŒï¼Œé€šè¿‡æ¥å£æ–‡æ¡£ï¼Œé‡‡ç”¨apifoxçš„æ–‡æ¡£è¿›è¡Œå¯¹æ¥ã€‚</p><p>æ•æ·å¼€å‘ï¼Œç‰ˆæœ¬ä¸Šçº¿è¿­ä»£ï¼Œéœ€æ±‚åˆ†æ-&gt;åŠŸèƒ½è®¾è®¡-&gt;è¯¦ç»†è®¾è®¡-&gt;ç¼–ç å®ç°ã€‚</p><h2 id="å¼€å‘å·¥å…·"><a href="#å¼€å‘å·¥å…·" class="headerlink" title="å¼€å‘å·¥å…·"></a>å¼€å‘å·¥å…·</h2><p>åç«¯ï¼šIDEA</p><p>å‰ç«¯ï¼šVSCode</p><p>é¡¹ç›®ç®¡ç†ï¼šgiteazycode</p><p>åŒ…ä¾èµ–ç®¡ç†ï¼šMaven3.6.0</p><p>æ•°æ®åº“ï¼šMysql5.7</p><p>æ•°æ®åº“è¿æ¥æ± å’Œç›‘æ§åº“ï¼šDruid</p><p>æ¡†æ¶ï¼šSpringboot 2.4.2</p><p>æ•°æ®åº“å›¾å½¢åŒ–ï¼šNavicat</p><p>æ¥å£ç®¡ç†å·¥å…·ï¼šAPIPost7</p><p>Redisæ¡Œé¢å·¥å…·ï¼šRedisDesktop</p><p>è¡¨å»ºæ¨¡ï¼šPDManager</p><p>åŸå‹è®¾è®¡ï¼šaxure8</p><p>åŸå‹ç»„ä»¶åº“: antdesign</p><p>ä»£ç ç”Ÿæˆå™¨ï¼šeasycodeï¼ˆideaçš„pluginå¸‚åœºï¼‰</p><p>ä¸€äº›æ’ä»¶ï¼šmybatisï¼ˆç±»-&gt;dao-&gt;æ•°æ®åº“ï¼‰ï¼Œeasycodeï¼ˆç”±æ•°æ®åº“è¡¨ç”Ÿæˆç›¸åº”ä»£ç ï¼‰, preconditionsï¼ˆå‚æ•°æ ¡éªŒï¼‰</p><p>node.js</p><h2 id="æ¶æ„è®¾è®¡"><a href="#æ¶æ„è®¾è®¡" class="headerlink" title="æ¶æ„è®¾è®¡"></a>æ¶æ„è®¾è®¡</h2><h3 id="ä¼ ç»Ÿé¡¹ç›®"><a href="#ä¼ ç»Ÿé¡¹ç›®" class="headerlink" title="ä¼ ç»Ÿé¡¹ç›®"></a>ä¼ ç»Ÿé¡¹ç›®</h3><p>[SpringMVCæ¡†æ¶ï¼ˆè¯¦è§£ï¼‰-CSDNåšå®¢](<a href="https://blog.csdn.net/H20031011/article/details/131511482?ops_request_misc=%7B%22request_id%22:%22172145077916800222810035%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172145077916800222810035&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-131511482-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=spring">https://blog.csdn.net/H20031011/article/details/131511482?ops_request_misc=%7B%22request%5Fid%22%3A%22172145077916800222810035%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172145077916800222810035&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-131511482-null-null.142^v100^pc_search_result_base8&amp;utm_term=spring</a> mvcæ¶æ„&amp;spm&#x3D;1018.2226.3001.4187)</p><p>ä¸€èˆ¬çš„mvcï¼šmodelï¼Œviewï¼Œcontroller</p><p>SpringMVCï¼šcontroller(view+controller)ï¼Œserviceï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰ï¼Œdaoï¼ˆæ•°æ®åº“ï¼‰</p><p><img src="https://s2.loli.net/2024/07/10/IkmcCyEaiVK8jvT.png" alt="image-20240710175347652.png"></p><p><img src="https://s2.loli.net/2024/07/20/4xSwLQAW6PBKqYI.png" alt="image-20240720125604514.png"></p><h3 id="ç°æœ‰çš„æ¶æ„"><a href="#ç°æœ‰çš„æ¶æ„" class="headerlink" title="ç°æœ‰çš„æ¶æ„"></a>ç°æœ‰çš„æ¶æ„</h3><p><a href="https://blog.csdn.net/qq_49619863/article/details/127836283?ops_request_misc=%7B%22request_id%22:%22172060612716800222827668%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172060612716800222827668&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-127836283-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=ddd%E6%9E%B6%E6%9E%84&spm=1018.2226.3001.4187">DDDæ¶æ„-CSDNåšå®¢</a></p><p>[æµ…è°ˆæ¶æ„è®¾è®¡ï¼šMVCæ¶æ„ä¸DDDæ¶æ„ã€å¼€å‘å®è·µã€‘_dddæ¶æ„å’Œmvcæ¶æ„åŒºåˆ«-CSDNåšå®¢](<a href="https://blog.csdn.net/qq_40656637/article/details/137344153?ops_request_misc=%7B%22request_id%22:%22172145093416800184184571%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=172145093416800184184571&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-137344153-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=spring">https://blog.csdn.net/qq_40656637/article/details/137344153?ops_request_misc=%7B%22request%5Fid%22%3A%22172145093416800184184571%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D&amp;request_id=172145093416800184184571&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-137344153-null-null.142^v100^pc_search_result_base8&amp;utm_term=spring</a> mvcæ¶æ„å’Œdddæ¶æ„&amp;spm&#x3D;1018.2226.3001.4187)</p><p>ddd æ¶æ„</p><p><img src="https://s2.loli.net/2024/07/10/6L8j9VMkRHxWOga.png" alt="cbc3530efc1e41d6b6a94455d804d3d3[1].png"></p><ul><li><p>ç”¨æˆ·æ¥å£å±‚ï¼ˆUser Interface ï¼‰ï¼šè´Ÿè´£å‘ç”¨æˆ·æ˜¾ç¤ºä¿¡æ¯å’Œè§£é‡Šç”¨æˆ·æŒ‡ä»¤ï¼ˆæ˜¯DDDæ¶æ„ä¸­çš„è¡¨ç°å±‚ï¼‰ï¼ˆè¡¨ç°å±‚æ˜¯è§†å›¾å±‚çš„è¶…é›†ï¼Œæ¦‚å¿µæœ‰æ‰€åŒºåˆ«ï¼ŒçŸ¥é“æœ€ä¸Šå±‚å°±æ˜¯è¡¨ç°å±‚å³å¯ï¼‰</p></li><li><p>åº”ç”¨å±‚ï¼ˆApplicationï¼‰ï¼šå¾ˆâ€œè–„â€çš„ä¸€å±‚ï¼Œç†è®ºä¸Šä¸åº”è¯¥æœ‰ä¸šåŠ¡è§„åˆ™æˆ–é€»è¾‘ï¼Œä¸»è¦é¢å‘ç”¨ä¾‹å’Œæµç¨‹ç›¸å…³çš„æ“ä½œã€‚åœ¨åº”ç”¨å±‚åè°ƒå¤šä¸ªæœåŠ¡å’Œé¢†åŸŸå¯¹è±¡å®ŒæˆæœåŠ¡çš„ç»„åˆå’Œç¼–æ’ï¼Œåä½œå®Œæˆä¸šåŠ¡æ“ä½œã€‚æ­¤å¤–ï¼Œåº”ç”¨å±‚ä¹Ÿæ˜¯å¾®æœåŠ¡ä¹‹é—´äº¤äº’çš„é€šé“ï¼Œå®ƒå¯ä»¥è°ƒç”¨å…¶å®ƒå¾®æœåŠ¡çš„åº”ç”¨æœåŠ¡ï¼Œå®Œæˆå¾®æœåŠ¡ä¹‹é—´æœåŠ¡çš„ç»„åˆå’Œç¼–æ’</p></li><li><p>é¢†åŸŸå±‚ï¼ˆDomainï¼‰ï¼šæ˜¯å®ç°ä¼ä¸šæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œé€šè¿‡å„ç§æ ¡éªŒæ‰‹æ®µä¿è¯ä¸šåŠ¡çš„æ­£ç¡®æ€§ã€‚é¢†åŸŸå±‚ä¸»è¦ä½“ç°é¢†åŸŸæ¨¡å‹çš„ä¸šåŠ¡èƒ½åŠ›ï¼Œå®ƒç”¨æ¥è¡¨è¾¾ä¸šåŠ¡æ¦‚å¿µã€ä¸šåŠ¡çŠ¶æ€å’Œä¸šåŠ¡è§„åˆ™ã€‚é¢†åŸŸå±‚åŒ…å«èšåˆæ ¹ã€å®ä½“ã€å€¼å¯¹è±¡ã€é¢†åŸŸæœåŠ¡ç­‰é¢†åŸŸæ¨¡å‹ä¸­çš„é¢†åŸŸå¯¹è±¡</p></li><li><p>åŸºç¡€å±‚ï¼ˆInfrastructureï¼‰ï¼šè´¯ç©¿æ‰€æœ‰å±‚ï¼Œä¸ºå…¶å®ƒå±‚æä¾›é€šç”¨çš„æŠ€æœ¯å’ŒåŸºç¡€æœåŠ¡ï¼ŒåŒ…æ‹¬ç¬¬ä¸‰æ–¹å·¥å…·ã€é©±åŠ¨ã€æ¶ˆæ¯ä¸­é—´ä»¶ã€ç½‘å…³ã€æ–‡ä»¶ã€ç¼“å­˜ä»¥åŠæ•°æ®åº“ç­‰</p></li><li><p>ä¸ªäººç†è§£ï¼šå°†serviceå±‚æ‹†åˆ†ä¸ºäº†åº”ç”¨å±‚å’Œé¢†åŸŸå±‚ã€‚å…¶ä¸­åº”ç”¨å±‚å…³æ³¨äºç”¨ä¾‹å’Œæµç¨‹ï¼Œä¸æ¶‰åŠä¸šåŠ¡è§„åˆ™æˆ–é€»è¾‘ï¼Œé€šè¿‡ç»„åˆå’Œç¼–æ’ä¸‹å±‚çš„é¢†åŸŸå±‚æ¥å®Œæˆä¸šåŠ¡æ“ä½œã€‚è€Œé¢†åŸŸå±‚ç”¨äºå°è£…å…·ä½“çš„ä¸šåŠ¡è§„åˆ™æˆ–é€»è¾‘ï¼Œæ‹†åˆ†å‡ºæ¥çš„é¢†åŸŸå±‚ä¸å†å’Œå…·ä½“æµç¨‹å…³è”ï¼Œå®ç°äº†é«˜å†…èšå’Œä½è€¦åˆï¼Œè¿˜æé«˜äº†é¢†åŸŸå±‚çš„å¯å¤ç”¨æ€§ã€‚ç”¨æˆ·æ¥å£å±‚å’ŒåŸºç¡€å±‚åˆ™ä¸ºåŸæ¥çš„è§†å›¾å±‚å’Œdaoå±‚çš„æ‰©å±•ï¼Œæ–°å¢äº†éƒ¨åˆ†èŒè´£åŠŸèƒ½ã€‚</p></li></ul><p>ä¾‹å­ï¼š</p><ol><li><strong>ç”µå­å•†åŠ¡é¢†åŸŸ</strong>ï¼š<ul><li>å®ä½“ï¼šç”¨æˆ·ã€äº§å“ã€è®¢å•ã€æ”¯ä»˜è®°å½•ã€‚</li><li>èšåˆï¼šè´­ç‰©è½¦ã€è®¢å•è¯¦æƒ…ã€‚</li><li>é¢†åŸŸæœåŠ¡ï¼šè®¢å•å¤„ç†ã€åº“å­˜ç®¡ç†ã€ç”¨æˆ·è®¤è¯ã€‚</li></ul></li><li><strong>äº¤é€šç‰©æµé¢†åŸŸ</strong>ï¼š<ul><li>å®ä½“ï¼šå¸æœºã€è½¦è¾†ã€è´§ç‰©ã€è¿è¾“ä»»åŠ¡ã€‚</li><li>èšåˆï¼šè¿è¾“è®¢å•ã€è½¦é˜Ÿç®¡ç†ã€‚</li><li>é¢†åŸŸæœåŠ¡ï¼šè·¯å¾„è§„åˆ’ã€è´§ç‰©è¿½è¸ªã€è°ƒåº¦ä¼˜åŒ–ã€‚</li></ul></li></ol><p><img src="https://s2.loli.net/2024/07/10/eTX5pdGHV3OrFIB.png" alt="image-20240710175452746.png"></p><ol><li><p><strong>APIï¼ˆå¯¹å¤–æ¥å£å±‚ï¼‰</strong>ï¼šè¿™ä¸€å±‚è´Ÿè´£å®šä¹‰å¯¹å¤–æä¾›çš„æœåŠ¡æ¥å£ï¼Œé€šå¸¸ç”¨äºä¸å®¢æˆ·ç«¯æˆ–å…¶ä»–æœåŠ¡è¿›è¡Œäº¤äº’ã€‚</p></li><li><p><strong>Controller</strong>ï¼šåœ¨ä¼ ç»Ÿçš„MVCæ¶æ„ä¸­ï¼Œæ§åˆ¶å™¨ç”¨äºå¤„ç†ç”¨æˆ·çš„è¯·æ±‚ã€‚åœ¨è¿™é‡Œï¼Œå®ƒç”¨äºæ¥æ”¶APIå±‚çš„è¯·æ±‚ï¼Œå¹¶å°†è¯·æ±‚è½¬æ¢ä¸ºåº”ç”¨å±‚å¯ä»¥ç†è§£çš„æ ¼å¼ã€‚</p></li><li><p><strong>DTOï¼ˆData Transfer Objectï¼‰</strong>ï¼š</p><p>ä»£è¡¨æ•°æ®ä¼ è¾“å¯¹è±¡çš„æ„æ€</p><p>æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ä¹‹é—´ä¼ è¾“æ•°æ®çš„è½¯ä»¶åº”ç”¨ç³»ç»Ÿï¼Œæ•°æ®ä¼ è¾“ç›®æ ‡å¾€å¾€æ˜¯æ•°æ®è®¿é—®å¯¹è±¡ä»æ•°æ®åº“ä¸­æ£€ç´¢æ•°æ®</p><p>æ•°æ®ä¼ è¾“å¯¹è±¡ä¸æ•°æ®äº¤äº’å¯¹è±¡æˆ–æ•°æ®è®¿é—®å¯¹è±¡ä¹‹é—´çš„å·®å¼‚æ˜¯ä¸€ä¸ªä»¥ä¸å…·ä»»ä½•è¡Œä¸ºé™¤äº†å­˜å‚¨å’Œæ£€ç´¢çš„æ•°æ®ï¼ˆè®¿é—®å’Œå­˜å–å™¨ï¼‰</p><p>ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯<strong>æ¥å£ä¹‹é—´ä¼ é€’çš„æ•°æ®å°è£…</strong></p><p>è¡¨é‡Œé¢æœ‰åå‡ ä¸ªå­—æ®µï¼šidï¼Œnameï¼Œgenderï¼ˆM&#x2F;F)ï¼Œageâ€¦â€¦</p><p>é¡µé¢éœ€è¦å±•ç¤ºä¸‰ä¸ªå­—æ®µï¼šnameï¼Œgender(ç”·&#x2F;å¥³)ï¼Œage</p><p>DTOç”±æ­¤äº§ç”Ÿï¼Œä¸€æ˜¯èƒ½æé«˜æ•°æ®ä¼ è¾“çš„é€Ÿåº¦(å‡å°‘äº†ä¼ è¾“å­—æ®µ)ï¼ŒäºŒèƒ½éšè—åç«¯è¡¨ç»“æ„ã€‚</p></li><li><p><strong>BOï¼ˆBusiness Objectï¼‰</strong>ï¼š</p><p>ä»£è¡¨ä¸šåŠ¡å¯¹è±¡çš„æ„æ€ï¼ŒBoå°±æ˜¯æŠŠä¸šåŠ¡é€»è¾‘å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼ˆæ³¨æ„æ˜¯é€»è¾‘ï¼Œä¸šåŠ¡é€»è¾‘ï¼‰ï¼Œè¿™ä¸ªå¯¹è±¡å¯ä»¥åŒ…æ‹¬ä¸€ä¸ªæˆ–å¤šä¸ªå…¶å®ƒçš„å¯¹è±¡ã€‚é€šè¿‡è°ƒç”¨Daoæ–¹æ³•ï¼Œç»“åˆPoæˆ–Voè¿›è¡Œä¸šåŠ¡æ“ä½œã€‚</p><p>å½¢è±¡æè¿°ä¸ºä¸€ä¸ªå¯¹è±¡çš„å½¢ä¸ºå’ŒåŠ¨ä½œï¼Œå½“ç„¶ä¹Ÿæœ‰æ¶‰åŠåˆ°åŸºå®ƒå¯¹è±¡çš„ä¸€äº›å½¢ä¸ºå’ŒåŠ¨ä½œã€‚æ¯”å¦‚å¤„ç†ä¸€ä¸ªäººçš„ä¸šåŠ¡é€»è¾‘ï¼Œè¯¥äººä¼šç¡è§‰ï¼Œåƒé¥­ï¼Œå·¥ä½œï¼Œä¸Šç­ç­‰ç­‰è¡Œä¸ºï¼Œè¿˜æœ‰å¯èƒ½å’Œåˆ«äººå‘å…³ç³»çš„è¡Œä¸ºï¼Œå¤„ç†è¿™æ ·çš„ä¸šåŠ¡é€»è¾‘æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥é’ˆå¯¹BOå»å¤„ç†ã€‚</p><p>å†æ¯”å¦‚æŠ•ä¿äººæ˜¯ä¸€ä¸ªPOï¼Œè¢«ä¿é™©äººæ˜¯ä¸€ä¸ªPOï¼Œé™©ç§ä¿¡æ¯ä¹Ÿæ˜¯ä¸€ä¸ªPOç­‰ç­‰ï¼Œä»–ä»¬ç»„åˆèµ·æ¥å°±æ˜¯ä¸€å¼ ä¿å•çš„BOã€‚</p></li><li><p><strong>PO&#x2F;DO: Persistent Object &#x2F; Data Objectï¼ŒæŒä¹…å¯¹è±¡ &#x2F; æ•°æ®å¯¹è±¡ã€‚</strong></p><p>å®ƒè·ŸæŒä¹…å±‚ï¼ˆé€šå¸¸æ˜¯å…³ç³»å‹æ•°æ®åº“ï¼‰çš„æ•°æ®ç»“æ„å½¢æˆä¸€ä¸€å¯¹åº”çš„æ˜ å°„å…³ç³»ï¼Œå¦‚æœæŒä¹…å±‚æ˜¯å…³ç³»å‹æ•°æ®åº“ï¼Œé‚£ä¹ˆï¼Œæ•°æ®è¡¨ä¸­çš„æ¯ä¸ªå­—æ®µï¼ˆæˆ–è‹¥å¹²ä¸ªï¼‰å°±å¯¹åº”POçš„ä¸€ä¸ªï¼ˆæˆ–è‹¥å¹²ä¸ªï¼‰å±æ€§ã€‚</p></li><li><p><strong>VO: View Object, è§†å›¾æ¨¡å‹ï¼Œå±•ç¤ºå±‚å¯¹è±¡</strong>:</p><p>å¯¹åº”é¡µé¢æ˜¾ç¤ºï¼ˆwebé¡µé¢&#x2F;ç§»åŠ¨ç«¯H5&#x2F;Nativeè§†å›¾ï¼‰çš„æ•°æ®å¯¹è±¡ã€‚</p></li><li><p><strong>Applicationå±‚ï¼ˆåº”ç”¨å±‚ï¼‰</strong>ï¼šè¿™ä¸€å±‚åŒ…å«åº”ç”¨æœåŠ¡ï¼Œå®ƒä»¬åè°ƒé¢†åŸŸå¯¹è±¡æ¥å®Œæˆä¸šåŠ¡é€»è¾‘ã€‚å®ƒè¿˜åŒ…å«ä¸€äº›ä¸šåŠ¡é€»è¾‘çš„è½¬æ¢é€»è¾‘ï¼Œå¦‚DTOåˆ°BOçš„è½¬æ¢ã€‚</p></li><li><p><strong>Interceptor</strong>ï¼šæ‹¦æˆªå™¨ï¼Œç”¨äºåœ¨è¯·æ±‚å¤„ç†è¿‡ç¨‹ä¸­è¿›è¡Œä¸€äº›å‰ç½®æˆ–åç½®å¤„ç†ï¼Œä¾‹å¦‚æ—¥å¿—è®°å½•ã€æƒé™éªŒè¯ç­‰ã€‚</p></li><li><p><strong>Application-MQï¼ˆæ¶ˆè´¹è€…ï¼‰&#x2F; Application-Job</strong>ï¼šè¿™æŒ‡çš„æ˜¯åº”ç”¨å±‚ä¸­å¤„ç†æ¶ˆæ¯é˜Ÿåˆ—æ¶ˆæ¯çš„ç»„ä»¶ï¼Œæˆ–è€…å®šæ—¶ä»»åŠ¡çš„å¤„ç†ã€‚</p></li><li><p><strong>Domainå±‚ï¼ˆé¢†åŸŸå±‚ï¼‰</strong>ï¼šè¿™æ˜¯DDDä¸­çš„æ ¸å¿ƒå±‚ï¼ŒåŒ…å«ä¸šåŠ¡é€»è¾‘å’Œé¢†åŸŸæ¨¡å‹ã€‚é¢†åŸŸå±‚ä¸“æ³¨äºä¸šåŠ¡è§„åˆ™å’Œä¸šåŠ¡å®ä½“ã€‚</p></li><li><p><strong>Service</strong>ï¼šé¢†åŸŸæœåŠ¡ï¼Œæ‰§è¡Œé¢†åŸŸé€»è¾‘ä½†ä¸è‡ªç„¶å±äºä»»ä½•å®ä½“æˆ–å€¼å¯¹è±¡çš„æ“ä½œã€‚</p></li><li><p><strong>Entity&#x2F;POï¼ˆPersistent Objectï¼‰</strong>ï¼šæŒä¹…åŒ–å¯¹è±¡ï¼Œé€šå¸¸ä¸æ•°æ®åº“å­˜å‚¨ç›¸å…³ï¼Œä»£è¡¨æ•°æ®åº“ä¸­çš„è®°å½•ã€‚</p></li><li><p><strong>Mapper</strong>ï¼šæ•°æ®è®¿é—®å¯¹è±¡ï¼Œç”¨äºå°†é¢†åŸŸå¯¹è±¡æ˜ å°„åˆ°æ•°æ®åº“è¡¨ã€‚</p></li><li><p><strong>Infraå±‚ï¼ˆåŸºç¡€è®¾æ–½å±‚ï¼‰</strong>ï¼šæä¾›æŠ€æœ¯å®ç°ï¼Œå¦‚æ•°æ®åº“è®¿é—®ã€æ¶ˆæ¯ä¼ é€’ã€å¤–éƒ¨æœåŠ¡è°ƒç”¨ç­‰ã€‚</p></li><li><p><strong>RPC</strong>ï¼šè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œç”¨äºæœåŠ¡ä¹‹é—´çš„é€šä¿¡ã€‚</p></li><li><p><strong>MGï¼ˆç”Ÿäº§è€…ï¼‰</strong>ï¼šæŒ‡çš„æ˜¯æ¶ˆæ¯ç”Ÿæˆè€…ï¼Œè´Ÿè´£ç”Ÿæˆå¹¶å‘é€æ¶ˆæ¯åˆ°æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p></li><li><p><strong>Starterï¼ˆå¯åŠ¨å±‚ï¼‰</strong>ï¼šæŒ‡çš„æ˜¯æœåŠ¡å¯åŠ¨æ—¶éœ€è¦è‡ªåŠ¨æ‰§è¡Œçš„ä»£ç æˆ–é…ç½®ã€‚</p></li><li><p><strong>Aggressiveï¼ˆèšåˆå±‚ï¼‰</strong>ï¼šèšåˆå±‚ï¼Œå°†å¤šä¸ªé¢†åŸŸå¯¹è±¡èšåˆæˆä¸€ä¸ªæ›´å¤§çš„ä¸šåŠ¡å®ä½“ã€‚</p></li><li><p><strong>Config</strong>ï¼šé…ç½®å±‚ï¼Œç”¨äºå­˜å‚¨å’Œè®¿é—®é…ç½®ä¿¡æ¯ã€‚</p></li><li><p><strong>Dictï¼ˆå­—å…¸ï¼‰</strong>ï¼šæŒ‡çš„æ˜¯æ•°æ®å­—å…¸ï¼Œç”¨äºå­˜å‚¨ä¸€äº›å›ºå®šçš„æ•°æ®æˆ–æ˜ å°„å…³ç³»ã€‚</p></li><li><p><strong>Commonï¼ˆå…¬å…±å±‚ï¼‰</strong>ï¼šåŒ…å«æ•´ä¸ªåº”ç”¨ä¸­å¤šä¸ªåœ°æ–¹ä¼šç”¨åˆ°çš„é€šç”¨ä»£ç æˆ–å·¥å…·ã€‚</p></li><li><p><strong>Enums</strong>ï¼šæšä¸¾ï¼Œç”¨äºå®šä¹‰ä¸€ç»„å‘½åçš„å¸¸é‡ã€‚</p></li><li><p><strong>Utils</strong>ï¼šå·¥å…·ç±»ï¼Œæä¾›ä¸€äº›é€šç”¨çš„è¾…åŠ©åŠŸèƒ½ã€‚</p></li></ol><p>req-&gt;dto-&gt;do-&gt;bo-&gt;entity-&gt;po</p><p><img src="https://s2.loli.net/2024/07/10/vcwy8WMZKz7pNSe.jpg" alt="UBWaSonlxTkZyGs[1].jpg"></p><h3 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h3><p><img src="https://s2.loli.net/2024/07/17/YwcR1HeWvrqD72s.png" alt="image-20240717163452115.png"></p><h4 id="åç«¯é¡¹ç›®ç›®å½•ï¼ˆbackendï¼‰"><a href="#åç«¯é¡¹ç›®ç›®å½•ï¼ˆbackendï¼‰" class="headerlink" title="åç«¯é¡¹ç›®ç›®å½•ï¼ˆbackendï¼‰"></a>åç«¯é¡¹ç›®ç›®å½•ï¼ˆbackendï¼‰</h4><ul><li><strong>asyncTool</strong>: åŒ…å«å¼‚æ­¥å¤„ç†å·¥å…·æˆ–åº“ï¼Œç”¨äºå¤„ç†å¼‚æ­¥ä»»åŠ¡ã€‚</li><li><strong>doc</strong>: å­˜æ”¾é¡¹ç›®æ–‡æ¡£ï¼Œå¦‚APIæ–‡æ¡£ã€æŠ€æœ¯è§„èŒƒç­‰ã€‚</li><li><strong>jc-club-auth</strong>: è®¤è¯æœåŠ¡ï¼Œè´Ÿè´£ç”¨æˆ·è®¤è¯å’Œæˆæƒã€‚</li><li><strong>jc-club-circle</strong>: å¯èƒ½ä¸ç¤¾åŒºåœˆå­æˆ–ç”¨æˆ·ç»„ç›¸å…³åŠŸèƒ½ã€‚</li><li><strong>jc-club-common-starter</strong>: é€šç”¨å¯åŠ¨å™¨æˆ–å·¥å…·ç±»ï¼Œæä¾›é¡¹ç›®é€šç”¨åŠŸèƒ½ã€‚</li><li><strong>jc-club-gateway</strong>: ç½‘å…³æœåŠ¡ï¼Œè´Ÿè´£è¯·æ±‚è·¯ç”±ã€è´Ÿè½½å‡è¡¡ç­‰ã€‚</li><li><strong>jc-club-gen</strong>: ä»£ç ç”Ÿæˆå·¥å…·ï¼Œå¯èƒ½ç”¨äºå¿«é€Ÿç”Ÿæˆé¡¹ç›®ä»£ç ã€‚</li><li><strong>jc-club-interview</strong>: é¢è¯•ç›¸å…³åŠŸèƒ½ï¼Œå¯èƒ½åŒ…å«é¢è¯•é¢˜åº“æˆ–æ¨¡æ‹Ÿé¢è¯•ã€‚</li><li><strong>jc-club-oss</strong>: å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼Œç”¨äºç®¡ç†æ–‡ä»¶å­˜å‚¨ã€‚</li><li><strong>jc-club-practice</strong>: å®è·µé¡¹ç›®æˆ–ç¤ºä¾‹ä»£ç ã€‚</li><li><strong>jc-club-subject</strong>: ä¸»é¢˜æˆ–è¯¾ç¨‹ç›¸å…³åŠŸèƒ½ï¼Œå¯èƒ½ç”¨äºæ•™è‚²æˆ–åŸ¹è®­ã€‚</li><li><strong>jc-club-wx</strong>: å¾®ä¿¡ç›¸å…³åŠŸèƒ½ï¼Œå¯èƒ½åŒ…å«å¾®ä¿¡å…¬ä¼—å·æ¥å£æˆ–å°ç¨‹åºæ”¯æŒã€‚</li></ul><h2 id="æŠ€æœ¯é€‰å‹"><a href="#æŠ€æœ¯é€‰å‹" class="headerlink" title="æŠ€æœ¯é€‰å‹"></a>æŠ€æœ¯é€‰å‹</h2><p>[Springå’ŒSpring Bootä¹‹é—´çš„åŒºåˆ«ï¼ˆå°ç»“ï¼‰_springå’Œspringbootçš„åŒºåˆ«-CSDNåšå®¢](<a href="https://blog.csdn.net/mengxin_chen/article/details/116240326?ops_request_misc=%7B%22request_id%22:%22172145220016800227442776%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172145220016800227442776&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-116240326-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=spring%E5%92%8Cspring">https://blog.csdn.net/mengxin_chen/article/details/116240326?ops_request_misc=%7B%22request%5Fid%22%3A%22172145220016800227442776%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172145220016800227442776&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-116240326-null-null.142^v100^pc_search_result_base8&amp;utm_term=springå’Œspring</a> bootåŒºåˆ«&amp;spm&#x3D;1018.2226.3001.4187)</p><p><img src="https://s2.loli.net/2024/07/10/SRyfeJV49ksGvNl.png" alt="image-20240710163626898.png"></p><h2 id="æœåŠ¡å™¨ä¸­é—´ä»¶"><a href="#æœåŠ¡å™¨ä¸­é—´ä»¶" class="headerlink" title="æœåŠ¡å™¨ä¸­é—´ä»¶"></a>æœåŠ¡å™¨ä¸­é—´ä»¶</h2><p>æœåŠ¡å™¨é‡‡ç”¨çš„äº¬ä¸œäº‘ centos</p><h3 id="Dockerå®‰è£…"><a href="#Dockerå®‰è£…" class="headerlink" title="Dockerå®‰è£…"></a>Dockerå®‰è£…</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">yum install -y yum-utils device-mapper-persistent-data lvm2</span><br><span class="line">yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br><span class="line">yum install docker-ce docker-ce-cli containerd.io -y </span><br><span class="line">systemctl start docker</span><br><span class="line">systemctl enable docker</span><br><span class="line">docker version </span><br><span class="line">docker images</span><br></pre></td></tr></table></figure><h3 id="Dockerå®‰è£…mysql"><a href="#Dockerå®‰è£…mysql" class="headerlink" title="Dockerå®‰è£…mysql"></a>Dockerå®‰è£…mysql</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker pull mysql:5.7 </span><br><span class="line">docker images </span><br><span class="line">mkdir -p /home/service/mysql/data </span><br><span class="line">mkdir -p /home/service/mysql/conf</span><br><span class="line">cd /home/service/mysql/conf</span><br><span class="line">touch my.cnf</span><br></pre></td></tr></table></figure><p>å°†ä»¥ä¸‹å†…å®¹ç²˜å…¥:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">user=mysql</span><br><span class="line">character-set-server=utf8</span><br><span class="line">default_authentication_plugin=mysql_native_password</span><br><span class="line">default-time_zone = &#x27;+8:00&#x27;</span><br><span class="line">[client]</span><br><span class="line">default-character-set=utf8</span><br><span class="line">[mysql]</span><br><span class="line">default-character-set=utf8</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker run -p 3306:3306 --name mysql -v /home/service/mysql/logs:/logs -v /home/service/mysql/data:/mysql_data -e MYSQL_ROOT_PASSWORD=Wing1Q2W#E -d mysql:5.7</span><br><span class="line">docker exec -it mysql bash </span><br><span class="line">mysql -uroot -p </span><br><span class="line"></span><br><span class="line">CREATE USER &#x27;admin&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;Wing1Q2W#E&#x27;;</span><br><span class="line">GRANT ALL ON *.* TO &#x27;admin&#x27;@&#x27;%&#x27;; </span><br><span class="line">flush privileges; </span><br></pre></td></tr></table></figure><p>docker ps æŸ¥çœ‹å¯åŠ¨çŠ¶æ€ã€‚</p><p>navicatç›´æ¥è¿æ¥å³å¯ï¼Œäº‘æœåŠ¡å™¨éœ€è¦å¼€å¯é˜²ç«å¢™ã€‚</p><h3 id="Mavené…ç½®å›½å†…æº"><a href="#Mavené…ç½®å›½å†…æº" class="headerlink" title="Mavené…ç½®å›½å†…æº"></a>Mavené…ç½®å›½å†…æº</h3><p>mavenä¸€å®šè¦æ”¾åˆ°Jenkinsçš„æ•°æ®æŒ‚è½½ç›®å½•å†…ï¼Œè¿™æ ·å®¹å™¨æ‰èƒ½è¯»åˆ°ã€‚å‚è€ƒå¼€å‘å·¥å…·é€‰å‹é‡Œé¢çš„maavenåŒ…ã€‚</p><p>åœ¨mavençš„confçš„settingçš„mirrorsé‡Œé¢è¿›è¡Œé…ç½®ï¼Œé…ç½®åï¼ŒJenkinsä¸‹è½½åŒ…ä¼šéå¸¸çš„å¿«ã€‚</p><mirror>    <id>alimaven</id>    <name>aliyun maven</name>    <url>http://maven.aliyun.com/nexus/content/groups/public/</url>    <mirrorOf>central</mirrorOf></mirror><h3 id="Dockerå®‰è£…Jenkins"><a href="#Dockerå®‰è£…Jenkins" class="headerlink" title="Dockerå®‰è£…Jenkins"></a>Dockerå®‰è£…Jenkins</h3><p>æœºå™¨ä¸Šè¦æœ‰ jdkï¼ŒæœåŠ¡å™¨å¯ä»¥æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y java-1.8.0-openjdk.x86_64</span><br></pre></td></tr></table></figure><p>jenkinså¼€å§‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker search jenkins</span><br><span class="line">docker pull jenkins/jenkins:2.414.2</span><br><span class="line">docker run -d -u root -p 8080:8080 -p 50000:50000 -v /var/jenkins_home:/var/jenkins_home -v /etc/localtime:/etc/localtime --name jenkins jenkins/jenkins:2.414.2</span><br><span class="line">docker start jenkins</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/07/10/M5EsQGFc1BZRXKO.png" alt="image-20240710183915242.png"></p><p>è¿™æ ·å°±æ˜¯å¯åŠ¨æˆåŠŸäº†ã€‚ç„¶åé€šè¿‡8080ç«¯å£è¿›è¡Œè®¿é—®ã€‚è®¿é—®çš„è¿‡ç¨‹ä¼šå¾ˆæ…¢ç­‰å¾…ä¸€ä¸‹ã€‚æœåŠ¡å™¨å†…å­˜æœ€å¥½å¤§ç‚¹ï¼Œå†…å­˜å°çš„å®¹æ˜“å¯åŠ¨ä¸èµ·æ¥ã€‚</p><p>é€šè¿‡logæ¥çœ‹ä¸€ä¸‹å¯†ç :</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs 67166b666c76</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/08/06/ikvAUXqgBdT3Yem.png" alt="image-20240710184049696.png"></p><p>è®¿é—®ä¹‹åï¼Œè¾“å…¥ä¸Šé¢çš„å¯†ç ã€‚</p><p>ç‚¹å‡»ç»§ç»­åï¼Œé€‰æ‹© æŒ‰ç…§æ¨èå®‰è£…æ’ä»¶ã€‚ç„¶åç»§ç»­ç­‰å¾…ã€‚</p><p><img src="https://s2.loli.net/2024/07/10/c47Sz8MmHEie1q9.png" alt="image-20240710184132391.png"></p><p>ç•Œé¢å¦‚ä¸‹ï¼š</p><p><img src="https://s2.loli.net/2024/07/10/Xth1ImGUkQxvTeN.png" alt="image-20240710184237761.png"></p><p><strong>æ–°å»ºä»»åŠ¡</strong></p><p>ä¸Šé¢è¾“å…¥ä»»åŠ¡åç§°ï¼Œä¸‹é¢é€‰æ‹©æ„å»ºè‡ªç”±é£æ ¼</p><p><img src="https://s2.loli.net/2024/07/10/3I4O7YSW8Xm9Cag.png" alt="image-20240710184414482.png"></p><p>é€‰æ‹©æºç ç®¡ç†ï¼Œé…ç½®mavenï¼Œæ³¨æ„ï¼šmavenä¸€å®šè¦æ”¾åˆ°Jenkinsçš„æ•°æ®æŒ‚è½½ç›®å½•å†…ï¼Œè¿™æ ·å®¹å™¨æ‰èƒ½è¯»åˆ°ã€‚</p><p><img src="https://s2.loli.net/2024/07/10/pXRAlrL3iSWkdMQ.png" alt="image-20240710184525082.png"></p><p><strong>é…ç½®sshæœåŠ¡å™¨</strong></p><p><img src="https://s2.loli.net/2024/07/10/Af3ZOncUWhbgRmy.png" alt="image-20240710184610325.png"></p><p><img src="https://s2.loli.net/2024/07/10/AdwqUtZPVxmolQb.png" alt="image-20240710184703520.png"></p><p>è®¾ç½®å¯†ç å³å¯ã€‚</p><p><strong>é…ç½®sshåˆ†å‘</strong></p><p><img src="https://s2.loli.net/2024/07/10/9vxsIKnEQPHNF7k.png" alt="image-20240710184752937.png"></p><p><strong>é…ç½®shellè„šæœ¬</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">cp /var/jenkins_home/workspace/programmer-club-subject/programmer-club-subject/programmer-club-starter/target/programmer-club-starter.jar /var/jenkins_home/jar/</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">APP_NAME=programmer-club-starter.jar</span><br><span class="line">LOG_NAME=programmer-club-starter.log</span><br><span class="line"></span><br><span class="line">pid=`ps -ef | grep $APP_NAME | grep -v grep|awk &#x27;&#123;print $2&#125;&#x27;`</span><br><span class="line"></span><br><span class="line">function is_exist()&#123;</span><br><span class="line">pid=`ps -ef | grep $APP_NAME | grep -v grep|awk &#x27;&#123;print $2&#125;&#x27;`</span><br><span class="line">if [ -z $&#123;pid&#125; ]; then</span><br><span class="line">String=&quot;notExist&quot;</span><br><span class="line">echo $String</span><br><span class="line">else</span><br><span class="line">String=&quot;exist&quot;</span><br><span class="line">echo $String</span><br><span class="line">fi</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">str=$(is_exist)</span><br><span class="line">if [ $&#123;str&#125; = &quot;exist&quot; ]; then</span><br><span class="line">echo &quot; æ£€æµ‹åˆ°å·²ç»å¯åŠ¨çš„ç¨‹åºï¼Œpid æ˜¯ $&#123;pid&#125; &quot;</span><br><span class="line">kill -9 $pid</span><br><span class="line">else</span><br><span class="line">echo &quot; ç¨‹åºæ²¡æœ‰å¯åŠ¨äº† &quot;</span><br><span class="line">echo &quot;$&#123;APP_NAME&#125; is not running&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">str=$(is_exist)</span><br><span class="line">if [ $&#123;str&#125; = &quot;exist&quot; ]; then</span><br><span class="line">echo &quot;$&#123;APP_NAME&#125; å·²ç»å¯åŠ¨äº†. pid=$&#123;pid&#125; .&quot;</span><br><span class="line">else</span><br><span class="line">source /etc/profile</span><br><span class="line">BUILD_ID=dontKillMe</span><br><span class="line">nohup java -Xms300m -Xmx300m -jar /var/jenkins_home/jar/$APP_NAME   &gt;$LOG_NAME 2&gt;&amp;1 &amp;</span><br><span class="line">echo &quot;ç¨‹åºå·²é‡æ–°å¯åŠ¨...&quot;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><h3 id="yumå®‰è£…JDK"><a href="#yumå®‰è£…JDK" class="headerlink" title="yumå®‰è£…JDK"></a>yumå®‰è£…JDK</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y java-1.8.0-openjdk.x86_64</span><br></pre></td></tr></table></figure><h3 id="Dockerå®‰è£…minioï¼Œæ­å»ºè‡ªå·±çš„ossæœåŠ¡å™¨"><a href="#Dockerå®‰è£…minioï¼Œæ­å»ºè‡ªå·±çš„ossæœåŠ¡å™¨" class="headerlink" title="Dockerå®‰è£…minioï¼Œæ­å»ºè‡ªå·±çš„ossæœåŠ¡å™¨"></a>Dockerå®‰è£…minioï¼Œæ­å»ºè‡ªå·±çš„ossæœåŠ¡å™¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search minio</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/07/10/iAn9flaIqCROozt.png" alt="image-20240710185255132.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">docker pull minio/minio</span><br><span class="line"></span><br><span class="line">docker run -p 9000:9000 -p 9090:9090 \</span><br><span class="line"> --name minio \</span><br><span class="line"> -d --restart=always \</span><br><span class="line"> -e &quot;MINIO_ACCESS_KEY=minioadmin&quot; \</span><br><span class="line"> -e &quot;MINIO_SECRET_KEY=minioadmin&quot; \</span><br><span class="line"> -v /mydata/minio/data:/data \</span><br><span class="line"> minio/minio server \</span><br><span class="line"> /data --console-address &quot;:9090&quot; -address &quot;:9000&quot;</span><br></pre></td></tr></table></figure><p>å¯åŠ¨åï¼Œè®¿é—®æœºå™¨ip+9090ï¼Œè¿›å…¥minioçš„ç•Œé¢ï¼Œè¾“å…¥ç”¨æˆ·åæˆ–å¯†ç åå¯ä»¥è®¿é—®ã€‚</p><p><img src="https://s2.loli.net/2024/07/10/g5FPeCrX4x1AbWd.png" alt="image-20240710185416658.png"></p><h4 id="Dockerå®‰è£…miniomcçªç ´7å¤©é™åˆ¶"><a href="#Dockerå®‰è£…miniomcçªç ´7å¤©é™åˆ¶" class="headerlink" title="Dockerå®‰è£…miniomcçªç ´7å¤©é™åˆ¶"></a>Dockerå®‰è£…miniomcçªç ´7å¤©é™åˆ¶</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">docker pull minio/mc</span><br><span class="line"></span><br><span class="line">docker run -it --entrypoint=/bin/sh minio/mc</span><br><span class="line"></span><br><span class="line">mc config host add &lt;ALIAS&gt; &lt;YOUR-S3-ENDPOINT&gt; &lt;YOUR-ACCESS-KEY&gt; &lt;YOUR-SECRET-KEY&gt; [--api API-SIGNATURE]</span><br><span class="line"></span><br><span class="line">mc config host add minio http://xxx.xx.xx.xxx:9000 GrVCPXySKgGoJiGgXmtv 0xlqSI9GXvnBOtp0GwUj5OshKNBk9JgwoexotbVV</span><br><span class="line"></span><br><span class="line">mc ls minio</span><br><span class="line"></span><br><span class="line">mc anonymous</span><br><span class="line"></span><br><span class="line">mc anonymous set download minio/jichi</span><br></pre></td></tr></table></figure><h3 id="DockeræŸ¥çœ‹è¿è¡Œå®¹å™¨å¯åŠ¨å‘½ä»¤"><a href="#DockeræŸ¥çœ‹è¿è¡Œå®¹å™¨å¯åŠ¨å‘½ä»¤" class="headerlink" title="DockeræŸ¥çœ‹è¿è¡Œå®¹å™¨å¯åŠ¨å‘½ä»¤"></a>DockeræŸ¥çœ‹è¿è¡Œå®¹å™¨å¯åŠ¨å‘½ä»¤</h3><p>å®‰è£…ä¸€ä¸ªå°å·¥å…· get_command_4_run_container</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker pull cucker/get_command_4_run_container</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä»¥nacosä¸ºä¾‹å­</span></span><br><span class="line">docker run --rm -v /var/run/docker.sock:/var/run/docker.sock cucker/get_command_4_run_container nacos</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°å¦‚ä¸‹çš„å¯åŠ¨å‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \ </span><br><span class="line">--name nacos \ </span><br><span class="line">--privileged \ </span><br><span class="line">--cgroupns host \ </span><br><span class="line">--env JVM_XMX=256m \ </span><br><span class="line">--env MODE=standalone \ </span><br><span class="line">--env JVM_XMS=256m \ </span><br><span class="line">-p 8848:8848/tcp \ </span><br><span class="line">-p 9848:9848/tcp \ </span><br><span class="line">--restart=always \ </span><br><span class="line">-w /home/nacos \ </span><br><span class="line">nacos/nacos-server</span><br></pre></td></tr></table></figure><h3 id="Dockerå®‰è£…nacos"><a href="#Dockerå®‰è£…nacos" class="headerlink" title="Dockerå®‰è£…nacos"></a>Dockerå®‰è£…nacos</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker search nacos</span><br><span class="line">docker pull nacos/nacos-server</span><br></pre></td></tr></table></figure><p>é•œåƒæ‹‰å®Œä¹‹åï¼Œå¯åŠ¨è„šæœ¬</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">  --name nacos \</span><br><span class="line">  --privileged  \</span><br><span class="line">  --cgroupns host \</span><br><span class="line">  --env JVM_XMX=256m \</span><br><span class="line"> --env MODE=standalone \</span><br><span class="line">  --env JVM_XMS=256m \</span><br><span class="line">  -p 8848:8848/tcp \</span><br><span class="line">  -p 9848:9848/tcp \</span><br><span class="line">  --restart=always \</span><br><span class="line">  -w /home/nacos \</span><br><span class="line">  nacos/nacos-server</span><br></pre></td></tr></table></figure><p>äº‘æœåŠ¡å™¨ä¸è¦å¿˜è®°æ‰“å¼€é˜²ç«å¢™ç«¯å£ã€‚</p><p>è®¿é—® ip åœ°å€+8848 &#x2F;nacos å³å¯è¿›å…¥æ§åˆ¶å°</p><p><img src="https://s2.loli.net/2024/07/17/omQFLlRk7htf5bB.png" alt="image-20240717151037534.png"></p><p>nacos çš„æ–‡æ¡£ï¼š<a href="https://nacos.io/zh-cn/docs/what-is-nacos.html">https://nacos.io/zh-cn/docs/what-is-nacos.html</a></p><p>nacos çš„æ¶æ„åŸç†ï¼š<a href="https://developer.aliyun.com/ebook/36?spm=a2c6h.20345107.ebook-index.18.152c2984fsi5ST">https://developer.aliyun.com/ebook/36?spm=a2c6h.20345107.ebook-index.18.152c2984fsi5ST</a></p><h3 id="Dockerå®‰è£…Redis"><a href="#Dockerå®‰è£…Redis" class="headerlink" title="Dockerå®‰è£…Redis"></a>Dockerå®‰è£…Redis</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker search redis</span><br><span class="line">docker pull redis</span><br></pre></td></tr></table></figure><p>æ‹‰ä¸‹é•œåƒä¹‹åï¼Œç‚¹å‡»ä¸‹é¢åœ°å€é€‰æ‹©è‡ªå·±éœ€è¦çš„ redis ç‰ˆæœ¬çš„é…ç½®æ–‡ä»¶</p><p><a href="https://redis.io/docs/management/config/">https://redis.io/docs/management/config/</a></p><p><img src="https://s2.loli.net/2024/07/17/QifoExYAU6VzSnt.png" alt="image-20240717151249025.png"></p><p>æå‰åœ¨æœåŠ¡å™¨å»ºç«‹ &#x2F;data&#x2F;redis æ–‡ä»¶å¤¹ï¼Œtouch æ–‡ä»¶redis.confï¼Œä¹Ÿå¯ä»¥ä¸Šé¢çš„ç›´æ¥å¤åˆ¶</p><p><code>redis.conf</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">protected-mode yes</span><br><span class="line">port 6379</span><br><span class="line">tcp-backlog 511</span><br><span class="line">timeout 0</span><br><span class="line">tcp-keepalive 300</span><br><span class="line">daemonize no</span><br><span class="line">pidfile /var/run/redis_6379.pid</span><br><span class="line">loglevel notice</span><br><span class="line">logfile &quot;&quot;</span><br><span class="line">databases 16</span><br><span class="line">always-show-logo no</span><br><span class="line">set-proc-title yes</span><br><span class="line">proc-title-template &quot;&#123;title&#125; &#123;listen-addr&#125; &#123;server-mode&#125;&quot;</span><br><span class="line">locale-collate &quot;&quot;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å¯åŠ¨å‘½ä»¤</span><br><span class="line">docker run -p 6379:6379 --name redis -v /data/redis/redis.conf:/etc/redis/redis.conf  -v /data/redis/data:/data -d redis redis-server /etc/redis/redis.conf --appendonly yes</span><br></pre></td></tr></table></figure><p>-p 6379:6379:æŠŠå®¹å™¨å†…çš„6379ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœº6379ç«¯å£ </p><p>-v &#x2F;data&#x2F;redis&#x2F;redis.conf:&#x2F;etc&#x2F;redis&#x2F;redis.confï¼šæŠŠå®¿ä¸»æœºé…ç½®å¥½çš„redis.confæ”¾åˆ°å®¹å™¨å†…çš„è¿™ä¸ªä½ç½®ä¸­ </p><p>-v &#x2F;data&#x2F;redis&#x2F;data:&#x2F;dataï¼šæŠŠredisæŒä¹…åŒ–çš„æ•°æ®åœ¨å®¿ä¸»æœºå†…æ˜¾ç¤ºï¼Œåšæ•°æ®å¤‡ä»½</p><p>redis-server &#x2F;etc&#x2F;redis&#x2F;redis.confï¼šè¿™ä¸ªæ˜¯å…³é”®é…ç½®ï¼Œè®©redisä¸æ˜¯æ— é…ç½®å¯åŠ¨ï¼Œè€Œæ˜¯æŒ‰ç…§è¿™ä¸ªredis.confçš„é…ç½®å¯åŠ¨ </p><p>â€“appendonly yesï¼šrediså¯åŠ¨åæ•°æ®æŒä¹…åŒ–</p><p>å·¥å…·ï¼šRedis Desktop Manager</p><p><strong>IDEAè¿æ¥rediså¯ä»¥ç›´æ¥ä¸‹è½½ plugin çš„ redis æ’ä»¶</strong></p><h3 id="Dockerå®‰è£…es"><a href="#Dockerå®‰è£…es" class="headerlink" title="Dockerå®‰è£…es"></a>Dockerå®‰è£…es</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">yum install -y yum-utils device-mapper-persistent-data lvm2</span><br><span class="line"></span><br><span class="line">docker search elasticsearch</span><br><span class="line"></span><br><span class="line">docker pull elasticsearch:7.3.1</span><br><span class="line"></span><br><span class="line">docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot;  -e ES_JAVA_OPTS=&quot;-Xms1024m -Xmx1024m&quot; 3d3aa92f641f</span><br></pre></td></tr></table></figure><p>å¯åŠ¨æˆåŠŸä¹‹åï¼Œè®¿é—®<a href="http://xxx.xx.xx.xxx:9200/">http://xxx.xx.xx.xxx:9200/</a></p><p><img src="https://s2.loli.net/2024/07/17/g9zDn8wIMPYakiS.png" alt="image-20240717151757675.png"></p><p>çœ‹åˆ°è¿™ä¸ªå°±è¯æ˜æˆåŠŸäº†ï¼</p><p>æ’ä»¶ï¼šes-head</p><h3 id="dockerå®‰è£…xxl-job"><a href="#dockerå®‰è£…xxl-job" class="headerlink" title="dockerå®‰è£…xxl-job"></a>dockerå®‰è£…xxl-job</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">docker search xxl-job</span><br><span class="line">docker pull xuxueli/xxl-job-admin:2.4.0</span><br><span class="line"></span><br><span class="line">docker run  -d \</span><br><span class="line">        -p 8088:8088\</span><br><span class="line">        -v /tool/xxl-job/logs:/data/applogs \</span><br><span class="line">        -v /tool/xxl-job/application.properties:/xxl-job/xxl-job-admin/src/main/resources/application.properties \</span><br><span class="line">        -e PARAMS=&quot;--server.port=8088\</span><br><span class="line">        --spring.datasource.url=jdbc:mysql://xxx.xx.xx.xxx:3306/xxl_job?useUnicode=true&amp;characterEncoding=UTF-8&amp;autoReconnect=true&amp;serverTimezone=Asia/Shanghai \</span><br><span class="line">        --spring.datasource.username=root \</span><br><span class="line">        --spring.datasource.password=Wing1Q2W#E&quot; \</span><br><span class="line">        --name xxl-job-admin  \</span><br><span class="line">xuxueli/xxl-job-admin:2.4.0</span><br></pre></td></tr></table></figure><h3 id="rocketmqå®‰è£…"><a href="#rocketmqå®‰è£…" class="headerlink" title="rocketmqå®‰è£…"></a>rocketmqå®‰è£…</h3><p>å®˜ç½‘åœ°å€ï¼š<a href="https://rocketmq.apache.org/">https://rocketmq.apache.org/</a></p><p>å®‰è£…åŒ…ä¸Šä¼ åˆ° linux çš„&#x2F;soft æ–‡ä»¶å¤¹ï¼Œæ²¡æœ‰æ­¤æ–‡ä»¶å¤¹ï¼Œå…ˆåˆ›å»ºï¼Œä¸è¿‡åœ¨ es çš„æ—¶å€™å·²ç»åˆ›å»ºè¿‡äº†ã€‚</p><p><img src="https://s2.loli.net/2024/07/17/eEKGOkDYhwJUHxT.png" alt="image-20240717152141331.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">yum install unzip  å¯ä»¥è§£å‹zipåŒ…çš„ä¾èµ–</span><br><span class="line">unzip rocketmq-all-4.8.0-bin-release.zip</span><br><span class="line">cd rocketmq-all-4.8.0-bin-release</span><br><span class="line">cd bin</span><br><span class="line">vim runserver.sh</span><br><span class="line">å°†å…¶ä¸­çš„xmxï¼Œxmsç­‰è¿›è¡Œä¿®æ”¹256mï¼Œå¼„å°ä¸€ç‚¹ï¼Œè®©æœåŠ¡å™¨ç”¨</span><br><span class="line">vim runbroker.sh</span><br><span class="line">åŒç†ä¿®æ”¹å…¶ä¸­çš„xmxï¼Œxmsç­‰è¿›è¡Œä¿®æ”¹256mï¼Œå¼„å°ä¸€ç‚¹ï¼Œè®©æœåŠ¡å™¨ç”¨</span><br><span class="line">nohup sh mqnamesrv &amp;</span><br><span class="line">tail -f ~/logs/rocketmqlogs/namesrv.log</span><br></pre></td></tr></table></figure><p>å¯åŠ¨broker</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export NAMESRV_ADDR=localhost:9876</span><br><span class="line">nohup sh mqbroker -n localhost:9876 &amp;</span><br><span class="line">tail -f ~/logs/rocketmqlogs/broker.log</span><br></pre></td></tr></table></figure><p>å‘é€æ¶ˆæ¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sh tools.sh org.apache.rocketmq.example.quickstart.Producer</span><br><span class="line">sh tools.sh org.apache.rocketmq.example.quickstart.Consumer</span><br></pre></td></tr></table></figure><p>å¦‚æœå‘é€æ¶ˆæ¯æŠ¥é”™ï¼Œå»ºç«‹æ–‡ä»¶å¤¹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd ~/store</span><br><span class="line">mkdir commitlog </span><br><span class="line">cd commitlog</span><br><span class="line">mkdir consumequeue</span><br></pre></td></tr></table></figure><p>å…³é—­</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sh bin/mqshutdown broker</span><br><span class="line">sh bin/mqshutdown namesrv</span><br></pre></td></tr></table></figure><p><strong>å®‰è£…æ§åˆ¶å°</strong></p><p><img src="https://s2.loli.net/2024/07/17/QmgKi1q86yeVaR3.png" alt="image-20240717152526211.png"></p><p>æ›´æ”¹ç«¯å£å’Œé…ç½®æ–‡ä»¶ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup java -Xms300m -Xmx300m -jar rocketmq-console.jar &gt; console.log &amp;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/07/17/QvTwp6AJcBnLKjV.png" alt="image-20240717152632964.png"></p><h2 id="ç¬¬ä¸€éƒ¨åˆ†"><a href="#ç¬¬ä¸€éƒ¨åˆ†" class="headerlink" title="ç¬¬ä¸€éƒ¨åˆ†"></a>ç¬¬ä¸€éƒ¨åˆ†</h2><h3 id="æ•°æ®åº“è¡¨"><a href="#æ•°æ®åº“è¡¨" class="headerlink" title="æ•°æ®åº“è¡¨"></a>æ•°æ®åº“è¡¨</h3><h4 id="æ•°æ®åº“è¡¨å»ºæ¨¡JSON"><a href="#æ•°æ®åº“è¡¨å»ºæ¨¡JSON" class="headerlink" title="æ•°æ®åº“è¡¨å»ºæ¨¡JSON"></a>æ•°æ®åº“è¡¨å»ºæ¨¡JSON</h4><p><strong>åˆ·é¢˜æ¨¡å—</strong></p><p><img src="https://s2.loli.net/2024/07/17/AE9ZyjdKSlap1tb.png" alt="image-20240717154028356.png"></p><p><strong>SQL</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `subject_radio`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `subject_radio`</span><br><span class="line">(</span><br><span class="line">    `id`             <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">    `subject_id`     <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é¢˜ç›®id&#x27;</span>,</span><br><span class="line">    `option_type`    tinyint(<span class="number">4</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;a,b,c,d&#x27;</span>,</span><br><span class="line">    `option_content` <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é€‰é¡¹å†…å®¹&#x27;</span>,</span><br><span class="line">    `is_correct`     tinyint(<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ˜¯å¦æ­£ç¡®&#x27;</span>,</span><br><span class="line">    `created_by`     <span class="type">varchar</span>(<span class="number">32</span>)  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºäºº&#x27;</span>,</span><br><span class="line">    `created_time`   datetime     <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    `update_by`      <span class="type">varchar</span>(<span class="number">32</span>)  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¿®æ”¹äºº&#x27;</span>,</span><br><span class="line">    `update_time`    datetime     <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¿®æ”¹æ—¶é—´&#x27;</span>,</span><br><span class="line">    `is_deleted`     <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 COMMENT<span class="operator">=</span><span class="string">&#x27;å•é€‰é¢˜ä¿¡æ¯è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `subject_multiple`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `subject_multiple`</span><br><span class="line">(</span><br><span class="line">    `id`             <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">    `subject_id`     <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é¢˜ç›®id&#x27;</span>,</span><br><span class="line">    `option_type`    <span class="type">bigint</span>(<span class="number">4</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é€‰é¡¹ç±»å‹&#x27;</span>,</span><br><span class="line">    `option_content` <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é€‰é¡¹å†…å®¹&#x27;</span>,</span><br><span class="line">    `is_correct`     tinyint(<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ˜¯å¦æ­£ç¡®&#x27;</span>,</span><br><span class="line">    `created_by`     <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºäºº&#x27;</span>,</span><br><span class="line">    `created_time`   datetime    <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    `update_by`      <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°äºº&#x27;</span>,</span><br><span class="line">    `update_time`    datetime    <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">    `is_deleted`     <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 COMMENT<span class="operator">=</span><span class="string">&#x27;å¤šé€‰é¢˜ä¿¡æ¯è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `subject_mapping`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `subject_mapping`</span><br><span class="line">(</span><br><span class="line">    `id`           <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">    `subject_id`   <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é¢˜ç›®id&#x27;</span>,</span><br><span class="line">    `category_id`  <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ†ç±»id&#x27;</span>,</span><br><span class="line">    `label_id`     <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ ‡ç­¾id&#x27;</span>,</span><br><span class="line">    `created_by`   <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºäºº&#x27;</span>,</span><br><span class="line">    `created_time` datetime    <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    `update_by`    <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¿®æ”¹äºº&#x27;</span>,</span><br><span class="line">    `update_time`  datetime    <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¿®æ”¹æ—¶é—´&#x27;</span>,</span><br><span class="line">    `is_deleted`   <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">536</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 COMMENT<span class="operator">=</span><span class="string">&#x27;é¢˜ç›®åˆ†ç±»å…³ç³»è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `subject_liked`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `subject_liked`</span><br><span class="line">(</span><br><span class="line">    `id`           <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">    `subject_id`   <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é¢˜ç›®id&#x27;</span>,</span><br><span class="line">    `like_user_id` <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">COLLATE</span> utf8mb4_bin <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç‚¹èµäººid&#x27;</span>,</span><br><span class="line">    `status`       <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç‚¹èµçŠ¶æ€ 1ç‚¹èµ 0ä¸ç‚¹èµ&#x27;</span>,</span><br><span class="line">    `created_by`   <span class="type">varchar</span>(<span class="number">32</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºäºº&#x27;</span>,</span><br><span class="line">    `created_time` datetime                        <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    `update_by`    <span class="type">varchar</span>(<span class="number">32</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¿®æ”¹äºº&#x27;</span>,</span><br><span class="line">    `update_time`  datetime                        <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¿®æ”¹æ—¶é—´&#x27;</span>,</span><br><span class="line">    `is_deleted`   <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">    <span class="keyword">UNIQUE</span> KEY `uniq_like` (`subject_id`,`like_user_id`) <span class="keyword">USING</span> BTREE COMMENT <span class="string">&#x27;ç‚¹èµå”¯ä¸€ç´¢å¼•&#x27;</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_bin COMMENT<span class="operator">=</span><span class="string">&#x27;é¢˜ç›®ç‚¹èµè¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `subject_label`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `subject_label`</span><br><span class="line">(</span><br><span class="line">    `id`           <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">    `label_name`   <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ ‡ç­¾åˆ†ç±»&#x27;</span>,</span><br><span class="line">    `sort_num`     <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ’åº&#x27;</span>,</span><br><span class="line">    `category_id`  <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    `created_by`   <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºäºº&#x27;</span>,</span><br><span class="line">    `created_time` datetime    <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    `update_by`    <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°äºº&#x27;</span>,</span><br><span class="line">    `update_time`  datetime    <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">    `is_deleted`   <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">64</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 COMMENT<span class="operator">=</span><span class="string">&#x27;é¢˜ç›®æ ‡ç­¾è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `subject_judge`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `subject_judge`</span><br><span class="line">(</span><br><span class="line">    `id`           <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">    `subject_id`   <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é¢˜ç›®id&#x27;</span>,</span><br><span class="line">    `is_correct`   tinyint(<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ˜¯å¦æ­£ç¡®&#x27;</span>,</span><br><span class="line">    `created_by`   <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºäºº&#x27;</span>,</span><br><span class="line">    `created_time` datetime    <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    `update_by`    <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°äºº&#x27;</span>,</span><br><span class="line">    `update_time`  datetime    <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">    `is_deleted`   <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 COMMENT<span class="operator">=</span><span class="string">&#x27;åˆ¤æ–­é¢˜&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `subject_info`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `subject_info`</span><br><span class="line">(</span><br><span class="line">    `id`                <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">    `subject_name`      <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é¢˜ç›®åç§°&#x27;</span>,</span><br><span class="line">    `subject_difficult` tinyint(<span class="number">4</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é¢˜ç›®éš¾åº¦&#x27;</span>,</span><br><span class="line">    `settle_name`       <span class="type">varchar</span>(<span class="number">32</span>)  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å‡ºé¢˜äººå&#x27;</span>,</span><br><span class="line">    `subject_type`      tinyint(<span class="number">4</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é¢˜ç›®ç±»å‹ 1å•é€‰ 2å¤šé€‰ 3åˆ¤æ–­ 4ç®€ç­”&#x27;</span>,</span><br><span class="line">    `subject_score`     tinyint(<span class="number">4</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é¢˜ç›®åˆ†æ•°&#x27;</span>,</span><br><span class="line">    `subject_parse`     <span class="type">varchar</span>(<span class="number">512</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é¢˜ç›®è§£æ&#x27;</span>,</span><br><span class="line">    `created_by`        <span class="type">varchar</span>(<span class="number">32</span>)  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºäºº&#x27;</span>,</span><br><span class="line">    `created_time`      datetime     <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    `update_by`         <span class="type">varchar</span>(<span class="number">32</span>)  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¿®æ”¹äºº&#x27;</span>,</span><br><span class="line">    `update_time`       datetime     <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¿®æ”¹æ—¶é—´&#x27;</span>,</span><br><span class="line">    `is_deleted`        <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">327</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 COMMENT<span class="operator">=</span><span class="string">&#x27;é¢˜ç›®ä¿¡æ¯è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `subject_category`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `subject_category`</span><br><span class="line">(</span><br><span class="line">    `id`            <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">    `category_name` <span class="type">varchar</span>(<span class="number">16</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ†ç±»åç§°&#x27;</span>,</span><br><span class="line">    `category_type` tinyint(<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ†ç±»ç±»å‹&#x27;</span>,</span><br><span class="line">    `image_url`     <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å›¾æ ‡è¿æ¥&#x27;</span>,</span><br><span class="line">    `parent_id`     <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;çˆ¶çº§id&#x27;</span>,</span><br><span class="line">    `created_by`    <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºäºº&#x27;</span>,</span><br><span class="line">    `created_time`  datetime    <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    `update_by`     <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°äºº&#x27;</span>,</span><br><span class="line">    `update_time`   datetime    <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">    `is_deleted`    tinyint(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;æ˜¯å¦åˆ é™¤ 0: æœªåˆ é™¤ 1: å·²åˆ é™¤&#x27;</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">12</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 COMMENT<span class="operator">=</span><span class="string">&#x27;é¢˜ç›®åˆ†ç±»&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `subject_brief`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `subject_brief`</span><br><span class="line">(</span><br><span class="line">    `id`             <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">    `subject_id`     <span class="type">int</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é¢˜ç›®id&#x27;</span>,</span><br><span class="line">    `subject_answer` text COMMENT <span class="string">&#x27;é¢˜ç›®ç­”æ¡ˆ&#x27;</span>,</span><br><span class="line">    `created_by`     <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºäºº&#x27;</span>,</span><br><span class="line">    `created_time`   datetime    <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    `update_by`      <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°äºº&#x27;</span>,</span><br><span class="line">    `update_time`    datetime    <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">    `is_deleted`     <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">280</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 COMMENT<span class="operator">=</span><span class="string">&#x27;ç®€ç­”é¢˜&#x27;</span>;</span><br></pre></td></tr></table></figure><h4 id="åˆ·é¢˜æ¨¡å—æ•°æ®æ¨¡å‹"><a href="#åˆ·é¢˜æ¨¡å—æ•°æ®æ¨¡å‹" class="headerlink" title="åˆ·é¢˜æ¨¡å—æ•°æ®æ¨¡å‹"></a>åˆ·é¢˜æ¨¡å—æ•°æ®æ¨¡å‹</h4><p><img src="https://s2.loli.net/2024/07/17/V8iKD6RWFCJHUab.png" alt="image-20240717162213876.png"></p><p><img src="https://s2.loli.net/2024/07/17/9I7ol1eVBZm3NvA.png" alt="image-20240717154416885.png"><br><img src="https://s2.loli.net/2024/07/17/nbR4qgoGCBw93ik.png" alt="image-20240717154425945.png"><br><img src="https://s2.loli.net/2024/07/17/iYCKuszXPJmLG5t.png" alt="image-20240717154441135.png"><br><img src="https://s2.loli.net/2024/07/17/cuG26enxkZCDtps.png" alt="image-20240717162527674.png"><br><img src="https://s2.loli.net/2024/07/17/KZSErI4H5tVxn2k.png" alt="image-20240717162448319.png"><br><img src="https://s2.loli.net/2024/07/17/V2PGpheKlCJ1Dfw.png" alt="image-20240717154448206.png"><br><img src="https://s2.loli.net/2024/07/17/b85pTjQCnKoW2VB.png" alt="image-20240717154500698.png"></p><p><strong>é‰´æƒæ¨¡å—</strong></p><h3 id="1-åˆ·é¢˜æ¨¡å—ï¼ˆå¾®æœåŠ¡æ¨¡å—ï¼‰"><a href="#1-åˆ·é¢˜æ¨¡å—ï¼ˆå¾®æœåŠ¡æ¨¡å—ï¼‰" class="headerlink" title="1.åˆ·é¢˜æ¨¡å—ï¼ˆå¾®æœåŠ¡æ¨¡å—ï¼‰"></a>1.åˆ·é¢˜æ¨¡å—ï¼ˆå¾®æœåŠ¡æ¨¡å—ï¼‰</h3><p><img src="https://s2.loli.net/2024/07/17/wl4dD9uVb1gnAtB.png" alt="image-20240717163944712.png"></p><p>starterç±»æ˜¯ç”¨äºæ”¾ç½®æ•´ä¸ªé¡¹ç›®çš„å¯åŠ¨ç±»çš„</p><h4 id="äº§å“åŠŸèƒ½æ¨¡å—"><a href="#äº§å“åŠŸèƒ½æ¨¡å—" class="headerlink" title="äº§å“åŠŸèƒ½æ¨¡å—"></a>äº§å“åŠŸèƒ½æ¨¡å—</h4><p><img src="https://s2.loli.net/2024/07/10/weDZpG3xrbvXtnV.png" alt="image-20240710164145589.png"></p><h4 id="ç ”å‘åŠŸèƒ½æ¨¡å—æ‹†åˆ†"><a href="#ç ”å‘åŠŸèƒ½æ¨¡å—æ‹†åˆ†" class="headerlink" title="ç ”å‘åŠŸèƒ½æ¨¡å—æ‹†åˆ†"></a>ç ”å‘åŠŸèƒ½æ¨¡å—æ‹†åˆ†</h4><p><img src="https://s2.loli.net/2024/07/10/xjnVqWl3YUD97AB.png" alt="image-20240710164949102.png"></p><h4 id="åŸå‹è®¾è®¡"><a href="#åŸå‹è®¾è®¡" class="headerlink" title="åŸå‹è®¾è®¡"></a>åŸå‹è®¾è®¡</h4><p>axrue+antdesignçš„ç»„ä»¶åº“</p><h5 id="åˆ·é¢˜é¦–é¡µ"><a href="#åˆ·é¢˜é¦–é¡µ" class="headerlink" title="åˆ·é¢˜é¦–é¡µ"></a>åˆ·é¢˜é¦–é¡µ</h5><p><img src="https://s2.loli.net/2024/07/10/mLyW9JI56dVsefR.png" alt="image-20240710165032544.png"></p><h5 id="é¢˜ç›®è¯¦æƒ…"><a href="#é¢˜ç›®è¯¦æƒ…" class="headerlink" title="é¢˜ç›®è¯¦æƒ…"></a>é¢˜ç›®è¯¦æƒ…</h5><p><img src="https://s2.loli.net/2024/07/10/s5GYPwTHDFv6pe3.png" alt="image-20240710165319312.png"></p><h4 id="åˆ†ç±»æ¨¡å—"><a href="#åˆ†ç±»æ¨¡å—" class="headerlink" title="åˆ†ç±»æ¨¡å—"></a>åˆ†ç±»æ¨¡å—</h4><p><img src="https://s2.loli.net/2024/07/10/OQNz3dAREaLeyTm.png" alt="image-20240710174638222.png"></p><p><strong>åˆ†ç±»çš„æ¦‚å¿µæ˜¯é¢è¯•é¢˜çš„å¤§ç±»ã€‚å…¶ä¸­æˆ‘ä»¬æœ‰ä¸¤ç§æ¦‚å¿µï¼š</strong></p><ol><li><strong>ä¸€ç§æ˜¯å²—ä½åˆ†ç±»ï¼Œä¾‹å¦‚åç«¯ï¼Œå‰ç«¯ï¼Œæµ‹è¯•ã€‚</strong></li><li><strong>ä¸€ç§æ˜¯å²—ä½ä¸‹ç»†åˆ†çš„åˆ†ç±»ï¼Œæ¯”å¦‚åç«¯ä¸‹ç»†åˆ†ï¼Œæ¡†æ¶ï¼Œå¹¶å‘ï¼Œé›†åˆç­‰ç­‰ã€‚</strong></li></ol><h5 id="æ–°å¢åˆ†ç±»"><a href="#æ–°å¢åˆ†ç±»" class="headerlink" title="æ–°å¢åˆ†ç±»"></a>æ–°å¢åˆ†ç±»</h5><p>æ­£å¸¸çš„ä¸šåŠ¡é€»è¾‘ï¼Œä¿è¯æ–°å¢åï¼Œå¯ä»¥æ­£å¸¸çš„æ’å…¥æ•°æ®åº“å³å¯ã€‚</p><h5 id="ä¿®æ”¹åˆ†ç±»"><a href="#ä¿®æ”¹åˆ†ç±»" class="headerlink" title="ä¿®æ”¹åˆ†ç±»"></a>ä¿®æ”¹åˆ†ç±»</h5><p>crud</p><h5 id="åˆ é™¤åˆ†ç±»"><a href="#åˆ é™¤åˆ†ç±»" class="headerlink" title="åˆ é™¤åˆ†ç±»"></a>åˆ é™¤åˆ†ç±»</h5><p>crud</p><h5 id="é¦–é¡µçš„åˆ†ç±»"><a href="#é¦–é¡µçš„åˆ†ç±»" class="headerlink" title="é¦–é¡µçš„åˆ†ç±»"></a>é¦–é¡µçš„åˆ†ç±»</h5><p>å¯ä»¥æ‰©å±•åšæˆåšæˆç¼“å­˜ï¼Œä¸æ˜“å˜çš„æ•°æ®ï¼Œç›´æ¥ä»redisæŸ¥ç¼“å­˜ã€‚</p><p>ç¼“å­˜é¢„çƒ­è¿™ç§ï¼Œå¯åŠ¨é¡¹ç›®ä¹‹åï¼Œæ‰”è¿›å»ã€‚</p><p>ç›®å‰åšæˆä¸²è¡ŒåŒ–çš„ï¼ŒäºŒæœŸå¯ä»¥ä¼˜åŒ–ï¼Œç”±å‰ç«¯å…ˆæŸ¥è¯¢å²—ä½å¤§ç±»ï¼Œç„¶åå†æ ¹æ®å¤§ç±»æŸ¥è¯¢å°ç±»ã€‚</p><h4 id="æ ‡ç­¾è¯¦ç»†è®¾è®¡"><a href="#æ ‡ç­¾è¯¦ç»†è®¾è®¡" class="headerlink" title="æ ‡ç­¾è¯¦ç»†è®¾è®¡"></a>æ ‡ç­¾è¯¦ç»†è®¾è®¡</h4><p>æ ‡ç­¾çš„æ¦‚å¿µæ˜¯åˆ†ç±»ä¸‹çš„ç»†åˆ†ã€‚æ ‡ç­¾æ˜¯é€šç”¨æ€§çš„ï¼Œç‹¬ç«‹çš„ä¸ªä½“ï¼Œä¸åˆ†ç±»ä¸è¿›è¡Œå¼ºè€¦åˆï¼Œå’Œé¢˜ç›®ç›¸å…³ã€‚æ ‡ç­¾å’Œåˆ†ç±»æ˜¯å…¬ç”¨çš„ï¼Œå¤šä¸ªåˆ†ç±»å¯ä»¥å¯¹åº”åŒä¸€ä¸ªæ ‡ç­¾ã€‚</p><h5 id="æ–°å¢æ ‡ç­¾"><a href="#æ–°å¢æ ‡ç­¾" class="headerlink" title="æ–°å¢æ ‡ç­¾"></a>æ–°å¢æ ‡ç­¾</h5><p>crud ç›´æ¥çœ‹ä»£ç </p><h5 id="ä¿®æ”¹æ ‡ç­¾"><a href="#ä¿®æ”¹æ ‡ç­¾" class="headerlink" title="ä¿®æ”¹æ ‡ç­¾"></a>ä¿®æ”¹æ ‡ç­¾</h5><p>crud</p><h5 id="åˆ é™¤æ ‡ç­¾"><a href="#åˆ é™¤æ ‡ç­¾" class="headerlink" title="åˆ é™¤æ ‡ç­¾"></a>åˆ é™¤æ ‡ç­¾</h5><p>crud</p><h5 id="æ ‡ç­¾æŸ¥è¯¢"><a href="#æ ‡ç­¾æŸ¥è¯¢" class="headerlink" title="æ ‡ç­¾æŸ¥è¯¢"></a>æ ‡ç­¾æŸ¥è¯¢</h5><p>æ ¹æ®åˆ†ç±»å»æŸ¥è¯¢æ ‡ç­¾ï¼Œè¦é€šè¿‡é¢˜ç›®ä¿¡æ¯çš„å…³è”è¡¨æ¥è¿›è¡ŒæŸ¥è¯¢ã€‚è¯¦ç»†çœ‹ä»£ç </p><p>ä»¥ä¸ŠåŠŸèƒ½æ¶‰åŠåˆ° subject_label è¡¨</p><p><img src="https://s2.loli.net/2024/07/10/omhFSeL9tyZRjVJ.png" alt="7yCAHGEJegnk5NF[1].png"></p><h4 id="é¢˜ç›®æ¨¡å—"><a href="#é¢˜ç›®æ¨¡å—" class="headerlink" title="é¢˜ç›®æ¨¡å—"></a>é¢˜ç›®æ¨¡å—</h4><p><img src="https://s2.loli.net/2024/07/10/MLmSYUluqyNp1sz.png" alt="image-20240710174839950.png"></p><p>é¢˜ç›®åˆ†ä¸ºå•é€‰ï¼Œå¤šé€‰ï¼Œåˆ¤æ–­ï¼Œç®€å•ï¼Œå››ç§æ•°æ®ç±»å‹ï¼Œåœ¨è®¾è®¡æ•°æ®çš„æ—¶å€™ï¼Œæ‹†åˆ†æˆäº†é¢˜ç›®çš„ä¸»è¡¨å’Œå…¶ä»–å¯¹åº”çš„è¡¨æ¥åšã€‚</p><h5 id="æ–°å¢é¢˜ç›®"><a href="#æ–°å¢é¢˜ç›®" class="headerlink" title="æ–°å¢é¢˜ç›®"></a>æ–°å¢é¢˜ç›®</h5><p>æ³¨æ„ï¼šé‡‡å–å·¥å‚+ç­–ç•¥çš„æ¨¡å¼å»åšæ‰©å±•ï¼Œç°åœ¨æœ‰å››ç§é¢˜å‹ï¼Œæœªæ¥æ— è®ºåŠ å¤šå°‘ç§ï¼Œéƒ½å¯ä»¥ä¸ç”¨åŠ¨ä¸»æµç¨‹ã€‚</p><p>åæœŸä¼šç»“åˆes åšé¢˜ç›®çš„æŸ¥é‡ã€‚ä¸ºæœç´¢åšå‡†å¤‡ã€‚</p><h5 id="ä¿®æ”¹é¢˜ç›®"><a href="#ä¿®æ”¹é¢˜ç›®" class="headerlink" title="ä¿®æ”¹é¢˜ç›®"></a>ä¿®æ”¹é¢˜ç›®</h5><p>crud</p><h5 id="åˆ é™¤é¢˜ç›®"><a href="#åˆ é™¤é¢˜ç›®" class="headerlink" title="åˆ é™¤é¢˜ç›®"></a>åˆ é™¤é¢˜ç›®</h5><p>è¦æ³¨æ„åˆ é™¤ä¸»è¡¨çš„åŒæ—¶ï¼Œä¹ŸæŠŠå…¶ä»–çš„ç»†åˆ†çš„æ•°æ®è¡¨è¿›è¡ŒåŒæ­¥çš„å¤„ç†ã€‚</p><h5 id="é¢˜ç›®åˆ—è¡¨"><a href="#é¢˜ç›®åˆ—è¡¨" class="headerlink" title="é¢˜ç›®åˆ—è¡¨"></a>é¢˜ç›®åˆ—è¡¨</h5><p>éš¾åº¦ä¸å¤§ï¼Œå°±æ˜¯ä¸ªç®€å•çš„åˆ†é¡µçš„æŸ¥è¯¢ï¼Œåˆ†ç±»ã€æ ‡ç­¾ï¼Œéš¾åº¦è¿™äº›å…¶å®éƒ½æ˜¯å…¥å‚çš„åœºæ™¯ã€‚</p><p>æŸ¥æ ‡ç­¾ï¼Œéš¾åº¦å•Šï¼Œå‡ºé¢˜äººå•Šï¼Œç­‰ç­‰ï¼Œè¿™äº›å°±ç›´æ¥æŸ¥ï¼Œä¸åšjoinã€‚</p><h5 id="é¢˜ç›®çš„è¯¦æƒ…"><a href="#é¢˜ç›®çš„è¯¦æƒ…" class="headerlink" title="é¢˜ç›®çš„è¯¦æƒ…"></a>é¢˜ç›®çš„è¯¦æƒ…</h5><p>ä¹Ÿåšä¸€ä¸‹å·¥å‚+ç­–ç•¥å§</p><p>æ­¤åŠŸèƒ½æ¶‰åŠå¦‚ä¸‹æ•°æ®è¡¨</p><p><img src="https://s2.loli.net/2024/07/10/x2aCvEXZFSIl6N7.png" alt="image-20240710171403151.png"></p><h4 id="åˆ·é¢˜æ¨¡å—ä»£ç çš„å®ç°ï¼ˆjc-club-subjectï¼‰"><a href="#åˆ·é¢˜æ¨¡å—ä»£ç çš„å®ç°ï¼ˆjc-club-subjectï¼‰" class="headerlink" title="åˆ·é¢˜æ¨¡å—ä»£ç çš„å®ç°ï¼ˆjc-club-subjectï¼‰"></a>åˆ·é¢˜æ¨¡å—ä»£ç çš„å®ç°ï¼ˆjc-club-subjectï¼‰</h4><h5 id="applicationå±‚çš„SubjectControllerï¼ˆåº”ç”¨å±‚åˆæ¢-SpringMVCé›†æˆï¼‰"><a href="#applicationå±‚çš„SubjectControllerï¼ˆåº”ç”¨å±‚åˆæ¢-SpringMVCé›†æˆï¼‰" class="headerlink" title="applicationå±‚çš„SubjectControllerï¼ˆåº”ç”¨å±‚åˆæ¢&amp;SpringMVCé›†æˆï¼‰"></a>applicationå±‚çš„SubjectControllerï¼ˆåº”ç”¨å±‚åˆæ¢&amp;SpringMVCé›†æˆï¼‰</h5><p>åœ¨<code>jc-club-subject</code>ä¸­çš„<code>jc-club-application-controller</code>ä¸­çš„<code>controller</code>æ¨¡å—ä¸‹é¢å»ºç«‹<code>SubjectController.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.subject.application.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ·é¢˜controller</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/subject&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectController</span> &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/test&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™é‡Œç»™å‡ºçš„æµ‹è¯•ä»£ç å¦‚ä¸Šã€‚</p><p>åœ¨<code>jc-club-subject</code>ä¸­çš„<code>jc-club-starter</code>åŒ…ä¸­æœ‰<code>SubjectApplication.java</code>ä½œä¸ºå¯åŠ¨ç±»,å¹¶ä¸”éœ€è¦ä¿®æ”¹<code>pom.xml</code>ä¸­çš„å†…å®¹ï¼Œè®©å¯åŠ¨ç±»èƒ½å¤Ÿè®¿é—®åˆ°<code>jc-club-application-controller</code>ä¸­çš„ä»£ç å†…å®¹ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">//jc-club-starterçš„pom.xml,åœ¨starterä¸­å…³äºå¯åŠ¨çš„é…ç½®æ˜¯å†™åœ¨resourcesä¸­çš„application.ymlæ–‡ä»¶ä¸­çš„ï¼ŒåŒ…è£¹æ•°æ®åº“è¿æ¥,redisç­‰ç­‰</span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-application-controller<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SubjectApplication.java å¯åŠ¨ç±»</span></span><br><span class="line"><span class="keyword">package</span> com.jingdianjichi.subject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.annotation.MapperScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.openfeign.EnableFeignClients;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ·é¢˜å¾®æœåŠ¡å¯åŠ¨ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: ChickenWing</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2023/10/1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.jingdianjichi&quot;)</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.jingdianjichi.**.mapper&quot;)</span></span><br><span class="line"><span class="meta">@EnableFeignClients(basePackages = &quot;com.jingdianjichi&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectApplication</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(SubjectApplication.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è®°å¾—maven install</p><h5 id="mysql-druid-mybatisé›†æˆ-infrastructureå±‚"><a href="#mysql-druid-mybatisé›†æˆ-infrastructureå±‚" class="headerlink" title="mysql,druid,mybatisé›†æˆ(infrastructureå±‚)"></a>mysql,druid,mybatisé›†æˆ(infrastructureå±‚)</h5><p><a href="https://blog.csdn.net/Bb15070047748/article/details/107188167/?ops_request_misc=&request_id=&biz_id=102&utm_term=&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-107188167.nonecase&spm=1018.2226.3001.4187#{}&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-107188167.nonecase">å½»åº•ææ‡‚MyBaitsä¸­#{}å’Œ${}çš„åŒºåˆ«_mybatis #{}-CSDNåšå®¢</a></p><p>åœ¨<code>jc-club-subject</code>ä¸­çš„<code>jc-club-infra</code>åŒ…ä¸­</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">//pom.xml</span><br><span class="line"> <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- jdbcStarter --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- druidè¿æ¥æ±  --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.22<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- mysql --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.22<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- mybatisplus --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åš<strong>subject_category</strong>è¿™ä¸ªæ¨¡å—</p><p>ç”¨IDEAè‡ªå¸¦æ˜¯æ•°æ®åº“å·¥å…·å»è¿ä¸ŠMySQL</p><p><img src="https://s2.loli.net/2024/07/20/fDcwKd4ak8NtzXj.png" alt="image-20240720131302130.png"></p><p><img src="https://s2.loli.net/2024/07/20/HANolc9JDCsXFhy.png" alt="image-20240720131412700.png"><br>è”ä¸Šæ•°æ®åº“åï¼Œå³é”®categoryè¡¨ï¼Œç„¶åEazycodeï¼Œé€‰æ‹©ç›®å½•ï¼Œæ”¾åœ¨<code>jc-club-infra</code>åŒ…ä¸‹çš„basicç›®å½•ä¸­ï¼Œ<code>template</code>é€‰æ‹©<code>mapper.xml.vm, dao.java.vm, entity.java.vm, service.java.vm, serviceImpl.java.vm</code>(ä¸‹é¢ä¸¤å¼ å›¾æ˜¯é¡¹ç›®ç»“æŸåå®Œæ•´çš„æˆªå›¾ï¼Œè¿™é‡Œå°±æ¶‰åŠåˆ°äº†mybatis)</p><p><img src="https://s2.loli.net/2024/07/20/sYgHreQo5bGAaxq.png" alt="image-20240720132232428.png"></p><p><img src="https://s2.loli.net/2024/07/20/y4JMCVFKU3uv2lf.png" alt="image-20240720132254642.png"></p><p><a href="https://blog.csdn.net/quest101/article/details/105624322?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172154711316800226546866%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=172154711316800226546866&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-105624322-null-null.142">https://blog.csdn.net/quest101/article/details/105624322?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522172154711316800226546866%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&amp;request_id=172154711316800226546866&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-105624322-null-null.142</a></p><p>[mybatis-pluså…³äº@Mapperã€@Repositoryã€@MapperScanã€xmlæ–‡ä»¶çš„ç›¸å…³é—®é¢˜_mybatisplus repository-CSDNåšå®¢](<a href="https://blog.csdn.net/qq_41428418/article/details/132575881?ops_request_misc=&request_id=&biz_id=102&utm_term=mapperscan">https://blog.csdn.net/qq_41428418/article/details/132575881?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=mapperscan</a> resulttype&#x3D;&amp;utm_medium&#x3D;distribute.pc_search_result.none-task-blog-2<del>all</del>sobaiduweb~default-1-132575881.142^v100^pc_search_result_base8&amp;spm&#x3D;1018.2226.3001.4187)</p><p>ç»§ç»­åœ¨<code>jc-club-starter</code>æ¨¡å—çš„<code>pom.xml</code>ä¸­å¼•å…¥å½“å‰çš„<code>jc-club-infra</code>æ¨¡å—</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">//jc-club-starterçš„pom.xml</span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-application-controller<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-infra<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨<code>jc-club-subject</code>ä¸­çš„<code>jc-club-starter</code>ä¸­çš„<code>resources</code>ä¸­çš„<code>application.yml</code>ä¸­ï¼Œå®šä¹‰äº†æœåŠ¡å™¨å’Œæ•°æ®æºçš„é…ç½®ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="string">port:3000</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">123456</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/jc-club?serverTimezone=Asia/Shanghai&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=true</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line">    <span class="attr">druid:</span></span><br><span class="line">      <span class="attr">initial-size:</span> <span class="number">20</span></span><br><span class="line">      <span class="attr">min-idle:</span> <span class="number">20</span></span><br><span class="line">      <span class="attr">max-active:</span> <span class="number">100</span></span><br><span class="line">      <span class="attr">max-wait:</span> <span class="number">60000</span></span><br><span class="line">      <span class="attr">stat-view-servlet:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">url-pattern:</span> <span class="string">/druid/*</span></span><br><span class="line">        <span class="attr">login-username:</span> <span class="string">admin</span></span><br><span class="line">        <span class="attr">login-password:</span> <span class="number">123456</span></span><br><span class="line">      <span class="attr">filter:</span></span><br><span class="line">        <span class="attr">stat:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">slow-sql-millis:</span> <span class="number">2000</span></span><br><span class="line">          <span class="attr">log-slow-sql:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">wall:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><ul><li><p><code>server</code>: å®šä¹‰äº†æœåŠ¡å™¨çš„é…ç½®ã€‚</p><ul><li><code>port</code>: æŒ‡å®šäº†æœåŠ¡å™¨è¿è¡Œçš„ç«¯å£å·ï¼Œè¿™é‡Œæ˜¯ <code>3000</code>ã€‚</li></ul></li><li><p><code>spring</code>: åŒ…å«äº†Springæ¡†æ¶çš„é…ç½®ã€‚</p><ul><li><code>datasource</code>: å®šä¹‰äº†æ•°æ®æºçš„é…ç½®ï¼Œç”¨äºæ•°æ®åº“è¿æ¥ã€‚<ul><li><code>username</code>: æ•°æ®åº“çš„ç”¨æˆ·åï¼Œè¿™é‡Œæ˜¯ <code>root</code>ã€‚</li><li><code>password</code>: æ•°æ®åº“çš„å¯†ç ï¼Œè¿™é‡Œæ˜¯ <code>123456</code>ã€‚</li><li><code>driver-class-name</code>: MySQLæ•°æ®åº“é©±åŠ¨çš„ç±»åã€‚</li><li><code>url</code>: æ•°æ®åº“çš„è¿æ¥URLï¼ŒåŒ…æ‹¬æ•°æ®åº“åœ°å€ã€ç«¯å£ã€æ•°æ®åº“åä»¥åŠä¸€äº›è¿æ¥å‚æ•°ã€‚è¿™é‡Œçš„URLè¡¨æ˜è¿æ¥åˆ°æœ¬åœ°çš„MySQLæœåŠ¡å™¨ä¸Šçš„ <code>jc-club</code> æ•°æ®åº“ï¼Œå¹¶ä¸”æŒ‡å®šäº†æ—¶åŒºã€å­—ç¬¦ç¼–ç å’ŒSSLçš„ä½¿ç”¨ã€‚</li><li><code>type</code>: æŒ‡å®šäº†æ•°æ®æºçš„ç±»å‹ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯é˜¿é‡Œå·´å·´çš„Druidè¿æ¥æ± ã€‚</li><li><code>druid</code>: Druidè¿æ¥æ± çš„ç‰¹å®šé…ç½®ã€‚<ul><li><code>initial-size</code>: è¿æ¥æ± çš„åˆå§‹å¤§å°ï¼Œè¿™é‡Œæ˜¯ <code>20</code>ã€‚</li><li><code>min-idle</code>: è¿æ¥æ± ä¸­æœ€å°çš„ç©ºé—²è¿æ¥æ•°ï¼Œè¿™é‡Œæ˜¯ <code>20</code>ã€‚</li><li><code>max-active</code>: è¿æ¥æ± ä¸­æœ€å¤§çš„æ´»åŠ¨è¿æ¥æ•°ï¼Œè¿™é‡Œæ˜¯ <code>100</code>ã€‚</li><li><code>max-wait</code>: è¿æ¥æ± ä¸­è·å–è¿æ¥çš„æœ€å¤§ç­‰å¾…æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œè¿™é‡Œæ˜¯ <code>60000</code> æ¯«ç§’ï¼ˆå³60ç§’ï¼‰ã€‚</li><li><code>stat-view-servlet</code>: ç”¨äºDruidçš„ç›‘æ§é¡µé¢ã€‚<ul><li><code>enabled</code>: æ˜¯å¦å¯ç”¨ç›‘æ§é¡µé¢ï¼Œè¿™é‡Œæ˜¯ <code>true</code>ã€‚</li><li><code>url-pattern</code>: ç›‘æ§é¡µé¢çš„URLæ¨¡å¼ã€‚</li><li><code>login-username</code>: ç›‘æ§é¡µé¢çš„ç™»å½•ç”¨æˆ·åã€‚</li><li><code>login-password</code>: ç›‘æ§é¡µé¢çš„ç™»å½•å¯†ç ã€‚</li></ul></li><li><code>filter</code>: å®šä¹‰äº†Druidçš„è¿‡æ»¤å™¨é…ç½®ã€‚<ul><li><code>stat</code>: ç”¨äºç»Ÿè®¡çš„è¿‡æ»¤å™¨ã€‚<ul><li><code>enabled</code>: æ˜¯å¦å¯ç”¨ç»Ÿè®¡è¿‡æ»¤å™¨ï¼Œè¿™é‡Œæ˜¯ <code>true</code>ã€‚</li><li><code>slow-sql-millis</code>: æ‰§è¡Œæ—¶é—´è¶…è¿‡å¤šå°‘æ¯«ç§’çš„SQLè¢«è®¤ä¸ºæ˜¯æ…¢æŸ¥è¯¢ï¼Œè¿™é‡Œæ˜¯ <code>2000</code> æ¯«ç§’ã€‚</li><li><code>log-slow-sql</code>: æ˜¯å¦è®°å½•æ…¢æŸ¥è¯¢çš„æ—¥å¿—ï¼Œè¿™é‡Œæ˜¯ <code>true</code>ã€‚</li></ul></li><li><code>wall</code>: ç”¨äºé˜²ç«å¢™çš„è¿‡æ»¤å™¨ï¼Œç”¨äºé˜²æ­¢SQLæ³¨å…¥ã€‚<ul><li><code>enabled</code>: æ˜¯å¦å¯ç”¨é˜²ç«å¢™è¿‡æ»¤å™¨ï¼Œè¿™é‡Œæ˜¯ <code>true</code>ã€‚</li></ul></li></ul></li></ul></li></ul></li></ul></li></ul><p>åœ¨<code>jc-club-subject</code>ä¸­çš„<code>jc-club-application-controller</code>ä¸­çš„<code>pom.xml</code>ä¸­å¼•å…¥<code>jc-club-infra</code>æ¨¡å—</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-application<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-application-controller<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.compilerVersion</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.compilerVersion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.reporting.outputEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-infra<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨<code>jc-club-subject</code>ä¸­çš„<code>jc-club-application-controller</code>ä¸­çš„<code>SubjectController.java</code>ä¸­æ–°å¢ä¸€æ®µå¯¹æ•°æ®åº“çš„æµ‹è¯•ä»£ç </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.subject.application.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ·é¢˜controller</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/subject&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectController</span> &#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/test&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">SubjectCategory</span> <span class="variable">subjectCategory</span> <span class="operator">=</span> subjectCategoryService.queryById(<span class="number">1L</span>);</span><br><span class="line">        <span class="keyword">return</span> subjectCategory;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æµ‹è¯•æˆåŠŸ</p><p><img src="https://s2.loli.net/2024/07/21/V6nFPGIOk5UmXSu.png" alt="image-20240721152600418.png"></p><h5 id="åŸºäºdruidé…ç½®æ–‡ä»¶åŠ å¯†ï¼ˆinfraä¸­çš„å·¥å…·ç±»ï¼‰"><a href="#åŸºäºdruidé…ç½®æ–‡ä»¶åŠ å¯†ï¼ˆinfraä¸­çš„å·¥å…·ç±»ï¼‰" class="headerlink" title="åŸºäºdruidé…ç½®æ–‡ä»¶åŠ å¯†ï¼ˆinfraä¸­çš„å·¥å…·ç±»ï¼‰"></a>åŸºäºdruidé…ç½®æ–‡ä»¶åŠ å¯†ï¼ˆinfraä¸­çš„å·¥å…·ç±»ï¼‰</h5><p>åœ¨<code>jc-club-subject</code>ä¸­çš„<code>jc-club-infra/basic</code>ä¸­æ–°å»ºä¸€ä¸ª<code>utils</code>åŒ…ï¼Œå»ºä¸€ä¸ªç”¨äºæ•°æ®åº“åŠ å¯†çš„<code>DruidEncrypUtil.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.subject.infra.basic.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.filter.config.ConfigTools;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchProviderException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DruidEncryptUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String publicKey;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String privateKey;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String[] keyPair = ConfigTools.genKeyPair(<span class="number">512</span>);</span><br><span class="line">            privateKey = keyPair[<span class="number">0</span>]; <span class="comment">//ç§é’¥</span></span><br><span class="line">            System.out.println(<span class="string">&quot;privateKey:&quot;</span> + privateKey);</span><br><span class="line">            publicKey = keyPair[<span class="number">1</span>]; <span class="comment">//å…¬é’¥</span></span><br><span class="line">            System.out.println(<span class="string">&quot;publicKey:&quot;</span> + publicKey);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchProviderException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//åŠ å¯†</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">encrypt</span><span class="params">(String plainText)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">encrypt</span> <span class="operator">=</span> ConfigTools.encrypt(privateKey, plainText);</span><br><span class="line">        System.out.println(<span class="string">&quot;encrypt:&quot;</span> + encrypt);</span><br><span class="line">        <span class="keyword">return</span> encrypt;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//è§£å¯†</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">decrypt</span><span class="params">(String encryptText)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">decrypt</span> <span class="operator">=</span> ConfigTools.decrypt(publicKey, encryptText);</span><br><span class="line">        System.out.println(<span class="string">&quot;decrypt:&quot;</span> + decrypt);</span><br><span class="line">        <span class="keyword">return</span> decrypt;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">encrypt</span> <span class="operator">=</span> encrypt(<span class="string">&quot;123456&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;encrypt:&quot;</span> + encrypt);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç”Ÿæˆçš„å…¬ç§é’¥å’ŒåŠ å¯†çš„å¯†ç </p><p><img src="https://s2.loli.net/2024/07/20/trGKkfQ7o2C9MqU.png" alt="image-20240720154842241.png"></p><p>åœ¨<code>jc-club-subject</code>ä¸­çš„<code>jc-club-starter</code>ä¸­ä¿®æ”¹<code>application.yml</code>ï¼Œåœ¨<code>passwordã€configå’ŒpublicKey</code>å¤„è¿›è¡Œä¿®æ”¹:</p><ul><li><p><code>config</code>: é…ç½®è¿‡æ»¤å™¨ï¼Œè¿™é‡Œå¯ç”¨äº†é…ç½®è¿‡æ»¤å™¨ã€‚</p></li><li><p><code>connectionProperties</code>: è¿æ¥å±æ€§ï¼Œè¿™é‡Œé…ç½®äº†è§£å¯†é…ç½®ï¼Œ<code>config.decrypt=true</code> è¡¨ç¤ºå¼€å¯è§£å¯†åŠŸèƒ½ï¼Œ<code>config.decrypt.key=$&#123;publicKey&#125;</code> è¡¨ç¤ºä½¿ç”¨é…ç½®çš„å…¬é’¥å±æ€§è¿›è¡Œè§£å¯†ã€‚</p></li><li><p><code>publicKey</code>: å®šä¹‰äº†ä¸€ä¸ªå…¬é’¥ï¼Œç”¨äºä¸ <code>connectionProperties</code> ä¸­çš„ <code>config.decrypt.key</code> é…åˆï¼Œè¿›è¡Œæ•°æ®åº“å¯†ç çš„è§£å¯†ã€‚</p></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="string">port:3000</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">Me2Tw8jJlEU2C3ghYkBPPfauoyYKXOnb7iTsOHbISHU/mC1ol9OUvU3O9klxv1o5UEv49mErTSawnrw4zsG+5g==</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/jc-club?serverTimezone=Asia/Shanghai&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=true</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line">    <span class="attr">druid:</span></span><br><span class="line">      <span class="attr">initial-size:</span> <span class="number">20</span></span><br><span class="line">      <span class="attr">min-idle:</span> <span class="number">20</span></span><br><span class="line">      <span class="attr">max-active:</span> <span class="number">100</span></span><br><span class="line">      <span class="attr">max-wait:</span> <span class="number">60000</span></span><br><span class="line">      <span class="attr">connectionProperties:</span> <span class="string">config.decrypt=true;config.decrypt.key=$&#123;publicKey&#125;;</span></span><br><span class="line">      <span class="attr">stat-view-servlet:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">url-pattern:</span> <span class="string">/druid/*</span></span><br><span class="line">        <span class="attr">login-username:</span> <span class="string">admin</span></span><br><span class="line">        <span class="attr">login-password:</span> <span class="number">123456</span></span><br><span class="line">      <span class="attr">filter:</span></span><br><span class="line">        <span class="attr">stat:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">slow-sql-millis:</span> <span class="number">2000</span></span><br><span class="line">          <span class="attr">log-slow-sql:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">wall:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">config:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span> </span><br><span class="line"><span class="attr">publicKey:</span> <span class="string">MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAIKZoTIyh/UEThK6nHOmxVlsSYM6o5qTle39c8NilMUjIln2P3bll86R0asiMLU2p2S81RRfARjIO1im8dNBvS8CAwEAAQ==</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç°åœ¨æ•°æ®åº“å¯ä»¥é€šè¿‡åŠ å¯†åçš„å¯†ç è¿ä¸Šäº†</p><h5 id="åˆ†å±‚æ¶æ„ä¸šåŠ¡å¼€å‘"><a href="#åˆ†å±‚æ¶æ„ä¸šåŠ¡å¼€å‘" class="headerlink" title="åˆ†å±‚æ¶æ„ä¸šåŠ¡å¼€å‘"></a>åˆ†å±‚æ¶æ„ä¸šåŠ¡å¼€å‘</h5><p>æ‰€æœ‰æ¥å£å¦‚å›¾æ‰€ç¤ºï¼š</p><p><img src="https://s2.loli.net/2024/07/22/kZsLMm7DNdGpfSX.png" alt="image-20240722125513009.png"></p><h6 id="é¢˜ç›®åˆ†ç±»-SubjectCategoryController-java"><a href="#é¢˜ç›®åˆ†ç±»-SubjectCategoryController-java" class="headerlink" title="é¢˜ç›®åˆ†ç±»(SubjectCategoryController.java)"></a>é¢˜ç›®åˆ†ç±»(SubjectCategoryController.java)</h6><p>è¿™éƒ¨åˆ†å†…å®¹ä¸­ï¼Œ<code>SujectCategoryController</code>ä½œä¸ºå¯¹é¢˜ç›®ç±»å‹æ¶‰åŠåˆ°getã€postå¢åˆ æ”¹æŸ¥çš„å…¥å£ï¼Œå…¶ä¸­åŒ…å«éƒ½åœ¨<code>jc-club-application-controller</code>ä¸­çš„<code>SubjectCategoryServiceImpl</code>å’Œ<code>SubjectCategoryDomainServiceImpl</code>ã€‚è¯¥controlleré€šè¿‡<code>jc-club-application-convert</code>ç»„ä»¶ä¸­<code>SubjectCategoryDTOConverter</code>çš„å°†DTO-&gt;BO&#x2F;BO-&gt;DTOï¼Œå†åˆ©ç”¨<code>SubjectCategoryDomainServiceImpl</code>ç»„ä»¶çš„addæ–¹æ³•ï¼Œå…¶ä¸­æ¶‰åŠåˆ°<code>jc-club-domain-convert</code>ç»„ä»¶ä¸­çš„<code>SubjectCategoryConverter</code>å°†BO-&gt;Categoryï¼Œåœ¨é€šè¿‡<code>SubjectCategoryServiceImpl</code>è°ƒç”¨<code>infra</code>å±‚çš„<code>SubjectCategoryConverter</code>å°†Categoryç±»è½¬åŒ–ä¸ºDAOã€‚</p><p><a href="https://blog.csdn.net/weixin_45067224/article/details/130882294?ops_request_misc=%7B%22request_id%22:%22172154968616800188590959%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172154968616800188590959&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-130882294-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=mapstruct.Mapper&spm=1018.2226.3001.4187">MapStructè½¬æ¢å™¨å¸¸è§é—®é¢˜åŠå…¶ä½¿ç”¨æ–¹å¼_@inheritinverseconfiguration-CSDNåšå®¢</a></p><p>è¿™é‡Œçš„convertçš„å®ç°æ˜¯åˆ©ç”¨@Mapperæ³¨è§£åˆ°converterç±»çš„</p><p><a href="https://blog.csdn.net/hellozhxy/article/details/121403654?ops_request_misc=%7B%22request_id%22:%22172154968616800188590959%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172154968616800188590959&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-4-121403654-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=mapstruct.Mapper&spm=1018.2226.3001.4187">MapStructä½¿ç”¨è¯¦è§£-CSDNåšå®¢</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.mapstruct.Mapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectCategoryDTOConverter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">SubjectCategoryDTOConverter</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(SubjectCategoryDTOConverter.class);</span><br><span class="line"></span><br><span class="line">    List&lt;SubjectCategoryDTO&gt; <span class="title function_">convertBoToCategoryDTOList</span><span class="params">(List&lt;SubjectCategoryBO&gt; subjectCategoryDTO)</span>;</span><br><span class="line"></span><br><span class="line">    SubjectCategoryBO <span class="title function_">convertDtoToCategoryBO</span><span class="params">(SubjectCategoryDTO subjectCategoryDTO)</span>;</span><br><span class="line"></span><br><span class="line">    SubjectCategoryDTO <span class="title function_">convertBoToCategoryDTO</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol><li><p>æ–°å¢åˆ†ç±»ï¼ˆ<code>POST: /subject/category/add</code>ï¼‰</p><p>è¯·æ±‚<code>body</code>:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;categoryName&quot;</span><span class="punctuation">:</span><span class="string">&quot;åç«¯&quot;</span>ï¼Œ</span><br><span class="line"><span class="attr">&quot;categoryType&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;parentId&quot;</span><span class="punctuation">:</span><span class="number">0</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;imgUrl&quot;</span><span class="punctuation">:</span><span class="string">&quot;http://image/123&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å“åº”æˆåŠŸç¤ºä¾‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span><span class="number">200</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;message&quot;</span><span class="punctuation">:</span><span class="string">&quot;æ–°å¢æˆåŠŸ&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;reqUuid&quot;</span><span class="punctuation">:</span><span class="string">&quot;123123123.123123.123123&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;success&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>æ–°å¢<code>jc-club-common</code>åŒ…ï¼š</p><ol><li><p><code>Lombok</code>æ˜¯ä¸€ä¸ªJavaåº“ï¼Œå®ƒé€šè¿‡æ³¨è§£çš„æ–¹å¼æä¾›äº†ä¸€ç³»åˆ—å¯ä»¥ç®€åŒ–Javaä»£ç çš„å·¥å…·ï¼Œæ¯”å¦‚è‡ªåŠ¨ç”Ÿæˆgetterã€setterã€toStringç­‰æ–¹æ³•ã€‚</p></li><li><p><code>MapStruct</code>æ˜¯ä¸€ä¸ªä»£ç ç”Ÿæˆå™¨ï¼Œç”¨äºå°†Javaæ–¹æ³•çš„è¾“å…¥å‚æ•°æ˜ å°„åˆ°è¾“å‡ºå‚æ•°ï¼Œé€šå¸¸ç”¨äºDTOï¼ˆæ•°æ®ä¼ è¾“å¯¹è±¡ï¼‰å’ŒEntityï¼ˆå®ä½“ï¼‰ä¹‹é—´çš„æ˜ å°„ã€‚</p><p><a href="https://blog.csdn.net/Kevinnsm/article/details/114998540?ops_request_misc=%7B%22request_id%22:%22172146370216800184185770%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=172146370216800184185770&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-5-114998540-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E5%AF%B9%E8%B1%A1%E4%B8%8E%E5%AE%9E%E4%BD%93&spm=1018.2226.3001.4187">DTOæ•°æ®ä¼ è¾“å¯¹è±¡è¯¦è§£_dtoæ’–å¯¡æƒ…-CSDNåšå®¢</a></p></li><li><p><code>mapstruct-processor</code>ï¼Œæ˜¯MapStructçš„æ³¨è§£å¤„ç†å™¨éƒ¨åˆ†ï¼Œç”¨äºåœ¨ç¼–è¯‘æ—¶ç”Ÿæˆæ˜ å°„ä»£ç ã€‚</p></li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">//pom.xml æ³¨æ„lombokæ”¾åœ¨mapstructå‰é¢æ˜¯ä¸ºäº†èƒ½å¤Ÿæ­£å¸¸çš„æ‹¿åˆ°æ•°æ®ã€‚å¦‚æœé¡¹ç›®ä¸­ä½¿ç”¨äº†lombokï¼Œé‚£ä¹ˆéœ€è¦åœ¨ç¼–è¯‘å™¨æŒ‡å®šä»–ä»¬çš„æ‰§è¡Œé¡ºåºï¼Œå› ä¸ºmapstrutåº•å±‚æ˜¯é set/getèµ‹å€¼çš„ï¼Œæ‰€ä»¥éœ€è¦lombokå…ˆç¼–è¯‘ã€‚</span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mapstruct<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapstruct<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.2.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mapstruct<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapstruct-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.2.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>jc-club-infra</code>ä¸­çš„<code>entity</code>ä¸‹çš„<code>SubjectCategory.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.subject.infra.basic.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é¢˜ç›®åˆ†ç±»(SubjectCategory)å®ä½“ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span> <span class="comment">//å¯¼å…¥äº†Lombokåº“ä¸­çš„@Dataæ³¨è§£ã€‚@Dataæ˜¯ä¸€ä¸ªä¾¿åˆ©çš„æ³¨è§£ï¼Œå®ƒä¸ºç±»è‡ªåŠ¨ç”Ÿæˆgetterå’Œsetteræ–¹æ³•ã€equals()ã€hashCode()å’ŒtoString()æ–¹æ³•ã€‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectCategory</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123; <span class="comment">//åºåˆ—åŒ–</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»é”®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†ç±»åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String categoryName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†ç±»ç±»å‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer categoryType;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å›¾æ ‡è¿æ¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String imageUrl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * çˆ¶çº§id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long parentId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºäºº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String createdBy;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºæ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date createdTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°äºº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String updateBy;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date updateTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€»è¾‘åˆ é™¤ 0æœªåˆ é™¤ 1å·²åˆ é™¤</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer isDeleted;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>jc-club-infra</code>ä¸­çš„<code>mapper</code>ä¸‹çš„<code>SubjectCategoryDao.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.subject.infra.basic.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.subject.infra.basic.entity.SubjectCategory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Param;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é¢˜ç›®åˆ†ç±»(SubjectCategory)è¡¨æ•°æ®åº“è®¿é—®å±‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectCategoryDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡IDæŸ¥è¯¢å•æ¡æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id ä¸»é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    SubjectCategory <span class="title function_">queryById</span><span class="params">(Long id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»Ÿè®¡æ€»è¡Œæ•°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subjectCategory æŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ€»è¡Œæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">long</span> <span class="title function_">count</span><span class="params">(SubjectCategory subjectCategory)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subjectCategory å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å½±å“è¡Œæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">insert</span><span class="params">(SubjectCategory subjectCategory)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰¹é‡æ–°å¢æ•°æ®ï¼ˆMyBatisåŸç”Ÿforeachæ–¹æ³•ï¼‰</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> entities List&lt;SubjectCategory&gt; å®ä¾‹å¯¹è±¡åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å½±å“è¡Œæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">insertBatch</span><span class="params">(<span class="meta">@Param(&quot;entities&quot;)</span> List&lt;SubjectCategory&gt; entities)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰¹é‡æ–°å¢æˆ–æŒ‰ä¸»é”®æ›´æ–°æ•°æ®ï¼ˆMyBatisåŸç”Ÿforeachæ–¹æ³•ï¼‰</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> entities List&lt;SubjectCategory&gt; å®ä¾‹å¯¹è±¡åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å½±å“è¡Œæ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> org.springframework.jdbc.BadSqlGrammarException å…¥å‚æ˜¯ç©ºListçš„æ—¶å€™ä¼šæŠ›SQLè¯­å¥é”™è¯¯çš„å¼‚å¸¸ï¼Œè¯·è‡ªè¡Œæ ¡éªŒå…¥å‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">insertOrUpdateBatch</span><span class="params">(<span class="meta">@Param(&quot;entities&quot;)</span> List&lt;SubjectCategory&gt; entities)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subjectCategory å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å½±å“è¡Œæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">update</span><span class="params">(SubjectCategory subjectCategory)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡ä¸»é”®åˆ é™¤æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id ä¸»é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å½±å“è¡Œæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">deleteById</span><span class="params">(Long id)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;SubjectCategory&gt; <span class="title function_">queryCategory</span><span class="params">(SubjectCategory subjectCategory)</span>;</span><br><span class="line"></span><br><span class="line">    Integer <span class="title function_">querySubjectCount</span><span class="params">(Long id)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>jc-club-infra</code>ä¸­çš„<code>service</code>ä¸‹çš„<code>SubjectCategoryServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.subject.infra.basic.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.subject.infra.basic.entity.SubjectCategory;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.subject.infra.basic.mapper.SubjectCategoryDao;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.subject.infra.basic.service.SubjectCategoryService;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é¢˜ç›®åˆ†ç±»(SubjectCategory)è¡¨æœåŠ¡å®ç°ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service(&quot;subjectCategoryService&quot;)</span> <span class="comment">//Springæ³¨è§£ï¼Œç”¨äºå£°æ˜è¿™ä¸ªç±»æ˜¯ä¸€ä¸ªæœåŠ¡ç»„ä»¶ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡subjectCategoryServiceè¿™ä¸ªåç§°è·å–åˆ°è¿™ä¸ªæœåŠ¡çš„å®ä¾‹ã€‚</span></span><br><span class="line"><span class="meta">@Slf4j</span> <span class="comment">//Lombokæ³¨è§£ï¼Œè‡ªåŠ¨ä¸ºç±»ç”Ÿæˆä¸€ä¸ªæ—¥å¿—å¯¹è±¡(log)ï¼Œä½¿ç”¨SLF4Jæ—¥å¿—æ¡†æ¶ã€‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectCategoryServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">SubjectCategoryService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span> <span class="comment">//Springæ³¨è§£ï¼Œç”¨äºè‡ªåŠ¨è£…é…(æ³¨å…¥)SubjectCategoryDaoç±»å‹çš„beanåˆ°subjectCategoryDaoå­—æ®µã€‚</span></span><br><span class="line">    <span class="keyword">private</span> SubjectCategoryDao subjectCategoryDao;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subjectCategory å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> SubjectCategory <span class="title function_">insert</span><span class="params">(SubjectCategory subjectCategory)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(log.isInfoEnabled())&#123;</span><br><span class="line">            log.info(<span class="string">&quot;SubjectCategoryController.add.subjectCategory:&#123;&#125;&quot;</span></span><br><span class="line">                    , JSON.toJSONString(subjectCategory));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.subjectCategoryDao.insert(subjectCategory);</span><br><span class="line">        <span class="keyword">return</span> subjectCategory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> SubjectCategory <span class="title function_">queryById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.subjectCategoryDao.queryById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subjectCategory å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">update</span><span class="params">(SubjectCategory subjectCategory)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.subjectCategoryDao.update(subjectCategory);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡ä¸»é”®åˆ é™¤æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id ä¸»é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ˜¯å¦æˆåŠŸ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">deleteById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.subjectCategoryDao.deleteById(id) &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;SubjectCategory&gt; <span class="title function_">queryCategory</span><span class="params">(SubjectCategory subjectCategory)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.subjectCategoryDao.queryCategory(subjectCategory);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">querySubjectCount</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.subjectCategoryDao.querySubjectCount(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>jc-club-domain</code>ä¸­çš„<code>pom.xml</code>å¼•å…¥<code>infra</code>æ¨¡å—ï¼Œä¾¿äº<code>jc-club-domain</code>ä¸­çš„<code>service/impl</code>ä¸‹çš„<code>SubjectCategoryDomainServiceImpl.java</code>æ¥å¼•ç”¨</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-subject<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-domain<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">source</span>&gt;</span>8<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">target</span>&gt;</span>8<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-infra<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>jc-club-domain</code>ä¸­çš„<code>entity</code>ä¸‹çš„<code>SubjectCategoryBO.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.subject.domain.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é¢˜ç›®åˆ†ç±»(SubjectCategory)å®ä½“ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> makejava</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2023-10-01 21:49:59</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectCategoryBO</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»é”®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†ç±»åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String categoryName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†ç±»ç±»å‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer categoryType;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å›¾æ ‡è¿æ¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String imageUrl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * çˆ¶çº§id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long parentId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°é‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer count;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ‡ç­¾boæ•°é‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;SubjectLabelBO&gt; labelBOList;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>jc-club-domain</code>ä¸­çš„<code>service</code>ä¸‹çš„<code>SubjectCategoryDomainService.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.subject.domain.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.subject.domain.entity.SubjectCategoryBO;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectCategoryDomainService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢åˆ†ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢å²—ä½å¤§ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;SubjectCategoryBO&gt; <span class="title function_">queryCategory</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°åˆ†ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Boolean <span class="title function_">update</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤åˆ†ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Boolean <span class="title function_">delete</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢åˆ†ç±»åŠæ ‡ç­¾</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;SubjectCategoryBO&gt; <span class="title function_">queryCategoryAndLabel</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ€ä¹ˆå°†BOè½¬ä¸ºCategoryå‘¢ï¼Ÿè¿™é‡Œéœ€è¦åœ¨<code>jc-club-domain</code>ä¸­çš„<code>convert</code>åŒ…è®¾ç½®<code>SubjectCategoryConverter.java</code>ï¼Œç”¨åˆ°mapstructã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SubjectCategoryConverter.java</span></span><br><span class="line"><span class="keyword">package</span> com.jingdianjichi.subject.domain.convert;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.subject.domain.entity.SubjectCategoryBO;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.subject.infra.basic.entity.SubjectCategory;</span><br><span class="line"><span class="keyword">import</span> org.mapstruct.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.mapstruct.factory.Mappers;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectCategoryConverter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">SubjectCategoryConverter</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(SubjectCategoryConverter.class);</span><br><span class="line"></span><br><span class="line">    SubjectCategory <span class="title function_">convertBoToCategory</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;SubjectCategoryBO&gt; <span class="title function_">convertBoToCategory</span><span class="params">(List&lt;SubjectCategory&gt; categoryList)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ­¤æ—¶`jc-club-domain`ä¸­çš„`service`ä¸‹çš„`SubjectCategoryDomainServiceImpl.java`å°±å¯ä»¥è°ƒç”¨è¿™ä¸ªäº†</span></span><br><span class="line"><span class="keyword">package</span> com.jingdianjichi.subject.domain.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectCategoryDomainServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">SubjectCategoryDomainService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectCategoryService subjectCategoryService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span> &#123;</span><br><span class="line">        <span class="type">SubjectCategory</span> <span class="variable">subjectCategory</span> <span class="operator">=</span> SubjectCategoryConverter.INSTANCE</span><br><span class="line">                .convertBoToCategory(subjectCategoryBO); <span class="comment">//BO-&gt;SujectCategory</span></span><br><span class="line">        subjectCategory.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">        subjectCategoryService.insert(subjectCategory);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨<code>jc-club-subject</code>ä¸­çš„<code>jc-club-application-controller</code>çš„<code>pom.xml</code>ä¸­æ–°å¢<code>jc-club-domain</code>ï¼Œç›®çš„æ˜¯åœ¨åˆ›å»º<code>SubjectCategoryController</code>æ—¶èƒ½æ­£å¸¸å¼•å…¥ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">//pom.xml</span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-infra<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-domain<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨<code>jc-club-subject</code>ä¸­çš„<code>jc-club-application-controller</code>çš„<code>SubjectCategoryController.java</code>ã€‚è¿™é‡Œä¼šæ¶‰åŠåˆ°åœ¨<code>jc-club-application-dto</code>æ¨¡å—ä¸‹çš„ä»BOåˆ°DTOçš„è½¬æ¢ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SubjectCategoryDTO.java BO-&gt;DTO</span></span><br><span class="line"><span class="keyword">package</span> com.jingdianjichi.subject.application.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é¢˜ç›®åˆ†ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: ChickenWing</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2023/10/3</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectCategoryDTO</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»é”®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†ç±»åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String categoryName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†ç±»ç±»å‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer categoryType;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å›¾æ ‡è¿æ¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String imageUrl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * çˆ¶çº§id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long parentId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°é‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer count;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ‡ç­¾ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;SubjectLabelDTO&gt; labelDTOList;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//SubjectCategoryDTOConverter.java</span></span><br><span class="line"><span class="keyword">package</span> com.jingdianjichi.subject.application.convert;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.subject.application.dto.SubjectCategoryDTO;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.subject.domain.entity.SubjectCategoryBO;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.subject.infra.basic.entity.SubjectCategory;</span><br><span class="line"><span class="keyword">import</span> org.mapstruct.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.mapstruct.factory.Mappers;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é¢˜ç›®åˆ†ç±»dtoè½¬æ¢å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectCategoryDTOConverter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">SubjectCategoryDTOConverter</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(SubjectCategoryDTOConverter.class);</span><br><span class="line"></span><br><span class="line">    List&lt;SubjectCategoryDTO&gt; <span class="title function_">convertBoToCategoryDTOList</span><span class="params">(List&lt;SubjectCategoryBO&gt; subjectCategoryDTO)</span>;</span><br><span class="line"></span><br><span class="line">    SubjectCategoryBO <span class="title function_">convertDtoToCategoryBO</span><span class="params">(SubjectCategoryDTO subjectCategoryDTO)</span>;</span><br><span class="line"></span><br><span class="line">    SubjectCategoryDTO <span class="title function_">convertBoToCategoryDTO</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SubjectCategoryController.java</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/subject/category&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectCategoryController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectCategoryDomainService subjectCategoryDomainService;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">add</span><span class="params">(<span class="meta">@RequestBody</span> SubjectCategoryDTO subjectCategoryDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            SubjectCategoryBO subjectCategoryBO=SubjectCategoryDTOConverter.INSTANCE.convertDtoToBO(subjectCategoryDTO);</span><br><span class="line">            subjectDomainService.add(subjectCategoryBO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(<span class="literal">true</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="literal">false</span>); <span class="comment">//è¿™é‡Œçš„è¿”å›ç»“æœåœ¨jc-club-commonä¸­çš„entityæ¨¡å—è®¾è®¡ä¸€ä¸ªResultç±»æ¥ç»Ÿä¸€è¿”å›</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºä¼šæ¶‰åŠåˆ°ç»“æœè¿”å›ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//jc-club-common/entity Result.java</span></span><br><span class="line"><span class="keyword">package</span> com.jingdianjichi.subject.common.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.subject.common.enums.ResultCodeEnum;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Result</span>&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Boolean success;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer code;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> T data;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title function_">ok</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Result</span>();</span><br><span class="line">        result.setSuccess(<span class="literal">true</span>);</span><br><span class="line">        result.setCode(ResultCodeEnum.SUCCESS.getCode());</span><br><span class="line">        result.setMessage(ResultCodeEnum.SUCCESS.getDesc());</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result <span class="title function_">ok</span><span class="params">(T data)</span>&#123;</span><br><span class="line">        <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Result</span>();</span><br><span class="line">        result.setSuccess(<span class="literal">true</span>);</span><br><span class="line">        result.setCode(ResultCodeEnum.SUCCESS.getCode());</span><br><span class="line">        result.setMessage(ResultCodeEnum.SUCCESS.getDesc());</span><br><span class="line">        result.setData(data);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title function_">fail</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Result</span>();</span><br><span class="line">        result.setSuccess(<span class="literal">false</span>);</span><br><span class="line">        result.setCode(ResultCodeEnum.FAIL.getCode());</span><br><span class="line">        result.setMessage(ResultCodeEnum.FAIL.getDesc());</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result <span class="title function_">fail</span><span class="params">(T data)</span>&#123;</span><br><span class="line">        <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Result</span>();</span><br><span class="line">        result.setSuccess(<span class="literal">false</span>);</span><br><span class="line">        result.setCode(ResultCodeEnum.FAIL.getCode());</span><br><span class="line">        result.setMessage(ResultCodeEnum.FAIL.getDesc());</span><br><span class="line">        result.setData(data);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//jc-club-common/enums ResultCodeEnum.java</span></span><br><span class="line"><span class="keyword">package</span> com.jingdianjichi.subject.common.enums;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">ResultCodeEnum</span> &#123;</span><br><span class="line"></span><br><span class="line">    SUCCESS(<span class="number">200</span>,<span class="string">&quot;æˆåŠŸ&quot;</span>),</span><br><span class="line">    FAIL(<span class="number">500</span>,<span class="string">&quot;å¤±è´¥&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> code;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String desc;</span><br><span class="line"></span><br><span class="line">    ResultCodeEnum(<span class="type">int</span> code,String desc)&#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">        <span class="built_in">this</span>.desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ResultCodeEnum <span class="title function_">getByCode</span><span class="params">(<span class="type">int</span> codeVal)</span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(ResultCodeEnum resultCodeEnum : ResultCodeEnum.values())&#123;</span><br><span class="line">            <span class="keyword">if</span>(resultCodeEnum.code == codeVal)&#123;</span><br><span class="line">                <span class="keyword">return</span> resultCodeEnum;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¢åŠ æ—¥å¿—lo4j2å’Œfastjsonåœ¨<code>jc-club-common</code>ä¸­ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">//pom.xml</span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mapstruct<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapstruct<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.2.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mapstruct<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapstruct-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.2.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-log4j2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.24<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„<code>SubjectCategoryController.java</code>å’Œ<code>SubjectCategoryDomainServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SubjectCategoryController.java</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/subject/category&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectCategoryController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectCategoryDomainService subjectCategoryDomainService;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">add</span><span class="params">(<span class="meta">@RequestBody</span> SubjectCategoryDTO subjectCategoryDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;SubjectCategoryController.add.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(subjectCategoryDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">/*è¿™é‡Œlog.isInfoEnabled()çš„ä½œç”¨æ˜¯å¦‚æœä¸åŠ log.isDebugEnabled()ç­‰</span></span><br><span class="line"><span class="comment">è¿›è¡Œé¢„å…ˆåˆ¤æ–­ï¼Œå½“ç³»ç»Ÿloglevelè®¾ç½®é«˜äºDebugæˆ–Infoæˆ–Traceæ—¶ï¼Œè™½ç„¶ç³»ç»Ÿä¸ä¼šç­”åº”å‡ºè¿™äº›çº§åˆ«çš„æ—¥å¿—ï¼Œä½†æ˜¯æ¯æ¬¡è¿˜æ˜¯ä¼šæ‹¼æ¥</span></span><br><span class="line"><span class="comment">å‚æ•°å­—ç¬¦ä¸²/åºåˆ—åŒ–ï¼Œå½±å“ç³»ç»Ÿçš„æ€§èƒ½ã€‚*/</span></span><br><span class="line">            SubjectCategoryBO subjectCategoryBO=SubjectCategoryDTOConverter.INSTANCE.convertDtoToBO(subjectCategoryDTO);</span><br><span class="line">            subjectDomainService.add(subjectCategoryBO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(<span class="literal">true</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="literal">false</span>); <span class="comment">//è¿™é‡Œçš„è¿”å›ç»“æœåœ¨jc-club-commonä¸­çš„entityæ¨¡å—è®¾è®¡ä¸€ä¸ªResultç±»æ¥ç»Ÿä¸€è¿”å›</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//SubjectCategoryDomainServiceImpl.java</span></span><br><span class="line"><span class="keyword">package</span> com.jingdianjichi.subject.domain.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectCategoryDomainServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">SubjectCategoryDomainService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectCategoryService subjectCategoryService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;SubjectCategoryController.add.bo:&#123;&#125;&quot;</span>, JSON.toJSONString(subjectCategoryBO));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">SubjectCategory</span> <span class="variable">subjectCategory</span> <span class="operator">=</span> SubjectCategoryConverter.INSTANCE</span><br><span class="line">                .convertBoToCategory(subjectCategoryBO); <span class="comment">//BO-&gt;SujectCategory</span></span><br><span class="line">        subjectCategory.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">        subjectCategoryService.insert(subjectCategory);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>preconditionså‚æ•°æ ¡éªŒ</strong>ï¼š</p><p>å›åˆ°<code>SubjectCategoryController.java</code>ï¼Œè¿›è¡Œå‚æ•°æ ¡éªŒï¼Œåœ¨<code>pom.xml</code>ä¸­æ·»åŠ <code>guava</code>ï¼ˆæ³¨æ„å‚æ•°æ ¡éªŒæ”¾åœ¨controllerï¼‰</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">//jc-club-common/pom.xml</span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mapstruct<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapstruct<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.2.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mapstruct<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mapstruct-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.2.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-log4j2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.24<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.guava<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>guava<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>19.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SubjectCategoryController.java</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">add</span><span class="params">(<span class="meta">@RequestBody</span> SubjectCategoryDTO subjectCategoryDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;SubjectCategoryController.add.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(subjectCategoryDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkNotNull(subjectCategoryDTO.getCategoryType(), <span class="string">&quot;åˆ†ç±»ç±»å‹ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            Preconditions.checkArgument(!StringUtils.isBlank(subjectCategoryDTO.getCategoryName()), <span class="string">&quot;åˆ†ç±»åç§°ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            Preconditions.checkNotNull(subjectCategoryDTO.getParentId(), <span class="string">&quot;åˆ†ç±»çˆ¶çº§idä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="type">SubjectCategoryBO</span> <span class="variable">subjectCategoryBO</span> <span class="operator">=</span> SubjectCategoryDTOConverter.INSTANCE.convertDtoToCategoryBO(subjectCategoryDTO);</span><br><span class="line">            subjectCategoryDomainService.add(subjectCategoryBO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(<span class="literal">true</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;SubjectCategoryController.add.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æ–°å¢åˆ†ç±»å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li></ol><h6 id="åˆ·é¢˜æ¨¡å—æ¥å£å®šä¹‰"><a href="#åˆ·é¢˜æ¨¡å—æ¥å£å®šä¹‰" class="headerlink" title="åˆ·é¢˜æ¨¡å—æ¥å£å®šä¹‰"></a>åˆ·é¢˜æ¨¡å—æ¥å£å®šä¹‰</h6><ol><li>æ–°å¢åˆ†ç±»</li><li>æ›´æ–°åˆ†ç±»</li><li>æŸ¥è¯¢åˆ†ç±»</li><li>æŸ¥è¯¢å¤§ç±»ä¸‹åˆ†ç±»</li><li>æŸ¥è¯¢åˆ†ç±»åŠæ ‡ç­¾ï¼ˆäºŒæœŸä¼˜åŒ–ï¼‰</li><li>åˆ é™¤åˆ†ç±»</li></ol><p><img src="https://s2.loli.net/2024/07/10/mLyW9JI56dVsefR.png" alt="image-20240710165032544.png"></p><p>åˆ†ç±»-&gt;æ ‡ç­¾</p><p>åŸºæœ¬çš„-&gt;äºŒæ¬¡ä¼˜åŒ–</p><p>æ•°æ®åº“-&gt;ç¼“å­˜ä¼˜åŒ–</p><ol><li><p>æ–°å¢åˆ†ç±»ï¼šPOSTï¼š&#x2F;subject&#x2F;category&#x2F;add</p><p>è¯·æ±‚ä½“ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;categoryName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ç¼“å­˜&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;parentId&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;categoryType&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;imageUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://image/category.icon&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å“åº”æˆåŠŸç¤ºä¾‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;success&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span> <span class="number">200</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æˆåŠŸ&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>æŸ¥è¯¢åˆ†ç±»ï¼šPOSTï¼š&#x2F;subject&#x2F;category&#x2F;queryPrimaryCategory</p><p>è¯·æ±‚ä½“ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;categoryType&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å“åº”ç¤ºä¾‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;success&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span> <span class="number">200</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æˆåŠŸ&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;åç«¯&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryType&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;imageUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://image/category.icon&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;parentId&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;count&quot;</span><span class="punctuation">:</span> <span class="number">65</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>æŸ¥è¯¢å¤§ç±»ä¸‹åˆ†ç±»ï¼šPOSTï¼š&#x2F;subject&#x2F;category&#x2F;queryCategoryByPrimary</p><p>è¯·æ±‚ä½“ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;parentId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;categoryType&quot;</span><span class="punctuation">:</span> <span class="number">2</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å“åº”ç¤ºä¾‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;success&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span> <span class="number">200</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æˆåŠŸ&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æ¡†æ¶&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryType&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;imageUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://image/123&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;parentId&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">5</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å¹¶å‘&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryType&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;imageUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://image/123&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;parentId&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">6</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;jvm&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryType&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;imageUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://image/123&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;parentId&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>æŸ¥è¯¢åˆ†ç±»åŠæ ‡ç­¾ï¼ˆäºŒæœŸä¼˜åŒ–ï¼‰</p><p>è¯·æ±‚ä½“ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å“åº”ç¤ºä¾‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;success&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span> <span class="number">200</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æˆåŠŸ&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ç¼“å­˜&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryType&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;imageUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://image/category.icon&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;parentId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelDTOList&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Redis&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;é›†ç¾¤&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">23</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å®é™…åº”ç”¨&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">34</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å¤šçº¿ç¨‹&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">44</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æ•°æ®ä¸€è‡´æ€§&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">46</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;åˆ†å¸ƒå¼&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">47</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æŒä¹…åŒ–&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">49</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;äº‹åŠ¡&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æ•°æ®åº“&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryType&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;imageUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://image/category.icon&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;parentId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelDTOList&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;è¿›ç¨‹&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Mysql&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">16</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ç´¢å¼•&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">23</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å®é™…åº”ç”¨&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">33</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å­˜å‚¨å¼•æ“&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">44</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æ•°æ®ä¸€è‡´æ€§&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">49</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;äº‹åŠ¡&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;JavaSE&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryType&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;imageUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://image/category.icon&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;parentId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelDTOList&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">15</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;åŸºç¡€&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">5</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æ¡†æ¶&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryType&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;imageUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://image/category.icon&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;parentId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelDTOList&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">38</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Spring&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">62</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SpringBoot&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">6</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æ¶ˆæ¯é˜Ÿåˆ—&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryType&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;imageUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://image/category.icon&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;parentId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelDTOList&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">15</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;åŸºç¡€&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">23</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å®é™…åº”ç”¨&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">7</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ä»£ç ç®¡ç†å·¥å…·&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryType&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;imageUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://image/category.icon&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;parentId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelDTOList&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">25</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Git&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">9</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ç½‘ç»œ&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryType&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;imageUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://image/category.icon&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;parentId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelDTOList&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">15</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;åŸºç¡€&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æ“ä½œç³»ç»Ÿ&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryType&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;imageUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://image/category.icon&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;parentId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelDTOList&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">15</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;åŸºç¡€&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">11</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æœ€ä½³å®è·µ&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryType&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;imageUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://image/category.icon&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;parentId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelDTOList&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">23</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å®é™…åº”ç”¨&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">53</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Jvm&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¼˜åŒ–åçš„å…¶å®æ˜¯æŠŠå¤§åˆ†ç±»-&gt;å°åˆ†ç±»-&gt;æ ‡ç­¾å…¨éƒ½æŸ¥å®Œäº†ï¼Œæ˜¯ç”¨çš„å¤šçº¿ç¨‹å»å®ç°çš„</p><p>æ•°æ®æŸ¥å®Œä¹‹åï¼Œå†é€šè¿‡éå†ç„¶ååˆ©ç”¨æŸäº›è§„åˆ™ï¼Œå‰ç«¯å°±èƒ½å¾ˆè½»æ¾çš„æŸ¥åˆ°äº†</p></li><li><p>åˆ é™¤åˆ†ç±»</p><p>è¯·æ±‚ä½“:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">3</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å“åº”ç¤ºä¾‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;success&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span> <span class="number">200</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æˆåŠŸ&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>æ›´æ–°åˆ†ç±»</p><p>è¯·æ±‚ä½“:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;categoryName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Spring&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;categoryType&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;parentId&quot;</span><span class="punctuation">:</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;imageUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://image/123&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å“åº”ç¤ºä¾‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;success&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span> <span class="number">200</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æˆåŠŸ&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li></ol><h6 id="é¢˜ç›®åˆ—è¡¨åŠè¯¦æƒ…æ¥å£å®šä¹‰"><a href="#é¢˜ç›®åˆ—è¡¨åŠè¯¦æƒ…æ¥å£å®šä¹‰" class="headerlink" title="é¢˜ç›®åˆ—è¡¨åŠè¯¦æƒ…æ¥å£å®šä¹‰"></a>é¢˜ç›®åˆ—è¡¨åŠè¯¦æƒ…æ¥å£å®šä¹‰</h6><p><img src="https://s2.loli.net/2024/07/10/mLyW9JI56dVsefR.png" alt="image-20240710165032544.png"></p><p>æ¶‰åŠåˆ°éš¾åº¦ï¼Œåˆ›å»ºæ—¶é—´ï¼Œé¢˜ç›®ï¼Œç‚¹èµæ”¶è—è¯„è®ºï¼Œåˆ›å»ºäºº</p><p>åˆ†é¡µæŸ¥è¯¢</p><ol><li><p>æŸ¥è¯¢é¢˜ç›®åˆ—è¡¨ï¼ˆPOST:&#x2F;subject&#x2F;category&#x2F;querySubjectListï¼‰</p><p>è¯·æ±‚ä½“ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;pageIndex&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;pageSize&quot;</span><span class="punctuation">:</span><span class="number">10</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelId&quot;</span><span class="punctuation">:</span><span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;difficulty&quot;</span><span class="punctuation">:</span><span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å“åº”ç¤ºä¾‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span><span class="number">200</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;message&quot;</span><span class="punctuation">:</span><span class="string">&quot;æŸ¥è¯¢æˆåŠŸ&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;total&quot;</span><span class="punctuation">:</span><span class="number">100</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;totalPage&quot;</span><span class="punctuation">:</span><span class="number">20</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;pageList&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;subjectName&quot;</span><span class="punctuation">:</span><span class="string">&quot;SpringBootçš„è‡ªåŠ¨è£…é…åŸç†æ˜¯ä»€ä¹ˆ?&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;subjectId&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;difficulty&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;labelNames&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span></span><br><span class="line">                    <span class="string">&quot;å¹¶å‘&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="string">&quot;é›†åˆ&quot;</span></span><br><span class="line">                <span class="punctuation">]</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span>ï¼Œ</span><br><span class="line">    <span class="string">&quot;reqUuid&quot;</span>ï¼š<span class="string">&quot;1231231223&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="string">&quot;success&quot;</span>ï¼š<span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li></ol><h6 id="åˆ†ç±»æ¥å£å¼€å‘"><a href="#åˆ†ç±»æ¥å£å¼€å‘" class="headerlink" title="åˆ†ç±»æ¥å£å¼€å‘"></a>åˆ†ç±»æ¥å£å¼€å‘</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SubjectCategoryController.java</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢å²—ä½å¤§ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/queryPrimaryCategory&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;List&lt;SubjectCategoryDTO&gt;&gt; <span class="title function_">queryPrimaryCategory</span><span class="params">(<span class="meta">@RequestBody</span> SubjectCategoryDTO subjectCategoryDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">SubjectCategoryBO</span> <span class="variable">subjectCategoryBO</span> <span class="operator">=</span> SubjectCategoryDTOConverter.INSTANCE.</span><br><span class="line">                    convertDtoToCategoryBO(subjectCategoryDTO);</span><br><span class="line">            List&lt;SubjectCategoryBO&gt; subjectCategoryBOList = subjectCategoryDomainService.queryCategory(subjectCategoryBO);</span><br><span class="line">            List&lt;SubjectCategoryDTO&gt; subjectCategoryDTOList = SubjectCategoryDTOConverter.INSTANCE.</span><br><span class="line">                    convertBoToCategoryDTOList(subjectCategoryBOList);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(subjectCategoryDTOList);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;SubjectCategoryController.queryPrimaryCategory.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æŸ¥è¯¢å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//domainåŒ…é‡Œ SubjectCategoryDomainService.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectCategoryDomainService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢åˆ†ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢å²—ä½å¤§ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;SubjectCategoryBO&gt; <span class="title function_">queryCategory</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span>;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//domainåŒ…é‡Œ SubjectCategoryDomainServiceImpl.java</span></span><br><span class="line"> <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;SubjectCategoryBO&gt; <span class="title function_">queryCategory</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span> &#123;</span><br><span class="line">        <span class="type">SubjectCategory</span> <span class="variable">subjectCategory</span> <span class="operator">=</span> SubjectCategoryConverter.INSTANCE</span><br><span class="line">                .convertBoToCategory(subjectCategoryBO);</span><br><span class="line">        subjectCategory.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">        List&lt;SubjectCategory&gt; subjectCategoryList = subjectCategoryService.queryCategory(subjectCategory);</span><br><span class="line">        List&lt;SubjectCategoryBO&gt; boList = SubjectCategoryConverter.INSTANCE</span><br><span class="line">                .convertBoToCategory(subjectCategoryList);</span><br><span class="line">        <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;SubjectCategoryController.queryPrimaryCategory.boList:&#123;&#125;&quot;</span>,</span><br><span class="line">                    JSON.toJSONString(boList));</span><br><span class="line">        &#125;</span><br><span class="line">        boList.forEach(bo -&gt; &#123;</span><br><span class="line">            <span class="type">Integer</span> <span class="variable">subjectCount</span> <span class="operator">=</span> subjectCategoryService.querySubjectCount(bo.getId());</span><br><span class="line">            bo.setCount(subjectCount);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> boList;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>controller:ç”¨converter DTO-&gt;BO</p><p>domainservice: converter bo-&gt;categoryï¼Œç”¨serviceå¸¦ç€categoryå»æŸ¥,ç”¨Daoå»æŸ¥ï¼ˆdaoçš„æ¥å£+dao.xml,mapperscanèƒ½æ‰«æåˆ°ï¼‰æ•°æ®åº“ï¼Œè¿”å›List<SubjectCategory></p><p>controller:ç”¨converter bolist-&gt;dtolist</p><p>è¿”å›dtolistï¼Œç”¨Resultå°è£…ä¸€ä¸‹ï¼ŒæŸ¥å‡ºæ¥äº†</p><p>å…³äºä¸ºä»€ä¹ˆèƒ½å¤Ÿç”¨Resultè¿”å›ç”¨postmanå¯ä»¥æŸ¥åˆ°ï¼Œå…¶å®ç”¨äº†@RestControlleræ ‡è¯†ï¼š[SpringBootä»¥åŠé›†æˆç»„ä»¶æ³¨è§£å¤§å…¨è¯¦è§£ï¼ˆä¸€ï¼‰â€”â€”lomback &amp;&amp; JPA_@componentscanæ˜¯å¤åˆæ³¨è§£å—-CSDNåšå®¢](<a href="https://blog.csdn.net/qq_42133100/article/details/89084518?ops_request_misc=%7B%22request_id%22:%22172154818816800186530805%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=172154818816800186530805&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-89084518-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=lomback%E4%B8%AD@data">https://blog.csdn.net/qq_42133100/article/details/89084518?ops_request_misc=%7B%22request%5Fid%22%3A%22172154818816800186530805%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D&amp;request_id=172154818816800186530805&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-89084518-null-null.142^v100^pc_search_result_base8&amp;utm_term=lombackä¸­@data</a> RestController&amp;spm&#x3D;1018.2226.3001.4187)</p><p>[ã€MyBatisã€‘Daoæ¥å£å’ŒDao.xmlæ–‡ä»¶å¦‚ä½•å»ºç«‹è¿æ¥-CSDNåšå®¢](<a href="https://blog.csdn.net/weixin_45156425/article/details/120956070?ops_request_misc=%7B%22request_id%22:%22172154533316800207082850%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=172154533316800207082850&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-120956070-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=mybatis%E5%92%8Cdao">https://blog.csdn.net/weixin_45156425/article/details/120956070?ops_request_misc=%7B%22request%5Fid%22%3A%22172154533316800207082850%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D&amp;request_id=172154533316800207082850&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-120956070-null-null.142^v100^pc_search_result_base8&amp;utm_term=mybatiså’Œdao</a> xml&amp;spm&#x3D;1018.2226.3001.4187)</p><p><img src="https://s2.loli.net/2024/07/21/V6nFPGIOk5UmXSu.png" alt="image-20240721152600418.png"></p><p><strong>æ ¹æ®å¤§ç±»æŸ¥è¯¢äºŒçº§åˆ†ç±»</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ›´æ–°SubjectCategoryDomainService.java</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectCategoryDomainService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢åˆ†ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢å²—ä½å¤§ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;SubjectCategoryBO&gt; <span class="title function_">queryCategory</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//SubjectCategoryController.java</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®åˆ†ç±»idæŸ¥äºŒçº§åˆ†ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/queryCategoryByPrimary&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;List&lt;SubjectCategoryDTO&gt;&gt; <span class="title function_">queryCategoryByPrimary</span><span class="params">(<span class="meta">@RequestBody</span> SubjectCategoryDTO subjectCategoryDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;SubjectCategoryController.queryCategoryByPrimary.dto:&#123;&#125;&quot;</span></span><br><span class="line">                        , JSON.toJSONString(subjectCategoryDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkNotNull(subjectCategoryDTO.getParentId(), <span class="string">&quot;åˆ†ç±»idä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="type">SubjectCategoryBO</span> <span class="variable">subjectCategoryBO</span> <span class="operator">=</span> SubjectCategoryDTOConverter.INSTANCE.</span><br><span class="line">                    convertDtoToCategoryBO(subjectCategoryDTO);</span><br><span class="line">            List&lt;SubjectCategoryBO&gt; subjectCategoryBOList = subjectCategoryDomainService.queryCategory(subjectCategoryBO);</span><br><span class="line">            List&lt;SubjectCategoryDTO&gt; subjectCategoryDTOList = SubjectCategoryDTOConverter.INSTANCE.</span><br><span class="line">                    convertBoToCategoryDTOList(subjectCategoryBOList);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(subjectCategoryDTOList);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;SubjectCategoryController.queryPrimaryCategory.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æŸ¥è¯¢å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><strong>æ›´æ–°åˆ†ç±»</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°åˆ†ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/update&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> SubjectCategoryDTO subjectCategoryDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;SubjectCategoryController.update.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(subjectCategoryDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">SubjectCategoryBO</span> <span class="variable">subjectCategoryBO</span> <span class="operator">=</span> SubjectCategoryDTOConverter.INSTANCE.</span><br><span class="line">                    convertDtoToCategoryBO(subjectCategoryDTO);</span><br><span class="line">            <span class="type">Boolean</span> <span class="variable">result</span> <span class="operator">=</span> subjectCategoryDomainService.update(subjectCategoryBO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(result);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;SubjectCategoryController.update.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æ›´æ–°åˆ†ç±»å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//SubjectCategoryDomainService</span></span><br><span class="line">Boolean <span class="title function_">update</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span>;</span><br><span class="line"><span class="comment">//SubjectCategoryDomainServiceImpl</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">update</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span> &#123;</span><br><span class="line">        <span class="type">SubjectCategory</span> <span class="variable">subjectCategory</span> <span class="operator">=</span> SubjectCategoryConverter.INSTANCE</span><br><span class="line">                .convertBoToCategory(subjectCategoryBO);</span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> subjectCategoryService.update(subjectCategory);</span><br><span class="line">        <span class="keyword">return</span> count &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//SubjectCategoryService</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">update</span><span class="params">(SubjectCategory subjectCategory)</span>;</span><br><span class="line"><span class="comment">//SubjectCategoryServiceImpl</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">update</span><span class="params">(SubjectCategory subjectCategory)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.subjectCategoryDao.update(subjectCategory);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//SubjectCategoryDao</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">update</span><span class="params">(SubjectCategory subjectCategory)</span>;</span><br><span class="line"><span class="comment">//æ¥ä¸‹æ¥å°±æ˜¯é€šè¿‡SubjectCategoryD.xmlå’Œmybatisç»„ä»¶å»è¿›è¡Œæ•°æ®åº“çš„æ“ä½œ</span></span><br></pre></td></tr></table></figure><p><strong>åˆ é™¤åˆ†ç±»</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤åˆ†ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/delete&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">delete</span><span class="params">(<span class="meta">@RequestBody</span> SubjectCategoryDTO subjectCategoryDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;SubjectCategoryController.delete.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(subjectCategoryDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">SubjectCategoryBO</span> <span class="variable">subjectCategoryBO</span> <span class="operator">=</span> SubjectCategoryDTOConverter.INSTANCE.</span><br><span class="line">                    convertDtoToCategoryBO(subjectCategoryDTO);</span><br><span class="line">            <span class="type">Boolean</span> <span class="variable">result</span> <span class="operator">=</span> subjectCategoryDomainService.delete(subjectCategoryBO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(result);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;SubjectCategoryController.delete.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;åˆ é™¤åˆ†ç±»å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//SubjectCategoryDomainService</span></span><br><span class="line">Boolean <span class="title function_">delete</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span>;</span><br><span class="line"><span class="comment">//SubjectCategoryDomainServiceImpl</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">delete</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span> &#123;</span><br><span class="line">        <span class="type">SubjectCategory</span> <span class="variable">subjectCategory</span> <span class="operator">=</span> SubjectCategoryConverter.INSTANCE</span><br><span class="line">                .convertBoToCategory(subjectCategoryBO);</span><br><span class="line">        subjectCategory.setIsDeleted(IsDeletedFlagEnum.DELETED.getCode()); <span class="comment">//è®¾ç½®å·²ç»åˆ é™¤å­—æ®µ</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> subjectCategoryService.update(subjectCategory);</span><br><span class="line">        <span class="keyword">return</span> count &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//IsDeletedFlagEnum åœ¨commonåŒ…ä¸‹çš„enumä¸­</span></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">IsDeletedFlagEnum</span> &#123;</span><br><span class="line"></span><br><span class="line">    DELETED(<span class="number">1</span>,<span class="string">&quot;å·²åˆ é™¤&quot;</span>),</span><br><span class="line">    UN_DELETED(<span class="number">0</span>,<span class="string">&quot;æœªåˆ é™¤&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> code;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String desc;</span><br><span class="line"></span><br><span class="line">    IsDeletedFlagEnum(<span class="type">int</span> code, String desc)&#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">        <span class="built_in">this</span>.desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> IsDeletedFlagEnum <span class="title function_">getByCode</span><span class="params">(<span class="type">int</span> codeVal)</span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(IsDeletedFlagEnum resultCodeEnum : IsDeletedFlagEnum.values())&#123;</span><br><span class="line">            <span class="keyword">if</span>(resultCodeEnum.code == codeVal)&#123;</span><br><span class="line">                <span class="keyword">return</span> resultCodeEnum;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//SubjectCategoryService</span></span><br><span class="line"><span class="type">boolean</span> <span class="title function_">deleteById</span><span class="params">(Long id)</span>;</span><br><span class="line"><span class="comment">//SubjectCategoryServiceImpl</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">deleteById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.subjectCategoryDao.deleteById(id) &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//SubjectCategoryDao</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">deleteById</span><span class="params">(Long id)</span>;</span><br><span class="line"><span class="comment">//æ¥ä¸‹æ¥å°±æ˜¯é€šè¿‡SubjectCategoryD.xmlå’Œmybatisç»„ä»¶å»è¿›è¡Œæ•°æ®åº“çš„æ“ä½œ</span></span><br></pre></td></tr></table></figure><h6 id="é¢˜ç›®æ ‡ç­¾æ¥å£å®šä¹‰"><a href="#é¢˜ç›®æ ‡ç­¾æ¥å£å®šä¹‰" class="headerlink" title="é¢˜ç›®æ ‡ç­¾æ¥å£å®šä¹‰"></a>é¢˜ç›®æ ‡ç­¾æ¥å£å®šä¹‰</h6><ol><li><p>æ–°å¢æ ‡ç­¾</p><p>è¯·æ±‚ä½“ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SpringMVC&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span><span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å“åº”ç¤ºä¾‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;success&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span> <span class="number">200</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æˆåŠŸ&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>æ›´æ–°æ ‡ç­¾</p><p>è¯·æ±‚ä½“ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Spring&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">10</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å“åº”ç¤ºä¾‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;success&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span> <span class="number">200</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æˆåŠŸ&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>åˆ é™¤æ ‡ç­¾</p><p>è¯·æ±‚ä½“ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å“åº”ç¤ºä¾‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;success&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span> <span class="number">200</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æˆåŠŸ&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>æ ¹æ®åˆ†ç±»æŸ¥è¯¢æ ‡ç­¾</p><p>è¯·æ±‚ä½“ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å“åº”ç¤ºä¾‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;success&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span> <span class="number">200</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æˆåŠŸ&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SpringBoot&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;categoryId&quot;</span><span class="punctuation">:</span> <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;labelName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SpringMVC&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;sortNum&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li></ol><h6 id="æ ‡ç­¾åŸºç¡€æ¨¡å—å¼€å‘"><a href="#æ ‡ç­¾åŸºç¡€æ¨¡å—å¼€å‘" class="headerlink" title="æ ‡ç­¾åŸºç¡€æ¨¡å—å¼€å‘"></a>æ ‡ç­¾åŸºç¡€æ¨¡å—å¼€å‘</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SubjectLabelController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectLabelController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectLabelDomainService subjectLabelDomainService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢æ ‡ç­¾</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">add</span><span class="params">(<span class="meta">@RequestBody</span> SubjectLabelDTO subjectLabelDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;SubjectLabelController.add.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(subjectLabelDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkArgument(!StringUtils.isBlank(subjectLabelDTO.getLabelName()),</span><br><span class="line">                    <span class="string">&quot;æ ‡ç­¾åç§°ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="type">SubjectLabelBO</span> <span class="variable">subjectLabelBO</span> <span class="operator">=</span> SubjectLabelDTOConverter.INSTANCE.convertDtoToLabelBO(subjectLabelDTO);</span><br><span class="line">            <span class="type">Boolean</span> <span class="variable">result</span> <span class="operator">=</span> subjectLabelDomainService.add(subjectLabelBO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(result);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;SubjectLabelController.add.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æ–°å¢æ ‡ç­¾å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°æ ‡ç­¾</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/update&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> SubjectLabelDTO subjectLabelDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;SubjectLabelController.update.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(subjectLabelDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkNotNull(subjectLabelDTO.getId(), <span class="string">&quot;æ ‡ç­¾idä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="type">SubjectLabelBO</span> <span class="variable">subjectLabelBO</span> <span class="operator">=</span> SubjectLabelDTOConverter.INSTANCE.convertDtoToLabelBO(subjectLabelDTO);</span><br><span class="line">            <span class="type">Boolean</span> <span class="variable">result</span> <span class="operator">=</span> subjectLabelDomainService.update(subjectLabelBO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(result);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;SubjectLabelController.update.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æ›´æ–°æ ‡ç­¾å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤æ ‡ç­¾</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/delete&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">delete</span><span class="params">(<span class="meta">@RequestBody</span> SubjectLabelDTO subjectLabelDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;SubjectLabelController.delete.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(subjectLabelDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkNotNull(subjectLabelDTO.getId(), <span class="string">&quot;æ ‡ç­¾idä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="type">SubjectLabelBO</span> <span class="variable">subjectLabelBO</span> <span class="operator">=</span> SubjectLabelDTOConverter.INSTANCE.convertDtoToLabelBO(subjectLabelDTO);</span><br><span class="line">            <span class="type">Boolean</span> <span class="variable">result</span> <span class="operator">=</span> subjectLabelDomainService.delete(subjectLabelBO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(result);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;SubjectLabelController.delete.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;åˆ é™¤æ ‡ç­¾å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢åˆ†ç±»ä¸‹æ ‡ç­¾</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/queryLabelByCategoryId&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;List&lt;SubjectLabelDTO&gt;&gt; <span class="title function_">queryLabelByCategoryId</span><span class="params">(<span class="meta">@RequestBody</span> SubjectLabelDTO subjectLabelDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;SubjectLabelController.queryLabelByCategoryId.dto:&#123;&#125;&quot;</span>,</span><br><span class="line">                        JSON.toJSONString(subjectLabelDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkNotNull(subjectLabelDTO.getCategoryId(), <span class="string">&quot;åˆ†ç±»idä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="type">SubjectLabelBO</span> <span class="variable">subjectLabelBO</span> <span class="operator">=</span> SubjectLabelDTOConverter.INSTANCE.convertDtoToLabelBO(subjectLabelDTO);</span><br><span class="line">            List&lt;SubjectLabelBO&gt; resultList = subjectLabelDomainService.queryLabelByCategoryId(subjectLabelBO);</span><br><span class="line">            List&lt;SubjectLabelDTO&gt; subjectLabelDTOS = SubjectLabelDTOConverter.INSTANCE.convertBOToLabelDTOList(resultList);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(subjectLabelDTOS);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;SubjectLabelController.queryLabelByCategoryId.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æŸ¥è¯¢åˆ†ç±»ä¸‹æ ‡ç­¾å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SubjectLabelDTOConverter</span></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectLabelDTOConverter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">SubjectLabelDTOConverter</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(SubjectLabelDTOConverter.class);</span><br><span class="line"></span><br><span class="line">    SubjectLabelBO <span class="title function_">convertDtoToLabelBO</span><span class="params">(SubjectLabelDTO subjectLabelDTO)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;SubjectLabelDTO&gt; <span class="title function_">convertBOToLabelDTOList</span><span class="params">(List&lt;SubjectLabelBO&gt; boList)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//SubjectLabelConverter</span></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectLabelConverter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">SubjectLabelConverter</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(SubjectLabelConverter.class);</span><br><span class="line"></span><br><span class="line">    SubjectLabel <span class="title function_">convertBoToLabel</span><span class="params">(SubjectLabelBO subjectLabelBO)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;SubjectLabelBO&gt; <span class="title function_">convertLabelToBoList</span><span class="params">(List&lt;SubjectLabel&gt; subjectLabelList)</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//SubjectLabelDTO</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectLabelDTO</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»é”®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†ç±»id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long categoryId;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ‡ç­¾åˆ†ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String labelName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ’åº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer sortNum;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//SubjectLabelBO</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectLabelBO</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»é”®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ‡ç­¾åˆ†ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String labelName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ’åº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer sortNum;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†ç±»id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long categoryId;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SubjectLabelDomainService</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectLabelDomainService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢æ ‡ç­¾</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Boolean <span class="title function_">add</span><span class="params">(SubjectLabelBO subjectLabelBO)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°æ ‡ç­¾</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Boolean <span class="title function_">update</span><span class="params">(SubjectLabelBO subjectLabelBO)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤æ ‡ç­¾</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Boolean <span class="title function_">delete</span><span class="params">(SubjectLabelBO subjectLabelBO)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢åˆ†ç±»ä¸‹æ ‡ç­¾</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;SubjectLabelBO&gt; <span class="title function_">queryLabelByCategoryId</span><span class="params">(SubjectLabelBO subjectLabelBO)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//SubjectLabelDomainServiceImpl</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectLabelDomainServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">SubjectLabelDomainService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectLabelService subjectLabelService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectMappingService subjectMappingService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectCategoryService subjectCategoryService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">add</span><span class="params">(SubjectLabelBO subjectLabelBO)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;SubjectLabelDomainServiceImpl.add.bo:&#123;&#125;&quot;</span>, JSON.toJSONString(subjectLabelBO));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">SubjectLabel</span> <span class="variable">subjectLabel</span> <span class="operator">=</span> SubjectLabelConverter.INSTANCE</span><br><span class="line">                .convertBoToLabel(subjectLabelBO);</span><br><span class="line">        subjectLabel.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> subjectLabelService.insert(subjectLabel);</span><br><span class="line">        <span class="keyword">return</span> count &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">update</span><span class="params">(SubjectLabelBO subjectLabelBO)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;SubjectLabelDomainServiceImpl.update.bo:&#123;&#125;&quot;</span>, JSON.toJSONString(subjectLabelBO));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">SubjectLabel</span> <span class="variable">subjectLabel</span> <span class="operator">=</span> SubjectLabelConverter.INSTANCE</span><br><span class="line">                .convertBoToLabel(subjectLabelBO);</span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> subjectLabelService.update(subjectLabel);</span><br><span class="line">        <span class="keyword">return</span> count &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">delete</span><span class="params">(SubjectLabelBO subjectLabelBO)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;SubjectLabelDomainServiceImpl.update.bo:&#123;&#125;&quot;</span>, JSON.toJSONString(subjectLabelBO));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">SubjectLabel</span> <span class="variable">subjectLabel</span> <span class="operator">=</span> SubjectLabelConverter.INSTANCE</span><br><span class="line">                .convertBoToLabel(subjectLabelBO);</span><br><span class="line">        subjectLabel.setIsDeleted(IsDeletedFlagEnum.DELETED.getCode());</span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> subjectLabelService.update(subjectLabel);</span><br><span class="line">        <span class="keyword">return</span> count &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;SubjectLabelBO&gt; <span class="title function_">queryLabelByCategoryId</span><span class="params">(SubjectLabelBO subjectLabelBO)</span> &#123;</span><br><span class="line">        <span class="comment">//å¦‚æœå½“å‰åˆ†ç±»æ˜¯1çº§åˆ†ç±»ï¼Œåˆ™æŸ¥è¯¢æ‰€æœ‰æ ‡ç­¾</span></span><br><span class="line">        <span class="type">SubjectCategory</span> <span class="variable">subjectCategory</span> <span class="operator">=</span> subjectCategoryService.queryById(subjectLabelBO.getCategoryId());</span><br><span class="line">        <span class="keyword">if</span>(CategoryTypeEnum.PRIMARY.getCode() == subjectCategory.getCategoryType())&#123;</span><br><span class="line">            <span class="type">SubjectLabel</span> <span class="variable">subjectLabel</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectLabel</span>();</span><br><span class="line">            subjectLabel.setCategoryId(subjectLabelBO.getCategoryId());</span><br><span class="line">            List&lt;SubjectLabel&gt; labelList = subjectLabelService.queryByCondition(subjectLabel);</span><br><span class="line">            List&lt;SubjectLabelBO&gt; labelResultList = SubjectLabelConverter.INSTANCE.convertLabelToBoList(labelList);</span><br><span class="line">            <span class="keyword">return</span> labelResultList;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Long</span> <span class="variable">categoryId</span> <span class="operator">=</span> subjectLabelBO.getCategoryId();</span><br><span class="line">        <span class="type">SubjectMapping</span> <span class="variable">subjectMapping</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectMapping</span>();</span><br><span class="line">        subjectMapping.setCategoryId(categoryId);</span><br><span class="line">        subjectMapping.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">        List&lt;SubjectMapping&gt; mappingList = subjectMappingService.queryLabelId(subjectMapping);</span><br><span class="line">        <span class="keyword">if</span> (CollectionUtils.isEmpty(mappingList)) &#123;</span><br><span class="line">            <span class="keyword">return</span> Collections.emptyList();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å°†mappingListè½¬æ¢ä¸ºä¸€ä¸ªæµï¼ˆStreamï¼‰,ä½¿ç”¨mapæ“ä½œå¯¹æµä¸­çš„æ¯ä¸ªå…ƒç´ ï¼ˆSubjectMappingå¯¹è±¡ï¼‰åº”ç”¨ä¸€ä¸ªå‡½æ•°,ä½¿ç”¨collectæ“ä½œå°†æµä¸­çš„å…ƒç´ æ±‡æ€»æˆ–å½’çº³åˆ°ä¸€ä¸ªæ–°çš„é›†åˆä¸­</span></span><br><span class="line">        List&lt;Long&gt; labelIdList = mappingList.stream().map(SubjectMapping::getLabelId).collect(Collectors.toList());</span><br><span class="line">        List&lt;SubjectLabel&gt; labelList = subjectLabelService.batchQueryById(labelIdList);</span><br><span class="line">        List&lt;SubjectLabelBO&gt; boList = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        labelList.forEach(label -&gt; &#123; <span class="comment">//lamdaè¡¨è¾¾å¼</span></span><br><span class="line">            <span class="type">SubjectLabelBO</span> <span class="variable">bo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectLabelBO</span>();</span><br><span class="line">            bo.setId(label.getId());</span><br><span class="line">            bo.setLabelName(label.getLabelName());</span><br><span class="line">            bo.setCategoryId(categoryId);</span><br><span class="line">            bo.setSortNum(label.getSortNum());</span><br><span class="line">            boList.add(bo);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> boList;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//SubjectMappingService</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectMappingService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡IDæŸ¥è¯¢å•æ¡æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    SubjectMapping <span class="title function_">queryById</span><span class="params">(<span class="type">int</span> id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subjectMapping å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    SubjectMapping <span class="title function_">insert</span><span class="params">(SubjectMapping subjectMapping)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subjectMapping å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">update</span><span class="params">(SubjectMapping subjectMapping)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡ä¸»é”®åˆ é™¤æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ˜¯å¦æˆåŠŸ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">deleteById</span><span class="params">(<span class="type">int</span> id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢æ ‡ç­¾id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;SubjectMapping&gt; <span class="title function_">queryLabelId</span><span class="params">(SubjectMapping subjectMapping)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰¹é‡æ’å…¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">batchInsert</span><span class="params">(List&lt;SubjectMapping&gt; mappingList)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//SubjectMappingServiceImpl</span></span><br><span class="line"><span class="meta">@Service(&quot;subjectMappingService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectMappingServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">SubjectMappingService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectMappingDao subjectMappingDao;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡IDæŸ¥è¯¢å•æ¡æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> SubjectMapping <span class="title function_">queryById</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.subjectMappingDao.queryById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subjectMapping å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> SubjectMapping <span class="title function_">insert</span><span class="params">(SubjectMapping subjectMapping)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.subjectMappingDao.insert(subjectMapping);</span><br><span class="line">        <span class="keyword">return</span> subjectMapping;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subjectMapping å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">update</span><span class="params">(SubjectMapping subjectMapping)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.subjectMappingDao.update(subjectMapping);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡ä¸»é”®åˆ é™¤æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ˜¯å¦æˆåŠŸ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">deleteById</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.subjectMappingDao.deleteById(id) &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;SubjectMapping&gt; <span class="title function_">queryLabelId</span><span class="params">(SubjectMapping subjectMapping)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.subjectMappingDao.queryDistinctLabelId(subjectMapping);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">batchInsert</span><span class="params">(List&lt;SubjectMapping&gt; mappingList)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.subjectMappingDao.insertBatch(mappingList);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="æ ‡ç­¾ä¸šåŠ¡æ”¹åŠ¨"><a href="#æ ‡ç­¾ä¸šåŠ¡æ”¹åŠ¨" class="headerlink" title="æ ‡ç­¾ä¸šåŠ¡æ”¹åŠ¨"></a>æ ‡ç­¾ä¸šåŠ¡æ”¹åŠ¨</h6><p>å°†ä¸€çº§åˆ†ç±»å’Œæ ‡ç­¾è”ç³»èµ·æ¥</p><p><img src="https://s2.loli.net/2024/07/28/cHv61yPJdFUGBVZ.png" alt="image-20240728114457915.png"></p><p><code>SubjectLabelDao.xml</code></p><p><img src="https://s2.loli.net/2024/07/28/AjiBfXphTF9ctyV.png" alt="image-20240728114229629.png"></p><p>domainå±‚ä¹Ÿè·Ÿç€æ”¹</p><h6 id="é¢˜ç›®æ¨¡å—æ¥å£å®šä¹‰"><a href="#é¢˜ç›®æ¨¡å—æ¥å£å®šä¹‰" class="headerlink" title="é¢˜ç›®æ¨¡å—æ¥å£å®šä¹‰"></a>é¢˜ç›®æ¨¡å—æ¥å£å®šä¹‰</h6><ol><li><p>æ–°å¢å•é€‰é¢˜ç›®</p><p>è¯·æ±‚ä½“ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;subjectName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;SpringBootè‡ªåŠ¨è£…é…åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;subjectDifficult&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;subjectType&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;subjectScore&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;subjectParse&quot;</span><span class="punctuation">:</span> <span class="string">&quot;é¢˜ç›®è§£æ&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;categoryIds&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">5</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;labelIds&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">3</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;optionList&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;optionType&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;optionContent&quot;</span><span class="punctuation">:</span> <span class="string">&quot;è‡ªåŠ¨çš„&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;isCorrect&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;optionType&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;optionContent&quot;</span><span class="punctuation">:</span> <span class="string">&quot;å…¶å®æ˜¯ç”¨é…ç½®æ–‡ä»¶&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;isCorrect&quot;</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å“åº”æˆåŠŸç¤ºä¾‹ï¼š</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"><span class="attr">&quot;success&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;code&quot;</span><span class="punctuation">:</span> <span class="number">200</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="string">&quot;æˆåŠŸ&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>æ–°å¢å¤šé€‰é¢˜ç›®</p><p>è¯·æ±‚ä½“ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;subjectName&quot;</span>: <span class="string">&quot;SpringBootè‡ªåŠ¨è£…é…åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;subjectDifficult&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&quot;subjectType&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="string">&quot;subjectScore&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="string">&quot;subjectParse&quot;</span>: <span class="string">&quot;é¢˜ç›®è§£æ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;categoryIds&quot;</span>: [</span><br><span class="line">        <span class="number">4</span>,</span><br><span class="line">        <span class="number">5</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;labelIds&quot;</span>: [</span><br><span class="line">        <span class="number">2</span>,</span><br><span class="line">        <span class="number">3</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;optionList&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;optionType&quot;</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="string">&quot;optionContent&quot;</span>: <span class="string">&quot;è‡ªåŠ¨çš„&quot;</span>,</span><br><span class="line">            <span class="string">&quot;isCorrect&quot;</span>: <span class="number">1</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;optionType&quot;</span>: <span class="number">2</span>,</span><br><span class="line">            <span class="string">&quot;optionContent&quot;</span>: <span class="string">&quot;å…¶å®æ˜¯ç”¨é…ç½®æ–‡ä»¶&quot;</span>,</span><br><span class="line">            <span class="string">&quot;isCorrect&quot;</span>: <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å“åº”æˆåŠŸç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;success&quot;</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="string">&quot;code&quot;</span>: <span class="number">200</span>,</span><br><span class="line"><span class="string">&quot;message&quot;</span>: <span class="string">&quot;æˆåŠŸ&quot;</span>,</span><br><span class="line"><span class="string">&quot;data&quot;</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æ–°å¢åˆ¤æ–­é¢˜ç›®</p><p>è¯·æ±‚ä½“ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;subjectName&quot;</span>: <span class="string">&quot;SpringBootè‡ªåŠ¨è£…é…åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;subjectDifficult&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&quot;subjectType&quot;</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="string">&quot;subjectScore&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="string">&quot;subjectParse&quot;</span>: <span class="string">&quot;é¢˜ç›®è§£æ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;categoryIds&quot;</span>: [</span><br><span class="line">        <span class="number">4</span>,</span><br><span class="line">        <span class="number">5</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;labelIds&quot;</span>: [</span><br><span class="line">        <span class="number">2</span>,</span><br><span class="line">        <span class="number">3</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;optionList&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;isCorrect&quot;</span>: <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å“åº”æˆåŠŸç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;success&quot;</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="string">&quot;code&quot;</span>: <span class="number">200</span>,</span><br><span class="line"><span class="string">&quot;message&quot;</span>: <span class="string">&quot;æˆåŠŸ&quot;</span>,</span><br><span class="line"><span class="string">&quot;data&quot;</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æ–°å¢ç®€ç­”é¢˜ç›®</p><p>è¯·æ±‚ä½“ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;subjectName&quot;</span>: <span class="string">&quot;Mysqlæ˜¯ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Ÿ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;subjectDifficult&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&quot;subjectType&quot;</span>: <span class="number">4</span>,</span><br><span class="line">    <span class="string">&quot;subjectScore&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="string">&quot;subjectParse&quot;</span>: <span class="string">&quot;é¢˜ç›®è§£æ2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;subjectAnswer&quot;</span>: <span class="string">&quot;Mysqlæ˜¯ä¸ªæ•°æ®åº“&quot;</span>,</span><br><span class="line">    <span class="string">&quot;categoryIds&quot;</span>: [</span><br><span class="line">        <span class="number">5</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&quot;labelIds&quot;</span>: [</span><br><span class="line">        <span class="number">11</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å“åº”ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;success&quot;</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="string">&quot;code&quot;</span>: <span class="number">200</span>,</span><br><span class="line"><span class="string">&quot;message&quot;</span>: <span class="string">&quot;æˆåŠŸ&quot;</span>,</span><br><span class="line"><span class="string">&quot;data&quot;</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥è¯¢é¢˜ç›®åˆ—è¡¨</p><p>è¯·æ±‚ä½“ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;pageNo&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="string">&quot;pageSize&quot;</span>: <span class="number">10</span>,</span><br><span class="line">    <span class="string">&quot;labelId&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&quot;categoryId&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="string">&quot;subjectDifficult&quot;</span>: <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å“åº”ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;success&quot;</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="string">&quot;code&quot;</span>: <span class="number">200</span>,</span><br><span class="line"><span class="string">&quot;message&quot;</span>: <span class="string">&quot;æˆåŠŸ&quot;</span>,</span><br><span class="line"><span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line"><span class="string">&quot;pageNo&quot;</span>: <span class="number">1</span>,</span><br><span class="line"><span class="string">&quot;pageSize&quot;</span>: <span class="number">20</span>,</span><br><span class="line"><span class="string">&quot;total&quot;</span>: <span class="number">1</span>,</span><br><span class="line"><span class="string">&quot;totalPages&quot;</span>: <span class="number">1</span>,</span><br><span class="line"><span class="string">&quot;result&quot;</span>: [</span><br><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;pageNo&quot;</span>: <span class="number">1</span>,</span><br><span class="line"><span class="string">&quot;pageSize&quot;</span>: <span class="number">20</span>,</span><br><span class="line"><span class="string">&quot;id&quot;</span>: <span class="number">9</span>,</span><br><span class="line"><span class="string">&quot;subjectName&quot;</span>: <span class="string">&quot;SpringBootè‡ªåŠ¨è£…é…åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ&quot;</span>,</span><br><span class="line"><span class="string">&quot;subjectDifficult&quot;</span>: <span class="number">1</span>,</span><br><span class="line"><span class="string">&quot;subjectType&quot;</span>: <span class="number">4</span>,</span><br><span class="line"><span class="string">&quot;subjectScore&quot;</span>: <span class="number">2</span>,</span><br><span class="line"><span class="string">&quot;subjectParse&quot;</span>: <span class="string">&quot;é¢˜ç›®è§£æ&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">],</span><br><span class="line"><span class="string">&quot;start&quot;</span>: <span class="number">1</span>,</span><br><span class="line"><span class="string">&quot;end&quot;</span>: <span class="number">20</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥è¯¢é¢˜ç›®åˆ—è¡¨</p><p>è¯·æ±‚ä½“ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;pageNo&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="string">&quot;pageSize&quot;</span>: <span class="number">10</span>,</span><br><span class="line">    <span class="string">&quot;labelId&quot;</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">&quot;categoryId&quot;</span>: <span class="number">2</span>,</span><br><span class="line">    <span class="string">&quot;subjectDifficult&quot;</span>: <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å“åº”ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;success&quot;</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="string">&quot;code&quot;</span>: <span class="number">200</span>,</span><br><span class="line"><span class="string">&quot;message&quot;</span>: <span class="string">&quot;æˆåŠŸ&quot;</span>,</span><br><span class="line"><span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line"><span class="string">&quot;pageNo&quot;</span>: <span class="number">1</span>,</span><br><span class="line"><span class="string">&quot;pageSize&quot;</span>: <span class="number">20</span>,</span><br><span class="line"><span class="string">&quot;total&quot;</span>: <span class="number">1</span>,</span><br><span class="line"><span class="string">&quot;totalPages&quot;</span>: <span class="number">1</span>,</span><br><span class="line"><span class="string">&quot;result&quot;</span>: [</span><br><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;pageNo&quot;</span>: <span class="number">1</span>,</span><br><span class="line"><span class="string">&quot;pageSize&quot;</span>: <span class="number">20</span>,</span><br><span class="line"><span class="string">&quot;id&quot;</span>: <span class="number">9</span>,</span><br><span class="line"><span class="string">&quot;subjectName&quot;</span>: <span class="string">&quot;SpringBootè‡ªåŠ¨è£…é…åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ&quot;</span>,</span><br><span class="line"><span class="string">&quot;subjectDifficult&quot;</span>: <span class="number">1</span>,</span><br><span class="line"><span class="string">&quot;subjectType&quot;</span>: <span class="number">4</span>,</span><br><span class="line"><span class="string">&quot;subjectScore&quot;</span>: <span class="number">2</span>,</span><br><span class="line"><span class="string">&quot;subjectParse&quot;</span>: <span class="string">&quot;é¢˜ç›®è§£æ&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">],</span><br><span class="line"><span class="string">&quot;start&quot;</span>: <span class="number">1</span>,</span><br><span class="line"><span class="string">&quot;end&quot;</span>: <span class="number">20</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>æŸ¥è¯¢é¢˜ç›®è¯¦æƒ…</p><p>è¯·æ±‚ä½“ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;id&quot;</span>: <span class="number">100</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å“åº”ä½“ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;success&quot;</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="string">&quot;code&quot;</span>: <span class="number">200</span>,</span><br><span class="line"><span class="string">&quot;message&quot;</span>: <span class="string">&quot;æˆåŠŸ&quot;</span>,</span><br><span class="line"><span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line"><span class="string">&quot;pageNo&quot;</span>: <span class="number">1</span>,</span><br><span class="line"><span class="string">&quot;pageSize&quot;</span>: <span class="number">20</span>,</span><br><span class="line"><span class="string">&quot;id&quot;</span>: <span class="number">9</span>,</span><br><span class="line"><span class="string">&quot;subjectName&quot;</span>: <span class="string">&quot;SpringBootè‡ªåŠ¨è£…é…åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ&quot;</span>,</span><br><span class="line"><span class="string">&quot;subjectDifficult&quot;</span>: <span class="number">1</span>,</span><br><span class="line"><span class="string">&quot;subjectType&quot;</span>: <span class="number">4</span>,</span><br><span class="line"><span class="string">&quot;subjectScore&quot;</span>: <span class="number">2</span>,</span><br><span class="line"><span class="string">&quot;subjectParse&quot;</span>: <span class="string">&quot;é¢˜ç›®è§£æ&quot;</span>,</span><br><span class="line"><span class="string">&quot;subjectAnswer&quot;</span>: <span class="string">&quot;é¢˜ç›®ç­”æ¡ˆ&quot;</span>,</span><br><span class="line"><span class="string">&quot;labelName&quot;</span>: [</span><br><span class="line"><span class="string">&quot;SpringBoot&quot;</span>,</span><br><span class="line"><span class="string">&quot;SpringMVC&quot;</span></span><br><span class="line">]</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h6 id="é¢˜ç›®æ¨¡å—æ¥å£å¼€å‘"><a href="#é¢˜ç›®æ¨¡å—æ¥å£å¼€å‘" class="headerlink" title="é¢˜ç›®æ¨¡å—æ¥å£å¼€å‘"></a>é¢˜ç›®æ¨¡å—æ¥å£å¼€å‘</h6><p>é¢˜ç›®æ¨¡å—æ¥å£å¼€å‘æ˜¯ç¨‹åºå‘˜ç¤¾åŒºé¡¹ç›®ä¸­ç”¨äºç®¡ç†é¢˜ç›®ä¿¡æ¯çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚å®ƒæ¶‰åŠä¸€ç³»åˆ—æ¥å£ï¼Œç”¨äºå®ç°é¢˜ç›®çš„æ–°å¢ã€æŸ¥è¯¢ã€æ›´æ–°å’Œåˆ é™¤ç­‰æ“ä½œã€‚è¿™äº›æ¥å£åŒ…æ‹¬ä½†ä¸é™äºï¼š</p><ul><li>æ–°å¢å•é€‰ã€å¤šé€‰ã€åˆ¤æ–­å’Œç®€ç­”é¢˜ç›®çš„æ¥å£ï¼Œå…è®¸ç”¨æˆ·æäº¤é¢˜ç›®åç§°ã€éš¾åº¦ã€ç±»å‹ã€åˆ†æ•°ã€è§£æã€æ‰€å±åˆ†ç±»å’Œæ ‡ç­¾ç­‰ä¿¡æ¯ã€‚</li><li>æŸ¥è¯¢é¢˜ç›®åˆ—è¡¨çš„æ¥å£ï¼Œæ”¯æŒåˆ†é¡µæŸ¥è¯¢ï¼Œå¹¶å¯æ ¹æ®åˆ†ç±»ã€æ ‡ç­¾ã€éš¾åº¦ç­‰æ¡ä»¶è¿›è¡Œç­›é€‰ã€‚</li><li>æŸ¥è¯¢é¢˜ç›®è¯¦æƒ…çš„æ¥å£ï¼Œé€šè¿‡é¢˜ç›®IDè·å–è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬é¢˜ç›®ç±»å‹ã€å†…å®¹ã€é€‰é¡¹ã€æ­£ç¡®ç­”æ¡ˆå’Œè§£æç­‰ã€‚</li></ul><p>ä»£ç å±‚é¢ï¼Œé¢˜ç›®æ¨¡å—æ¥å£å¼€å‘ä½¿ç”¨äº†Spring Bootæ¡†æ¶æ¥æ„å»ºRESTful APIï¼Œå¹¶é‡‡ç”¨äº†DTOï¼ˆData Transfer Objectï¼‰å’ŒBOï¼ˆBusiness Objectï¼‰æ¨¡å¼æ¥åˆ†ç¦»æ•°æ®ä¼ è¾“å’Œä¸šåŠ¡é€»è¾‘ã€‚é€šè¿‡MapStructåº“å®ç°äº†DTOä¸BOä¹‹é—´çš„è‡ªåŠ¨è½¬æ¢ï¼Œä»¥ç®€åŒ–ä»£ç å¹¶å‡å°‘é‡å¤æ€§å·¥ä½œã€‚æ­¤å¤–ï¼ŒæœåŠ¡å±‚ï¼ˆServiceï¼‰å’Œæ•°æ®è®¿é—®å±‚ï¼ˆDAOï¼‰çš„åˆ†ç¦»ç¡®ä¿äº†ä¸šåŠ¡é€»è¾‘çš„æ¸…æ™°å’Œæ•°æ®è®¿é—®çš„é«˜æ•ˆæ€§ã€‚</p><p>åœ¨å®ç°ä¸Šï¼Œé¢˜ç›®æ¨¡å—æ¥å£åˆ©ç”¨äº†Lombokåº“æ¥è‡ªåŠ¨ç”Ÿæˆgetterã€setterç­‰æ–¹æ³•ï¼Œä»¥åŠä½¿ç”¨Springæ¡†æ¶çš„æ³¨è§£å¦‚<code>@RestController</code>å’Œ<code>@RequestMapping</code>æ¥ç®€åŒ–è·¯ç”±é…ç½®ã€‚æ—¥å¿—è®°å½•é‡‡ç”¨SLF4Jä¸Log4j2ï¼Œç¡®ä¿äº†æ—¥å¿—çš„çµæ´»æ€§å’Œå¯é…ç½®æ€§ã€‚æ­¤å¤–ï¼Œé€šè¿‡ä½¿ç”¨Springçš„äº‹åŠ¡ç®¡ç†<code>@Transactional</code>ï¼Œä¿è¯äº†æ•°æ®æ“ä½œçš„åŸå­æ€§å’Œä¸€è‡´æ€§ã€‚</p><p>æ•´ä½“è€Œè¨€ï¼Œé¢˜ç›®æ¨¡å—æ¥å£å¼€å‘ä¸ºç¨‹åºå‘˜ç¤¾åŒºé¡¹ç›®æä¾›äº†ä¸€ä¸ªç¨³å®šã€å¯æ‰©å±•ä¸”æ˜“äºç»´æŠ¤çš„åç«¯æœåŠ¡ï¼Œä»¥æ”¯æŒé¢˜ç›®å†…å®¹çš„ç®¡ç†ä¸å±•ç¤ºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SubjectInfoBO</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectInfoBO</span> <span class="keyword">extends</span> <span class="title class_">PageInfo</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»é”®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¢˜ç›®åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String subjectName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¢˜ç›®éš¾åº¦</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer subjectDifficult;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‡ºé¢˜äººå</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String settleName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¢˜ç›®ç±»å‹ 1å•é€‰ 2å¤šé€‰ 3åˆ¤æ–­ 4ç®€ç­”</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer subjectType;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¢˜ç›®åˆ†æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer subjectScore;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¢˜ç›®è§£æ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String subjectParse;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¢˜ç›®ç­”æ¡ˆ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String subjectAnswer;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†ç±»id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Integer&gt; categoryIds;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ‡ç­¾id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Integer&gt; labelIds;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ‡ç­¾name</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; labelName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç­”æ¡ˆé€‰é¡¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;SubjectAnswerBO&gt; optionList;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long categoryId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long labelId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String keyWord;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºäººæ˜µç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String createUser;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºäººå¤´åƒ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String createUserAvatar;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¢˜ç›®æ•°é‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer subjectCount;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦è¢«å½“å‰ç”¨æˆ·ç‚¹èµ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Boolean liked;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å½“å‰é¢˜ç›®ç‚¹èµçš„æ•°é‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer likedCount;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸‹ä¸€é¢˜</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long nextSubjectId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸Šä¸€é¢˜</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long lastSubjectId;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//PageResult</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PageResult</span>&lt;T&gt; <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Integer</span> <span class="variable">pageNo</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Integer</span> <span class="variable">pageSize</span> <span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Integer</span> <span class="variable">total</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Integer</span> <span class="variable">totalPages</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;T&gt; result = Collections.emptyList();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Integer</span> <span class="variable">start</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Integer</span> <span class="variable">end</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRecords</span><span class="params">(List&lt;T&gt; result)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.result = result;</span><br><span class="line">        <span class="keyword">if</span> (result != <span class="literal">null</span> &amp;&amp; result.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            setTotal(result.size());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setTotal</span><span class="params">(Integer total)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.total = total;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">this</span>.pageSize &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">this</span>.totalPages = (total / <span class="built_in">this</span>.pageSize) + (total % <span class="built_in">this</span>.pageSize == <span class="number">0</span> ? <span class="number">0</span> : <span class="number">1</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.totalPages = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.start = (<span class="built_in">this</span>.pageSize &gt; <span class="number">0</span> ? (<span class="built_in">this</span>.pageNo - <span class="number">1</span>) * <span class="built_in">this</span>.pageSize : <span class="number">0</span>) + <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">this</span>.end = (<span class="built_in">this</span>.start - <span class="number">1</span> + <span class="built_in">this</span>.pageSize * (<span class="built_in">this</span>.pageNo &gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPageSize</span><span class="params">(Integer pageSize)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.pageSize = pageSize;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPageNo</span><span class="params">(Integer pageNo)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.pageNo = pageNo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//PageInfo</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PageInfo</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Integer</span> <span class="variable">pageNo</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Integer</span> <span class="variable">pageSize</span> <span class="operator">=</span> <span class="number">20</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getPageNo</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (pageNo == <span class="literal">null</span> || pageNo &lt; <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> pageNo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getPageSize</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (pageSize == <span class="literal">null</span> || pageSize &lt; <span class="number">1</span> || pageSize &gt; Integer.MAX_VALUE) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">20</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> pageSize;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//SubjectAnswerBO</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectAnswerBO</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç­”æ¡ˆé€‰é¡¹æ ‡è¯†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer optionType;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç­”æ¡ˆ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String optionContent;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦æ­£ç¡®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer isCorrect;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//SubjectAnswerDTO</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectAnswerDTO</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç­”æ¡ˆé€‰é¡¹æ ‡è¯†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer optionType;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç­”æ¡ˆ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String optionContent;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦æ­£ç¡®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer isCorrect;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//SubjectOptionBO</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectOptionBO</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¢˜ç›®ç­”æ¡ˆ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String subjectAnswer;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç­”æ¡ˆé€‰é¡¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;SubjectAnswerBO&gt; optionList;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SubjectInfo</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectInfo</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">71318372165220898L</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»é”®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¢˜ç›®åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String subjectName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¢˜ç›®éš¾åº¦</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer subjectDifficult;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‡ºé¢˜äººå</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String settleName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¢˜ç›®ç±»å‹ 1å•é€‰ 2å¤šé€‰ 3åˆ¤æ–­ 4ç®€ç­”</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer subjectType;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¢˜ç›®åˆ†æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer subjectScore;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¢˜ç›®è§£æ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String subjectParse;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºäºº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String createdBy;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºæ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date createdTime;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹äºº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String updateBy;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date updateTime;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Integer isDeleted;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer subjectCount;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SubjectInfoDTO</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectInfoDTO</span> <span class="keyword">extends</span> <span class="title class_">PageInfo</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸»é”®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¢˜ç›®åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String subjectName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¢˜ç›®éš¾åº¦</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer subjectDifficult;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‡ºé¢˜äººå</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String settleName;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¢˜ç›®ç±»å‹ 1å•é€‰ 2å¤šé€‰ 3åˆ¤æ–­ 4ç®€ç­”</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer subjectType;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¢˜ç›®åˆ†æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer subjectScore;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¢˜ç›®è§£æ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String subjectParse;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¢˜ç›®ç­”æ¡ˆ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String subjectAnswer;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†ç±»id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Integer&gt; categoryIds;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ‡ç­¾id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Integer&gt; labelIds;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç­”æ¡ˆé€‰é¡¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;SubjectAnswerDTO&gt; optionList;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ‡ç­¾name</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; labelName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long categoryId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long labelId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String keyWord;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºäººæ˜µç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String createUser;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºäººå¤´åƒ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String createUserAvatar;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¢˜ç›®æ•°é‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer subjectCount;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦è¢«å½“å‰ç”¨æˆ·ç‚¹èµ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Boolean liked;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å½“å‰é¢˜ç›®ç‚¹èµçš„æ•°é‡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer likedCount;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸‹ä¸€é¢˜</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long nextSubjectId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸Šä¸€é¢˜</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long lastSubjectId;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//SubjectTypeHandler</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectTypeHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æšä¸¾èº«ä»½çš„è¯†åˆ«</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    SubjectInfoTypeEnum <span class="title function_">getHandlerType</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å®é™…çš„é¢˜ç›®çš„æ’å…¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(SubjectInfoBO subjectInfoBO)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å®é™…çš„é¢˜ç›®çš„æ’å…¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    SubjectOptionBO <span class="title function_">query</span><span class="params">(<span class="type">int</span> subjectId)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//BriefTypeHandler</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BriefTypeHandler</span> <span class="keyword">implements</span> <span class="title class_">SubjectTypeHandler</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectBriefService subjectBriefService;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> SubjectInfoTypeEnum <span class="title function_">getHandlerType</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> SubjectInfoTypeEnum.BRIEF;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(SubjectInfoBO subjectInfoBO)</span> &#123;</span><br><span class="line">        <span class="type">SubjectBrief</span> <span class="variable">subjectBrief</span> <span class="operator">=</span> BriefSubjectConverter.INSTANCE.convertBoToEntity(subjectInfoBO);</span><br><span class="line">        subjectBrief.setSubjectId(subjectInfoBO.getId().intValue());</span><br><span class="line">        subjectBrief.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">        subjectBriefService.insert(subjectBrief);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> SubjectOptionBO <span class="title function_">query</span><span class="params">(<span class="type">int</span> subjectId)</span> &#123;</span><br><span class="line">        <span class="type">SubjectBrief</span> <span class="variable">subjectBrief</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectBrief</span>();</span><br><span class="line">        subjectBrief.setSubjectId(subjectId);</span><br><span class="line">        <span class="type">SubjectBrief</span> <span class="variable">result</span> <span class="operator">=</span> subjectBriefService.queryByCondition(subjectBrief);</span><br><span class="line">        <span class="type">SubjectOptionBO</span> <span class="variable">subjectOptionBO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectOptionBO</span>();</span><br><span class="line">        subjectOptionBO.setSubjectAnswer(result.getSubjectAnswer());</span><br><span class="line">        <span class="keyword">return</span> subjectOptionBO;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//JudgeTypeHandler</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JudgeTypeHandler</span> <span class="keyword">implements</span> <span class="title class_">SubjectTypeHandler</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectJudgeService subjectJudgeService;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> SubjectInfoTypeEnum <span class="title function_">getHandlerType</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> SubjectInfoTypeEnum.JUDGE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(SubjectInfoBO subjectInfoBO)</span> &#123;</span><br><span class="line">        <span class="comment">//åˆ¤æ–­é¢˜ç›®çš„æ’å…¥</span></span><br><span class="line">        <span class="type">SubjectJudge</span> <span class="variable">subjectJudge</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectJudge</span>();</span><br><span class="line">        <span class="type">SubjectAnswerBO</span> <span class="variable">subjectAnswerBO</span> <span class="operator">=</span> subjectInfoBO.getOptionList().get(<span class="number">0</span>);</span><br><span class="line">        subjectJudge.setSubjectId(subjectInfoBO.getId());</span><br><span class="line">        subjectJudge.setIsCorrect(subjectAnswerBO.getIsCorrect());</span><br><span class="line">        subjectJudge.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">        subjectJudgeService.insert(subjectJudge);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> SubjectOptionBO <span class="title function_">query</span><span class="params">(<span class="type">int</span> subjectId)</span> &#123;</span><br><span class="line">        <span class="type">SubjectJudge</span> <span class="variable">subjectJudge</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectJudge</span>();</span><br><span class="line">        subjectJudge.setSubjectId(Long.valueOf(subjectId));</span><br><span class="line">        List&lt;SubjectJudge&gt; result = subjectJudgeService.queryByCondition(subjectJudge);</span><br><span class="line">        List&lt;SubjectAnswerBO&gt; subjectAnswerBOList = JudgeSubjectConverter.INSTANCE.convertEntityToBoList(result);</span><br><span class="line">        <span class="type">SubjectOptionBO</span> <span class="variable">subjectOptionBO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectOptionBO</span>();</span><br><span class="line">        subjectOptionBO.setOptionList(subjectAnswerBOList);</span><br><span class="line">        <span class="keyword">return</span> subjectOptionBO;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//MultipleTypeHandler</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MultipleTypeHandler</span> <span class="keyword">implements</span> <span class="title class_">SubjectTypeHandler</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectMultipleService subjectMultipleService;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> SubjectInfoTypeEnum <span class="title function_">getHandlerType</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> SubjectInfoTypeEnum.MULTIPLE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(SubjectInfoBO subjectInfoBO)</span> &#123;</span><br><span class="line">        <span class="comment">//å¤šé€‰é¢˜ç›®çš„æ’å…¥</span></span><br><span class="line">        List&lt;SubjectMultiple&gt; subjectMultipleList = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        subjectInfoBO.getOptionList().forEach(option -&gt; &#123;</span><br><span class="line">            <span class="type">SubjectMultiple</span> <span class="variable">subjectMultiple</span> <span class="operator">=</span> MultipleSubjectConverter.INSTANCE.convertBoToEntity(option);</span><br><span class="line">            subjectMultiple.setSubjectId(subjectInfoBO.getId());</span><br><span class="line">            subjectMultiple.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">            subjectMultipleList.add(subjectMultiple);</span><br><span class="line">        &#125;);</span><br><span class="line">        subjectMultipleService.batchInsert(subjectMultipleList);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> SubjectOptionBO <span class="title function_">query</span><span class="params">(<span class="type">int</span> subjectId)</span> &#123;</span><br><span class="line">        <span class="type">SubjectMultiple</span> <span class="variable">subjectMultiple</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectMultiple</span>();</span><br><span class="line">        subjectMultiple.setSubjectId(Long.valueOf(subjectId));</span><br><span class="line">        List&lt;SubjectMultiple&gt; result = subjectMultipleService.queryByCondition(subjectMultiple);</span><br><span class="line">        List&lt;SubjectAnswerBO&gt; subjectAnswerBOList = MultipleSubjectConverter.INSTANCE.convertEntityToBoList(result);</span><br><span class="line">        <span class="type">SubjectOptionBO</span> <span class="variable">subjectOptionBO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectOptionBO</span>();</span><br><span class="line">        subjectOptionBO.setOptionList(subjectAnswerBOList);</span><br><span class="line">        <span class="keyword">return</span> subjectOptionBO;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//RadioTypeHandler</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RadioTypeHandler</span> <span class="keyword">implements</span> <span class="title class_">SubjectTypeHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectRadioService subjectRadioService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> SubjectInfoTypeEnum <span class="title function_">getHandlerType</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> SubjectInfoTypeEnum.RADIO;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(SubjectInfoBO subjectInfoBO)</span> &#123;</span><br><span class="line">        <span class="comment">//å•é€‰é¢˜ç›®çš„æ’å…¥</span></span><br><span class="line">        List&lt;SubjectRadio&gt; subjectRadioList = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        subjectInfoBO.getOptionList().forEach(option -&gt; &#123;</span><br><span class="line">            <span class="type">SubjectRadio</span> <span class="variable">subjectRadio</span> <span class="operator">=</span> RadioSubjectConverter.INSTANCE.convertBoToEntity(option);</span><br><span class="line">            subjectRadio.setSubjectId(subjectInfoBO.getId());</span><br><span class="line">            subjectRadio.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">            subjectRadioList.add(subjectRadio);</span><br><span class="line">        &#125;);</span><br><span class="line">        subjectRadioService.batchInsert(subjectRadioList);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> SubjectOptionBO <span class="title function_">query</span><span class="params">(<span class="type">int</span> subjectId)</span> &#123;</span><br><span class="line">        <span class="type">SubjectRadio</span> <span class="variable">subjectRadio</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectRadio</span>();</span><br><span class="line">        subjectRadio.setSubjectId(Long.valueOf(subjectId));</span><br><span class="line">        List&lt;SubjectRadio&gt; result = subjectRadioService.queryByCondition(subjectRadio);</span><br><span class="line">        List&lt;SubjectAnswerBO&gt; subjectAnswerBOList = RadioSubjectConverter.INSTANCE.convertEntityToBoList(result);</span><br><span class="line">        <span class="type">SubjectOptionBO</span> <span class="variable">subjectOptionBO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectOptionBO</span>();</span><br><span class="line">        subjectOptionBO.setOptionList(subjectAnswerBOList);</span><br><span class="line">        <span class="keyword">return</span> subjectOptionBO;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SubjectController</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/subject&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectInfoDomainService subjectInfoDomainService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RocketMQTemplate rocketMQTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢é¢˜ç›®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">add</span><span class="params">(<span class="meta">@RequestBody</span> SubjectInfoDTO subjectInfoDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;SubjectController.add.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(subjectInfoDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkArgument(!StringUtils.isBlank(subjectInfoDTO.getSubjectName()),</span><br><span class="line">                    <span class="string">&quot;é¢˜ç›®åç§°ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            Preconditions.checkNotNull(subjectInfoDTO.getSubjectDifficult(), <span class="string">&quot;é¢˜ç›®éš¾åº¦ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            Preconditions.checkNotNull(subjectInfoDTO.getSubjectType(), <span class="string">&quot;é¢˜ç›®ç±»å‹ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            Preconditions.checkNotNull(subjectInfoDTO.getSubjectScore(), <span class="string">&quot;é¢˜ç›®åˆ†æ•°ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            Preconditions.checkArgument(!CollectionUtils.isEmpty(subjectInfoDTO.getCategoryIds())</span><br><span class="line">                    , <span class="string">&quot;åˆ†ç±»idä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            Preconditions.checkArgument(!CollectionUtils.isEmpty(subjectInfoDTO.getLabelIds())</span><br><span class="line">                    , <span class="string">&quot;æ ‡ç­¾idä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="type">SubjectInfoBO</span> <span class="variable">subjectInfoBO</span> <span class="operator">=</span> SubjectInfoDTOConverter.INSTANCE.convertDTOToBO(subjectInfoDTO); <span class="comment">//è½¬ä¸ºBO</span></span><br><span class="line">            List&lt;SubjectAnswerBO&gt; subjectAnswerBOS =</span><br><span class="line">                    SubjectAnswerDTOConverter.INSTANCE.convertListDTOToBO(subjectInfoDTO.getOptionList()); <span class="comment">//å•ç‹¬æ·»åŠ å›ç­”</span></span><br><span class="line">            subjectInfoBO.setOptionList(subjectAnswerBOS);</span><br><span class="line">            subjectInfoDomainService.add(subjectInfoBO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(<span class="literal">true</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;SubjectCategoryController.add.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æ–°å¢é¢˜ç›®å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢é¢˜ç›®åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/getSubjectPage&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;PageResult&lt;SubjectInfoDTO&gt;&gt; <span class="title function_">getSubjectPage</span><span class="params">(<span class="meta">@RequestBody</span> SubjectInfoDTO subjectInfoDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;SubjectController.getSubjectPage.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(subjectInfoDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkNotNull(subjectInfoDTO.getCategoryId(), <span class="string">&quot;åˆ†ç±»idä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            Preconditions.checkNotNull(subjectInfoDTO.getLabelId(), <span class="string">&quot;æ ‡ç­¾idä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="type">SubjectInfoBO</span> <span class="variable">subjectInfoBO</span> <span class="operator">=</span> SubjectInfoDTOConverter.INSTANCE.convertDTOToBO(subjectInfoDTO);</span><br><span class="line">            subjectInfoBO.setPageNo(subjectInfoDTO.getPageNo()); <span class="comment">//é¡µç </span></span><br><span class="line">            subjectInfoBO.setPageSize(subjectInfoDTO.getPageSize()); <span class="comment">//å¤§å°</span></span><br><span class="line">            PageResult&lt;SubjectInfoBO&gt; boPageResult = subjectInfoDomainService.getSubjectPage(subjectInfoBO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(boPageResult);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;SubjectCategoryController.add.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;åˆ†é¡µæŸ¥è¯¢é¢˜ç›®å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢é¢˜ç›®ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/querySubjectInfo&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;SubjectInfoDTO&gt; <span class="title function_">querySubjectInfo</span><span class="params">(<span class="meta">@RequestBody</span> SubjectInfoDTO subjectInfoDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;SubjectController.querySubjectInfo.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(subjectInfoDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkNotNull(subjectInfoDTO.getId(), <span class="string">&quot;é¢˜ç›®idä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="type">SubjectInfoBO</span> <span class="variable">subjectInfoBO</span> <span class="operator">=</span> SubjectInfoDTOConverter.INSTANCE.convertDTOToBO(subjectInfoDTO);</span><br><span class="line">            <span class="type">SubjectInfoBO</span> <span class="variable">boResult</span> <span class="operator">=</span> subjectInfoDomainService.querySubjectInfo(subjectInfoBO);</span><br><span class="line">            <span class="type">SubjectInfoDTO</span> <span class="variable">dto</span> <span class="operator">=</span> SubjectInfoDTOConverter.INSTANCE.convertBOToDTO(boResult);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(dto);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;SubjectCategoryController.add.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æŸ¥è¯¢é¢˜ç›®è¯¦æƒ…å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å…¨æ–‡æ£€ç´¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/getSubjectPageBySearch&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;PageResult&lt;SubjectInfoEs&gt;&gt; <span class="title function_">getSubjectPageBySearch</span><span class="params">(<span class="meta">@RequestBody</span> SubjectInfoDTO subjectInfoDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;SubjectController.getSubjectPageBySearch.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(subjectInfoDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkArgument(StringUtils.isNotBlank(subjectInfoDTO.getKeyWord()), <span class="string">&quot;å…³é”®è¯ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="type">SubjectInfoBO</span> <span class="variable">subjectInfoBO</span> <span class="operator">=</span> SubjectInfoDTOConverter.INSTANCE.convertDTOToBO(subjectInfoDTO);</span><br><span class="line">            subjectInfoBO.setPageNo(subjectInfoDTO.getPageNo());</span><br><span class="line">            subjectInfoBO.setPageSize(subjectInfoDTO.getPageSize());</span><br><span class="line">            PageResult&lt;SubjectInfoEs&gt; boPageResult = subjectInfoDomainService.getSubjectPageBySearch(subjectInfoBO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(boPageResult);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;SubjectCategoryController.getSubjectPageBySearch.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;å…¨æ–‡æ£€ç´¢å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–é¢˜ç›®è´¡çŒ®æ¦œ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/getContributeList&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;List&lt;SubjectInfoDTO&gt;&gt; <span class="title function_">getContributeList</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            List&lt;SubjectInfoBO&gt; boList = subjectInfoDomainService.getContributeList();</span><br><span class="line">            List&lt;SubjectInfoDTO&gt; dtoList = SubjectInfoDTOConverter.INSTANCE.convertBOToDTOList(boList);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(dtoList);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;SubjectCategoryController.getContributeList.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;è·å–è´¡çŒ®æ¦œå¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æµ‹è¯•mqå‘é€</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/pushMessage&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">pushMessage</span><span class="params">(<span class="meta">@Param(&quot;id&quot;)</span> <span class="type">int</span> id)</span> &#123;</span><br><span class="line">        rocketMQTemplate.convertAndSend(<span class="string">&quot;test-topic&quot;</span>, <span class="string">&quot;æ—©ä¸Šå¥½&quot;</span> + id);</span><br><span class="line">        <span class="keyword">return</span> Result.ok(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SubjectInfoDTOConverter</span></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectInfoDTOConverter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">SubjectInfoDTOConverter</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(SubjectInfoDTOConverter.class);</span><br><span class="line"></span><br><span class="line">    SubjectInfoBO <span class="title function_">convertDTOToBO</span><span class="params">(SubjectInfoDTO subjectInfoDTO)</span>;</span><br><span class="line"></span><br><span class="line">    SubjectInfoDTO <span class="title function_">convertBOToDTO</span><span class="params">(SubjectInfoBO subjectInfoBO)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;SubjectInfoDTO&gt; <span class="title function_">convertBOToDTOList</span><span class="params">(List&lt;SubjectInfoBO&gt; subjectInfoBO)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//SubjectAnswerDTOConverter</span></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectAnswerDTOConverter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">SubjectAnswerDTOConverter</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(SubjectAnswerDTOConverter.class);</span><br><span class="line"></span><br><span class="line">    SubjectAnswerBO <span class="title function_">convertDTOToBO</span><span class="params">(SubjectAnswerDTO subjectAnswerDTO)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;SubjectAnswerBO&gt; <span class="title function_">convertListDTOToBO</span><span class="params">(List&lt;SubjectAnswerDTO&gt; dtoList)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//SubjectInfoConverter</span></span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectInfoConverter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">SubjectInfoConverter</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(SubjectInfoConverter.class);</span><br><span class="line"></span><br><span class="line">    SubjectInfo <span class="title function_">convertBoToInfo</span><span class="params">(SubjectInfoBO subjectInfoBO)</span>;</span><br><span class="line"></span><br><span class="line">    SubjectInfoBO <span class="title function_">convertOptionToBo</span><span class="params">(SubjectOptionBO subjectOptionBO)</span>;</span><br><span class="line"></span><br><span class="line">    SubjectInfoBO <span class="title function_">convertOptionAndInfoToBo</span><span class="params">(SubjectOptionBO subjectOptionBO,SubjectInfo subjectInfo)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;SubjectInfoBO&gt; <span class="title function_">convertListInfoToBO</span><span class="params">(List&lt;SubjectInfo&gt; subjectInfoList)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SubjectInfoDomainService</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectInfoDomainService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢é¢˜ç›®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(SubjectInfoBO subjectInfoBO)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    PageResult&lt;SubjectInfoBO&gt; <span class="title function_">getSubjectPage</span><span class="params">(SubjectInfoBO subjectInfoBO)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢é¢˜ç›®ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    SubjectInfoBO <span class="title function_">querySubjectInfo</span><span class="params">(SubjectInfoBO subjectInfoBO)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å…¨æ–‡æ£€ç´¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    PageResult&lt;SubjectInfoEs&gt; <span class="title function_">getSubjectPageBySearch</span><span class="params">(SubjectInfoBO subjectInfoBO)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;SubjectInfoBO&gt; <span class="title function_">getContributeList</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectInfoDomainServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">SubjectInfoDomainService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectInfoService subjectInfoService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectMappingService subjectMappingService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectLabelService subjectLabelService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectTypeHandlerFactory subjectTypeHandlerFactory;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectEsService subjectEsService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectLikedDomainService subjectLikedDomainService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> UserRpc userRpc;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RedisUtil redisUtil;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">RANK_KEY</span> <span class="operator">=</span> <span class="string">&quot;subject_rank&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(SubjectInfoBO subjectInfoBO)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;SubjectInfoDomainServiceImpl.add.bo:&#123;&#125;&quot;</span>, JSON.toJSONString(subjectInfoBO));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">SubjectInfo</span> <span class="variable">subjectInfo</span> <span class="operator">=</span> SubjectInfoConverter.INSTANCE.convertBoToInfo(subjectInfoBO);</span><br><span class="line">        subjectInfo.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">        subjectInfoService.insert(subjectInfo);</span><br><span class="line">        <span class="type">SubjectTypeHandler</span> <span class="variable">handler</span> <span class="operator">=</span> subjectTypeHandlerFactory.getHandler(subjectInfo.getSubjectType()); <span class="comment">//é¢˜ç›®ç±»å‹å…³ç³»å·¥å‚</span></span><br><span class="line">        subjectInfoBO.setId(subjectInfo.getId());</span><br><span class="line">        handler.add(subjectInfoBO);</span><br><span class="line">        List&lt;Integer&gt; categoryIds = subjectInfoBO.getCategoryIds();</span><br><span class="line">        List&lt;Integer&gt; labelIds = subjectInfoBO.getLabelIds();</span><br><span class="line">        List&lt;SubjectMapping&gt; mappingList = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        categoryIds.forEach(categoryId -&gt; &#123; <span class="comment">//categoryå’Œlabelå¤šå¯¹å¤šçš„å…³ç³»</span></span><br><span class="line">            labelIds.forEach(labelId -&gt; &#123;</span><br><span class="line">                <span class="type">SubjectMapping</span> <span class="variable">subjectMapping</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectMapping</span>();</span><br><span class="line">                subjectMapping.setSubjectId(subjectInfo.getId());</span><br><span class="line">                subjectMapping.setCategoryId(Long.valueOf(categoryId));</span><br><span class="line">                subjectMapping.setLabelId(Long.valueOf(labelId));</span><br><span class="line">                subjectMapping.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">                mappingList.add(subjectMapping);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">        subjectMappingService.batchInsert(mappingList);</span><br><span class="line">        <span class="comment">//åŒæ­¥åˆ°es</span></span><br><span class="line">        <span class="type">SubjectInfoEs</span> <span class="variable">subjectInfoEs</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectInfoEs</span>();</span><br><span class="line">        subjectInfoEs.setDocId(<span class="keyword">new</span> <span class="title class_">IdWorkerUtil</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>).nextId());</span><br><span class="line">        subjectInfoEs.setSubjectId(subjectInfo.getId());</span><br><span class="line">        subjectInfoEs.setSubjectAnswer(subjectInfoBO.getSubjectAnswer());</span><br><span class="line">        subjectInfoEs.setCreateTime(<span class="keyword">new</span> <span class="title class_">Date</span>().getTime());</span><br><span class="line">        subjectInfoEs.setCreateUser(<span class="string">&quot;Roger&quot;</span>);</span><br><span class="line">        subjectInfoEs.setSubjectName(subjectInfo.getSubjectName());</span><br><span class="line">        subjectInfoEs.setSubjectType(subjectInfo.getSubjectType());</span><br><span class="line">        subjectEsService.insert(subjectInfoEs);</span><br><span class="line">        <span class="comment">//redisæ”¾å…¥zaddè®¡å…¥æ’è¡Œæ¦œ</span></span><br><span class="line">        redisUtil.addScore(RANK_KEY, LoginUtil.getLoginId(), <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//å®ç°äº†åˆ†é¡µæŸ¥è¯¢é€»è¾‘ï¼Œå¹¶ä¸”å°†æŸ¥è¯¢åˆ°çš„æ•°æ®å’Œç›¸å…³çš„æ ‡ç­¾ä¿¡æ¯å°è£…åˆ°ä¸šåŠ¡å¯¹è±¡ä¸­ï¼Œæœ€ååŒ…è£…æˆä¸€ä¸ªåˆ†é¡µç»“æœè¿”å›ã€‚</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> PageResult&lt;SubjectInfoBO&gt; <span class="title function_">getSubjectPage</span><span class="params">(SubjectInfoBO subjectInfoBO)</span> &#123;</span><br><span class="line">        PageResult&lt;SubjectInfoBO&gt; pageResult = <span class="keyword">new</span> <span class="title class_">PageResult</span>&lt;&gt;();</span><br><span class="line">        pageResult.setPageNo(subjectInfoBO.getPageNo());</span><br><span class="line">        pageResult.setPageSize(subjectInfoBO.getPageSize());</span><br><span class="line">        <span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> (subjectInfoBO.getPageNo() - <span class="number">1</span>) * subjectInfoBO.getPageSize();</span><br><span class="line">        <span class="type">SubjectInfo</span> <span class="variable">subjectInfo</span> <span class="operator">=</span> SubjectInfoConverter.INSTANCE.convertBoToInfo(subjectInfoBO);</span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> subjectInfoService.countByCondition(subjectInfo, subjectInfoBO.getCategoryId()</span><br><span class="line">                , subjectInfoBO.getLabelId()); <span class="comment">//æ ¹æ®æ¡ä»¶æŸ¥è¯¢æ»¡è¶³è¦æ±‚çš„é¢˜ç›®æ€»æ•°ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (count == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> pageResult;</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;SubjectInfo&gt; subjectInfoList = subjectInfoService.queryPage(subjectInfo, subjectInfoBO.getCategoryId()</span><br><span class="line">                , subjectInfoBO.getLabelId(), start, subjectInfoBO.getPageSize());</span><br><span class="line">        List&lt;SubjectInfoBO&gt; subjectInfoBOS = SubjectInfoConverter.INSTANCE.convertListInfoToBO(subjectInfoList);</span><br><span class="line">        subjectInfoBOS.forEach(info -&gt; &#123;</span><br><span class="line">            <span class="type">SubjectMapping</span> <span class="variable">subjectMapping</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectMapping</span>();</span><br><span class="line">            subjectMapping.setSubjectId(info.getId());</span><br><span class="line">            List&lt;SubjectMapping&gt; mappingList = subjectMappingService.queryLabelId(subjectMapping);</span><br><span class="line">            List&lt;Long&gt; labelIds = mappingList.stream().map(SubjectMapping::getLabelId).collect(Collectors.toList());</span><br><span class="line">            List&lt;SubjectLabel&gt; labelList = subjectLabelService.batchQueryById(labelIds);</span><br><span class="line">            List&lt;String&gt; labelNames = labelList.stream().map(SubjectLabel::getLabelName).collect(Collectors.toList());</span><br><span class="line">            info.setLabelName(labelNames);</span><br><span class="line">        &#125;);</span><br><span class="line">        pageResult.setRecords(subjectInfoBOS);</span><br><span class="line">        pageResult.setTotal(count);</span><br><span class="line">        <span class="keyword">return</span> pageResult;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> SubjectInfoBO <span class="title function_">querySubjectInfo</span><span class="params">(SubjectInfoBO subjectInfoBO)</span> &#123;</span><br><span class="line">        <span class="type">SubjectInfo</span> <span class="variable">subjectInfo</span> <span class="operator">=</span> subjectInfoService.queryById(subjectInfoBO.getId());</span><br><span class="line">        <span class="type">SubjectTypeHandler</span> <span class="variable">handler</span> <span class="operator">=</span> subjectTypeHandlerFactory.getHandler(subjectInfo.getSubjectType());</span><br><span class="line">        <span class="type">SubjectOptionBO</span> <span class="variable">optionBO</span> <span class="operator">=</span> handler.query(subjectInfo.getId().intValue());</span><br><span class="line">        <span class="type">SubjectInfoBO</span> <span class="variable">bo</span> <span class="operator">=</span> SubjectInfoConverter.INSTANCE.convertOptionAndInfoToBo(optionBO, subjectInfo);</span><br><span class="line">        <span class="type">SubjectMapping</span> <span class="variable">subjectMapping</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectMapping</span>();</span><br><span class="line">        subjectMapping.setSubjectId(subjectInfo.getId());</span><br><span class="line">        subjectMapping.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">        List&lt;SubjectMapping&gt; mappingList = subjectMappingService.queryLabelId(subjectMapping);</span><br><span class="line">        List&lt;Long&gt; labelIdList = mappingList.stream().map(SubjectMapping::getLabelId).collect(Collectors.toList());</span><br><span class="line">        List&lt;SubjectLabel&gt; labelList = subjectLabelService.batchQueryById(labelIdList);</span><br><span class="line">        List&lt;String&gt; labelNameList = labelList.stream().map(SubjectLabel::getLabelName).collect(Collectors.toList());</span><br><span class="line">        bo.setLabelName(labelNameList);</span><br><span class="line">        bo.setLiked(subjectLikedDomainService.isLiked(subjectInfoBO.getId().toString(), LoginUtil.getLoginId()));</span><br><span class="line">        bo.setLikedCount(subjectLikedDomainService.getLikedCount(subjectInfoBO.getId().toString()));</span><br><span class="line">        assembleSubjectCursor(subjectInfoBO, bo);</span><br><span class="line">        <span class="keyword">return</span> bo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">assembleSubjectCursor</span><span class="params">(SubjectInfoBO subjectInfoBO, SubjectInfoBO bo)</span> &#123;</span><br><span class="line">        <span class="type">Long</span> <span class="variable">categoryId</span> <span class="operator">=</span> subjectInfoBO.getCategoryId();</span><br><span class="line">        <span class="type">Long</span> <span class="variable">labelId</span> <span class="operator">=</span> subjectInfoBO.getLabelId();</span><br><span class="line">        <span class="type">Long</span> <span class="variable">subjectId</span> <span class="operator">=</span> subjectInfoBO.getId();</span><br><span class="line">        <span class="keyword">if</span> (Objects.isNull(categoryId) || Objects.isNull(labelId)) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Long</span> <span class="variable">nextSubjectId</span> <span class="operator">=</span> subjectInfoService.querySubjectIdCursor(subjectId, categoryId, labelId, <span class="number">1</span>);</span><br><span class="line">        bo.setNextSubjectId(nextSubjectId);</span><br><span class="line">        <span class="type">Long</span> <span class="variable">lastSubjectId</span> <span class="operator">=</span> subjectInfoService.querySubjectIdCursor(subjectId, categoryId, labelId, <span class="number">0</span>);</span><br><span class="line">        bo.setLastSubjectId(lastSubjectId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> PageResult&lt;SubjectInfoEs&gt; <span class="title function_">getSubjectPageBySearch</span><span class="params">(SubjectInfoBO subjectInfoBO)</span> &#123;</span><br><span class="line">        <span class="type">SubjectInfoEs</span> <span class="variable">subjectInfoEs</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectInfoEs</span>();</span><br><span class="line">        subjectInfoEs.setPageNo(subjectInfoBO.getPageNo());</span><br><span class="line">        subjectInfoEs.setPageSize(subjectInfoBO.getPageSize());</span><br><span class="line">        subjectInfoEs.setKeyWord(subjectInfoBO.getKeyWord());</span><br><span class="line">        <span class="keyword">return</span> subjectEsService.querySubjectList(subjectInfoEs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;SubjectInfoBO&gt; <span class="title function_">getContributeList</span><span class="params">()</span> &#123;</span><br><span class="line">        Set&lt;ZSetOperations.TypedTuple&lt;String&gt;&gt; typedTuples = redisUtil.rankWithScore(RANK_KEY, <span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line">        <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;getContributeList.typedTuples:&#123;&#125;&quot;</span>, JSON.toJSONString(typedTuples));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (CollectionUtils.isEmpty(typedTuples)) &#123;</span><br><span class="line">            <span class="keyword">return</span> Collections.emptyList();</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;SubjectInfoBO&gt; boList = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        typedTuples.forEach((rank -&gt; &#123;</span><br><span class="line">            <span class="type">SubjectInfoBO</span> <span class="variable">subjectInfoBO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectInfoBO</span>();</span><br><span class="line">            subjectInfoBO.setSubjectCount(rank.getScore().intValue());</span><br><span class="line">            <span class="type">UserInfo</span> <span class="variable">userInfo</span> <span class="operator">=</span> userRpc.getUserInfo(rank.getValue());</span><br><span class="line">            subjectInfoBO.setCreateUser(userInfo.getNickName());</span><br><span class="line">            subjectInfoBO.setCreateUserAvatar(userInfo.getAvatar());</span><br><span class="line">            boList.add(subjectInfoBO);</span><br><span class="line">        &#125;));</span><br><span class="line">        <span class="keyword">return</span> boList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service(&quot;subjectInfoService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectInfoServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">SubjectInfoService</span> &#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectInfoDao subjectInfoDao;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡IDæŸ¥è¯¢å•æ¡æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id ä¸»é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> SubjectInfo <span class="title function_">queryById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.subjectInfoDao.queryById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subjectInfo å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> SubjectInfo <span class="title function_">insert</span><span class="params">(SubjectInfo subjectInfo)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.subjectInfoDao.insert(subjectInfo);</span><br><span class="line">        <span class="keyword">return</span> subjectInfo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subjectInfo å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> SubjectInfo <span class="title function_">update</span><span class="params">(SubjectInfo subjectInfo)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.subjectInfoDao.update(subjectInfo);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.queryById(subjectInfo.getId());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡ä¸»é”®åˆ é™¤æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id ä¸»é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ˜¯å¦æˆåŠŸ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">deleteById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.subjectInfoDao.deleteById(id) &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">countByCondition</span><span class="params">(SubjectInfo subjectInfo, Long categoryId, Long labelId)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.subjectInfoDao.countByCondition(subjectInfo, categoryId, labelId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;SubjectInfo&gt; <span class="title function_">queryPage</span><span class="params">(SubjectInfo subjectInfo, Long categoryId, Long labelId, <span class="type">int</span> start, Integer pageSize)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.subjectInfoDao.queryPage(subjectInfo, categoryId, labelId, start, pageSize);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;SubjectInfo&gt; <span class="title function_">getContributeCount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.subjectInfoDao.getContributeCount();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">querySubjectIdCursor</span><span class="params">(Long subjectId, Long categoryId, Long labelId, <span class="type">int</span> cursor)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.subjectInfoDao.querySubjectIdCursor(subjectId, categoryId, labelId, cursor);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectInfoService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡IDæŸ¥è¯¢å•æ¡æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id ä¸»é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    SubjectInfo <span class="title function_">queryById</span><span class="params">(Long id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subjectInfo å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    SubjectInfo <span class="title function_">insert</span><span class="params">(SubjectInfo subjectInfo)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subjectInfo å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    SubjectInfo <span class="title function_">update</span><span class="params">(SubjectInfo subjectInfo)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡ä¸»é”®åˆ é™¤æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id ä¸»é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ˜¯å¦æˆåŠŸ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">deleteById</span><span class="params">(Long id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">countByCondition</span><span class="params">(SubjectInfo subjectInfo, Long categoryId, Long labelId)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;SubjectInfo&gt; <span class="title function_">queryPage</span><span class="params">(SubjectInfo subjectInfo, Long categoryId, Long labelId, <span class="type">int</span> start, Integer pageSize)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;SubjectInfo&gt; <span class="title function_">getContributeCount</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    Long <span class="title function_">querySubjectIdCursor</span><span class="params">(Long subjectId, Long categoryId, Long labelId, <span class="type">int</span> cursor)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectInfoDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡IDæŸ¥è¯¢å•æ¡æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id ä¸»é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    SubjectInfo <span class="title function_">queryById</span><span class="params">(Long id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢æŒ‡å®šè¡Œæ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subjectInfo æŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å¯¹è±¡åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;SubjectInfo&gt; <span class="title function_">queryAllByLimit</span><span class="params">(SubjectInfo subjectInfo)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç»Ÿè®¡æ€»è¡Œæ•°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subjectInfo æŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ€»è¡Œæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">long</span> <span class="title function_">count</span><span class="params">(SubjectInfo subjectInfo)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subjectInfo å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å½±å“è¡Œæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">insert</span><span class="params">(SubjectInfo subjectInfo)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰¹é‡æ–°å¢æ•°æ®ï¼ˆMyBatisåŸç”Ÿforeachæ–¹æ³•ï¼‰</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> entities List&lt;SubjectInfo&gt; å®ä¾‹å¯¹è±¡åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å½±å“è¡Œæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">insertBatch</span><span class="params">(<span class="meta">@Param(&quot;entities&quot;)</span> List&lt;SubjectInfo&gt; entities)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰¹é‡æ–°å¢æˆ–æŒ‰ä¸»é”®æ›´æ–°æ•°æ®ï¼ˆMyBatisåŸç”Ÿforeachæ–¹æ³•ï¼‰</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> entities List&lt;SubjectInfo&gt; å®ä¾‹å¯¹è±¡åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å½±å“è¡Œæ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> org.springframework.jdbc.BadSqlGrammarException å…¥å‚æ˜¯ç©ºListçš„æ—¶å€™ä¼šæŠ›SQLè¯­å¥é”™è¯¯çš„å¼‚å¸¸ï¼Œè¯·è‡ªè¡Œæ ¡éªŒå…¥å‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">insertOrUpdateBatch</span><span class="params">(<span class="meta">@Param(&quot;entities&quot;)</span> List&lt;SubjectInfo&gt; entities)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subjectInfo å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å½±å“è¡Œæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">update</span><span class="params">(SubjectInfo subjectInfo)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡ä¸»é”®åˆ é™¤æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id ä¸»é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å½±å“è¡Œæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">deleteById</span><span class="params">(Long id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">countByCondition</span><span class="params">(<span class="meta">@Param(&quot;subjectInfo&quot;)</span> SubjectInfo subjectInfo,</span></span><br><span class="line"><span class="params">                         <span class="meta">@Param(&quot;categoryId&quot;)</span> Long categoryId,</span></span><br><span class="line"><span class="params">                         <span class="meta">@Param(&quot;labelId&quot;)</span> Long labelId)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;SubjectInfo&gt; <span class="title function_">queryPage</span><span class="params">(<span class="meta">@Param(&quot;subjectInfo&quot;)</span> SubjectInfo subjectInfo,</span></span><br><span class="line"><span class="params">                                <span class="meta">@Param(&quot;categoryId&quot;)</span> Long categoryId,</span></span><br><span class="line"><span class="params">                                <span class="meta">@Param(&quot;labelId&quot;)</span> Long labelId,</span></span><br><span class="line"><span class="params">                                <span class="meta">@Param(&quot;start&quot;)</span> <span class="type">int</span> start,</span></span><br><span class="line"><span class="params">                                <span class="meta">@Param(&quot;pageSize&quot;)</span> Integer pageSize)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;SubjectInfo&gt; <span class="title function_">getContributeCount</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    Long <span class="title function_">querySubjectIdCursor</span><span class="params">(<span class="meta">@Param(&quot;subjectId&quot;)</span> Long subjectId,</span></span><br><span class="line"><span class="params">                              <span class="meta">@Param(&quot;categoryId&quot;)</span> Long categoryId,</span></span><br><span class="line"><span class="params">                              <span class="meta">@Param(&quot;labelId&quot;)</span> Long labelId,</span></span><br><span class="line"><span class="params">                              <span class="meta">@Param(&quot;cursor&quot;)</span> <span class="type">int</span> cursor)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>JacksonConverterï¼ˆå¯¹äºè¿”å›å€¼çš„å¤„ç†ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.subject.application.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonInclude;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.SerializationFeature;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.subject.application.interceptor.LoginInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.converter.HttpMessageConverter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.converter.json.MappingJackson2HttpMessageConverter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurationSupport;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * mvcçš„å…¨å±€å¤„ç†</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: ChickenWing</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2023/10/7</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalConfig</span> <span class="keyword">extends</span> <span class="title class_">WebMvcConfigurationSupport</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">configureMessageConverters</span><span class="params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.configureMessageConverters(converters);</span><br><span class="line">        converters.add(mappingJackson2HttpMessageConverter());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">LoginInterceptor</span>())</span><br><span class="line">                .addPathPatterns(<span class="string">&quot;/**&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è‡ªå®šä¹‰mappingJackson2HttpMessageConverter</span></span><br><span class="line"><span class="comment">     * ç›®å‰å®ç°ï¼šç©ºå€¼å¿½ç•¥ï¼Œç©ºå­—æ®µå¯è¿”å›</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> MappingJackson2HttpMessageConverter <span class="title function_">mappingJackson2HttpMessageConverter</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        objectMapper.configure(SerializationFeature.FAIL_ON_EMPTY_BEANS, <span class="literal">false</span>); <span class="comment">//è¿™è¡Œä»£ç é…ç½®ObjectMapperï¼Œä½¿å…¶åœ¨åºåˆ—åŒ–æ—¶ä¸ä¼šå› ç©ºBeanè€Œå¤±è´¥ã€‚</span></span><br><span class="line">        objectMapper.setSerializationInclusion(JsonInclude.Include.NON_NULL); <span class="comment">//è¿™è¡Œä»£ç è®¾ç½®åºåˆ—åŒ–æ—¶åªåŒ…å«éç©ºçš„å­—æ®µã€‚ï¼ˆå³è¿”å›çš„jsonç»“æœä¸­ä¸ä¼šå«æœ‰å€¼ä¸ºNullçš„å­—æ®µï¼‰</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MappingJackson2HttpMessageConverter</span>(objectMapper);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>SQLæ‹¦æˆªå™¨è‡ªåŠ¨ç¿»è¯‘ï¼ˆmybatisæä¾›çš„ï¼‰</strong></p><p>SqlStatementInterceptor ä¸»è¦ä½œç”¨æ˜¯ç›‘æ§MyBatisçš„SQLæ‰§è¡Œæ—¶é—´ï¼Œå¹¶æ ¹æ®ä¸åŒçš„æ‰§è¡Œæ—¶é—´è®°å½•ä¸åŒçº§åˆ«çš„æ—¥å¿—</p><p>MybatisPlusAllSqlLogè¿™ä¸ªç±»å®ç°äº†<code>InnerInterceptor</code>æ¥å£ï¼Œå®ƒæ˜¯MyBatis-Plusæ¡†æ¶æä¾›çš„ä¸€ä¸ªå†…éƒ¨æ‹¦æˆªå™¨æ¥å£ï¼Œç”¨äºæ‹¦æˆªSQLçš„æ‰§è¡Œã€‚è¿™ä¸ªç±»æœ‰ä¸¤ä¸ªä¸»è¦çš„é‡å†™æ–¹æ³•ï¼š</p><ul><li><code>beforeQuery</code>: åœ¨æŸ¥è¯¢æ‰§è¡Œå‰è°ƒç”¨ï¼Œè®°å½•SQLä¿¡æ¯ã€‚</li><li><code>beforeUpdate</code>: åœ¨æ›´æ–°æ‰§è¡Œå‰è°ƒç”¨ï¼Œè®°å½•SQLä¿¡æ¯ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SqlStatementInterceptor ä¸»è¦ä½œç”¨æ˜¯ç›‘æ§MyBatisçš„SQLæ‰§è¡Œæ—¶é—´ï¼Œå¹¶æ ¹æ®ä¸åŒçš„æ‰§è¡Œæ—¶é—´è®°å½•ä¸åŒçº§åˆ«çš„æ—¥å¿—</span></span><br><span class="line"><span class="keyword">package</span> com.jingdianjichi.subject.infra.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.cache.CacheKey;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.executor.Executor;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.mapping.BoundSql;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.mapping.MappedStatement;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.plugin.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.ResultHandler;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.RowBounds;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Intercepts(&#123;</span></span><br><span class="line"><span class="meta">        @Signature(type = Executor.class, method = &quot;update&quot;, args = &#123;MappedStatement.class,</span></span><br><span class="line"><span class="meta">                Object.class&#125;),</span></span><br><span class="line"><span class="meta">        @Signature(type = Executor.class, method = &quot;query&quot;, args = &#123;MappedStatement.class,</span></span><br><span class="line"><span class="meta">                Object.class, RowBounds.class, ResultHandler.class, CacheKey.class, BoundSql.class&#125;)&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SqlStatementInterceptor</span> <span class="keyword">implements</span> <span class="title class_">Interceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(<span class="string">&quot;sys-sql&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">intercept</span><span class="params">(Invocation invocation)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> invocation.proceed();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">timeConsuming</span> <span class="operator">=</span> System.currentTimeMillis() - startTime;</span><br><span class="line">            log.info(<span class="string">&quot;æ‰§è¡ŒSQL:&#123;&#125;ms&quot;</span>, timeConsuming);</span><br><span class="line">            <span class="keyword">if</span> (timeConsuming &gt; <span class="number">999</span> &amp;&amp; timeConsuming &lt; <span class="number">5000</span>) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;æ‰§è¡ŒSQLå¤§äº1s:&#123;&#125;ms&quot;</span>, timeConsuming);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (timeConsuming &gt;= <span class="number">5000</span> &amp;&amp; timeConsuming &lt; <span class="number">10000</span>) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;æ‰§è¡ŒSQLå¤§äº5s:&#123;&#125;ms&quot;</span>, timeConsuming);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (timeConsuming &gt;= <span class="number">10000</span>) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;æ‰§è¡ŒSQLå¤§äº10s:&#123;&#125;ms&quot;</span>, timeConsuming);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">plugin</span><span class="params">(Object target)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Plugin.wrap(target, <span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setProperties</span><span class="params">(Properties properties)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//MybatisPlusAllSqlLog</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisPlusAllSqlLog</span> <span class="keyword">implements</span> <span class="title class_">InnerInterceptor</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(<span class="string">&quot;sys-sql&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeQuery</span><span class="params">(Executor executor, MappedStatement ms, Object parameter, RowBounds rowBounds, ResultHandler resultHandler, BoundSql boundSql)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        logInfo(boundSql, ms, parameter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeUpdate</span><span class="params">(Executor executor, MappedStatement ms, Object parameter)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="type">BoundSql</span> <span class="variable">boundSql</span> <span class="operator">=</span> ms.getBoundSql(parameter);</span><br><span class="line">        logInfo(boundSql, ms, parameter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">logInfo</span><span class="params">(BoundSql boundSql, MappedStatement ms, Object parameter)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            log.info(<span class="string">&quot;parameter = &quot;</span> + parameter);</span><br><span class="line">            <span class="comment">// è·å–åˆ°èŠ‚ç‚¹çš„id,å³sqlè¯­å¥çš„id</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sqlId</span> <span class="operator">=</span> ms.getId();</span><br><span class="line">            log.info(<span class="string">&quot;sqlId = &quot;</span> + sqlId);</span><br><span class="line">            <span class="comment">// è·å–èŠ‚ç‚¹çš„é…ç½®</span></span><br><span class="line">            <span class="type">Configuration</span> <span class="variable">configuration</span> <span class="operator">=</span> ms.getConfiguration();</span><br><span class="line">            <span class="comment">// è·å–åˆ°æœ€ç»ˆçš„sqlè¯­å¥</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> getSql(configuration, boundSql, sqlId);</span><br><span class="line">            log.info(<span class="string">&quot;å®Œæ•´çš„sql:&#123;&#125;&quot;</span>, sql);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;å¼‚å¸¸:&#123;&#125;&quot;</span>, e.getLocalizedMessage(), e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°è£…äº†ä¸€ä¸‹sqlè¯­å¥ï¼Œä½¿å¾—ç»“æœè¿”å›å®Œæ•´xmlè·¯å¾„ä¸‹çš„sqlè¯­å¥èŠ‚ç‚¹id + sqlè¯­å¥</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getSql</span><span class="params">(Configuration configuration, BoundSql boundSql, String sqlId)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sqlId + <span class="string">&quot;:&quot;</span> + showSql(configuration, boundSql);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿›è¡Œï¼Ÿçš„æ›¿æ¢</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">showSql</span><span class="params">(Configuration configuration, BoundSql boundSql)</span> &#123;</span><br><span class="line">        <span class="comment">// è·å–å‚æ•°</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">parameterObject</span> <span class="operator">=</span> boundSql.getParameterObject();</span><br><span class="line">        List&lt;ParameterMapping&gt; parameterMappings = boundSql.getParameterMappings();</span><br><span class="line">        <span class="comment">// sqlè¯­å¥ä¸­å¤šä¸ªç©ºæ ¼éƒ½ç”¨ä¸€ä¸ªç©ºæ ¼ä»£æ›¿</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> boundSql.getSql().replaceAll(<span class="string">&quot;[\\s]+&quot;</span>, <span class="string">&quot; &quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!CollectionUtils.isEmpty(parameterMappings) &amp;&amp; parameterObject != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// è·å–ç±»å‹å¤„ç†å™¨æ³¨å†Œå™¨ï¼Œç±»å‹å¤„ç†å™¨çš„åŠŸèƒ½æ˜¯è¿›è¡Œjavaç±»å‹å’Œæ•°æ®åº“ç±»å‹çš„è½¬æ¢</span></span><br><span class="line">            <span class="type">TypeHandlerRegistry</span> <span class="variable">typeHandlerRegistry</span> <span class="operator">=</span> configuration.getTypeHandlerRegistry();</span><br><span class="line">            <span class="comment">// å¦‚æœæ ¹æ®parameterObject.getClass(ï¼‰å¯ä»¥æ‰¾åˆ°å¯¹åº”çš„ç±»å‹ï¼Œåˆ™æ›¿æ¢</span></span><br><span class="line">            <span class="keyword">if</span> (typeHandlerRegistry.hasTypeHandler(parameterObject.getClass())) &#123;</span><br><span class="line">                sql = sql.replaceFirst(<span class="string">&quot;\\?&quot;</span>,</span><br><span class="line">                        Matcher.quoteReplacement(getParameterValue(parameterObject)));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// MetaObjectä¸»è¦æ˜¯å°è£…äº†originalObjectå¯¹è±¡ï¼Œæä¾›äº†getå’Œsetçš„æ–¹æ³•ç”¨äºè·å–å’Œè®¾ç½®originalObjectçš„å±æ€§å€¼,ä¸»è¦æ”¯æŒå¯¹JavaBeanã€Collectionã€Mapä¸‰ç§ç±»å‹å¯¹è±¡çš„æ“ä½œ</span></span><br><span class="line">                <span class="type">MetaObject</span> <span class="variable">metaObject</span> <span class="operator">=</span> configuration.newMetaObject(parameterObject);</span><br><span class="line">                <span class="keyword">for</span> (ParameterMapping parameterMapping : parameterMappings) &#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">propertyName</span> <span class="operator">=</span> parameterMapping.getProperty();</span><br><span class="line">                    <span class="keyword">if</span> (metaObject.hasGetter(propertyName)) &#123;</span><br><span class="line">                        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> metaObject.getValue(propertyName);</span><br><span class="line">                        sql = sql.replaceFirst(<span class="string">&quot;\\?&quot;</span>,</span><br><span class="line">                                Matcher.quoteReplacement(getParameterValue(obj)));</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (boundSql.hasAdditionalParameter(propertyName)) &#123;</span><br><span class="line">                        <span class="comment">// è¯¥åˆ†æ”¯æ˜¯åŠ¨æ€sql</span></span><br><span class="line">                        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> boundSql.getAdditionalParameter(propertyName);</span><br><span class="line">                        sql = sql.replaceFirst(<span class="string">&quot;\\?&quot;</span>,</span><br><span class="line">                                Matcher.quoteReplacement(getParameterValue(obj)));</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="comment">// æ‰“å°å‡ºç¼ºå¤±ï¼Œæé†’è¯¥å‚æ•°ç¼ºå¤±å¹¶é˜²æ­¢é”™ä½</span></span><br><span class="line">                        sql = sql.replaceFirst(<span class="string">&quot;\\?&quot;</span>, <span class="string">&quot;ç¼ºå¤±&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sql;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœå‚æ•°æ˜¯Stringï¼Œåˆ™æ·»åŠ å•å¼•å·ï¼Œ å¦‚æœæ˜¯æ—¥æœŸï¼Œåˆ™è½¬æ¢ä¸ºæ—¶é—´æ ¼å¼å™¨å¹¶åŠ å•å¼•å·ï¼› å¯¹å‚æ•°æ˜¯nullå’Œä¸æ˜¯nullçš„æƒ…å†µä½œäº†å¤„ç†</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">getParameterValue</span><span class="params">(Object obj)</span> &#123;</span><br><span class="line">        String value;</span><br><span class="line">        <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line">            value = <span class="string">&quot;&#x27;&quot;</span> + obj.toString() + <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> Date) &#123;</span><br><span class="line">            <span class="type">DateFormat</span> <span class="variable">formatter</span> <span class="operator">=</span> DateFormat.getDateTimeInstance(DateFormat.DEFAULT,</span><br><span class="line">                    DateFormat.DEFAULT, Locale.CHINA);</span><br><span class="line">            value = <span class="string">&quot;&#x27;&quot;</span> + formatter.format(<span class="keyword">new</span> <span class="title class_">Date</span>()) + <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (obj != <span class="literal">null</span>) &#123;</span><br><span class="line">                value = obj.toString();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                value = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h3><h4 id="ä¼ ç»Ÿéƒ¨ç½²å½¢å¼"><a href="#ä¼ ç»Ÿéƒ¨ç½²å½¢å¼" class="headerlink" title="ä¼ ç»Ÿéƒ¨ç½²å½¢å¼"></a>ä¼ ç»Ÿéƒ¨ç½²å½¢å¼</h4><p>åœ¨starteræ¨¡å—çš„pom.xmlä¸­</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">//é…ç½®çš„ç‰ˆæœ¬ç­‰å†…å®¹</span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.reporting.outputEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.reporting.outputEncoding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring-boot.version</span>&gt;</span>2.4.2<span class="tag">&lt;/<span class="name">spring-boot.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring-cloud-alibaba.version</span>&gt;</span>2021.1<span class="tag">&lt;/<span class="name">spring-cloud-alibaba.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spring-cloud.version</span>&gt;</span>2020.0.6<span class="tag">&lt;/<span class="name">spring-cloud.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">....</span><br><span class="line">//æ‰“åŒ…çš„åå­—</span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">finalName</span>&gt;</span>$&#123;project.artifactId&#125;<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ‰“åŒ…æˆjaråŒ…æ—¶çš„åå­—--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>repackage<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ‰“åŒ…å¥½JaråŒ…,å¤åˆ¶åˆ°æœåŠ¡å™¨ä¸Š,java -jarè¿è¡Œå³å¯</p><p>ä½†æ˜¯è¿™æ ·è¿˜æ˜¯æ¯”è¾ƒå¤æ‚</p><h4 id="CI-CD-jenkinsè‡ªåŠ¨æ‰“åŒ…é›†æˆå’Œéƒ¨ç½²"><a href="#CI-CD-jenkinsè‡ªåŠ¨æ‰“åŒ…é›†æˆå’Œéƒ¨ç½²" class="headerlink" title="CI&#x2F;CD jenkinsè‡ªåŠ¨æ‰“åŒ…é›†æˆå’Œéƒ¨ç½²"></a>CI&#x2F;CD jenkinsè‡ªåŠ¨æ‰“åŒ…é›†æˆå’Œéƒ¨ç½²</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker search jenkins</span><br><span class="line">docker pull jenkins/jenkins:lts</span><br><span class="line">docker run -d -u root -p 8080:8080 -p 50000:50000 -v /var/jenkins_home:/var/jenkins_home -v /etc/localtime:/etc/localtime --name jenkins jenkins/jenkins:lts</span><br><span class="line">docker ps -a</span><br></pre></td></tr></table></figure><p>ç„¶åé…ç½®ä¸€äº›å¯†ç ï¼Œmavenï¼Œæ‹‰ä¸€äº›åŒ…ï¼Œé…ç½®pom.xmlï¼Œé…ç½®è·¯å¾„ï¼Œå°±å¯ä»¥æ‰“åŒ…å¥½ï¼Œå†™ä¸€ä¸ªshellè„šæœ¬ç„¶åè¿è¡Œå°±è¡Œäº†</p><p>[shellè„šæœ¬è¯­è¨€(è¶…å…¨è¶…è¯¦ç»†)-CSDNåšå®¢](<a href="https://blog.csdn.net/weixin_43288201/article/details/105643692?ops_request_misc=&request_id=&biz_id=102&utm_term=shell">https://blog.csdn.net/weixin_43288201/article/details/105643692?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=shell</a> è„šæœ¬ ^&amp;utm_medium&#x3D;distribute.pc_search_result.none-task-blog-2<del>all</del>sobaiduweb~default-5-105643692.142^v100^pc_search_result_base8&amp;spm&#x3D;1018.2226.3001.4187)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">cp /var/jenkins_home/workspace/programmer-club-subject/programmer-club-subject/programmer-club-starter/target/programmer-club-starter.jar /var/jenkins_home/jar/</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line">APP_NAME=programmer-club-starter.jar</span><br><span class="line">LOG_NAME=programmer-club-starter.log</span><br><span class="line"></span><br><span class="line">pid=`ps -ef | grep $APP_NAME | grep -v grep|awk &#x27;&#123;print $2&#125;&#x27;`</span><br><span class="line"></span><br><span class="line">function is_exist()&#123;</span><br><span class="line">pid=`ps -ef | grep $APP_NAME | grep -v grep|awk &#x27;&#123;print $2&#125;&#x27;`</span><br><span class="line">if [ -z $&#123;pid&#125; ]; then</span><br><span class="line">String=&quot;notExist&quot;</span><br><span class="line">echo $String</span><br><span class="line">else</span><br><span class="line">String=&quot;exist&quot;</span><br><span class="line">echo $String</span><br><span class="line">fi</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">str=$(is_exist)</span><br><span class="line">if [ $&#123;str&#125; = &quot;exist&quot; ]; then</span><br><span class="line">echo &quot; æ£€æµ‹åˆ°å·²ç»å¯åŠ¨çš„ç¨‹åºï¼Œpid æ˜¯ $&#123;pid&#125; &quot;</span><br><span class="line">kill -9 $pid</span><br><span class="line">else</span><br><span class="line">echo &quot; ç¨‹åºæ²¡æœ‰å¯åŠ¨äº† &quot;</span><br><span class="line">echo &quot;$&#123;APP_NAME&#125; is not running&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">str=$(is_exist)</span><br><span class="line">if [ $&#123;str&#125; = &quot;exist&quot; ]; then</span><br><span class="line">echo &quot;$&#123;APP_NAME&#125; å·²ç»å¯åŠ¨äº†. pid=$&#123;pid&#125; .&quot;</span><br><span class="line">else</span><br><span class="line">source /etc/profile</span><br><span class="line">BUILD_ID=dontKillMe</span><br><span class="line">nohup java -Xms300m -Xmx300m -jar /var/jenkins_home/jar/$APP_NAME   &gt;$LOG_NAME 2&gt;&amp;1 &amp;</span><br><span class="line">echo &quot;ç¨‹åºå·²é‡æ–°å¯åŠ¨...&quot;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªè„šæœ¬ä¸­è·å–PIDçš„å‘½ä»¤ï¼š</p><ol><li><code>ps -ef</code>ï¼šè¿™ä¸ªå‘½ä»¤åˆ—å‡ºäº†å½“å‰ç³»ç»Ÿä¸Šæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ã€‚<code>-e</code>é€‰é¡¹è¡¨ç¤ºæ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ï¼Œ<code>-f</code>é€‰é¡¹è¡¨ç¤ºæ˜¾ç¤ºå®Œæ•´æ ¼å¼ã€‚</li><li><code>grep $APP_NAME</code>ï¼š<code>grep</code>å‘½ä»¤ç”¨äºæœç´¢åŒ…å«æŒ‡å®šæ–‡æœ¬çš„è¡Œã€‚åœ¨è¿™é‡Œï¼Œå®ƒæœç´¢åŒ…å«<code>APP_NAME</code>å˜é‡å€¼ï¼ˆå³<code>programmer-club-starter.jar</code>ï¼‰çš„è¡Œã€‚</li><li><code>grep -v grep</code>ï¼šè¿™ä¸ªå‘½ä»¤ç”¨äºæ’é™¤åŒ…å«<code>grep</code>æœ¬èº«çš„è¡Œï¼Œ<code>-v</code>é€‰é¡¹è¡¨ç¤ºæ˜¾ç¤ºä¸åŒ…å«åŒ¹é…æ–‡æœ¬çš„è¡Œã€‚</li><li><code>awk &#39;&#123;print $2&#125;&#39;</code>ï¼š<code>awk</code>æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ–‡æœ¬å¤„ç†å·¥å…·ã€‚åœ¨è¿™é‡Œï¼Œå®ƒç”¨äºæ‰“å°æ¯è¡Œçš„ç¬¬äºŒä¸ªå­—æ®µï¼Œå³è¿›ç¨‹IDï¼ˆPIDï¼‰ã€‚åœ¨Unix&#x2F;Linuxç³»ç»Ÿä¸­ï¼Œ<code>ps -ef</code>å‘½ä»¤çš„è¾“å‡ºä¸­ï¼ŒPIDé€šå¸¸ä½äºç¬¬äºŒåˆ—ã€‚</li></ol><h3 id="2-OSSæ¨¡å—-jc-club-oss"><a href="#2-OSSæ¨¡å—-jc-club-oss" class="headerlink" title="2. OSSæ¨¡å—(jc-club-oss)"></a>2. OSSæ¨¡å—(jc-club-oss)</h3><p><img src="https://s2.loli.net/2024/07/28/XtN8V5Dq4orKgFP.png" alt="image-20240728193051763.png"></p><h4 id="OSSæ¨¡å—è®¾è®¡"><a href="#OSSæ¨¡å—è®¾è®¡" class="headerlink" title="OSSæ¨¡å—è®¾è®¡"></a>OSSæ¨¡å—è®¾è®¡</h4><p><img src="https://s2.loli.net/2024/07/17/DutXl68xcz4QmRr.png" alt="image-20240717153600388.png"></p><p>æ³¨æ„ï¼šè€ƒè™‘ oss çš„æ‰©å±•æ€§å’Œåˆ‡æ¢æ€§ã€‚</p><p>ç›®å‰å¯¹æ¥çš„ minioï¼Œè¦è€ƒè™‘ï¼Œå¦‚æœä½œä¸ºå…¬å…±çš„ oss æœåŠ¡ï¼Œå¦‚ä½•åˆ‡æ¢åˆ°å…¶ä»–çš„é˜¿é‡Œäº‘ oss æˆ–è€…å¯¹æ¥äº¬ä¸œäº‘çš„ ossã€‚ä½œä¸ºåŸºç¡€çš„ oss æœåŠ¡ï¼Œåˆ‡æ¢ç­‰ç­‰åŠ¨ä½œï¼Œä¸åº”è¯¥è¦æ±‚ä¸šåŠ¡æ–¹è¿›è¡Œæ”¹é€ ï¼Œä»¥åŠå¯¹åˆ‡æ¢æœ‰æ„ŸçŸ¥ã€‚</p><p><img src="https://s2.loli.net/2024/07/17/Ag6VbxBDoSRjn4O.png" alt="image-20240717153706800.png"></p><h4 id="minioæ¨¡å—å¼€å‘"><a href="#minioæ¨¡å—å¼€å‘" class="headerlink" title="minioæ¨¡å—å¼€å‘"></a>minioæ¨¡å—å¼€å‘</h4><p>controller-&gt;service-&gt;adaperï¼ˆé˜¿é‡Œ&#x2F;minioï¼Œé€‚é…å™¨æ¨¡å¼ï¼Œä¸ç”¨å·¥å‚ï¼‹ç­–ç•¥çš„æ˜¯å› ä¸ºå·¥å‚+ç­–ç•¥çš„ä¼ å…¥çš„å‚æ•°ä¹‹ç±»çš„å·®ä¸å¤šï¼Œæ‰€ä»¥ç”¨é€‚é…å™¨ï¼‰-&gt;å…·ä½“æ“ä½œ</p><p><a href="https://blog.csdn.net/Java_Mr_Jin/article/details/125643455?ops_request_misc=%7B%22request_id%22:%22172205057816800211579712%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172205057816800211579712&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-125643455-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=minio&spm=1018.2226.3001.4187">minioå®‰è£…éƒ¨ç½²åŠä½¿ç”¨-CSDNåšå®¢</a></p><p><code>pom.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.minio<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>minio<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span> //spingcloudçš„nacos</span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-log4j2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-bootstrap<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">//application.yml</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">4000</span></span><br><span class="line"><span class="attr">minio:</span></span><br><span class="line">  <span class="attr">url:</span> <span class="string">http://117.72.14.166:9000</span></span><br><span class="line">  <span class="attr">accessKey:</span> <span class="string">minioadmin</span></span><br><span class="line">  <span class="attr">secretKey:</span> <span class="string">minioadmin</span></span><br><span class="line"><span class="attr">storage:</span></span><br><span class="line">  <span class="attr">service:</span></span><br><span class="line">  <span class="attr">type:</span></span><br><span class="line">  <span class="string">minio</span></span><br><span class="line"> <span class="string">/*</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">`server.port:</span> <span class="number">4000</span><span class="string">`ï¼šè¿™è¡Œé…ç½®æŒ‡å®šäº†åº”ç”¨ç¨‹åºè¿è¡Œçš„ç«¯å£å·ä¸º4000ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="string">`minio`éƒ¨åˆ†ï¼šé…ç½®äº†MinIOæœåŠ¡çš„ç›¸å…³å±æ€§ã€‚</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">`url`ï¼šMinIOæœåŠ¡çš„URLåœ°å€ï¼Œè¿™é‡Œæ˜¯`http://117.72.14.166:9000`ã€‚</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">`accessKey`å’Œ`secretKey`ï¼šè®¿é—®MinIOæœåŠ¡çš„å¯†é’¥å’Œç§é’¥ï¼Œè¿™é‡Œéƒ½è®¾ç½®ä¸º`minioadmin`ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="string">`storage.service.type.minio`ï¼šæŒ‡å®šå­˜å‚¨æœåŠ¡çš„ç±»å‹ä¸ºMinIOã€‚</span></span><br><span class="line"> <span class="string">*/</span></span><br></pre></td></tr></table></figure><p><code>Miniocofig.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.oss.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.minio.MinioClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * minioé…ç½®ç®¡ç†</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: ChickenWing</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2023/10/11</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MinioConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * minioUrl</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;minio.url&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * minioè´¦æˆ·</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;minio.accessKey&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String accessKey;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * minioå¯†ç </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;minio.secretKey&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String secretKey;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ„é€ minioClient</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MinioClient <span class="title function_">getMinioClient</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> MinioClient.builder().endpoint(url).credentials(accessKey, secretKey).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>MinioUtil.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.oss.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.oss.entity.FileInfo;</span><br><span class="line"><span class="keyword">import</span> io.minio.*;</span><br><span class="line"><span class="keyword">import</span> io.minio.errors.*;</span><br><span class="line"><span class="keyword">import</span> io.minio.http.Method;</span><br><span class="line"><span class="keyword">import</span> io.minio.messages.Bucket;</span><br><span class="line"><span class="keyword">import</span> io.minio.messages.Item;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.security.InvalidKeyException;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * minioæ–‡ä»¶æ“ä½œå·¥å…·</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: ChickenWing</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2023/10/11</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MinioUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> MinioClient minioClient;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºbucketæ¡¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">createBucket</span><span class="params">(String bucket)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">exists</span> <span class="operator">=</span> minioClient.bucketExists(BucketExistsArgs.builder().bucket(bucket).build());</span><br><span class="line">        <span class="keyword">if</span> (!exists) &#123;</span><br><span class="line">            minioClient.makeBucket(MakeBucketArgs.builder().bucket(bucket).build());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">uploadFile</span><span class="params">(InputStream inputStream, String bucket, String objectName)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        minioClient.putObject(PutObjectArgs.builder().bucket(bucket).object(objectName)</span><br><span class="line">                .stream(inputStream, -<span class="number">1</span>, <span class="number">5242889L</span>).build());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ—å‡ºæ‰€æœ‰æ¡¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getAllBucket</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        List&lt;Bucket&gt; buckets = minioClient.listBuckets();</span><br><span class="line">        <span class="keyword">return</span> buckets.stream().map(Bucket::name).collect(Collectors.toList());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ—å‡ºå½“å‰æ¡¶åŠæ–‡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;FileInfo&gt; <span class="title function_">getAllFile</span><span class="params">(String bucket)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Iterable&lt;Result&lt;Item&gt;&gt; results = minioClient.listObjects(</span><br><span class="line">                ListObjectsArgs.builder().bucket(bucket).build());</span><br><span class="line">        List&lt;FileInfo&gt; fileInfoList = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Result&lt;Item&gt; result : results) &#123;</span><br><span class="line">            <span class="type">FileInfo</span> <span class="variable">fileInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInfo</span>();</span><br><span class="line">            <span class="type">Item</span> <span class="variable">item</span> <span class="operator">=</span> result.get();</span><br><span class="line">            fileInfo.setFileName(item.objectName());</span><br><span class="line">            fileInfo.setDirectoryFlag(item.isDir());</span><br><span class="line">            fileInfo.setEtag(item.etag());</span><br><span class="line">            fileInfoList.add(fileInfo);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> fileInfoList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸‹è½½æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> InputStream <span class="title function_">downLoad</span><span class="params">(String bucket, String objectName)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">return</span> minioClient.getObject(</span><br><span class="line">                GetObjectArgs.builder().bucket(bucket).object(objectName).build()</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤æ¡¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteBucket</span><span class="params">(String bucket)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        minioClient.removeBucket(</span><br><span class="line">                RemoveBucketArgs.builder().bucket(bucket).build()</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteObject</span><span class="params">(String bucket, String objectName)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        minioClient.removeObject(</span><br><span class="line">                RemoveObjectArgs.builder().bucket(bucket).object(objectName).build()</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æ–‡ä»¶url</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getPreviewFileUrl</span><span class="params">(String bucketName, String objectName)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">            <span class="type">GetPresignedObjectUrlArgs</span> <span class="variable">args</span> <span class="operator">=</span> GetPresignedObjectUrlArgs.builder()</span><br><span class="line">                    .method(Method.GET)</span><br><span class="line">                    .bucket(bucketName).object(objectName).build();</span><br><span class="line">            <span class="keyword">return</span> minioClient.getPresignedObjectUrl(args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>FileInfo.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileInfo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String fileName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Boolean directoryFlag;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String etag;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getFileName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> fileName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFileName</span><span class="params">(String fileName)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.fileName = fileName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">getDirectoryFlag</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> directoryFlag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDirectoryFlag</span><span class="params">(Boolean directoryFlag)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.directoryFlag = directoryFlag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getEtag</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> etag;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setEtag</span><span class="params">(String etag)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.etag = etag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>FileController.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> FileService fileService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/testGetAllBuckets&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testGetAllBuckets</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        List&lt;String&gt; allBucket = fileService.getAllBucket();</span><br><span class="line">        <span class="keyword">return</span> allBucket.get(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/getUrl&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUrl</span><span class="params">(String bucketName, String objectName)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">return</span> fileService.getUrl(bucketName, objectName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/upload&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">upload</span><span class="params">(MultipartFile uploadFile, String bucket, String objectName)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> fileService.uploadFile(uploadFile, bucket, objectName);</span><br><span class="line">        <span class="keyword">return</span> Result.ok(url);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>fileService.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> StorageAdapter storageAdapter;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">FileService</span><span class="params">(StorageAdapter storageAdapter)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.storageAdapter = storageAdapter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ—å‡ºæ‰€æœ‰æ¡¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getAllBucket</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> storageAdapter.getAllBucket();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUrl</span><span class="params">(String bucketName,String objectName)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> storageAdapter.getUrl(bucketName,objectName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">uploadFile</span><span class="params">(MultipartFile uploadFile, String bucket, String objectName)</span>&#123;</span><br><span class="line">        storageAdapter.uploadFile(uploadFile,bucket,objectName);</span><br><span class="line">        objectName = objectName + <span class="string">&quot;/&quot;</span> + uploadFile.getOriginalFilename();</span><br><span class="line">        <span class="keyword">return</span> storageAdapter.getUrl(bucket, objectName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>StorageConfig.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@RefreshScope</span> <span class="comment">//å®ç°nacosåŠ¨æ€çš„é…ç½®åˆ·æ–°</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StorageConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;storage.service.type&#125;&quot;)</span>  <span class="comment">//è¿™é‡Œçš„æ³¨è§£æ˜¯ä»pom.xmlä¸­å»è¯»çš„</span></span><br><span class="line">    <span class="keyword">private</span> String storageType;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@RefreshScope</span> <span class="comment">//å®ç°nacosåŠ¨æ€çš„é…ç½®åˆ·æ–°</span></span><br><span class="line">    <span class="keyword">public</span> StorageAdapter <span class="title function_">storageService</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;minio&quot;</span>.equals(storageType)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MinioStorageAdapter</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;aliyun&quot;</span>.equals(storageType)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AliStorageAdapter</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;æœªæ‰¾åˆ°å¯¹åº”çš„æ–‡ä»¶å­˜å‚¨å¤„ç†å™¨&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>StorageAdapter.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">StorageAdapter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºbucketæ¡¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">createBucket</span><span class="params">(String bucket)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">uploadFile</span><span class="params">(MultipartFile uploadFile, String bucket, String objectName)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ—å‡ºæ‰€æœ‰æ¡¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;String&gt; <span class="title function_">getAllBucket</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ—å‡ºå½“å‰æ¡¶åŠæ–‡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;FileInfo&gt; <span class="title function_">getAllFile</span><span class="params">(String bucket)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸‹è½½æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    InputStream <span class="title function_">downLoad</span><span class="params">(String bucket, String objectName)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤æ¡¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteBucket</span><span class="params">(String bucket)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤æ–‡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteObject</span><span class="params">(String bucket, String objectName)</span>;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">getUrl</span><span class="params">(String bucket, String objectName)</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>MinioStorageAdapter.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.oss.adapter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.oss.entity.FileInfo;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.oss.util.MinioUtil;</span><br><span class="line"><span class="keyword">import</span> lombok.SneakyThrows;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.multipart.MultipartFile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * minioIOå­˜å‚¨é€‚é…å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MinioStorageAdapter</span> <span class="keyword">implements</span> <span class="title class_">StorageAdapter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> MinioUtil minioUtil;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * minioUrl</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;minio.url&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String url;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@SneakyThrows</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">createBucket</span><span class="params">(String bucket)</span> &#123;</span><br><span class="line">        minioUtil.createBucket(bucket);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@SneakyThrows</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">uploadFile</span><span class="params">(MultipartFile uploadFile, String bucket, String objectName)</span> &#123;</span><br><span class="line">        minioUtil.createBucket(bucket);</span><br><span class="line">        <span class="keyword">if</span> (objectName != <span class="literal">null</span>) &#123;</span><br><span class="line">            minioUtil.uploadFile(uploadFile.getInputStream(), bucket, objectName + <span class="string">&quot;/&quot;</span> + uploadFile.getOriginalFilename());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            minioUtil.uploadFile(uploadFile.getInputStream(), bucket, uploadFile.getOriginalFilename());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@SneakyThrows</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getAllBucket</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> minioUtil.getAllBucket();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@SneakyThrows</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;FileInfo&gt; <span class="title function_">getAllFile</span><span class="params">(String bucket)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> minioUtil.getAllFile(bucket);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@SneakyThrows</span></span><br><span class="line">    <span class="keyword">public</span> InputStream <span class="title function_">downLoad</span><span class="params">(String bucket, String objectName)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> minioUtil.downLoad(bucket, objectName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@SneakyThrows</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteBucket</span><span class="params">(String bucket)</span> &#123;</span><br><span class="line">        minioUtil.deleteBucket(bucket);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@SneakyThrows</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteObject</span><span class="params">(String bucket, String objectName)</span> &#123;</span><br><span class="line">        minioUtil.deleteObject(bucket, objectName);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@SneakyThrows</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUrl</span><span class="params">(String bucket, String objectName)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> url + <span class="string">&quot;/&quot;</span> + bucket + <span class="string">&quot;/&quot;</span> + objectName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œç›¸å½“äºåšäº†ä¸ªé€‚é…å™¨ï¼Œè¿™é‡Œç”¨çš„æ˜¯minioçš„ï¼Œå¦‚æœè¦ç”¨é˜¿é‡Œçš„æœåŠ¡å°±è¦åˆ‡åˆ°å¦ä¸€å¥—äº†</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.oss.adapter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.oss.entity.FileInfo;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.multipart.MultipartFile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é˜¿é‡Œäº‘ossé€‚é…å™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AliStorageAdapter</span> <span class="keyword">implements</span> <span class="title class_">StorageAdapter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">createBucket</span><span class="params">(String bucket)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">uploadFile</span><span class="params">(MultipartFile uploadFile, String bucket, String objectName)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getAllBucket</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;String&gt; bucketNameList = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        bucketNameList.add(<span class="string">&quot;aliyun&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> bucketNameList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;FileInfo&gt; <span class="title function_">getAllFile</span><span class="params">(String bucket)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> InputStream <span class="title function_">downLoad</span><span class="params">(String bucket, String objectName)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteBucket</span><span class="params">(String bucket)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteObject</span><span class="params">(String bucket, String objectName)</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUrl</span><span class="params">(String bucket, String objectName)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="OSSæ¨¡å—é…åˆnacoså®ç°åŠ¨æ€åˆ‡æ¢"><a href="#OSSæ¨¡å—é…åˆnacoså®ç°åŠ¨æ€åˆ‡æ¢" class="headerlink" title="OSSæ¨¡å—é…åˆnacoså®ç°åŠ¨æ€åˆ‡æ¢"></a>OSSæ¨¡å—é…åˆnacoså®ç°åŠ¨æ€åˆ‡æ¢</h4><p>nacos ä½œä¸ºé…ç½®ä¸­å¿ƒï¼Œå¯ä»¥å®ç°åŠ¨æ€é…ç½®ï¼Œé€‚ç”¨äºæ¯”å¦‚åŠ¨æ€æ•°æ®æºåˆ‡æ¢ï¼ŒåŠ¨æ€åˆ‡æ¢ ossã€‚</p><p><strong>è¿™é‡Œè¦é…åˆ<code>RefreshScope</code>æ³¨è§£å»ä½¿ç”¨</strong>ï¼Œå®ç°åŠ¨æ€åˆ·æ–°ï¼ˆminio-&gt;aliï¼‰ã€‚</p><p><a href="https://blog.csdn.net/m0_71777195/article/details/126319418?ops_request_misc=%7B%22request_id%22:%22172205984816800185890242%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172205984816800185890242&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-1-126319418-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=RefreshScope&spm=1018.2226.3001.4187">ä¸€æ–‡å¸¦ä½ ç†è§£@RefreshScopeæ³¨è§£å®ç°åŠ¨æ€åˆ·æ–°åŸç†-CSDNåšå®¢</a></p><h5 id="é›†æˆnaocsåŠ¨æ€é…ç½®"><a href="#é›†æˆnaocsåŠ¨æ€é…ç½®" class="headerlink" title="é›†æˆnaocsåŠ¨æ€é…ç½®"></a>é›†æˆnaocsåŠ¨æ€é…ç½®</h5><p>é…ç½®</p><ol><li><p>jc-club-oss&#x2F;pom.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.minio<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>minio<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-log4j2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-bootstrap<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>jc-club-oss&#x2F;src&#x2F;main&#x2F;java&#x2F;com&#x2F;jingdianjichi&#x2F;oss&#x2F;controller&#x2F;FileController.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileController</span>&#123; </span><br><span class="line"><span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> FileService fileService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NacosValue(value = &quot;$&#123;storage.service.type&#125;&quot;, autoRefreshed = true)</span></span><br><span class="line">    <span class="keyword">private</span> String storageType;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/testGetAllBuckets&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testGetAllBuckets</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        List&lt;String&gt; allBucket = fileService.getAllBucket();</span><br><span class="line">        <span class="keyword">return</span> allBucket.get(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/testNacos&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">testNacos</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">return</span> storageType;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>jc-club-oss&#x2F;src&#x2F;main&#x2F;resources&#x2F;bootstrap.yml</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">jc-club-oss-dev</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">117.72</span><span class="number">.14</span><span class="number">.166</span><span class="string">:8848</span></span><br><span class="line">        <span class="attr">prefix:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">DEFAULT_GROUP</span></span><br><span class="line">        <span class="attr">namespace:</span></span><br><span class="line">        <span class="attr">file-extension:</span> <span class="string">yaml</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">117.72</span><span class="number">.14</span><span class="number">.166</span><span class="string">:8848</span></span><br><span class="line"><span class="string">/*</span></span><br><span class="line"><span class="string">Spring</span> <span class="string">åº”ç”¨åç§°ï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="attr">application.name:</span> <span class="string">jc-club-oss-devï¼šå®šä¹‰äº†Springåº”ç”¨çš„åç§°ä¸ºjc-club-oss-devã€‚</span></span><br><span class="line"><span class="string">æ¿€æ´»çš„é…ç½®æ–‡ä»¶ï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="attr">profiles.active:</span> <span class="string">devï¼šæŒ‡å®šäº†æ¿€æ´»çš„é…ç½®æ–‡ä»¶ä¸ºdevï¼Œè¿™æ„å‘³ç€åœ¨å¯åŠ¨æ—¶ä¼šåŠ è½½application-dev.yamlæˆ–application-dev.propertiesç­‰é…ç½®æ–‡ä»¶ã€‚</span></span><br><span class="line"><span class="string">Nacos</span> <span class="string">é…ç½®ï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="attr">cloud.nacos.config.server-addr:</span> <span class="number">117.72</span><span class="number">.14</span><span class="number">.166</span><span class="string">:8848ï¼šå®šä¹‰äº†Nacosé…ç½®æœåŠ¡å™¨çš„åœ°å€ï¼Œè¿™é‡Œæ˜¯117.72.14.166:8848ã€‚</span></span><br><span class="line"><span class="attr">cloud.nacos.config.prefix:</span> <span class="string">$&#123;spring.application.name&#125;ï¼šå®šä¹‰äº†é…ç½®çš„å‰ç¼€ï¼Œè¿™é‡Œä½¿ç”¨äº†$&#123;spring.application.name&#125;ï¼Œå³åº”ç”¨åç§°ä½œä¸ºå‰ç¼€ã€‚</span></span><br><span class="line"><span class="attr">cloud.nacos.config.group:</span> <span class="string">DEFAULT_GROUPï¼šå®šä¹‰äº†é…ç½®çš„åˆ†ç»„ï¼Œè¿™é‡Œæ˜¯DEFAULT_GROUPã€‚</span></span><br><span class="line"><span class="string">cloud.nacos.config.namespaceï¼šè¿™é‡Œæ²¡æœ‰æŒ‡å®šå…·ä½“çš„å‘½åç©ºé—´ï¼Œé€šå¸¸ç”¨äºåŒºåˆ†ä¸åŒç¯å¢ƒçš„é…ç½®ã€‚</span></span><br><span class="line"><span class="attr">cloud.nacos.config.file-extension:</span> <span class="string">yamlï¼šæŒ‡å®šäº†é…ç½®æ–‡ä»¶çš„æ‰©å±•åï¼Œè¿™é‡Œæ˜¯yamlã€‚</span></span><br><span class="line"><span class="string">Nacos</span> <span class="string">æœåŠ¡å‘ç°ï¼š</span></span><br><span class="line"></span><br><span class="line"><span class="attr">cloud.nacos.discovery.enabled:</span> <span class="literal">true</span><span class="string">ï¼šå¯ç”¨äº†Nacosçš„æœåŠ¡å‘ç°åŠŸèƒ½ã€‚</span></span><br><span class="line"><span class="attr">cloud.nacos.discovery.server-addr:</span> <span class="number">117.72</span><span class="number">.14</span><span class="number">.166</span><span class="string">:8848ï¼šå®šä¹‰äº†NacosæœåŠ¡å‘ç°æœåŠ¡å™¨çš„åœ°å€ï¼Œä¸é…ç½®æœåŠ¡å™¨åœ°å€ä¸€è‡´ã€‚</span></span><br><span class="line"><span class="string">é…ç½®çš„ä½œç”¨</span></span><br><span class="line"><span class="string">é…ç½®ç®¡ç†ï¼šé€šè¿‡Nacosé…ç½®ä¸­å¿ƒï¼Œåº”ç”¨å¯ä»¥åŠ¨æ€åœ°è¯»å–å’Œæ›´æ–°é…ç½®ï¼Œè€Œä¸éœ€è¦é‡å¯åº”ç”¨ã€‚è¿™å¯¹äºå¾®æœåŠ¡æ¶æ„ä¸­çš„é…ç½®ç®¡ç†éå¸¸æœ‰ç”¨ã€‚</span></span><br><span class="line"><span class="string">æœåŠ¡å‘ç°ï¼šé€šè¿‡NacosæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œåº”ç”¨å¯ä»¥æ³¨å†Œè‡ªèº«æœåŠ¡å¹¶å‘ç°å…¶ä»–æœåŠ¡ï¼Œä»è€Œå®ç°æœåŠ¡é—´çš„è°ƒç”¨ã€‚</span></span><br><span class="line"><span class="string">ä½¿ç”¨åœºæ™¯</span></span><br><span class="line"><span class="string">åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œä½¿ç”¨Nacosè¿›è¡Œé…ç½®ç®¡ç†å’ŒæœåŠ¡å‘ç°å¯ä»¥æé«˜ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§ã€‚</span></span><br><span class="line"><span class="string">åŠ¨æ€é…ç½®æ›´æ–°ï¼šåº”ç”¨å¯ä»¥æ ¹æ®Nacosé…ç½®ä¸­å¿ƒçš„é…ç½®å˜åŒ–è‡ªåŠ¨æ›´æ–°å…¶é…ç½®ï¼Œè€Œä¸éœ€è¦äººå·¥å¹²é¢„ã€‚*/</span></span><br></pre></td></tr></table></figure></li></ol><p>é€šè¿‡åœ¨nacosç•Œé¢ä¿®æ”¹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">storage:</span></span><br><span class="line"><span class="attr">service:</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">minio/aliyun</span></span><br></pre></td></tr></table></figure><p>å³å¯é€šè¿‡**@Configuration**æ³¨è§£çš„<code>Storage.java</code>ä¸­çš„<code>@Beanã€@RefreshScope</code>æ³¨è§£çš„storageServiceæ–¹æ³•ä¼šåˆ›å»ºé€‚é…å™¨çš„å¯¹åº”çš„StorageAdapterï¼Œæ‹¿åˆ°minio&#x2F;é˜¿é‡Œäº‘çš„ossæœåŠ¡ã€‚</p><p><a href="https://blog.csdn.net/weixin_44296929/article/details/139138784?ops_request_misc=%7B%22request_id%22:%22172208236416800222858291%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172208236416800222858291&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-139138784-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=@Configuration%E7%B1%BB&spm=1018.2226.3001.4187">@Configurationæ³¨è§£ä½¿ç”¨è¯¦è§£ã€è®°å½•ã€‘-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/m0_46190243/article/details/105604483?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~PaidSort-1-105604483-blog-135087635.235%5Ev43%5Epc_blog_bottom_relevance_base7&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~PaidSort-1-105604483-blog-135087635.235%5Ev43%5Epc_blog_bottom_relevance_base7&utm_relevant_index=2">Spring å¸¸ç”¨æ³¨è§£@Configurationï¼Œ@Beanï¼Œ@Componentï¼Œ@Serviceï¼Œ@Controllerï¼Œ@Repositoryï¼Œ@Entityçš„åŒºåˆ†ä¸å­¦ä¹ _@entity @repository åŒºåˆ«-CSDNåšå®¢</a></p><h3 id="3-ç™»å½•é‰´æƒæ¨¡å—"><a href="#3-ç™»å½•é‰´æƒæ¨¡å—" class="headerlink" title="3. ç™»å½•é‰´æƒæ¨¡å—"></a>3. ç™»å½•é‰´æƒæ¨¡å—</h3><p><img src="https://s2.loli.net/2024/07/28/l9Wx8Itu31GewjT.png" alt="image-20240728193217684.png"></p><p><img src="https://s2.loli.net/2024/07/29/txUbV5a1osP7f2z.png" alt="image-20240729100733585.png"></p><h4 id="æŠ€æœ¯é€‰å‹-1"><a href="#æŠ€æœ¯é€‰å‹-1" class="headerlink" title="æŠ€æœ¯é€‰å‹"></a>æŠ€æœ¯é€‰å‹</h4><p><strong>Sa-Token</strong> æ˜¯ä¸€ä¸ªè½»é‡çº§ Java æƒé™è®¤è¯æ¡†æ¶ï¼Œä¸»è¦è§£å†³ï¼š<strong>ç™»å½•è®¤è¯</strong>ã€<strong>æƒé™è®¤è¯</strong>ã€<strong>å•ç‚¹ç™»å½•</strong>ã€<strong>OAuth2.0</strong>ã€<strong>åˆ†å¸ƒå¼Sessionä¼šè¯</strong>ã€<strong>å¾®æœåŠ¡ç½‘å…³é‰´æƒ</strong> ç­‰ä¸€ç³»åˆ—æƒé™ç›¸å…³é—®é¢˜ã€‚</p><p>Sa-Token æ—¨åœ¨ä»¥ç®€å•ã€ä¼˜é›…çš„æ–¹å¼å®Œæˆç³»ç»Ÿçš„æƒé™è®¤è¯éƒ¨åˆ†ï¼Œä»¥ç™»å½•è®¤è¯ä¸ºä¾‹ï¼Œä½ åªéœ€è¦ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¼šè¯ç™»å½•ï¼Œå‚æ•°å¡«ç™»å½•äººçš„è´¦å·id </span></span><br><span class="line">StpUtil.login(<span class="number">10001</span>);</span><br></pre></td></tr></table></figure><p>æ— éœ€å®ç°ä»»ä½•æ¥å£ï¼Œæ— éœ€åˆ›å»ºä»»ä½•é…ç½®æ–‡ä»¶ï¼Œåªéœ€è¦è¿™ä¸€å¥é™æ€ä»£ç çš„è°ƒç”¨ï¼Œä¾¿å¯ä»¥å®Œæˆä¼šè¯ç™»å½•è®¤è¯ã€‚</p><p>å¦‚æœä¸€ä¸ªæ¥å£éœ€è¦ç™»å½•åæ‰èƒ½è®¿é—®ï¼Œæˆ‘ä»¬åªéœ€è°ƒç”¨ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¡éªŒå½“å‰å®¢æˆ·ç«¯æ˜¯å¦å·²ç»ç™»å½•ï¼Œå¦‚æœæœªç™»å½•åˆ™æŠ›å‡º `NotLoginException` å¼‚å¸¸</span></span><br><span class="line">StpUtil.checkLogin();</span><br></pre></td></tr></table></figure><p>åœ¨ Sa-Token ä¸­ï¼Œå¤§å¤šæ•°åŠŸèƒ½éƒ½å¯ä»¥ä¸€è¡Œä»£ç è§£å†³ï¼š</p><p>è¸¢äººä¸‹çº¿ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å°†è´¦å·idä¸º 10077 çš„ä¼šè¯è¸¢ä¸‹çº¿ </span></span><br><span class="line">StpUtil.kickout(<span class="number">10077</span>);å¤åˆ¶åˆ°å‰ªè´´æ¿é”™è¯¯å¤åˆ¶æˆåŠŸ</span><br></pre></td></tr></table></figure><p>æƒé™è®¤è¯ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ³¨è§£é‰´æƒï¼šåªæœ‰å…·å¤‡ `user:add` æƒé™çš„ä¼šè¯æ‰å¯ä»¥è¿›å…¥æ–¹æ³•</span></span><br><span class="line"><span class="meta">@SaCheckPermission(&quot;user:add&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">insert</span><span class="params">(SysUser user)</span> &#123;</span><br><span class="line">    <span class="comment">// ... </span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;ç”¨æˆ·å¢åŠ &quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è·¯ç”±æ‹¦æˆªé‰´æƒï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¹æ®è·¯ç”±åˆ’åˆ†æ¨¡å—ï¼Œä¸åŒæ¨¡å—ä¸åŒé‰´æƒ </span></span><br><span class="line">registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">SaInterceptor</span>(handler -&gt; &#123;</span><br><span class="line">    SaRouter.match(<span class="string">&quot;/user/**&quot;</span>, r -&gt; StpUtil.checkPermission(<span class="string">&quot;user&quot;</span>));</span><br><span class="line">    SaRouter.match(<span class="string">&quot;/admin/**&quot;</span>, r -&gt; StpUtil.checkPermission(<span class="string">&quot;admin&quot;</span>));</span><br><span class="line">    SaRouter.match(<span class="string">&quot;/goods/**&quot;</span>, r -&gt; StpUtil.checkPermission(<span class="string">&quot;goods&quot;</span>));</span><br><span class="line">    SaRouter.match(<span class="string">&quot;/orders/**&quot;</span>, r -&gt; StpUtil.checkPermission(<span class="string">&quot;orders&quot;</span>));</span><br><span class="line">    SaRouter.match(<span class="string">&quot;/notice/**&quot;</span>, r -&gt; StpUtil.checkPermission(<span class="string">&quot;notice&quot;</span>));</span><br><span class="line">    <span class="comment">// æ›´å¤šæ¨¡å—... </span></span><br><span class="line">&#125;)).addPathPatterns(<span class="string">&quot;/**&quot;</span>);</span><br><span class="line"><span class="number">9</span></span><br></pre></td></tr></table></figure><p>å½“ä½ å—å¤Ÿ Shiroã€SpringSecurity ç­‰æ¡†æ¶çš„ä¸‰æ‹œä¹å©ä¹‹åï¼Œä½ å°±ä¼šæ˜ç™½ï¼Œç›¸å¯¹äºè¿™äº›ä¼ ç»Ÿè€ç‰Œæ¡†æ¶ï¼ŒSa-Token çš„ API è®¾è®¡æ˜¯å¤šä¹ˆçš„ç®€å•ã€ä¼˜é›…ï¼</p><p><a href="https://sa-token.cc/doc.html#/?id=sa-token-%E5%8A%9F%E8%83%BD%E4%B8%80%E8%A7%88">Sa-Token åŠŸèƒ½ä¸€è§ˆ</a></p><p>Sa-Token ç›®å‰ä¸»è¦äº”å¤§åŠŸèƒ½æ¨¡å—ï¼šç™»å½•è®¤è¯ã€æƒé™è®¤è¯ã€å•ç‚¹ç™»å½•ã€OAuth2.0ã€å¾®æœåŠ¡é‰´æƒã€‚</p><ul><li><strong>ç™»å½•è®¤è¯</strong> â€”â€” å•ç«¯ç™»å½•ã€å¤šç«¯ç™»å½•ã€åŒç«¯äº’æ–¥ç™»å½•ã€ä¸ƒå¤©å†…å…ç™»å½•ã€‚</li><li><strong>æƒé™è®¤è¯</strong> â€”â€” æƒé™è®¤è¯ã€è§’è‰²è®¤è¯ã€ä¼šè¯äºŒçº§è®¤è¯ã€‚</li><li><strong>è¸¢äººä¸‹çº¿</strong> â€”â€” æ ¹æ®è´¦å·idè¸¢äººä¸‹çº¿ã€æ ¹æ®Tokenå€¼è¸¢äººä¸‹çº¿ã€‚</li><li><strong>æ³¨è§£å¼é‰´æƒ</strong> â€”â€” ä¼˜é›…çš„å°†é‰´æƒä¸ä¸šåŠ¡ä»£ç åˆ†ç¦»ã€‚</li><li><strong>è·¯ç”±æ‹¦æˆªå¼é‰´æƒ</strong> â€”â€” æ ¹æ®è·¯ç”±æ‹¦æˆªé‰´æƒï¼Œå¯é€‚é… restful æ¨¡å¼ã€‚</li><li><strong>Sessionä¼šè¯</strong> â€”â€” å…¨ç«¯å…±äº«Session,å•ç«¯ç‹¬äº«Session,è‡ªå®šä¹‰Session,æ–¹ä¾¿çš„å­˜å–å€¼ã€‚</li><li><strong>æŒä¹…å±‚æ‰©å±•</strong> â€”â€” å¯é›†æˆ Redisï¼Œé‡å¯æ•°æ®ä¸ä¸¢å¤±ã€‚</li><li><strong>å‰åå°åˆ†ç¦»</strong> â€”â€” APPã€å°ç¨‹åºç­‰ä¸æ”¯æŒ Cookie çš„ç»ˆç«¯ä¹Ÿå¯ä»¥è½»æ¾é‰´æƒã€‚</li><li><strong>Tokené£æ ¼å®šåˆ¶</strong> â€”â€” å†…ç½®å…­ç§ Token é£æ ¼ï¼Œè¿˜å¯ï¼šè‡ªå®šä¹‰ Token ç”Ÿæˆç­–ç•¥ã€‚</li><li><strong>è®°ä½æˆ‘æ¨¡å¼</strong> â€”â€” é€‚é… [è®°ä½æˆ‘] æ¨¡å¼ï¼Œé‡å¯æµè§ˆå™¨å…éªŒè¯ã€‚</li><li><strong>äºŒçº§è®¤è¯</strong> â€”â€” åœ¨å·²ç™»å½•çš„åŸºç¡€ä¸Šå†æ¬¡è®¤è¯ï¼Œä¿è¯å®‰å…¨æ€§ã€‚</li><li><strong>æ¨¡æ‹Ÿä»–äººè´¦å·</strong> â€”â€” å®æ—¶æ“ä½œä»»æ„ç”¨æˆ·çŠ¶æ€æ•°æ®ã€‚</li><li><strong>ä¸´æ—¶èº«ä»½åˆ‡æ¢</strong> â€”â€” å°†ä¼šè¯èº«ä»½ä¸´æ—¶åˆ‡æ¢ä¸ºå…¶å®ƒè´¦å·ã€‚</li><li><strong>åŒç«¯äº’æ–¥ç™»å½•</strong> â€”â€” åƒQQä¸€æ ·æ‰‹æœºç”µè„‘åŒæ—¶åœ¨çº¿ï¼Œä½†æ˜¯ä¸¤ä¸ªæ‰‹æœºä¸Šäº’æ–¥ç™»å½•ã€‚</li><li><strong>è´¦å·å°ç¦</strong> â€”â€” ç™»å½•å°ç¦ã€æŒ‰ç…§ä¸šåŠ¡åˆ†ç±»å°ç¦ã€æŒ‰ç…§å¤„ç½šé˜¶æ¢¯å°ç¦ã€‚</li><li><strong>å¯†ç åŠ å¯†</strong> â€”â€” æä¾›åŸºç¡€åŠ å¯†ç®—æ³•ï¼Œå¯å¿«é€Ÿ MD5ã€SHA1ã€SHA256ã€AES åŠ å¯†ã€‚</li><li><strong>ä¼šè¯æŸ¥è¯¢</strong> â€”â€” æä¾›æ–¹ä¾¿çµæ´»çš„ä¼šè¯æŸ¥è¯¢æ¥å£ã€‚</li><li><strong>Http Basicè®¤è¯</strong> â€”â€” ä¸€è¡Œä»£ç æ¥å…¥ Http Basicã€Digest è®¤è¯ã€‚</li><li><strong>å…¨å±€ä¾¦å¬å™¨</strong> â€”â€” åœ¨ç”¨æˆ·ç™»é™†ã€æ³¨é”€ã€è¢«è¸¢ä¸‹çº¿ç­‰å…³é”®æ€§æ“ä½œæ—¶è¿›è¡Œä¸€äº›AOPæ“ä½œã€‚</li><li><strong>å…¨å±€è¿‡æ»¤å™¨</strong> â€”â€” æ–¹ä¾¿çš„å¤„ç†è·¨åŸŸï¼Œå…¨å±€è®¾ç½®å®‰å…¨å“åº”å¤´ç­‰æ“ä½œã€‚</li><li><strong>å¤šè´¦å·ä½“ç³»è®¤è¯</strong> â€”â€” ä¸€ä¸ªç³»ç»Ÿå¤šå¥—è´¦å·åˆ†å¼€é‰´æƒï¼ˆæ¯”å¦‚å•†åŸçš„ User è¡¨å’Œ Admin è¡¨ï¼‰</li><li><strong>å•ç‚¹ç™»å½•</strong> â€”â€” å†…ç½®ä¸‰ç§å•ç‚¹ç™»å½•æ¨¡å¼ï¼šåŒåŸŸã€è·¨åŸŸã€åŒRedisã€è·¨Redisã€å‰åç«¯åˆ†ç¦»ç­‰æ¶æ„éƒ½å¯ä»¥æå®šã€‚</li><li><strong>å•ç‚¹æ³¨é”€</strong> â€”â€” ä»»æ„å­ç³»ç»Ÿå†…å‘èµ·æ³¨é”€ï¼Œå³å¯å…¨ç«¯ä¸‹çº¿ã€‚</li><li><strong>OAuth2.0è®¤è¯</strong> â€”â€” è½»æ¾æ­å»º OAuth2.0 æœåŠ¡ï¼Œæ”¯æŒopenidæ¨¡å¼ ã€‚</li><li><strong>åˆ†å¸ƒå¼ä¼šè¯</strong> â€”â€” æä¾›å…±äº«æ•°æ®ä¸­å¿ƒåˆ†å¸ƒå¼ä¼šè¯æ–¹æ¡ˆã€‚</li><li><strong>å¾®æœåŠ¡ç½‘å…³é‰´æƒ</strong> â€”â€” é€‚é…Gatewayã€ShenYuã€Zuulç­‰å¸¸è§ç½‘å…³çš„è·¯ç”±æ‹¦æˆªè®¤è¯ã€‚</li><li><strong>RPCè°ƒç”¨é‰´æƒ</strong> â€”â€” ç½‘å…³è½¬å‘é‰´æƒï¼ŒRPCè°ƒç”¨é‰´æƒï¼Œè®©æœåŠ¡è°ƒç”¨ä¸å†è£¸å¥”</li><li><strong>ä¸´æ—¶Tokenè®¤è¯</strong> â€”â€” è§£å†³çŸ­æ—¶é—´çš„ Token æˆæƒé—®é¢˜ã€‚</li><li><strong>ç‹¬ç«‹Redis</strong> â€”â€” å°†æƒé™ç¼“å­˜ä¸ä¸šåŠ¡ç¼“å­˜åˆ†ç¦»ã€‚</li><li><strong>Quickå¿«é€Ÿç™»å½•è®¤è¯</strong> â€”â€” ä¸ºé¡¹ç›®é›¶ä»£ç æ³¨å…¥ä¸€ä¸ªç™»å½•é¡µé¢ã€‚</li><li><strong>æ ‡ç­¾æ–¹è¨€</strong> â€”â€” æä¾› Thymeleaf æ ‡ç­¾æ–¹è¨€é›†æˆåŒ…ï¼Œæä¾› beetl é›†æˆç¤ºä¾‹ã€‚</li><li><strong>jwté›†æˆ</strong> â€”â€” æä¾›ä¸‰ç§æ¨¡å¼çš„ jwt é›†æˆæ–¹æ¡ˆï¼Œæä¾› token æ‰©å±•å‚æ•°èƒ½åŠ›ã€‚</li><li><strong>RPCè°ƒç”¨çŠ¶æ€ä¼ é€’</strong> â€”â€” æä¾› dubboã€grpc ç­‰é›†æˆåŒ…ï¼Œåœ¨RPCè°ƒç”¨æ—¶ç™»å½•çŠ¶æ€ä¸ä¸¢å¤±ã€‚</li><li><strong>å‚æ•°ç­¾å</strong> â€”â€” æä¾›è·¨ç³»ç»ŸAPIè°ƒç”¨ç­¾åæ ¡éªŒæ¨¡å—ï¼Œé˜²å‚æ•°ç¯¡æ”¹ï¼Œé˜²è¯·æ±‚é‡æ”¾ã€‚</li><li><strong>è‡ªåŠ¨ç»­ç­¾</strong> â€”â€” æä¾›ä¸¤ç§Tokenè¿‡æœŸç­–ç•¥ï¼Œçµæ´»æ­é…ä½¿ç”¨ï¼Œè¿˜å¯è‡ªåŠ¨ç»­ç­¾ã€‚</li><li><strong>å¼€ç®±å³ç”¨</strong> â€”â€” æä¾›SpringMVCã€WebFluxã€Solon ç­‰å¸¸è§æ¡†æ¶é›†æˆåŒ…ï¼Œå¼€ç®±å³ç”¨ã€‚</li><li><strong>æœ€æ–°æŠ€æœ¯æ ˆ</strong> â€”â€” é€‚é…æœ€æ–°æŠ€æœ¯æ ˆï¼šæ”¯æŒ SpringBoot 3.xï¼Œjdk 17ã€‚</li></ul><p>åŠŸèƒ½ç»“æ„å›¾ï¼š</p><p><img src="https://s2.loli.net/2024/07/28/1Duqo9p4fe2VWCL.png" alt="image-20240728132015039.png"></p><h4 id="é‰´æƒè®¾è®¡-RBACæ¨¡å‹"><a href="#é‰´æƒè®¾è®¡-RBACæ¨¡å‹" class="headerlink" title="é‰´æƒè®¾è®¡-RBACæ¨¡å‹"></a>é‰´æƒè®¾è®¡-RBACæ¨¡å‹</h4><p><strong>RBAC æ¨¡å‹ï¼ˆrole-based access controlï¼‰</strong></p><p>éå¸¸æˆç†Ÿçš„å®‰å…¨çš„æ¨¡å‹æ¦‚å¿µï¼ŒåŸºäºè§’è‰²å¸®åŠ©æˆ‘ä»¬æŠŠæˆæƒå’Œç”¨æˆ·çš„è®¿é—®æ§åˆ¶æ¥åšç»“åˆã€‚</p><p>Userï¼ˆç”¨æˆ·ï¼‰ç”¨æˆ·å°±æ˜¯æŒ‡æˆ‘ä»¬çš„ç³»ç»Ÿä½¿ç”¨è€…ã€‚</p><p>PerMissionï¼ˆæƒé™ï¼‰ç”¨æˆ·æˆ‘ä»¬å¯¹ç³»ç»Ÿçš„æ“ä½œï¼Œè®¿é—®å“ªäº›ä¸œè¥¿ï¼Œå¯ä»¥æ“ä½œå†™å…¥æ“ä½œç­‰ç­‰ã€‚å®é™…çš„ä¾‹å­ï¼Œæ¯”å¦‚æ–°å¢é¢˜ç›®ã€‚</p><p>Roleï¼ˆè§’è‰²ï¼‰æˆ‘ä»¬å»æŠŠä¸€ç»„çš„æƒé™ï¼Œå»åšé›†åˆï¼Œå°±å¾—åˆ°äº†è§’è‰²ã€‚</p><p>æ ¸å¿ƒæ€æƒ³å…¶å®å°±æ˜¯æŠŠè§’è‰²å’Œæƒé™åšå…³è”ï¼Œå®ç°æ•´ä½“çš„ä¸€ä¸ªçµæ´»è®¿é—®ï¼Œæé«˜æˆ‘ä»¬çš„ç³»ç»Ÿçš„å®‰å…¨æ€§å’Œç®¡ç†å‹ã€‚åŸºäºè¿™ä¸ªæ¨¡å‹ï¼Œæˆ‘ä»¬çš„å¼€å‘é€Ÿåº¦è¿˜æœ‰ç²’åº¦çš„ç²—ç»†ä¹Ÿéƒ½æ˜¯ååˆ†å¥½æ§åˆ¶çš„ã€‚</p><p>ä¼˜ç‚¹ï¼š</p><p>çµæ´»ï¼Œå®‰å…¨ï¼Œç®€åŒ–ç®¡ç†ã€‚</p><p><strong>ä¸‰ç§RBACæ¨¡å‹ï¼š</strong></p><ol><li><p><strong>RBAC-0 æ¨¡å‹</strong></p><p>ç”¨æˆ·å’Œè§’è‰²æ˜¯ä¸€ä¸ªå¤šå¯¹å¤šçš„å…³ç³»ï¼Œè§’è‰²å’Œæƒé™ä¹Ÿæ˜¯ä¸€ä¸ªå¤šå¯¹å¤šå…³ç³»ã€‚</p></li><li><p><strong>RBAC-1 æ¨¡å‹</strong></p><p>å¤šäº†ä¸€ä¸ªç»§æ‰¿çš„æ¦‚å¿µã€‚</p><p>æ¯”å¦‚ä¸€ä¸ªä¸šåŠ¡éƒ¨é—¨ï¼Œç»ç†ï¼Œä¸»ç®¡ï¼Œè¥ä¸šå‘˜ã€‚ä¸»ç®¡çš„æƒé™è‚¯å®šä¸èƒ½å¤§äºç»ç†ï¼Œè¥ä¸šå‘˜ä¸èƒ½å¤§äºä¸»ç®¡ã€‚</p><p>å­è§’è‰²çš„èŒƒå›´ä¸€å®šä¼šå°äºçˆ¶è§’è‰²ã€‚</p></li><li><p><strong>RBAC-2 æ¨¡å‹</strong></p><p>è§’è‰²äº’æ–¥ï¼ŒåŸºæ•°çº¦æŸï¼Œå…ˆå†³æ¡ä»¶ç­‰ç­‰ã€‚</p><ul><li>è§’è‰²äº’æ–¥ï¼šåŒä¸€ä¸ªç”¨æˆ·ï¼Œä¸èƒ½è¢«åˆ†é…åˆ°å¤åˆ¶çš„è§’è‰²ï¼Œæ¯”å¦‚è¯´ï¼Œä½ æ˜¯ä¸€ä¸ªé‡‡è´­ï¼Œé‚£ä½ å°±ä¸èƒ½åˆ†é…é”€å”®ã€‚</li><li>åŸºæ•°çº¦æŸï¼šä¸€ä¸ªè§’è‰²åˆ†é…çš„ç”¨æˆ·æ•°é‡æ˜¯æœ‰é™çš„ã€‚æ¯”å¦‚æœ‰ä¸€ä¸ªå…¬å¸çš„æ¶æ„å¸ˆï¼Œæœ€å¤šåªèƒ½æœ‰ä¸‰ä¸ªã€‚</li><li>å…ˆå†³æ¡ä»¶ï¼šä½ æƒ³è·å¾—æ¶æ„å¸ˆçš„è§’è‰²ï¼Œé‚£ä½ å¿…ç„¶å¾—å…ˆæ˜¯ä¸€ä¸ªèµ„æ·±å·¥ç¨‹å¸ˆçš„è§’è‰²ã€‚</li></ul></li></ol><p><strong>æƒé™</strong>ï¼š</p><ul><li>ä»–çš„å«ä¹‰å…¶å®æ˜¯éå¸¸å¹¿æ³›çš„ï¼Œå¯ä»¥æ˜¯èœå•ï¼Œé¡µé¢ï¼Œå­—æ®µï¼Œæ•°æ®ã€‚<ul><li>èœå•æƒé™</li><li>é¡µé¢æƒé™</li><li>å­—æ®µæƒé™</li><li>æ•°æ®æƒé™</li><li>æ“ä½œæƒé™</li></ul></li></ul><p><strong>ç”¨æˆ·ç»„ï¼š</strong></p><ul><li>å¹³å°çš„ç”¨æˆ·åŸºæ•°éå¸¸å¤§ï¼Œè§’è‰²ä¹Ÿéå¸¸çš„å¤šï¼Œå¦‚æœè¯´æˆ‘ç»™æ¯ä¸ªç”¨æˆ·éƒ½æ“ä½œä¸€ä¸‹è§’è‰²ï¼Œå°±éå¸¸çš„éº»çƒ¦ã€‚</li><li>æŠ½è±¡ä¸€å±‚ç»„çš„æ¦‚å¿µï¼ŒæŠŠåŒç±»çš„ç”¨æˆ·ï¼Œæ”¾åœ¨ä¸€èµ·ï¼Œç›´æ¥æ‹¥æœ‰ç›¸åŒçš„æƒé™ã€‚</li><li>éå¸¸æœ‰ç›Šäºå‡å°‘å·¥ä½œé‡ï¼Œä¸€äº›ç®¡ç†æ–¹é¢ä¹Ÿéå¸¸åˆé€‚ã€‚ç”¨æˆ·ç»„æŠ½è±¡åˆ°å®é™…ä¸­ï¼Œå…¶å®å°±æ˜¯éƒ¨é—¨å•Šï¼Œç§‘å®¤å•Šã€‚</li></ul><h4 id="é‰´æƒæ•°æ®æ¨¡å‹è®¾è®¡"><a href="#é‰´æƒæ•°æ®æ¨¡å‹è®¾è®¡" class="headerlink" title="é‰´æƒæ•°æ®æ¨¡å‹è®¾è®¡"></a>é‰´æƒæ•°æ®æ¨¡å‹è®¾è®¡</h4><p><img src="https://s2.loli.net/2024/07/28/ERumTNky47Z1xAK.jpg" alt="4aaca7492044e3e4d3c9d55c9b05c39.jpg"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for auth_permission</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `auth_permission`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `auth_permission`</span><br><span class="line">(</span><br><span class="line">    `id`             <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">    `name`           <span class="type">varchar</span>(<span class="number">64</span>)  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æƒé™åç§°&#x27;</span>,</span><br><span class="line">    `parent_id`      <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;çˆ¶id&#x27;</span>,</span><br><span class="line">    `type`           tinyint(<span class="number">4</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æƒé™ç±»å‹ 0èœå• 1æ“ä½œ&#x27;</span>,</span><br><span class="line">    `menu_url`       <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;èœå•è·¯ç”±&#x27;</span>,</span><br><span class="line">    `status`         tinyint(<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;çŠ¶æ€ 0å¯ç”¨ 1ç¦ç”¨&#x27;</span>,</span><br><span class="line">    `<span class="keyword">show</span>`           tinyint(<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å±•ç¤ºçŠ¶æ€ 0å±•ç¤º 1éšè—&#x27;</span>,</span><br><span class="line">    `icon`           <span class="type">varchar</span>(<span class="number">128</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å›¾æ ‡&#x27;</span>,</span><br><span class="line">    `permission_key` <span class="type">varchar</span>(<span class="number">64</span>)  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æƒé™å”¯ä¸€æ ‡è¯†&#x27;</span>,</span><br><span class="line">    `created_by`     <span class="type">varchar</span>(<span class="number">32</span>)  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºäºº&#x27;</span>,</span><br><span class="line">    `created_time`   datetime     <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    `update_by`      <span class="type">varchar</span>(<span class="number">32</span>)  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°äºº&#x27;</span>,</span><br><span class="line">    `update_time`    datetime     <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">    `is_deleted`     <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;æ˜¯å¦è¢«åˆ é™¤ 0ä¸ºåˆ é™¤ 1å·²åˆ é™¤&#x27;</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">2</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of auth_permission</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `auth_permission`</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;æ–°å¢é¢˜ç›®&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;ladiwd/www&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;http://1.png&#x27;</span>, <span class="string">&#x27;subject:add1&#x27;</span>, <span class="string">&#x27;oYA4HtwGJEsLio6pGrhx5Hzv9XD0&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;2024-02-28 03:20:38&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;2023-11-12 16:17:12&#x27;</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for auth_role</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `auth_role`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `auth_role`</span><br><span class="line">(</span><br><span class="line">    `id`           <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">    `role_name`    <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è§’è‰²åç§°&#x27;</span>,</span><br><span class="line">    `role_key`     <span class="type">varchar</span>(<span class="number">64</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è§’è‰²å”¯ä¸€æ ‡è¯†&#x27;</span>,</span><br><span class="line">    `created_by`   <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºäºº&#x27;</span>,</span><br><span class="line">    `created_time` datetime    <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    `update_by`    <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°äºº&#x27;</span>,</span><br><span class="line">    `update_time`  datetime    <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">    `is_deleted`   <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;æ˜¯å¦è¢«åˆ é™¤ 0æœªåˆ é™¤ 1å·²åˆ é™¤&#x27;</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">3</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of auth_role</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `auth_role`</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;ç®¡ç†å‘˜&#x27;</span>, <span class="string">&#x27;admin_user&#x27;</span>, <span class="string">&#x27;oYA4HtwGJEsLio6pGrhx5Hzv9XD0&#x27;</span>, <span class="string">&#x27;2024-02-28 03:20:44&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;2023-11-12 16:16:07&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `auth_role`</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;æ™®é€šç”¨æˆ·&#x27;</span>, <span class="string">&#x27;normal_user&#x27;</span>, <span class="string">&#x27;oYA4HtwGJEsLio6pGrhx5Hzv9XD0&#x27;</span>, <span class="string">&#x27;2024-02-28 03:20:44&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;2023-11-12 16:16:10&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for auth_role_permission</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `auth_role_permission`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `auth_role_permission`</span><br><span class="line">(</span><br><span class="line">    `id`            <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">    `role_id`       <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è§’è‰²id&#x27;</span>,</span><br><span class="line">    `permission_id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æƒé™id&#x27;</span>,</span><br><span class="line">    `created_by`    <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºäºº&#x27;</span>,</span><br><span class="line">    `created_time`  datetime    <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    `update_by`     <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°äºº&#x27;</span>,</span><br><span class="line">    `update_time`   datetime    <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">    `is_deleted`    <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">2</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 COMMENT<span class="operator">=</span><span class="string">&#x27;è§’è‰²æƒé™å…³è”è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of auth_role_permission</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for auth_user</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `auth_user`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `auth_user`</span><br><span class="line">(</span><br><span class="line">    `id`           <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">    `user_name`    <span class="type">varchar</span>(<span class="number">32</span>)  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”¨æˆ·åç§°/è´¦å·&#x27;</span>,</span><br><span class="line">    `nick_name`    <span class="type">varchar</span>(<span class="number">32</span>)  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ˜µç§°&#x27;</span>,</span><br><span class="line">    `email`        <span class="type">varchar</span>(<span class="number">32</span>)  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;é‚®ç®±&#x27;</span>,</span><br><span class="line">    `phone`        <span class="type">varchar</span>(<span class="number">32</span>)  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ‰‹æœºå·&#x27;</span>,</span><br><span class="line">    `password`     <span class="type">varchar</span>(<span class="number">64</span>)  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¯†ç &#x27;</span>,</span><br><span class="line">    `sex`          tinyint(<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ€§åˆ«&#x27;</span>,</span><br><span class="line">    `avatar`       <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;å¤´åƒ&#x27;</span>,</span><br><span class="line">    `status`       tinyint(<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;çŠ¶æ€ 0å¯ç”¨ 1ç¦ç”¨&#x27;</span>,</span><br><span class="line">    `introduce`    <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ä¸ªäººä»‹ç»&#x27;</span>,</span><br><span class="line">    `ext_json`     <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç‰¹æ®Šå­—æ®µ&#x27;</span>,</span><br><span class="line">    `created_by`   <span class="type">varchar</span>(<span class="number">32</span>)  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºäºº&#x27;</span>,</span><br><span class="line">    `created_time` datetime     <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    `update_by`    <span class="type">varchar</span>(<span class="number">32</span>)  <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°äºº&#x27;</span>,</span><br><span class="line">    `update_time`  datetime     <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">    `is_deleted`   <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;æ˜¯å¦è¢«åˆ é™¤ 0æœªåˆ é™¤ 1å·²åˆ é™¤&#x27;</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 COMMENT<span class="operator">=</span><span class="string">&#x27;ç”¨æˆ·ä¿¡æ¯è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of auth_user</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for auth_user_role</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `auth_user_role`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `auth_user_role`</span><br><span class="line">(</span><br><span class="line">    `id`           <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ä¸»é”®&#x27;</span>,</span><br><span class="line">    `user_id`      <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ç”¨æˆ·id&#x27;</span>,</span><br><span class="line">    `role_id`      <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;è§’è‰²id&#x27;</span>,</span><br><span class="line">    `created_by`   <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºäºº&#x27;</span>,</span><br><span class="line">    `created_time` datetime    <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    `update_by`    <span class="type">varchar</span>(<span class="number">32</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°äºº&#x27;</span>,</span><br><span class="line">    `update_time`  datetime    <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">    `is_deleted`   <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 COMMENT<span class="operator">=</span><span class="string">&#x27;ç”¨æˆ·è§’è‰²è¡¨&#x27;</span>;</span><br></pre></td></tr></table></figure><h4 id="é‰´æƒæ¶æ„è®¾è®¡"><a href="#é‰´æƒæ¶æ„è®¾è®¡" class="headerlink" title="é‰´æƒæ¶æ„è®¾è®¡"></a>é‰´æƒæ¶æ„è®¾è®¡</h4><p><strong>jc-club-auth</strong>ï¼šè¿™ä¸ªæœåŠ¡æ‰¿è½½äº†æˆ‘ä»¬æ‰€æœ‰çš„åŸºç¡€æ•°æ®æºã€‚ä»–<strong>ä¸ç®¡é‰´æƒï¼Œåªç®¡æ•°æ®ç›¸å…³çš„æŒä¹…åŒ–æ“ä½œä»¥åŠä¸šåŠ¡æ“ä½œ</strong>ï¼Œæä¾›å‡ºå„ç§å„æ ·çš„æƒé™ç›¸å…³çš„æ¥å£ã€‚</p><p><strong>nacosï¼š</strong>å°† auth æœåŠ¡ä»¥åŠ subject æœåŠ¡éƒ½æ³¨å†Œåˆ°ä¸Šé¢ã€‚å†…éƒ¨è¿›è¡Œè°ƒç”¨ï¼Œä¸å¯¹å¤–æš´éœ²ã€‚é€šè¿‡ nacos å®ç°æˆ‘ä»¬çš„æœåŠ¡å‘ç°ã€‚</p><p><strong>gatewayï¼ˆç½‘å…³ï¼‰</strong>ï¼šç½‘å…³å±‚ä¼š<strong>å¯¹å¤–æä¾›æœåŠ¡</strong>ï¼Œ<strong>å†…éƒ¨å®ç°è·¯ç”±ï¼Œé‰´æƒ</strong>ã€‚æ•´ä½“æˆ‘ä»¬é‡‡å– token çš„æ–¹å¼æ¥ä¸å‰ç«¯è¿›è¡Œäº¤äº’ã€‚ç”±ç½‘å…³æ¥å†³å®šå½“å‰ç”¨æˆ·æ˜¯å¦å¯ä»¥æ“ä½œåˆ°åé¢çš„ä¸šåŠ¡é€»è¾‘ã€‚</p><p><img src="https://s2.loli.net/2024/07/28/hWNqz4F7CsrRXdg.png" alt="image-20240728144400289.png"></p><p>é‰´æƒã€è·¯ç”±ç­‰å¤„ç†éƒ½ç”±ç½‘å…³æ¥åšã€‚</p><h4 id="é‰´æƒåŠŸèƒ½è®¾è®¡"><a href="#é‰´æƒåŠŸèƒ½è®¾è®¡" class="headerlink" title="é‰´æƒåŠŸèƒ½è®¾è®¡"></a>é‰´æƒåŠŸèƒ½è®¾è®¡</h4><ol><li><p>ç”¨æˆ·åŸºç¡€æ¨¡å— </p><ul><li>æ–°å¢ç”¨æˆ·</li><li>ä¿®æ”¹ç”¨æˆ·</li><li>åˆ é™¤ç”¨æˆ·</li><li>ç”¨æˆ·å¯ç”¨</li><li>ç”¨æˆ·ç¦ç”¨</li><li>ç”¨æˆ·å¯†ç åŠ å¯†</li></ul></li><li><p>è§’è‰²åŸºç¡€æ¨¡å— </p><ul><li>æ–°å¢è§’è‰²</li><li>ä¿®æ”¹è§’è‰²</li><li>åˆ é™¤è§’è‰²</li><li>è§’è‰²ä¸ç”¨æˆ·çš„å…³è”</li></ul></li><li><p>æƒé™åŸºç¡€æ¨¡å— </p><ul><li><p>æ–°å¢æƒé™</p></li><li><p>ä¿®æ”¹æƒé™</p></li><li><p>åˆ é™¤æƒé™</p></li><li><p>æƒé™ç¦ç”¨ä¸å¯ç”¨</p></li><li><p>æƒé™çš„å±•ç¤ºä¸éšè—</p></li><li><p>æƒé™ä¸è§’è‰²å…³è”</p></li></ul></li><li><p>ç™»å½•æ³¨å†Œæ¨¡å— </p><ul><li>æ³¨å†Œç”¨æˆ·ä¸éªŒè¯</li></ul><ol><li><p>çŸ­ä¿¡çš„æ–¹å¼ï¼Œé€šè¿‡å‘æ‰‹æœºå·å‘é€éªŒè¯ç ï¼Œæ¥å®ç°ç”¨æˆ·çš„éªŒè¯å¹¶ç™»å½•ï¼ˆè€ƒè™‘çš„æˆæœ¬æ˜¯çŸ­ä¿¡çš„è´¹ç”¨ï¼‰</p></li><li><p>é‚®ç®±çš„æ³¨å†Œç™»å½•ã€‚</p><p>ç”¨æˆ·æ³¨å†Œçš„æ—¶å€™ï¼Œç•™ä¸€ä¸ªé‚®ç®±ï¼Œæˆ‘ä»¬å¾€é‚®ç®±é‡Œé€šè¿‡é‚®ç®±æœåŠ¡å™¨å‘é€ä¸€ä¸ªé“¾æ¥ï¼Œç”¨æˆ·ç‚¹å‡»ä¹‹åï¼Œå®ç°ä¸€ä¸ªæ¿€æ´»ï¼Œæ¿€æ´»æˆåŠŸä¹‹åå°±å®Œæˆäº†æ³¨å†Œã€‚ï¼ˆ0 æˆæœ¬ï¼Œåå¤„è¿™ç§å‘é€çš„é‚®ä»¶å¾ˆå®¹æ˜“è¿›åƒåœ¾ç®±ï¼‰</p></li><li><p>ä¸ªäººå…¬ä¼—å·æ¨¡å¼ï¼ˆä¸ªäººå¼€å‘è€…æ— å…¬å¸çš„ï¼Œæ¯”è¾ƒé€‚åˆä½¿ç”¨ï¼Œ0 æˆæœ¬ï¼‰</p><p>ç”¨æˆ·ç™»å½•çš„æ—¶å€™ï¼Œå¼¹å‡ºæˆ‘ä»¬çš„è¿™ä¸ªå…¬ä¼—å·çš„ç ã€‚æ‰«ç åï¼Œç”¨æˆ·è¾“å…¥æˆ‘ä»¬æç¤ºçš„éªŒè¯ç ã€‚å¯ä»¥éšæœºæ¯”å¦‚è¯´ nadbugeï¼Œé€šè¿‡æˆ‘ä»¬çš„å…¬ä¼—å·å¯¹æ¥çš„å›è°ƒã€‚èƒ½æ‹¿åˆ°ä¸€å®šçš„ä¿¡æ¯ï¼Œç”¨æˆ·çš„ openIdã€‚è¿›è€Œè®°å½•ç”¨æˆ·çš„ä¿¡æ¯</p></li><li><p>ä¼ä¸šçš„æœåŠ¡å·ï¼ˆå¿…é¡»è¦æœ‰è¥ä¸šæ‰§ç…§ï¼Œè‡ªå·±ç©çš„ä¸ä¸Šçº¿çš„è¯ï¼Œä¹Ÿå¯ä»¥ç”¨æµ‹è¯•å·ï¼‰</p><p>å¥½å¤„å°±æ˜¯ä¸ä»…æ‰“é€šäº†å„ç§å›è°ƒï¼Œè€Œä¸”è¿˜èƒ½æ‹¿åˆ°ç”¨æˆ·çš„ä¿¡æ¯ã€‚</p></li></ol><ul><li>ç™»å½•åŠŸèƒ½</li></ul><p>  ä¼ ç»Ÿçš„ pc å½¢å¼ï¼Œéƒ½æ˜¯ç™»å½•ä¹‹åï¼Œå†™å…¥ cookieã€‚å‰ç«¯å†æ¬¡è¯·æ±‚çš„æ—¶å€™ï¼Œå¸¦ç€ cookie ä¸€ä¸ªèº«ä»½è¯†åˆ«å°±å¯ä»¥å®Œæˆè®¤è¯ã€‚</p><p>  åå¤„æ˜¯ä»€ä¹ˆï¼Ÿå°ç¨‹åºå‘€ï¼Œapp å‘€ï¼Œå…¶å®æ˜¯æ²¡æœ‰ cookie è¿™ä¸ªæ¦‚å¿µçš„ã€‚</p><p>  <a href="https://blog.csdn.net/qq_53895518/article/details/136869614">å•ç‚¹ç™»å½•(SSO)è¯¦è§£â€”â€”è¶…è¯¦ç»†-CSDNåšå®¢</a></p><p>  ä¸ºäº†æ›´å¥½çš„æ‰©å±•ï¼Œæˆ‘ä»¬å°±ç›´æ¥é€‰æ‹© <strong>tokençš„æ¨¡å¼</strong>ã€‚token æ”¾å…¥ header æ¥å®ç°ç”¨æˆ·èº«ä»½çš„è¯†åˆ«ä¸é‰´æƒã€‚</p><ul><li>è¸¢äººä¸‹çº¿</li></ul><p>  å‘ç°é£é™©ç”¨æˆ·ï¼Œå¯ä»¥é€šè¿‡åå°ç›´æ¥æŠŠç”¨æˆ·è¸¢æ‰ï¼Œç¦æ­¢å…¶å†è®¿é—®ï¼Œtoken ä¹Ÿå¯ä»¥ç›´æ¥ç½®ä¸ºå¤±æ•ˆçš„å½¢å¼ã€‚</p><ul><li>é›†æˆ redis ï¼ˆä¿å­˜tokenï¼‰</li></ul><p>  å¦‚æœè¯´æˆ‘ä»¬é€‰æ‹©äº† tokenï¼Œç„¶åä¸åš token çš„ä¿å­˜ï¼ŒæœåŠ¡é‡å¯å‘€ï¼Œåˆ†å¸ƒå¼å¾®æœåŠ¡å•Šï¼Œæ•°æ®æ˜¯æ— æ³•å…±äº«å¹¶ä¸”ä¼šäº§ç”Ÿä¸¢å¤±é—®é¢˜ï¼Œæ‰€ä»¥ç”¨ redis æ¥å­˜å‚¨ä¸€äº›ä¿¡æ¯ï¼Œå®ç°å…±äº«ã€‚</p><ul><li><p>è‡ªå®šä¹‰æˆ‘ä»¬çš„ token é£æ ¼å’Œå‰ç¼€ </p><p>æ¯”å¦‚æ­£å¸¸çš„ token å¯èƒ½æ˜¯ uuidï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å…¶ä»–å½¢å¼ã€‚</p><p>ç„¶åå°±æ˜¯ token çš„å‰ç«¯çš„ä¼ é€’ï¼Œä¹Ÿå¯ä»¥å»å®šä¹‰å‰ç¼€ï¼Œå›ºå®šå‰ç¼€æ‰ç”Ÿæ•ˆã€‚</p></li><li><p>è®°ä½æˆ‘</p></li></ul><p>  å½“æˆ‘ä»¬å»å‹¾é€‰è®°ä½æˆ‘çš„æ—¶å€™ï¼Œä¸‹æ¬¡ç™»å½•å°±è‡ªåŠ¨å®ç°äº†ã€‚</p><p>  å‰åç«¯åˆ†ç¦»ï¼Œæ²¡æœ‰ token çš„æ—¶å€™ï¼Œå¿…ç„¶ä¼šäº§ç”Ÿæ— æ³•å®ç°çš„é—®é¢˜ï¼Œæˆ‘ä»¬å°±é€‰æ‹©åœ¨å‰ç«¯çš„ localstorage æ¥åšã€‚</p></li><li><p>ç½‘å…³ç»Ÿä¸€é‰´æƒ </p><p>æ ¡éªŒæƒé™ï¼Œæ ¡éªŒç”¨æˆ·çš„è§’è‰²ç­‰ç­‰çš„ä¸œè¥¿ï¼Œå°±æ”¾åœ¨ç½‘å…³é‡Œé¢ç»Ÿä¸€å»åšã€‚</p><p>ä¸æ”¾åœ¨ç½‘å…³ï¼Œå¯¼è‡´æ¯ä¸ªå¾®æœåŠ¡ï¼Œå…¨è¦å¼•å…¥çš„é‰´æƒçš„æ¡†æ¶ï¼Œä¸æ–­çš„å»å†™é‡å¤çš„ä»£ç ã€‚</p><p>æ•°æ®çš„æƒé™è·å–äº§ç”Ÿé—®é¢˜ï¼š</p><ol><li>ç½‘å…³ç›´æ¥å¯¹æ¥æ•°æ®åº“ï¼Œå®ç°æŸ¥è¯¢ã€‚</li><li>redis ä¸­è·å–æ•°æ®ï¼Œè·å–ä¸åˆ°çš„æ—¶å€™è¿˜æ˜¯è¦åƒç¬¬ä¸€ç§ä¸€æ ·å»æ•°æ®åº“é‡ŒæŸ¥ã€‚</li><li>redis ä¸­è·å–ç¼“å­˜ï¼Œæ²¡æœ‰çš„è¯ï¼Œä» auth æœåŠ¡é‡Œé¢è·å–ç›¸å…³çš„ä¿¡æ¯ã€‚</li><li>ç›´æ¥ä» redis è¯»å–ã€‚</li></ol></li></ol><h4 id="authæ¨¡å—é…ç½®"><a href="#authæ¨¡å—é…ç½®" class="headerlink" title="authæ¨¡å—é…ç½®"></a>authæ¨¡å—é…ç½®</h4><p><code>jc-club-auth-application/pom.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span> //ç”¨äº Spring Cloud é¡¹ç›®ä¸­ï¼Œé€šè¿‡ Feign å®¢æˆ·ç«¯ç®€åŒ– HTTP å®¢æˆ·ç«¯çš„è°ƒç”¨ã€‚</span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-loadbalancer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span> //ç”¨äº Spring Cloud é¡¹ç›®ä¸­ï¼Œæä¾›å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚</span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span> //è‡ªåŠ¨ç”Ÿæˆ getterã€setterã€æ„é€ å‡½æ•°ç­‰ã€‚</span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>jc-club-auth-application-controller/pom.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- sa-token ä¾èµ–--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.dev33<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>sa-token-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.37.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-auth-domain<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-auth-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>jc-club-auth-starter/pom.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-auth-infra<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-auth-application-controller<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span> //nacos</span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-bootstrap<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>jc-club-auth-domain/pom.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-auth-infra<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-auth-common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.code.gson<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>gson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.8.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>jc-club-auth-infra/pom.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- jdbcStarter --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- druidè¿æ¥æ±  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.22<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- mysql --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.22<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- mybatisplus --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-auth-common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="ç™»å½•-è¯¦æƒ…åœ¨ç”¨æˆ·æ¨¡å—"><a href="#ç™»å½•-è¯¦æƒ…åœ¨ç”¨æˆ·æ¨¡å—" class="headerlink" title="ç™»å½•(è¯¦æƒ…åœ¨ç”¨æˆ·æ¨¡å—)"></a>ç™»å½•(è¯¦æƒ…åœ¨ç”¨æˆ·æ¨¡å—)</h4><p>æ³¨æ„openidå°±æ˜¯username</p><p><strong>Sa-token</strong></p><p><a href="https://sa-token.cc/doc.html#/up/not-cookie">å‰åç«¯åˆ†ç¦» (sa-token.cc)</a></p><p>åœ¨authæ¨¡å—ä¸­çš„<code>UserController.java</code>ä¸­å®ç°</p><p><code>jc-club-auth: UserController</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;doLogin&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;SaTokenInfo&gt; <span class="title function_">doLogin</span><span class="params">(<span class="meta">@RequestParam(&quot;validCode&quot;)</span> String validCode)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Preconditions.checkArgument(!StringUtils.isBlank(validCode), <span class="string">&quot;éªŒè¯ç ä¸èƒ½ä¸ºç©º!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> Result.ok(authUserDomainService.doLogin(validCode));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;UserController.doLogin.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        <span class="keyword">return</span> Result.fail(<span class="string">&quot;ç”¨æˆ·ç™»å½•å¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>jc-club-auth:AuthUserDomainServiceImpl</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> SaTokenInfo <span class="title function_">doLogin</span><span class="params">(String validCode)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">loginKey</span> <span class="operator">=</span> redisUtil.buildKey(LOGIN_PREFIX, validCode);</span><br><span class="line">    <span class="type">String</span> <span class="variable">openId</span> <span class="operator">=</span> redisUtil.get(loginKey);</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(openId)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">AuthUserBO</span> <span class="variable">authUserBO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthUserBO</span>();</span><br><span class="line">    authUserBO.setUserName(openId);</span><br><span class="line">    <span class="built_in">this</span>.register(authUserBO);</span><br><span class="line">    StpUtil.login(openId);</span><br><span class="line">    <span class="type">SaTokenInfo</span> <span class="variable">tokenInfo</span> <span class="operator">=</span> StpUtil.getTokenInfo();</span><br><span class="line">    <span class="keyword">return</span> tokenInfo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¾®æœåŠ¡æ³¨å†Œåˆ°nacos"><a href="#å¾®æœåŠ¡æ³¨å†Œåˆ°nacos" class="headerlink" title="å¾®æœåŠ¡æ³¨å†Œåˆ°nacos"></a>å¾®æœåŠ¡æ³¨å†Œåˆ°nacos</h4><p>é˜¿é‡Œäº‘è„šæ‰‹æ¶ç”¨äºç»„ä»¶&#x2F;ç‰ˆæœ¬çš„é€‰æ‹©å…¼å®¹ï¼Œéå¸¸æ–¹ä¾¿: <a href="">start.aliyun.com</a></p><h5 id="ossæœåŠ¡-nacos"><a href="#ossæœåŠ¡-nacos" class="headerlink" title="ossæœåŠ¡-&gt;nacos"></a>ossæœåŠ¡-&gt;nacos</h5><p><img src="https://s2.loli.net/2024/07/29/zDoegrTpUiBQHu5.png" alt="image-20240729102012839.png"></p><p><code>pom.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span> //æ„å»º Web åº”ç”¨ç¨‹åºæ‰€éœ€çš„ Spring MVC å’Œ Tomcatã€‚</span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span> //ä¸ä¼šåŒ…å«é»˜è®¤çš„æ—¥å¿—æ¡†æ¶</span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.minio<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span> //ç”¨äºä¸ Minio å¯¹è±¡å­˜å‚¨æœåŠ¡è¿›è¡Œäº¤äº’çš„å®¢æˆ·ç«¯åº“ã€‚</span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>minio<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span> //</span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span> //å‡å°‘æ ·æ¿ä»£ç ï¼Œè‡ªåŠ¨ç”Ÿæˆ getterã€setter ç­‰ã€‚</span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span> //ç”¨äºé›†æˆ Nacos é…ç½®ä¸­å¿ƒï¼Œæä¾›é…ç½®ç®¡ç†åŠŸèƒ½ã€‚</span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-log4j2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span> //æ›¿æ¢é»˜è®¤çš„æ—¥å¿—æ¡†æ¶ï¼Œä½¿ç”¨ Log4j2 ä½œä¸ºæ—¥å¿—è®°å½•å™¨ã€‚</span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-bootstrap<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span> //ç”¨äº Spring Cloud åº”ç”¨çš„å¼•å¯¼ç±»ï¼Œå¸®åŠ©åº”ç”¨å¯åŠ¨æ—¶åŠ è½½é…ç½®(bootstrap.yaml)ã€‚</span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span> //ç”¨äºé›†æˆ Nacos æœåŠ¡å‘ç°ï¼Œæä¾›æœåŠ¡æ³¨å†Œä¸å‘ç°åŠŸèƒ½ã€‚</span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¦ç”¨åˆ°<code>bootstrap.yaml</code>å»åœ¨nacosä¸­æ³¨å†Œ:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">jc-club-oss-dev</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">117.72</span><span class="number">.14</span><span class="number">.166</span><span class="string">:8848</span></span><br><span class="line">        <span class="attr">prefix:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">DEFAULT_GROUP</span></span><br><span class="line">        <span class="attr">namespace:</span></span><br><span class="line">        <span class="attr">file-extension:</span> <span class="string">yaml</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">117.72</span><span class="number">.14</span><span class="number">.166</span><span class="string">:8848</span> <span class="string">//éƒ¨ç½²æœ‰nacosçš„äº‘æœåŠ¡å™¨çš„åœ°å€</span></span><br></pre></td></tr></table></figure><p>å¯åŠ¨ç¨‹åºå°±æ³¨å†Œä¸Šå»äº†</p><h5 id="ï¼ˆgateway-nacosï¼‰Spring-Cloud-Gatewayæ­å»ºåŠè·¯ç”±é…ç½®"><a href="#ï¼ˆgateway-nacosï¼‰Spring-Cloud-Gatewayæ­å»ºåŠè·¯ç”±é…ç½®" class="headerlink" title="ï¼ˆgateway-&gt;nacosï¼‰Spring Cloud Gatewayæ­å»ºåŠè·¯ç”±é…ç½®"></a>ï¼ˆgateway-&gt;nacosï¼‰Spring Cloud Gatewayæ­å»ºåŠè·¯ç”±é…ç½®</h5><p><code>pom.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.minio<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>minio<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-bootstrap<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-loadbalancer<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>bootstrap.yaml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">jc-club-gateway-dev</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">117.72</span><span class="number">.14</span><span class="number">.166</span><span class="string">:8848</span></span><br><span class="line">        <span class="attr">prefix:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">DEFAULT_GROUP</span></span><br><span class="line">        <span class="attr">namespace:</span></span><br><span class="line">        <span class="attr">file-extension:</span> <span class="string">yaml</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">117.72</span><span class="number">.14</span><span class="number">.166</span><span class="string">:8848</span></span><br></pre></td></tr></table></figure><p><code>application.yaml</code>ï¼Œç”¨äºè·¯ç”±è½¬å‘</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">5000</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">oss</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://jc-club-oss-dev</span> <span class="string">//ä½¿ç”¨</span> <span class="string">lb://</span> <span class="string">å‰ç¼€è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨çš„è°ƒç”¨ã€‚jc-club-oss-dev</span> <span class="string">æ˜¯æœåŠ¡åï¼ŒSpring</span> <span class="string">Cloud</span> <span class="string">Gateway</span> <span class="string">å°†é€šè¿‡æœåŠ¡å‘ç°æ‰¾åˆ°å¯¹åº”çš„å®ä¾‹ã€‚</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/oss/**</span> <span class="string">//è·¯ç”±åŒ¹é…æ¡ä»¶</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">StripPrefix=1</span> <span class="string">//è¿‡æ»¤å™¨ç”¨äºä»è¯·æ±‚è·¯å¾„ä¸­å»é™¤å‰ç¼€ã€‚</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">auth</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://jc-club-auth-dev</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/auth/**</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">StripPrefix=1</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">subject</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://jc-club-subject-dev</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/subject/**</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">StripPrefix=1</span></span><br></pre></td></tr></table></figure><p>è¿è¡ŒåŠæ³¨å†Œåˆ°nacosä¸­ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç½‘å…³è¿›è¡Œè·¯ç”±è½¬å‘åˆ°å¯¹åº”çš„å¾®æœåŠ¡ä¸Šã€‚</p><h5 id="é‰´æƒ-åˆ·é¢˜-nacos"><a href="#é‰´æƒ-åˆ·é¢˜-nacos" class="headerlink" title="é‰´æƒ+åˆ·é¢˜-&gt;nacos"></a>é‰´æƒ+åˆ·é¢˜-&gt;nacos</h5><p><strong>auth:</strong></p><p><code>starter/pom.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-auth-infra<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-auth-application-controller<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-bootstrap<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>bootstrap.yaml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">jc-club-gateway-dev</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">117.72</span><span class="number">.14</span><span class="number">.166</span><span class="string">:8848</span></span><br><span class="line">        <span class="attr">prefix:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">DEFAULT_GROUP</span></span><br><span class="line">        <span class="attr">namespace:</span></span><br><span class="line">        <span class="attr">file-extension:</span> <span class="string">yaml</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">117.72</span><span class="number">.14</span><span class="number">.166</span><span class="string">:8848</span></span><br></pre></td></tr></table></figure><p><strong>subjectï¼š</strong></p><p><code>starter/pom.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-application-controller<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-application-mq<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-infra<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-bootstrap<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>bootstrap.yaml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">jc-club-subject-dev</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">117.72</span><span class="number">.14</span><span class="number">.166</span><span class="string">:8848</span></span><br><span class="line">        <span class="attr">prefix:</span> <span class="string">$&#123;spring.application.name&#125;</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">DEFAULT_GROUP</span></span><br><span class="line">        <span class="attr">namespace:</span></span><br><span class="line">        <span class="attr">file-extension:</span> <span class="string">yaml</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="number">117.72</span><span class="number">.14</span><span class="number">.166</span><span class="string">:8848</span></span><br></pre></td></tr></table></figure><h4 id="Sa-Tokené›†æˆRedis"><a href="#Sa-Tokené›†æˆRedis" class="headerlink" title="Sa-Tokené›†æˆRedis"></a>Sa-Tokené›†æˆRedis</h4><p><a href="https://sa-token.cc/doc.html#/up/integ-redis">é›†æˆ Redis (sa-token.cc)</a></p><p><a href="https://sa-token.cc/doc.html#/up/integ-redis">redis.io&#x2F;docs&#x2F;management&#x2F;config</a></p><h4 id="gatewayç½‘å…³ï¼ˆsa-tokenï¼‰åŸºäºrediså®ç°åˆ†å¸ƒå¼ä¼šè¯é‰´æƒ"><a href="#gatewayç½‘å…³ï¼ˆsa-tokenï¼‰åŸºäºrediså®ç°åˆ†å¸ƒå¼ä¼šè¯é‰´æƒ" class="headerlink" title="gatewayç½‘å…³ï¼ˆsa-tokenï¼‰åŸºäºrediså®ç°åˆ†å¸ƒå¼ä¼šè¯é‰´æƒ"></a>gatewayç½‘å…³ï¼ˆsa-tokenï¼‰åŸºäºrediså®ç°åˆ†å¸ƒå¼ä¼šè¯é‰´æƒ</h4><p><strong>gateway é›†æˆ redis åŠ refactor é‰´æƒ</strong></p><p><strong>pomæ–‡ä»¶å†™å…¥</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- çœç•¥äº†ä¹‹å‰çš„éƒ¨åˆ†ï¼Œä¸‹é¢çš„æ˜¯æ–°å¢çš„ --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- Sa-Token æƒé™è®¤è¯ï¼ˆReactorå“åº”å¼é›†æˆï¼‰, åœ¨çº¿æ–‡æ¡£ï¼šhttps://sa-token.cc --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.dev33<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>sa-token-reactor-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.37.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Sa-Token æ•´åˆ Redis ï¼ˆä½¿ç”¨ jackson åºåˆ—åŒ–æ–¹å¼ï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.dev33<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>sa-token-redis-jackson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.37.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-pool2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.code.gson<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>gson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.8.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>gatewayçš„<code>applicaiton.yaml</code>,ä¿®æ”¹ç½‘å…³é…ç½®æ–‡ä»¶</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">5000</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">oss</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://jc-club-oss-dev</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/oss/**</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">StripPrefix=1</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">auth</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://jc-club-auth-dev</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/auth/**</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">StripPrefix=1</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">subject</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://jc-club-subject-dev</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/subject/**</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">StripPrefix=1</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">practice</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://jc-club-practice-dev</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/practice/**</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">StripPrefix=1</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">circle</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://jc-club-circle</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/circle/**</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">StripPrefix=1</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">interview</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://jc-club-interview</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/interview/**</span></span><br><span class="line">          <span class="attr">filters:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">StripPrefix=1</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="comment"># Redisæ•°æ®åº“ç´¢å¼•ï¼ˆé»˜è®¤ä¸º0ï¼‰</span></span><br><span class="line">    <span class="attr">database:</span> <span class="number">1</span></span><br><span class="line">    <span class="comment"># RedisæœåŠ¡å™¨åœ°å€</span></span><br><span class="line">    <span class="attr">host:</span> <span class="number">117.72</span><span class="number">.14</span><span class="number">.166</span></span><br><span class="line">    <span class="comment"># RedisæœåŠ¡å™¨è¿æ¥ç«¯å£</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">6379</span></span><br><span class="line">    <span class="comment"># RedisæœåŠ¡å™¨è¿æ¥å¯†ç ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">jichi1234</span></span><br><span class="line">    <span class="comment"># è¿æ¥è¶…æ—¶æ—¶é—´</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="string">2s</span></span><br><span class="line">    <span class="attr">lettuce:</span></span><br><span class="line">      <span class="attr">pool:</span></span><br><span class="line">        <span class="comment"># è¿æ¥æ± æœ€å¤§è¿æ¥æ•°</span></span><br><span class="line">        <span class="attr">max-active:</span> <span class="number">200</span></span><br><span class="line">        <span class="comment"># è¿æ¥æ± æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰</span></span><br><span class="line">        <span class="attr">max-wait:</span> <span class="string">-1ms</span></span><br><span class="line">        <span class="comment"># è¿æ¥æ± ä¸­çš„æœ€å¤§ç©ºé—²è¿æ¥</span></span><br><span class="line">        <span class="attr">max-idle:</span> <span class="number">10</span></span><br><span class="line">        <span class="comment"># è¿æ¥æ± ä¸­çš„æœ€å°ç©ºé—²è¿æ¥</span></span><br><span class="line">        <span class="attr">min-idle:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">sa-token:</span></span><br><span class="line">  <span class="comment"># token åç§°ï¼ˆåŒæ—¶ä¹Ÿæ˜¯ cookie åç§°ï¼‰</span></span><br><span class="line">  <span class="attr">token-name:</span> <span class="string">satoken</span></span><br><span class="line">  <span class="comment"># token æœ‰æ•ˆæœŸï¼ˆå•ä½ï¼šç§’ï¼‰ é»˜è®¤30å¤©ï¼Œ-1 ä»£è¡¨æ°¸ä¹…æœ‰æ•ˆ</span></span><br><span class="line">  <span class="attr">timeout:</span> <span class="number">2592000</span></span><br><span class="line">  <span class="comment"># token æœ€ä½æ´»è·ƒé¢‘ç‡ï¼ˆå•ä½ï¼šç§’ï¼‰ï¼Œå¦‚æœ token è¶…è¿‡æ­¤æ—¶é—´æ²¡æœ‰è®¿é—®ç³»ç»Ÿå°±ä¼šè¢«å†»ç»“ï¼Œé»˜è®¤-1 ä»£è¡¨ä¸é™åˆ¶ï¼Œæ°¸ä¸å†»ç»“</span></span><br><span class="line">  <span class="attr">active-timeout:</span> <span class="number">-1</span></span><br><span class="line">  <span class="comment"># æ˜¯å¦å…è®¸åŒä¸€è´¦å·å¤šåœ°åŒæ—¶ç™»å½• ï¼ˆä¸º true æ—¶å…è®¸ä¸€èµ·ç™»å½•, ä¸º false æ—¶æ–°ç™»å½•æŒ¤æ‰æ—§ç™»å½•ï¼‰</span></span><br><span class="line">  <span class="attr">is-concurrent:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># åœ¨å¤šäººç™»å½•åŒä¸€è´¦å·æ—¶ï¼Œæ˜¯å¦å…±ç”¨ä¸€ä¸ª token ï¼ˆä¸º true æ—¶æ‰€æœ‰ç™»å½•å…±ç”¨ä¸€ä¸ª token, ä¸º false æ—¶æ¯æ¬¡ç™»å½•æ–°å»ºä¸€ä¸ª tokenï¼‰</span></span><br><span class="line">  <span class="attr">is-share:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># token é£æ ¼ï¼ˆé»˜è®¤å¯å–å€¼ï¼šuuidã€simple-uuidã€random-32ã€random-64ã€random-128ã€tikï¼‰</span></span><br><span class="line">  <span class="attr">token-style:</span> <span class="string">random-32</span></span><br><span class="line">  <span class="comment"># æ˜¯å¦è¾“å‡ºæ“ä½œæ—¥å¿—</span></span><br><span class="line">  <span class="attr">is-log:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">token-prefix:</span> <span class="string">jichi</span></span><br></pre></td></tr></table></figure><p><code>jc-club-auth-starter/application.yaml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"> <span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">3011</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">qvQP7MBvSkbyGzLzlRaPp9swmOmkqdVkVgBNPQF7pMlImathGYopQcWR2CuZMZAkL1xrDHwut9Hbr2TZ4qmr2Q==</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://117.72.14.166:3306/jc-club?serverTimezone=Asia/Shanghai&amp;useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=false</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span></span><br><span class="line">    <span class="attr">druid:</span></span><br><span class="line">      <span class="attr">initial-size:</span> <span class="number">20</span></span><br><span class="line">      <span class="attr">min-idle:</span> <span class="number">20</span></span><br><span class="line">      <span class="attr">connectionProperties:</span> <span class="string">config.decrypt=true;config.decrypt.key=$&#123;publicKey&#125;;</span></span><br><span class="line">      <span class="attr">max-active:</span> <span class="number">100</span></span><br><span class="line">      <span class="attr">max-wait:</span> <span class="number">60000</span></span><br><span class="line">      <span class="attr">stat-view-servlet:</span></span><br><span class="line">        <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">url-pattern:</span> <span class="string">/druid/*</span></span><br><span class="line">        <span class="attr">login-username:</span> <span class="string">admin</span></span><br><span class="line">        <span class="attr">login-password:</span> <span class="number">123456</span></span><br><span class="line">      <span class="attr">filter:</span></span><br><span class="line">        <span class="attr">stat:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">slow-sql-millis:</span> <span class="number">2000</span></span><br><span class="line">          <span class="attr">log-slow-sql:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">wall:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">config:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="comment"># Redisæ•°æ®åº“ç´¢å¼•ï¼ˆé»˜è®¤ä¸º0ï¼‰</span></span><br><span class="line">    <span class="attr">database:</span> <span class="number">1</span></span><br><span class="line">    <span class="comment"># RedisæœåŠ¡å™¨åœ°å€</span></span><br><span class="line">    <span class="attr">host:</span> <span class="number">117.72</span><span class="number">.14</span><span class="number">.166</span></span><br><span class="line">    <span class="comment"># RedisæœåŠ¡å™¨è¿æ¥ç«¯å£</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">6379</span></span><br><span class="line">    <span class="comment"># RedisæœåŠ¡å™¨è¿æ¥å¯†ç ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">jichi1234</span></span><br><span class="line">    <span class="comment"># è¿æ¥è¶…æ—¶æ—¶é—´</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="string">2s</span></span><br><span class="line">    <span class="attr">lettuce:</span> <span class="comment">#lettuceè¿æ¥æ± </span></span><br><span class="line">      <span class="attr">pool:</span></span><br><span class="line">        <span class="comment"># è¿æ¥æ± æœ€å¤§è¿æ¥æ•°</span></span><br><span class="line">        <span class="attr">max-active:</span> <span class="number">200</span></span><br><span class="line">        <span class="comment"># è¿æ¥æ± æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰</span></span><br><span class="line">        <span class="attr">max-wait:</span> <span class="string">-1ms</span></span><br><span class="line">        <span class="comment"># è¿æ¥æ± ä¸­çš„æœ€å¤§ç©ºé—²è¿æ¥</span></span><br><span class="line">        <span class="attr">max-idle:</span> <span class="number">10</span></span><br><span class="line">        <span class="comment"># è¿æ¥æ± ä¸­çš„æœ€å°ç©ºé—²è¿æ¥</span></span><br><span class="line">        <span class="attr">min-idle:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">publicKey:</span> <span class="string">MFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAMJzo9TiSuOGAMR2Zma25lWdtR1oxq6RcZYnWE9vcYLNKxUOkBlvSfMrbS25KtlJi+hIzikfCoyTDB0VI5gB3Q8CAwEAAQ==</span></span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">config:</span> <span class="string">classpath:log4j2-spring.xml</span></span><br><span class="line"><span class="attr">sa-token:</span></span><br><span class="line">  <span class="comment"># token åç§°ï¼ˆåŒæ—¶ä¹Ÿæ˜¯ cookie åç§°ï¼‰</span></span><br><span class="line">  <span class="attr">token-name:</span> <span class="string">satoken</span></span><br><span class="line">  <span class="comment"># token æœ‰æ•ˆæœŸï¼ˆå•ä½ï¼šç§’ï¼‰ é»˜è®¤30å¤©ï¼Œ-1 ä»£è¡¨æ°¸ä¹…æœ‰æ•ˆ</span></span><br><span class="line">  <span class="attr">timeout:</span> <span class="number">2592000</span></span><br><span class="line">  <span class="comment"># token æœ€ä½æ´»è·ƒé¢‘ç‡ï¼ˆå•ä½ï¼šç§’ï¼‰ï¼Œå¦‚æœ token è¶…è¿‡æ­¤æ—¶é—´æ²¡æœ‰è®¿é—®ç³»ç»Ÿå°±ä¼šè¢«å†»ç»“ï¼Œé»˜è®¤-1 ä»£è¡¨ä¸é™åˆ¶ï¼Œæ°¸ä¸å†»ç»“</span></span><br><span class="line">  <span class="attr">active-timeout:</span> <span class="number">-1</span></span><br><span class="line">  <span class="comment"># æ˜¯å¦å…è®¸åŒä¸€è´¦å·å¤šåœ°åŒæ—¶ç™»å½• ï¼ˆä¸º true æ—¶å…è®¸ä¸€èµ·ç™»å½•, ä¸º false æ—¶æ–°ç™»å½•æŒ¤æ‰æ—§ç™»å½•ï¼‰</span></span><br><span class="line">  <span class="attr">is-concurrent:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># åœ¨å¤šäººç™»å½•åŒä¸€è´¦å·æ—¶ï¼Œæ˜¯å¦å…±ç”¨ä¸€ä¸ª token ï¼ˆä¸º true æ—¶æ‰€æœ‰ç™»å½•å…±ç”¨ä¸€ä¸ª token, ä¸º false æ—¶æ¯æ¬¡ç™»å½•æ–°å»ºä¸€ä¸ª tokenï¼‰</span></span><br><span class="line">  <span class="attr">is-share:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># token é£æ ¼ï¼ˆé»˜è®¤å¯å–å€¼ï¼šuuidã€simple-uuidã€random-32ã€random-64ã€random-128ã€tikï¼‰</span></span><br><span class="line">  <span class="attr">token-style:</span> <span class="string">random-32</span></span><br><span class="line">  <span class="comment"># æ˜¯å¦è¾“å‡ºæ“ä½œæ—¥å¿—</span></span><br><span class="line">  <span class="attr">is-log:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">token-prefix:</span> <span class="string">jichi</span></span><br></pre></td></tr></table></figure><p><strong>ç½‘å…³è‡ªå®šä¹‰æƒé™æ¥å£æ‰©å±•</strong> </p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StpInterfaceImpl</span> <span class="keyword">implements</span> <span class="title class_">StpInterface</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RedisUtil redisUtil;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">authPermissionPrefix</span> <span class="operator">=</span> <span class="string">&quot;auth.permission&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">authRolePrefix</span> <span class="operator">=</span> <span class="string">&quot;auth.role&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getPermissionList</span><span class="params">(Object loginId, String loginType)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getAuth(loginId.toString(), authPermissionPrefix);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getRoleList</span><span class="params">(Object loginId, String loginType)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getAuth(loginId.toString(), authRolePrefix);</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p><code>jc-club-gateway:SaTokenConfigure</code>ï¼Œsatokené…ç½®ã€‚</p><p>è¿™ä¸ªé…ç½®ç±»çš„ä¸»è¦ä½œç”¨æ˜¯ï¼š</p><ul><li>æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ã€‚</li><li>æ ¹æ®è¯·æ±‚çš„è·¯å¾„ï¼Œæ‰§è¡Œä¸åŒçš„æƒé™æ ¡éªŒé€»è¾‘ï¼Œç¡®ä¿åªæœ‰å…·æœ‰ç›¸åº”æƒé™çš„ç”¨æˆ·æ‰èƒ½è®¿é—®ç‰¹å®šçš„èµ„æºã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SaTokenConfigure</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> SaReactorFilter <span class="title function_">getSaReactorFilter</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">SaReactorFilter</span>()</span><br><span class="line">                <span class="comment">// æ‹¦æˆªåœ°å€</span></span><br><span class="line">                .addInclude(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">                <span class="comment">// é‰´æƒæ–¹æ³•ï¼šæ¯æ¬¡è®¿é—®è¿›å…¥</span></span><br><span class="line">                .setAuth(obj -&gt; &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;-------- å‰ç«¯è®¿é—®pathï¼š&quot;</span> + SaHolder.getRequest().getRequestPath());</span><br><span class="line">                    <span class="comment">// ç™»å½•æ ¡éªŒ -- æ‹¦æˆªæ‰€æœ‰è·¯ç”±ï¼Œå¹¶æ’é™¤/user/doLogin ç”¨äºå¼€æ”¾ç™»å½•</span></span><br><span class="line">                    SaRouter.match(<span class="string">&quot;/auth/**&quot;</span>, <span class="string">&quot;/auth/user/doLogin&quot;</span>, r -&gt; StpUtil.checkRole(<span class="string">&quot;admin&quot;</span>));</span><br><span class="line">                    SaRouter.match(<span class="string">&quot;/oss/**&quot;</span>, r -&gt; StpUtil.checkLogin());</span><br><span class="line">                    SaRouter.match(<span class="string">&quot;/subject/subject/add&quot;</span>, r -&gt; StpUtil.checkPermission(<span class="string">&quot;subject:add&quot;</span>));</span><br><span class="line">                    SaRouter.match(<span class="string">&quot;/subject/**&quot;</span>, r -&gt; StpUtil.checkLogin());</span><br><span class="line">                &#125;)</span><br><span class="line">                ;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç½‘å…³å…¨å±€å¼‚å¸¸å¤„ç†ï¼ˆsa-token-monoï¼‰"><a href="#ç½‘å…³å…¨å±€å¼‚å¸¸å¤„ç†ï¼ˆsa-token-monoï¼‰" class="headerlink" title="ç½‘å…³å…¨å±€å¼‚å¸¸å¤„ç†ï¼ˆsa-token monoï¼‰"></a>ç½‘å…³å…¨å±€å¼‚å¸¸å¤„ç†ï¼ˆsa-token monoï¼‰</h4><p>Sa-token æä¾›çš„ç¤ºä¾‹ï¼Œé€‚ç”¨äºå•ä½“é¡¹ç›®çš„å…¨å±€å¼‚å¸¸æ•è·ã€‚æˆ‘ä»¬é€‰æ‹©äº†å¾®æœåŠ¡æ¶æ„ï¼Œåˆ™å°±è¦å˜ä¸ºé€šè¿‡ç½‘å…³æ¥è¿›è¡Œå…¨å±€å¼‚å¸¸çš„å¤„ç†ï¼Œæˆ‘ä»¬å¸Œæœ›ï¼Œæƒé™å‘ç”Ÿå¼‚å¸¸çš„æ—¶å€™ï¼Œå¯ä»¥ç»Ÿä¸€åš 401 çš„è¿”å›ï¼Œå‰ç«¯è¿›è¡Œè·³è½¬ç™»å½•ã€‚</p><p><img src="https://s2.loli.net/2024/08/06/FqMnKyZGQum9sSr.png" alt="image-20240729142433511.png"></p><p><code>GatewayExceptionHandler.java</code></p><p>è¿™ä¸ªå…¨å±€å¼‚å¸¸å¤„ç†å™¨çš„ä¸»è¦ä½œç”¨æ˜¯ï¼š</p><ul><li>æ•è·å¹¶å¤„ç†ç½‘å…³ä¸­çš„å¼‚å¸¸ã€‚</li><li>æ ¹æ®å¼‚å¸¸ç±»å‹è¿”å›ä¸åŒçš„çŠ¶æ€ç å’Œæ¶ˆæ¯ã€‚</li><li>å°†å¼‚å¸¸ä¿¡æ¯åºåˆ—åŒ–ä¸º JSON æ ¼å¼ï¼Œå¹¶è®¾ç½®æ­£ç¡®çš„ <code>Content-Type</code> å‘é€å›å®¢æˆ·ç«¯ã€‚</li></ul><p><a href="https://blog.csdn.net/aofengdaxia/article/details/129265983?ops_request_misc=%7B%22request_id%22:%22172223483416800182161820%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172223483416800182161820&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-129265983-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=ErrorWebExceptionHandler&spm=1018.2226.3001.4187">æ·±å…¥å­¦ä¹ ErrorWebExceptionHandler-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/crazymakercircle/article/details/124120506?ops_request_misc=%7B%22request_id%22:%22172223509816800186538079%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172223509816800186538079&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-124120506-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=mono&spm=1018.2226.3001.4187">Fluxã€Monoã€Reactor å®æˆ˜ï¼ˆå²ä¸Šæœ€å…¨ï¼‰_reactor mono-CSDNåšå®¢</a></p><p>[å“åº”å¼ç¼–ç¨‹äºŒMonoï¼ŒFluxç®€å•ä»‹ç»_flux mono-CSDNåšå®¢](<a href="https://blog.csdn.net/lsdstone/article/details/134983206?ops_request_misc=&request_id=&biz_id=102&utm_term=mono">https://blog.csdn.net/lsdstone/article/details/134983206?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=mono</a> javaå“åº”å¼&amp;utm_medium&#x3D;distribute.pc_search_result.none-task-blog-2<del>all</del>sobaiduweb~default-2-134983206.142^v100^pc_search_result_base8&amp;spm&#x3D;1018.2226.3001.4187)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GatewayExceptionHandler</span> <span class="keyword">implements</span> <span class="title class_">ErrorWebExceptionHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>(); <span class="comment">//åˆ›å»ºäº†ä¸€ä¸ªObjectMapperå®ä¾‹ï¼Œç”¨äºå°†Javaå¯¹è±¡è½¬æ¢ä¸ºJSONæ ¼å¼ã€‚</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;Void&gt; <span class="title function_">handle</span><span class="params">(ServerWebExchange serverWebExchange, Throwable throwable)</span> &#123; <span class="comment">//å¤„ç†å¼‚å¸¸çš„æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªMono&lt;Void&gt;ç±»å‹ï¼Œè¡¨ç¤ºå¼‚æ­¥æ“ä½œçš„å®Œæˆã€‚</span></span><br><span class="line">        <span class="type">ServerHttpRequest</span> <span class="variable">request</span> <span class="operator">=</span> serverWebExchange.getRequest();</span><br><span class="line">        <span class="type">ServerHttpResponse</span> <span class="variable">response</span> <span class="operator">=</span> serverWebExchange.getResponse();</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">code</span> <span class="operator">=</span> <span class="number">200</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span> (throwable <span class="keyword">instanceof</span> SaTokenException) &#123;</span><br><span class="line">            code = <span class="number">401</span>;</span><br><span class="line">            message = <span class="string">&quot;ç”¨æˆ·æ— æƒé™&quot;</span>;</span><br><span class="line">            throwable.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            code = <span class="number">500</span>;</span><br><span class="line">            message = <span class="string">&quot;ç³»ç»Ÿç¹å¿™&quot;</span>;</span><br><span class="line">            throwable.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> Result.fail(code, message);</span><br><span class="line">        response.getHeaders().setContentType(MediaType.APPLICATION_JSON);</span><br><span class="line">        <span class="keyword">return</span> response.writeWith(Mono.fromSupplier(() -&gt; &#123;</span><br><span class="line">            <span class="comment">/*ä½¿ç”¨response.writeWithæ–¹æ³•ï¼Œç»“åˆMono.fromSupplieræ¥å¼‚æ­¥å†™å…¥å“åº”ä½“ã€‚</span></span><br><span class="line"><span class="comment">åœ¨Mono.fromSupplierä¸­ï¼š</span></span><br><span class="line"><span class="comment">ä½¿ç”¨objectMapper.writeValueAsBytes(result)å°†Resultå¯¹è±¡åºåˆ—åŒ–ä¸ºJSONæ ¼å¼çš„å­—èŠ‚æ•°ç»„ã€‚</span></span><br><span class="line"><span class="comment">ä½¿ç”¨DataBufferFactory.wrap(bytes)å°†å­—èŠ‚æ•°ç»„åŒ…è£…æˆæ•°æ®ç¼“å†²åŒºï¼Œä»¥ä¾¿å†™å…¥å“åº”ä½“*/</span></span><br><span class="line">            <span class="type">DataBufferFactory</span> <span class="variable">dataBufferFactory</span> <span class="operator">=</span> response.bufferFactory();</span><br><span class="line">            <span class="type">byte</span>[] bytes = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                bytes = objectMapper.writeValueAsBytes(result); <span class="comment">//jsonæ ¼å¼å­—èŠ‚æ•°ç»„</span></span><br><span class="line">            &#125; <span class="keyword">catch</span> (JsonProcessingException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> dataBufferFactory.wrap(bytes); <span class="comment">//åŒ…è£…æˆæ•°æ®ç¼“å†²åŒº</span></span><br><span class="line">        &#125;));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ResultCodeEnum.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">ResultCodeEnum</span> &#123;</span><br><span class="line"></span><br><span class="line">    SUCCESS(<span class="number">200</span>,<span class="string">&quot;æˆåŠŸ&quot;</span>),</span><br><span class="line">    FAIL(<span class="number">500</span>,<span class="string">&quot;å¤±è´¥&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> code;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String desc;</span><br><span class="line"></span><br><span class="line">    ResultCodeEnum(<span class="type">int</span> code, String desc)&#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">        <span class="built_in">this</span>.desc = desc;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ResultCodeEnum <span class="title function_">getByCode</span><span class="params">(<span class="type">int</span> codeVal)</span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(ResultCodeEnum resultCodeEnum : ResultCodeEnum.values())&#123;</span><br><span class="line">            <span class="keyword">if</span>(resultCodeEnum.code == codeVal)&#123;</span><br><span class="line">                <span class="keyword">return</span> resultCodeEnum;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Result.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Result</span>&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Boolean success;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer code;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> T data;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title function_">ok</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Result</span>();</span><br><span class="line">        result.setSuccess(<span class="literal">true</span>);</span><br><span class="line">        result.setCode(ResultCodeEnum.SUCCESS.getCode());</span><br><span class="line">        result.setMessage(ResultCodeEnum.SUCCESS.getDesc());</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result <span class="title function_">ok</span><span class="params">(T data)</span> &#123;</span><br><span class="line">        <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Result</span>();</span><br><span class="line">        result.setSuccess(<span class="literal">true</span>);</span><br><span class="line">        result.setCode(ResultCodeEnum.SUCCESS.getCode());</span><br><span class="line">        result.setMessage(ResultCodeEnum.SUCCESS.getDesc());</span><br><span class="line">        result.setData(data);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title function_">fail</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Result</span>();</span><br><span class="line">        result.setSuccess(<span class="literal">false</span>);</span><br><span class="line">        result.setCode(ResultCodeEnum.FAIL.getCode());</span><br><span class="line">        result.setMessage(ResultCodeEnum.FAIL.getDesc());</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Result <span class="title function_">fail</span><span class="params">(T data)</span> &#123;</span><br><span class="line">        <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Result</span>();</span><br><span class="line">        result.setSuccess(<span class="literal">false</span>);</span><br><span class="line">        result.setCode(ResultCodeEnum.FAIL.getCode());</span><br><span class="line">        result.setMessage(ResultCodeEnum.FAIL.getDesc());</span><br><span class="line">        result.setData(data);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Result <span class="title function_">fail</span><span class="params">(Integer code,String message)</span> &#123;</span><br><span class="line">        <span class="type">Result</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Result</span>();</span><br><span class="line">        result.setSuccess(<span class="literal">false</span>);</span><br><span class="line">        result.setCode(code);</span><br><span class="line">        result.setMessage(message);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="gatewayå®ç°redisæƒé™æ•°æ®æ‹‰å–-gateway"><a href="#gatewayå®ç°redisæƒé™æ•°æ®æ‹‰å–-gateway" class="headerlink" title="gatewayå®ç°redisæƒé™æ•°æ®æ‹‰å–(gateway)"></a>gatewayå®ç°redisæƒé™æ•°æ®æ‹‰å–(gateway)</h4><p><strong>RedisTemplate-&gt;RedisConfig(é‡å†™åºåˆ—åŒ–ï¼Œ@Beanåˆ›å»ºRedisTemplate bean)-&gt;RedisUtil(å°è£…å¯¹redisçš„æ“ä½œï¼Œå…·ä½“æ˜¯ç”¨redistemplateæ¥æ“ä½œçš„)</strong></p><p>ä¸ºä»€ä¹ˆé‡å†™redistemplate?</p><ul><li>è¿™é‡Œä¸é‡æ–°ä»–çš„ä¸€ä¸ªåºåˆ—åŒ–ä¼šé€ æˆä¸€ä¸ªä¹±ç çš„é—®é¢˜ï¼Œé‡å†™äº†RedisTemplate:<ul><li>objectMapper-&gt;Jackson2jsonRedisSerializer-&gt;redisTemplateï¼Œæ³¨æ„@Beanæ³¨å…¥</li></ul></li></ul><p>ç½‘å…³è¯»å–æƒé™å†…å®¹æœ‰ä¸‰ç§å½¢å¼ã€‚</p><p>1ã€ç½‘å…³å±‚ç›´æ¥ä¸æ•°æ®åº“äº¤äº’</p><p>2ã€ç½‘å…³å±‚ä¸ redis è¿›è¡Œäº¤äº’</p><p>3ã€ç½‘å…³å±‚ä¸ redis è¿›è¡Œäº¤äº’ï¼Œredis æ²¡æœ‰ï¼Œåˆ™é€šè¿‡ feign è°ƒç”¨ auth æœåŠ¡è·å–ã€‚</p><p>é€‰æ‹©ç¬¬äºŒç§å½¢å¼ï¼Œå®Œå…¨ä¿¡ä»»ç¼“å­˜ï¼ŒåŒæ—¶å¼•å‡ºæ•°æ®åº“ä¸ç¼“å­˜æ•°æ®ä¸€è‡´æ€§çš„æ–¹æ¡ˆã€‚</p><p><code>pom.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.google.code.gson<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>gson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.8.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è‡ªå®šä¹‰è·å–æƒé™æ”¹ä¸ºä» redis:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.club.gateway.auth;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.dev33.satoken.stp.StpInterface;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.cloud.commons.lang.StringUtils;</span><br><span class="line"><span class="keyword">import</span> com.google.gson.Gson;</span><br><span class="line"><span class="keyword">import</span> com.google.gson.reflect.TypeToken;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.club.gateway.entity.AuthPermission;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.club.gateway.entity.AuthRole;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.club.gateway.redis.RedisUtil;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"><span class="keyword">import</span> java.util.LinkedList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StpInterfaceImpl</span> <span class="keyword">implements</span> <span class="title class_">StpInterface</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RedisUtil redisUtil;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">authPermissionPrefix</span> <span class="operator">=</span> <span class="string">&quot;auth.permission&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">authRolePrefix</span> <span class="operator">=</span> <span class="string">&quot;auth.role&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getPermissionList</span><span class="params">(Object loginId, String loginType)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getAuth(loginId.toString(), authPermissionPrefix);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getRoleList</span><span class="params">(Object loginId, String loginType)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getAuth(loginId.toString(), authRolePrefix);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; <span class="title function_">getAuth</span><span class="params">(String loginId, String prefix)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">authKey</span> <span class="operator">=</span> redisUtil.buildKey(prefix, loginId.toString());</span><br><span class="line">        <span class="type">String</span> <span class="variable">authValue</span> <span class="operator">=</span> redisUtil.get(authKey);</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isBlank(authValue)) &#123; <span class="comment">//è‹¥ç©ºè¿”å›ç©º</span></span><br><span class="line">            <span class="keyword">return</span> Collections.emptyList();</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;String&gt; authList = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span> (authRolePrefix.equals(prefix)) &#123;</span><br><span class="line">            List&lt;AuthRole&gt; roleList = <span class="keyword">new</span> <span class="title class_">Gson</span>().fromJson(authValue, <span class="keyword">new</span> <span class="title class_">TypeToken</span>&lt;List&lt;AuthRole&gt;&gt;() &#123;</span><br><span class="line">            &#125;.getType());</span><br><span class="line">            authList = roleList.stream().map(AuthRole::getRoleKey).collect(Collectors.toList());</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (authPermissionPrefix.equals(prefix)) &#123;</span><br><span class="line">            List&lt;AuthPermission&gt; permissionList = <span class="keyword">new</span> <span class="title class_">Gson</span>().fromJson(authValue, <span class="keyword">new</span> <span class="title class_">TypeToken</span>&lt;List&lt;AuthPermission&gt;&gt;() &#123;</span><br><span class="line">            &#125;.getType());</span><br><span class="line">            authList = permissionList.stream().map(AuthPermission::getPermissionKey).collect(Collectors.toList());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> authList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>RedisTemplate é‡å†™ä¼˜åŒ–ï¼šåŸç”Ÿ redis çš„ template çš„åºåˆ—åŒ–å™¨ä¼šäº§ç”Ÿä¹±ç é—®é¢˜ï¼Œé‡å†™æ”¹ä¸º jacksonã€‚</p><p><a href="https://blog.csdn.net/qq_42623400/article/details/115791984?ops_request_misc=%7B%22request_id%22:%22172225253916800225574987%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=172225253916800225574987&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-115791984-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=redistemplate%E5%92%8Cjackson&spm=1018.2226.3001.4187">Spring date-redisä¸­RedisTemplateçš„Jacksonåºåˆ—åŒ–è®¾ç½®_redistemplateåºåˆ—åŒ–æ—¶dateå¸¦æœ‰ç±»å‹ä¿¡æ¯-CSDNåšå®¢</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.club.gateway.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonAutoDetect;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonTypeInfo;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.PropertyAccessor;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.DeserializationFeature;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.connection.RedisConnectionFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.serializer.RedisSerializer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.serializer.StringRedisSerializer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisConfig</span> &#123;</span><br><span class="line">   <span class="comment">/*æ€»ç»“æ¥è¯´ï¼Œé€šè¿‡åœ¨RedisConfigç±»ä¸­ä½¿ç”¨@Beanæ³¨è§£å®šä¹‰redisTemplateæ–¹æ³•ï¼ŒSpringå®¹å™¨ä¼šåœ¨å¯åŠ¨æ—¶åˆ›å»ºå¹¶æ³¨å†Œè¿™ä¸ªRedisTemplate Beanã€‚ä¹‹åï¼Œåº”ç”¨ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†å¯ä»¥é€šè¿‡@Autowiredæˆ–@Resourceæ³¨è§£æ¥è‡ªåŠ¨è·å–å¹¶ä½¿ç”¨è¿™ä¸ªBeanã€‚*/</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RedisTemplate&lt;String,Object&gt; <span class="title function_">redisTemplate</span><span class="params">(RedisConnectionFactory redisConnectionFactory)</span>&#123;</span><br><span class="line">        RedisTemplate&lt;String,Object&gt; redisTemplate = <span class="keyword">new</span> <span class="title class_">RedisTemplate</span>&lt;&gt;();</span><br><span class="line">        RedisSerializer&lt;String&gt; redisSerializer = <span class="keyword">new</span> <span class="title class_">StringRedisSerializer</span>();</span><br><span class="line">        redisTemplate.setConnectionFactory(redisConnectionFactory);</span><br><span class="line">        redisTemplate.setKeySerializer(redisSerializer);</span><br><span class="line">        redisTemplate.setHashKeySerializer(redisSerializer);</span><br><span class="line">        redisTemplate.setValueSerializer(jackson2JsonRedisSerializer());</span><br><span class="line">        redisTemplate.setHashValueSerializer(jackson2JsonRedisSerializer());</span><br><span class="line">        <span class="keyword">return</span> redisTemplate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Jackson2JsonRedisSerializer&lt;Object&gt; <span class="title function_">jackson2JsonRedisSerializer</span><span class="params">()</span>&#123;</span><br><span class="line">        Jackson2JsonRedisSerializer&lt;Object&gt; jsonRedisSerializer = <span class="keyword">new</span> <span class="title class_">Jackson2JsonRedisSerializer</span>&lt;&gt;(Object.class); </span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        objectMapper.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY); <span class="comment">//è®¾ç½® ObjectMapper çš„è®¿é—®çº§åˆ«ï¼Œä½¿å…¶èƒ½å¤Ÿåºåˆ—åŒ–æ‰€æœ‰å­—æ®µï¼Œæ— è®ºå®ƒä»¬æ˜¯å¦æœ‰ public è®¿é—®æƒé™ã€‚</span></span><br><span class="line">        objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES,<span class="literal">false</span>);</span><br><span class="line">        objectMapper.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL, JsonTypeInfo.As.PROPERTY);</span><br><span class="line">        jsonRedisSerializer.setObjectMapper(objectMapper); <span class="comment">//å°†é…ç½®å¥½çš„ ObjectMapper è®¾ç½®åˆ° Jackson2JsonRedisSerializer ä¸­ã€‚</span></span><br><span class="line">        <span class="keyword">return</span> jsonRedisSerializer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>RedisUtil çš„å°è£…</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.club.gateway.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Stream;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * RedisUtilå·¥å…·ç±»</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: ChickenWing</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2023/1/15</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RedisUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate; <span class="comment">//é€šè¿‡DIæ‹¿åˆ°è¢«RedisConfigæ”¹åçš„RedisTemplate</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">CACHE_KEY_SEPARATOR</span> <span class="operator">=</span> <span class="string">&quot;.&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ„å»ºç¼“å­˜key</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">buildKey</span><span class="params">(String... strObjs)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Stream.of(strObjs).collect(Collectors.joining(CACHE_KEY_SEPARATOR));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦å­˜åœ¨key</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">exist</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.hasKey(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤key</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">del</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.delete(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(String key, String value)</span> &#123;</span><br><span class="line">        redisTemplate.opsForValue().set(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">setNx</span><span class="params">(String key, String value, Long time, TimeUnit timeUnit)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForValue().setIfAbsent(key, value, time, timeUnit);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">get</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (String) redisTemplate.opsForValue().get(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">zAdd</span><span class="params">(String key, String value, Long score)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForZSet().add(key, value, Double.valueOf(String.valueOf(score)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">countZset</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForZSet().size(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">rangeZset</span><span class="params">(String key, <span class="type">long</span> start, <span class="type">long</span> end)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForZSet().range(key, start, end);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">removeZset</span><span class="params">(String key, Object value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForZSet().remove(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeZsetList</span><span class="params">(String key, Set&lt;String&gt; value)</span> &#123;</span><br><span class="line">        value.stream().forEach((val) -&gt; redisTemplate.opsForZSet().remove(key, val));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Double <span class="title function_">score</span><span class="params">(String key, Object value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForZSet().score(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Set&lt;String&gt; <span class="title function_">rangeByScore</span><span class="params">(String key, <span class="type">long</span> start, <span class="type">long</span> end)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForZSet().rangeByScore(key, Double.valueOf(String.valueOf(start)), Double.valueOf(String.valueOf(end)));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">addScore</span><span class="params">(String key, Object obj, <span class="type">double</span> score)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForZSet().incrementScore(key, obj, score);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">rank</span><span class="params">(String key, Object obj)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForZSet().rank(key, obj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç”¨æˆ·æ¨¡å—å¼€å‘-auth-user"><a href="#ç”¨æˆ·æ¨¡å—å¼€å‘-auth-user" class="headerlink" title="ç”¨æˆ·æ¨¡å—å¼€å‘(auth_user)"></a>ç”¨æˆ·æ¨¡å—å¼€å‘(auth_user)</h4><p>ä¾ç„¶æœ‰ä»DTO-&gt;BO-&gt;entityçš„converterï¼Œæ­¤éƒ¨åˆ†å¿½ç•¥æ‰æè¿°</p><h5 id="controlleråŒ…"><a href="#controlleråŒ…" class="headerlink" title="controlleråŒ…"></a>controlleråŒ…</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user/&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> AuthUserDomainService authUserDomainService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·æ³¨å†Œ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;register&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">register</span><span class="params">(<span class="meta">@RequestBody</span> AuthUserDTO authUserDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;UserController.register.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(authUserDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            checkUserInfo(authUserDTO);</span><br><span class="line">            <span class="type">AuthUserBO</span> <span class="variable">authUserBO</span> <span class="operator">=</span> AuthUserDTOConverter.INSTANCE.convertDTOToBO(authUserDTO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(authUserDomainService.register(authUserBO));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;UserController.register.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æ³¨å†Œç”¨æˆ·å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;update&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> AuthUserDTO authUserDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;UserController.update.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(authUserDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            checkUserInfo(authUserDTO);</span><br><span class="line">            <span class="type">AuthUserBO</span> <span class="variable">authUserBO</span> <span class="operator">=</span> AuthUserDTOConverter.INSTANCE.convertDTOToBO(authUserDTO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(authUserDomainService.update(authUserBO));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;UserController.update.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æ›´æ–°ç”¨æˆ·ä¿¡æ¯å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;getUserInfo&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;AuthUserDTO&gt; <span class="title function_">getUserInfo</span><span class="params">(<span class="meta">@RequestBody</span> AuthUserDTO authUserDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;UserController.getUserInfo.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(authUserDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkArgument(!StringUtils.isBlank(authUserDTO.getUserName()), <span class="string">&quot;ç”¨æˆ·åä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="type">AuthUserBO</span> <span class="variable">authUserBO</span> <span class="operator">=</span> AuthUserDTOConverter.INSTANCE.convertDTOToBO(authUserDTO);</span><br><span class="line">            <span class="type">AuthUserBO</span> <span class="variable">userInfo</span> <span class="operator">=</span> authUserDomainService.getUserInfo(authUserBO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(AuthUserDTOConverter.INSTANCE.convertBOToDTO(userInfo));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;UserController.update.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æ›´æ–°ç”¨æˆ·ä¿¡æ¯å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰¹é‡è·å–ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;listByIds&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;List&lt;AuthUserDTO&gt;&gt; <span class="title function_">listUserInfoByIds</span><span class="params">(<span class="meta">@RequestBody</span> List&lt;String&gt; userNameList)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;UserController.listUserInfoByIds.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(userNameList));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkArgument(!CollectionUtils.isEmpty(userNameList), <span class="string">&quot;idé›†åˆä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            List&lt;AuthUserBO&gt; userInfos = authUserDomainService.listUserInfoByIds(userNameList);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(AuthUserDTOConverter.INSTANCE.convertBOToDTO(userInfos));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;UserController.listUserInfoByIds.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æ‰¹é‡è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·é€€å‡º</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;logOut&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result <span class="title function_">logOut</span><span class="params">(<span class="meta">@RequestParam</span> String userName)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            log.info(<span class="string">&quot;UserController.logOut.userName:&#123;&#125;&quot;</span>, userName);</span><br><span class="line">            Preconditions.checkArgument(!StringUtils.isBlank(userName), <span class="string">&quot;ç”¨æˆ·åä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            StpUtil.logout(userName);</span><br><span class="line">            <span class="keyword">return</span> Result.ok();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;UserController.logOut.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;ç”¨æˆ·ç™»å‡ºå¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤ç”¨æˆ·</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;delete&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">delete</span><span class="params">(<span class="meta">@RequestBody</span> AuthUserDTO authUserDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;UserController.delete.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(authUserDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">AuthUserBO</span> <span class="variable">authUserBO</span> <span class="operator">=</span> AuthUserDTOConverter.INSTANCE.convertDTOToBO(authUserDTO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(authUserDomainService.update(authUserBO));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;UserController.update.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;åˆ é™¤ç”¨æˆ·ä¿¡æ¯å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">checkUserInfo</span><span class="params">(<span class="meta">@RequestBody</span> AuthUserDTO authUserDTO)</span> &#123;</span><br><span class="line">        Preconditions.checkArgument(!StringUtils.isBlank(authUserDTO.getUserName()), <span class="string">&quot;ç”¨æˆ·åä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·å¯ç”¨/ç¦ç”¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;changeStatus&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">changeStatus</span><span class="params">(<span class="meta">@RequestBody</span> AuthUserDTO authUserDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;UserController.changeStatus.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(authUserDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkNotNull(authUserDTO.getStatus(), <span class="string">&quot;ç”¨æˆ·çŠ¶æ€ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="type">AuthUserBO</span> <span class="variable">authUserBO</span> <span class="operator">=</span> AuthUserDTOConverter.INSTANCE.convertDTOToBO(authUserDTO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(authUserDomainService.update(authUserBO));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;UserController.changeStatus.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;å¯ç”¨/ç¦ç”¨ç”¨æˆ·ä¿¡æ¯å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;doLogin&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;SaTokenInfo&gt; <span class="title function_">doLogin</span><span class="params">(<span class="meta">@RequestParam(&quot;validCode&quot;)</span> String validCode)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Preconditions.checkArgument(!StringUtils.isBlank(validCode), <span class="string">&quot;éªŒè¯ç ä¸èƒ½ä¸ºç©º!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(authUserDomainService.doLogin(validCode));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;UserController.doLogin.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;ç”¨æˆ·ç™»å½•å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æŸ¥è¯¢ç™»å½•çŠ¶æ€ï¼Œæµè§ˆå™¨è®¿é—®ï¼š http://localhost:8081/user/isLogin</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;isLogin&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">isLogin</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;å½“å‰ä¼šè¯æ˜¯å¦ç™»å½•ï¼š&quot;</span> + StpUtil.isLogin();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="domainåŒ…"><a href="#domainåŒ…" class="headerlink" title="domainåŒ…"></a>domainåŒ…</h5><p><code>AuthUserDomainServiceImpl.javaï¼ˆç”¨æˆ·æ³¨å†Œã€æ›´æ–°ã€åˆ é™¤ã€ç™»å½•å’Œä¿¡æ¯æŸ¥è¯¢ï¼Œredisï¼‰</code></p><ol><li>èµ„æºæ³¨å…¥</li></ol><ul><li><code>@Resource</code>ï¼šç”¨äºè‡ªåŠ¨æ³¨å…¥Springç®¡ç†çš„Beanï¼Œå¦‚å„ç§æœåŠ¡ï¼ˆ<code>Service</code>ï¼‰å’Œ<code>RedisUtil</code>ã€‚</li></ul><ol start="2"><li>æˆå‘˜å˜é‡</li></ol><ul><li>å®šä¹‰äº†ç”¨äºæ„å»ºRedisé”®çš„å‰ç¼€ã€ç›å€¼ï¼ˆ<code>salt</code>ï¼‰ã€ç™»å½•éªŒè¯ç å‰ç¼€ï¼ˆ<code>LOGIN_PREFIX</code>ï¼‰ã€‚</li></ul><ol start="3"><li>æ³¨å†Œæ–¹æ³•</li></ol><ul><li><code>@Override</code>ï¼šè¦†ç›–æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ã€‚</li><li><code>@SneakyThrows</code>ï¼šä½¿ç”¨Lombokæ³¨è§£æ¥éšè—æŠ›å‡ºçš„å¼‚å¸¸ã€‚</li><li><code>@Transactional</code>ï¼šå£°æ˜äº‹åŠ¡æ”¯æŒï¼ŒæŒ‡å®šå¼‚å¸¸å›æ»šã€‚</li><li><code>public Boolean register(AuthUserBO authUserBO)</code>ï¼šæ³¨å†Œç”¨æˆ·çš„æ–¹æ³•ã€‚</li></ul><ol start="4"><li>æ³¨å†Œé€»è¾‘</li></ol><ul><li>æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨ã€‚</li><li>å¯†ç åŠ å¯†å­˜å‚¨ã€‚ï¼ˆmd5+saltï¼‰</li><li>è®¾ç½®é»˜è®¤å¤´åƒå’Œæ˜µç§°ã€‚</li><li>æ’å…¥ç”¨æˆ·æ•°æ®åˆ°æ•°æ®åº“ã€‚</li><li>å»ºç«‹ç”¨æˆ·ä¸è§’è‰²çš„å…³è”ã€‚</li><li>å°†è§’è‰²å’Œæƒé™ä¿¡æ¯å­˜å‚¨åˆ°Redisã€‚</li></ul><ol start="5"><li>æ›´æ–°å’Œåˆ é™¤æ–¹æ³•</li></ol><ul><li><code>public Boolean update(AuthUserBO authUserBO)</code>ï¼šæ›´æ–°ç”¨æˆ·ä¿¡æ¯çš„æ–¹æ³•ã€‚</li><li><code>public Boolean delete(AuthUserBO authUserBO)</code>ï¼šé€»è¾‘åˆ é™¤ç”¨æˆ·çš„æ–¹æ³•ï¼ŒåŒæ—¶æ›´æ–°Redisä¸­çš„ç¼“å­˜ã€‚</li></ul><ol start="6"><li>ç™»å½•å’Œè·å–ç”¨æˆ·ä¿¡æ¯æ–¹æ³•</li></ol><ul><li><code>public SaTokenInfo doLogin(String validCode)</code>ï¼šå¤„ç†ç”¨æˆ·ç™»å½•çš„æ–¹æ³•ï¼Œä½¿ç”¨<code>Sa-Token</code>è¿›è¡Œè®¤è¯ã€‚</li><li><code>public AuthUserBO getUserInfo(AuthUserBO authUserBO)</code>ï¼šæ ¹æ®ç”¨æˆ·åè·å–ç”¨æˆ·ä¿¡æ¯çš„æ–¹æ³•ã€‚</li></ul><ol start="7"><li>æ‰¹é‡è·å–ç”¨æˆ·ä¿¡æ¯æ–¹æ³•</li></ol><ul><li><code>public List&lt;AuthUserBO&gt; listUserInfoByIds(List&lt;String&gt; userNameList)</code>ï¼šæ ¹æ®ç”¨æˆ·IDåˆ—è¡¨æ‰¹é‡è·å–ç”¨æˆ·ä¿¡æ¯çš„æ–¹æ³•ã€‚</li></ul><ol start="8"><li>äº‹åŠ¡å’Œå¼‚å¸¸å¤„ç†</li></ol><ul><li>æ³¨å†Œã€æ›´æ–°å’Œåˆ é™¤æ–¹æ³•ä½¿ç”¨<code>@Transactional</code>æ³¨è§£ï¼Œç¡®ä¿æ“ä½œçš„åŸå­æ€§ã€‚</li><li>ä½¿ç”¨<code>@SneakyThrows</code>æ¥å¤„ç†å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸ï¼Œé¿å…æ˜¾å¼å£°æ˜å¼‚å¸¸ã€‚</li></ul><ol start="9"><li>æ—¥å¿—è®°å½•</li></ol><ul><li><code>log</code>å˜é‡ç”¨äºè®°å½•æ—¥å¿—ä¿¡æ¯ã€‚</li></ul><ol start="10"><li>ç¼“å­˜æ“ä½œ</li></ol><ul><li>ä½¿ç”¨<code>RedisUtil</code>è¿›è¡ŒRedisçš„è¯»å†™æ“ä½œï¼Œå¦‚å­˜å‚¨ç”¨æˆ·çš„è§’è‰²å’Œæƒé™ä¿¡æ¯ã€‚</li></ul><ol start="11"><li>å¯†ç å®‰å…¨</li></ol><ul><li>ä½¿ç”¨<code>SaSecureUtil.md5BySalt</code>æ–¹æ³•å¯¹ç”¨æˆ·å¯†ç è¿›è¡ŒMD5åŠ ç›åŠ å¯†ã€‚</li></ul><ol start="12"><li>é»˜è®¤èµ„æº</li></ol><ul><li>ä¸ºæ–°ç”¨æˆ·è®¾ç½®äº†é»˜è®¤çš„å¤´åƒå’Œæ˜µç§°ã€‚</li></ul><ol start="13"><li>æœåŠ¡äº¤äº’</li></ol><ul><li>é€šè¿‡è°ƒç”¨<code>AuthUserService</code>ã€<code>AuthUserRoleService</code>ç­‰çš„æ–¹æ³•ï¼Œå®ç°ä¸šåŠ¡é€»è¾‘ã€‚</li></ul><p>è¿™ä¸ª<code>AuthUserDomainServiceImpl</code>ç±»é€šè¿‡å®ç°<code>AuthUserDomainService</code>æ¥å£ï¼Œæä¾›äº†ç”¨æˆ·æ³¨å†Œã€æ›´æ–°ã€åˆ é™¤ã€ç™»å½•å’Œä¿¡æ¯æŸ¥è¯¢ç­‰æœåŠ¡ï¼ŒåŒæ—¶ä¸Redisç¼“å­˜è¿›è¡Œäº¤äº’ï¼Œä»¥æé«˜ç³»ç»Ÿçš„å“åº”é€Ÿåº¦å’Œæ€§èƒ½ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthUserDomainServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AuthUserDomainService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> AuthUserService authUserService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> AuthUserRoleService authUserRoleService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> AuthPermissionService authPermissionService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> AuthRolePermissionService authRolePermissionService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> AuthRoleService authRoleService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">salt</span> <span class="operator">=</span> <span class="string">&quot;chicken&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RedisUtil redisUtil;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">authPermissionPrefix</span> <span class="operator">=</span> <span class="string">&quot;auth.permission&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">authRolePrefix</span> <span class="operator">=</span> <span class="string">&quot;auth.role&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">LOGIN_PREFIX</span> <span class="operator">=</span> <span class="string">&quot;loginCode&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@SneakyThrows</span></span><br><span class="line">    <span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">register</span><span class="params">(AuthUserBO authUserBO)</span> &#123;</span><br><span class="line">        <span class="comment">//æ ¡éªŒç”¨æˆ·æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">        <span class="type">AuthUser</span> <span class="variable">existAuthUser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthUser</span>();</span><br><span class="line">        existAuthUser.setUserName(authUserBO.getUserName());</span><br><span class="line">        List&lt;AuthUser&gt; existUser = authUserService.queryByCondition(existAuthUser);</span><br><span class="line">        <span class="keyword">if</span> (existUser.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">AuthUser</span> <span class="variable">authUser</span> <span class="operator">=</span> AuthUserBOConverter.INSTANCE.convertBOToEntity(authUserBO);</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(authUser.getPassword())) &#123;</span><br><span class="line">            authUser.setPassword(SaSecureUtil.md5BySalt(authUser.getPassword(), salt));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isBlank(authUser.getAvatar())) &#123;</span><br><span class="line">            authUser.setAvatar(<span class="string">&quot;http://117.72.10.84:9000/user/icon/å¾®ä¿¡å›¾ç‰‡_20231203153718(1).png&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isBlank(authUser.getNickName())) &#123;</span><br><span class="line">            authUser.setNickName(<span class="string">&quot;lzrj&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        authUser.setStatus(AuthUserStatusEnum.OPEN.getCode());</span><br><span class="line">        authUser.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> authUserService.insert(authUser);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å»ºç«‹ä¸€ä¸ªåˆæ­¥çš„è§’è‰²çš„å…³è”</span></span><br><span class="line">        <span class="type">AuthRole</span> <span class="variable">authRole</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthRole</span>();</span><br><span class="line">        authRole.setRoleKey(AuthConstant.NORMAL_USER);</span><br><span class="line">        <span class="type">AuthRole</span> <span class="variable">roleResult</span> <span class="operator">=</span> authRoleService.queryByCondition(authRole);</span><br><span class="line">        <span class="type">Long</span> <span class="variable">roleId</span> <span class="operator">=</span> roleResult.getId();</span><br><span class="line">        <span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> authUser.getId();</span><br><span class="line">        <span class="type">AuthUserRole</span> <span class="variable">authUserRole</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthUserRole</span>();</span><br><span class="line">        authUserRole.setUserId(userId);</span><br><span class="line">        authUserRole.setRoleId(roleId);</span><br><span class="line">        authUserRole.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">        authUserRoleService.insert(authUserRole);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">roleKey</span> <span class="operator">=</span> redisUtil.buildKey(authRolePrefix, authUser.getUserName());</span><br><span class="line">        List&lt;AuthRole&gt; roleList = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        roleList.add(authRole);</span><br><span class="line">        redisUtil.set(roleKey, <span class="keyword">new</span> <span class="title class_">Gson</span>().toJson(roleList));</span><br><span class="line"></span><br><span class="line">        <span class="type">AuthRolePermission</span> <span class="variable">authRolePermission</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthRolePermission</span>();</span><br><span class="line">        authRolePermission.setRoleId(roleId);</span><br><span class="line">        List&lt;AuthRolePermission&gt; rolePermissionList = authRolePermissionService.</span><br><span class="line">                queryByCondition(authRolePermission);</span><br><span class="line"></span><br><span class="line">        List&lt;Long&gt; permissionIdList = rolePermissionList.stream()</span><br><span class="line">                .map(AuthRolePermission::getPermissionId).collect(Collectors.toList());</span><br><span class="line">        <span class="comment">//æ ¹æ®roleIdæŸ¥æƒé™</span></span><br><span class="line">        List&lt;AuthPermission&gt; permissionList = authPermissionService.queryByRoleList(permissionIdList);</span><br><span class="line">        <span class="type">String</span> <span class="variable">permissionKey</span> <span class="operator">=</span> redisUtil.buildKey(authPermissionPrefix, authUser.getUserName());</span><br><span class="line">        redisUtil.set(permissionKey, <span class="keyword">new</span> <span class="title class_">Gson</span>().toJson(permissionList));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> count &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">update</span><span class="params">(AuthUserBO authUserBO)</span> &#123;</span><br><span class="line">        <span class="type">AuthUser</span> <span class="variable">authUser</span> <span class="operator">=</span> AuthUserBOConverter.INSTANCE.convertBOToEntity(authUserBO);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> authUserService.updateByUserName(authUser);</span><br><span class="line">        <span class="keyword">return</span> count &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">delete</span><span class="params">(AuthUserBO authUserBO)</span> &#123;</span><br><span class="line">        <span class="type">AuthUser</span> <span class="variable">authUser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthUser</span>();</span><br><span class="line">        authUser.setId(authUserBO.getId());</span><br><span class="line">        authUser.setIsDeleted(IsDeletedFlagEnum.DELETED.getCode());</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> authUserService.update(authUser);</span><br><span class="line">        <span class="comment">//æœ‰ä»»ä½•çš„æ›´æ–°ï¼Œéƒ½è¦ä¸ç¼“å­˜è¿›è¡ŒåŒæ­¥çš„ä¿®æ”¹</span></span><br><span class="line">        <span class="keyword">return</span> count &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> SaTokenInfo <span class="title function_">doLogin</span><span class="params">(String validCode)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">loginKey</span> <span class="operator">=</span> redisUtil.buildKey(LOGIN_PREFIX, validCode);</span><br><span class="line">        <span class="type">String</span> <span class="variable">openId</span> <span class="operator">=</span> redisUtil.get(loginKey);</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isBlank(openId)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">AuthUserBO</span> <span class="variable">authUserBO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthUserBO</span>();</span><br><span class="line">        authUserBO.setUserName(openId);</span><br><span class="line">        <span class="built_in">this</span>.register(authUserBO);</span><br><span class="line">        StpUtil.login(openId);</span><br><span class="line">        <span class="type">SaTokenInfo</span> <span class="variable">tokenInfo</span> <span class="operator">=</span> StpUtil.getTokenInfo();</span><br><span class="line">        <span class="keyword">return</span> tokenInfo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> AuthUserBO <span class="title function_">getUserInfo</span><span class="params">(AuthUserBO authUserBO)</span> &#123;</span><br><span class="line">        <span class="type">AuthUser</span> <span class="variable">authUser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthUser</span>();</span><br><span class="line">        authUser.setUserName(authUserBO.getUserName());</span><br><span class="line">        List&lt;AuthUser&gt; userList = authUserService.queryByCondition(authUser);</span><br><span class="line">        <span class="keyword">if</span> (CollectionUtils.isEmpty(userList)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AuthUserBO</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">AuthUser</span> <span class="variable">user</span> <span class="operator">=</span> userList.get(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> AuthUserBOConverter.INSTANCE.convertEntityToBO(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;AuthUserBO&gt; <span class="title function_">listUserInfoByIds</span><span class="params">(List&lt;String&gt; userNameList)</span> &#123;</span><br><span class="line">        List&lt;AuthUser&gt; userList = authUserService.listUserInfoByIds(userNameList);</span><br><span class="line">        <span class="keyword">if</span> (CollectionUtils.isEmpty(userList)) &#123;</span><br><span class="line">            <span class="keyword">return</span> Collections.emptyList();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> AuthUserBOConverter.INSTANCE.convertEntityToBO(userList);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="infraå±‚"><a href="#infraå±‚" class="headerlink" title="infraå±‚"></a>infraå±‚</h5><p><img src="https://s2.loli.net/2024/07/28/ERumTNky47Z1xAK.jpg" alt="4aaca7492044e3e4d3c9d55c9b05c39.jpg"></p><p>å¯¹è¿™äº”å¼ è¡¨çš„å¢åˆ æŸ¥æ”¹</p><h5 id="å¸¸è§åŠ å¯†-å¯†ç åŠ å¯†"><a href="#å¸¸è§åŠ å¯†-å¯†ç åŠ å¯†" class="headerlink" title="å¸¸è§åŠ å¯†&amp;å¯†ç åŠ å¯†"></a>å¸¸è§åŠ å¯†&amp;å¯†ç åŠ å¯†</h5><p><strong>å‰è¨€</strong></p><p>æ•°æ®åº“å¦‚æœè¯´å­˜å‚¨æ˜æ–‡çš„å¯†ç æ˜¯éå¸¸çš„å±é™©çš„ï¼Œä¸€æ—¦è¢«æ”»å‡»å•Šï¼Œæˆ–è€…æ•°æ®æ³„æ¼ï¼Œç”¨æˆ·çš„ä¿¡æ¯ç–¯ç‹‚çš„æš´éœ²å‡ºå»ï¼Œé»‘å®¢ä»€ä¹ˆéƒ½èƒ½å¹²ï¼Œè¿™æ˜¯éå¸¸ä¸è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åšåŠ å¯†ï¼Œè®©é»‘å®¢å³ä½¿æ‹¿åˆ°äº†å¯†ç ä¿¡æ¯ï¼Œ ä¹Ÿä¸çŸ¥é“åŸå§‹çš„å¯†ç ï¼Œå°±ç™»å½•ä¸æˆåŠŸã€‚</p><p><strong>åŠ å¯†çš„æ–¹å¼</strong></p><ol><li><p>æ‘˜è¦åŠ å¯†</p><p>md5ï¼Œsha1ï¼Œsha256</p><p>æ‘˜è¦ä¸»è¦å°±æ˜¯å“ˆå¸Œå€¼ï¼Œé€šè¿‡æˆ‘ä»¬çš„æ•£åˆ—çš„ç®—æ³•ã€‚æ‘˜è¦çš„æ¦‚å¿µä¸»è¦æ˜¯éªŒè¯å®Œæ•´æ€§å’Œå”¯ä¸€æ€§ï¼Œä¸ç®¡æˆ‘ä»¬çš„å¯†ç æ˜¯å¤šé•¿å•Šï¼Œæˆ–è€…å¤šå¤æ‚çš„å•Šï¼Œå¾—åˆ°çš„å€¼éƒ½æ˜¯å›ºå®šé•¿åº¦ã€‚</p><p>æ‘˜è¦åŠ å¯†æœ‰ä¸€å®šçš„é£é™©ã€‚123456 ç”¨ md5 åŠ å¯†ã€‚ä»–å…¶å®æ˜¯å›ºå®šçš„ï¼Œå¤§å®¶ä¹Ÿå¯ä»¥åˆ°ä¸€äº›ç½‘ç«™æœ‰åè§£å¯†ã€‚</p></li><li><p>å¯¹ç§°åŠ å¯†</p><p>æˆ‘ä»¬çº¦å®šäº†ä¸€ä¸ªå¯†é’¥ã€‚è¿™ä¸ªå¯†é’¥ä¸€å®šè¦å¥½å¥½ä¿å­˜ï¼Œä¸èƒ½æ³„æ¼ï¼Œä¸€æ—¦æ³„æ¼å°±å¯ä»¥è¿›è¡Œæƒ³ä½ æƒ³çš„è§£å¯†äº†ã€‚</p><p>åŠ å¯†çš„è¿‡ç¨‹ï¼šå¯†ç +å¯†é’¥ ç”Ÿæˆ</p><p>è§£å¯†çš„è¿‡ç¨‹ï¼šå¯†æ–‡+å¯†é’¥ åè§£</p><p>å¯†é’¥ä¸€å®šä¸€å®šè¦åšå¥½å…¶ä¸­çš„ä¿å­˜ã€‚</p><p>å¸¸è§çš„å¯¹ç§°åŠ å¯†çš„ç®—æ³•ï¼šAESï¼ŒDESï¼Œ3DESCï¼ŒSM4</p></li><li><p>éå¯¹ç§°åŠ å¯†</p><p>ä¸€ä¸ªå…¬é’¥ï¼Œä¸€ä¸ªç§é’¥ã€‚</p><p>å…¬é’¥å»åŠ å¯†ï¼Œç§é’¥å»è§£å¯†ã€‚</p><p>ç§é’¥å»åŠ å¯†ï¼Œå…¬é’¥å»è§£å¯†ã€‚</p><p>å¸¸è§çš„ç®—æ³•ï¼šRSAï¼ŒECCï¼Œå›½å¯†çš„ SM2</p><p>ç®—æ³•çš„æ—¶æ€§èƒ½ä¸Šï¼Œå·®ä¸€ç‚¹ï¼ŒåŠ å¯†çš„æ•°é‡æ²¡æœ‰å¯¹ç§°åŠ å¯†å¿«ã€‚</p></li></ol><p><strong>åŠ ç›ï¼Ÿæ˜¯åšé¥­å—ï¼Ÿ</strong></p><p>æ‘˜è¦ç®—æ³•æ¯”å¦‚ md5ï¼Œå…‰åŠ å¯† 123456ï¼Œç»“æœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœæ˜¯ç ´è§£çš„åº“é‡Œæ­£å¥½æœ‰è¿™ä¸ª md5 å°±å¾ˆå®¹æ˜“çŸ¥é“é€†å‘æ˜¯ 123456ã€‚æ¥ä¸€æ‰‹åŠ ç›ã€‚ç›æ˜¯éšæœºçš„å­—ç¬¦ä¸²ï¼Œä»–æ¥ä¸åŸå¯†ç è¿›è¡Œä¸€æ³¢äºŒæ¬¡åŠ å¯†ã€‚è¿™æ ·è·å–åˆ°çš„å¾ˆéš¾ç ´è§£å‡ºæ¥ã€‚å¦‚æœä¸åŠ ç›ï¼Œç®€å•å¯†ç å¾ˆå®¹æ˜“æ’åº“çš„ã€‚</p><p><code>AuthUserDomainServiceImpl.java</code>ï¼Œsatoken:md5+saltï¼Œè¿™é‡Œçš„saltæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@SneakyThrows</span></span><br><span class="line"><span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line"><span class="keyword">public</span> Boolean <span class="title function_">register</span><span class="params">(AuthUserBO authUserBO)</span> &#123;</span><br><span class="line">    <span class="comment">//æ ¡éªŒç”¨æˆ·æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">    <span class="type">AuthUser</span> <span class="variable">existAuthUser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthUser</span>();</span><br><span class="line">    existAuthUser.setUserName(authUserBO.getUserName());</span><br><span class="line">    List&lt;AuthUser&gt; existUser = authUserService.queryByCondition(existAuthUser);</span><br><span class="line">    <span class="keyword">if</span> (existUser.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">AuthUser</span> <span class="variable">authUser</span> <span class="operator">=</span> AuthUserBOConverter.INSTANCE.convertBOToEntity(authUserBO);</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isNotBlank(authUser.getPassword())) &#123;</span><br><span class="line">        authUser.setPassword(SaSecureUtil.md5BySalt(authUser.getPassword(), salt)); <span class="comment">//satoken:md5+saltï¼Œè¿™é‡Œçš„saltæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(authUser.getAvatar())) &#123;</span><br><span class="line">        authUser.setAvatar(<span class="string">&quot;http://117.72.10.84:9000/user/icon/å¾®ä¿¡å›¾ç‰‡_20231203153718(1).png&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">   ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è§’è‰²æ¨¡å—å¼€å‘-auth-role"><a href="#è§’è‰²æ¨¡å—å¼€å‘-auth-role" class="headerlink" title="è§’è‰²æ¨¡å—å¼€å‘(auth_role)"></a>è§’è‰²æ¨¡å—å¼€å‘(auth_role)</h4><h5 id="controller"><a href="#controller" class="headerlink" title="controller"></a>controller</h5><p><code>RolePermissionController.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.auth.application.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.google.common.base.Preconditions;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.auth.application.convert.AuthRolePermissionDTOConverter;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.auth.application.dto.AuthRolePermissionDTO;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.auth.domain.entity.AuthRolePermissionBO;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.auth.domain.service.AuthRolePermissionDomainService;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.auth.entity.Result;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.CollectionUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è§’è‰²æƒé™controller</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: ChickenWing</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2023/11/2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/rolePermission/&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RolePermissionController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> AuthRolePermissionDomainService authRolePermissionDomainService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢è§’è‰²æƒé™å…³è”å…³ç³»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">add</span><span class="params">(<span class="meta">@RequestBody</span> AuthRolePermissionDTO authRolePermissionDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;RolePermissionController.add.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(authRolePermissionDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkArgument(!CollectionUtils.isEmpty(authRolePermissionDTO.getPermissionIdList()),<span class="string">&quot;æƒé™å…³è”ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            Preconditions.checkNotNull(authRolePermissionDTO.getRoleId(),<span class="string">&quot;è§’è‰²ä¸èƒ½ä¸ºç©º!&quot;</span>);</span><br><span class="line">            <span class="type">AuthRolePermissionBO</span> <span class="variable">rolePermissionBO</span> <span class="operator">=</span> AuthRolePermissionDTOConverter.INSTANCE.convertDTOToBO(authRolePermissionDTO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(authRolePermissionDomainService.add(rolePermissionBO));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;PermissionController.add.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æ–°å¢è§’è‰²æƒé™å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>RoleController.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.auth.application.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.google.common.base.Preconditions;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.auth.application.convert.AuthRoleDTOConverter;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.auth.application.dto.AuthRoleDTO;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.auth.domain.entity.AuthRoleBO;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.auth.domain.service.AuthRoleDomainService;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.auth.entity.Result;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è§’è‰²controller</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: ChickenWing</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2023/11/2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/role/&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RoleController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> AuthRoleDomainService authRoleDomainService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢è§’è‰²</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">add</span><span class="params">(<span class="meta">@RequestBody</span> AuthRoleDTO authRoleDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;RoleController.add.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(authRoleDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkArgument(!StringUtils.isBlank(authRoleDTO.getRoleKey()), <span class="string">&quot;è§’è‰²keyä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            Preconditions.checkArgument(!StringUtils.isBlank(authRoleDTO.getRoleName()), <span class="string">&quot;è§’è‰²åç§°ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="type">AuthRoleBO</span> <span class="variable">authRoleBO</span> <span class="operator">=</span> AuthRoleDTOConverter.INSTANCE.convertDTOToBO(authRoleDTO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(authRoleDomainService.add(authRoleBO));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;UserController.register.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æ–°å¢è§’è‰²å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹è§’è‰²</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;update&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> AuthRoleDTO authRoleDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;RoleController.update.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(authRoleDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkNotNull(authRoleDTO.getId(), <span class="string">&quot;è§’è‰²idä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="type">AuthRoleBO</span> <span class="variable">authRoleBO</span> <span class="operator">=</span> AuthRoleDTOConverter.INSTANCE.convertDTOToBO(authRoleDTO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(authRoleDomainService.update(authRoleBO));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;RoleController.update.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æ›´æ–°è§’è‰²ä¿¡æ¯å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤è§’è‰²</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;delete&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">delete</span><span class="params">(<span class="meta">@RequestBody</span> AuthRoleDTO authRoleDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;RoleController.delete.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(authRoleDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">AuthRoleBO</span> <span class="variable">authRoleBO</span> <span class="operator">=</span> AuthRoleDTOConverter.INSTANCE.convertDTOToBO(authRoleDTO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(authRoleDomainService.delete(authRoleBO));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;RoleController.delete.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;åˆ é™¤è§’è‰²ä¿¡æ¯å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>PermissionController.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.auth.application.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.google.common.base.Preconditions;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.auth.application.convert.AuthPermissionDTOConverter;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.auth.application.dto.AuthPermissionDTO;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.auth.domain.entity.AuthPermissionBO;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.auth.domain.service.AuthPermissionDomainService;</span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.auth.entity.Result;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æƒé™controller</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span>: ChickenWing</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span>: 2023/11/2</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/permission/&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PermissionController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> AuthPermissionDomainService authPermissionDomainService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢æƒé™</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">add</span><span class="params">(<span class="meta">@RequestBody</span> AuthPermissionDTO authPermissionDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;PermissionController.add.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(authPermissionDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkArgument(!StringUtils.isBlank(authPermissionDTO.getName()), <span class="string">&quot;æƒé™åç§°ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            Preconditions.checkNotNull(authPermissionDTO.getParentId(), <span class="string">&quot;æƒé™çˆ¶idä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="type">AuthPermissionBO</span> <span class="variable">permissionBO</span> <span class="operator">=</span> AuthPermissionDTOConverter.INSTANCE.convertDTOToBO(authPermissionDTO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(authPermissionDomainService.add(permissionBO));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;PermissionController.add.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æ–°å¢æƒé™å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹æƒé™</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;update&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> AuthPermissionDTO authPermissionDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;PermissionController.update.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(authPermissionDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkNotNull(authPermissionDTO.getId(), <span class="string">&quot;æƒé™idä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="type">AuthPermissionBO</span> <span class="variable">permissionBO</span> <span class="operator">=</span> AuthPermissionDTOConverter.INSTANCE.convertDTOToBO(authPermissionDTO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(authPermissionDomainService.update(permissionBO));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;PermissionController.update.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æ›´æ–°æƒé™ä¿¡æ¯å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤æƒé™</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;delete&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">delete</span><span class="params">(<span class="meta">@RequestBody</span> AuthPermissionDTO authPermissionDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;PermissionController.delete.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(authPermissionDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkNotNull(authPermissionDTO.getId(), <span class="string">&quot;æƒé™idä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="type">AuthPermissionBO</span> <span class="variable">permissionBO</span> <span class="operator">=</span> AuthPermissionDTOConverter.INSTANCE.convertDTOToBO(authPermissionDTO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(authPermissionDomainService.delete(permissionBO));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;PermissionController.delete.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;åˆ é™¤æƒé™ä¿¡æ¯å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢ç”¨æˆ·æƒé™</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;getPermission&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">getPermission</span><span class="params">(String userName)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            log.info(<span class="string">&quot;PermissionController.getPermission.userName:&#123;&#125;&quot;</span>,userName);</span><br><span class="line">            Preconditions.checkArgument(!StringUtils.isBlank(userName), <span class="string">&quot;ç”¨æˆ·idä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(authPermissionDomainService.getPermission(userName));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;PermissionController.getPermission.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æŸ¥è¯¢ç”¨æˆ·æƒé™ä¿¡æ¯å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="domain"><a href="#domain" class="headerlink" title="domain"></a>domain</h5><p><code>AuthPermissionDomainServiceImpl.java</code>(æƒé™)</p><ol><li>ä¸šåŠ¡æ–¹æ³•å®ç°</li></ol><ul><li><code>@Override</code>ï¼šè¦†ç›–æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ã€‚</li><li><code>public Boolean add(AuthPermissionBO authPermissionBO)</code>ï¼šæ·»åŠ æƒé™çš„æ–¹æ³•ï¼Œå°†ä¸šåŠ¡å¯¹è±¡ï¼ˆBOï¼‰è½¬æ¢ä¸ºå®ä½“å¯¹è±¡ï¼ˆEntityï¼‰ï¼Œè®¾ç½®æœªåˆ é™¤æ ‡å¿—ï¼Œå¹¶æ’å…¥æ•°æ®åº“ã€‚</li><li><code>public Boolean update(AuthPermissionBO authPermissionBO)</code>ï¼šæ›´æ–°æƒé™çš„æ–¹æ³•ï¼Œå°†BOè½¬æ¢ä¸ºEntityï¼Œå¹¶æ›´æ–°æ•°æ®åº“ã€‚</li><li><code>public Boolean delete(AuthPermissionBO authPermissionBO)</code>ï¼šé€»è¾‘åˆ é™¤æƒé™çš„æ–¹æ³•ï¼Œæ›´æ–°åˆ é™¤æ ‡å¿—ã€‚</li></ul><ol start="2"><li>æƒé™è·å–æ–¹æ³•</li></ol><ul><li><pre><code class="java">public List&lt;String&gt; getPermission(String userName)<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  ï¼šæ ¹æ®ç”¨æˆ·åè·å–æƒé™åˆ—è¡¨çš„æ–¹æ³•ã€‚</span><br><span class="line"></span><br><span class="line">  - ä½¿ç”¨`RedisUtil`æ„å»ºæƒé™çš„Redisé”®ã€‚</span><br><span class="line">  - ä»Redisä¸­è·å–æƒé™çš„JSONå­—ç¬¦ä¸²ã€‚</span><br><span class="line">  - å¦‚æœRedisä¸­æ²¡æœ‰æ•°æ®ï¼Œåˆ™è¿”å›ç©ºåˆ—è¡¨ã€‚</span><br><span class="line">  - ä½¿ç”¨Gsonååºåˆ—åŒ–JSONå­—ç¬¦ä¸²ä¸º`AuthPermission`åˆ—è¡¨ã€‚</span><br><span class="line">  - ä»æƒé™åˆ—è¡¨ä¸­æå–æƒé™é”®ï¼ˆPermission Keyï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">3. æ—¥å¿—è®°å½•</span><br><span class="line"></span><br><span class="line">- `log`å˜é‡ç”¨äºè®°å½•æ—¥å¿—ä¿¡æ¯ã€‚</span><br><span class="line"></span><br><span class="line">4. ç¼“å­˜æ“ä½œ</span><br><span class="line"></span><br><span class="line">- ä½¿ç”¨`RedisUtil`è¿›è¡ŒRedisçš„è¯»å†™æ“ä½œï¼Œå¦‚è·å–ç”¨æˆ·æƒé™ä¿¡æ¯ã€‚</span><br><span class="line"></span><br><span class="line">5. æ•°æ®è½¬æ¢</span><br><span class="line"></span><br><span class="line">- ä½¿ç”¨`AuthPermissionBOConverter`å°†ä¸šåŠ¡å¯¹è±¡ï¼ˆBOï¼‰è½¬æ¢ä¸ºæ•°æ®åº“å®ä½“ï¼ˆEntityï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">6. é€»è¾‘åˆ é™¤</span><br><span class="line"></span><br><span class="line">- è®¾ç½®`IsDeletedFlagEnum.UN_DELETED.getCode()`å’Œ`IsDeletedFlagEnum.DELETED.getCode()`æ¥æ ‡è®°è®°å½•çš„åˆ é™¤çŠ¶æ€ã€‚</span><br><span class="line"></span><br><span class="line">è¿™ä¸ª`AuthPermissionDomainServiceImpl`ç±»é€šè¿‡å®ç°`AuthPermissionDomainService`æ¥å£ï¼Œæä¾›äº†æƒé™çš„å¢åˆ æ”¹ä»¥åŠæ ¹æ®ç”¨æˆ·åè·å–æƒé™åˆ—è¡¨çš„æœåŠ¡ã€‚å®ƒåˆ©ç”¨äº†Redisç¼“å­˜æ¥æé«˜è·å–æƒé™åˆ—è¡¨çš„æ€§èƒ½ï¼Œå¹¶é‡‡ç”¨äº†é€»è¾‘åˆ é™¤çš„æ–¹å¼æ¥ç®¡ç†æƒé™æ•°æ®ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥çµæ´»åœ°è¿›è¡Œæƒé™æ§åˆ¶å’ŒéªŒè¯ã€‚</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">@Service</span><br><span class="line">@Slf4j</span><br><span class="line">public class AuthPermissionDomainServiceImpl implements AuthPermissionDomainService &#123;</span><br><span class="line"></span><br><span class="line">    @Resource</span><br><span class="line">    private AuthPermissionService authPermissionService;</span><br><span class="line"></span><br><span class="line">    @Resource</span><br><span class="line">    private RedisUtil redisUtil;</span><br><span class="line"></span><br><span class="line">    private String authPermissionPrefix = &quot;auth.permission&quot;;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Boolean add(AuthPermissionBO authPermissionBO) &#123;</span><br><span class="line">        AuthPermission authPermission = AuthPermissionBOConverter.INSTANCE.convertBOToEntity(authPermissionBO);</span><br><span class="line">        authPermission.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">        Integer count = authPermissionService.insert(authPermission);</span><br><span class="line">        return count &gt; 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Boolean update(AuthPermissionBO authPermissionBO) &#123;</span><br><span class="line">        AuthPermission authPermission = AuthPermissionBOConverter.INSTANCE.convertBOToEntity(authPermissionBO);</span><br><span class="line">        Integer count = authPermissionService.update(authPermission);</span><br><span class="line">        return count &gt; 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Boolean delete(AuthPermissionBO authPermissionBO) &#123;</span><br><span class="line">        AuthPermission authPermission = new AuthPermission();</span><br><span class="line">        authPermission.setId(authPermissionBO.getId());</span><br><span class="line">        authPermission.setIsDeleted(IsDeletedFlagEnum.DELETED.getCode());</span><br><span class="line">        Integer count = authPermissionService.update(authPermission);</span><br><span class="line">        return count &gt; 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public List&lt;String&gt; getPermission(String userName) &#123;</span><br><span class="line">        String permissionKey = redisUtil.buildKey(authPermissionPrefix, userName);</span><br><span class="line">        String permissionValue = redisUtil.get(permissionKey);</span><br><span class="line">        if (StringUtils.isBlank(permissionValue)) &#123;</span><br><span class="line">            return Collections.emptyList();</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;AuthPermission&gt; permissionList = new Gson().fromJson(permissionValue,</span><br><span class="line">                new TypeToken&lt;List&lt;AuthPermission&gt;&gt;() &#123;</span><br><span class="line">                &#125;.getType());</span><br><span class="line">        List&lt;String&gt; authList = permissionList.stream().map(AuthPermission::getPermissionKey).collect(Collectors.toList());</span><br><span class="line">        return authList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></code></pre></li></ul><p><code>AuthRoleDomainServiceImpl</code>ï¼ˆè§’è‰²ï¼‰</p><ol><li>ä¸šåŠ¡æ–¹æ³•å®ç°@Overrideï¼šè¦†ç›–æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ã€‚</li><li>æ·»åŠ è§’è‰²æ–¹æ³•public Boolean add(AuthRoleBO authRoleBO)ï¼š<ul><li>æ·»åŠ è§’è‰²çš„æ–¹æ³•ã€‚<ul><li>ä½¿ç”¨ AuthRoleBOConverter å°†ä¸šåŠ¡å¯¹è±¡ï¼ˆBOï¼‰è½¬æ¢ä¸ºå®ä½“å¯¹è±¡ï¼ˆEntityï¼‰ã€‚</li><li>è®¾ç½®è§’è‰²æœªåˆ é™¤æ ‡å¿—ã€‚</li><li>è°ƒç”¨ authRoleService çš„ insert æ–¹æ³•å°†å®ä½“æ’å…¥æ•°æ®åº“ã€‚</li><li>è¿”å›æ“ä½œå½±å“çš„è¡Œæ•°æ˜¯å¦å¤§äº0ã€‚</li></ul></li></ul></li><li>æ›´æ–°è§’è‰²æ–¹æ³•public Boolean update(AuthRoleBO authRoleBO)ï¼š<ul><li>æ›´æ–°è§’è‰²çš„æ–¹æ³•ã€‚<ul><li>ç±»ä¼¼äºæ·»åŠ æ–¹æ³•ï¼Œä½†è°ƒç”¨ update æ–¹æ³•æ›´æ–°æ•°æ®åº“ä¸­çš„å®ä½“ã€‚</li></ul></li></ul></li><li>åˆ é™¤è§’è‰²æ–¹æ³•public Boolean delete(AuthRoleBO authRoleBO)ï¼š<ul><li>é€»è¾‘åˆ é™¤è§’è‰²çš„æ–¹æ³•ã€‚<ul><li>åˆ›å»ºä¸€ä¸ªæ–°çš„ AuthRole å®ä½“ï¼Œè®¾ç½®IDå’Œé€»è¾‘åˆ é™¤æ ‡å¿—ã€‚</li><li>è°ƒç”¨ authRoleService çš„ update æ–¹æ³•æ›´æ–°æ•°æ®åº“ä¸­çš„å®ä½“ã€‚8.</li></ul></li></ul></li><li>æ—¥å¿—è®°å½•log <ul><li>å˜é‡ç”¨äºè®°å½•æ—¥å¿—ä¿¡æ¯ã€‚</li></ul></li><li>é€»è¾‘åˆ é™¤è®¾ç½® <ul><li>IsDeletedFlagEnum.UN_DELETED.getCode() å’Œ IsDeletedFlagEnum.DELETED.getCode() æ¥æ ‡è®°è®°å½•çš„åˆ é™¤çŠ¶æ€ã€‚</li></ul></li></ol><p>è¿™ä¸ª AuthRoleDomainServiceImpl ç±»é€šè¿‡å®ç° AuthRoleDomainService æ¥å£ï¼Œæä¾›äº†è§’è‰²çš„å¢åˆ æ”¹æœåŠ¡ã€‚å®ƒåˆ©ç”¨äº†é€»è¾‘åˆ é™¤çš„æ–¹å¼æ¥ç®¡ç†è§’è‰²æ•°æ®ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥çµæ´»åœ°è¿›è¡Œè§’è‰²ç®¡ç†å’Œæƒé™åˆ†é…ã€‚æ³¨æ„ï¼Œä»£ç ä¸­æ²¡æœ‰æ˜¾ç¤ºå…·ä½“çš„æ—¥å¿—è¾“å‡ºè¯­å¥ï¼Œä½† @Slf4j æ³¨è§£ä¼šåœ¨ç±»ä¸­æ·»åŠ æ—¥å¿—å˜é‡ï¼Œå¯ä»¥åœ¨æ–¹æ³•ä¸­ä½¿ç”¨ log è¿›è¡Œæ—¥å¿—è®°å½•ã€‚æ­¤å¤–ï¼Œ@SneakyThrows æ³¨è§£æœªåœ¨æ­¤ä»£ç ç‰‡æ®µä¸­ä½¿ç”¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œå®ƒé€šå¸¸ç”¨äºéšè—æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthRoleDomainServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AuthRoleDomainService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> AuthRoleService authRoleService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">add</span><span class="params">(AuthRoleBO authRoleBO)</span> &#123;</span><br><span class="line">        <span class="type">AuthRole</span> <span class="variable">authRole</span> <span class="operator">=</span> AuthRoleBOConverter.INSTANCE.convertBOToEntity(authRoleBO);</span><br><span class="line">        authRole.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> authRoleService.insert(authRole);</span><br><span class="line">        <span class="keyword">return</span> count &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">update</span><span class="params">(AuthRoleBO authRoleBO)</span> &#123;</span><br><span class="line">        <span class="type">AuthRole</span> <span class="variable">authRole</span> <span class="operator">=</span> AuthRoleBOConverter.INSTANCE.convertBOToEntity(authRoleBO);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> authRoleService.update(authRole);</span><br><span class="line">        <span class="keyword">return</span> count &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">delete</span><span class="params">(AuthRoleBO authRoleBO)</span> &#123;</span><br><span class="line">        <span class="type">AuthRole</span> <span class="variable">authRole</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthRole</span>();</span><br><span class="line">        authRole.setId(authRoleBO.getId());</span><br><span class="line">        authRole.setIsDeleted(IsDeletedFlagEnum.DELETED.getCode());</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> authRoleService.update(authRole);</span><br><span class="line">        <span class="keyword">return</span> count &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>AuthRolePermissionDomainServiceImpl.java</code>(è§’è‰²æƒé™å…³è”)</p><p>æ·»åŠ è§’è‰²æƒé™å…³è”æ–¹æ³•</p><ul><li><pre><code>public Boolean add(AuthRolePermissionBO authRolePermissionBO)<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  ï¼šæ·»åŠ è§’è‰²ä¸æƒé™å…³è”çš„æ–¹æ³•ã€‚</span><br><span class="line"></span><br><span class="line">  - é¦–å…ˆåˆ›å»ºä¸€ä¸ª`AuthRolePermission`åˆ—è¡¨ï¼Œç”¨äºå­˜å‚¨å¤šä¸ªè§’è‰²æƒé™å…³è”å¯¹è±¡ã€‚</span><br><span class="line">  - é€šè¿‡`authRolePermissionBO`è·å–è§’è‰²IDã€‚</span><br><span class="line">  - éå†`authRolePermissionBO`ä¸­çš„æƒé™IDåˆ—è¡¨ã€‚</span><br><span class="line">  - å¯¹äºæ¯ä¸ªæƒé™IDï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„`AuthRolePermission`å®ä½“ï¼Œè®¾ç½®è§’è‰²IDã€æƒé™IDå’Œæœªåˆ é™¤æ ‡å¿—ã€‚</span><br><span class="line">  - å°†åˆ›å»ºçš„å®ä½“æ·»åŠ åˆ°åˆ—è¡¨ä¸­ã€‚</span><br><span class="line">  - ä½¿ç”¨`authRolePermissionService`çš„`batchInsert`æ–¹æ³•æ‰¹é‡æ’å…¥å…³è”æ•°æ®åˆ°æ•°æ®åº“ã€‚</span><br><span class="line">  - è¿”å›æ“ä½œå½±å“çš„è¡Œæ•°æ˜¯å¦å¤§äº0ã€‚</span><br><span class="line"></span><br><span class="line">è¿™ä¸ª`AuthRolePermissionDomainServiceImpl`ç±»é€šè¿‡å®ç°`AuthRolePermissionDomainService`æ¥å£ï¼Œæä¾›äº†æ·»åŠ è§’è‰²ä¸æƒé™å…³è”çš„æœåŠ¡ã€‚å®ƒå…è®¸ä¸€ä¸ªè§’è‰²ä¸å¤šä¸ªæƒé™è¿›è¡Œå…³è”ï¼Œé€šè¿‡æ‰¹é‡æ’å…¥çš„æ–¹å¼æé«˜æ•°æ®å­˜å‚¨çš„æ•ˆç‡ã€‚ä½¿ç”¨é€»è¾‘åˆ é™¤æ¥ç®¡ç†è§’è‰²æƒé™å…³è”æ•°æ®ï¼Œä½¿å¾—æ•°æ®ä¸ä¼šä»æ•°æ®åº“ä¸­çœŸæ­£åˆ é™¤ï¼Œä¾¿äºè¿›è¡Œæ•°æ®æ¢å¤æˆ–å®¡è®¡ã€‚æ³¨æ„ï¼Œä»£ç ä¸­æ²¡æœ‰æä¾›åˆ é™¤æˆ–æ›´æ–°è§’è‰²æƒé™å…³è”çš„å®ç°ï¼Œè¿™å¯èƒ½æ˜¯å› ä¸ºè¿™äº›åŠŸèƒ½è¦ä¹ˆä¸éœ€è¦å®ç°ï¼Œè¦ä¹ˆåœ¨å…¶ä»–éƒ¨åˆ†çš„ä»£ç ä¸­å®ç°ã€‚</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">@Service</span><br><span class="line">@Slf4j</span><br><span class="line">public class AuthRolePermissionDomainServiceImpl implements AuthRolePermissionDomainService &#123;</span><br><span class="line"></span><br><span class="line">    @Resource</span><br><span class="line">    private AuthRolePermissionService authRolePermissionService;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Boolean add(AuthRolePermissionBO authRolePermissionBO) &#123;</span><br><span class="line">        List&lt;AuthRolePermission&gt; rolePermissionList = new LinkedList&lt;&gt;();</span><br><span class="line">        Long roleId = authRolePermissionBO.getRoleId();</span><br><span class="line">        authRolePermissionBO.getPermissionIdList().forEach(permissionId -&gt; &#123;</span><br><span class="line">            AuthRolePermission authRolePermission = new AuthRolePermission();</span><br><span class="line">            authRolePermission.setRoleId(roleId);</span><br><span class="line">            authRolePermission.setPermissionId(permissionId);</span><br><span class="line">            authRolePermission.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">            rolePermissionList.add(authRolePermission);</span><br><span class="line">        &#125;);</span><br><span class="line">        int count = authRolePermissionService.batchInsert(rolePermissionList);</span><br><span class="line">        return count &gt; 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></code></pre></li></ul><h5 id="infraå±‚-1"><a href="#infraå±‚-1" class="headerlink" title="infraå±‚"></a>infraå±‚</h5><p><img src="https://s2.loli.net/2024/07/28/ERumTNky47Z1xAK.jpg" alt="4aaca7492044e3e4d3c9d55c9b05c39.jpg"></p><h4 id="ç”¨æˆ·è§’è‰²å…³è”-user-role-è¿™é‡Œä¸»è¦æ˜¯infraå±‚çš„ä¸œè¥¿"><a href="#ç”¨æˆ·è§’è‰²å…³è”-user-role-è¿™é‡Œä¸»è¦æ˜¯infraå±‚çš„ä¸œè¥¿" class="headerlink" title="ç”¨æˆ·è§’è‰²å…³è”(user_role,è¿™é‡Œä¸»è¦æ˜¯infraå±‚çš„ä¸œè¥¿)"></a>ç”¨æˆ·è§’è‰²å…³è”(user_role,è¿™é‡Œä¸»è¦æ˜¯infraå±‚çš„ä¸œè¥¿)</h4><h5 id="controllerï¼ˆUserControllerçš„æ³¨å†Œæ¨¡å—ï¼‰"><a href="#controllerï¼ˆUserControllerçš„æ³¨å†Œæ¨¡å—ï¼‰" class="headerlink" title="controllerï¼ˆUserControllerçš„æ³¨å†Œæ¨¡å—ï¼‰"></a>controllerï¼ˆUserControllerçš„æ³¨å†Œæ¨¡å—ï¼‰</h5><p>å…¶å®å°±æ˜¯UserControllerï¼Œåœ¨è¿›è¡Œregisterç­‰ç›¸å…³æ“ä½œæ—¶ä¼šè¿›è¡Œä¸é»˜è®¤è§’è‰²çš„å…³è”</p><h5 id="domain-1"><a href="#domain-1" class="headerlink" title="domain"></a>domain</h5><p><code>AuthUserRoleDomainServiceImpl.java</code></p><ol><li><strong>ç”¨æˆ·å­˜åœ¨æ€§æ£€æŸ¥</strong>ï¼šé¦–å…ˆæ£€æŸ¥è¦æ³¨å†Œçš„ç”¨æˆ·æ˜¯å¦å·²å­˜åœ¨ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™è¿”å›<code>true</code>ã€‚</li><li><strong>ç”¨æˆ·BOè½¬æ¢</strong>ï¼šå°†<code>AuthUserBO</code>ï¼ˆä¸šåŠ¡å¯¹è±¡ï¼‰è½¬æ¢ä¸º<code>AuthUser</code>å®ä½“ã€‚</li><li><strong>å¯†ç åŠ å¯†</strong>ï¼šå¦‚æœç”¨æˆ·å¯†ç ä¸ä¸ºç©ºï¼Œåˆ™ä½¿ç”¨MD5åŠ ç›çš„æ–¹å¼åŠ å¯†å¯†ç ã€‚</li><li><strong>é»˜è®¤å¤´åƒå’Œæ˜µç§°</strong>ï¼šå¦‚æœç”¨æˆ·æ²¡æœ‰æä¾›å¤´åƒæˆ–æ˜µç§°ï¼Œåˆ™è®¾ç½®é»˜è®¤å€¼ã€‚</li><li><strong>ç”¨æˆ·çŠ¶æ€è®¾ç½®</strong>ï¼šè®¾ç½®ç”¨æˆ·çŠ¶æ€ä¸ºå¼€å¯ï¼ˆ<code>AuthUserStatusEnum.OPEN</code>ï¼‰å’Œæœªåˆ é™¤ï¼ˆ<code>IsDeletedFlagEnum.UN_DELETED</code>ï¼‰ã€‚</li><li><strong>ç”¨æˆ·æ’å…¥æ•°æ®åº“</strong>ï¼šå°†ç”¨æˆ·å®ä½“æ’å…¥æ•°æ®åº“ï¼Œå¹¶æ£€æŸ¥æ’å…¥æ“ä½œæ˜¯å¦æˆåŠŸã€‚</li><li><strong>è§’è‰²å…³è”</strong>ï¼šä¸ºæ–°ç”¨æˆ·åˆ†é…ä¸€ä¸ªé»˜è®¤è§’è‰²ï¼ˆæ™®é€šç”¨æˆ·ï¼‰ï¼Œå¹¶å°†è§’è‰²ä¸ç”¨æˆ·å…³è”ã€‚</li><li><strong>Redisç¼“å­˜è§’è‰²ä¿¡æ¯</strong>ï¼šä½¿ç”¨Redisç¼“å­˜ç”¨æˆ·çš„è§’è‰²ä¿¡æ¯ï¼Œä»¥ä¾¿å¿«é€Ÿæ£€ç´¢ã€‚</li><li><strong>æƒé™æŸ¥è¯¢ä¸ç¼“å­˜</strong>ï¼šæŸ¥è¯¢è§’è‰²æ‹¥æœ‰çš„æƒé™ï¼Œå¹¶å°†æƒé™ä¿¡æ¯ç¼“å­˜åˆ°Redisã€‚</li><li><strong>äº‹åŠ¡ç®¡ç†</strong>ï¼šä½¿ç”¨<code>@Transactional</code>æ³¨è§£ç¡®ä¿æ–¹æ³•åœ¨å‡ºç°å¼‚å¸¸æ—¶å¯ä»¥å›æ»šã€‚ï¼ˆä¹Ÿå¯ä»¥ç”¨TransactionnalTemplateï¼‰</li><li><strong>å¼‚å¸¸å¤„ç†</strong>ï¼šä½¿ç”¨<code>@SneakyThrows</code>æ³¨è§£æ¥é‡æ–°æŠ›å‡ºæ£€æŸ¥å‹å¼‚å¸¸ã€‚</li><li><strong>è¿”å›ç»“æœ</strong>ï¼šå¦‚æœç”¨æˆ·æ’å…¥æˆåŠŸï¼Œåˆ™è¿”å›<code>true</code>ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@SneakyThrows</span></span><br><span class="line"><span class="meta">@Transactional(rollbackFor = Exception.class)</span> <span class="comment">//äº‹åŠ¡</span></span><br><span class="line"><span class="keyword">public</span> Boolean <span class="title function_">register</span><span class="params">(AuthUserBO authUserBO)</span> &#123;</span><br><span class="line">    <span class="comment">//æ ¡éªŒç”¨æˆ·æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">    <span class="type">AuthUser</span> <span class="variable">existAuthUser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthUser</span>();</span><br><span class="line">    existAuthUser.setUserName(authUserBO.getUserName());</span><br><span class="line">    List&lt;AuthUser&gt; existUser = authUserService.queryByCondition(existAuthUser);</span><br><span class="line">    <span class="keyword">if</span> (existUser.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">AuthUser</span> <span class="variable">authUser</span> <span class="operator">=</span> AuthUserBOConverter.INSTANCE.convertBOToEntity(authUserBO);</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isNotBlank(authUser.getPassword())) &#123;</span><br><span class="line">        authUser.setPassword(SaSecureUtil.md5BySalt(authUser.getPassword(), salt));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(authUser.getAvatar())) &#123;</span><br><span class="line">        authUser.setAvatar(<span class="string">&quot;http://117.72.10.84:9000/user/icon/å¾®ä¿¡å›¾ç‰‡_20231203153718(1).png&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(authUser.getNickName())) &#123;</span><br><span class="line">        authUser.setNickName(<span class="string">&quot;lzrj&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    authUser.setStatus(AuthUserStatusEnum.OPEN.getCode());</span><br><span class="line">    authUser.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> authUserService.insert(authUser);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å»ºç«‹ä¸€ä¸ªåˆæ­¥çš„è§’è‰²çš„å…³è”</span></span><br><span class="line">    <span class="type">AuthRole</span> <span class="variable">authRole</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthRole</span>();</span><br><span class="line">    authRole.setRoleKey(AuthConstant.NORMAL_USER);</span><br><span class="line">    <span class="type">AuthRole</span> <span class="variable">roleResult</span> <span class="operator">=</span> authRoleService.queryByCondition(authRole);</span><br><span class="line">    <span class="type">Long</span> <span class="variable">roleId</span> <span class="operator">=</span> roleResult.getId();</span><br><span class="line">    <span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> authUser.getId();</span><br><span class="line">    <span class="type">AuthUserRole</span> <span class="variable">authUserRole</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthUserRole</span>();</span><br><span class="line">    authUserRole.setUserId(userId);</span><br><span class="line">    authUserRole.setRoleId(roleId);</span><br><span class="line">    authUserRole.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">    authUserRoleService.insert(authUserRole);</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">roleKey</span> <span class="operator">=</span> redisUtil.buildKey(authRolePrefix, authUser.getUserName());</span><br><span class="line">    List&lt;AuthRole&gt; roleList = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    roleList.add(authRole);</span><br><span class="line">    redisUtil.set(roleKey, <span class="keyword">new</span> <span class="title class_">Gson</span>().toJson(roleList));</span><br><span class="line"></span><br><span class="line">    <span class="type">AuthRolePermission</span> <span class="variable">authRolePermission</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthRolePermission</span>();</span><br><span class="line">    authRolePermission.setRoleId(roleId);</span><br><span class="line">    List&lt;AuthRolePermission&gt; rolePermissionList = authRolePermissionService.</span><br><span class="line">            queryByCondition(authRolePermission);</span><br><span class="line"></span><br><span class="line">    List&lt;Long&gt; permissionIdList = rolePermissionList.stream()</span><br><span class="line">            .map(AuthRolePermission::getPermissionId).collect(Collectors.toList());</span><br><span class="line">    <span class="comment">//æ ¹æ®roleIdæŸ¥æƒé™</span></span><br><span class="line">    List&lt;AuthPermission&gt; permissionList = authPermissionService.queryByRoleList(permissionIdList);</span><br><span class="line">    <span class="type">String</span> <span class="variable">permissionKey</span> <span class="operator">=</span> redisUtil.buildKey(authPermissionPrefix, authUser.getUserName());</span><br><span class="line">    redisUtil.set(permissionKey, <span class="keyword">new</span> <span class="title class_">Gson</span>().toJson(permissionList));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> count &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºä»€ä¹ˆè¿™é‡Œé‡åˆ°@Transactionalæ³¨è§£ï¼š<a href="https://blog.csdn.net/minghao0508/article/details/124374637?ops_request_misc=%7B%22request_id%22:%22172243354616800175766334%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172243354616800175766334&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-124374637-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=@Transactional&spm=1018.2226.3001.4187">Springâ€”â€”äº‹åŠ¡æ³¨è§£@Transactionalã€å»ºè®®æ”¶è—ã€‘-CSDNåšå®¢</a></p><p><code>@Transactional</code> æ³¨è§£åœ¨ Java åº”ç”¨ç¨‹åºä¸­ï¼Œå°¤å…¶æ˜¯åœ¨ä½¿ç”¨ Spring æ¡†æ¶æ—¶ï¼Œæ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ç‰¹æ€§ã€‚è¿™ä¸ªæ³¨è§£é€šå¸¸ç”¨äºå£°æ˜æ–¹æ³•åœ¨æ‰§è¡Œæ—¶åº”è¯¥è¢«è§†ä¸ºä¸€ä¸ªäº‹åŠ¡çš„è¾¹ç•Œã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨ <code>@Transactional</code> æ³¨è§£çš„ä¸€äº›ä¸»è¦åŸå› ï¼š</p><ol><li><strong>ç¡®ä¿æ•°æ®ä¸€è‡´æ€§</strong>ï¼šåœ¨æ¶‰åŠæ•°æ®åº“æ“ä½œçš„æ–¹æ³•ä¸­ï¼Œ<code>@Transactional</code> ç¡®ä¿æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­çš„æ‰€æœ‰æ•°æ®åº“æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆåœ¨é‡åˆ°å¼‚å¸¸æ—¶å…¨éƒ¨æ’¤é”€ï¼Œä»¥ä¿æŒæ•°æ®çš„ä¸€è‡´æ€§ã€‚</li><li><strong>ç®€åŒ–ä»£ç </strong>ï¼šä½¿ç”¨ <code>@Transactional</code> æ³¨è§£å¯ä»¥é¿å…åœ¨æ¯ä¸ªæ•°æ®åº“æ“ä½œåæ‰‹åŠ¨ç®¡ç†äº‹åŠ¡çš„å¼€å§‹å’Œæäº¤ï¼Œç®€åŒ–äº†ä»£ç ã€‚</li><li><strong>å£°æ˜å¼äº‹åŠ¡ç®¡ç†</strong>ï¼šSpring æ”¯æŒå£°æ˜å¼äº‹åŠ¡ç®¡ç†ï¼Œ<code>@Transactional</code> æ³¨è§£å°±æ˜¯è¿™ä¸€æ¦‚å¿µçš„å®ç°ä¹‹ä¸€ï¼Œå®ƒå…è®¸å°†äº‹åŠ¡ç®¡ç†é€»è¾‘ä»ä¸šåŠ¡é€»è¾‘ä»£ç ä¸­åˆ†ç¦»å‡ºæ¥ã€‚</li><li><strong>å›æ»šç­–ç•¥</strong>ï¼šé€šè¿‡ <code>@Transactional</code> æ³¨è§£ï¼Œå¯ä»¥å®šä¹‰å“ªäº›å¼‚å¸¸ä¼šå¯¼è‡´äº‹åŠ¡å›æ»šã€‚åœ¨æ‚¨æä¾›çš„ä»£ç ä¸­ï¼Œ<code>rollbackFor = Exception.class</code> è¡¨ç¤ºå¦‚æœæŠ›å‡ºä»»ä½•ç±»å‹çš„å¼‚å¸¸ï¼Œäº‹åŠ¡éƒ½ä¼šå›æ»šã€‚</li><li><strong>æ”¯æŒåµŒå¥—äº‹åŠ¡</strong>ï¼šå½“ä¸€ä¸ªäº‹åŠ¡æ–¹æ³•è°ƒç”¨å¦ä¸€ä¸ªå¸¦æœ‰ <code>@Transactional</code> æ³¨è§£çš„æ–¹æ³•æ—¶ï¼ŒSpring ä¼šå¤„ç†è¿™äº›æ–¹æ³•ä¹‹é—´çš„äº‹åŠ¡åµŒå¥—ã€‚</li><li><strong>æé«˜æ€§èƒ½</strong>ï¼šSpring äº‹åŠ¡ç®¡ç†å™¨å¯ä»¥é’ˆå¯¹ä¸åŒçš„äº‹åŠ¡ç­–ç•¥è¿›è¡Œä¼˜åŒ–ï¼Œæ¯”å¦‚æ‡’åŠ è½½äº‹åŠ¡ã€ä½¿ç”¨é€‚å½“çš„éš”ç¦»çº§åˆ«ç­‰ï¼Œä»¥æé«˜åº”ç”¨ç¨‹åºæ€§èƒ½ã€‚</li><li><strong>å¯ä¼¸ç¼©æ€§</strong>ï¼šéšç€åº”ç”¨ç¨‹åºçš„æ‰©å±•ï¼Œ<code>@Transactional</code> æ³¨è§£å¯ä»¥å¾ˆå®¹æ˜“åœ°åº”ç”¨äºæ–°çš„æ–¹æ³•æˆ–ç±»ï¼Œè€Œä¸éœ€è¦å¯¹ç°æœ‰ä»£ç è¿›è¡Œå¤§é‡ä¿®æ”¹ã€‚</li></ol><p>åœ¨æ‚¨çš„ä»£ç ç¤ºä¾‹ä¸­ï¼Œ<code>@Transactional</code> æ³¨è§£åº”ç”¨äºæ³¨å†Œç”¨æˆ·çš„æ–¹æ³•ä¸Šï¼Œè¿™æ„å‘³ç€ä»æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨åˆ°ç”¨æˆ·ä¿¡æ¯å†™å…¥æ•°æ®åº“ã€è§’è‰²å’Œæƒé™ä¿¡æ¯ç¼“å­˜åˆ° Redis çš„æ•´ä¸ªè¿‡ç¨‹è¢«è§†ä¸ºä¸€ä¸ªå•ä¸€çš„äº‹åŠ¡ã€‚å¦‚æœåœ¨è¿™ä¸ªè¿‡ç¨‹çš„ä»»ä½•åœ°æ–¹å‘ç”Ÿå¼‚å¸¸ï¼Œæ•´ä¸ªæ“ä½œå°†å›æ»šï¼Œä»¥ç¡®ä¿ç”¨æˆ·ä¿¡æ¯å’Œç›¸å…³çš„è§’è‰²ã€æƒé™è®¾ç½®è¦ä¹ˆå®Œå…¨åº”ç”¨ï¼Œè¦ä¹ˆå®Œå…¨ä¸åº”ç”¨ï¼Œé¿å…æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</p><p><code>auth-domain</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.auth.domain.constants;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * authæœåŠ¡å¸¸é‡</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthConstant</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">NORMAL_USER</span> <span class="operator">=</span> <span class="string">&quot;normal_user&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="infraå±‚-2"><a href="#infraå±‚-2" class="headerlink" title="infraå±‚"></a>infraå±‚</h5><p><img src="https://s2.loli.net/2024/07/28/ERumTNky47Z1xAK.jpg" alt="4aaca7492044e3e4d3c9d55c9b05c39.jpg"></p><p>æ¥ä¸‹æ¥å›åˆ°gatewayæ¨¡å—ï¼Œåœ¨ç”¨æˆ·ç™»å½•æ—¶åšå¥½ä¸redisçš„äº¤äº’å°±å¯ä»¥æ‰“é€šäº†ã€‚</p><h4 id="æƒé™æ¨¡å—å¼€å‘-auth-permission"><a href="#æƒé™æ¨¡å—å¼€å‘-auth-permission" class="headerlink" title="æƒé™æ¨¡å—å¼€å‘(auth_permission)"></a>æƒé™æ¨¡å—å¼€å‘(auth_permission)</h4><h5 id="controllerå±‚"><a href="#controllerå±‚" class="headerlink" title="controllerå±‚"></a>controllerå±‚</h5><p><code>PermissionController.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/permission/&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PermissionController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> AuthPermissionDomainService authPermissionDomainService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢æƒé™</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">add</span><span class="params">(<span class="meta">@RequestBody</span> AuthPermissionDTO authPermissionDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;PermissionController.add.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(authPermissionDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkArgument(!StringUtils.isBlank(authPermissionDTO.getName()), <span class="string">&quot;æƒé™åç§°ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            Preconditions.checkNotNull(authPermissionDTO.getParentId(), <span class="string">&quot;æƒé™çˆ¶idä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="type">AuthPermissionBO</span> <span class="variable">permissionBO</span> <span class="operator">=</span> AuthPermissionDTOConverter.INSTANCE.convertDTOToBO(authPermissionDTO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(authPermissionDomainService.add(permissionBO));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;PermissionController.add.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æ–°å¢æƒé™å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹æƒé™</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;update&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">update</span><span class="params">(<span class="meta">@RequestBody</span> AuthPermissionDTO authPermissionDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;PermissionController.update.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(authPermissionDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkNotNull(authPermissionDTO.getId(), <span class="string">&quot;æƒé™idä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="type">AuthPermissionBO</span> <span class="variable">permissionBO</span> <span class="operator">=</span> AuthPermissionDTOConverter.INSTANCE.convertDTOToBO(authPermissionDTO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(authPermissionDomainService.update(permissionBO));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;PermissionController.update.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æ›´æ–°æƒé™ä¿¡æ¯å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤æƒé™</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;delete&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">delete</span><span class="params">(<span class="meta">@RequestBody</span> AuthPermissionDTO authPermissionDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;PermissionController.delete.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(authPermissionDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkNotNull(authPermissionDTO.getId(), <span class="string">&quot;æƒé™idä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="type">AuthPermissionBO</span> <span class="variable">permissionBO</span> <span class="operator">=</span> AuthPermissionDTOConverter.INSTANCE.convertDTOToBO(authPermissionDTO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(authPermissionDomainService.delete(permissionBO));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;PermissionController.delete.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;åˆ é™¤æƒé™ä¿¡æ¯å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢ç”¨æˆ·æƒé™</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;getPermission&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">getPermission</span><span class="params">(String userName)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            log.info(<span class="string">&quot;PermissionController.getPermission.userName:&#123;&#125;&quot;</span>,userName);</span><br><span class="line">            Preconditions.checkArgument(!StringUtils.isBlank(userName), <span class="string">&quot;ç”¨æˆ·idä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(authPermissionDomainService.getPermission(userName));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;PermissionController.getPermission.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æŸ¥è¯¢ç”¨æˆ·æƒé™ä¿¡æ¯å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>AuthPermissionDTO.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthPermissionDTO</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Long parentId;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Integer type;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String menuUrl;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Integer status;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Integer show;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String icon;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String permissionKey;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>AuthPermissionDTOConverter.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AuthPermissionDTOConverter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">AuthPermissionDTOConverter</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(AuthPermissionDTOConverter.class);</span><br><span class="line"></span><br><span class="line">    AuthPermissionBO <span class="title function_">convertDTOToBO</span><span class="params">(AuthPermissionDTO authPermissionDTO)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="domainå±‚"><a href="#domainå±‚" class="headerlink" title="domainå±‚"></a>domainå±‚</h5><p><code>AuthPermissionBOConverter.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AuthPermissionBOConverter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">AuthPermissionBOConverter</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> Mappers.getMapper(AuthPermissionBOConverter.class);</span><br><span class="line"></span><br><span class="line">    AuthPermission <span class="title function_">convertBOToEntity</span><span class="params">(AuthPermissionBO authPermissionBO)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>AuthPermissionBO.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthPermissionBO</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Long parentId;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Integer type;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String menuUrl;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Integer status;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Integer show;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String icon;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String permissionKey;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>AuthPermissionService.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthPermissionDomainServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AuthPermissionDomainService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> AuthPermissionService authPermissionService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RedisUtil redisUtil;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">authPermissionPrefix</span> <span class="operator">=</span> <span class="string">&quot;auth.permission&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">add</span><span class="params">(AuthPermissionBO authPermissionBO)</span> &#123;</span><br><span class="line">        <span class="type">AuthPermission</span> <span class="variable">authPermission</span> <span class="operator">=</span> AuthPermissionBOConverter.INSTANCE.convertBOToEntity(authPermissionBO);</span><br><span class="line">        authPermission.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> authPermissionService.insert(authPermission);</span><br><span class="line">        <span class="keyword">return</span> count &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">update</span><span class="params">(AuthPermissionBO authPermissionBO)</span> &#123;</span><br><span class="line">        <span class="type">AuthPermission</span> <span class="variable">authPermission</span> <span class="operator">=</span> AuthPermissionBOConverter.INSTANCE.convertBOToEntity(authPermissionBO);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> authPermissionService.update(authPermission);</span><br><span class="line">        <span class="keyword">return</span> count &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">delete</span><span class="params">(AuthPermissionBO authPermissionBO)</span> &#123;</span><br><span class="line">        <span class="type">AuthPermission</span> <span class="variable">authPermission</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthPermission</span>();</span><br><span class="line">        authPermission.setId(authPermissionBO.getId());</span><br><span class="line">        authPermission.setIsDeleted(IsDeletedFlagEnum.DELETED.getCode());</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> authPermissionService.update(authPermission);</span><br><span class="line">        <span class="keyword">return</span> count &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getPermission</span><span class="params">(String userName)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">permissionKey</span> <span class="operator">=</span> redisUtil.buildKey(authPermissionPrefix, userName);</span><br><span class="line">        <span class="type">String</span> <span class="variable">permissionValue</span> <span class="operator">=</span> redisUtil.get(permissionKey);</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isBlank(permissionValue)) &#123;</span><br><span class="line">            <span class="keyword">return</span> Collections.emptyList();</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;AuthPermission&gt; permissionList = <span class="keyword">new</span> <span class="title class_">Gson</span>().fromJson(permissionValue,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">TypeToken</span>&lt;List&lt;AuthPermission&gt;&gt;() &#123;</span><br><span class="line">                &#125;.getType());</span><br><span class="line">        List&lt;String&gt; authList = permissionList.stream().map(AuthPermission::getPermissionKey).collect(Collectors.toList());</span><br><span class="line">        <span class="keyword">return</span> authList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="infraå±‚-3"><a href="#infraå±‚-3" class="headerlink" title="infraå±‚"></a>infraå±‚</h5><p><code>AuthPermission.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthPermission</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">56518358607843924L</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Long parentId;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Integer type;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String menuUrl;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Integer status;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Integer show;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String icon;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String permissionKey;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºäºº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String createdBy;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºæ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date createdTime;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°äºº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String updateBy;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date updateTime;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Integer isDeleted;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">getParentId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> parentId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setParentId</span><span class="params">(Long parentId)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.parentId = parentId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getType</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> type;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setType</span><span class="params">(Integer type)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.type = type;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMenuUrl</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> menuUrl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMenuUrl</span><span class="params">(String menuUrl)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.menuUrl = menuUrl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getStatus</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> status;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setStatus</span><span class="params">(Integer status)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.status = status;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getShow</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> show;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setShow</span><span class="params">(Integer show)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.show = show;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getIcon</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> icon;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setIcon</span><span class="params">(String icon)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.icon = icon;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getPermissionKey</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> permissionKey;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPermissionKey</span><span class="params">(String permissionKey)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.permissionKey = permissionKey;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getCreatedBy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> createdBy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCreatedBy</span><span class="params">(String createdBy)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.createdBy = createdBy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Date <span class="title function_">getCreatedTime</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> createdTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCreatedTime</span><span class="params">(Date createdTime)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.createdTime = createdTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUpdateBy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> updateBy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUpdateBy</span><span class="params">(String updateBy)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.updateBy = updateBy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Date <span class="title function_">getUpdateTime</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> updateTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUpdateTime</span><span class="params">(Date updateTime)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.updateTime = updateTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getIsDeleted</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> isDeleted;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setIsDeleted</span><span class="params">(Integer isDeleted)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.isDeleted = isDeleted;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>AuthPermissionDao.xml</code></p><ul><li><code>type</code>, <code>show</code>ï¼šè¿™äº›åˆ—åä½¿ç”¨äº†åå¼•å·ï¼Œå› ä¸º <code>type</code> å’Œ <code>show</code> æ˜¯ MySQL çš„ä¿ç•™å­—ã€‚åœ¨ SQL ä¸­ï¼Œä¿ç•™å­—æ˜¯å…·æœ‰ç‰¹å®šæ„ä¹‰çš„å…³é”®å­—ï¼Œå¦‚æœç”¨ä½œåˆ—åæˆ–è¡¨åï¼Œéœ€è¦ç”¨åå¼•å·æ‹¬èµ·æ¥ï¼Œä»¥é¿å…è¯­æ³•é”™è¯¯ã€‚</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--æ–°å¢æ‰€æœ‰åˆ—--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insert&quot;</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span> <span class="attr">useGeneratedKeys</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    insert into auth_permission(name, parent_id, `type`, menu_url, status, `show`, icon, permission_key, created_by, created_time, update_by, update_time, is_deleted)</span><br><span class="line">    values (#&#123;name&#125;, #&#123;parentId&#125;, #&#123;type&#125;, #&#123;menuUrl&#125;, #&#123;status&#125;, #&#123;show&#125;, #&#123;icon&#125;, #&#123;permissionKey&#125;, #&#123;createdBy&#125;, #&#123;createdTime&#125;, #&#123;updateBy&#125;, #&#123;updateTime&#125;, #&#123;isDeleted&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>AuthPermissionServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service(&quot;authPermissionService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthPermissionServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AuthPermissionService</span> &#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> AuthPermissionDao authPermissionDao;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡IDæŸ¥è¯¢å•æ¡æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id ä¸»é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> AuthPermission <span class="title function_">queryById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.authPermissionDao.queryById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> authPermission å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">insert</span><span class="params">(AuthPermission authPermission)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.authPermissionDao.insert(authPermission);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> authPermission å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">update</span><span class="params">(AuthPermission authPermission)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.authPermissionDao.update(authPermission);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡ä¸»é”®åˆ é™¤æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id ä¸»é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ˜¯å¦æˆåŠŸ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">deleteById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.authPermissionDao.deleteById(id) &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;AuthPermission&gt; <span class="title function_">queryByRoleList</span><span class="params">(List&lt;Long&gt; roleIdList)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.authPermissionDao.queryByRoleList(roleIdList);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="è§’è‰²æƒé™å…³è”å¼€å‘ï¼ˆauth-role-permissionï¼‰"><a href="#è§’è‰²æƒé™å…³è”å¼€å‘ï¼ˆauth-role-permissionï¼‰" class="headerlink" title="è§’è‰²æƒé™å…³è”å¼€å‘ï¼ˆauth_role_permissionï¼‰"></a>è§’è‰²æƒé™å…³è”å¼€å‘ï¼ˆauth_role_permissionï¼‰</h4><h5 id="controller-1"><a href="#controller-1" class="headerlink" title="controller"></a>controller</h5><p><code>RolePermissionController</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/rolePermission/&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RolePermissionController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> AuthRolePermissionDomainService authRolePermissionDomainService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢è§’è‰²æƒé™å…³è”å…³ç³»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Result&lt;Boolean&gt; <span class="title function_">add</span><span class="params">(<span class="meta">@RequestBody</span> AuthRolePermissionDTO authRolePermissionDTO)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">                log.info(<span class="string">&quot;RolePermissionController.add.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(authRolePermissionDTO));</span><br><span class="line">            &#125;</span><br><span class="line">            Preconditions.checkArgument(!CollectionUtils.isEmpty(authRolePermissionDTO.getPermissionIdList()),<span class="string">&quot;æƒé™å…³è”ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">            Preconditions.checkNotNull(authRolePermissionDTO.getRoleId(),<span class="string">&quot;è§’è‰²ä¸èƒ½ä¸ºç©º!&quot;</span>);</span><br><span class="line">            <span class="type">AuthRolePermissionBO</span> <span class="variable">rolePermissionBO</span> <span class="operator">=</span> AuthRolePermissionDTOConverter.INSTANCE.convertDTOToBO(authRolePermissionDTO);</span><br><span class="line">            <span class="keyword">return</span> Result.ok(authRolePermissionDomainService.add(rolePermissionBO));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;PermissionController.add.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">            <span class="keyword">return</span> Result.fail(<span class="string">&quot;æ–°å¢è§’è‰²æƒé™å¤±è´¥&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>AuthRolePermissionDTO.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthRolePermissionDTO</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">459343371709166261L</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Long roleId;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Long permissionId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Long&gt; permissionIdList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="domainå±‚-1"><a href="#domainå±‚-1" class="headerlink" title="domainå±‚"></a>domainå±‚</h5><p><code>AuthRolePermissionDomainServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthRolePermissionDomainServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AuthRolePermissionDomainService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> AuthRolePermissionService authRolePermissionService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">add</span><span class="params">(AuthRolePermissionBO authRolePermissionBO)</span> &#123;</span><br><span class="line">        List&lt;AuthRolePermission&gt; rolePermissionList = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">Long</span> <span class="variable">roleId</span> <span class="operator">=</span> authRolePermissionBO.getRoleId();</span><br><span class="line">        authRolePermissionBO.getPermissionIdList().forEach(permissionId -&gt; &#123;</span><br><span class="line">            <span class="type">AuthRolePermission</span> <span class="variable">authRolePermission</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthRolePermission</span>();</span><br><span class="line">            authRolePermission.setRoleId(roleId);</span><br><span class="line">            authRolePermission.setPermissionId(permissionId);</span><br><span class="line">            authRolePermission.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">            rolePermissionList.add(authRolePermission);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> authRolePermissionService.batchInsert(rolePermissionList);</span><br><span class="line">        <span class="keyword">return</span> count &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>AuthRolePermissionBO.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthRolePermissionBO</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">459343371709166261L</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Long roleId;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Long permissionId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;Long&gt; permissionIdList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="infraå±‚-4"><a href="#infraå±‚-4" class="headerlink" title="infraå±‚"></a>infraå±‚</h5><p><code>AuthRolePermissionServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service(&quot;authRolePermissionService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthRolePermissionServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">AuthRolePermissionService</span> &#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> AuthRolePermissionDao authRolePermissionDao;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡IDæŸ¥è¯¢å•æ¡æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id ä¸»é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> AuthRolePermission <span class="title function_">queryById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.authRolePermissionDao.queryById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–°å¢æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> authRolePermission å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> AuthRolePermission <span class="title function_">insert</span><span class="params">(AuthRolePermission authRolePermission)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.authRolePermissionDao.insert(authRolePermission);</span><br><span class="line">        <span class="keyword">return</span> authRolePermission;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">batchInsert</span><span class="params">(List&lt;AuthRolePermission&gt; authRolePermissionList)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.authRolePermissionDao.insertBatch(authRolePermissionList);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿®æ”¹æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> authRolePermission å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> AuthRolePermission <span class="title function_">update</span><span class="params">(AuthRolePermission authRolePermission)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.authRolePermissionDao.update(authRolePermission);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.queryById(authRolePermission.getId());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡ä¸»é”®åˆ é™¤æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id ä¸»é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ˜¯å¦æˆåŠŸ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">deleteById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.authRolePermissionDao.deleteById(id) &gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;AuthRolePermission&gt; <span class="title function_">queryByCondition</span><span class="params">(AuthRolePermission authRolePermission)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.authRolePermissionDao.queryAllByLimit(authRolePermission);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>AuthRolePermission.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthRolePermission</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">459343371709166261L</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Long roleId;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Long permissionId;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºäºº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String createdBy;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºæ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date createdTime;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°äºº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String updateBy;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date updateTime;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Integer isDeleted;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">getRoleId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> roleId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRoleId</span><span class="params">(Long roleId)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.roleId = roleId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Long <span class="title function_">getPermissionId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> permissionId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPermissionId</span><span class="params">(Long permissionId)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.permissionId = permissionId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getCreatedBy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> createdBy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCreatedBy</span><span class="params">(String createdBy)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.createdBy = createdBy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Date <span class="title function_">getCreatedTime</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> createdTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCreatedTime</span><span class="params">(Date createdTime)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.createdTime = createdTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getUpdateBy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> updateBy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUpdateBy</span><span class="params">(String updateBy)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.updateBy = updateBy;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Date <span class="title function_">getUpdateTime</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> updateTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUpdateTime</span><span class="params">(Date updateTime)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.updateTime = updateTime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getIsDeleted</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> isDeleted;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setIsDeleted</span><span class="params">(Integer isDeleted)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.isDeleted = isDeleted;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç¼“å­˜ä¸æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼ˆå»¶è¿ŸåŒåˆ ï¼‰"><a href="#ç¼“å­˜ä¸æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼ˆå»¶è¿ŸåŒåˆ ï¼‰" class="headerlink" title="ç¼“å­˜ä¸æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼ˆå»¶è¿ŸåŒåˆ ï¼‰"></a>ç¼“å­˜ä¸æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼ˆå»¶è¿ŸåŒåˆ ï¼‰</h4><p><img src="https://s2.loli.net/2024/08/02/vgMZ7Fy3fRPnJj6.jpg" alt="1699108963209-2ec4047e-03ee-4f39-99ed-9210e4efc363[1].jpeg"></p><p>æ ¹æ®ä»¥ä¸Šçš„æµç¨‹æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯å½“æ•°æ®å˜æ›´çš„æ—¶å€™ï¼Œå¦‚ä½•æŠŠç¼“å­˜å˜åˆ°æœ€æ–°ï¼Œä½¿æˆ‘ä»¬ä¸‹é¢è¦è®¨è®ºçš„é—®é¢˜ã€‚</p><ol><li><p>æ›´æ–°äº†æ•°æ®åº“ï¼Œå†æ›´æ–°ç¼“å­˜</p><p>å‡è®¾æ•°æ®åº“æ›´æ–°æˆåŠŸï¼Œç¼“å­˜æ›´æ–°å¤±è´¥ï¼Œåœ¨ç¼“å­˜å¤±æ•ˆå’Œè¿‡æœŸçš„æ—¶å€™ï¼Œè¯»å–åˆ°çš„éƒ½æ˜¯è€æ•°æ®ç¼“å­˜ã€‚</p></li><li><p>æ›´æ–°ç¼“å­˜ï¼Œæ›´æ–°æ•°æ®åº“</p><p>ç¼“å­˜æ›´æ–°æˆåŠŸäº†ï¼Œæ•°æ®åº“æ›´æ–°å¤±è´¥ï¼Œæ˜¯ä¸æ˜¯è¯»å–çš„ç¼“å­˜çš„éƒ½æ˜¯é”™è¯¯çš„ã€‚</p></li></ol><p>ä»¥ä¸Šä¸¤ç§ï¼Œå…¨éƒ½ä¸æ¨èã€‚</p><ol start="3"><li><p>å…ˆåˆ é™¤ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“</p><p>æœ‰ä¸€å®šçš„ä½¿ç”¨é‡ã€‚å³ä½¿æ•°æ®åº“æ›´æ–°å¤±è´¥ã€‚ç¼“å­˜ä¹Ÿå¯ä»¥ä¼šåˆ·ã€‚</p><p>å­˜åœ¨çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>é«˜å¹¶å‘æƒ…å†µä¸‹ï¼ï¼</p><p>æ¯”å¦‚è¯´æœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œä¸€ä¸ªæ˜¯ A çº¿ç¨‹ï¼Œä¸€ä¸ªæ˜¯ B çº¿ç¨‹ã€‚</p><p>A çº¿ç¨‹æŠŠæ•°æ®åˆ äº†ï¼Œæ­£åœ¨æ›´æ–°æ•°æ®åº“ï¼Œè¿™ä¸ªæ—¶å€™ B çº¿ç¨‹æ¥äº†ï¼Œå‘ç°ç¼“å­˜æ²¡äº†ï¼ŒåˆæŸ¥æ•°æ®ï¼Œåˆæ”¾å…¥ç¼“å­˜ã€‚ç¼“å­˜é‡Œé¢å­˜çš„å°±ä¸€ç›´æ˜¯è€æ•°æ®äº†ã€‚</p></li></ol><p><strong>å»¶è¿ŸåŒåˆ ï¼š</strong>:star:</p><ul><li>**å»¶æ—¶æ˜¯ç¡®ä¿ **ä¿®æ”¹æ•°æ®åº“ -&gt; æ¸…ç©ºç¼“å­˜å‰ï¼Œå…¶ä»–äº‹åŠ¡çš„æ›´æ”¹ç¼“å­˜æ“ä½œå·²ç»æ‰§è¡Œå®Œã€‚<a href="https://blog.csdn.net/qq_35890572/article/details/108538712?ops_request_misc=%7B%22request_id%22:%22172258242116800222864858%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172258242116800222864858&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-108538712-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=%E7%BC%93%E5%AD%98%E5%8F%8C%E5%88%A0&spm=1018.2226.3001.4187&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g/c3BtPTEwMDAuMjExNS4zMDAxLjQ0OTgmcT0lRTclQkMlOTMlRTUlQUQlOTglRTUlOEYlOEMlRTUlODglQTAmdD0mdT0=">redisç¼“å­˜ä¸ºä»€ä¹ˆè¦å»¶æ—¶åŒåˆ -CSDNåšå®¢</a></li></ul><p><strong>æ‰©å±•æ€è·¯</strong></p><ol><li><p>æ¶ˆæ¯é˜Ÿåˆ—è¡¥å¿</p><p>åˆ é™¤å¤±è´¥çš„ç¼“å­˜ï¼Œä½œä¸ºæ¶ˆæ¯æ‰“å…¥ mqï¼Œmq æ¶ˆè´¹è€…è¿›è¡Œç›‘å¬ï¼Œå†æ¬¡è¿›è¡Œé‡è¯•åˆ·ç¼“å­˜ã€‚</p></li><li><p>canal</p><p>ç›‘å¬æ•°æ®åº“çš„å˜åŒ–ï¼Œåšä¸€ä¸ªå…¬å…±æœåŠ¡ï¼Œä¸“é—¨æ¥å¯¹æ¥ç¼“å­˜åˆ·æ–°ã€‚ä¼˜ç‚¹ä¸šåŠ¡è§£è€¦ï¼Œä¸šåŠ¡å¤ªå¤šå†—ä½™ä»£ç å¤æ‚åº¦ã€‚</p></li></ol><h4 id="ç½‘å…³ä¸authå¾®æœåŠ¡ç¼“å­˜æ‰“é€š"><a href="#ç½‘å…³ä¸authå¾®æœåŠ¡ç¼“å­˜æ‰“é€š" class="headerlink" title="ç½‘å…³ä¸authå¾®æœåŠ¡ç¼“å­˜æ‰“é€š"></a>ç½‘å…³ä¸authå¾®æœåŠ¡ç¼“å­˜æ‰“é€š</h4><p>ä¸»è¦è·Ÿæ³¨å†Œæœ‰å…³</p><p><code>AuthUserDomainServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@SneakyThrows</span></span><br><span class="line"><span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line"><span class="keyword">public</span> Boolean <span class="title function_">register</span><span class="params">(AuthUserBO authUserBO)</span> &#123;</span><br><span class="line">    <span class="comment">//æ ¡éªŒç”¨æˆ·æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">    <span class="type">AuthUser</span> <span class="variable">existAuthUser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthUser</span>();</span><br><span class="line">    existAuthUser.setUserName(authUserBO.getUserName());</span><br><span class="line">    List&lt;AuthUser&gt; existUser = authUserService.queryByCondition(existAuthUser);</span><br><span class="line">    <span class="keyword">if</span> (existUser.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">AuthUser</span> <span class="variable">authUser</span> <span class="operator">=</span> AuthUserBOConverter.INSTANCE.convertBOToEntity(authUserBO);</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isNotBlank(authUser.getPassword())) &#123;</span><br><span class="line">        authUser.setPassword(SaSecureUtil.md5BySalt(authUser.getPassword(), salt));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(authUser.getAvatar())) &#123;</span><br><span class="line">        authUser.setAvatar(<span class="string">&quot;http://117.72.10.84:9000/user/icon/å¾®ä¿¡å›¾ç‰‡_20231203153718(1).png&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(authUser.getNickName())) &#123;</span><br><span class="line">        authUser.setNickName(<span class="string">&quot;åˆ«å&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    authUser.setStatus(AuthUserStatusEnum.OPEN.getCode());</span><br><span class="line">    authUser.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> authUserService.insert(authUser);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å»ºç«‹ä¸€ä¸ªåˆæ­¥çš„è§’è‰²çš„å…³è”</span></span><br><span class="line">    <span class="type">AuthRole</span> <span class="variable">authRole</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthRole</span>();</span><br><span class="line">    authRole.setRoleKey(AuthConstant.NORMAL_USER); <span class="comment">//æ™®é€šè§’è‰²</span></span><br><span class="line">    <span class="type">AuthRole</span> <span class="variable">roleResult</span> <span class="operator">=</span> authRoleService.queryByCondition(authRole); <span class="comment">//æŸ¥åˆ°å¯¹åº”çš„è§’è‰²è¿”å›ç»“æœï¼Œè¿™é‡Œä¸»è¦æ˜¯æ‹¿è§’è‰²çš„id</span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">roleId</span> <span class="operator">=</span> roleResult.getId();</span><br><span class="line">    <span class="type">Long</span> <span class="variable">userId</span> <span class="operator">=</span> authUser.getId();</span><br><span class="line">    <span class="type">AuthUserRole</span> <span class="variable">authUserRole</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthUserRole</span>();</span><br><span class="line">    authUserRole.setUserId(userId); <span class="comment">//ç”¨æˆ·è§’è‰² è®¾ç½® userId</span></span><br><span class="line">    authUserRole.setRoleId(roleId); <span class="comment">//ç”¨æˆ·è§’è‰² è®¾ç½® roleId</span></span><br><span class="line">    authUserRole.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">    authUserRoleService.insert(authUserRole);</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">roleKey</span> <span class="operator">=</span> redisUtil.buildKey(authRolePrefix, authUser.getUserName()); <span class="comment">//key:è§’è‰²å‰ç¼€+ç”¨æˆ·å</span></span><br><span class="line">    List&lt;AuthRole&gt; roleList = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    roleList.add(authRole);</span><br><span class="line">    redisUtil.set(roleKey, <span class="keyword">new</span> <span class="title class_">Gson</span>().toJson(roleList)); <span class="comment">//key:è§’è‰²å‰ç¼€+ç”¨æˆ·å value:åˆ—è¡¨å½¢å¼çš„roleï¼Œåœ¨è¿™é‡Œåªæœ‰æ™®é€šç”¨æˆ·</span></span><br><span class="line"></span><br><span class="line">    <span class="type">AuthRolePermission</span> <span class="variable">authRolePermission</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthRolePermission</span>();</span><br><span class="line">    authRolePermission.setRoleId(roleId); <span class="comment">//ç»™è§’è‰²æƒé™è®¾ç½®roleId</span></span><br><span class="line">    List&lt;AuthRolePermission&gt; rolePermissionList = authRolePermissionService.</span><br><span class="line">            queryByCondition(authRolePermission); <span class="comment">//æŸ¥è¯¢åˆ°æƒé™list</span></span><br><span class="line"></span><br><span class="line">    List&lt;Long&gt; permissionIdList = rolePermissionList.stream()  <span class="comment">//æ‹¿åˆ°è§’è‰²listå¯¹åº”çš„æƒé™id list</span></span><br><span class="line">            .map(AuthRolePermission::getPermissionId).collect(Collectors.toList());</span><br><span class="line">    List&lt;AuthPermission&gt; permissionList = authPermissionService.queryByRoleList(permissionIdList);<span class="comment">//æ ¹æ®æƒé™id listæŸ¥è¯¢æƒé™æœ¬èº«list</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">permissionKey</span> <span class="operator">=</span> redisUtil.buildKey(authPermissionPrefix, authUser.getUserName());<span class="comment">//key:æƒé™å‰ç¼€+ç”¨æˆ·å</span></span><br><span class="line">    redisUtil.set(permissionKey, <span class="keyword">new</span> <span class="title class_">Gson</span>().toJson(permissionList));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> count &gt; <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>AuthPermissionDao.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;AuthPermission&gt; <span class="title function_">queryByRoleList</span><span class="params">(<span class="meta">@Param(&quot;list&quot;)</span> List&lt;Long&gt; roleIdList)</span>;</span><br></pre></td></tr></table></figure><p><code>AuthPermissionDao.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryByRoleList&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;AuthPermissionMap&quot;</span>&gt;</span></span><br><span class="line">    select * from auth_permission</span><br><span class="line">    where id in</span><br><span class="line">    <span class="tag">&lt;<span class="name">foreach</span> <span class="attr">open</span>=<span class="string">&quot;(&quot;</span> <span class="attr">close</span>=<span class="string">&quot;)&quot;</span> <span class="attr">collection</span>=<span class="string">&quot;list&quot;</span> <span class="attr">item</span>=<span class="string">&quot;id&quot;</span> <span class="attr">separator</span>=<span class="string">&quot;,&quot;</span>&gt;</span></span><br><span class="line">        #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p>[mybatisä¸­resultMapçš„ç†è§£_result map-CSDNåšå®¢](<a href="https://blog.csdn.net/u012843873/article/details/80198185?ops_request_misc=%7B%22request_id%22:%22172259150816800178584486%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172259150816800178584486&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-80198185-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=mybatic">https://blog.csdn.net/u012843873/article/details/80198185?ops_request_misc=%7B%22request%5Fid%22%3A%22172259150816800178584486%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172259150816800178584486&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-80198185-null-null.142^v100^pc_search_result_base8&amp;utm_term=mybatic</a> resultmap&amp;spm&#x3D;1018.2226.3001.4187)</p><p>å›åˆ°ç½‘å…³å±‚</p><p><code>StpInterfaceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StpInterfaceImpl</span> <span class="keyword">implements</span> <span class="title class_">StpInterface</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RedisUtil redisUtil;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">authPermissionPrefix</span> <span class="operator">=</span> <span class="string">&quot;auth.permission&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">authRolePrefix</span> <span class="operator">=</span> <span class="string">&quot;auth.role&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getPermissionList</span><span class="params">(Object loginId, String loginType)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getAuth(loginId.toString(), authPermissionPrefix);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getRoleList</span><span class="params">(Object loginId, String loginType)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getAuth(loginId.toString(), authRolePrefix);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt; <span class="title function_">getAuth</span><span class="params">(String loginId, String prefix)</span> &#123; <span class="comment">//æ ¹æ®registerè¿‡ç¨‹ä¸­åˆ›å»ºçš„Redis keyè¿›è¡ŒæŸ¥è¯¢ï¼ŒåŒ…å«è§’è‰²å’Œæƒé™ä¸¤ç§</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">authKey</span> <span class="operator">=</span> redisUtil.buildKey(prefix, loginId.toString());</span><br><span class="line">        <span class="type">String</span> <span class="variable">authValue</span> <span class="operator">=</span> redisUtil.get(authKey);</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isBlank(authValue)) &#123;</span><br><span class="line">            <span class="keyword">return</span> Collections.emptyList();</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;String&gt; authList = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span> (authRolePrefix.equals(prefix)) &#123; <span class="comment">//è§’è‰²List</span></span><br><span class="line">            List&lt;AuthRole&gt; roleList = <span class="keyword">new</span> <span class="title class_">Gson</span>().fromJson(authValue, <span class="keyword">new</span> <span class="title class_">TypeToken</span>&lt;List&lt;AuthRole&gt;&gt;() &#123;</span><br><span class="line">            &#125;.getType());</span><br><span class="line">            authList = roleList.stream().map(AuthRole::getRoleKey).collect(Collectors.toList());</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (authPermissionPrefix.equals(prefix)) &#123; <span class="comment">//æƒé™List </span></span><br><span class="line">            List&lt;AuthPermission&gt; permissionList = <span class="keyword">new</span> <span class="title class_">Gson</span>().fromJson(authValue, <span class="keyword">new</span> <span class="title class_">TypeToken</span>&lt;List&lt;AuthPermission&gt;&gt;() &#123;</span><br><span class="line">            &#125;.getType());</span><br><span class="line">            authList = permissionList.stream().map(AuthPermission::getPermissionKey).collect(Collectors.toList());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> authList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ç™»å½•åå°±ä¼šæ‹¿åˆ°tokenï¼Œåœ¨redisä¸­å­˜æ”¾æœ‰k vï¼Œä¿å­˜æœ‰ç™»å½•çŠ¶æ€ã€‚åœ¨ç½‘å…³å±‚ä¼šæœ‰æ‹¦æˆªå™¨æ ¹æ®è·¯ç”±è¿›è¡Œå¯¹åº”çš„æ‹¦æˆªï¼ŒéªŒè¯æ˜¯å¦ç™»å½•&#x2F;æœ‰æƒé™ã€‚</p><p>æ‹¿åˆ°tokenä¹‹åï¼Œå°±å¯ä»¥é€šè¿‡isLoginå»éªŒè¯æ˜¯å¦ç™»å½•äº†ï¼ˆåœ¨è¯·æ±‚headerä¸­å¸¦æœ‰isLoginï¼‰</p><p><a href="https://sa-token.cc/doc.html#/use/jur-auth">æƒé™è®¤è¯ (sa-token.cc)</a></p><h4 id="ç™»å½•å¼€å‘ï¼ˆå¾®ä¿¡å…¬ä¼—å·ï¼Œæµ‹è¯•å·ï¼‰"><a href="#ç™»å½•å¼€å‘ï¼ˆå¾®ä¿¡å…¬ä¼—å·ï¼Œæµ‹è¯•å·ï¼‰" class="headerlink" title="ç™»å½•å¼€å‘ï¼ˆå¾®ä¿¡å…¬ä¼—å·ï¼Œæµ‹è¯•å·ï¼‰"></a>ç™»å½•å¼€å‘ï¼ˆå¾®ä¿¡å…¬ä¼—å·ï¼Œæµ‹è¯•å·ï¼‰</h4><p>å…¨æµç¨‹ï¼šæ‰«ç å¾®ä¿¡-&gt;å¾®ä¿¡å‘é€æ¶ˆæ¯åˆ°æœåŠ¡å™¨ï¼Œæ ¡éªŒç­¾åç¡®ä¿æ¥è‡ªå¾®ä¿¡ï¼ˆgetï¼‰-&gt;æœåŠ¡å™¨å†æŠŠæ¶ˆæ¯è¿›è¡ŒåŒ…è£…ï¼Œ é€šè¿‡å‰ç¼€+éªŒè¯ç ï¼ˆä¸€ä¸ªéšæœºæ•°ï¼‰ä½œä¸ºredis keyï¼ŒfromUserName(openId)ä½œä¸ºvalueå­˜åˆ°redisï¼Œå¹¶æŠŠåŒ…å«éªŒè¯ç çš„æ¶ˆæ¯å‘é€åˆ°å¾®ä¿¡-&gt;ç”¨æˆ·éªŒè¯ç ï¼ˆå¾®ä¿¡ï¼‰,ä»redisæ‹¿åˆ°openIdï¼ˆå³ç”¨æˆ·åï¼‰-&gt;ç”¨satokenç”¨openIdè¿›è¡Œç™»å½•ï¼Œç„¶ååˆ©ç”¨satokenè¿”å›ä¸€ä¸ªtokenï¼Œåç»­ç™»å½•å°±ä¼šå¸¦ä¸Šè¿™ä¸ªtoken</p><p>è¿™é‡Œç”¨çš„æ˜¯æµ‹è¯•å·ï¼Œå¹¶ä¸ä¼šç”ŸæˆçœŸæ­£çš„éªŒè¯ç åˆ°æ‰‹æœºä¸Šï¼Œåªæ˜¯ä¸ºäº†å¼€å‘æ¥å£ã€‚</p><p>ç™»å½•æ³¨å†Œæ¨¡å— </p><ul><li><p>æ³¨å†Œç”¨æˆ·ä¸éªŒè¯ </p><ol><li><p>çŸ­ä¿¡çš„æ–¹å¼ï¼Œé€šè¿‡å‘æ‰‹æœºå·å‘é€éªŒè¯ç ï¼Œæ¥å®ç°ç”¨æˆ·çš„éªŒè¯å¹¶ç™»å½•ï¼ˆè€ƒè™‘çš„æˆæœ¬æ˜¯çŸ­ä¿¡çš„è´¹ç”¨ï¼‰</p></li><li><p>é‚®ç®±çš„æ³¨å†Œç™»å½•ã€‚</p><p>ç”¨æˆ·æ³¨å†Œçš„æ—¶å€™ï¼Œç•™ä¸€ä¸ªé‚®ç®±ï¼Œæˆ‘ä»¬å¾€é‚®ç®±é‡Œé€šè¿‡é‚®ç®±æœåŠ¡å™¨å‘é€ä¸€ä¸ªé“¾æ¥ï¼Œç”¨æˆ·ç‚¹å‡»ä¹‹åï¼Œå®ç°ä¸€ä¸ªæ¿€æ´»ï¼Œæ¿€æ´»æˆåŠŸä¹‹åå°±å®Œæˆäº†æ³¨å†Œã€‚ï¼ˆ0 æˆæœ¬ï¼Œåå¤„è¿™ç§å‘é€çš„é‚®ä»¶å¾ˆå®¹æ˜“è¿›åƒåœ¾ç®±ï¼‰</p></li><li><p>ä¸ªäººå…¬ä¼—å·æ¨¡å¼ï¼ˆä¸ªäººå¼€å‘è€…æ— å…¬å¸çš„ï¼Œæ¯”è¾ƒé€‚åˆä½¿ç”¨ï¼Œ0 æˆæœ¬ï¼‰</p><p>ç”¨æˆ·ç™»å½•çš„æ—¶å€™ï¼Œå¼¹å‡ºæˆ‘ä»¬çš„è¿™ä¸ªå…¬ä¼—å·çš„ç ã€‚æ‰«ç åï¼Œç”¨æˆ·è¾“å…¥æˆ‘ä»¬æç¤ºçš„éªŒè¯ç ã€‚å¯ä»¥éšæœºæ¯”å¦‚è¯´ nadbugeï¼Œé€šè¿‡æˆ‘ä»¬çš„å…¬ä¼—å·å¯¹æ¥çš„å›è°ƒã€‚èƒ½æ‹¿åˆ°ä¸€å®šçš„ä¿¡æ¯ï¼Œç”¨æˆ·çš„ openIdã€‚è¿›è€Œè®°å½•ç”¨æˆ·çš„ä¿¡æ¯</p></li><li><p>ä¼ä¸šçš„æœåŠ¡å·ï¼ˆå¿…é¡»è¦æœ‰è¥ä¸šæ‰§ç…§ï¼Œè‡ªå·±ç©çš„ä¸ä¸Šçº¿çš„è¯ï¼Œä¹Ÿå¯ä»¥ç”¨æµ‹è¯•å·ï¼‰</p><p>å¥½å¤„å°±æ˜¯ä¸ä»…æ‰“é€šäº†å„ç§å›è°ƒï¼Œè€Œä¸”è¿˜èƒ½æ‹¿åˆ°ç”¨æˆ·çš„ä¿¡æ¯ã€‚</p></li></ol></li><li><p>ç™»å½•åŠŸèƒ½ </p><p>ä¼ ç»Ÿçš„ pc å½¢å¼ï¼Œéƒ½æ˜¯ç™»å½•ä¹‹åï¼Œå†™å…¥ cookieã€‚å‰ç«¯å†æ¬¡è¯·æ±‚çš„æ—¶å€™ï¼Œå¸¦ç€ cookie ä¸€ä¸ªèº«ä»½è¯†åˆ«å°±å¯ä»¥å®Œæˆè®¤è¯ã€‚</p><p>åå¤„æ˜¯ä»€ä¹ˆï¼Ÿå°ç¨‹åºå‘€ï¼Œapp å‘€ï¼Œå…¶å®æ˜¯æ²¡æœ‰ cookie è¿™ä¸ªæ¦‚å¿µçš„ã€‚</p><p><a href="https://blog.csdn.net/qq_53895518/article/details/136869614">å•ç‚¹ç™»å½•(SSO)è¯¦è§£â€”â€”è¶…è¯¦ç»†-CSDNåšå®¢</a></p><p>ä¸ºäº†æ›´å¥½çš„æ‰©å±•ï¼Œæˆ‘ä»¬å°±ç›´æ¥é€‰æ‹© <strong>tokençš„æ¨¡å¼</strong>ã€‚token æ”¾å…¥ header æ¥å®ç°ç”¨æˆ·èº«ä»½çš„è¯†åˆ«ä¸é‰´æƒã€‚</p></li><li><p>è¸¢äººä¸‹çº¿ </p><p>å‘ç°é£é™©ç”¨æˆ·ï¼Œå¯ä»¥é€šè¿‡åå°ç›´æ¥æŠŠç”¨æˆ·è¸¢æ‰ï¼Œç¦æ­¢å…¶å†è®¿é—®ï¼Œtoken ä¹Ÿå¯ä»¥ç›´æ¥ç½®ä¸ºå¤±æ•ˆçš„å½¢å¼ã€‚</p></li><li><p>é›†æˆ redis ï¼ˆä¿å­˜tokenï¼‰</p><p>å¦‚æœè¯´æˆ‘ä»¬é€‰æ‹©äº† tokenï¼Œç„¶åä¸åš token çš„ä¿å­˜ï¼ŒæœåŠ¡é‡å¯å‘€ï¼Œåˆ†å¸ƒå¼å¾®æœåŠ¡å•Šï¼Œæ•°æ®æ˜¯æ— æ³•å…±äº«å¹¶ä¸”ä¼šäº§ç”Ÿä¸¢å¤±é—®é¢˜ï¼Œæ‰€ä»¥ç”¨ redis æ¥å­˜å‚¨ä¸€äº›ä¿¡æ¯ï¼Œå®ç°å…±äº«ã€‚</p></li><li><p>è‡ªå®šä¹‰æˆ‘ä»¬çš„ token é£æ ¼å’Œå‰ç¼€ </p><p>æ¯”å¦‚æ­£å¸¸çš„ token å¯èƒ½æ˜¯ uuidï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å…¶ä»–å½¢å¼ã€‚</p><p>ç„¶åå°±æ˜¯ token çš„å‰ç«¯çš„ä¼ é€’ï¼Œä¹Ÿå¯ä»¥å»å®šä¹‰å‰ç¼€ï¼Œå›ºå®šå‰ç¼€æ‰ç”Ÿæ•ˆã€‚</p></li><li><p>è®°ä½æˆ‘ </p><p>å½“æˆ‘ä»¬å»å‹¾é€‰è®°ä½æˆ‘çš„æ—¶å€™ï¼Œä¸‹æ¬¡ç™»å½•å°±è‡ªåŠ¨å®ç°äº†ã€‚</p><p>å‰åç«¯åˆ†ç¦»ï¼Œæ²¡æœ‰ token çš„æ—¶å€™ï¼Œå¿…ç„¶ä¼šäº§ç”Ÿæ— æ³•å®ç°çš„é—®é¢˜ï¼Œæˆ‘ä»¬å°±é€‰æ‹©åœ¨å‰ç«¯çš„ localstorage æ¥åšã€‚</p></li></ul><h5 id="ç™»å½•æµç¨‹"><a href="#ç™»å½•æµç¨‹" class="headerlink" title="ç™»å½•æµç¨‹"></a>ç™»å½•æµç¨‹</h5><p>æ•´ä½“é‡‡å–ä¸ªäººå·çš„ç™»å½•æ¨¡å¼ï¼Œé€‰å–æŸä¿¡å·çš„ openId ä½œä¸ºç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†ï¼</p><p><img src="https://s2.loli.net/2024/08/03/31axL8tWMH9CJKG.png" alt="image-20240803115222050.png"></p><p>æ•´ä½“æµç¨‹ï¼š</p><ol><li><p>ç”¨æˆ·æ‰«å…¬ä¼—å·ç ã€‚ç„¶åå‘ä¸€æ¡æ¶ˆæ¯ï¼šéªŒè¯ç ã€‚</p></li><li><p>é€šè¿‡ api å›å¤ä¸€ä¸ªéšæœºçš„éªŒè¯ç ã€‚å­˜å…¥ redis</p><ul><li>key: å‰ç¼€+éªŒè¯ç </li><li>value: fromUsername(ä¹Ÿå°±æ˜¯openId)</li></ul></li><li><p>ç”¨æˆ·åœ¨éªŒè¯ç æ¡†è¾“å…¥ä¹‹åï¼Œç‚¹å‡»ç™»å½•ï¼Œè¿›å…¥æˆ‘ä»¬çš„æ³¨å†Œæ¨¡å—ï¼ŒåŒæ—¶å…³è”è§’è‰²å’Œæƒé™ã€‚å°±å®ç°äº†ç½‘å…³çš„ç»Ÿä¸€é‰´æƒã€‚</p></li><li><p>ç”¨æˆ·å°±å¯ä»¥è¿›è¡Œæ“ä½œï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®ä¸ªäººçš„ openId æ¥ç»´æŠ¤ä¸ªäººä¿¡æ¯ã€‚</p></li><li><p>ç”¨æˆ·ç™»å½•æˆåŠŸä¹‹åï¼Œè¿”å› tokenï¼Œå‰ç«¯çš„æ‰€æœ‰è¯·æ±‚éƒ½å¸¦ç€ token å°±å¯ä»¥è®¿é—®äº†ã€‚</p></li></ol><h5 id="æœåŠ¡è®¾è®¡"><a href="#æœåŠ¡è®¾è®¡" class="headerlink" title="æœåŠ¡è®¾è®¡"></a>æœåŠ¡è®¾è®¡</h5><ol><li><p>å¼€ä¸€ä¸ªæ–°çš„æœåŠ¡ï¼Œå«æˆ‘ä»¬çš„ jc-club-wechatã€‚ä¸“é—¨ç”¨äºå¯¹æ¥å¾®ä¿¡çš„ api å’Œå¾®ä¿¡çš„æ¶ˆæ¯çš„å›è°ƒã€‚</p><ul><li>å›è°ƒï¼šå…³æ³¨å…¬ä¼—å·ï¼Œå‘é€éªŒè¯ç </li></ul></li><li><p>é€šè¿‡ nacos æ³¨å†Œä¸­å¿ƒæ¥è°ƒç”¨æˆ‘ä»¬çš„ auth æœåŠ¡ï¼Œæ¥å®ç°ç”¨æˆ·çš„æ³¨å†Œã€‚</p></li><li><p>å¦ä¸€ç§æ‰©å±•æ–¹æ¡ˆï¼Œwechat å’Œ auth ä¸ç›´æ¥äº¤äº’ã€‚</p><ul><li>é€šè¿‡ mq æ¥åšã€‚wechat æ¥æ”¶å›è°ƒåï¼Œåå‘å‘å‡º mqã€‚è‡ªèº«çš„ auth æ¥è®¢é˜… mq è¿›è¡Œæ¶ˆè´¹ã€‚</li></ul></li></ol><h5 id="å…¬ä¼—å·å¼€å‘æ–‡æ¡£"><a href="#å…¬ä¼—å·å¼€å‘æ–‡æ¡£" class="headerlink" title="å…¬ä¼—å·å¼€å‘æ–‡æ¡£"></a>å…¬ä¼—å·å¼€å‘æ–‡æ¡£</h5><p><strong>é‡Œé¢çš„ä¾‹å­åªæœ‰pythonçš„æ²¡æœ‰javaçš„</strong></p><p>æµ‹è¯•å·åœ°å€ï¼š<a href="https://mp.weixin.qq.com/debug/cgi-bin/sandboxinfo?action=showinfo&t=sandbox/index">https://mp.weixin.qq.com/debug/cgi-bin/sandboxinfo?action=showinfo&amp;t=sandbox/index</a></p><p>å…¬ä¼—å·å¼€å‘æ–‡æ¡£ï¼š<a href="https://developers.weixin.qq.com/doc/offiaccount/Getting_Started/Overview.html">https://developers.weixin.qq.com/doc/offiaccount/Getting_Started/Overview.html</a></p><p>å›è°ƒæ¶ˆæ¯æ¥å…¥æŒ‡å—ï¼š<a href="https://developers.weixin.qq.com/doc/offiaccount/Basic_Information/Access_Overview.html">https://developers.weixin.qq.com/doc/offiaccount/Basic_Information/Access_Overview.html</a></p><p>æ¥æ”¶å…¬ä¼—å·æ¶ˆæ¯ä½“æ–‡æ¡£ï¼š<a href="https://developers.weixin.qq.com/doc/offiaccount/Message_Management/Receiving_standard_messages.html">https://developers.weixin.qq.com/doc/offiaccount/Message_Management/Receiving_standard_messages.html</a></p><p><img src="https://s2.loli.net/2024/08/03/MTJeu7qvbZUz6Gj.png" alt="image-20240803115835247.png"></p><h5 id="å…¬ä¼—å·éªŒç­¾å¼€å‘"><a href="#å…¬ä¼—å·éªŒç­¾å¼€å‘" class="headerlink" title="å…¬ä¼—å·éªŒç­¾å¼€å‘"></a>å…¬ä¼—å·éªŒç­¾å¼€å‘</h5><p><a href="https://developers.weixin.qq.com/doc/offiaccount/Basic_Information/Access_Overview.html"></a></p><p>ç”¨æˆ·å‘å…¬ä¼—å·å‘é€æ¶ˆæ¯æ—¶ï¼Œå…¬ä¼—å·æ–¹æ”¶åˆ°çš„æ¶ˆæ¯å‘é€è€…æ˜¯ä¸€ä¸ªOpenIDï¼Œæ˜¯ä½¿ç”¨ç”¨æˆ·å¾®ä¿¡å·åŠ å¯†åçš„ç»“æœï¼Œæ¯ä¸ªç”¨æˆ·å¯¹æ¯ä¸ªå…¬ä¼—å·æœ‰ä¸€ä¸ªå”¯ä¸€çš„OpenIDã€‚</p><p><img src="https://s2.loli.net/2024/08/03/eoJgcICb9mVwtAU.png" alt="image-20240803120538428.png"></p><ol><li><p><strong>å¡«å†™æœåŠ¡å™¨é…ç½®ï¼š</strong></p><p>ç™»å½•å¾®ä¿¡å…¬ä¼—å¹³å°å®˜ç½‘åï¼Œåœ¨å…¬ä¼—å¹³å°å®˜ç½‘çš„å¼€å‘-åŸºæœ¬è®¾ç½®é¡µé¢ï¼Œå‹¾é€‰åè®®æˆä¸ºå¼€å‘è€…ï¼Œç‚¹å‡»â€œä¿®æ”¹é…ç½®â€æŒ‰é’®ï¼Œå¡«å†™æœåŠ¡å™¨åœ°å€ï¼ˆURLï¼‰ã€Tokenå’ŒEncodingAESKeyï¼Œå…¶ä¸­URLæ˜¯å¼€å‘è€…ç”¨æ¥æ¥æ”¶å¾®ä¿¡æ¶ˆæ¯å’Œäº‹ä»¶çš„æ¥å£URLã€‚Tokenå¯ç”±å¼€å‘è€…å¯ä»¥ä»»æ„å¡«å†™ï¼Œç”¨ä½œç”Ÿæˆç­¾åï¼ˆè¯¥Tokenä¼šå’Œæ¥å£URLä¸­åŒ…å«çš„Tokenè¿›è¡Œæ¯”å¯¹ï¼Œä»è€ŒéªŒè¯å®‰å…¨æ€§ï¼‰ã€‚EncodingAESKeyç”±å¼€å‘è€…æ‰‹åŠ¨å¡«å†™æˆ–éšæœºç”Ÿæˆï¼Œå°†ç”¨ä½œæ¶ˆæ¯ä½“åŠ è§£å¯†å¯†é’¥ã€‚</p><p>åŒæ—¶ï¼Œå¼€å‘è€…å¯é€‰æ‹©æ¶ˆæ¯åŠ è§£å¯†æ–¹å¼ï¼šæ˜æ–‡æ¨¡å¼ã€å…¼å®¹æ¨¡å¼å’Œå®‰å…¨æ¨¡å¼ã€‚æ¨¡å¼çš„é€‰æ‹©ä¸æœåŠ¡å™¨é…ç½®åœ¨æäº¤åéƒ½ä¼šç«‹å³ç”Ÿæ•ˆï¼Œè¯·å¼€å‘è€…è°¨æ…å¡«å†™åŠé€‰æ‹©ã€‚åŠ è§£å¯†æ–¹å¼çš„é»˜è®¤çŠ¶æ€ä¸ºæ˜æ–‡æ¨¡å¼ï¼Œé€‰æ‹©å…¼å®¹æ¨¡å¼å’Œå®‰å…¨æ¨¡å¼éœ€è¦æå‰é…ç½®å¥½ç›¸å…³åŠ è§£å¯†ä»£ç ï¼Œ<a href="https://developers.weixin.qq.com/doc/offiaccount/Message_Management/Message_encryption_and_decryption_instructions.html">è¯¦æƒ…è¯·å‚è€ƒæ¶ˆæ¯ä½“ç­¾ååŠåŠ è§£å¯†éƒ¨åˆ†çš„æ–‡æ¡£</a> ã€‚</p><p><img src="https://s2.loli.net/2024/08/03/gGtxFwBLzdaubWE.png" alt="image-20240803122144007.png"></p></li><li><p>éªŒè¯æ¶ˆæ¯çš„ç¡®æ¥è‡ªå¾®ä¿¡æœåŠ¡å™¨</p><p>å¼€å‘è€…æäº¤ä¿¡æ¯åï¼Œå¾®ä¿¡æœåŠ¡å™¨å°†å‘é€GETè¯·æ±‚åˆ°å¡«å†™çš„æœåŠ¡å™¨åœ°å€URLä¸Šï¼ŒGETè¯·æ±‚æºå¸¦å‚æ•°å¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š</p><p><img src="https://s2.loli.net/2024/08/03/bQCGk9zgyfWIvw6.png" alt="image-20240803122337758.png"></p><p><code>CallBackController.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;callback&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">callback</span><span class="params">(<span class="meta">@RequestParam(&quot;signature&quot;)</span> String signature,</span></span><br><span class="line"><span class="params">                       <span class="meta">@RequestParam(&quot;timestamp&quot;)</span> String timestamp,</span></span><br><span class="line"><span class="params">                       <span class="meta">@RequestParam(&quot;nonce&quot;)</span> String nonce,</span></span><br><span class="line"><span class="params">                       <span class="meta">@RequestParam(&quot;echostr&quot;)</span> String echostr)</span> &#123;</span><br><span class="line">    log.info(<span class="string">&quot;getéªŒç­¾è¯·æ±‚å‚æ•°ï¼šsignature:&#123;&#125;ï¼Œtimestamp:&#123;&#125;ï¼Œnonce:&#123;&#125;ï¼Œechostr:&#123;&#125;&quot;</span>,</span><br><span class="line">            signature, timestamp, nonce, echostr);</span><br><span class="line">    <span class="type">String</span> <span class="variable">shaStr</span> <span class="operator">=</span> SHA1.getSHA1(token, timestamp, nonce, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (signature.equals(shaStr)) &#123;</span><br><span class="line">        <span class="keyword">return</span> echostr;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;unknown&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œsignatureæ˜¯å¾®ä¿¡æ ¹æ®ä¼ å…¥çš„tokenã€timestampã€nonceæ ¹æ®sha1è®¡ç®—ç”Ÿæˆçš„ï¼Œæ˜¯å¾®ä¿¡å›è°ƒæ¥çš„ã€‚</p></li></ol><h5 id="å†…ç½‘ç©¿é€ï¼ˆnatappï¼‰"><a href="#å†…ç½‘ç©¿é€ï¼ˆnatappï¼‰" class="headerlink" title="å†…ç½‘ç©¿é€ï¼ˆnatappï¼‰"></a>å†…ç½‘ç©¿é€ï¼ˆnatappï¼‰</h5><p>ä¸åŒç”µè„‘ä¸‹è½½åœ°å€ï¼š<a href="https://natapp.cn/#download">https://natapp.cn/#download</a></p><p>å†…ç½‘ç©¿é€ä½¿ç”¨æŒ‡å—ï¼š</p><p><a href="https://natapp.cn/article/natapp_newbie">https://natapp.cn/article/natapp_newbie</a></p><p>windows å¯åŠ¨æ–¹å¼ï¼š</p><p>è¿›åˆ°ç›®å½•ä¸‹ï¼Œè¿è¡Œexe</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start natapp -authtoken=xxxx</span><br></pre></td></tr></table></figure><p>é…ç½®å†…ç½‘ç©¿é€ï¼š</p><p><img src="https://s2.loli.net/2024/08/03/jQLXpdPHckq6bOv.png" alt="image-20240803122710792.png"></p><p>ä¼šç”Ÿæˆä¸€ä¸ªå…¬ç½‘çš„åˆ†é…çš„åœ°å€ï¼Œä»æœ¬åœ°åœ°å€-&gt;å…¬ç½‘åœ°å€ï¼Œå®ç°ç©¿é€</p><h5 id="ç›‘å¬ç”¨æˆ·è¡Œä¸º-è‡ªåŠ¨å›å¤æ¶ˆæ¯-æ¶ˆæ¯äº‹ä»¶ç›‘å¬-ç­–ç•¥æ¨¡å¼å®ç°è§£è€¦"><a href="#ç›‘å¬ç”¨æˆ·è¡Œä¸º-è‡ªåŠ¨å›å¤æ¶ˆæ¯-æ¶ˆæ¯äº‹ä»¶ç›‘å¬-ç­–ç•¥æ¨¡å¼å®ç°è§£è€¦" class="headerlink" title="ç›‘å¬ç”¨æˆ·è¡Œä¸º&amp;è‡ªåŠ¨å›å¤æ¶ˆæ¯(æ¶ˆæ¯äº‹ä»¶ç›‘å¬+ç­–ç•¥æ¨¡å¼å®ç°è§£è€¦)"></a>ç›‘å¬ç”¨æˆ·è¡Œä¸º&amp;è‡ªåŠ¨å›å¤æ¶ˆæ¯(æ¶ˆæ¯äº‹ä»¶ç›‘å¬+ç­–ç•¥æ¨¡å¼å®ç°è§£è€¦)</h5><h6 id="controller-2"><a href="#controller-2" class="headerlink" title="controller"></a>controller</h6><p><strong>è§£é‡Šå…³é”®ç‚¹</strong></p><ul><li>**<code>MessageUtil.parseXml</code>**ï¼šè¿™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰æ–¹æ³•ï¼Œç”¨äºå°† XML æ ¼å¼çš„å­—ç¬¦ä¸²è§£ææˆ <code>Map&lt;String, String&gt;</code>ã€‚</li><li>**<code>WxChatMsgHandler</code> å’Œ <code>wxChatMsgFactory</code>**ï¼š<code>WxChatMsgHandler</code> æ˜¯ä¸€ä¸ªå¤„ç†å¾®ä¿¡æ¶ˆæ¯çš„æ¥å£æˆ–ç±»ï¼Œ<code>wxChatMsgFactory</code> æ˜¯ä¸€ä¸ªå·¥å‚ç±»ï¼Œç”¨äºæ ¹æ®æ¶ˆæ¯ç±»å‹è·å–å¯¹åº”çš„æ¶ˆæ¯å¤„ç†å™¨ã€‚</li><li>**<code>msgTypeKey</code>**ï¼šè¿™ä¸ªå­—ç¬¦ä¸²é”®å€¼ç”¨äºæ ‡è¯†ä¸åŒçš„æ¶ˆæ¯ç±»å‹ï¼Œä¾‹å¦‚ â€œtextâ€ã€â€imageâ€ã€â€event.subscribeâ€ ç­‰ã€‚</li></ul><p><strong>ä¸»è¦é€»è¾‘æµç¨‹</strong></p><ol><li>æ¥æ”¶å¹¶è®°å½•å¾®ä¿¡å‘é€çš„æ¶ˆæ¯ã€‚</li><li>å°† XML æ ¼å¼çš„æ¶ˆæ¯è§£ææˆ <code>Map</code>ã€‚</li><li>æå–æ¶ˆæ¯ç±»å‹å’Œäº‹ä»¶ç±»å‹ã€‚</li><li>æ„å»ºæ¶ˆæ¯ç±»å‹é”®å€¼ï¼Œå¹¶æ ¹æ®é”®å€¼ä»å·¥å‚ä¸­è·å–å¯¹åº”çš„æ¶ˆæ¯å¤„ç†å™¨ã€‚<ul><li>subscribeæ¶ˆæ¯</li><li>textæ¶ˆæ¯</li></ul></li><li>ä½¿ç”¨æ¶ˆæ¯å¤„ç†å™¨å¤„ç†æ¶ˆæ¯ï¼Œè¿”å›å¤„ç†ç»“æœã€‚</li></ol><p><code>CallBackController.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> <span class="string">&quot;adwidhaidwoaid&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Resource</span></span><br><span class="line"><span class="keyword">private</span> WxChatMsgFactory wxChatMsgFactory;</span><br><span class="line"></span><br><span class="line"><span class="meta">@PostMapping(value = &quot;callback&quot;, produces = &quot;application/xml;charset=UTF-8&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">callback</span><span class="params">(</span></span><br><span class="line"><span class="params">        <span class="meta">@RequestBody</span> String requestBody,</span></span><br><span class="line"><span class="params">        <span class="meta">@RequestParam(&quot;signature&quot;)</span> String signature,</span></span><br><span class="line"><span class="params">        <span class="meta">@RequestParam(&quot;timestamp&quot;)</span> String timestamp,</span></span><br><span class="line"><span class="params">        <span class="meta">@RequestParam(&quot;nonce&quot;)</span> String nonce,</span></span><br><span class="line"><span class="params">        <span class="meta">@RequestParam(value = &quot;msg_signature&quot;, required = false)</span> String msgSignature)</span> &#123;</span><br><span class="line">    log.info(<span class="string">&quot;æ¥æ”¶åˆ°å¾®ä¿¡æ¶ˆæ¯ï¼šrequestBodyï¼š&#123;&#125;&quot;</span>, requestBody);</span><br><span class="line">    Map&lt;String, String&gt; messageMap = MessageUtil.parseXml(requestBody);</span><br><span class="line">    <span class="type">String</span> <span class="variable">msgType</span> <span class="operator">=</span> messageMap.get(<span class="string">&quot;MsgType&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">event</span> <span class="operator">=</span> messageMap.get(<span class="string">&quot;Event&quot;</span>) == <span class="literal">null</span> ? <span class="string">&quot;&quot;</span> : messageMap.get(<span class="string">&quot;Event&quot;</span>);</span><br><span class="line">    log.info(<span class="string">&quot;msgType:&#123;&#125;,event:&#123;&#125;&quot;</span>, msgType, event);</span><br><span class="line"></span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    sb.append(msgType);</span><br><span class="line">    <span class="keyword">if</span> (!StringUtils.isEmpty(event)) &#123;</span><br><span class="line">        sb.append(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">        sb.append(event);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">String</span> <span class="variable">msgTypeKey</span> <span class="operator">=</span> sb.toString();</span><br><span class="line">    <span class="type">WxChatMsgHandler</span> <span class="variable">wxChatMsgHandler</span> <span class="operator">=</span> wxChatMsgFactory.getHandlerByMsgType(msgTypeKey);</span><br><span class="line">    <span class="keyword">if</span> (Objects.isNull(wxChatMsgHandler)) &#123; </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;unknown&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">String</span> <span class="variable">replyContent</span> <span class="operator">=</span> wxChatMsgHandler.dealMsg(messageMap);</span><br><span class="line">    log.info(<span class="string">&quot;replyContent:&#123;&#125;&quot;</span>, replyContent);</span><br><span class="line">    <span class="keyword">return</span> replyContent;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="Utils"><a href="#Utils" class="headerlink" title="Utils"></a>Utils</h6><p><code>MessageUtil.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MessageUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è§£æå¾®ä¿¡å‘æ¥çš„è¯·æ±‚ï¼ˆString-&gt;XMLï¼‰.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> msg æ¶ˆæ¯</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> map</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, String&gt; <span class="title function_">parseXml</span><span class="params">(<span class="keyword">final</span> String msg)</span> &#123;</span><br><span class="line">        <span class="comment">// å°†è§£æç»“æœå­˜å‚¨åœ¨HashMapä¸­</span></span><br><span class="line">        Map&lt;String, String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, String&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä»requestä¸­å–å¾—è¾“å…¥æµ</span></span><br><span class="line">        <span class="keyword">try</span> (<span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(msg.getBytes(StandardCharsets.UTF_8.name()))) &#123;</span><br><span class="line">            <span class="comment">// è¯»å–è¾“å…¥æµ</span></span><br><span class="line">            <span class="type">SAXReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SAXReader</span>(); <span class="comment">//saxreader</span></span><br><span class="line">            <span class="type">Document</span> <span class="variable">document</span> <span class="operator">=</span> reader.read(inputStream);</span><br><span class="line">            <span class="comment">// å¾—åˆ°xmlæ ¹å…ƒç´ </span></span><br><span class="line">            <span class="type">Element</span> <span class="variable">root</span> <span class="operator">=</span> document.getRootElement();</span><br><span class="line">            <span class="comment">// å¾—åˆ°æ ¹å…ƒç´ çš„æ‰€æœ‰å­èŠ‚ç‚¹</span></span><br><span class="line">            List&lt;Element&gt; elementList = root.elements();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// éå†æ‰€æœ‰å­èŠ‚ç‚¹</span></span><br><span class="line">            <span class="keyword">for</span> (Element e : elementList) &#123;</span><br><span class="line">                map.put(e.getName(), e.getText());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> map;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="handler"><a href="#handler" class="headerlink" title="handler"></a>handler</h6><p><code>WxChatMsgHandler.java</code></p><p>æœ‰ä¸¤ä¸ªç±»ç»§æ‰¿å®ƒï¼š</p><ul><li><p><code>SubscribeMsgHandler.java</code></p></li><li><p><code>ReceiveTextMsgHandler.java</code></p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">WxChatMsgHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    WxChatMsgTypeEnum <span class="title function_">getMsgType</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">dealMsg</span><span class="params">(Map&lt;String, String&gt; messageMap)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.wx.handler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.jingdianjichi.wx.redis.RedisUtil;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReceiveTextMsgHandler</span> <span class="keyword">implements</span> <span class="title class_">WxChatMsgHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">KEY_WORD</span> <span class="operator">=</span> <span class="string">&quot;éªŒè¯ç &quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">LOGIN_PREFIX</span> <span class="operator">=</span> <span class="string">&quot;loginCode&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RedisUtil redisUtil;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> WxChatMsgTypeEnum <span class="title function_">getMsgType</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> WxChatMsgTypeEnum.TEXT_MSG;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">dealMsg</span><span class="params">(Map&lt;String, String&gt; messageMap)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;æ¥æ”¶åˆ°æ–‡æœ¬æ¶ˆæ¯äº‹ä»¶&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> messageMap.get(<span class="string">&quot;Content&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!KEY_WORD.equals(content)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">fromUserName</span> <span class="operator">=</span> messageMap.get(<span class="string">&quot;FromUserName&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">toUserName</span> <span class="operator">=</span> messageMap.get(<span class="string">&quot;ToUserName&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">        <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> random.nextInt(<span class="number">1000</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">numKey</span> <span class="operator">=</span> redisUtil.buildKey(LOGIN_PREFIX, String.valueOf(num));</span><br><span class="line">        redisUtil.setNx(numKey, fromUserName, <span class="number">5L</span>, TimeUnit.MINUTES);</span><br><span class="line">        <span class="type">String</span> <span class="variable">numContent</span> <span class="operator">=</span> <span class="string">&quot;æ‚¨å½“å‰çš„éªŒè¯ç æ˜¯ï¼š&quot;</span> + num + <span class="string">&quot;ï¼ 5åˆ†é’Ÿå†…æœ‰æ•ˆ&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">replyContent</span> <span class="operator">=</span> <span class="string">&quot;&lt;xml&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;  &lt;ToUserName&gt;&lt;![CDATA[&quot;</span> + fromUserName + <span class="string">&quot;]]&gt;&lt;/ToUserName&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;  &lt;FromUserName&gt;&lt;![CDATA[&quot;</span> + toUserName + <span class="string">&quot;]]&gt;&lt;/FromUserName&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;  &lt;CreateTime&gt;12345678&lt;/CreateTime&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;  &lt;MsgType&gt;&lt;![CDATA[text]]&gt;&lt;/MsgType&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;  &lt;Content&gt;&lt;![CDATA[&quot;</span> + numContent + <span class="string">&quot;]]&gt;&lt;/Content&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;&lt;/xml&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> replyContent;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingdianjichi.wx.handler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubscribeMsgHandler</span> <span class="keyword">implements</span> <span class="title class_">WxChatMsgHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> WxChatMsgTypeEnum <span class="title function_">getMsgType</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> WxChatMsgTypeEnum.SUBSCRIBE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">dealMsg</span><span class="params">(Map&lt;String, String&gt; messageMap)</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;è§¦å‘ç”¨æˆ·å…³æ³¨äº‹ä»¶ï¼&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">fromUserName</span> <span class="operator">=</span> messageMap.get(<span class="string">&quot;FromUserName&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">toUserName</span> <span class="operator">=</span> messageMap.get(<span class="string">&quot;ToUserName&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">subscribeContent</span> <span class="operator">=</span> <span class="string">&quot;æ„Ÿè°¢æ‚¨çš„å…³æ³¨&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> <span class="string">&quot;&lt;xml&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;  &lt;ToUserName&gt;&lt;![CDATA[&quot;</span> + fromUserName + <span class="string">&quot;]]&gt;&lt;/ToUserName&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;  &lt;FromUserName&gt;&lt;![CDATA[&quot;</span> + toUserName + <span class="string">&quot;]]&gt;&lt;/FromUserName&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;  &lt;CreateTime&gt;12345678&lt;/CreateTime&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;  &lt;MsgType&gt;&lt;![CDATA[text]]&gt;&lt;/MsgType&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;  &lt;Content&gt;&lt;![CDATA[&quot;</span> + subscribeContent + <span class="string">&quot;]]&gt;&lt;/Content&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;&lt;/xml&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="redis"><a href="#redis" class="headerlink" title="redis"></a>redis</h6><p>è¿™é‡Œä¹Ÿç”¨åˆ°äº†<code>RedisUtil.java</code>ï¼Œå’Œgatewayæ¨¡å—çš„ä¸€è‡´ï¼Œæ‰€ä»¥åç»­æ€è·¯å¯ä»¥æŠŠè¿™éƒ¨åˆ†æå–å‡ºæ¥å½“æˆcommonæ¨¡å—çš„ã€‚</p><p><code>ReceiveTextMsgHandler.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">numKey</span> <span class="operator">=</span> redisUtil.buildKey(LOGIN_PREFIX, String.valueOf(num));</span><br><span class="line">        redisUtil.setNx(numKey, fromUserName, <span class="number">5L</span>, TimeUnit.MINUTES); <span class="comment">//keyä¸ºç™»å½•çš„å‰ç¼€ï¼ˆå­—ç¬¦ä¸²ï¼‰+éªŒè¯ç ï¼ˆvalidCodeï¼‰</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">numContent</span> <span class="operator">=</span> <span class="string">&quot;æ‚¨å½“å‰çš„éªŒè¯ç æ˜¯ï¼š&quot;</span> + num + <span class="string">&quot;ï¼ 5åˆ†é’Ÿå†…æœ‰æ•ˆ&quot;</span>;</span><br></pre></td></tr></table></figure><h5 id="å…¬ä¼—å·ç™»å½•éªŒè¯ç é€»è¾‘"><a href="#å…¬ä¼—å·ç™»å½•éªŒè¯ç é€»è¾‘" class="headerlink" title="å…¬ä¼—å·ç™»å½•éªŒè¯ç é€»è¾‘"></a>å…¬ä¼—å·ç™»å½•éªŒè¯ç é€»è¾‘</h5><p><code>UserController.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;doLogin&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;SaTokenInfo&gt; <span class="title function_">doLogin</span><span class="params">(<span class="meta">@RequestParam(&quot;validCode&quot;)</span> String validCode)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Preconditions.checkArgument(!StringUtils.isBlank(validCode), <span class="string">&quot;éªŒè¯ç ä¸èƒ½ä¸ºç©º!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> Result.ok(authUserDomainService.doLogin(validCode));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;UserController.doLogin.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        <span class="keyword">return</span> Result.fail(<span class="string">&quot;ç”¨æˆ·ç™»å½•å¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>AuthUserDomainServiceImpl.java</code></p><p>é€šè¿‡å‰ç¼€+éªŒè¯ç -&gt;ä»redisæ‹¿åˆ°openIdï¼ˆå³ç”¨æˆ·åï¼‰ï¼Œç”¨satokenç”¨openIdè¿›è¡Œç™»å½•ï¼Œç„¶ååˆ©ç”¨satokenè¿”å›ä¸€ä¸ªtoken</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> SaTokenInfo <span class="title function_">doLogin</span><span class="params">(String validCode)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">loginKey</span> <span class="operator">=</span> redisUtil.buildKey(LOGIN_PREFIX, validCode);</span><br><span class="line">    <span class="type">String</span> <span class="variable">openId</span> <span class="operator">=</span> redisUtil.get(loginKey);</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(openId)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">AuthUserBO</span> <span class="variable">authUserBO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthUserBO</span>();</span><br><span class="line">    authUserBO.setUserName(openId);</span><br><span class="line">    <span class="built_in">this</span>.register(authUserBO); <span class="comment">//æ ¡éªŒæ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨ç›´æ¥è¿”å›ï¼Œä¸å­˜åœ¨å°±æ³¨å†Œ</span></span><br><span class="line">    StpUtil.login(openId);</span><br><span class="line">    <span class="type">SaTokenInfo</span> <span class="variable">tokenInfo</span> <span class="operator">=</span> StpUtil.getTokenInfo();</span><br><span class="line">    <span class="keyword">return</span> tokenInfo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¬¬äºŒéƒ¨åˆ†"><a href="#ç¬¬äºŒéƒ¨åˆ†" class="headerlink" title="ç¬¬äºŒéƒ¨åˆ†"></a>ç¬¬äºŒéƒ¨åˆ†</h2><h3 id="å‰åç«¯éƒ¨ç½²"><a href="#å‰åç«¯éƒ¨ç½²" class="headerlink" title="å‰åç«¯éƒ¨ç½²"></a>å‰åç«¯éƒ¨ç½²</h3><p>å‰ç«¯ï¼š</p><p>ä¸‹å¥½node.jsï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pnpm install</span><br></pre></td></tr></table></figure><p>ä¸‹è½½å¥½ä¾èµ–ã€‚</p><p><img src="https://s2.loli.net/2024/08/03/FmTDQI2UK3zPi1k.png" alt="image-20240803195320973.png"></p><p>åç«¯ï¼š</p><p>å¦‚æœæœåŠ¡å™¨æ²¡é‚£ä¹ˆå¤§ç©ºé—´ï¼ŒJenkinsè·‘èµ·æ¥æœ‰ç‚¹å›°éš¾ï¼Œå¯ä»¥å°±é…ç½®å¥½ç›¸å…³é…ç½®åinstallæ‰“å¥½jaråŒ…ï¼Œæ‰”åˆ°æœåŠ¡å™¨ä¸Šï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup java -jar ***.jar</span><br></pre></td></tr></table></figure><h3 id="ç»†èŠ‚ä¼˜åŒ–"><a href="#ç»†èŠ‚ä¼˜åŒ–" class="headerlink" title="ç»†èŠ‚ä¼˜åŒ–"></a>ç»†èŠ‚ä¼˜åŒ–</h3><p>1ã€åˆ†ç±»å’Œæ ‡ç­¾çš„æ€§èƒ½ä¼˜åŒ–ï¼Œä¸€æ¬¡æ€§æŸ¥è¯¢å‡ºæ¥ï¼Œç»„è£…æˆæ ‘ç»“æ„</p><p>2ã€å»å‡ºé¢˜çš„æŒ‰é’®çš„æƒé™äº¤äº’ã€‚ç”¨æˆ·ç™»å½•æˆåŠŸåï¼Œè¿”å›ç»™å‰ç«¯ï¼Œå½“å‰ç”¨æˆ·çš„ç›¸å…³æƒé™ã€‚å‰ç«¯å­˜åˆ°æœ¬åœ° localstorage é‡Œé¢ï¼Œè¿›è¡ŒæŒ‰é’®çº§åˆ«çš„å‰ç«¯äº¤äº’ã€‚å¯¹äºä¸€äº›æ•æ„Ÿçš„å†™æ“ä½œï¼Œåç«¯ä¹Ÿåº”è¯¥æä¾›ä¸€äº›æƒé™æ¥å£</p><p>3ã€é€€å‡ºåŠŸèƒ½ï¼Œtoken å¤±æ•ˆçš„åŠŸèƒ½</p><p>4ã€ä¸ªäººä¿¡æ¯é¡µé¢çš„æŸ¥è¯¢åŠŸèƒ½ã€‚</p><p>5ã€ä¸Šä¼ å¤´åƒçš„åŠŸèƒ½ã€‚</p><p>6ã€æ¯æ¬¡æ³¨å†Œçš„æ—¶å€™ï¼Œç›¸åŒçš„ openId è¦åšæ ¡éªŒã€‚</p><h4 id="1-é¿å…é‡å¤æ³¨å†Œ"><a href="#1-é¿å…é‡å¤æ³¨å†Œ" class="headerlink" title="1. é¿å…é‡å¤æ³¨å†Œ"></a>1. é¿å…é‡å¤æ³¨å†Œ</h4><p><code>AuthUserDomainServiceImpl.java</code></p><p>æ³¨æ„è¿™é‡Œè°ƒäº†registerçš„æ¥å£ï¼šç™»å½•â€”&gt;æ³¨å†Œï¼ˆå¦‚æœå·²ç»æ³¨å†Œäº†å°±è¿”å›ï¼Œæ²¡æœ‰æ³¨å†Œå°±æ³¨å†Œï¼‰-&gt;è¿”å›satokenæä¾›äº†çš„tokenInfoã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> SaTokenInfo <span class="title function_">doLogin</span><span class="params">(String validCode)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">loginKey</span> <span class="operator">=</span> redisUtil.buildKey(LOGIN_PREFIX, validCode);</span><br><span class="line">    <span class="type">String</span> <span class="variable">openId</span> <span class="operator">=</span> redisUtil.get(loginKey);</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(openId)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">AuthUserBO</span> <span class="variable">authUserBO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthUserBO</span>();</span><br><span class="line">    authUserBO.setUserName(openId);</span><br><span class="line">    <span class="built_in">this</span>.register(authUserBO);</span><br><span class="line">    StpUtil.login(openId);</span><br><span class="line">    <span class="type">SaTokenInfo</span> <span class="variable">tokenInfo</span> <span class="operator">=</span> StpUtil.getTokenInfo();</span><br><span class="line">    <span class="keyword">return</span> tokenInfo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>AuthUserDomainServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@SneakyThrows</span></span><br><span class="line"><span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line"><span class="keyword">public</span> Boolean <span class="title function_">register</span><span class="params">(AuthUserBO authUserBO)</span> &#123;</span><br><span class="line">    <span class="comment">//æ ¡éªŒç”¨æˆ·æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">    <span class="type">AuthUser</span> <span class="variable">existAuthUser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthUser</span>();</span><br><span class="line">    existAuthUser.setUserName(authUserBO.getUserName());</span><br><span class="line">    List&lt;AuthUser&gt; existUser = authUserService.queryByCondition(existAuthUser);</span><br><span class="line">    <span class="keyword">if</span> (existUser.size() &gt; <span class="number">0</span>) &#123; <span class="comment">//è¿™é‡Œå¦‚æœå·²ç»æ³¨å†Œè¿‡äº†ï¼Œå°±ç›´æ¥è¿”å›äº†</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-ä¸ªäººä¿¡æ¯æŸ¥è¯¢"><a href="#2-ä¸ªäººä¿¡æ¯æŸ¥è¯¢" class="headerlink" title="2.ä¸ªäººä¿¡æ¯æŸ¥è¯¢"></a>2.ä¸ªäººä¿¡æ¯æŸ¥è¯¢</h4><p><code>UserController.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;getUserInfo&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;AuthUserDTO&gt; <span class="title function_">getUserInfo</span><span class="params">(<span class="meta">@RequestBody</span> AuthUserDTO authUserDTO)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;UserController.getUserInfo.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(authUserDTO));</span><br><span class="line">        &#125;</span><br><span class="line">        Preconditions.checkArgument(!StringUtils.isBlank(authUserDTO.getUserName()), <span class="string">&quot;ç”¨æˆ·åä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">        <span class="type">AuthUserBO</span> <span class="variable">authUserBO</span> <span class="operator">=</span> AuthUserDTOConverter.INSTANCE.convertDTOToBO(authUserDTO);</span><br><span class="line">        <span class="type">AuthUserBO</span> <span class="variable">userInfo</span> <span class="operator">=</span> authUserDomainService.getUserInfo(authUserBO);</span><br><span class="line">        <span class="keyword">return</span> Result.ok(AuthUserDTOConverter.INSTANCE.convertBOToDTO(userInfo));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;UserController.update.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        <span class="keyword">return</span> Result.fail(<span class="string">&quot;æ›´æ–°ç”¨æˆ·ä¿¡æ¯å¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>authUserDomainServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> AuthUserBO <span class="title function_">getUserInfo</span><span class="params">(AuthUserBO authUserBO)</span> &#123;</span><br><span class="line">    <span class="type">AuthUser</span> <span class="variable">authUser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthUser</span>();</span><br><span class="line">    authUser.setUserName(authUserBO.getUserName());</span><br><span class="line">    List&lt;AuthUser&gt; userList = authUserService.queryByCondition(authUser);</span><br><span class="line">    <span class="keyword">if</span> (CollectionUtils.isEmpty(userList)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AuthUserBO</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">AuthUser</span> <span class="variable">user</span> <span class="operator">=</span> userList.get(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> AuthUserBOConverter.INSTANCE.convertEntityToBO(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>authUserServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;AuthUser&gt; <span class="title function_">queryByCondition</span><span class="params">(AuthUser authUser)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.authUserDao.queryAllByLimit(authUser);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-ç”¨æˆ·é€€å‡º"><a href="#3-ç”¨æˆ·é€€å‡º" class="headerlink" title="3.ç”¨æˆ·é€€å‡º"></a>3.ç”¨æˆ·é€€å‡º</h4><p><code>UserController.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;logOut&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">logOut</span><span class="params">(<span class="meta">@RequestParam</span> String userName)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;UserController.logOut.userName:&#123;&#125;&quot;</span>, userName);</span><br><span class="line">        Preconditions.checkArgument(!StringUtils.isBlank(userName), <span class="string">&quot;ç”¨æˆ·åä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">        StpUtil.logout(userName);</span><br><span class="line">        <span class="keyword">return</span> Result.ok();</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;UserController.logOut.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        <span class="keyword">return</span> Result.fail(<span class="string">&quot;ç”¨æˆ·ç™»å‡ºå¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-ç”¨æˆ·ä¸Šä¼ å¤´åƒ"><a href="#4-ç”¨æˆ·ä¸Šä¼ å¤´åƒ" class="headerlink" title="4. ç”¨æˆ·ä¸Šä¼ å¤´åƒ"></a>4. ç”¨æˆ·ä¸Šä¼ å¤´åƒ</h4><p><code>oss</code>æ¨¡å—ä¸‹çš„<code>FileController.java</code></p><p><strong>æ¥å£å®šä¹‰</strong>ï¼š<code>/upload</code> æ˜¯ä¸€ä¸ª HTTP è¯·æ±‚æ˜ å°„ï¼Œç”¨äºæ¥æ”¶æ–‡ä»¶ä¸Šä¼ è¯·æ±‚ã€‚</p><p><strong>å‚æ•°</strong>ï¼š<code>MultipartFile uploadFile</code> æ˜¯ä¸Šä¼ çš„æ–‡ä»¶ï¼Œ<code>String bucket</code> æ˜¯æ¡¶çš„åç§°ï¼Œ<code>String objectName</code> æ˜¯å¯¹è±¡åç§°ï¼ˆæ–‡ä»¶è·¯å¾„ï¼‰ã€‚</p><p><strong>è°ƒç”¨æœåŠ¡</strong>ï¼šè°ƒç”¨ <code>fileService.uploadFile</code> æ–¹æ³•ä¸Šä¼ æ–‡ä»¶ï¼Œå¹¶è·å–æ–‡ä»¶çš„ URLã€‚</p><p><strong>è¿”å›ç»“æœ</strong>ï¼šä½¿ç”¨ <code>Result.ok(url)</code> è¿”å›ä¸Šä¼ åçš„æ–‡ä»¶ URLã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/upload&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">upload</span><span class="params">(MultipartFile uploadFile, String bucket, String objectName)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> fileService.uploadFile(uploadFile, bucket, objectName);</span><br><span class="line">    <span class="keyword">return</span> Result.ok(url);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>fileService.java</code></p><p><strong>è°ƒç”¨é€‚é…å™¨</strong>ï¼šè°ƒç”¨ <code>storageAdapter.uploadFile</code> æ–¹æ³•ï¼Œå°†æ–‡ä»¶ä¸Šä¼ åˆ°æŒ‡å®šçš„æ¡¶å’Œå¯¹è±¡åç§°ã€‚</p><p><strong>æ›´æ–°å¯¹è±¡åç§°</strong>ï¼šå°† <code>objectName</code> æ›´æ–°ä¸º <code>objectName + &quot;/&quot; + uploadFile.getOriginalFilename()</code>ï¼Œè¿™ä¸€æ­¥æ˜¯ä¸ºäº†æ„å»ºæ–‡ä»¶çš„å®Œæ•´è·¯å¾„ã€‚</p><p><strong>è·å– URL</strong>ï¼šè°ƒç”¨ <code>storageAdapter.getUrl</code> æ–¹æ³•ï¼Œè·å–æ–‡ä»¶çš„è®¿é—® URL å¹¶è¿”å›ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">uploadFile</span><span class="params">(MultipartFile uploadFile, String bucket, String objectName)</span>&#123;</span><br><span class="line">    storageAdapter.uploadFile(uploadFile,bucket,objectName);</span><br><span class="line">    objectName = objectName + <span class="string">&quot;/&quot;</span> + uploadFile.getOriginalFilename();</span><br><span class="line">    <span class="keyword">return</span> storageAdapter.getUrl(bucket, objectName);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>MinioStorageAdapter.java</code></p><p><strong>åˆ›å»ºæ¡¶</strong>ï¼šè°ƒç”¨ <code>minioUtil.createBucket(bucket)</code> æ–¹æ³•ï¼Œç¡®ä¿æ¡¶å­˜åœ¨ã€‚å¦‚æœæ¡¶ä¸å­˜åœ¨åˆ™åˆ›å»ºã€‚</p><p><strong>ä¸Šä¼ æ–‡ä»¶</strong>ï¼šæ ¹æ® <code>objectName</code> æ˜¯å¦ä¸ºç©ºï¼Œå†³å®šæ–‡ä»¶ä¸Šä¼ çš„è·¯å¾„ã€‚å¦‚æœ <code>objectName</code> ä¸ä¸ºç©ºï¼Œåˆ™å°†æ–‡ä»¶ä¸Šä¼ åˆ° <code>objectName + &quot;/&quot; + uploadFile.getOriginalFilename()</code>ã€‚å¦‚æœä¸ºç©ºï¼Œåˆ™ä¸Šä¼ åˆ° <code>uploadFile.getOriginalFilename()</code>ã€‚</p><p><strong>è·å– URL</strong>ï¼šæ„å»ºå¹¶è¿”å›æ–‡ä»¶çš„ URLã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@SneakyThrows</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">uploadFile</span><span class="params">(MultipartFile uploadFile, String bucket, String objectName)</span> &#123;</span><br><span class="line">    minioUtil.createBucket(bucket);</span><br><span class="line">    <span class="keyword">if</span> (objectName != <span class="literal">null</span>) &#123;</span><br><span class="line">        minioUtil.uploadFile(uploadFile.getInputStream(), bucket, objectName + <span class="string">&quot;/&quot;</span> + uploadFile.getOriginalFilename());</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        minioUtil.uploadFile(uploadFile.getInputStream(), bucket, uploadFile.getOriginalFilename());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@SneakyThrows</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getUrl</span><span class="params">(String bucket, String objectName)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> url + <span class="string">&quot;/&quot;</span> + bucket + <span class="string">&quot;/&quot;</span> + objectName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-åˆ†ç±»é¢˜ç›®æ•°é‡æ›´æ–°"><a href="#5-åˆ†ç±»é¢˜ç›®æ•°é‡æ›´æ–°" class="headerlink" title="5.åˆ†ç±»é¢˜ç›®æ•°é‡æ›´æ–°"></a>5.åˆ†ç±»é¢˜ç›®æ•°é‡æ›´æ–°</h4><p><code>SubjectCategoryController.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping(&quot;/queryPrimaryCategory&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;List&lt;SubjectCategoryDTO&gt;&gt; <span class="title function_">queryPrimaryCategory</span><span class="params">(<span class="meta">@RequestBody</span> SubjectCategoryDTO subjectCategoryDTO)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">SubjectCategoryBO</span> <span class="variable">subjectCategoryBO</span> <span class="operator">=</span> SubjectCategoryDTOConverter.INSTANCE.</span><br><span class="line">                convertDtoToCategoryBO(subjectCategoryDTO);</span><br><span class="line">        List&lt;SubjectCategoryBO&gt; subjectCategoryBOList = subjectCategoryDomainService.queryCategory(subjectCategoryBO);</span><br><span class="line">        List&lt;SubjectCategoryDTO&gt; subjectCategoryDTOList = SubjectCategoryDTOConverter.INSTANCE.</span><br><span class="line">                convertBoToCategoryDTOList(subjectCategoryBOList);</span><br><span class="line">        <span class="keyword">return</span> Result.ok(subjectCategoryDTOList);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;SubjectCategoryController.queryPrimaryCategory.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        <span class="keyword">return</span> Result.fail(<span class="string">&quot;æŸ¥è¯¢å¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SubjectCategoryDomainServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;SubjectCategoryBO&gt; <span class="title function_">queryCategory</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span> &#123;</span><br><span class="line">    <span class="type">SubjectCategory</span> <span class="variable">subjectCategory</span> <span class="operator">=</span> SubjectCategoryConverter.INSTANCE</span><br><span class="line">            .convertBoToCategory(subjectCategoryBO);</span><br><span class="line">    subjectCategory.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">    List&lt;SubjectCategory&gt; subjectCategoryList = subjectCategoryService.queryCategory(subjectCategory);</span><br><span class="line">    List&lt;SubjectCategoryBO&gt; boList = SubjectCategoryConverter.INSTANCE</span><br><span class="line">            .convertBoToCategory(subjectCategoryList);</span><br><span class="line">    <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">        log.info(<span class="string">&quot;SubjectCategoryController.queryPrimaryCategory.boList:&#123;&#125;&quot;</span>,</span><br><span class="line">                JSON.toJSONString(boList));</span><br><span class="line">    &#125;</span><br><span class="line">    boList.forEach(bo -&gt; &#123;</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">subjectCount</span> <span class="operator">=</span> subjectCategoryService.querySubjectCount(bo.getId());</span><br><span class="line">        bo.setCount(subjectCount);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> boList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SubjectCategoryServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;SubjectCategory&gt; <span class="title function_">queryCategory</span><span class="params">(SubjectCategory subjectCategory)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.subjectCategoryDao.queryCategory(subjectCategory);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">querySubjectCount</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.subjectCategoryDao.querySubjectCount(id);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>SubjectCategoryDao.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;querySubjectCount&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;java.lang.Integer&quot;</span>&gt;</span></span><br><span class="line">    select count(distinct subject_id)</span><br><span class="line">    from subject_mapping a,</span><br><span class="line">         subject_label b</span><br><span class="line">    where a.label_id = b.id</span><br><span class="line">    and b.category_id = #&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="6-åˆ†ç±»æ ‡ç­¾æ€§èƒ½ä¼˜åŒ–-star"><a href="#6-åˆ†ç±»æ ‡ç­¾æ€§èƒ½ä¼˜åŒ–-star" class="headerlink" title="6. åˆ†ç±»æ ‡ç­¾æ€§èƒ½ä¼˜åŒ–:star:"></a>6. åˆ†ç±»æ ‡ç­¾æ€§èƒ½ä¼˜åŒ–:star:</h4><p><code>SubjectCategoryDomainServiceImpl.java</code>æ ¸å¿ƒæ˜¯ä½¿ç”¨<code>CompletableFuture</code>å’ŒJavaæµæ¥å¹¶è¡Œå¤„ç†ä»»åŠ¡ï¼š</p><ol><li>å¯¹æ¯ä¸ª<code>category</code>ï¼Œå¯åŠ¨ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡æ¥è·å–æ ‡ç­¾åˆ—è¡¨ï¼Œå¹¶å°†ä»»åŠ¡ç»“æœä»¥<code>CompletableFuture</code>çš„å½¢å¼æ”¶é›†åˆ°åˆ—è¡¨ä¸­ã€‚</li><li>éå†<code>completableFutureList</code>ï¼Œè·å–æ¯ä¸ªä»»åŠ¡çš„ç»“æœï¼Œå¹¶å°†éç©ºç»“æœåˆå¹¶åˆ°<code>map</code>ä¸­ã€‚ <a href="https://blog.csdn.net/qq_45721579/article/details/131384231?ops_request_misc=&request_id=&biz_id=102&utm_term=CompletableFuture.supplyAsync&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-131384231.nonecase&spm=1018.2226.3001.4187">ã€Java 8 æ–°ç‰¹æ€§ã€‘Java CompletableFuture supplyAsync()è¯¦è§£_completablefuture.supplyasync-CSDNåšå®¢</a></li><li>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥å¹¶è¡Œå¤„ç†å¤šä¸ªä»»åŠ¡ï¼Œæé«˜äº†ç¨‹åºçš„æ•ˆç‡ã€‚</li></ol><p><code>SubjectCategoryController.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŸ¥è¯¢åˆ†ç±»åŠæ ‡ç­¾ä¸€æ¬¡æ€§</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/queryCategoryAndLabel&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;List&lt;SubjectCategoryDTO&gt;&gt; <span class="title function_">queryCategoryAndLabel</span><span class="params">(<span class="meta">@RequestBody</span> SubjectCategoryDTO subjectCategoryDTO)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;SubjectCategoryController.queryCategoryAndLabel.dto:&#123;&#125;&quot;</span></span><br><span class="line">                    , JSON.toJSONString(subjectCategoryDTO));</span><br><span class="line">        &#125;</span><br><span class="line">        Preconditions.checkNotNull(subjectCategoryDTO.getId(), <span class="string">&quot;åˆ†ç±»idä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">        <span class="type">SubjectCategoryBO</span> <span class="variable">subjectCategoryBO</span> <span class="operator">=</span> SubjectCategoryDTOConverter.INSTANCE.</span><br><span class="line">                convertDtoToCategoryBO(subjectCategoryDTO);</span><br><span class="line">        List&lt;SubjectCategoryBO&gt; subjectCategoryBOList = subjectCategoryDomainService.queryCategoryAndLabel(subjectCategoryBO); <span class="comment">//æŸ¥ç§ç±»å’Œæ ‡ç­¾</span></span><br><span class="line">        List&lt;SubjectCategoryDTO&gt; dtoList = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        subjectCategoryBOList.forEach(bo -&gt; &#123;</span><br><span class="line">            <span class="type">SubjectCategoryDTO</span> <span class="variable">dto</span> <span class="operator">=</span> SubjectCategoryDTOConverter.INSTANCE.convertBoToCategoryDTO(bo);</span><br><span class="line">            List&lt;SubjectLabelDTO&gt; labelDTOList = SubjectLabelDTOConverter.INSTANCE.convertBOToLabelDTOList(bo.getLabelBOList());</span><br><span class="line">            dto.setLabelDTOList(labelDTOList);</span><br><span class="line">            dtoList.add(dto);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> Result.ok(dtoList);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;SubjectCategoryController.queryPrimaryCategory.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        <span class="keyword">return</span> Result.fail(<span class="string">&quot;æŸ¥è¯¢å¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è‡ªå®šä¹‰çº¿ç¨‹å·¥å‚ï¼š</strong></p><p><code>CustomNameThreadFactory.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥æ‰€éœ€çš„ç±»å’Œæ¥å£ã€‚</span></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ThreadFactory;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.atomic.AtomicInteger;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomNameThreadFactory</span> <span class="keyword">implements</span> <span class="title class_">ThreadFactory</span> &#123;</span><br><span class="line">    <span class="comment">// ç”¨äºç”Ÿæˆçº¿ç¨‹æ± ç¼–å·çš„é™æ€åŸå­ç±»ã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">AtomicInteger</span> <span class="variable">poolNumber</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">// çº¿ç¨‹æ‰€å±çš„çº¿ç¨‹ç»„ã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> ThreadGroup group;</span><br><span class="line">    <span class="comment">// ç”¨äºç”Ÿæˆçº¿ç¨‹ç¼–å·çš„åŸå­ç±»ã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">AtomicInteger</span> <span class="variable">threadNumber</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">// çº¿ç¨‹åç§°çš„å‰ç¼€ã€‚</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String namePrefix;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°æ¥è®¾ç½®çº¿ç¨‹åç§°çš„å‰ç¼€ã€‚</span></span><br><span class="line">    CustomNameThreadFactory(String name) &#123;</span><br><span class="line">        <span class="type">SecurityManager</span> <span class="variable">s</span> <span class="operator">=</span> System.getSecurityManager();</span><br><span class="line">        <span class="comment">// å¦‚æœå­˜åœ¨å®‰å…¨ç®¡ç†å™¨ï¼Œåˆ™ä½¿ç”¨å®‰å…¨ç®¡ç†å™¨çš„çº¿ç¨‹ç»„ï¼Œå¦åˆ™ä½¿ç”¨å½“å‰çº¿ç¨‹çš„çº¿ç¨‹ç»„ã€‚</span></span><br><span class="line">        group = (s != <span class="literal">null</span>) ? s.getThreadGroup() : Thread.currentThread().getThreadGroup();</span><br><span class="line">        <span class="comment">// å¦‚æœä¼ å…¥çš„åç§°ä¸ºç©ºæˆ–ç©ºç™½ï¼Œåˆ™é»˜è®¤ä½¿ç”¨ &quot;pool&quot; ä½œä¸ºåç§°ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isBlank(name)) &#123;</span><br><span class="line">            name = <span class="string">&quot;pool&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ„é€ çº¿ç¨‹åç§°çš„å‰ç¼€ï¼ŒåŒ…æ‹¬çº¿ç¨‹æ± ç¼–å·å’Œ &quot;-thread-&quot;ã€‚</span></span><br><span class="line">        namePrefix = name + <span class="string">&quot;-&quot;</span> + poolNumber.getAndIncrement() + <span class="string">&quot;-thread-&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®ç° ThreadFactory æ¥å£çš„ newThread æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºæ–°çš„çº¿ç¨‹ã€‚</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Thread <span class="title function_">newThread</span><span class="params">(Runnable r)</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹ï¼Œä½¿ç”¨ group ä½œä¸ºçº¿ç¨‹ç»„ï¼Œr ä½œä¸ºè¦æ‰§è¡Œçš„ä»»åŠ¡ã€‚</span></span><br><span class="line">        <span class="type">Thread</span> <span class="variable">t</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(group, r,</span><br><span class="line">                <span class="comment">// çº¿ç¨‹åç§°ç”±å‰ç¼€ã€çº¿ç¨‹ç¼–å·å’Œé€’å¢åçš„ç¼–å·ç»„æˆã€‚</span></span><br><span class="line">                namePrefix + threadNumber.getAndIncrement(),</span><br><span class="line">                <span class="number">0</span>);</span><br><span class="line">        <span class="comment">// å¦‚æœçº¿ç¨‹æ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Œåˆ™å°†å…¶è®¾ç½®ä¸ºéå®ˆæŠ¤çº¿ç¨‹ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (t.isDaemon())&#123;</span><br><span class="line">            t.setDaemon(<span class="literal">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¦‚æœçº¿ç¨‹çš„ä¼˜å…ˆçº§ä¸æ˜¯æ™®é€šä¼˜å…ˆçº§ï¼Œåˆ™å°†å…¶è®¾ç½®ä¸ºæ™®é€šä¼˜å…ˆçº§ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (t.getPriority() != Thread.NORM_PRIORITY)&#123;</span><br><span class="line">            t.setPriority(Thread.NORM_PRIORITY);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è¿”å›æ–°åˆ›å»ºçš„çº¿ç¨‹ã€‚</span></span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SubjectCategoryDomainServiceImpl.java</code></p><p><strong>åˆ›å»ºå¹¶åˆå§‹åŒ–<code>SubjectCategory</code>å¯¹è±¡</strong>ï¼š</p><ul><li>è®¾ç½®<code>ParentId</code>ä¸º<code>categoryId</code>ã€‚</li><li>è®¾ç½®<code>IsDeleted</code>ä¸ºæœªåˆ é™¤çŠ¶æ€ã€‚</li></ul><p><strong>æŸ¥è¯¢ç±»åˆ«åˆ—è¡¨</strong>ï¼š</p><ul><li>è°ƒç”¨<code>subjectCategoryService.queryCategory</code>æ–¹æ³•æŸ¥è¯¢ç±»åˆ«åˆ—è¡¨ã€‚</li></ul><p><strong>æ—¥å¿—è®°å½•</strong>ï¼š</p><ul><li>è®°å½•æŸ¥è¯¢ç»“æœçš„æ—¥å¿—ã€‚</li></ul><p><strong>è½¬æ¢ç±»åˆ«åˆ—è¡¨</strong>ï¼š</p><ul><li>ä½¿ç”¨<code>SubjectCategoryConverter</code>å°†<code>SubjectCategory</code>åˆ—è¡¨è½¬æ¢ä¸º<code>SubjectCategoryBO</code>åˆ—è¡¨ã€‚</li></ul><p><strong>å¹¶è¡Œå¤„ç†æ ‡ç­¾åˆ—è¡¨</strong>ï¼š</p><ul><li>ä¸ºæ¯ä¸ªç±»åˆ«åˆ›å»ºä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ï¼Œè°ƒç”¨<code>getLabelBOList</code>æ–¹æ³•è·å–æ ‡ç­¾åˆ—è¡¨ã€‚</li><li>ä½¿ç”¨<code>CompletableFuture</code>å¹¶è¡Œå¤„ç†è¿™äº›ä»»åŠ¡ã€‚</li></ul><p><strong>æ”¶é›†å¹¶åˆå¹¶ç»“æœ</strong>ï¼š</p><ul><li>ç­‰å¾…æ‰€æœ‰å¼‚æ­¥ä»»åŠ¡å®Œæˆï¼Œå¹¶å°†ç»“æœåˆå¹¶åˆ°ä¸€ä¸ª<code>Map&lt;Long, List&lt;SubjectLabelBO&gt;&gt;</code>ä¸­ã€‚</li></ul><p><strong>è®¾ç½®æ ‡ç­¾åˆ—è¡¨</strong>ï¼š</p><ul><li>ä¸ºæ¯ä¸ª<code>SubjectCategoryBO</code>å¯¹è±¡è®¾ç½®å¯¹åº”çš„æ ‡ç­¾åˆ—è¡¨ã€‚</li></ul><p><strong>è¿”å›ç»“æœ</strong>ï¼š</p><ul><li>è¿”å›åŒ…å«æ ‡ç­¾åˆ—è¡¨çš„<code>SubjectCategoryBO</code>åˆ—è¡¨ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Resource</span></span><br><span class="line"><span class="keyword">private</span> ThreadPoolExecutor labelThreadPool;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SneakyThrows</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;SubjectCategoryBO&gt; <span class="title function_">queryCategoryAndLabel</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span> &#123;</span><br><span class="line">    <span class="type">Long</span> <span class="variable">id</span> <span class="operator">=</span> subjectCategoryBO.getId();</span><br><span class="line">    <span class="type">String</span> <span class="variable">cacheKey</span> <span class="operator">=</span> <span class="string">&quot;categoryAndLabel.&quot;</span> + subjectCategoryBO.getId();</span><br><span class="line">    List&lt;SubjectCategoryBO&gt; subjectCategoryBOS = cacheUtil.getResult(cacheKey,</span><br><span class="line">            SubjectCategoryBO.class, (key) -&gt; getSubjectCategoryBOS(id));</span><br><span class="line">    <span class="keyword">return</span> subjectCategoryBOS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> List&lt;SubjectCategoryBO&gt; <span class="title function_">getSubjectCategoryBOS</span><span class="params">(Long categoryId)</span> &#123;</span><br><span class="line">        <span class="type">SubjectCategory</span> <span class="variable">subjectCategory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectCategory</span>();</span><br><span class="line">        subjectCategory.setParentId(categoryId);</span><br><span class="line">        subjectCategory.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">        List&lt;SubjectCategory&gt; subjectCategoryList = subjectCategoryService.queryCategory(subjectCategory);</span><br><span class="line">        <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;SubjectCategoryController.queryCategoryAndLabel.subjectCategoryList:&#123;&#125;&quot;</span>,</span><br><span class="line">                    JSON.toJSONString(subjectCategoryList));</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;SubjectCategoryBO&gt; categoryBOList = SubjectCategoryConverter.INSTANCE.convertBoToCategory(subjectCategoryList);</span><br><span class="line">        Map&lt;Long, List&lt;SubjectLabelBO&gt;&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        List&lt;CompletableFuture&lt;Map&lt;Long, List&lt;SubjectLabelBO&gt;&gt;&gt;&gt; completableFutureList = categoryBOList.stream().map(category -&gt;</span><br><span class="line">                CompletableFuture.supplyAsync(() -&gt; getLabelBOList(category), labelThreadPool).collect(Collectors.toList()); <span class="comment">//å¯¹äºæ¯ä¸ªcategoryï¼Œè°ƒç”¨å¼‚æ­¥çš„CompletableFuture.supplyAsync()æ‰§è¡ŒgetLabelBOListæ–¹æ³•å’ŒThreadPoolExecutorä½œä¸ºExecutorå»å¤šçº¿ç¨‹+å¼‚æ­¥çš„è·å–labelBOList</span></span><br><span class="line">        completableFutureList.forEach(future -&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Map&lt;Long, List&lt;SubjectLabelBO&gt;&gt; resultMap = future.get();</span><br><span class="line">                <span class="keyword">if</span> (!MapUtils.isEmpty(resultMap)) &#123;</span><br><span class="line">                    map.putAll(resultMap);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        categoryBOList.forEach(categoryBO -&gt; &#123;</span><br><span class="line">            <span class="keyword">if</span> (!CollectionUtils.isEmpty(map.get(categoryBO.getId()))) &#123;</span><br><span class="line">                categoryBO.setLabelBOList(map.get(categoryBO.getId()));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> categoryBOList;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//é€šè¿‡CategoryæŸ¥æ‰¾å¯¹åº”çš„labelList</span></span><br><span class="line"><span class="keyword">private</span> Map&lt;Long, List&lt;SubjectLabelBO&gt;&gt; <span class="title function_">getLabelBOList</span><span class="params">(SubjectCategoryBO category)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;getLabelBOList:&#123;&#125;&quot;</span>, JSON.toJSONString(category));</span><br><span class="line">        &#125;</span><br><span class="line">        Map&lt;Long, List&lt;SubjectLabelBO&gt;&gt; labelMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="type">SubjectMapping</span> <span class="variable">subjectMapping</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectMapping</span>();</span><br><span class="line">        subjectMapping.setCategoryId(category.getId());</span><br><span class="line">        List&lt;SubjectMapping&gt; mappingList = subjectMappingService.queryLabelId(subjectMapping);</span><br><span class="line">        <span class="keyword">if</span> (CollectionUtils.isEmpty(mappingList)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;Long&gt; labelIdList = mappingList.stream().map(SubjectMapping::getLabelId).collect(Collectors.toList());</span><br><span class="line">        List&lt;SubjectLabel&gt; labelList = subjectLabelService.batchQueryById(labelIdList);</span><br><span class="line">        List&lt;SubjectLabelBO&gt; labelBOList = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        labelList.forEach(label -&gt; &#123;</span><br><span class="line">            <span class="type">SubjectLabelBO</span> <span class="variable">subjectLabelBO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectLabelBO</span>();</span><br><span class="line">            subjectLabelBO.setId(label.getId());</span><br><span class="line">            subjectLabelBO.setLabelName(label.getLabelName());</span><br><span class="line">            subjectLabelBO.setCategoryId(label.getCategoryId());</span><br><span class="line">            subjectLabelBO.setSortNum(label.getSortNum());</span><br><span class="line">            labelBOList.add(subjectLabelBO);</span><br><span class="line">        &#125;);</span><br><span class="line">        labelMap.put(category.getId(), labelBOList);</span><br><span class="line">        <span class="keyword">return</span> labelMap;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç çš„æ ¸å¿ƒæ˜¯ä½¿ç”¨<code>CompletableFuture</code>å’ŒJavaæµæ¥å¹¶è¡Œå¤„ç†ä»»åŠ¡ï¼š</p><ol><li>å¯¹æ¯ä¸ª<code>category</code>ï¼Œå¯åŠ¨ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡æ¥è·å–æ ‡ç­¾åˆ—è¡¨ï¼Œå¹¶å°†ä»»åŠ¡ç»“æœä»¥<code>CompletableFuture</code>çš„å½¢å¼æ”¶é›†åˆ°åˆ—è¡¨ä¸­ã€‚</li><li>éå†<code>completableFutureList</code>ï¼Œè·å–æ¯ä¸ªä»»åŠ¡çš„ç»“æœï¼Œå¹¶å°†éç©ºç»“æœåˆå¹¶åˆ°<code>map</code>ä¸­ã€‚ <a href="https://blog.csdn.net/qq_45721579/article/details/131384231?ops_request_misc=&request_id=&biz_id=102&utm_term=CompletableFuture.supplyAsync&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-131384231.nonecase&spm=1018.2226.3001.4187">ã€Java 8 æ–°ç‰¹æ€§ã€‘Java CompletableFuture supplyAsync()è¯¦è§£_completablefuture.supplyasync-CSDNåšå®¢</a></li><li>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥å¹¶è¡Œå¤„ç†å¤šä¸ªä»»åŠ¡ï¼Œæé«˜äº†ç¨‹åºçš„æ•ˆç‡ã€‚</li></ol><h4 id="7-ç”¨æˆ·æƒé™è·å–"><a href="#7-ç”¨æˆ·æƒé™è·å–" class="headerlink" title="7. ç”¨æˆ·æƒé™è·å–"></a>7. ç”¨æˆ·æƒé™è·å–</h4><p><code>AuthPermissionDomainServiceImpl.java</code></p><p>å°†å­˜å‚¨åœ¨Redisä¸­çš„æƒé™æ•°æ®è½¬æ¢ä¸ºä¸€ä¸ªæ˜“äºä½¿ç”¨çš„æƒé™é”®åˆ—è¡¨ï¼Œä»¥ä¾¿åœ¨åº”ç”¨ç¨‹åºä¸­è¿›è¡Œæƒé™æ£€æŸ¥ã€‚å¦‚æœRedisä¸­æ²¡æœ‰æ‰¾åˆ°ç”¨æˆ·çš„æƒé™æ•°æ®ï¼Œåˆ™è¿”å›ä¸€ä¸ªç©ºåˆ—è¡¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getPermission</span><span class="params">(String userName)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">permissionKey</span> <span class="operator">=</span> redisUtil.buildKey(authPermissionPrefix, userName);</span><br><span class="line">    <span class="type">String</span> <span class="variable">permissionValue</span> <span class="operator">=</span> redisUtil.get(permissionKey);</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(permissionValue)) &#123;</span><br><span class="line">        <span class="keyword">return</span> Collections.emptyList();</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;AuthPermission&gt; permissionList = <span class="keyword">new</span> <span class="title class_">Gson</span>().fromJson(permissionValue,</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">TypeToken</span>&lt;List&lt;AuthPermission&gt;&gt;() &#123;</span><br><span class="line">            &#125;.getType()); <span class="comment">//ä½¿ç”¨Googleçš„Gsonåº“å°†æƒé™å­—ç¬¦ä¸²ååºåˆ—åŒ–ä¸ºAuthPermissionå¯¹è±¡çš„åˆ—è¡¨ã€‚TypeTokenç”¨äºæŒ‡å®šæ³›å‹ç±»å‹ã€‚</span></span><br><span class="line">    List&lt;String&gt; authList = permissionList.stream().map(AuthPermission::getPermissionKey).collect(Collectors.toList());</span><br><span class="line">    <span class="keyword">return</span> authList; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="8-åˆ©ç”¨minio-mcçªç ´å›¾ç‰‡7å¤©æƒé™"><a href="#8-åˆ©ç”¨minio-mcçªç ´å›¾ç‰‡7å¤©æƒé™" class="headerlink" title="8. åˆ©ç”¨minio&#x2F;mcçªç ´å›¾ç‰‡7å¤©æƒé™"></a>8. åˆ©ç”¨minio&#x2F;mcçªç ´å›¾ç‰‡7å¤©æƒé™</h4><p><img src="https://s2.loli.net/2024/08/06/iTOqVzkRdl74BUm.jpg" alt="93d2be17b7b8562a08d456c5484f684.jpg"></p><p>æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li>minioä¸Šä¼ å¤´åƒåªèƒ½ä¿å­˜7å¤©</li><li>ç”Ÿæˆçš„urlå¾ˆé•¿ï¼Œéœ€è¦ç®€åŒ–</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">docker pull minio/mc</span><br><span class="line"></span><br><span class="line">docker run -it --entrypoint=/bin/sh minio/mc</span><br><span class="line"></span><br><span class="line">mc config host add &lt;ALIAS&gt; &lt;YOUR-S3-ENDPOINT&gt; &lt;YOUR-ACCESS-KEY&gt; &lt;YOUR-SECRET-KEY&gt; [--api API-SIGNATURE]</span><br><span class="line"></span><br><span class="line">mc config host add minio http://xxx.xx.xx.xxx:9000 GrVCPXySKgGoJiGgXmtv 0xlqSI9GXvnBOtp0GwUj5OshKNBk9JgwoexotbVV</span><br><span class="line"></span><br><span class="line">mc ls minio</span><br><span class="line"></span><br><span class="line">mc anonymous //å¯ä»¥è®¾ç½®ä»€ä¹ˆ</span><br><span class="line"></span><br><span class="line">mc anonymous set download minio/jichi</span><br></pre></td></tr></table></figure><p>url: bucket+name</p><p><code>FileController.java</code></p><p><img src="https://s2.loli.net/2024/08/06/QEXLm8GRkTVxA9D.png" alt="image-20240806154518945.png"></p><p><code>MinioStorageAdapter.java</code></p><p><img src="https://s2.loli.net/2024/08/06/XORypnF7lIDZNE1.png" alt="image-20240806154356089.png"></p><p><code>FileController.java</code></p><p><img src="https://s2.loli.net/2024/08/06/jVz5AyCNiQKt9EG.png" alt="image-20240806154533525.png"></p><p><code>MinioStorageAdapter.java</code></p><p><img src="https://s2.loli.net/2024/08/06/1F5kzqREVeBYw4m.png" alt="image-20240806154622450.png"></p><h3 id="åŠŸèƒ½è§„åˆ’"><a href="#åŠŸèƒ½è§„åˆ’" class="headerlink" title="åŠŸèƒ½è§„åˆ’"></a>åŠŸèƒ½è§„åˆ’</h3><h4 id="æœç´¢åŠŸèƒ½ï¼ˆå®Œæˆï¼‰"><a href="#æœç´¢åŠŸèƒ½ï¼ˆå®Œæˆï¼‰" class="headerlink" title="æœç´¢åŠŸèƒ½ï¼ˆå®Œæˆï¼‰"></a>æœç´¢åŠŸèƒ½ï¼ˆå®Œæˆï¼‰</h4><p>å…¨æ–‡æ£€ç´¢ï¼ŒæŠ€æœ¯é€‰å‹ esã€‚</p><p>å®‰è£… esã€‚</p><p>xxl-job å®šæ—¶ä»»åŠ¡ï¼Œå»åšä¸€ä¸ªæ•°æ®åŒæ­¥ï¼Œå…¨é‡æ•°æ®å¯¼å…¥</p><p>es å…¨æ–‡æ£€ç´¢ï¼Œåšé«˜äº®</p><h4 id="ç‚¹èµï¼ˆå®Œæˆï¼‰"><a href="#ç‚¹èµï¼ˆå®Œæˆï¼‰" class="headerlink" title="ç‚¹èµï¼ˆå®Œæˆï¼‰"></a>ç‚¹èµï¼ˆå®Œæˆï¼‰</h4><p>è‡ªå·±ç‚¹èµè¿‡çš„ï¼Œè¿™é‡Œè‚¯å®šè¦æœ‰ä¸€ä¸ªç‚¹èµè¿‡çš„ icon çš„ä¸€ä¸ªæ ‡è¯†</p><p>åé¢çš„æ•°é‡ï¼Œæ„å‘³ç€è¿™é“é¢˜ç›®è¢«å¤šå°‘ä¸ªäººç‚¹è¿‡èµã€‚</p><p>å¦‚ä½•å»é˜²åˆ·ç‚¹èµã€‚ç–¯ç‹‚çš„ç‚¹èµï¼Œå–æ¶ˆç‚¹èµã€‚å‰ç«¯é…åˆé˜²æŠ–ï¼Œåç«¯çš„ç‚¹èµæ•°é‡æ”¾åˆ° redis é‡Œé¢ã€‚æ•°æ®åº“çš„æŒä¹…åŒ–ï¼Œå¯ä»¥é€šè¿‡å®šæ—¶ä»»åŠ¡æ¥å®šæ—¶çš„åˆ·æ–°åŒæ­¥ã€‚</p><p><img src="https://s2.loli.net/2024/08/03/gHmp6AnyT9C8jsZ.png" alt="image-20240803193709660.png"></p><h4 id="æˆ‘çš„ç‚¹èµï¼ˆå®Œæˆï¼‰"><a href="#æˆ‘çš„ç‚¹èµï¼ˆå®Œæˆï¼‰" class="headerlink" title="æˆ‘çš„ç‚¹èµï¼ˆå®Œæˆï¼‰"></a>æˆ‘çš„ç‚¹èµï¼ˆå®Œæˆï¼‰</h4><p>å±•ç¤ºï¼Œæˆ‘ä»¬å½“å‰å½“è¿‡èµçš„æ‰€æœ‰çš„æ•°æ®ï¼Œæ¥è¿›è¡Œä¸€æ³¢å±•ç¤ºã€‚</p><p><img src="https://s2.loli.net/2024/08/03/wI1p4UvNideb9cR.png" alt="image-20240803193658610.png"></p><h4 id="æ”¶è—ï¼ˆå®Œæˆï¼‰"><a href="#æ”¶è—ï¼ˆå®Œæˆï¼‰" class="headerlink" title="æ”¶è—ï¼ˆå®Œæˆï¼‰"></a>æ”¶è—ï¼ˆå®Œæˆï¼‰</h4><p><img src="https://s2.loli.net/2024/08/03/eUzZPhtopQYduEB.png" alt="image-20240803193734357.png"></p><h4 id="æˆ‘çš„æ”¶è—ï¼ˆå®Œæˆï¼‰"><a href="#æˆ‘çš„æ”¶è—ï¼ˆå®Œæˆï¼‰" class="headerlink" title="æˆ‘çš„æ”¶è—ï¼ˆå®Œæˆï¼‰"></a>æˆ‘çš„æ”¶è—ï¼ˆå®Œæˆï¼‰</h4><p><img src="https://s2.loli.net/2024/08/03/ChN7JM9nvoSWVbL.png" alt="image-20240803193755102.png"></p><h4 id="çº é”™ï¼ˆå®Œæˆï¼‰"><a href="#çº é”™ï¼ˆå®Œæˆï¼‰" class="headerlink" title="çº é”™ï¼ˆå®Œæˆï¼‰"></a>çº é”™ï¼ˆå®Œæˆï¼‰</h4><p>çº é”™å½“ç”¨æˆ·å‘ç°é¢˜ç›®æœ‰é—®é¢˜ï¼Œé”™è¯¯çš„è¯ï¼Œå°±å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹å¼ï¼Œæ¥è¿›è¡Œåé¦ˆã€‚</p><p><img src="https://s2.loli.net/2024/08/03/BNAG4PQK8wgXjxV.png" alt="image-20240803193910438.png"></p><h4 id="å¿«é€Ÿåˆ·é¢˜ï¼ˆå®Œæˆï¼‰"><a href="#å¿«é€Ÿåˆ·é¢˜ï¼ˆå®Œæˆï¼‰" class="headerlink" title="å¿«é€Ÿåˆ·é¢˜ï¼ˆå®Œæˆï¼‰"></a>å¿«é€Ÿåˆ·é¢˜ï¼ˆå®Œæˆï¼‰</h4><p><img src="https://s2.loli.net/2024/08/03/CzO3mXaAthjT6cF.png" alt="image-20240803193936006.png"></p><p>åœ¨è¿™ä¸ªä½ç½®å»åŠ ä¸€ä¸ªä¸Šä¸€é¢˜ï¼Œä¸‹ä¸€é¢˜ã€‚</p><h4 id="è´¡çŒ®æ¦œï¼ˆå®Œæˆï¼‰"><a href="#è´¡çŒ®æ¦œï¼ˆå®Œæˆï¼‰" class="headerlink" title="è´¡çŒ®æ¦œï¼ˆå®Œæˆï¼‰"></a>è´¡çŒ®æ¦œï¼ˆå®Œæˆï¼‰</h4><p>æŒ‰ç…§æˆ‘çš„å‘¨ç»´åº¦ï¼Œæœˆç»´åº¦ï¼Œæ¥åšæ•°æ®çš„å­˜å‚¨ã€‚zsetã€‚å’Œ redis åšå¤§é‡çš„äº¤äº’ã€‚</p><h4 id="feign-çš„å¾®æœåŠ¡é—´è°ƒç”¨ï¼ˆå®Œæˆï¼‰"><a href="#feign-çš„å¾®æœåŠ¡é—´è°ƒç”¨ï¼ˆå®Œæˆï¼‰" class="headerlink" title="feign çš„å¾®æœåŠ¡é—´è°ƒç”¨ï¼ˆå®Œæˆï¼‰"></a>feign çš„å¾®æœåŠ¡é—´è°ƒç”¨ï¼ˆå®Œæˆï¼‰</h4><p>ä¼šæ¶‰åŠåˆ°å¾®æœåŠ¡ä¹‹é—´çš„é€»è¾‘è°ƒç”¨ã€‚è¿™ä¸ªå°±ç”¨ feign äº†ã€‚</p><h4 id="æ‰“é€šç”¨æˆ·ä¸Šä¸‹æ–‡ï¼ˆå®Œæˆï¼‰"><a href="#æ‰“é€šç”¨æˆ·ä¸Šä¸‹æ–‡ï¼ˆå®Œæˆï¼‰" class="headerlink" title="æ‰“é€šç”¨æˆ·ä¸Šä¸‹æ–‡ï¼ˆå®Œæˆï¼‰"></a>æ‰“é€šç”¨æˆ·ä¸Šä¸‹æ–‡ï¼ˆå®Œæˆï¼‰</h4><p>é…åˆ threadlocalï¼ŒåŸºäº token æ¥å®ç°ç”¨æˆ·ä¿¡æ¯çš„ä¸Šä¸‹æ–‡ä¼ é€’ã€‚</p><h4 id="äºŒçº§ç¼“å­˜çš„ä½¿ç”¨ï¼ˆå®Œæˆï¼‰"><a href="#äºŒçº§ç¼“å­˜çš„ä½¿ç”¨ï¼ˆå®Œæˆï¼‰" class="headerlink" title="äºŒçº§ç¼“å­˜çš„ä½¿ç”¨ï¼ˆå®Œæˆï¼‰"></a>äºŒçº§ç¼“å­˜çš„ä½¿ç”¨ï¼ˆå®Œæˆï¼‰</h4><p>ç‚¹èµé‡Œé¢ã€‚</p><h3 id="ç”¨æˆ·ä¸Šä¸‹æ–‡æ‰“é€š"><a href="#ç”¨æˆ·ä¸Šä¸‹æ–‡æ‰“é€š" class="headerlink" title="ç”¨æˆ·ä¸Šä¸‹æ–‡æ‰“é€š"></a>ç”¨æˆ·ä¸Šä¸‹æ–‡æ‰“é€š</h3><p>é“¾è·¯æµç¨‹ï¼š</p><p><img src="https://s2.loli.net/2024/08/12/jRBZS5OvlwY3xzC.png" alt="image-20240812140358717.png"></p><p>è¯¦ç»†è®¾è®¡ï¼š</p><p><img src="https://s2.loli.net/2024/08/12/6veaby7irSgQWqo.png" alt="image-20240812140516313.png"></p><p><code>Loginfilter</code>(å®ç°<code>Globalfilteræ¥å£</code>ï¼Œé€šè¿‡filteræ‹¿åˆ°tokenï¼Œè§£æå‡º<strong>loginId</strong>ï¼Œç„¶åä¼ åˆ°åé¢çš„è¿‡æ»¤é“¾ä¸­)</p><p>-&gt;<code>LoginInterceptor</code>(å®ç°<code>HandlerInterceptor</code>ï¼Œæ£€éªŒ<strong>loginId</strong>æ˜¯å¦å­˜åœ¨ä¸”éç©ºï¼Œå¦‚æœå­˜åœ¨ï¼Œå°†å…¶ä¿å­˜åˆ°è‡ªå®šä¹‰çš„çº¿ç¨‹å±€éƒ¨å˜é‡ä¸Šä¸‹æ–‡<code>LoginContextHolder</code>ä¸­ï¼Œé€šè¿‡<code>InheritableThreadLocal</code>æ¥å®ç°)</p><p>ä»¥ä¸Šéƒ½ä¸æ‹¦æˆªdoLoginæ“ä½œ</p><h4 id="gatewayç½‘å…³è‡ªå®šä¹‰æ‹¦æˆªheader"><a href="#gatewayç½‘å…³è‡ªå®šä¹‰æ‹¦æˆªheader" class="headerlink" title="gatewayç½‘å…³è‡ªå®šä¹‰æ‹¦æˆªheader"></a>gatewayç½‘å…³è‡ªå®šä¹‰æ‹¦æˆªheader</h4><p><code>LoginFilter.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¼•å…¥Springç»„ä»¶æ³¨è§£ï¼Œæ ‡è¯†è¿™æ˜¯ä¸€ä¸ªSpringç»„ä»¶</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨lombokçš„@Slf4jæ³¨è§£è‡ªåŠ¨ä¸ºç±»ç”Ÿæˆæ—¥å¿—å¯¹è±¡</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginFilter</span> <span class="keyword">implements</span> <span class="title class_">GlobalFilter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®ç°GlobalFilteræ¥å£çš„filteræ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šåœ¨è¯·æ±‚è¢«è·¯ç”±ä¹‹å‰è°ƒç”¨</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">// ä½¿ç”¨@SneakyThrowsæ³¨è§£æ¥é¿å…æ˜¾å¼å£°æ˜å¼‚å¸¸ï¼Œç®€åŒ–ä»£ç </span></span><br><span class="line">    <span class="meta">@SneakyThrows</span></span><br><span class="line">    <span class="keyword">public</span> Mono&lt;Void&gt; <span class="title function_">filter</span><span class="params">(ServerWebExchange exchange, GatewayFilterChain chain)</span> &#123;</span><br><span class="line">        <span class="comment">// è·å–è¯·æ±‚å’Œå“åº”å¯¹è±¡</span></span><br><span class="line">        <span class="type">ServerHttpRequest</span> <span class="variable">request</span> <span class="operator">=</span> exchange.getRequest();</span><br><span class="line">        <span class="type">ServerHttpResponse</span> <span class="variable">response</span> <span class="operator">=</span> exchange.getResponse();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆ›å»ºè¯·æ±‚çš„æ„å»ºå™¨ï¼Œç”¨äºä¿®æ”¹è¯·æ±‚å¤´ä¿¡æ¯</span></span><br><span class="line">        ServerHttpRequest.<span class="type">Builder</span> <span class="variable">mutate</span> <span class="operator">=</span> request.mutate();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è·å–è¯·æ±‚çš„URLè·¯å¾„</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> request.getURI().getPath();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®°å½•è¯·æ±‚çš„URLåˆ°æ—¥å¿—</span></span><br><span class="line">        log.info(<span class="string">&quot;LoginFilter.filter.url:&#123;&#125;&quot;</span>, url);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å¦‚æœè¯·æ±‚çš„URLæ˜¯&quot;/user/doLogin&quot;ï¼Œåˆ™ç›´æ¥æ”¾è¡Œï¼Œä¸è¿›è¡Œæ‹¦æˆª</span></span><br><span class="line">        <span class="keyword">if</span> (url.equals(<span class="string">&quot;/user/doLogin&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> chain.filter(exchange);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å°è¯•è·å–å½“å‰è¯·æ±‚çš„tokenä¿¡æ¯ï¼Œè¿™é‡Œä½¿ç”¨äº†SaTokenæ¡†æ¶</span></span><br><span class="line">        <span class="type">SaTokenInfo</span> <span class="variable">tokenInfo</span> <span class="operator">=</span> StpUtil.getTokenInfo();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å°†tokenä¿¡æ¯è®°å½•åˆ°æ—¥å¿—ä¸­ï¼Œè¿™é‡Œä½¿ç”¨äº†Gsonåº“æ¥å°†å¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²</span></span><br><span class="line">        log.info(<span class="string">&quot;LoginFilter.filter.url:&#123;&#125;&quot;</span>, <span class="keyword">new</span> <span class="title class_">Gson</span>().toJson(tokenInfo));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä»tokenä¿¡æ¯ä¸­è·å–ç™»å½•ç”¨æˆ·çš„ID</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">loginId</span> <span class="operator">=</span> (String) tokenInfo.getLoginId();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å°†ç™»å½•ç”¨æˆ·çš„IDæ·»åŠ åˆ°è¯·æ±‚å¤´ä¸­</span></span><br><span class="line">        mutate.header(<span class="string">&quot;loginId&quot;</span>, loginId);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å°†ä¿®æ”¹åçš„è¯·æ±‚å’ŒåŸå§‹çš„å“åº”ä»¥åŠè¿‡æ»¤å™¨é“¾ä¸€èµ·æ„å»ºæˆä¸€ä¸ªæ–°çš„ServerWebExchangeå¯¹è±¡</span></span><br><span class="line">        <span class="comment">// å¹¶è°ƒç”¨chain.filteræ–¹æ³•ç»§ç»­è¿‡æ»¤é“¾çš„æ‰§è¡Œ</span></span><br><span class="line">        <span class="keyword">return</span> chain.filter(exchange.mutate().request(mutate.build()).build());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡filteræ‹¿åˆ°tokenï¼Œè§£æå‡ºloginIdï¼Œç„¶åä¼ åˆ°åé¢çš„è¿‡æ»¤é“¾ä¸­ã€‚</p><h4 id="åŸºäºthreadLocalå®ç°ä¸Šä¸‹æ–‡ä¼ é€’"><a href="#åŸºäºthreadLocalå®ç°ä¸Šä¸‹æ–‡ä¼ é€’" class="headerlink" title="åŸºäºthreadLocalå®ç°ä¸Šä¸‹æ–‡ä¼ é€’"></a>åŸºäºthreadLocalå®ç°ä¸Šä¸‹æ–‡ä¼ é€’</h4><p>mvcçš„å…¨å±€å¤„ç†ï¼š<code>GlobalConfig.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ‡è®°è¿™ä¸ªç±»æ˜¯ä¸€ä¸ªSpringé…ç½®ç±»</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalConfig</span> <span class="keyword">extends</span> <span class="title class_">WebMvcConfigurationSupport</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¦†ç›–configureMessageConvertersæ–¹æ³•æ¥æ·»åŠ è‡ªå®šä¹‰çš„æ¶ˆæ¯è½¬æ¢å™¨</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">configureMessageConverters</span><span class="params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters)</span> &#123;</span><br><span class="line">        <span class="comment">// é¦–å…ˆè°ƒç”¨çˆ¶ç±»çš„configureMessageConvertersæ–¹æ³•</span></span><br><span class="line">        <span class="built_in">super</span>.configureMessageConverters(converters);</span><br><span class="line">        <span class="comment">// æ·»åŠ ä¸€ä¸ªMappingJackson2HttpMessageConverteråˆ°è½¬æ¢å™¨åˆ—è¡¨ä¸­</span></span><br><span class="line">        converters.add(mappingJackson2HttpMessageConverter());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¦†ç›–addInterceptorsæ–¹æ³•æ¥æ·»åŠ è‡ªå®šä¹‰çš„æ‹¦æˆªå™¨</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        <span class="comment">// æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰çš„æ‹¦æˆªå™¨LoginInterceptor</span></span><br><span class="line">        registry.addInterceptor(<span class="keyword">new</span> <span class="title class_">LoginInterceptor</span>())</span><br><span class="line">                <span class="comment">// æ‹¦æˆªæ‰€æœ‰è·¯å¾„</span></span><br><span class="line">                .addPathPatterns(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">                <span class="comment">// æ’é™¤/user/doLoginè·¯å¾„ï¼Œä¸å¯¹ç™»å½•è¯·æ±‚è¿›è¡Œæ‹¦æˆª</span></span><br><span class="line">                .excludePathPatterns(<span class="string">&quot;/user/doLogin&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è‡ªå®šä¹‰çš„MappingJackson2HttpMessageConverterå®ç°</span></span><br><span class="line"><span class="comment">     * ç›®å‰å®ç°çš„åŠŸèƒ½ï¼š</span></span><br><span class="line"><span class="comment">     * - å¿½ç•¥ç©ºå€¼ï¼Œå³ä½¿å¯¹è±¡çš„å­—æ®µä¸ºnullä¹Ÿä¸ä¼šåœ¨JSONä¸­å‡ºç°</span></span><br><span class="line"><span class="comment">     * - åªåºåˆ—åŒ–éç©ºå­—æ®µï¼Œç©ºå­—æ®µä¸ä¼šè¢«åºåˆ—åŒ–åˆ°JSONä¸­</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> MappingJackson2HttpMessageConverter <span class="title function_">mappingJackson2HttpMessageConverter</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºObjectMapperå®ä¾‹</span></span><br><span class="line">        <span class="type">ObjectMapper</span> <span class="variable">objectMapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">        <span class="comment">// é…ç½®ObjectMapperï¼Œå½“å¯¹è±¡çš„å­—æ®µä¸ºnullæ—¶ä¸æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">        objectMapper.configure(SerializationFeature.FAIL_ON_EMPTY_BEANS, <span class="literal">false</span>);</span><br><span class="line">        <span class="comment">// è®¾ç½®åºåˆ—åŒ–æ—¶åŒ…å«éç©ºå­—æ®µ</span></span><br><span class="line">        objectMapper.setSerializationInclusion(JsonInclude.Include.NON_NULL);</span><br><span class="line">        <span class="comment">// åˆ›å»ºMappingJackson2HttpMessageConverterå¹¶ä½¿ç”¨è‡ªå®šä¹‰çš„ObjectMapper</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MappingJackson2HttpMessageConverter</span>(objectMapper);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç™»å½•æ‹¦æˆªå™¨ï¼š<code>LoginInterceptor.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åœ¨è¯·æ±‚å¤„ç†ä¹‹å‰æ‰§è¡Œçš„æ–¹æ³•</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// ä»è¯·æ±‚å¤´ä¸­è·å–loginId</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">loginId</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;loginId&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆ¤æ–­loginIdæ˜¯å¦å­˜åœ¨ä¸”éç©º</span></span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(loginId)) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœå­˜åœ¨ï¼Œå°†å…¶ä¿å­˜åˆ°è‡ªå®šä¹‰çš„çº¿ç¨‹å±€éƒ¨å˜é‡ä¸Šä¸‹æ–‡LoginContextHolderä¸­</span></span><br><span class="line">            LoginContextHolder.set(<span class="string">&quot;loginId&quot;</span>, loginId);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è¿”å›trueè¡¨ç¤ºç»§ç»­æ‰§è¡Œæ‹¦æˆªå™¨é“¾ä¸­çš„ä¸‹ä¸€ä¸ªæ‹¦æˆªå™¨æˆ–å¤„ç†å™¨</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¯·æ±‚å¤„ç†å®Œæˆåæ‰§è¡Œçš„æ–¹æ³•</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, <span class="meta">@Nullable</span> Exception ex)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">// ä»ä¸Šä¸‹æ–‡ä¸­ç§»é™¤loginIdï¼Œæ¸…ç†çº¿ç¨‹å±€éƒ¨å˜é‡</span></span><br><span class="line">        LoginContextHolder.remove();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç™»å½•ä¸Šä¸‹æ–‡å¯¹è±¡: <code>LoginContextHolder</code></p><p><a href="https://blog.csdn.net/yexiguafu/article/details/103900568?ops_request_misc=%7B%22request_id%22:%22172344903416800207094300%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172344903416800207094300&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-103900568-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=inheritablethreadlocal&spm=1018.2226.3001.4187">InheritableThreadLocalè¯¦è§£-CSDNåšå®¢</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginContextHolder</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨InheritableThreadLocalæ¥åˆ›å»ºçº¿ç¨‹å±€éƒ¨å˜é‡ï¼Œå…è®¸å­çº¿ç¨‹ç»§æ‰¿çˆ¶çº¿ç¨‹çš„å€¼</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> InheritableThreadLocal&lt;Map&lt;String, Object&gt;&gt; THREAD_LOCAL =</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">InheritableThreadLocal</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å°†é”®å€¼å¯¹æ”¾å…¥çº¿ç¨‹å±€éƒ¨å˜é‡ä¸­</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(String key, Object val)</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; map = getThreadLocalMap();</span><br><span class="line">        map.put(key, val);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ¹æ®é”®ä»çº¿ç¨‹å±€éƒ¨å˜é‡ä¸­è·å–å€¼</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">get</span><span class="params">(String key)</span>&#123;</span><br><span class="line">        Map&lt;String, Object&gt; threadLocalMap = getThreadLocalMap();</span><br><span class="line">        <span class="keyword">return</span> threadLocalMap.get(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä¸“é—¨ç”¨äºè·å–loginIdçš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getLoginId</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (String) getThreadLocalMap().get(<span class="string">&quot;loginId&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ¸…é™¤çº¿ç¨‹å±€éƒ¨å˜é‡ä¸­çš„æ‰€æœ‰æ•°æ®</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">()</span>&#123;</span><br><span class="line">        THREAD_LOCAL.remove();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–çº¿ç¨‹å±€éƒ¨å˜é‡ä¸­å­˜å‚¨çš„Mapï¼Œå¦‚æœMapä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„Map</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title function_">getThreadLocalMap</span><span class="params">()</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; map = THREAD_LOCAL.get();</span><br><span class="line">        <span class="keyword">if</span> (Objects.isNull(map)) &#123;</span><br><span class="line">            map = <span class="keyword">new</span> <span class="title class_">ConcurrentHashMap</span>&lt;&gt;(); <span class="comment">// ä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„ConcurrentHashMap</span></span><br><span class="line">            THREAD_LOCAL.set(map);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> map;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¹‹åå°±å¯ä»¥æ ¹æ®è¿™ä¸ªä¸Šä¸‹æ–‡ï¼Œå°è£…ä¸€ä¸‹ï¼Œå»æ‹¿loginId</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getLoginId</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> LoginContextHolder.getLoginId();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¾®æœåŠ¡ä¹‹é—´çš„Feignè°ƒç”¨"><a href="#å¾®æœåŠ¡ä¹‹é—´çš„Feignè°ƒç”¨" class="headerlink" title="å¾®æœåŠ¡ä¹‹é—´çš„Feignè°ƒç”¨"></a>å¾®æœåŠ¡ä¹‹é—´çš„Feignè°ƒç”¨</h4><p><strong>å¾®æœåŠ¡ä¹‹é—´çš„è°ƒç”¨</strong></p><p>openfeign æ˜¯ spring cloud æå‡ºæ¥çš„ä¸€ä¸ªå‡çº§ç‰ˆï¼Œnetflix çš„ feign è¿™ä¸ªä¸ç»´æŠ¤äº†ã€‚</p><p>openfeign ä»–å°±æ˜¯å£°æ˜å¼çš„ webservice çš„å®¢æˆ·ç«¯ï¼Œä½¿ç”¨ feignï¼Œç¼–å†™è°ƒç”¨æ›´åŠ çš„ç®€å•ï¼Œä¸»è¦æ‰“ä¸Šæ³¨è§£å°±å¯ä»¥è¿›è¡Œä¸€ä¸ªè°ƒç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">responese</span> <span class="operator">=</span> service.hello();</span><br></pre></td></tr></table></figure><p>ä¸€è¡Œä»£ç ç›´æ¥æå®šã€‚</p><p>feign å°±å¸®åŠ©æˆ‘ä»¬æŠŠ http çš„è°ƒç”¨ç¼–çš„éå¸¸çš„å®¹æ˜“å’Œæ–¹ä¾¿ï¼Œä»–æ•´ä½“çš„å®ç°å°±æ˜¯åˆ©ç”¨äº† resttemplate å¯¹ http çš„ä¸€ä¸ªå°è£…ã€‚</p><p>feign é€šè¿‡æ³¨è§£çš„æ–¹å¼é…ç½®ä¹‹åï¼Œå°±å¯ä»¥å®Œæˆæ¥å£çš„è‡ªåŠ¨ç»‘å®šï¼Œé‚£æˆ‘ä»¬è°ƒç”¨ feign çš„æ—¶å€™å°±åƒè°ƒæ¥å£ä¸€æ ·ï¼Œå†…ç½®è´Ÿè½½ã€‚å†…éƒ¨å°è£…äº† ribbonã€‚</p><p><strong>å®æ“ï¼š</strong></p><p>é¦–å…ˆï¼Œå¾®æœåŠ¡ä¹‹é—´è¦æš´éœ²å‡ºæä¾›ç»™å…¶ä»–æœåŠ¡çš„æ¥å£ã€‚åœ¨è¿™é‡Œä»¥<code>auth</code>åŒ…ä¸­çš„æ¥å£æš´éœ²ç»™<code>subject</code>åŒ…çš„æ¥å£ä¸ºä¾‹ã€‚</p><p><strong>auth:</strong></p><p><code>jc-club-auth-api</code>åŒ…ä¸­çš„<code>UserFeignService</code>æ¥å£ï¼Œè¿™é‡Œæ³¨æ„<code>@FeignClient</code>æ³¨è§£åé¢çš„<code>&quot;jc-club-auth-dev&quot;</code>å®åˆ™æ˜¯åœ¨<code>starter</code>åŒ…ä¸­å¯¹åº”çš„<code>bootstrap.yaml</code>ä¸­çš„æœåŠ¡åç§°ï¼ˆè¿™ä¸ªä¸œè¥¿æ˜¯æ³¨å†Œåˆ°nacosä¸Šé¢çš„ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient(&quot;jc-club-auth-dev&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserFeignService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨è¯¥æ¥å£å®åˆ™æ˜¯è°ƒç”¨çš„å¯¹åº”çš„domainService</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/user/getUserInfo&quot;)</span></span><br><span class="line">    Result&lt;AuthUserDTO&gt; <span class="title function_">getUserInfo</span><span class="params">(<span class="meta">@RequestBody</span> AuthUserDTO authUserDTO)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/user/listByIds&quot;)</span></span><br><span class="line">    Result&lt;List&lt;AuthUserDTO&gt;&gt; <span class="title function_">listUserInfoByIds</span><span class="params">(<span class="meta">@RequestBody</span> List&lt;String&gt; userNameList)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¹åº”çš„domainService</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> AuthUserBO <span class="title function_">getUserInfo</span><span class="params">(AuthUserBO authUserBO)</span> &#123;</span><br><span class="line">    <span class="type">AuthUser</span> <span class="variable">authUser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthUser</span>();</span><br><span class="line">    authUser.setUserName(authUserBO.getUserName());</span><br><span class="line">    List&lt;AuthUser&gt; userList = authUserService.queryByCondition(authUser);</span><br><span class="line">    <span class="keyword">if</span> (CollectionUtils.isEmpty(userList)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AuthUserBO</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">AuthUser</span> <span class="variable">user</span> <span class="operator">=</span> userList.get(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> AuthUserBOConverter.INSTANCE.convertEntityToBO(user);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;AuthUserBO&gt; <span class="title function_">listUserInfoByIds</span><span class="params">(List&lt;String&gt; userNameList)</span> &#123;</span><br><span class="line">    List&lt;AuthUser&gt; userList = authUserService.listUserInfoByIds(userNameList);</span><br><span class="line">    <span class="keyword">if</span> (CollectionUtils.isEmpty(userList)) &#123;</span><br><span class="line">        <span class="keyword">return</span> Collections.emptyList();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> AuthUserBOConverter.INSTANCE.convertEntityToBO(userList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨<code>jc-club-auth-application-controller</code>åŒ…ä¸­çš„<code>pom.xml</code>æ–‡ä»¶ä¸­ï¼Œæ·»åŠ å¯¹è¯¥apiåŒ…çš„ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-auth-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>subject:</strong></p><p>åœ¨<code>jc-club-subject</code>çš„<code>infra</code>åŒ…ä¸­çš„<code>pom.xml</code>ä¸­æ·»åŠ ä¾èµ–</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.jingdianjichi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jc-club-auth-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>åœ¨<code>jc-club-subject</code>çš„<code>infra</code>åŒ…ä¸­æ·»åŠ <code>UserRpc.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserRpc</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//auth-apiæ¨¡å—ä¸­çš„UserFeignServiceæ¥å£</span></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> UserFeignService userFeignService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> UserInfo <span class="title function_">getUserInfo</span><span class="params">(String userName)</span> &#123;</span><br><span class="line">        <span class="type">AuthUserDTO</span> <span class="variable">authUserDTO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthUserDTO</span>();</span><br><span class="line">        authUserDTO.setUserName(userName);</span><br><span class="line">        <span class="comment">//è°ƒç”¨UserFeignServiceä¸­æš´éœ²çš„æ¥å£</span></span><br><span class="line">        Result&lt;AuthUserDTO&gt; result = userFeignService.getUserInfo(authUserDTO);</span><br><span class="line">        <span class="type">UserInfo</span> <span class="variable">userInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserInfo</span>();</span><br><span class="line">        <span class="keyword">if</span> (!result.getSuccess()) &#123;</span><br><span class="line">            <span class="keyword">return</span> userInfo;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">AuthUserDTO</span> <span class="variable">data</span> <span class="operator">=</span> result.getData();</span><br><span class="line">        userInfo.setUserName(data.getUserName());</span><br><span class="line">        userInfo.setNickName(data.getNickName());</span><br><span class="line">        userInfo.setAvatar(data.getAvatar());</span><br><span class="line">        <span class="keyword">return</span> userInfo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿›è¡Œæµ‹è¯•ï¼Œèƒ½æ‹¿åˆ°userInfo</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/subject/category&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TestFeignController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> UserRpc userRpc;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;testFeign&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFeign</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">UserInfo</span> <span class="variable">userInfo</span> <span class="operator">=</span> userRpc.getUserInfo(<span class="string">&quot;lzrj&quot;</span>);</span><br><span class="line">        log.info(<span class="string">&quot;testFeign.userInfo:&#123;&#125;&quot;</span>, userInfo);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>openFeign</code>æ‹¦æˆªå™¨å®ç°ç”¨æˆ·ä¸Šä¸‹æ–‡æ‰“é€š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> feign.RequestInterceptor;</span><br><span class="line"><span class="keyword">import</span> feign.RequestTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.context.request.ServletRequestAttributes;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†Feignæ‹¦æˆªå™¨æ³¨å†Œä¸ºSpringç»„ä»¶</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FeignRequestInterceptor</span> <span class="keyword">implements</span> <span class="title class_">RequestInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®ç°applyæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†åœ¨Feignå®¢æˆ·ç«¯å‘å‡ºè¯·æ±‚ä¹‹å‰è¢«è°ƒç”¨</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">apply</span><span class="params">(RequestTemplate requestTemplate)</span> &#123;</span><br><span class="line">        <span class="comment">// ä»RequestContextHolderè·å–å½“å‰çš„ServletRequestAttributes</span></span><br><span class="line">        <span class="type">ServletRequestAttributes</span> <span class="variable">requestAttributes</span> <span class="operator">=</span> (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// ä»ServletRequestAttributesä¸­è·å–HttpServletRequestå¯¹è±¡</span></span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> requestAttributes.getRequest();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ£€æŸ¥HttpServletRequestæ˜¯å¦éç©º</span></span><br><span class="line">        <span class="keyword">if</span> (Objects.nonNull(request)) &#123;</span><br><span class="line">            <span class="comment">// ä»HttpServletRequestçš„è¯·æ±‚å¤´ä¸­è·å–loginId</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">loginId</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;loginId&quot;</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æ£€æŸ¥loginIdæ˜¯å¦éç©ºä¸”éä»…åŒ…å«ç©ºç™½å­—ç¬¦</span></span><br><span class="line">            <span class="keyword">if</span> (StringUtils.isNotBlank(loginId)) &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœloginIdå­˜åœ¨ï¼Œå°†å…¶æ·»åŠ åˆ°Feignè¯·æ±‚æ¨¡æ¿çš„è¯·æ±‚å¤´ä¸­</span></span><br><span class="line">                requestTemplate.header(<span class="string">&quot;loginId&quot;</span>, loginId);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FeignConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RequestInterceptor <span class="title function_">requestInterceptor</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FeignRequestInterceptor</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡<code>FeignRequestInterceptor</code>åœ¨è°ƒç”¨å¾®æœåŠ¡ä¹‹å‰ï¼Œå°±å¯ä»¥æŠŠç›¸å…³è¯·æ±‚çš„loginIdå°è£…åˆ°è¯·æ±‚ä¸­ï¼Œè¿›è¡Œè·¨å¾®æœåŠ¡çš„loginIdçš„ä¼ é€’ï¼š</p><h3 id="guavaæœ¬åœ°ç¼“å­˜-å·²ç»å‡çº§æˆCaffiene"><a href="#guavaæœ¬åœ°ç¼“å­˜-å·²ç»å‡çº§æˆCaffiene" class="headerlink" title="guavaæœ¬åœ°ç¼“å­˜(å·²ç»å‡çº§æˆCaffiene)"></a>guavaæœ¬åœ°ç¼“å­˜(å·²ç»å‡çº§æˆCaffiene)</h3><p>æ³›å‹+å‡½æ•°å¼ç¼–ç¨‹</p><p><strong>guava:</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.google.common.cache.Cache;</span><br><span class="line"><span class="keyword">import</span> com.google.common.cache.CacheBuilder;</span><br><span class="line"><span class="keyword">import</span> com.google.common.collect.Lists;</span><br><span class="line"><span class="keyword">import</span> com.google.gson.JsonObject;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections4.CollectionUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å°†CacheUtilç±»æ ‡è®°ä¸ºSpringç»„ä»¶</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CacheUtil</span>&lt;K, V&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä½¿ç”¨Guavaçš„CacheBuilderæ„å»ºä¸€ä¸ªæœ¬åœ°ç¼“å­˜</span></span><br><span class="line">    <span class="keyword">private</span> Cache&lt;String, String&gt; localCache =</span><br><span class="line">            CacheBuilder.newBuilder()</span><br><span class="line">                    <span class="comment">// è®¾ç½®ç¼“å­˜æœ€å¤§å®¹é‡ä¸º5000</span></span><br><span class="line">                    .maximumSize(<span class="number">5000</span>)</span><br><span class="line">                    <span class="comment">// è®¾ç½®å†™å…¥å10ç§’è¿‡æœŸ</span></span><br><span class="line">                    .expireAfterWrite(<span class="number">10</span>, TimeUnit.SECONDS)</span><br><span class="line">                    .build();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ¹æ®ç¼“å­˜é”®è·å–ç¼“å­˜ç»“æœï¼Œå¦‚æœç¼“å­˜æœªå‘½ä¸­åˆ™è°ƒç”¨functionè·å–æ•°æ®å¹¶ç¼“å­˜ç»“æœ</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;V&gt; <span class="title function_">getResult</span><span class="params">(String cacheKey, Class&lt;V&gt; clazz,</span></span><br><span class="line"><span class="params">                             Function&lt;String, List&lt;V&gt;&gt; function)</span> &#123;</span><br><span class="line">        List&lt;V&gt; resultList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// å°è¯•ä»ç¼“å­˜ä¸­è·å–å†…å®¹</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> localCache.getIfPresent(cacheKey);</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(content)) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœç¼“å­˜ä¸­æœ‰æ•°æ®ï¼Œè§£æJSONå­—ç¬¦ä¸²åˆ°Listä¸­</span></span><br><span class="line">            resultList = JSON.parseArray(content, clazz);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœç¼“å­˜æœªå‘½ä¸­ï¼Œè°ƒç”¨functionè·å–æ•°æ®</span></span><br><span class="line">            resultList = function.apply(cacheKey);</span><br><span class="line">            <span class="comment">// å¦‚æœè·å–çš„æ•°æ®ä¸ä¸ºç©ºï¼Œåˆ™å°†æ•°æ®åºåˆ—åŒ–ä¸ºJSONå­—ç¬¦ä¸²å¹¶ç¼“å­˜</span></span><br><span class="line">            <span class="keyword">if</span> (!CollectionUtils.isEmpty(resultList)) &#123;</span><br><span class="line">                localCache.put(cacheKey, JSON.toJSONString(resultList));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> resultList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ ¹æ®ç¼“å­˜é”®è·å–Mapç±»å‹çš„ç¼“å­˜ç»“æœï¼Œå¦‚æœç¼“å­˜æœªå‘½ä¸­åˆ™è°ƒç”¨functionè·å–æ•°æ®å¹¶ç¼“å­˜ç»“æœ</span></span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼šæ­¤æ–¹æ³•çš„å®ç°ç›®å‰ä¸ºç©ºï¼Œéœ€è¦æ ¹æ®å…·ä½“éœ€æ±‚è¿›è¡Œå®ç°</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;K, V&gt; <span class="title function_">getMapResult</span><span class="params">(String cacheKey, Class&lt;V&gt; clazz,</span></span><br><span class="line"><span class="params">                                  Function&lt;String, Map&lt;K, V&gt;&gt; function)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ç”¨åˆ°äº†<code>queryCategoryAndLabel</code>ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SneakyThrows</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;SubjectCategoryBO&gt; <span class="title function_">queryCategoryAndLabel</span><span class="params">(SubjectCategoryBO subjectCategoryBO)</span> &#123;</span><br><span class="line">    <span class="type">Long</span> <span class="variable">id</span> <span class="operator">=</span> subjectCategoryBO.getId();</span><br><span class="line">    <span class="type">String</span> <span class="variable">cacheKey</span> <span class="operator">=</span> <span class="string">&quot;categoryAndLabel.&quot;</span> + subjectCategoryBO.getId();</span><br><span class="line">    <span class="comment">// è°ƒç”¨æœ¬åœ°ç¼“å­˜</span></span><br><span class="line">    List&lt;SubjectCategoryBO&gt; subjectCategoryBOS = cacheUtil.getResult(cacheKey,</span><br><span class="line">            SubjectCategoryBO.class, (key) -&gt; getSubjectCategoryBOS(id)); <span class="comment">//å¦‚æœæœ¬åœ°ç¼“å­˜æ²¡æœ‰ å°±è°ƒç”¨getSubjectCategoryBOS</span></span><br><span class="line">    <span class="keyword">return</span> subjectCategoryBOS;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…¨æ–‡æ£€ç´¢åŠŸèƒ½"><a href="#å…¨æ–‡æ£€ç´¢åŠŸèƒ½" class="headerlink" title="å…¨æ–‡æ£€ç´¢åŠŸèƒ½"></a>å…¨æ–‡æ£€ç´¢åŠŸèƒ½</h3><p><a href="https://blog.csdn.net/JENREY/article/details/81290535?ops_request_misc=%7B%22request_id%22:%22172354172816800222897865%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172354172816800222897865&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-81290535-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=elasticsearch&spm=1018.2226.3001.4187">ElasticSearchä»å…¥é—¨åˆ°ç²¾é€šï¼Œå²ä¸Šæœ€å…¨ï¼ˆæŒç»­æ›´æ–°ï¼Œæœªå®Œå¾…ç»­ï¼Œæ¯å¤©ä¸€ç‚¹ç‚¹ï¼‰_elasticsearchä»å…¥é—¨åˆ°ç²¾é€š,å²ä¸Šæœ€å…¨-CSDNåšå®¢</a></p><h4 id="åŠŸèƒ½è®¾è®¡"><a href="#åŠŸèƒ½è®¾è®¡" class="headerlink" title="åŠŸèƒ½è®¾è®¡"></a>åŠŸèƒ½è®¾è®¡</h4><p><img src="https://s2.loli.net/2024/08/13/JGn2mjVoUIRkDYg.png" alt="image-20240813172543714.png"></p><p>æŠ€æœ¯é€‰å‹ï¼šelasticsearchã€‚</p><p>ç›®çš„æ˜¯ï¼Œç½‘ç«™ç°åœ¨æ•´ä½“çš„é¢˜ç›®é¢„è®¡ä¼šåˆ°å¥½å‡ ç™¾ï¼Œæ–¹ä¾¿å¿«é€Ÿçš„æœç´¢åˆ°è‡ªå·±æƒ³çœ‹çš„å†…å®¹ã€‚</p><p>å®ç°å½¢å¼ï¼š</p><ul><li><p>åŒæ­¥ï¼šæ–°å¢é¢˜ç›®-&gt;MYSQL-&gt;es</p><p><img src="https://s2.loli.net/2024/08/13/SyGl8MZvtJxaC46.png" alt="image-20240813172750581.png"></p></li><li><p>å¼‚æ­¥ï¼šmysql å­˜å‚¨å®Œåï¼Œå‘é€ mq</p><p><img src="https://s2.loli.net/2024/08/13/8AlqQE3mfD6evGH.png" alt="image-20240813172810340.png"></p></li><li><p>å¼‚æ­¥canalï¼šç›‘å¬ mysql å˜æ›´çš„ binlogï¼Œå®ç° es çš„å­˜å‚¨</p><p><img src="https://s2.loli.net/2024/08/13/zlsu95tIUGHRw7D.png" alt="image-20240813172928624.png"></p></li></ul><h4 id="å®é™…æ“ä½œ"><a href="#å®é™…æ“ä½œ" class="headerlink" title="å®é™…æ“ä½œ"></a>å®é™…æ“ä½œ</h4><p>[é€šè¿‡HTTPçš„æ–¹å¼æ“ä½œES-CSDNåšå®¢](<a href="https://blog.csdn.net/sss294438204/article/details/122884953?ops_request_misc=%7B%22request_id%22:%22172355571716800211536069%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172355571716800211536069&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-122884953-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=es">https://blog.csdn.net/sss294438204/article/details/122884953?ops_request_misc=%7B%22request%5Fid%22%3A%22172355571716800211536069%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172355571716800211536069&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-122884953-null-null.142^v100^pc_search_result_base8&amp;utm_term=es</a> http&amp;spm&#x3D;1018.2226.3001.4187)</p><p>æ¥å£ï¼š</p><p><img src="https://s2.loli.net/2024/08/13/kIjp4gbOqEHxtJC.png" alt="image-20240813212925046.png"></p><h4 id="esåˆ†è¯é—®é¢˜"><a href="#esåˆ†è¯é—®é¢˜" class="headerlink" title="esåˆ†è¯é—®é¢˜"></a>esåˆ†è¯é—®é¢˜</h4><p>åŸç”Ÿçš„ä¸å¤ªè¡Œï¼Œç”¨è¿™ä¸ª</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v7.3.1/elasticsearch-analysis-ik-7.3.1.zip</span><br></pre></td></tr></table></figure><p>è§£å‹åï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ çš„ ik æ–‡ä»¶å¤¹ä¸‹é¢ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mkdir /soft/ik</span><br><span class="line"></span><br><span class="line">è¿›å…¥å®¹å™¨å†…éƒ¨</span><br><span class="line">docker exec -it elasticsearch /bin/bash</span><br><span class="line">cd plugins</span><br><span class="line">mkdir ik</span><br><span class="line"></span><br><span class="line">å›åˆ°å¤–éƒ¨</span><br><span class="line">docker cp /soft/ik/. 73438a827b55:/usr/share/elasticsearch/plugins/ik</span><br><span class="line"></span><br><span class="line">é‡å¯es</span><br><span class="line">docker restart 73438a827b55</span><br></pre></td></tr></table></figure><h4 id="ç¼–ç -è¯•æ‰‹"><a href="#ç¼–ç -è¯•æ‰‹" class="headerlink" title="ç¼–ç : è¯•æ‰‹"></a>ç¼–ç : è¯•æ‰‹</h4><p><code>subject-infra</code>å±‚<code>pom.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-elasticsearch<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>TestFeignController.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;testCreateIndex&quot;)</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testCreateIndex</span><span class="params">()</span> &#123;</span><br><span class="line">       subjectEsService.createIndex();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@GetMapping(&quot;addDocs&quot;)</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addDocs</span><span class="params">()</span> &#123;</span><br><span class="line">       subjectEsService.addDoc();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@GetMapping(&quot;find&quot;)</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">find</span><span class="params">()</span> &#123;</span><br><span class="line">       subjectEsService.find();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@GetMapping(&quot;search&quot;)</span></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">search</span><span class="params">()</span> &#123;</span><br><span class="line">       subjectEsService.search();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>å®ä½“ç±»ï¼š<code>SubjectInfoEs.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@Document(indexName = &quot;subject_index&quot;, createIndex = false)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectInfoEs</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Field(type = FieldType.Long)</span></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Field(type = FieldType.Text, analyzer = &quot;ik_smart&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String subjectName;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Field(type = FieldType.Text, analyzer = &quot;ik_smart&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String subjectAnswer;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Field(type = FieldType.Keyword)</span></span><br><span class="line">    <span class="keyword">private</span> String createUser;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Field(type = FieldType.Date, index = false)</span></span><br><span class="line">    <span class="keyword">private</span> Date createTime;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SubjectEsRepository.java</code>ï¼Œç»§æ‰¿è‡ª<code>ElasticsearchRepository</code>ã€‚è¿™ä¸ªæ¥å£æ˜¯Spring Data Elasticsearchçš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºæä¾›å¯¹Elasticsearchçš„è®¿é—®å’Œæ“ä½œã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectEsRepository</span> <span class="keyword">extends</span> <span class="title class_">ElasticsearchRepository</span>&lt;SubjectInfoEs, Long&gt; &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SubjectEsService.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectEsService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">createIndex</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">addDoc</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">find</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">search</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SubjectEsServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectEsServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">SubjectEsService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> ElasticsearchRestTemplate elasticsearchRestTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectEsRepository subjectEsRepository;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">createIndex</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">IndexOperations</span> <span class="variable">indexOperations</span> <span class="operator">=</span></span><br><span class="line">                elasticsearchRestTemplate.indexOps(SubjectInfoEs.class);</span><br><span class="line">        indexOperations.create();</span><br><span class="line">        <span class="type">Document</span> <span class="variable">mapping</span> <span class="operator">=</span> indexOperations.createMapping(SubjectInfoEs.class);</span><br><span class="line">        indexOperations.putMapping(mapping);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addDoc</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;SubjectInfoEs&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        list.add(<span class="keyword">new</span> <span class="title class_">SubjectInfoEs</span>(<span class="number">1L</span>,<span class="string">&quot;redisæ˜¯ä»€ä¹ˆ&quot;</span>,<span class="string">&quot;redisæ˜¯ä¸€ä¸ªç¼“å­˜&quot;</span>,<span class="string">&quot;é¸¡ç¿…&quot;</span>,<span class="keyword">new</span> <span class="title class_">Date</span>()));</span><br><span class="line">        list.add(<span class="keyword">new</span> <span class="title class_">SubjectInfoEs</span>(<span class="number">2L</span>,<span class="string">&quot;mysqlæ˜¯ä»€ä¹ˆ&quot;</span>,<span class="string">&quot;mysqlæ˜¯æ•°æ®åº“&quot;</span>,<span class="string">&quot;é¸¡ç¿…&quot;</span>,<span class="keyword">new</span> <span class="title class_">Date</span>()));</span><br><span class="line">        subjectEsRepository.saveAll(list);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">find</span><span class="params">()</span> &#123;</span><br><span class="line">        Iterable&lt;SubjectInfoEs&gt; all = subjectEsRepository.findAll();</span><br><span class="line">        <span class="keyword">for</span> (SubjectInfoEs subjectInfoEs : all)&#123;</span><br><span class="line">            log.info(<span class="string">&quot;subjectInfoEs:&#123;&#125;&quot;</span>,JSON.toJSONString(subjectInfoEs));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">search</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">NativeSearchQuery</span> <span class="variable">nativeSearchQuery</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NativeSearchQueryBuilder</span>()</span><br><span class="line">                .withQuery(QueryBuilders.matchQuery(<span class="string">&quot;subjectName&quot;</span>,<span class="string">&quot;redis&quot;</span>))</span><br><span class="line">                .build();</span><br><span class="line">        SearchHits&lt;SubjectInfoEs&gt; search = elasticsearchRestTemplate.</span><br><span class="line">                search(nativeSearchQuery, SubjectInfoEs.class);</span><br><span class="line">        List&lt;SearchHit&lt;SubjectInfoEs&gt;&gt; searchHits = search.getSearchHits();</span><br><span class="line">        log.info(<span class="string">&quot;searchHits:&#123;&#125;&quot;</span>, JSON.toJSONString(searchHits));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>subject-starter</code>ä¸­çš„<code>application.yaml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">elasticsearch:</span></span><br><span class="line"> <span class="attr">rest:</span></span><br><span class="line">  <span class="string">uris:http://172.72.14.166:9200</span></span><br></pre></td></tr></table></figure><h4 id="ç¼–ç ï¼šè‡ªå®šä¹‰å°è£…esé›†ç¾¤è¿æ¥ç»Ÿä¸€ç®¡ç†"><a href="#ç¼–ç ï¼šè‡ªå®šä¹‰å°è£…esé›†ç¾¤è¿æ¥ç»Ÿä¸€ç®¡ç†" class="headerlink" title="ç¼–ç ï¼šè‡ªå®šä¹‰å°è£…esé›†ç¾¤è¿æ¥ç»Ÿä¸€ç®¡ç†"></a>ç¼–ç ï¼šè‡ªå®šä¹‰å°è£…esé›†ç¾¤è¿æ¥ç»Ÿä¸€ç®¡ç†</h4><p>å¸Œæœ›çš„ä¸€ä¸ªç›®çš„</p><ol><li>æœ‰è‡ªå·±çš„å°è£…å¥½çš„å·¥å…·</li><li>é›†ç¾¤ï¼Œç´¢å¼•ç­‰ç­‰éƒ½è¦å…¼å®¹çš„é…ç½®çš„æ¦‚å¿µ</li><li>ä¸æƒ³ç”¨ data çš„è¿™ç§æ–¹å¼ï¼Œä¸å¤Ÿæ‰©å±•</li></ol><p><img src="https://s2.loli.net/2024/08/14/IyEW14MJOe8gP9w.png" alt="image-20240814112513230.png"></p><p>é…ç½®ç±»ï¼šè¯»å–é…ç½®æ–‡ä»¶è‡ªå®šä¹‰çš„å±æ€§ï¼Œæ”¯æŒé›†ç¾¤ï¼ŒèŠ‚ç‚¹ç­‰ç­‰ä¸€äº›ä¿¡æ¯</p><ol><li>@Configuration + @ConfigurationProperties + @Dataï¼ˆå¿…é¡»æä¾›setæ–¹æ³•ï¼‰</li><li>@Configuration +  @Value</li></ol><p>é›†ç¾¤ç±»ï¼šé›†ç¾¤çš„åç§°ã€é›†ç¾¤çš„èŠ‚ç‚¹</p><p>ç´¢å¼•ç±»ï¼šé›†ç¾¤åç§°ã€ç´¢å¼•åç§°</p><p>å°è£…çš„è¯·æ±‚ç±»ï¼šæŸ¥è¯¢æ¡ä»¶ã€æŸ¥è¯¢å­—æ®µã€é¡µæ•°ã€æ¡æ•°ã€å¿«ç…§ã€å¿«ç…§ç¼“å­˜æ—¶é—´ã€æ’åºå­—æ®µã€æ’åºç±»å‹ã€é«˜äº®</p><p>å°è£…çš„è¿”å›ç±»ï¼šæ–‡æ¡£idï¼ˆä¿è¯å”¯ä¸€ï¼‰ã€æ‰€æœ‰è·ŸrestClientäº¤äº’çš„å°è£…æˆä¸€ä¸ªMap</p><p>è‡ªå®šä¹‰å·¥å…·ç±»ï¼šç›®çš„å°±æ˜¯ä¸ºäº†æä¾›ä¸€ä¸ªRestHighLevelClientï¼Œåœ¨åŸç”Ÿclientçš„åŸºç¡€ä¸Šå°è£…ä¸€äº›å¥½ç”¨çš„api</p><p>æ•´ä½“åŸºäº es çš„åŸç”Ÿçš„ client æ¥å»åšã€‚</p><p><code>subject-infra</code>å±‚<code>pom.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.elasticsearch<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>elasticsearch<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>7.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.elasticsearch.client<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>elasticsearch-rest-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>7.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.elasticsearch.client<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>elasticsearch-rest-high-level-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>7.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-collections4<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>esé›†ç¾¤ç±»<code>EsClusterConfig.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EsClusterConfig</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é›†ç¾¤åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é›†ç¾¤èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String nodes;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>EsConfigProperties.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;es.cluster&quot;)</span> <span class="comment">//è¿™éƒ¨åˆ†æ˜¯è·Ÿapplication.yamlä¸­çš„å¯¹åº”</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EsConfigProperties</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;EsClusterConfig&gt; esConfigs = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;EsClusterConfig&gt; <span class="title function_">getEsConfigs</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> esConfigs;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setEsConfigs</span><span class="params">(List&lt;EsClusterConfig&gt; esConfigs)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.esConfigs = esConfigs;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>subject-starter</code>ä¸­çš„<code>application.yaml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">es:</span></span><br><span class="line">  <span class="attr">cluster:</span></span><br><span class="line">    <span class="string">esConfigs[0]:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">73438a827b55</span></span><br><span class="line">      <span class="attr">nodes:</span> <span class="number">117.72</span><span class="number">.14</span><span class="number">.166</span><span class="string">:9200</span></span><br></pre></td></tr></table></figure><p><code>EsIndexInfo.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EsIndexInfo</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é›†ç¾¤åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String clusterName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç´¢å¼•åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String indexName;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>EsSearchRequest.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EsSearchRequest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> BoolQueryBuilder bq;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢å­—æ®µ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String[] fields;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é¡µæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> from;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¡æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * éœ€è¦å¿«ç…§</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Boolean needScroll;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¿«ç…§ç¼“å­˜æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long minutes;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ’åºå­—æ®µ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String sortName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ’åºç±»å‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> SortOrder sortOrder;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é«˜äº®builder</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> HighlightBuilder highlightBuilder;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>EsSourceData.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EsSourceData</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String docId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Object&gt; data;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>EsRestClient.java</code></p><p>è¿™ä¸ªç±»å°è£…äº†ä¸Elasticsearché›†ç¾¤äº¤äº’çš„å¸¸è§æ“ä½œ</p><ol><li><strong>ç±»å®šä¹‰å’Œæ—¥å¿—è®°å½•</strong>ï¼šä½¿ç”¨<code>@Component</code>æ³¨è§£è¡¨æ˜è¿™æ˜¯ä¸€ä¸ªSpringç»„ä»¶ï¼Œä½¿ç”¨<code>@Slf4j</code>æ¥å¼•å…¥æ—¥å¿—è®°å½•åŠŸèƒ½ã€‚</li><li><strong>å®¢æˆ·ç«¯æ˜ å°„</strong>ï¼š<code>clientMap</code>æ˜¯ä¸€ä¸ªé™æ€çš„<code>HashMap</code>ï¼Œç”¨äºå­˜å‚¨ä¸åŒElasticsearché›†ç¾¤çš„<code>RestHighLevelClient</code>å®ä¾‹ã€‚</li><li><strong>é…ç½®å±æ€§æ³¨å…¥</strong>ï¼šé€šè¿‡<code>@Resource</code>æ³¨è§£æ³¨å…¥<code>EsConfigProperties</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªé…ç½®å±æ€§ç±»ï¼Œç”¨äºè·å–Elasticsearché›†ç¾¤çš„é…ç½®ä¿¡æ¯ã€‚</li><li><strong>è¯·æ±‚é€‰é¡¹</strong>ï¼šå®šä¹‰äº†ä¸€ä¸ªé™æ€çš„<code>RequestOptions</code>å¯¹è±¡<code>COMMON_OPTIONS</code>ï¼Œç”¨äºåç»­çš„è¯·æ±‚ã€‚</li><li><strong>åˆå§‹åŒ–æ–¹æ³•</strong>ï¼š<code>initialize</code>æ–¹æ³•åœ¨ç»„ä»¶åˆå§‹åŒ–æ—¶è¢«è°ƒç”¨ï¼Œç”¨äºæ ¹æ®é…ç½®åˆ›å»ºå’Œåˆå§‹åŒ–<code>RestHighLevelClient</code>å®ä¾‹ã€‚</li><li><strong>åˆ›å»ºå®¢æˆ·ç«¯æ–¹æ³•</strong>ï¼š<code>initRestClient</code>æ˜¯ä¸€ä¸ªç§æœ‰æ–¹æ³•ï¼Œç”¨äºæ ¹æ®ç»™å®šçš„é›†ç¾¤é…ç½®åˆ›å»º<code>RestHighLevelClient</code>å®ä¾‹ã€‚</li><li><strong>è·å–å®¢æˆ·ç«¯æ–¹æ³•</strong>ï¼š<code>getClient</code>æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œç”¨äºæ ¹æ®é›†ç¾¤åç§°è·å–å¯¹åº”çš„<code>RestHighLevelClient</code>å®ä¾‹ã€‚</li><li><strong>æ–‡æ¡£æ“ä½œ</strong>ï¼šç±»ä¸­å®šä¹‰äº†ä¸€ç³»åˆ—çš„é™æ€æ–¹æ³•ï¼Œç”¨äºæ‰§è¡ŒElasticsearchä¸­çš„æ–‡æ¡£æ“ä½œï¼Œå¦‚æ’å…¥(<code>insertDoc</code>)ã€æ›´æ–°(<code>updateDoc</code>)ã€æ‰¹é‡æ›´æ–°(<code>batchUpdateDoc</code>)ã€åˆ é™¤(<code>delete</code>å’Œ<code>deleteDoc</code>)ã€æ£€æŸ¥æ–‡æ¡£æ˜¯å¦å­˜åœ¨(<code>isExistDocById</code>)ã€è·å–æ–‡æ¡£(<code>getDocById</code>)ç­‰ã€‚</li><li><strong>æœç´¢åŠŸèƒ½</strong>ï¼š<code>searchWithTermQuery</code>æ–¹æ³•ç”¨äºæ‰§è¡ŒåŸºäºå¸ƒå°”æŸ¥è¯¢æ„å»ºå™¨çš„æœç´¢è¯·æ±‚ï¼Œå¹¶æ”¯æŒé«˜äº®æ˜¾ç¤ºã€æ’åºå’Œæ»šåŠ¨(scroll)ã€‚</li><li><strong>æ‰¹é‡æ’å…¥</strong>ï¼š<code>batchInsertDoc</code>æ–¹æ³•ç”¨äºæ‰¹é‡æ’å…¥æ–‡æ¡£ã€‚</li><li><strong>æ›´æ–°æŸ¥è¯¢</strong>ï¼š<code>updateByQuery</code>æ–¹æ³•å…è®¸æ‰§è¡ŒåŸºäºæŸ¥è¯¢çš„æ›´æ–°æ“ä½œã€‚</li><li><strong>åˆ†è¯åŠŸèƒ½</strong>ï¼š<code>getAnalyze</code>æ–¹æ³•æä¾›äº†ä¸€ä¸ªåˆ†è¯åŠŸèƒ½ï¼Œå¯ä»¥å¯¹è¾“å…¥çš„æ–‡æœ¬è¿›è¡Œåˆ†è¯ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EsRestClient</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, RestHighLevelClient&gt; clientMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> EsConfigProperties esConfigProperties;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> RequestOptions COMMON_OPTIONS;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        RequestOptions.<span class="type">Builder</span> <span class="variable">builder</span> <span class="operator">=</span> RequestOptions.DEFAULT.toBuilder();</span><br><span class="line">        COMMON_OPTIONS = builder.build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;EsClusterConfig&gt; esConfigs = esConfigProperties.getEsConfigs();</span><br><span class="line">        <span class="keyword">for</span> (EsClusterConfig esConfig : esConfigs) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;initialize.config.name:&#123;&#125;,node:&#123;&#125;&quot;</span>, esConfig.getName(), esConfig.getNodes());</span><br><span class="line">            <span class="type">RestHighLevelClient</span> <span class="variable">restHighLevelClient</span> <span class="operator">=</span> initRestClient(esConfig);</span><br><span class="line">            <span class="keyword">if</span> (restHighLevelClient != <span class="literal">null</span>) &#123;</span><br><span class="line">                clientMap.put(esConfig.getName(), restHighLevelClient);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                log.error(<span class="string">&quot;config.name:&#123;&#125;,node:&#123;&#125;.initError&quot;</span>, esConfig.getName(), esConfig.getNodes());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> RestHighLevelClient <span class="title function_">initRestClient</span><span class="params">(EsClusterConfig esClusterConfig)</span> &#123;</span><br><span class="line">        String[] ipPortArr = esClusterConfig.getNodes().split(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">        List&lt;HttpHost&gt; httpHostList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(ipPortArr.length);</span><br><span class="line">        <span class="keyword">for</span> (String ipPort : ipPortArr) &#123;</span><br><span class="line">            String[] ipPortInfo = ipPort.split(<span class="string">&quot;:&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (ipPortInfo.length == <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="type">HttpHost</span> <span class="variable">httpHost</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpHost</span>(ipPortInfo[<span class="number">0</span>], NumberUtils.toInt(ipPortInfo[<span class="number">1</span>]));</span><br><span class="line">                httpHostList.add(httpHost);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        HttpHost[] httpHosts = <span class="keyword">new</span> <span class="title class_">HttpHost</span>[httpHostList.size()];</span><br><span class="line">        httpHostList.toArray(httpHosts);</span><br><span class="line"></span><br><span class="line">        <span class="type">RestClientBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> RestClient.builder(httpHosts);</span><br><span class="line">        <span class="type">RestHighLevelClient</span> <span class="variable">restHighLevelClient</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">RestHighLevelClient</span>(builder);</span><br><span class="line">        <span class="keyword">return</span> restHighLevelClient;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//è¿”å›é›†ç¾¤åç§°å¯¹åº”çš„RestHighLevelClient</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> RestHighLevelClient <span class="title function_">getClient</span><span class="params">(String clusterName)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> clientMap.get(clusterName);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//æ–°å¢æ–‡æ¡£</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">insertDoc</span><span class="params">(EsIndexInfo esIndexInfo, EsSourceData esSourceData)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">IndexRequest</span> <span class="variable">indexRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IndexRequest</span>(esIndexInfo.getIndexName());</span><br><span class="line">            indexRequest.source(esSourceData.getData());</span><br><span class="line">            indexRequest.id(esSourceData.getDocId());</span><br><span class="line">            getClient(esIndexInfo.getClusterName()).index(indexRequest, COMMON_OPTIONS);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;insertDoc.exception:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">updateDoc</span><span class="params">(EsIndexInfo esIndexInfo, EsSourceData esSourceData)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">UpdateRequest</span> <span class="variable">updateRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UpdateRequest</span>();</span><br><span class="line">            updateRequest.index(esIndexInfo.getIndexName());</span><br><span class="line">            updateRequest.id(esSourceData.getDocId());</span><br><span class="line">            updateRequest.doc(esSourceData.getData());</span><br><span class="line">            getClient(esIndexInfo.getClusterName()).update(updateRequest, COMMON_OPTIONS);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;updateDoc.exception:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">batchUpdateDoc</span><span class="params">(EsIndexInfo esIndexInfo,</span></span><br><span class="line"><span class="params">                                         List&lt;EsSourceData&gt; esSourceDataList)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="type">BulkRequest</span> <span class="variable">bulkRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BulkRequest</span>();</span><br><span class="line">            <span class="keyword">for</span> (EsSourceData esSourceData : esSourceDataList) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">docId</span> <span class="operator">=</span> esSourceData.getDocId();</span><br><span class="line">                <span class="keyword">if</span> (StringUtils.isNotBlank(docId)) &#123;</span><br><span class="line">                    <span class="type">UpdateRequest</span> <span class="variable">updateRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UpdateRequest</span>();</span><br><span class="line">                    updateRequest.index(esIndexInfo.getIndexName());</span><br><span class="line">                    updateRequest.id(esSourceData.getDocId());</span><br><span class="line">                    updateRequest.doc(esSourceData.getData());</span><br><span class="line">                    bulkRequest.add(updateRequest);</span><br><span class="line">                    flag = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">                <span class="type">BulkResponse</span> <span class="variable">bulk</span> <span class="operator">=</span> getClient(esIndexInfo.getClusterName()).bulk(bulkRequest, COMMON_OPTIONS);</span><br><span class="line">                <span class="keyword">if</span> (bulk.hasFailures()) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;batchUpdateDoc.exception:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">delete</span><span class="params">(EsIndexInfo esIndexInfo)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">DeleteByQueryRequest</span> <span class="variable">deleteByQueryRequest</span> <span class="operator">=</span></span><br><span class="line">                    <span class="keyword">new</span> <span class="title class_">DeleteByQueryRequest</span>(esIndexInfo.getIndexName());</span><br><span class="line">            deleteByQueryRequest.setQuery(QueryBuilders.matchAllQuery());</span><br><span class="line">            <span class="type">BulkByScrollResponse</span> <span class="variable">response</span> <span class="operator">=</span> getClient(esIndexInfo.getClusterName()).deleteByQuery(</span><br><span class="line">                    deleteByQueryRequest, COMMON_OPTIONS</span><br><span class="line">            );</span><br><span class="line">            <span class="type">long</span> <span class="variable">deleted</span> <span class="operator">=</span> response.getDeleted();</span><br><span class="line">            log.info(<span class="string">&quot;deleted.size:&#123;&#125;&quot;</span>, deleted);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;delete.exception:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">deleteDoc</span><span class="params">(EsIndexInfo esIndexInfo, String docId)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">DeleteRequest</span> <span class="variable">deleteRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DeleteRequest</span>(esIndexInfo.getIndexName());</span><br><span class="line">            deleteRequest.id(docId);</span><br><span class="line">            <span class="type">DeleteResponse</span> <span class="variable">response</span> <span class="operator">=</span> getClient(esIndexInfo.getClusterName()).delete(deleteRequest, COMMON_OPTIONS);</span><br><span class="line">            log.info(<span class="string">&quot;deleteDoc.response:&#123;&#125;&quot;</span>, JSON.toJSONString(response));</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;deleteDoc.exception:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isExistDocById</span><span class="params">(EsIndexInfo esIndexInfo, String docId)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">GetRequest</span> <span class="variable">getRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GetRequest</span>(esIndexInfo.getIndexName());</span><br><span class="line">            getRequest.id(docId);</span><br><span class="line">            <span class="keyword">return</span> getClient(esIndexInfo.getClusterName()).exists(getRequest, COMMON_OPTIONS);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;isExistDocById.exception:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title function_">getDocById</span><span class="params">(EsIndexInfo esIndexInfo, String docId)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">GetRequest</span> <span class="variable">getRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GetRequest</span>(esIndexInfo.getIndexName());</span><br><span class="line">            getRequest.id(docId);</span><br><span class="line">            <span class="type">GetResponse</span> <span class="variable">response</span> <span class="operator">=</span> getClient(esIndexInfo.getClusterName()).get(getRequest, COMMON_OPTIONS);</span><br><span class="line">            Map&lt;String, Object&gt; source = response.getSource();</span><br><span class="line">            <span class="keyword">return</span> source;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;isExistDocById.exception:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title function_">getDocById</span><span class="params">(EsIndexInfo esIndexInfo, String docId,</span></span><br><span class="line"><span class="params">                                                 String[] fields)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">GetRequest</span> <span class="variable">getRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GetRequest</span>(esIndexInfo.getIndexName());</span><br><span class="line">            getRequest.id(docId);</span><br><span class="line">            <span class="type">FetchSourceContext</span> <span class="variable">fetchSourceContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FetchSourceContext</span>(<span class="literal">true</span>, fields, <span class="literal">null</span>);</span><br><span class="line">            getRequest.fetchSourceContext(fetchSourceContext);</span><br><span class="line">            <span class="type">GetResponse</span> <span class="variable">response</span> <span class="operator">=</span> getClient(esIndexInfo.getClusterName()).get(getRequest, COMMON_OPTIONS);</span><br><span class="line">            Map&lt;String, Object&gt; source = response.getSource();</span><br><span class="line">            <span class="keyword">return</span> source;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;isExistDocById.exception:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‰§è¡ŒElasticsearchæœç´¢ï¼Œæ”¯æŒå¤æ‚çš„æŸ¥è¯¢æ¡ä»¶ã€å­—æ®µé€‰æ‹©ã€é«˜äº®æ˜¾ç¤ºã€æ’åºå’Œæ»šåŠ¨æœç´¢ã€‚</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> SearchResponse <span class="title function_">searchWithTermQuery</span><span class="params">(EsIndexInfo esIndexInfo,</span></span><br><span class="line"><span class="params">                                                     EsSearchRequest esSearchRequest)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">BoolQueryBuilder</span> <span class="variable">bq</span> <span class="operator">=</span> esSearchRequest.getBq();</span><br><span class="line">            String[] fields = esSearchRequest.getFields();</span><br><span class="line">            <span class="type">int</span> <span class="variable">from</span> <span class="operator">=</span> esSearchRequest.getFrom();</span><br><span class="line">            <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> esSearchRequest.getSize();</span><br><span class="line">            <span class="type">Long</span> <span class="variable">minutes</span> <span class="operator">=</span> esSearchRequest.getMinutes();</span><br><span class="line">            <span class="type">Boolean</span> <span class="variable">needScroll</span> <span class="operator">=</span> esSearchRequest.getNeedScroll();</span><br><span class="line">            <span class="type">String</span> <span class="variable">sortName</span> <span class="operator">=</span> esSearchRequest.getSortName();</span><br><span class="line">            <span class="type">SortOrder</span> <span class="variable">sortOrder</span> <span class="operator">=</span> esSearchRequest.getSortOrder();</span><br><span class="line"></span><br><span class="line">            <span class="type">SearchSourceBuilder</span> <span class="variable">searchSourceBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SearchSourceBuilder</span>();</span><br><span class="line">            searchSourceBuilder.query(bq);</span><br><span class="line">            searchSourceBuilder.fetchSource(fields, <span class="literal">null</span>).from(from).size(size);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (Objects.nonNull(esSearchRequest.getHighlightBuilder())) &#123;</span><br><span class="line">                searchSourceBuilder.highlighter(esSearchRequest.getHighlightBuilder());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (StringUtils.isNotBlank(sortName)) &#123;</span><br><span class="line">                searchSourceBuilder.sort(sortName);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            searchSourceBuilder.sort(<span class="keyword">new</span> <span class="title class_">ScoreSortBuilder</span>().order(SortOrder.DESC));</span><br><span class="line"></span><br><span class="line">            <span class="type">SearchRequest</span> <span class="variable">searchRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SearchRequest</span>();</span><br><span class="line">            searchRequest.searchType(SearchType.DEFAULT);</span><br><span class="line">            searchRequest.indices(esIndexInfo.getIndexName());</span><br><span class="line">            searchRequest.source(searchSourceBuilder);</span><br><span class="line">            <span class="keyword">if</span> (needScroll) &#123;</span><br><span class="line">                <span class="type">Scroll</span> <span class="variable">scroll</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scroll</span>(TimeValue.timeValueMinutes(minutes));</span><br><span class="line">                searchRequest.scroll(scroll);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">SearchResponse</span> <span class="variable">search</span> <span class="operator">=</span> getClient(esIndexInfo.getClusterName()).search(searchRequest, COMMON_OPTIONS);</span><br><span class="line">            <span class="keyword">return</span> search;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;searchWithTermQuery.exception:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">batchInsertDoc</span><span class="params">(EsIndexInfo esIndexInfo, List&lt;EsSourceData&gt; esSourceDataList)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;æ‰¹é‡æ–°å¢ES:&quot;</span> + esSourceDataList.size());</span><br><span class="line">            log.info(<span class="string">&quot;indexName:&quot;</span> + esIndexInfo.getIndexName());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="type">BulkRequest</span> <span class="variable">bulkRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BulkRequest</span>();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (EsSourceData source : esSourceDataList) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">docId</span> <span class="operator">=</span> source.getDocId();</span><br><span class="line">                <span class="keyword">if</span> (StringUtils.isNotBlank(docId)) &#123;</span><br><span class="line">                    <span class="type">IndexRequest</span> <span class="variable">indexRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IndexRequest</span>(esIndexInfo.getIndexName());</span><br><span class="line">                    indexRequest.id(docId);</span><br><span class="line">                    indexRequest.source(source.getData());</span><br><span class="line">                    bulkRequest.add(indexRequest);</span><br><span class="line">                    flag = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">                <span class="type">BulkResponse</span> <span class="variable">response</span> <span class="operator">=</span> getClient(esIndexInfo.getClusterName()).bulk(bulkRequest, COMMON_OPTIONS);</span><br><span class="line">                <span class="keyword">if</span> (response.hasFailures()) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;batchInsertDoc.error&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">updateByQuery</span><span class="params">(EsIndexInfo esIndexInfo, QueryBuilder queryBuilder, Script script, <span class="type">int</span> batchSize)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;updateByQuery.indexName:&quot;</span> + esIndexInfo.getIndexName());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">UpdateByQueryRequest</span> <span class="variable">updateByQueryRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UpdateByQueryRequest</span>(esIndexInfo.getIndexName());</span><br><span class="line">            updateByQueryRequest.setQuery(queryBuilder);</span><br><span class="line">            updateByQueryRequest.setScript(script);</span><br><span class="line">            updateByQueryRequest.setBatchSize(batchSize);</span><br><span class="line">            updateByQueryRequest.setAbortOnVersionConflict(<span class="literal">false</span>);</span><br><span class="line">            <span class="type">BulkByScrollResponse</span> <span class="variable">response</span> <span class="operator">=</span> getClient(esIndexInfo.getClusterName()).updateByQuery(updateByQueryRequest, RequestOptions.DEFAULT);</span><br><span class="line">            List&lt;BulkItemResponse.Failure&gt; failures = response.getBulkFailures();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;updateByQuery.error&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†è¯æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title function_">getAnalyze</span><span class="params">(EsIndexInfo esIndexInfo, String text)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line">        <span class="type">Request</span> <span class="variable">request</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Request</span>(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;_analyze&quot;</span>);</span><br><span class="line">        <span class="type">JSONObject</span> <span class="variable">entity</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSONObject</span>();</span><br><span class="line">        entity.put(<span class="string">&quot;analyzer&quot;</span>, <span class="string">&quot;ik_smart&quot;</span>);</span><br><span class="line">        entity.put(<span class="string">&quot;text&quot;</span>, text);</span><br><span class="line">        request.setJsonEntity(entity.toJSONString());</span><br><span class="line">        <span class="type">Response</span> <span class="variable">response</span> <span class="operator">=</span> getClient(esIndexInfo.getClusterName()).getLowLevelClient().performRequest(request);</span><br><span class="line">        <span class="type">JSONObject</span> <span class="variable">tokens</span> <span class="operator">=</span> JSONObject.parseObject(EntityUtils.toString(response.getEntity()));</span><br><span class="line">        <span class="type">JSONArray</span> <span class="variable">arrays</span> <span class="operator">=</span> tokens.getJSONArray(<span class="string">&quot;tokens&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arrays.size(); i++) &#123;</span><br><span class="line">            <span class="type">JSONObject</span> <span class="variable">obj</span> <span class="operator">=</span> JSON.parseObject(arrays.getString(i));</span><br><span class="line">            list.add(obj.getString(<span class="string">&quot;token&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æ–°å¢é¢˜ç›®åŒæ­¥åˆ°es-å¸¦é«˜äº®çš„ç½‘ç«™å…¨æ–‡æœç´¢"><a href="#æ–°å¢é¢˜ç›®åŒæ­¥åˆ°es-å¸¦é«˜äº®çš„ç½‘ç«™å…¨æ–‡æœç´¢" class="headerlink" title="æ–°å¢é¢˜ç›®åŒæ­¥åˆ°es+å¸¦é«˜äº®çš„ç½‘ç«™å…¨æ–‡æœç´¢"></a>æ–°å¢é¢˜ç›®åŒæ­¥åˆ°es+å¸¦é«˜äº®çš„ç½‘ç«™å…¨æ–‡æœç´¢</h4><p><code>subject-infra</code>çš„<code>SubjectInfoEs.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectInfoEs</span> <span class="keyword">extends</span> <span class="title class_">PageInfo</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long subjectId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long docId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String subjectName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String subjectAnswer;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String createUser;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long createTime;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer subjectType;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String keyWord;</span><br><span class="line"><span class="comment">//ç›¸å…³æ€§çš„åˆ†æ•°ï¼Œæœç´¢çš„ç»“æœ</span></span><br><span class="line">    <span class="keyword">private</span> BigDecimal score;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>subject-infra</code>çš„<code>EsSubjectFields.java</code></p><p>è´Ÿè´£ä¸Elasticsearchï¼ˆESï¼‰çš„äº¤äº’ï¼ŒåŒ…æ‹¬æ•°æ®çš„æ’å…¥å’ŒæŸ¥è¯¢ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EsSubjectFields</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DOC_ID</span> <span class="operator">=</span> <span class="string">&quot;doc_id&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SUBJECT_ID</span> <span class="operator">=</span> <span class="string">&quot;subject_id&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SUBJECT_NAME</span> <span class="operator">=</span> <span class="string">&quot;subject_name&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SUBJECT_ANSWER</span> <span class="operator">=</span> <span class="string">&quot;subject_answer&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SUBJECT_TYPE</span> <span class="operator">=</span> <span class="string">&quot;subject_type&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">CREATE_USER</span> <span class="operator">=</span> <span class="string">&quot;create_user&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">CREATE_TIME</span> <span class="operator">=</span> <span class="string">&quot;create_time&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] FIELD_QUERY = &#123;</span><br><span class="line">            SUBJECT_ID, SUBJECT_NAME, SUBJECT_ANSWER, SUBJECT_TYPE, DOC_ID, CREATE_USER, CREATE_TIME</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>subject-infra</code>çš„<code>SubjectEsService.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SubjectEsService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">insert</span><span class="params">(SubjectInfoEs subjectInfoEs)</span>;</span><br><span class="line"><span class="comment">//åšä¸€ä¸ªåˆ†é¡µçš„</span></span><br><span class="line">    PageResult&lt;SubjectInfoEs&gt; <span class="title function_">querySubjectList</span><span class="params">(SubjectInfoEs subjectInfoEs)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SubjectEsServiceImpl.java</code></p><ol><li><strong>æ’å…¥æ–¹æ³•</strong>ï¼š<code>insert</code>æ–¹æ³•å®ç°äº†å°†<code>SubjectInfoEs</code>å¯¹è±¡è½¬æ¢ä¸ºESçš„æ–‡æ¡£å¹¶æ’å…¥åˆ°ESä¸­ã€‚å®ƒé¦–å…ˆè°ƒç”¨<code>convert2EsSourceData</code>æ–¹æ³•å°†<code>SubjectInfoEs</code>å¯¹è±¡è½¬æ¢ä¸ºESçš„æºæ•°æ®æ ¼å¼ï¼Œç„¶åä½¿ç”¨<code>EsRestClient</code>çš„<code>insertDoc</code>æ–¹æ³•æ‰§è¡Œæ’å…¥æ“ä½œã€‚</li><li><strong>è½¬æ¢æ–¹æ³•</strong>ï¼š<code>convert2EsSourceData</code>æ˜¯ä¸€ä¸ªç§æœ‰æ–¹æ³•ï¼Œç”¨äºå°†<code>SubjectInfoEs</code>å¯¹è±¡çš„å±æ€§è½¬æ¢ä¸ºä¸€ä¸ªMapï¼Œè¿™ä¸ªMapå°†ä½œä¸ºESæ–‡æ¡£çš„æ•°æ®éƒ¨åˆ†ã€‚</li><li><strong>æŸ¥è¯¢æ–¹æ³•</strong>ï¼š<code>querySubjectList</code>æ–¹æ³•å®ç°äº†åˆ†é¡µæŸ¥è¯¢ESä¸­çš„æ•°æ®ã€‚å®ƒé¦–å…ˆåˆ›å»ºä¸€ä¸ª<code>EsSearchRequest</code>æŸ¥è¯¢è¯·æ±‚ï¼Œç„¶åä½¿ç”¨<code>EsRestClient</code>çš„<code>searchWithTermQuery</code>æ–¹æ³•æ‰§è¡ŒæŸ¥è¯¢ï¼Œå¹¶å°†ç»“æœè½¬æ¢ä¸º<code>PageResult&lt;SubjectInfoEs&gt;</code>å¯¹è±¡ã€‚</li><li><strong>ç»“æœè½¬æ¢æ–¹æ³•</strong>ï¼š<code>convertResult</code>æ˜¯ä¸€ä¸ªç§æœ‰æ–¹æ³•ï¼Œç”¨äºå°†ESæŸ¥è¯¢ç»“æœçš„<code>SearchHit</code>è½¬æ¢ä¸º<code>SubjectInfoEs</code>å¯¹è±¡ã€‚å®ƒè¿˜å¤„ç†äº†é«˜äº®æ˜¾ç¤ºæŸ¥è¯¢å…³é”®å­—çš„åŠŸèƒ½ã€‚</li><li><strong>æŸ¥è¯¢æ„å»ºæ–¹æ³•</strong>ï¼š<code>createSearchListQuery</code>æ˜¯ä¸€ä¸ªç§æœ‰æ–¹æ³•ï¼Œç”¨äºæ„å»ºæŸ¥è¯¢è¯·æ±‚ã€‚å®ƒä½¿ç”¨<code>BoolQueryBuilder</code>æ¥æ„å»ºæŸ¥è¯¢æ¡ä»¶ï¼Œå¹¶è®¾ç½®äº†é«˜äº®æ˜¾ç¤ºçš„é…ç½®ã€‚</li><li><strong>è·å–ESç´¢å¼•ä¿¡æ¯æ–¹æ³•</strong>ï¼š<code>getEsIndexInfo</code>æ˜¯ä¸€ä¸ªç§æœ‰æ–¹æ³•ï¼Œç”¨äºè·å–ESçš„ç´¢å¼•ä¿¡æ¯ï¼ŒåŒ…æ‹¬é›†ç¾¤åç§°å’Œç´¢å¼•åç§°ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SubjectEsServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">SubjectEsService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">insert</span><span class="params">(SubjectInfoEs subjectInfoEs)</span> &#123;</span><br><span class="line">        <span class="type">EsSourceData</span> <span class="variable">esSourceData</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EsSourceData</span>();</span><br><span class="line">        Map&lt;String, Object&gt; data = convert2EsSourceData(subjectInfoEs);</span><br><span class="line">        esSourceData.setDocId(subjectInfoEs.getDocId().toString());</span><br><span class="line">        esSourceData.setData(data);</span><br><span class="line">        <span class="keyword">return</span> EsRestClient.insertDoc(getEsIndexInfo(), esSourceData);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Object&gt; <span class="title function_">convert2EsSourceData</span><span class="params">(SubjectInfoEs subjectInfoEs)</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; data = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        data.put(EsSubjectFields.SUBJECT_ID, subjectInfoEs.getSubjectId());</span><br><span class="line">        data.put(EsSubjectFields.DOC_ID, subjectInfoEs.getDocId());</span><br><span class="line">        data.put(EsSubjectFields.SUBJECT_NAME, subjectInfoEs.getSubjectName());</span><br><span class="line">        data.put(EsSubjectFields.SUBJECT_ANSWER, subjectInfoEs.getSubjectAnswer());</span><br><span class="line">        data.put(EsSubjectFields.SUBJECT_TYPE, subjectInfoEs.getSubjectType());</span><br><span class="line">        data.put(EsSubjectFields.CREATE_USER, subjectInfoEs.getCreateUser());</span><br><span class="line">        data.put(EsSubjectFields.CREATE_TIME, subjectInfoEs.getCreateTime());</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//å¸¦é«˜äº®çš„ç½‘ç«™å…¨æ–‡æœç´¢</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> PageResult&lt;SubjectInfoEs&gt; <span class="title function_">querySubjectList</span><span class="params">(SubjectInfoEs req)</span> &#123;</span><br><span class="line">        PageResult&lt;SubjectInfoEs&gt; pageResult = <span class="keyword">new</span> <span class="title class_">PageResult</span>&lt;&gt;();</span><br><span class="line">        <span class="type">EsSearchRequest</span> <span class="variable">esSearchRequest</span> <span class="operator">=</span> createSearchListQuery(req);</span><br><span class="line">        <span class="type">SearchResponse</span> <span class="variable">searchResponse</span> <span class="operator">=</span> EsRestClient.searchWithTermQuery(getEsIndexInfo(), esSearchRequest);</span><br><span class="line"></span><br><span class="line">        List&lt;SubjectInfoEs&gt; subjectInfoEsList = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">SearchHits</span> <span class="variable">searchHits</span> <span class="operator">=</span> searchResponse.getHits();</span><br><span class="line">        <span class="keyword">if</span> (searchHits == <span class="literal">null</span> || searchHits.getHits() == <span class="literal">null</span>) &#123;</span><br><span class="line">            pageResult.setPageNo(req.getPageNo());</span><br><span class="line">            pageResult.setPageSize(req.getPageSize());</span><br><span class="line">            pageResult.setRecords(subjectInfoEsList);</span><br><span class="line">            pageResult.setTotal(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">return</span> pageResult;</span><br><span class="line">        &#125;</span><br><span class="line">        SearchHit[] hits = searchHits.getHits();</span><br><span class="line">        <span class="keyword">for</span> (SearchHit hit : hits) &#123;</span><br><span class="line">            <span class="type">SubjectInfoEs</span> <span class="variable">subjectInfoEs</span> <span class="operator">=</span> convertResult(hit);</span><br><span class="line">            <span class="keyword">if</span> (Objects.nonNull(subjectInfoEs)) &#123;</span><br><span class="line">                subjectInfoEsList.add(subjectInfoEs);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        pageResult.setPageNo(req.getPageNo());</span><br><span class="line">        pageResult.setPageSize(req.getPageSize());</span><br><span class="line">        pageResult.setRecords(subjectInfoEsList);</span><br><span class="line">        pageResult.setTotal(Long.valueOf(searchHits.getTotalHits().value).intValue());</span><br><span class="line">        <span class="keyword">return</span> pageResult;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å°†Elasticsearchæœç´¢ç»“æœçš„SearchHitå¯¹è±¡è½¬æ¢ä¸ºSubjectInfoEså¯¹è±¡ã€‚</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> hit Elasticsearchè¿”å›çš„æœç´¢ç»“æœæ¡ç›®ã€‚</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> è½¬æ¢åçš„SubjectInfoEså¯¹è±¡ï¼Œå¦‚æœç»“æœä¸ºç©ºåˆ™è¿”å›nullã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> SubjectInfoEs <span class="title function_">convertResult</span><span class="params">(SearchHit hit)</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–æœç´¢ç»“æœçš„æºæ•°æ®æ˜ å°„ã€‚</span></span><br><span class="line">    Map&lt;String, Object&gt; sourceAsMap = hit.getSourceAsMap();</span><br><span class="line">    <span class="comment">// å¦‚æœæºæ•°æ®æ˜ å°„ä¸ºç©ºï¼Œåˆ™è¿”å›nullã€‚</span></span><br><span class="line">    <span class="keyword">if</span> (CollectionUtils.isEmpty(sourceAsMap)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆ›å»ºSubjectInfoEså¯¹è±¡ç”¨äºå­˜å‚¨è½¬æ¢ç»“æœã€‚</span></span><br><span class="line">    <span class="type">SubjectInfoEs</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectInfoEs</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// ä»æºæ•°æ®æ˜ å°„ä¸­è·å–é¢˜ç›®IDï¼Œå¹¶è®¾ç½®åˆ°resultå¯¹è±¡ã€‚</span></span><br><span class="line">    result.setSubjectId(MapUtils.getLong(sourceAsMap, EsSubjectFields.SUBJECT_ID));</span><br><span class="line">    <span class="comment">// ä»æºæ•°æ®æ˜ å°„ä¸­è·å–é¢˜ç›®åç§°ï¼Œå¹¶è®¾ç½®åˆ°resultå¯¹è±¡ã€‚</span></span><br><span class="line">    result.setSubjectName(MapUtils.getString(sourceAsMap, EsSubjectFields.SUBJECT_NAME));</span><br><span class="line">    <span class="comment">// ä»æºæ•°æ®æ˜ å°„ä¸­è·å–é¢˜ç›®ç­”æ¡ˆï¼Œå¹¶è®¾ç½®åˆ°resultå¯¹è±¡ã€‚</span></span><br><span class="line">    result.setSubjectAnswer(MapUtils.getString(sourceAsMap, EsSubjectFields.SUBJECT_ANSWER));</span><br><span class="line">    <span class="comment">// ä»æºæ•°æ®æ˜ å°„ä¸­è·å–æ–‡æ¡£IDï¼Œå¹¶è®¾ç½®åˆ°resultå¯¹è±¡ã€‚</span></span><br><span class="line">    result.setDocId(MapUtils.getLong(sourceAsMap, EsSubjectFields.DOC_ID));</span><br><span class="line">    <span class="comment">// ä»æºæ•°æ®æ˜ å°„ä¸­è·å–é¢˜ç›®ç±»å‹ï¼Œå¹¶è®¾ç½®åˆ°resultå¯¹è±¡ã€‚</span></span><br><span class="line">    result.setSubjectType(MapUtils.getInteger(sourceAsMap, EsSubjectFields.SUBJECT_TYPE));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è·å–æœç´¢ç»“æœçš„ç›¸å…³æ€§åˆ†æ•°ï¼Œå¹¶è½¬æ¢ä¸ºç™¾åˆ†æ¯”å½¢å¼ï¼Œè®¾ç½®åˆ°resultå¯¹è±¡ã€‚</span></span><br><span class="line">    result.setScore(<span class="keyword">new</span> <span class="title class_">BigDecimal</span>(String.valueOf(hit.getScore()))</span><br><span class="line">            .multiply(<span class="keyword">new</span> <span class="title class_">BigDecimal</span>(<span class="string">&quot;100.00&quot;</span>).setScale(<span class="number">2</span>, RoundingMode.HALF_UP)));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è·å–é«˜äº®å­—æ®µï¼Œå¤„ç†é¢˜ç›®åç§°çš„é«˜äº®æ˜¾ç¤ºã€‚</span></span><br><span class="line">    Map&lt;String, HighlightField&gt; highlightFields = hit.getHighlightFields();</span><br><span class="line">    <span class="type">HighlightField</span> <span class="variable">subjectNameField</span> <span class="operator">=</span> highlightFields.get(EsSubjectFields.SUBJECT_NAME);</span><br><span class="line">    <span class="keyword">if</span> (Objects.nonNull(subjectNameField)) &#123;</span><br><span class="line">        <span class="comment">// è·å–é¢˜ç›®åç§°çš„é«˜äº®ç‰‡æ®µã€‚</span></span><br><span class="line">        Text[] fragments = subjectNameField.getFragments();</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">subjectNameBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (Text fragment : fragments) &#123;</span><br><span class="line">            <span class="comment">// æ‹¼æ¥é«˜äº®ç‰‡æ®µã€‚</span></span><br><span class="line">            subjectNameBuilder.append(fragment);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è®¾ç½®å¤„ç†åçš„é«˜äº®é¢˜ç›®åç§°ã€‚</span></span><br><span class="line">        result.setSubjectName(subjectNameBuilder.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¤„ç†é¢˜ç›®ç­”æ¡ˆçš„é«˜äº®æ˜¾ç¤ºã€‚</span></span><br><span class="line">    <span class="type">HighlightField</span> <span class="variable">subjectAnswerField</span> <span class="operator">=</span> highlightFields.get(EsSubjectFields.SUBJECT_ANSWER);</span><br><span class="line">    <span class="keyword">if</span> (Objects.nonNull(subjectAnswerField)) &#123;</span><br><span class="line">        Text[] fragments = subjectAnswerField.getFragments();</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">subjectAnswerBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (Text fragment : fragments) &#123;</span><br><span class="line">            subjectAnswerBuilder.append(fragment);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è®¾ç½®å¤„ç†åçš„é«˜äº®é¢˜ç›®ç­”æ¡ˆã€‚</span></span><br><span class="line">        result.setSubjectAnswer(subjectAnswerBuilder.toString());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿”å›å¡«å……å¥½çš„SubjectInfoEså¯¹è±¡ã€‚</span></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ›å»ºä¸€ä¸ªç”¨äºæŸ¥è¯¢é¢˜ç›®åˆ—è¡¨çš„EsSearchRequestå¯¹è±¡ã€‚</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> req åŒ…å«æŸ¥è¯¢æ¡ä»¶çš„SubjectInfoEså¯¹è±¡ã€‚</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> é…ç½®å¥½çš„EsSearchRequestå¯¹è±¡ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> EsSearchRequest <span class="title function_">createSearchListQuery</span><span class="params">(SubjectInfoEs req)</span> &#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºEsSearchRequestå¯¹è±¡ç”¨äºå­˜å‚¨æœç´¢è¯·æ±‚çš„é…ç½®ã€‚</span></span><br><span class="line">    <span class="type">EsSearchRequest</span> <span class="variable">esSearchRequest</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EsSearchRequest</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªå¸ƒå°”æŸ¥è¯¢æ„é€ å™¨ï¼Œç”¨äºç»„åˆå¤šä¸ªæŸ¥è¯¢æ¡ä»¶ã€‚</span></span><br><span class="line">    <span class="type">BoolQueryBuilder</span> <span class="variable">bq</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BoolQueryBuilder</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªåŒ¹é…æŸ¥è¯¢æ„é€ å™¨ï¼Œç”¨äºåŒ¹é…é¢˜ç›®åç§°å­—æ®µã€‚</span></span><br><span class="line">    <span class="type">MatchQueryBuilder</span> <span class="variable">subjectNameQueryBuilder</span> <span class="operator">=</span></span><br><span class="line">            QueryBuilders.matchQuery(EsSubjectFields.SUBJECT_NAME, req.getKeyWord());</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å°†é¢˜ç›®åç§°çš„åŒ¹é…æŸ¥è¯¢æ·»åŠ åˆ°å¸ƒå°”æŸ¥è¯¢ä¸­ï¼Œå¹¶è®¾ç½®æå‡å› å­ä¸º2ï¼Œä»¥æé«˜ç›¸å…³æ€§ã€‚</span></span><br><span class="line">    bq.should(subjectNameQueryBuilder);</span><br><span class="line">    subjectNameQueryBuilder.boost(<span class="number">2</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªåŒ¹é…æŸ¥è¯¢æ„é€ å™¨ï¼Œç”¨äºåŒ¹é…é¢˜ç›®ç­”æ¡ˆå­—æ®µã€‚</span></span><br><span class="line">    <span class="type">MatchQueryBuilder</span> <span class="variable">subjectAnswerQueryBuilder</span> <span class="operator">=</span></span><br><span class="line">            QueryBuilders.matchQuery(EsSubjectFields.SUBJECT_ANSWER, req.getKeyWord());</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å°†é¢˜ç›®ç­”æ¡ˆçš„åŒ¹é…æŸ¥è¯¢æ·»åŠ åˆ°å¸ƒå°”æŸ¥è¯¢ä¸­ã€‚</span></span><br><span class="line">    bq.should(subjectAnswerQueryBuilder);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªåŒ¹é…æŸ¥è¯¢æ„é€ å™¨ï¼Œç”¨äºåŒ¹é…é¢˜ç›®ç±»å‹å­—æ®µï¼Œå¿…é¡»æ˜¯ç®€ç­”é¢˜ç±»å‹ã€‚</span></span><br><span class="line">    <span class="type">MatchQueryBuilder</span> <span class="variable">subjectTypeQueryBuilder</span> <span class="operator">=</span></span><br><span class="line">            QueryBuilders.matchQuery(EsSubjectFields.SUBJECT_TYPE, SubjectInfoTypeEnum.BRIEF.getCode());</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å¿…é¡»åŒ¹é…é¢˜ç›®ç±»å‹çš„æŸ¥è¯¢æ·»åŠ åˆ°å¸ƒå°”æŸ¥è¯¢ä¸­ã€‚</span></span><br><span class="line">    bq.must(subjectTypeQueryBuilder);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è®¾ç½®è‡³å°‘åº”è¯¥åŒ¹é…çš„shouldå­å¥çš„æ•°é‡ä¸º1ã€‚</span></span><br><span class="line">    bq.minimumShouldMatch(<span class="number">1</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆ›å»ºé«˜äº®æ˜¾ç¤ºæ„é€ å™¨ï¼Œè®¾ç½®é«˜äº®æ˜¾ç¤ºçš„å‰ç¼€å’Œåç¼€æ ‡ç­¾ã€‚</span></span><br><span class="line">    <span class="type">HighlightBuilder</span> <span class="variable">highlightBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HighlightBuilder</span>().field(<span class="string">&quot;*&quot;</span>).requireFieldMatch(<span class="literal">false</span>);</span><br><span class="line">    highlightBuilder.preTags(<span class="string">&quot;&lt;span style = \&quot;color:red\&quot;&gt;&quot;</span>);</span><br><span class="line">    highlightBuilder.postTags(<span class="string">&quot;&lt;/span&gt;&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è®¾ç½®EsSearchRequestå¯¹è±¡çš„å¸ƒå°”æŸ¥è¯¢æ„é€ å™¨ã€‚</span></span><br><span class="line">    esSearchRequest.setBq(bq);</span><br><span class="line">    <span class="comment">// è®¾ç½®é«˜äº®æ˜¾ç¤ºæ„é€ å™¨ã€‚</span></span><br><span class="line">    esSearchRequest.setHighlightBuilder(highlightBuilder);</span><br><span class="line">    <span class="comment">// è®¾ç½®éœ€è¦è¿”å›çš„å­—æ®µã€‚</span></span><br><span class="line">    esSearchRequest.setFields(EsSubjectFields.FIELD_QUERY);</span><br><span class="line">    <span class="comment">// è®¾ç½®ä»ç¬¬å‡ ä¸ªæ–‡æ¡£å¼€å§‹è¿”å›ç»“æœï¼Œç”¨äºåˆ†é¡µã€‚</span></span><br><span class="line">    esSearchRequest.setFrom((req.getPageNo() - <span class="number">1</span>) * req.getPageSize());</span><br><span class="line">    <span class="comment">// è®¾ç½®æ¯é¡µè¿”å›çš„æ–‡æ¡£æ•°é‡ã€‚</span></span><br><span class="line">    esSearchRequest.setSize(req.getPageSize());</span><br><span class="line">    <span class="comment">// è®¾ç½®ä¸éœ€è¦æ»šåŠ¨æœç´¢ã€‚</span></span><br><span class="line">    esSearchRequest.setNeedScroll(<span class="literal">false</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// è¿”å›é…ç½®å¥½çš„æœç´¢è¯·æ±‚å¯¹è±¡ã€‚</span></span><br><span class="line">    <span class="keyword">return</span> esSearchRequest;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> EsIndexInfo <span class="title function_">getEsIndexInfo</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">EsIndexInfo</span> <span class="variable">esIndexInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">EsIndexInfo</span>();</span><br><span class="line">        esIndexInfo.setClusterName(<span class="string">&quot;73438a827b55&quot;</span>);</span><br><span class="line">        esIndexInfo.setIndexName(<span class="string">&quot;subject_index&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> esIndexInfo;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SubjectInfoDomainServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(SubjectInfoBO subjectInfoBO)</span> &#123;</span><br><span class="line">    ......</span><br><span class="line">    <span class="comment">//åŒæ­¥åˆ°es</span></span><br><span class="line">    <span class="type">SubjectInfoEs</span> <span class="variable">subjectInfoEs</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectInfoEs</span>();</span><br><span class="line">    subjectInfoEs.setDocId(<span class="keyword">new</span> <span class="title class_">IdWorkerUtil</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>).nextId());</span><br><span class="line">    subjectInfoEs.setSubjectId(subjectInfo.getId());</span><br><span class="line">    subjectInfoEs.setSubjectAnswer(subjectInfoBO.getSubjectAnswer());</span><br><span class="line">    subjectInfoEs.setCreateTime(<span class="keyword">new</span> <span class="title class_">Date</span>().getTime());</span><br><span class="line">    subjectInfoEs.setCreateUser(<span class="string">&quot;lzrj&quot;</span>);</span><br><span class="line">    subjectInfoEs.setSubjectName(subjectInfo.getSubjectName());</span><br><span class="line">    subjectInfoEs.setSubjectType(subjectInfo.getSubjectType());</span><br><span class="line">    subjectEsService.insert(subjectInfoEs);</span><br><span class="line">   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SubjectController.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å…¨æ–‡æ£€ç´¢</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/getSubjectPageBySearch&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;PageResult&lt;SubjectInfoEs&gt;&gt; <span class="title function_">getSubjectPageBySearch</span><span class="params">(<span class="meta">@RequestBody</span> SubjectInfoDTO subjectInfoDTO)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;SubjectController.getSubjectPageBySearch.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(subjectInfoDTO));</span><br><span class="line">        &#125;</span><br><span class="line">        Preconditions.checkArgument(StringUtils.isNotBlank(subjectInfoDTO.getKeyWord()), <span class="string">&quot;å…³é”®è¯ä¸èƒ½ä¸ºç©º&quot;</span>);</span><br><span class="line">        <span class="type">SubjectInfoBO</span> <span class="variable">subjectInfoBO</span> <span class="operator">=</span> SubjectInfoDTOConverter.INSTANCE.convertDTOToBO(subjectInfoDTO);</span><br><span class="line">        subjectInfoBO.setPageNo(subjectInfoDTO.getPageNo());</span><br><span class="line">        subjectInfoBO.setPageSize(subjectInfoDTO.getPageSize());</span><br><span class="line">        PageResult&lt;SubjectInfoEs&gt; boPageResult = subjectInfoDomainService.getSubjectPageBySearch(subjectInfoBO);</span><br><span class="line">        <span class="keyword">return</span> Result.ok(boPageResult);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;SubjectCategoryController.getSubjectPageBySearch.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        <span class="keyword">return</span> Result.fail(<span class="string">&quot;å…¨æ–‡æ£€ç´¢å¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SubjectInfoDomainServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> PageResult&lt;SubjectInfoEs&gt; <span class="title function_">getSubjectPageBySearch</span><span class="params">(SubjectInfoBO subjectInfoBO)</span> &#123;</span><br><span class="line">    <span class="type">SubjectInfoEs</span> <span class="variable">subjectInfoEs</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectInfoEs</span>();</span><br><span class="line">    subjectInfoEs.setPageNo(subjectInfoBO.getPageNo());</span><br><span class="line">    subjectInfoEs.setPageSize(subjectInfoBO.getPageSize());</span><br><span class="line">    subjectInfoEs.setKeyWord(subjectInfoBO.getKeyWord());</span><br><span class="line">    <span class="keyword">return</span> subjectEsService.querySubjectList(subjectInfoEs);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ‰‹å†™Mybatisæ‹¦æˆªå™¨è‡ªåŠ¨å¡«å……æ•°æ®-æ–¹æ³•çº§åˆ«æ‹¦æˆªå™¨"><a href="#æ‰‹å†™Mybatisæ‹¦æˆªå™¨è‡ªåŠ¨å¡«å……æ•°æ®-æ–¹æ³•çº§åˆ«æ‹¦æˆªå™¨" class="headerlink" title="æ‰‹å†™Mybatisæ‹¦æˆªå™¨è‡ªåŠ¨å¡«å……æ•°æ®(æ–¹æ³•çº§åˆ«æ‹¦æˆªå™¨)"></a>æ‰‹å†™Mybatisæ‹¦æˆªå™¨è‡ªåŠ¨å¡«å……æ•°æ®(æ–¹æ³•çº§åˆ«æ‹¦æˆªå™¨)</h3><p><code>LoginContextHolder</code>å’Œ<code>LoginUtil</code>éƒ½æ”¾åœ¨<code>common</code>å±‚é‡Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¡«å……createBy, createTimeç­‰å…¬å…±å­—æ®µçš„æ‹¦æˆªå™¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="comment">// å£°æ˜æ‹¦æˆªå™¨ï¼ŒæŒ‡å®šè¦æ‹¦æˆªçš„Executorç±»ä¸­çš„updateæ–¹æ³•ï¼Œä»¥åŠè¯¥æ–¹æ³•çš„å‚æ•°ç±»å‹</span></span><br><span class="line"><span class="meta">@Intercepts(&#123;</span></span><br><span class="line"><span class="meta">    @Signature(type = Executor.class, method = &quot;update&quot;, args = &#123;MappedStatement.class, Object.class&#125;)</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisInterceptor</span> <span class="keyword">implements</span> <span class="title class_">Interceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">intercept</span><span class="params">(Invocation invocation)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="comment">// è·å–æ‹¦æˆªæ–¹æ³•çš„å‚æ•°</span></span><br><span class="line">        <span class="type">MappedStatement</span> <span class="variable">mappedStatement</span> <span class="operator">=</span> (MappedStatement) invocation.getArgs()[<span class="number">0</span>];</span><br><span class="line">        <span class="type">SqlCommandType</span> <span class="variable">sqlCommandType</span> <span class="operator">=</span> mappedStatement.getSqlCommandType();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">parameter</span> <span class="operator">=</span> invocation.getArgs()[<span class="number">1</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å¦‚æœå‚æ•°ä¸ºç©ºï¼Œç›´æ¥æ‰§è¡ŒåŸæ–¹æ³•</span></span><br><span class="line">        <span class="keyword">if</span> (parameter == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> invocation.proceed();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è·å–å½“å‰ç™»å½•ç”¨æˆ·çš„id</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">loginId</span> <span class="operator">=</span> LoginUtil.getLoginId();</span><br><span class="line">        <span class="comment">// å¦‚æœæ²¡æœ‰ç™»å½•ç”¨æˆ·ï¼Œç›´æ¥æ‰§è¡ŒåŸæ–¹æ³•</span></span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isBlank(loginId)) &#123;</span><br><span class="line">            <span class="keyword">return</span> invocation.proceed();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ ¹æ®SqlCommandTypeæ˜¯INSERTæˆ–UPDATEï¼Œè°ƒç”¨ä¸åŒçš„å¤„ç†æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">if</span> (SqlCommandType.INSERT == sqlCommandType || SqlCommandType.UPDATE == sqlCommandType) &#123;</span><br><span class="line">            replaceEntityProperty(parameter, loginId, sqlCommandType);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ‰§è¡ŒåŸæ–¹æ³•</span></span><br><span class="line">        <span class="keyword">return</span> invocation.proceed();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®ä¸åŒçš„å‚æ•°ç±»å‹ï¼Œè°ƒç”¨ä¸åŒçš„å±æ€§æ›¿æ¢æ–¹æ³•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> parameter æ‹¦æˆªæ–¹æ³•çš„å‚æ•°å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> loginId å½“å‰ç™»å½•ç”¨æˆ·çš„id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sqlCommandType SQLå‘½ä»¤ç±»å‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">replaceEntityProperty</span><span class="params">(Object parameter, String loginId, SqlCommandType sqlCommandType)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (parameter <span class="keyword">instanceof</span> Map) &#123;</span><br><span class="line">            replaceMap((Map) parameter, loginId, sqlCommandType);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            replace(parameter, loginId, sqlCommandType);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤„ç†Mapç±»å‹çš„å‚æ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> parameter Mapå‚æ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> loginId ç™»å½•ç”¨æˆ·çš„id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sqlCommandType SQLå‘½ä»¤ç±»å‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">replaceMap</span><span class="params">(Map parameter, String loginId, SqlCommandType sqlCommandType)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span> (Object val : parameter.values()) &#123;</span><br><span class="line">            replace(val, loginId, sqlCommandType);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤„ç†æ™®é€šå¯¹è±¡æˆ–é›†åˆç±»å‹çš„å‚æ•°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> parameter å‚æ•°å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> loginId ç™»å½•ç”¨æˆ·çš„id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sqlCommandType SQLå‘½ä»¤ç±»å‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">replace</span><span class="params">(Object parameter, String loginId, SqlCommandType sqlCommandType)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (SqlCommandType.INSERT == sqlCommandType) &#123;</span><br><span class="line">        dealInsert(parameter, loginId);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        dealUpdate(parameter, loginId);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å¤„ç†UPDATEæ“ä½œçš„å­—æ®µæ›¿æ¢</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> parameter å‚æ•°å¯¹è±¡</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> loginId ç™»å½•ç”¨æˆ·çš„id</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">dealUpdate</span><span class="params">(Object parameter, String loginId)</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–æ‰€æœ‰å­—æ®µï¼ŒåŒ…æ‹¬ç»§æ‰¿çš„å­—æ®µ</span></span><br><span class="line">    Field[] fields = getAllFields(parameter);</span><br><span class="line">    <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">// å¦‚æœå­—æ®µå·²ç»æœ‰å€¼ï¼Œåˆ™è·³è¿‡</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> field.get(parameter);</span><br><span class="line">        <span class="keyword">if</span> (Objects.nonNull(o)) &#123;</span><br><span class="line">          field.setAccessible(<span class="literal">false</span>);</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ ¹æ®å­—æ®µåè®¾ç½®ä¸åŒçš„å€¼</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;updateBy&quot;</span>.equals(field.getName())) &#123;</span><br><span class="line">          field.set(parameter, loginId);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;updateTime&quot;</span>.equals(field.getName())) &#123;</span><br><span class="line">          field.set(parameter, <span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// å…¶ä»–å­—æ®µä¸å¤„ç†</span></span><br><span class="line">        &#125;</span><br><span class="line">        field.setAccessible(<span class="literal">false</span>);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;dealUpdate.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * å¤„ç†INSERTæ“ä½œçš„å­—æ®µæ›¿æ¢</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> parameter å‚æ•°å¯¹è±¡</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> loginId ç™»å½•ç”¨æˆ·çš„id</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">dealInsert</span><span class="params">(Object parameter, String loginId)</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–æ‰€æœ‰å­—æ®µï¼ŒåŒ…æ‹¬ç»§æ‰¿çš„å­—æ®µ</span></span><br><span class="line">    Field[] fields = getAllFields(parameter);</span><br><span class="line">    <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">// å¦‚æœå­—æ®µå·²ç»æœ‰å€¼ï¼Œåˆ™è·³è¿‡</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">o</span> <span class="operator">=</span> field.get(parameter);</span><br><span class="line">        <span class="keyword">if</span> (Objects.nonNull(o)) &#123;</span><br><span class="line">          field.setAccessible(<span class="literal">false</span>);</span><br><span class="line">          <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ ¹æ®å­—æ®µåè®¾ç½®ä¸åŒçš„å€¼</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;isDeleted&quot;</span>.equals(field.getName())) &#123;</span><br><span class="line">          field.set(parameter, <span class="number">0</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;createdBy&quot;</span>.equals(field.getName())) &#123;</span><br><span class="line">          field.set(parameter, loginId);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;createdTime&quot;</span>.equals(field.getName())) &#123;</span><br><span class="line">          field.set(parameter, <span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="comment">// å…¶ä»–å­—æ®µä¸å¤„ç†</span></span><br><span class="line">        &#125;</span><br><span class="line">        field.setAccessible(<span class="literal">false</span>);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;dealInsert.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * é€’å½’è·å–å¯¹è±¡æ‰€æœ‰å­—æ®µï¼ŒåŒ…æ‹¬çˆ¶ç±»çš„å­—æ®µ</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> object å¯¹è±¡</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> å­—æ®µæ•°ç»„</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> Field[] getAllFields(Object object) &#123;</span><br><span class="line">    Class&lt;?&gt; clazz = object.getClass();</span><br><span class="line">    List&lt;Field&gt; fieldList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">while</span> (clazz != <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="comment">// æ·»åŠ å½“å‰ç±»çš„æ‰€æœ‰å­—æ®µåˆ°åˆ—è¡¨</span></span><br><span class="line">      fieldList.addAll(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(Arrays.asList(clazz.getDeclaredFields())));</span><br><span class="line">      clazz = clazz.getSuperclass();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è½¬æ¢åˆ—è¡¨ä¸ºæ•°ç»„</span></span><br><span class="line">    Field[] fields = <span class="keyword">new</span> <span class="title class_">Field</span>[fieldList.size()];</span><br><span class="line">    fieldList.toArray(fields);</span><br><span class="line">    <span class="keyword">return</span> fields;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// MyBatisæ’ä»¶æ¥å£æ–¹æ³•ï¼Œå®é™…ä½¿ç”¨æ—¶ä¼šå¢å¼ºç›®æ ‡å¯¹è±¡</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> Object <span class="title function_">plugin</span><span class="params">(Object target)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Plugin.wrap(target, <span class="built_in">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç”¨äºæ¥æ”¶MyBatisä¼ å…¥çš„å±æ€§ï¼Œä¸€èˆ¬ä¸ä½¿ç”¨</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setProperties</span><span class="params">(Properties properties)</span> &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é¢˜ç›®æ’è¡Œæ¦œåŠŸèƒ½è®¾è®¡"><a href="#é¢˜ç›®æ’è¡Œæ¦œåŠŸèƒ½è®¾è®¡" class="headerlink" title="é¢˜ç›®æ’è¡Œæ¦œåŠŸèƒ½è®¾è®¡"></a>é¢˜ç›®æ’è¡Œæ¦œåŠŸèƒ½è®¾è®¡</h3><p>æ’è¡Œæ¦œä¸€èˆ¬æ¥è¯´å®æ—¶çš„ï¼Œéå®æ—¶çš„ã€‚</p><p><strong>å®æ—¶çš„æ–¹æ¡ˆ</strong></p><ol><li><strong>æ•°æ®åº“ç»Ÿè®¡</strong></li></ol><p>ç°åœ¨æ•°æ®åº“é‡Œé¢çš„ createby å­—æ®µã€‚ç”¨æˆ·çš„æ ‡è¯†æ˜¯å”¯ä¸€çš„ï¼Œé‚£æˆ‘ç›´æ¥é€šè¿‡ group by çš„å½¢å¼ç»Ÿè®¡ countã€‚</p><p>select count(1),create_by from subject_info group by create_by limit 0,5;</p><p>æ•°æ®é‡æ¯”è¾ƒå°ï¼Œå¹¶å‘ä¹Ÿæ¯”è¾ƒå°ã€‚è¿™ç§æ–¹æ¡ˆæ˜¯ ok çš„ã€‚ä¿è¯å¯ä»¥èµ°åˆ°ç´¢å¼•ï¼Œè¿”å›é€Ÿåº¦å¿«ï¼Œä¸è¦äº§ç”Ÿæ…¢ sqlã€‚</p><p>åœ¨æ•°æ®åº“å±‚é¢åŠ ä¸€å±‚ç¼“å­˜ï¼Œæ¥å—ä¸€å®šçš„å»¶æ—¶æ€§ã€‚</p><ol start="2"><li><p><strong>redis çš„ sorted set</strong></p><p>æœ‰åºé›†åˆï¼Œä¸å…è®¸é‡å¤çš„æˆå‘˜ï¼Œç„¶åæ¯ä¸€ä¸ª key éƒ½ä¼šåŒ…å«ä¸€ä¸ª score åˆ†æ•°çš„æ¦‚å¿µã€‚redis æ ¹æ®åˆ†æ•°å¯ä»¥å¸®åŠ©æˆ‘ä»¬åšä»å°åˆ°å¤§ï¼Œå’Œä»å¤§åˆ°å°çš„ä¸€ä¸ªå¤„ç†ã€‚</p><p>æœ‰åºé›†åˆçš„ key ä¸å¯é‡å¤ï¼Œscore é‡å¤ã€‚</p><p>å®ƒé€šè¿‡æˆ‘ä»¬çš„ä¸€ä¸ªå“ˆå¸Œè¡¨æ¥å®ç°çš„ï¼Œæ·»åŠ ï¼Œåˆ é™¤ï¼ŒæŸ¥æ‰¾ï¼Œå¤æ‚åº¦ o(1) ï¼Œæœ€å¤§æ•°é‡æ˜¯ 2çš„32 æ¬¡æ–¹-1ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">zadd</span><br><span class="line"></span><br><span class="line">zrange</span><br><span class="line"></span><br><span class="line">zincrby</span><br><span class="line"></span><br><span class="line">zscore</span><br></pre></td></tr></table></figure><p>è¿™ç§çš„å¥½å¤„åœ¨äºï¼Œå®Œå…¨ä¸ç”¨å’Œæ•°æ®åº“åšä»»ä½•çš„äº¤äº’ï¼Œçº¯çº¯çš„é€šè¿‡ç¼“å­˜æ¥åšï¼Œé€Ÿåº¦éå¸¸å¿«ï¼Œè¦é¿å…ä¸€äº›å¤§ key çš„é—®é¢˜ã€‚</p></li></ol><p><strong>éå®æ—¶</strong></p><p>å®šæ—¶ä»»åŠ¡ xxl-job</p><p>ç»Ÿè®¡æ•°æ®åº“çš„æ•°æ®å½¢å¼ï¼Œå¸®åŠ©æˆ‘ä»¬ç»Ÿè®¡å®Œæˆåï¼Œç›´æ¥å†™å…¥ç¼“å­˜ã€‚ç¼“å­˜çš„å¤–éƒ¨çš„äº¤äº’å±•ç¤ºã€‚</p><h4 id="ä¼ ç»Ÿæ•°æ®åº“å®ç°æ’è¡Œæ¦œ"><a href="#ä¼ ç»Ÿæ•°æ®åº“å®ç°æ’è¡Œæ¦œ" class="headerlink" title="ä¼ ç»Ÿæ•°æ®åº“å®ç°æ’è¡Œæ¦œ"></a>ä¼ ç»Ÿæ•°æ®åº“å®ç°æ’è¡Œæ¦œ</h4><p><code>SubjectController.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è·å–é¢˜ç›®è´¡çŒ®æ¦œ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/getContributeList&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;List&lt;SubjectInfoDTO&gt;&gt; <span class="title function_">getContributeList</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        List&lt;SubjectInfoBO&gt; boList = subjectInfoDomainService.getContributeList();</span><br><span class="line">        List&lt;SubjectInfoDTO&gt; dtoList = SubjectInfoDTOConverter.INSTANCE.convertBOToDTOList(boList);</span><br><span class="line">        <span class="keyword">return</span> Result.ok(dtoList);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;SubjectCategoryController.getContributeList.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        <span class="keyword">return</span> Result.fail(<span class="string">&quot;è·å–è´¡çŒ®æ¦œå¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>SubjectDomainInfoServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;SubjectInfoBO&gt; <span class="title function_">getContributeList</span><span class="params">()</span> &#123;</span><br><span class="line">    List&lt;SubjectInfo&gt; subjectInfoList = subjectInfoService.getContributeCount();</span><br><span class="line">    <span class="keyword">if</span> (CollectionUtils.isEmpty(subjectInfoList)) &#123;</span><br><span class="line">        <span class="keyword">return</span> Collections.emptyList();</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;SubjectInfoBO&gt; boList = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    subjectInfoList.forEach((subjectInfo -&gt; &#123;</span><br><span class="line">        <span class="type">SubjectInfoBO</span> <span class="variable">subjectInfoBO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectInfoBO</span>();</span><br><span class="line">        subjectInfoBO.setSubjectCount(subjectInfo.getSubjectCount());</span><br><span class="line">        <span class="comment">//è¿™é‡Œç”¨åˆ°äº†UserRpc</span></span><br><span class="line">        <span class="type">UserInfo</span> <span class="variable">userInfo</span> <span class="operator">=</span> userRpc.getUserInfo(subjectInfo.getCreatedBy());</span><br><span class="line">        subjectInfoBO.setCreateUser(userInfo.getNickName());</span><br><span class="line">        subjectInfoBO.setCreateUserAvatar(userInfo.getAvatar());</span><br><span class="line">        boList.add(subjectInfoBO);</span><br><span class="line">    &#125;));</span><br><span class="line">    <span class="keyword">return</span> boList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>UserRpc.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserRpc</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> UserFeignService userFeignService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> UserInfo <span class="title function_">getUserInfo</span><span class="params">(String userName)</span> &#123;</span><br><span class="line">        <span class="type">AuthUserDTO</span> <span class="variable">authUserDTO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AuthUserDTO</span>();</span><br><span class="line">        authUserDTO.setUserName(userName);</span><br><span class="line">        Result&lt;AuthUserDTO&gt; result = userFeignService.getUserInfo(authUserDTO);</span><br><span class="line">        <span class="type">UserInfo</span> <span class="variable">userInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserInfo</span>();</span><br><span class="line">        <span class="keyword">if</span> (!result.getSuccess()) &#123;</span><br><span class="line">            <span class="keyword">return</span> userInfo;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">AuthUserDTO</span> <span class="variable">data</span> <span class="operator">=</span> result.getData();</span><br><span class="line">        userInfo.setUserName(data.getUserName());</span><br><span class="line">        userInfo.setNickName(data.getNickName());</span><br><span class="line">        <span class="comment">//æ–°å¢ è®¾ç½®å¤´åƒ</span></span><br><span class="line">        userInfo.setAvatar(data.getAvatar());</span><br><span class="line">        <span class="keyword">return</span> userInfo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>subjectInfoServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;SubjectInfo&gt; <span class="title function_">getContributeCount</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.subjectInfoDao.getContributeCount();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SubjectInfoDao.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;getContributeCount&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.jingdianjichi.subject.infra.basic.entity.SubjectInfo&quot;</span>&gt;</span></span><br><span class="line">    select count(1) as subjectCount,</span><br><span class="line">           created_by as createdBy</span><br><span class="line">    from subject_info</span><br><span class="line">    where is_deleted = 0</span><br><span class="line">    and created_by is not null</span><br><span class="line">    group by created_by</span><br><span class="line">    limit 0,5</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="åŸºäºredisçš„zsetå®ç°æ’è¡Œæ¦œ"><a href="#åŸºäºredisçš„zsetå®ç°æ’è¡Œæ¦œ" class="headerlink" title="åŸºäºredisçš„zsetå®ç°æ’è¡Œæ¦œ"></a>åŸºäºredisçš„zsetå®ç°æ’è¡Œæ¦œ</h4><p><code>subject-domain/pom.xml</code></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-pool2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>subject-doamin/RedisUtil.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Set&lt;ZSetOperations.TypedTuple&lt;String&gt;&gt; rankWithScore(String key, <span class="type">long</span> start, <span class="type">long</span> end) &#123;</span><br><span class="line">    Set&lt;ZSetOperations.TypedTuple&lt;String&gt;&gt; set = redisTemplate.opsForZSet().reverseRangeWithScores(key, start, end);</span><br><span class="line">    <span class="keyword">return</span> set;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/fuzhijieabc/article/details/123805608?ops_request_misc=%7B%22request_id%22:%22172447209416800188585058%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172447209416800188585058&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-123805608-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=reverseRangeWithScores&spm=1018.2226.3001.4187">redisâ€”â€”Zsetæœ‰åºé›†åˆä¹‹reverseRangeWithScoreå‡½æ•°ä½¿ç”¨_reverserangewithscores-CSDNåšå®¢</a></p><p><code>SubjectInfoDomainServiceImpl.java</code></p><p>æ’è¡Œæ¦œæ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">RANK_KEY</span> <span class="operator">=</span> <span class="string">&quot;subject_rank&quot;</span>;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;SubjectInfoBO&gt; <span class="title function_">getContributeList</span><span class="params">()</span> &#123;</span><br><span class="line">    Set&lt;ZSetOperations.TypedTuple&lt;String&gt;&gt; typedTuples = redisUtil.rankWithScore(RANK_KEY, <span class="number">0</span>, <span class="number">5</span>);</span><br><span class="line">    <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">        log.info(<span class="string">&quot;getContributeList.typedTuples:&#123;&#125;&quot;</span>, JSON.toJSONString(typedTuples));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (CollectionUtils.isEmpty(typedTuples)) &#123;</span><br><span class="line">        <span class="keyword">return</span> Collections.emptyList();</span><br><span class="line">    &#125;</span><br><span class="line">    List&lt;SubjectInfoBO&gt; boList = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    typedTuples.forEach((rank -&gt; &#123;</span><br><span class="line">        <span class="type">SubjectInfoBO</span> <span class="variable">subjectInfoBO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectInfoBO</span>();</span><br><span class="line">        subjectInfoBO.setSubjectCount(rank.getScore().intValue());</span><br><span class="line">        <span class="comment">// è¿™ä¸ªæ˜¯openId</span></span><br><span class="line">        <span class="type">UserInfo</span> <span class="variable">userInfo</span> <span class="operator">=</span> userRpc.getUserInfo(rank.getValue());</span><br><span class="line">        subjectInfoBO.setCreateUser(userInfo.getNickName());</span><br><span class="line">        subjectInfoBO.setCreateUserAvatar(userInfo.getAvatar());</span><br><span class="line">        boList.add(subjectInfoBO);</span><br><span class="line">    &#125;));</span><br><span class="line">    <span class="comment">// è¿”å›ä¸€ä¸ªåŒ…å«é¢˜ç›®ä¿¡æ¯çš„list</span></span><br><span class="line">    <span class="keyword">return</span> boList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç‚¹èµå’Œæ”¶è—"><a href="#ç‚¹èµå’Œæ”¶è—" class="headerlink" title="ç‚¹èµå’Œæ”¶è—"></a>ç‚¹èµå’Œæ”¶è—</h3><h4 id="ç‚¹èµå’Œæ”¶è—åŠŸèƒ½è®¾è®¡"><a href="#ç‚¹èµå’Œæ”¶è—åŠŸèƒ½è®¾è®¡" class="headerlink" title="ç‚¹èµå’Œæ”¶è—åŠŸèƒ½è®¾è®¡"></a>ç‚¹èµå’Œæ”¶è—åŠŸèƒ½è®¾è®¡</h4><p>ç‚¹èµä¸æ”¶è—çš„é€»è¾‘æ˜¯éå¸¸ä¸€æ ·çš„ï¼Œæˆ‘ä»¬è¿™é‡Œå°±é€‰å–ç‚¹èµåŠŸèƒ½æ¥ç»™å¤§å®¶åšå¼€å‘ã€‚</p><p>æŒ‰ç…§æˆ‘ä»¬çš„ç¨‹åºå‘˜ club çš„è®¾è®¡ï¼Œç‚¹èµä¸šåŠ¡å…¶å®æ¶‰åŠå‡ ä¸ªæ–¹é¢ï¼š</p><ul><li>æˆ‘ä»¬è‚¯å®šè¦çŸ¥é“ä¸€ä¸ªé¢˜ç›®è¢«å¤šå°‘äººç‚¹è¿‡èµ</li><li>è¿˜è¦çŸ¥é“ï¼Œæ¯ä¸ªäººä»–ç‚¹èµäº†å“ªäº›é¢˜ç›®ã€‚</li></ul><p>ç‚¹èµçš„ä¸šåŠ¡ç‰¹æ€§ï¼šé¢‘ç¹ã€‚ç”¨æˆ·ä¸€å¤šï¼Œæ—¶æ—¶åˆ»åˆ»éƒ½åœ¨è¿›è¡Œç‚¹èµå•Šï¼Œæ”¶è—å•Šç­‰ç­‰å¤„ç†ï¼Œå¦‚æœè¯´æˆ‘ä»¬é‡‡å–ä¼ ç»Ÿçš„æ•°æ®åº“çš„æ¨¡å¼å•Šï¼Œè¿™ä¸ªäº¤äº’é‡æ˜¯éå¸¸å¤§çš„ï¼Œå¾ˆéš¾å»æŠ—ä½è¿™ä¸ªå¹¶å‘é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬é‡‡å– redis çš„æ–¹å¼æ¥åšã€‚</p><p>æŸ¥è¯¢çš„æ•°æ®äº¤äº’ï¼Œæˆ‘ä»¬å¯ä»¥å’Œ redis ç›´æ¥æ¥åšï¼ŒæŒä¹…åŒ–çš„æ•°æ®ï¼Œé€šè¿‡æ•°æ®åº“æŸ¥è¯¢å³å¯ï¼Œè¿™ä¸ªæ•°æ®å¦‚ä½•å»åŒæ­¥åˆ°æ•°æ®åº“ï¼Œæˆ‘ä»¬å°±é‡‡å–çš„å®šæ—¶ä»»åŠ¡ xxl-job å®šæœŸæ¥åˆ·æ•°æ®ã€‚</p><p><img src="https://s2.loli.net/2024/08/24/IHPpxkGLXu3adjD.png" alt="image-20240824121946908.png"></p><p>è®°å½•çš„æ—¶å€™ä¸‰ä¸ªå…³é”®ä¿¡æ¯ï¼Œç‚¹èµçš„äººï¼Œè¢«ç‚¹èµçš„é¢˜ç›®ï¼Œç‚¹èµçš„çŠ¶æ€ã€‚</p><p>æˆ‘ä»¬æœ€ç»ˆçš„æ•°æ®ç»“æ„å°±æ˜¯ hashï¼Œstring ç±»å‹ã€‚</p><ul><li>hashï¼Œå­˜åˆ°ä¸€ä¸ªé”®é‡Œé¢ï¼Œé”®é‡Œæ˜¯ä¸€ä¸ª mapï¼Œä»–åˆåˆ†ä¸º hashkey å’Œ hashvalã€‚<ul><li>è°ç‚¹èµäº†å“ªä¸ªé¢˜ç›®+çŠ¶æ€ï¼šhashkeyï¼ŒsubjectId:userIdï¼Œval å°±å­˜çš„æ˜¯ç‚¹èµçš„çŠ¶æ€ 1 æ˜¯ç‚¹èµ 0 æ˜¯ä¸ç‚¹èµã€‚</li><li>ç‚¹èµæ•°é‡ï¼šstring ç±»å‹ key subjectIdï¼Œval å³ä½¿æˆ‘ä»¬çš„é¢˜ç›®è¢«ç‚¹èµçš„æ•°é‡ã€‚</li><li>æœ‰æ²¡æœ‰ç‚¹è¿‡èµï¼Œkeyå­˜åœ¨è¯´æ˜ç‚¹è¿‡ï¼ˆå¹¶éè®°å½•çŠ¶æ€ï¼‰ï¼škeyä¸ºstring ç±»å‹ï¼Œ subjectId:userIdã€‚</li></ul></li></ul><p><strong>è¡¨ç»“æ„ï¼š</strong></p><p><img src="https://s2.loli.net/2024/08/24/IGp3lt4YMgxVOui.png" alt="image-20240824123024005.png"></p><p><strong>æ–°å¢ç‚¹èµ</strong></p><p>ç›´æ¥æ“ä½œ redis</p><p>å­˜ hashï¼Œå­˜æ•°é‡ï¼Œå­˜ç‚¹èµçš„äººä¸é¢˜ç›®çš„ keyã€‚</p><p><strong>å–æ¶ˆç‚¹èµ</strong></p><p>ä¸Šé¢çš„åé€»è¾‘ï¼Œæ•°é‡ä¼š-1ï¼Œhash é‡Œé¢çš„çŠ¶æ€ä¼šæ›´æ–°ï¼Œç‚¹èµäººä¸é¢˜ç›®å…³è”çš„ key ä¼šè¢«åˆ é™¤</p><p><strong>æŸ¥è¯¢å½“å‰é¢˜ç›®è¢«ç‚¹èµçš„æ•°é‡</strong></p><p>ç›´æ¥ä¸ redis äº¤äº’ï¼Œè¯»é¢˜ç›®çš„è¢«ç‚¹èµæ•°é‡çš„ key</p><p><strong>æŸ¥è¯¢å½“å‰é¢˜ç›®è¢«å½“å‰ç”¨æˆ·æ˜¯å¦ç‚¹è¿‡èµ</strong></p><p>ç›´æ¥æŸ¥ redis å°±å¯ä»¥äº†ã€‚</p><p><strong>æˆ‘çš„ç‚¹èµ</strong></p><p>ç›´æ¥æŸ¥æ•°æ®åº“åšåˆ†é¡µé€»è¾‘çš„å±•ç¤ºã€‚</p><h4 id="ç‚¹èµåŠŸèƒ½å¼€å‘"><a href="#ç‚¹èµåŠŸèƒ½å¼€å‘" class="headerlink" title="ç‚¹èµåŠŸèƒ½å¼€å‘"></a>ç‚¹èµåŠŸèƒ½å¼€å‘</h4><p><code>RedisUtil.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// keyå¯ä»¥ç”¨æ¥åŒºåˆ†è¿™äº›ä¸åŒçš„å“ˆå¸Œè¡¨ã€‚hashKey åˆ™æ˜¯è¿™äº›å“ˆå¸Œè¡¨å†…éƒ¨çš„é”®</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">putHash</span><span class="params">(String key, String hashKey, Object hashVal)</span> &#123;</span><br><span class="line">    redisTemplate.opsForHash().put(key, hashKey, hashVal);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SubjectLikedDomainServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å®šä¹‰å¸¸é‡ï¼Œç”¨äºä½œä¸ºRedisä¸­å­˜å‚¨ä¸»é¢˜ç‚¹èµä¿¡æ¯çš„å“ˆå¸Œè¡¨çš„é”®</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SUBJECT_LIKED_KEY</span> <span class="operator">=</span> <span class="string">&quot;subject.liked&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å¸¸é‡ï¼Œç”¨äºä½œä¸ºRedisä¸­å­˜å‚¨ä¸»é¢˜ç‚¹èµæ•°é‡çš„é”®</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SUBJECT_LIKED_COUNT_KEY</span> <span class="operator">=</span> <span class="string">&quot;subject.liked.count&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰å¸¸é‡ï¼Œç”¨äºä½œä¸ºRedisä¸­å­˜å‚¨ä¸»é¢˜ç‚¹èµè¯¦ç»†ä¿¡æ¯çš„é”®</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SUBJECT_LIKED_DETAIL_KEY</span> <span class="operator">=</span> <span class="string">&quot;subject.liked.detail&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ·»åŠ ç‚¹èµä¿¡æ¯åˆ°Redisã€‚</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> subjectLikedBO åŒ…å«ç‚¹èµæ“ä½œçš„ä¸šåŠ¡å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«ä¸»é¢˜IDã€ç‚¹èµç”¨æˆ·IDå’ŒçŠ¶æ€ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(SubjectLikedBO subjectLikedBO)</span> &#123;</span><br><span class="line">    <span class="comment">// ä»ä¸šåŠ¡å¯¹è±¡ä¸­è·å–ä¸»é¢˜ID</span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">subjectId</span> <span class="operator">=</span> subjectLikedBO.getSubjectId();</span><br><span class="line">    <span class="comment">// ä»ä¸šåŠ¡å¯¹è±¡ä¸­è·å–ç‚¹èµç”¨æˆ·çš„ID</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">likeUserId</span> <span class="operator">=</span> subjectLikedBO.getLikeUserId();</span><br><span class="line">    <span class="comment">// ä»ä¸šåŠ¡å¯¹è±¡ä¸­è·å–ç‚¹èµçŠ¶æ€</span></span><br><span class="line">    <span class="type">Integer</span> <span class="variable">status</span> <span class="operator">=</span> subjectLikedBO.getStatus();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ„å»ºç”¨äºå­˜å‚¨ç‚¹èµçŠ¶æ€çš„å“ˆå¸Œè¡¨çš„å­—æ®µå</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">hashKey</span> <span class="operator">=</span> buildSubjectLikedKey(subjectId.toString(), likeUserId);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å°†ç‚¹èµçŠ¶æ€å­˜å‚¨åˆ°Rediså“ˆå¸Œè¡¨ä¸­</span></span><br><span class="line">    redisUtil.putHash(SUBJECT_LIKED_KEY, hashKey, status);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ„å»ºå­˜å‚¨ç‚¹èµè¯¦ç»†ä¿¡æ¯çš„é”®ï¼Œæ ¼å¼ä¸º &quot;subject.liked.detail + ä¸»é¢˜ID + . + ç‚¹èµç”¨æˆ·ID&quot;</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">detailKey</span> <span class="operator">=</span> SUBJECT_LIKED_DETAIL_KEY + <span class="string">&quot;.&quot;</span> + subjectId + <span class="string">&quot;.&quot;</span> + likeUserId;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// æ„å»ºå­˜å‚¨ç‚¹èµæ•°é‡çš„é”®ï¼Œæ ¼å¼ä¸º &quot;subject.liked.count + . + ä¸»é¢˜ID&quot;</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">countKey</span> <span class="operator">=</span> SUBJECT_LIKED_COUNT_KEY + <span class="string">&quot;.&quot;</span> + subjectId;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// åˆ¤æ–­ç‚¹èµçŠ¶æ€æ˜¯å¦ä¸º &quot;ç‚¹èµ&quot;</span></span><br><span class="line">    <span class="keyword">if</span> (SubjectLikedStatusEnum.LIKED.getCode() == status) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæ˜¯ç‚¹èµï¼Œå¢åŠ ç‚¹èµæ•°é‡</span></span><br><span class="line">        redisUtil.increment(countKey, <span class="number">1</span>);</span><br><span class="line">        <span class="comment">// å­˜å‚¨ç‚¹èµè¯¦ç»†ä¿¡æ¯ï¼Œè¿™é‡Œå‡è®¾ç‚¹èµè¯¦ç»†ä¿¡æ¯åªå­˜å‚¨ä¸º &quot;1&quot;</span></span><br><span class="line">        redisUtil.set(detailKey, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœä¸æ˜¯ç‚¹èµçŠ¶æ€ï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œ</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> redisUtil.getInt(countKey);</span><br><span class="line">        <span class="comment">// å¦‚æœç‚¹èµæ•°é‡ä¸ºnullæˆ–å°äºç­‰äº0ï¼Œåˆ™ä¸æ‰§è¡Œä»»ä½•æ“ä½œ</span></span><br><span class="line">        <span class="keyword">if</span> (Objects.isNull(count) || count &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å‡å°‘ç‚¹èµæ•°é‡</span></span><br><span class="line">        redisUtil.increment(countKey, -<span class="number">1</span>);</span><br><span class="line">        <span class="comment">// åˆ é™¤ç‚¹èµè¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">        redisUtil.del(detailKey);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="é¢˜ç›®è¯¦æƒ…å¢åŠ ç‚¹èµæ•°æ®"><a href="#é¢˜ç›®è¯¦æƒ…å¢åŠ ç‚¹èµæ•°æ®" class="headerlink" title="é¢˜ç›®è¯¦æƒ…å¢åŠ ç‚¹èµæ•°æ®"></a>é¢˜ç›®è¯¦æƒ…å¢åŠ ç‚¹èµæ•°æ®</h4><p><code>SubjectLikedDomainServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">isLiked</span><span class="params">(String subjectId, String userId)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">detailKey</span> <span class="operator">=</span> SUBJECT_LIKED_DETAIL_KEY + <span class="string">&quot;.&quot;</span> + subjectId + <span class="string">&quot;.&quot;</span> + userId;</span><br><span class="line">        <span class="keyword">return</span> redisUtil.exist(detailKey);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Integer <span class="title function_">getLikedCount</span><span class="params">(String subjectId)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">countKey</span> <span class="operator">=</span> SUBJECT_LIKED_COUNT_KEY + <span class="string">&quot;.&quot;</span> + subjectId;</span><br><span class="line">    <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> redisUtil.getInt(countKey);</span><br><span class="line">    <span class="keyword">if</span> (Objects.isNull(count) || count &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> redisUtil.getInt(countKey);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SubjectInfoDomainServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> SubjectInfoBO <span class="title function_">querySubjectInfo</span><span class="params">(SubjectInfoBO subjectInfoBO)</span> &#123;</span><br><span class="line">    <span class="type">SubjectInfo</span> <span class="variable">subjectInfo</span> <span class="operator">=</span> subjectInfoService.queryById(subjectInfoBO.getId());</span><br><span class="line">    <span class="type">SubjectTypeHandler</span> <span class="variable">handler</span> <span class="operator">=</span> subjectTypeHandlerFactory.getHandler(subjectInfo.getSubjectType());</span><br><span class="line">    <span class="type">SubjectOptionBO</span> <span class="variable">optionBO</span> <span class="operator">=</span> handler.query(subjectInfo.getId().intValue());</span><br><span class="line">    <span class="type">SubjectInfoBO</span> <span class="variable">bo</span> <span class="operator">=</span> SubjectInfoConverter.INSTANCE.convertOptionAndInfoToBo(optionBO, subjectInfo);</span><br><span class="line">    <span class="type">SubjectMapping</span> <span class="variable">subjectMapping</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectMapping</span>();</span><br><span class="line">    subjectMapping.setSubjectId(subjectInfo.getId());</span><br><span class="line">    subjectMapping.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">    List&lt;SubjectMapping&gt; mappingList = subjectMappingService.queryLabelId(subjectMapping);</span><br><span class="line">    List&lt;Long&gt; labelIdList = mappingList.stream().map(SubjectMapping::getLabelId).collect(Collectors.toList());</span><br><span class="line">    List&lt;SubjectLabel&gt; labelList = subjectLabelService.batchQueryById(labelIdList);</span><br><span class="line">    List&lt;String&gt; labelNameList = labelList.stream().map(SubjectLabel::getLabelName).collect(Collectors.toList());</span><br><span class="line">    bo.setLabelName(labelNameList);</span><br><span class="line">    bo.setLiked(subjectLikedDomainService.isLiked(subjectInfoBO.getId().toString(), LoginUtil.getLoginId()));</span><br><span class="line">    bo.setLikedCount(subjectLikedDomainService.getLikedCount(subjectInfoBO.getId().toString()));</span><br><span class="line">    assembleSubjectCursor(subjectInfoBO, bo);</span><br><span class="line">    <span class="keyword">return</span> bo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="xxljobå®šæ—¶ä»»åŠ¡å®Œæˆ"><a href="#xxljobå®šæ—¶ä»»åŠ¡å®Œæˆ" class="headerlink" title="xxljobå®šæ—¶ä»»åŠ¡å®Œæˆ"></a>xxljobå®šæ—¶ä»»åŠ¡å®Œæˆ</h4><p>XXL-JOB æ˜¯ä¸€ä¸ªè½»é‡çº§åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å°ï¼Œå…¶æ ¸å¿ƒè®¾è®¡ç›®æ ‡æ˜¯å¼€å‘è¿…é€Ÿã€å­¦ä¹ ç®€å•ã€è½»é‡çº§ã€æ˜“æ‰©å±•ã€‚ç°å·²å¼€æ”¾æºä»£ç å¹¶æ¥å…¥å¤šå®¶å…¬å¸çº¿ä¸Šäº§å“çº¿ï¼Œå¼€ç®±å³ç”¨ã€‚</p><p><img src="https://s2.loli.net/2024/08/24/sb1G3l4E97DJPLQ.png" alt="image-20240824155129452.png"></p><p><a href="https://www.xuxueli.com/xxl-job/">åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦å¹³å°XXL-JOB (xuxueli.com)</a></p><p><strong>ç‰¹æ€§</strong></p><ul><li>1ã€ç®€å•ï¼šæ”¯æŒé€šè¿‡ Web é¡µé¢å¯¹ä»»åŠ¡è¿›è¡Œ CRUD æ“ä½œï¼Œæ“ä½œç®€å•ï¼Œä¸€åˆ†é’Ÿä¸Šæ‰‹ï¼›</li><li>2ã€åŠ¨æ€ï¼šæ”¯æŒåŠ¨æ€ä¿®æ”¹ä»»åŠ¡çŠ¶æ€ã€å¯åŠ¨ &#x2F; åœæ­¢ä»»åŠ¡ï¼Œä»¥åŠç»ˆæ­¢è¿è¡Œä¸­ä»»åŠ¡ï¼Œå³æ—¶ç”Ÿæ•ˆï¼›</li><li>3ã€è°ƒåº¦ä¸­å¿ƒ HAï¼ˆä¸­å¿ƒå¼ï¼‰ï¼šè°ƒåº¦é‡‡ç”¨ä¸­å¿ƒå¼è®¾è®¡ï¼Œâ€œè°ƒåº¦ä¸­å¿ƒâ€ è‡ªç ”è°ƒåº¦ç»„ä»¶å¹¶æ”¯æŒé›†ç¾¤éƒ¨ç½²ï¼Œå¯ä¿è¯è°ƒåº¦ä¸­å¿ƒ HAï¼›</li><li>4ã€æ‰§è¡Œå™¨ HAï¼ˆåˆ†å¸ƒå¼ï¼‰ï¼šä»»åŠ¡åˆ†å¸ƒå¼æ‰§è¡Œï¼Œä»»åŠ¡ â€œæ‰§è¡Œå™¨â€ æ”¯æŒé›†ç¾¤éƒ¨ç½²ï¼Œå¯ä¿è¯ä»»åŠ¡æ‰§è¡Œ HAï¼›</li><li>5ã€æ³¨å†Œä¸­å¿ƒï¼šæ‰§è¡Œå™¨ä¼šå‘¨æœŸæ€§è‡ªåŠ¨æ³¨å†Œä»»åŠ¡ï¼Œè°ƒåº¦ä¸­å¿ƒå°†ä¼šè‡ªåŠ¨å‘ç°æ³¨å†Œçš„ä»»åŠ¡å¹¶è§¦å‘æ‰§è¡Œã€‚åŒæ—¶ï¼Œä¹Ÿæ”¯æŒæ‰‹åŠ¨å½•å…¥æ‰§è¡Œå™¨åœ°å€ï¼›</li><li>6ã€å¼¹æ€§æ‰©å®¹ç¼©å®¹ï¼šä¸€æ—¦æœ‰æ–°æ‰§è¡Œå™¨æœºå™¨ä¸Šçº¿æˆ–è€…ä¸‹çº¿ï¼Œä¸‹æ¬¡è°ƒåº¦æ—¶å°†ä¼šé‡æ–°åˆ†é…ä»»åŠ¡ï¼›</li><li>7ã€è·¯ç”±ç­–ç•¥ï¼šæ‰§è¡Œå™¨é›†ç¾¤éƒ¨ç½²æ—¶æä¾›ä¸°å¯Œçš„è·¯ç”±ç­–ç•¥ï¼ŒåŒ…æ‹¬ï¼šç¬¬ä¸€ä¸ªã€æœ€åä¸€ä¸ªã€è½®è¯¢ã€éšæœºã€ä¸€è‡´æ€§ HASHã€æœ€ä¸ç»å¸¸ä½¿ç”¨ã€æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨ã€æ•…éšœè½¬ç§»ã€å¿™ç¢Œè½¬ç§»ç­‰ï¼›</li><li>8ã€æ•…éšœè½¬ç§»ï¼šä»»åŠ¡è·¯ç”±ç­–ç•¥é€‰æ‹© â€œæ•…éšœè½¬ç§»â€ æƒ…å†µä¸‹ï¼Œå¦‚æœæ‰§è¡Œå™¨é›†ç¾¤ä¸­æŸä¸€å°æœºå™¨æ•…éšœï¼Œå°†ä¼šè‡ªåŠ¨ Failover åˆ‡æ¢åˆ°ä¸€å°æ­£å¸¸çš„æ‰§è¡Œå™¨å‘é€è°ƒåº¦è¯·æ±‚ã€‚</li><li>9ã€é˜»å¡å¤„ç†ç­–ç•¥ï¼šè°ƒåº¦è¿‡äºå¯†é›†æ‰§è¡Œå™¨æ¥ä¸åŠå¤„ç†æ—¶çš„å¤„ç†ç­–ç•¥ï¼Œç­–ç•¥åŒ…æ‹¬ï¼šå•æœºä¸²è¡Œï¼ˆé»˜è®¤ï¼‰ã€ä¸¢å¼ƒåç»­è°ƒåº¦ã€è¦†ç›–ä¹‹å‰è°ƒåº¦ï¼›</li><li>10ã€ä»»åŠ¡è¶…æ—¶æ§åˆ¶ï¼šæ”¯æŒè‡ªå®šä¹‰ä»»åŠ¡è¶…æ—¶æ—¶é—´ï¼Œä»»åŠ¡è¿è¡Œè¶…æ—¶å°†ä¼šä¸»åŠ¨ä¸­æ–­ä»»åŠ¡ï¼›</li><li>11ã€ä»»åŠ¡å¤±è´¥é‡è¯•ï¼šæ”¯æŒè‡ªå®šä¹‰ä»»åŠ¡å¤±è´¥é‡è¯•æ¬¡æ•°ï¼Œå½“ä»»åŠ¡å¤±è´¥æ—¶å°†ä¼šæŒ‰ç…§é¢„è®¾çš„å¤±è´¥é‡è¯•æ¬¡æ•°ä¸»åŠ¨è¿›è¡Œé‡è¯•ï¼›å…¶ä¸­åˆ†ç‰‡ä»»åŠ¡æ”¯æŒåˆ†ç‰‡ç²’åº¦çš„å¤±è´¥é‡è¯•ï¼›</li><li>12ã€ä»»åŠ¡å¤±è´¥å‘Šè­¦ï¼›é»˜è®¤æä¾›é‚®ä»¶æ–¹å¼å¤±è´¥å‘Šè­¦ï¼ŒåŒæ—¶é¢„ç•™æ‰©å±•æ¥å£ï¼Œå¯æ–¹ä¾¿çš„æ‰©å±•çŸ­ä¿¡ã€é’‰é’‰ç­‰å‘Šè­¦æ–¹å¼ï¼›</li><li>13ã€åˆ†ç‰‡å¹¿æ’­ä»»åŠ¡ï¼šæ‰§è¡Œå™¨é›†ç¾¤éƒ¨ç½²æ—¶ï¼Œä»»åŠ¡è·¯ç”±ç­–ç•¥é€‰æ‹© â€œåˆ†ç‰‡å¹¿æ’­â€ æƒ…å†µä¸‹ï¼Œä¸€æ¬¡ä»»åŠ¡è°ƒåº¦å°†ä¼šå¹¿æ’­è§¦å‘é›†ç¾¤ä¸­æ‰€æœ‰æ‰§è¡Œå™¨æ‰§è¡Œä¸€æ¬¡ä»»åŠ¡ï¼Œå¯æ ¹æ®åˆ†ç‰‡å‚æ•°å¼€å‘åˆ†ç‰‡ä»»åŠ¡ï¼›</li><li>14ã€åŠ¨æ€åˆ†ç‰‡ï¼šåˆ†ç‰‡å¹¿æ’­ä»»åŠ¡ä»¥æ‰§è¡Œå™¨ä¸ºç»´åº¦è¿›è¡Œåˆ†ç‰‡ï¼Œæ”¯æŒåŠ¨æ€æ‰©å®¹æ‰§è¡Œå™¨é›†ç¾¤ä»è€ŒåŠ¨æ€å¢åŠ åˆ†ç‰‡æ•°é‡ï¼ŒååŒè¿›è¡Œä¸šåŠ¡å¤„ç†ï¼›åœ¨è¿›è¡Œå¤§æ•°æ®é‡ä¸šåŠ¡æ“ä½œæ—¶å¯æ˜¾è‘—æå‡ä»»åŠ¡å¤„ç†èƒ½åŠ›å’Œé€Ÿåº¦ã€‚</li><li>15ã€äº‹ä»¶è§¦å‘ï¼šé™¤äº† â€œCron æ–¹å¼â€ å’Œ â€œä»»åŠ¡ä¾èµ–æ–¹å¼â€ è§¦å‘ä»»åŠ¡æ‰§è¡Œä¹‹å¤–ï¼Œæ”¯æŒåŸºäºäº‹ä»¶çš„è§¦å‘ä»»åŠ¡æ–¹å¼ã€‚è°ƒåº¦ä¸­å¿ƒæä¾›è§¦å‘ä»»åŠ¡å•æ¬¡æ‰§è¡Œçš„ API æœåŠ¡ï¼Œå¯æ ¹æ®ä¸šåŠ¡äº‹ä»¶çµæ´»è§¦å‘ã€‚</li><li>16ã€ä»»åŠ¡è¿›åº¦ç›‘æ§ï¼šæ”¯æŒå®æ—¶ç›‘æ§ä»»åŠ¡è¿›åº¦ï¼›</li><li>17ã€Rolling å®æ—¶æ—¥å¿—ï¼šæ”¯æŒåœ¨çº¿æŸ¥çœ‹è°ƒåº¦ç»“æœï¼Œå¹¶ä¸”æ”¯æŒä»¥ Rolling æ–¹å¼å®æ—¶æŸ¥çœ‹æ‰§è¡Œå™¨è¾“å‡ºçš„å®Œæ•´çš„æ‰§è¡Œæ—¥å¿—ï¼›</li><li>18ã€GLUEï¼šæä¾› Web IDEï¼Œæ”¯æŒåœ¨çº¿å¼€å‘ä»»åŠ¡é€»è¾‘ä»£ç ï¼ŒåŠ¨æ€å‘å¸ƒï¼Œå®æ—¶ç¼–è¯‘ç”Ÿæ•ˆï¼Œçœç•¥éƒ¨ç½²ä¸Šçº¿çš„è¿‡ç¨‹ã€‚æ”¯æŒ 30 ä¸ªç‰ˆæœ¬çš„å†å²ç‰ˆæœ¬å›æº¯ã€‚</li><li>19ã€è„šæœ¬ä»»åŠ¡ï¼šæ”¯æŒä»¥ GLUE æ¨¡å¼å¼€å‘å’Œè¿è¡Œè„šæœ¬ä»»åŠ¡ï¼ŒåŒ…æ‹¬ Shellã€Pythonã€NodeJSã€PHPã€PowerShell ç­‰ç±»å‹è„šæœ¬ï¼›</li><li>20ã€å‘½ä»¤è¡Œä»»åŠ¡ï¼šåŸç”Ÿæä¾›é€šç”¨å‘½ä»¤è¡Œä»»åŠ¡ Handlerï¼ˆBean ä»»åŠ¡ï¼Œâ€CommandJobHandlerâ€ï¼‰ï¼›ä¸šåŠ¡æ–¹åªéœ€è¦æä¾›å‘½ä»¤è¡Œå³å¯ï¼›</li><li>21ã€ä»»åŠ¡ä¾èµ–ï¼šæ”¯æŒé…ç½®å­ä»»åŠ¡ä¾èµ–ï¼Œå½“çˆ¶ä»»åŠ¡æ‰§è¡Œç»“æŸä¸”æ‰§è¡ŒæˆåŠŸåå°†ä¼šä¸»åŠ¨è§¦å‘ä¸€æ¬¡å­ä»»åŠ¡çš„æ‰§è¡Œï¼Œå¤šä¸ªå­ä»»åŠ¡ç”¨é€—å·åˆ†éš”ï¼›</li><li>22ã€ä¸€è‡´æ€§ï¼šâ€œè°ƒåº¦ä¸­å¿ƒâ€ é€šè¿‡ DB é”ä¿è¯é›†ç¾¤åˆ†å¸ƒå¼è°ƒåº¦çš„ä¸€è‡´æ€§ï¼Œä¸€æ¬¡ä»»åŠ¡è°ƒåº¦åªä¼šè§¦å‘ä¸€æ¬¡æ‰§è¡Œï¼›</li><li>23ã€è‡ªå®šä¹‰ä»»åŠ¡å‚æ•°ï¼šæ”¯æŒåœ¨çº¿é…ç½®è°ƒåº¦ä»»åŠ¡å…¥å‚ï¼Œå³æ—¶ç”Ÿæ•ˆï¼›</li><li>24ã€è°ƒåº¦çº¿ç¨‹æ± ï¼šè°ƒåº¦ç³»ç»Ÿå¤šçº¿ç¨‹è§¦å‘è°ƒåº¦è¿è¡Œï¼Œç¡®ä¿è°ƒåº¦ç²¾ç¡®æ‰§è¡Œï¼Œä¸è¢«å µå¡ï¼›</li><li>25ã€æ•°æ®åŠ å¯†ï¼šè°ƒåº¦ä¸­å¿ƒå’Œæ‰§è¡Œå™¨ä¹‹é—´çš„é€šè®¯è¿›è¡Œæ•°æ®åŠ å¯†ï¼Œæå‡è°ƒåº¦ä¿¡æ¯å®‰å…¨æ€§ï¼›</li><li>26ã€é‚®ä»¶æŠ¥è­¦ï¼šä»»åŠ¡å¤±è´¥æ—¶æ”¯æŒé‚®ä»¶æŠ¥è­¦ï¼Œæ”¯æŒé…ç½®å¤šé‚®ä»¶åœ°å€ç¾¤å‘æŠ¥è­¦é‚®ä»¶ï¼›</li><li>27ã€æ¨é€ maven ä¸­å¤®ä»“åº“ï¼šå°†ä¼šæŠŠæœ€æ–°ç¨³å®šç‰ˆæ¨é€åˆ° maven ä¸­å¤®ä»“åº“ï¼Œæ–¹ä¾¿ç”¨æˆ·æ¥å…¥å’Œä½¿ç”¨ï¼›</li><li>28ã€è¿è¡ŒæŠ¥è¡¨ï¼šæ”¯æŒå®æ—¶æŸ¥çœ‹è¿è¡Œæ•°æ®ï¼Œå¦‚ä»»åŠ¡æ•°é‡ã€è°ƒåº¦æ¬¡æ•°ã€æ‰§è¡Œå™¨æ•°é‡ç­‰ï¼›ä»¥åŠè°ƒåº¦æŠ¥è¡¨ï¼Œå¦‚è°ƒåº¦æ—¥æœŸåˆ†å¸ƒå›¾ï¼Œè°ƒåº¦æˆåŠŸåˆ†å¸ƒå›¾ç­‰ï¼›</li><li>29ã€å…¨å¼‚æ­¥ï¼šä»»åŠ¡è°ƒåº¦æµç¨‹å…¨å¼‚æ­¥åŒ–è®¾è®¡å®ç°ï¼Œå¦‚å¼‚æ­¥è°ƒåº¦ã€å¼‚æ­¥è¿è¡Œã€å¼‚æ­¥å›è°ƒç­‰ï¼Œæœ‰æ•ˆå¯¹å¯†é›†è°ƒåº¦è¿›è¡Œæµé‡å‰Šå³°ï¼Œç†è®ºä¸Šæ”¯æŒä»»æ„æ—¶é•¿ä»»åŠ¡çš„è¿è¡Œï¼›</li><li>30ã€è·¨è¯­è¨€ï¼šè°ƒåº¦ä¸­å¿ƒä¸æ‰§è¡Œå™¨æä¾›è¯­è¨€æ— å…³çš„ RESTful API æœåŠ¡ï¼Œç¬¬ä¸‰æ–¹ä»»æ„è¯­è¨€å¯æ®æ­¤å¯¹æ¥è°ƒåº¦ä¸­å¿ƒæˆ–è€…å®ç°æ‰§è¡Œå™¨ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æä¾›äº† â€œå¤šä»»åŠ¡æ¨¡å¼â€ å’Œ â€œhttpJobHandlerâ€ ç­‰å…¶ä»–è·¨è¯­è¨€æ–¹æ¡ˆï¼›</li><li>31ã€å›½é™…åŒ–ï¼šè°ƒåº¦ä¸­å¿ƒæ”¯æŒå›½é™…åŒ–è®¾ç½®ï¼Œæä¾›ä¸­æ–‡ã€è‹±æ–‡ä¸¤ç§å¯é€‰è¯­è¨€ï¼Œé»˜è®¤ä¸ºä¸­æ–‡ï¼›</li><li>32ã€å®¹å™¨åŒ–ï¼šæä¾›å®˜æ–¹ docker é•œåƒï¼Œå¹¶å®æ—¶æ›´æ–°æ¨é€ dockerhubï¼Œè¿›ä¸€æ­¥å®ç°äº§å“å¼€ç®±å³ç”¨ï¼›</li><li>33ã€çº¿ç¨‹æ± éš”ç¦»ï¼šè°ƒåº¦çº¿ç¨‹æ± è¿›è¡Œéš”ç¦»æ‹†åˆ†ï¼Œæ…¢ä»»åŠ¡è‡ªåŠ¨é™çº§è¿›å…¥ â€œSlowâ€ çº¿ç¨‹æ± ï¼Œé¿å…è€—å°½è°ƒåº¦çº¿ç¨‹ï¼Œæé«˜ç³»ç»Ÿç¨³å®šæ€§ï¼›</li><li>34ã€ç”¨æˆ·ç®¡ç†ï¼šæ”¯æŒåœ¨çº¿ç®¡ç†ç³»ç»Ÿç”¨æˆ·ï¼Œå­˜åœ¨ç®¡ç†å‘˜ã€æ™®é€šç”¨æˆ·ä¸¤ç§è§’è‰²ï¼›</li><li>35ã€æƒé™æ§åˆ¶ï¼šæ‰§è¡Œå™¨ç»´åº¦è¿›è¡Œæƒé™æ§åˆ¶ï¼Œç®¡ç†å‘˜æ‹¥æœ‰å…¨é‡æƒé™ï¼Œæ™®é€šç”¨æˆ·éœ€è¦åˆ†é…æ‰§è¡Œå™¨æƒé™åæ‰å…è®¸ç›¸å…³æ“ä½œï¼›</li></ul><p>å…¶å®æŠŠä¸œè¥¿é…ç½®å¥½å°±è¡Œ</p><p><code>subject-starter/application.yaml</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">xxl:</span></span><br><span class="line">  <span class="attr">job:</span></span><br><span class="line">    <span class="attr">admin:</span></span><br><span class="line">      <span class="attr">addresses:</span> <span class="string">http://127.0.0.1:8080/xxl-job-admin</span> </span><br><span class="line">    <span class="attr">accessToken:</span> <span class="string">default_token</span></span><br><span class="line">    <span class="attr">executor:</span></span><br><span class="line">      <span class="attr">appname:</span> <span class="string">jc-club-subjcet</span></span><br><span class="line">      <span class="attr">address:</span></span><br><span class="line">      <span class="attr">ip:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">9999</span></span><br><span class="line">      <span class="attr">logpath:</span> <span class="string">/data/applogs/xxl-job/jobhandler</span></span><br><span class="line">      <span class="attr">logretentiondays:</span> <span class="number">30</span></span><br></pre></td></tr></table></figure><p><code>XxlJobConfig.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Value(&quot;$&#123;xxl.job.admin.addresses&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String adminAddresses;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value(&quot;$&#123;xxl.job.accessToken&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String accessToken;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value(&quot;$&#123;xxl.job.executor.appname&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String appname;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value(&quot;$&#123;xxl.job.executor.address&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value(&quot;$&#123;xxl.job.executor.ip&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String ip;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value(&quot;$&#123;xxl.job.executor.port&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> port;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value(&quot;$&#123;xxl.job.executor.logpath&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String logPath;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value(&quot;$&#123;xxl.job.executor.logretentiondays&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span> logRetentionDays;</span><br><span class="line"></span><br><span class="line"><span class="comment">//é…ç½®æ‰§è¡Œå™¨</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="keyword">public</span> XxlJobSpringExecutor <span class="title function_">xxlJobExecutor</span><span class="params">()</span> &#123;</span><br><span class="line">    logger.info(<span class="string">&quot;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job config init.&quot;</span>);</span><br><span class="line">    <span class="type">XxlJobSpringExecutor</span> <span class="variable">xxlJobSpringExecutor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XxlJobSpringExecutor</span>();</span><br><span class="line">    xxlJobSpringExecutor.setAdminAddresses(adminAddresses);</span><br><span class="line">    xxlJobSpringExecutor.setAppname(appname);</span><br><span class="line">    xxlJobSpringExecutor.setAddress(address);</span><br><span class="line">    xxlJobSpringExecutor.setIp(ip);</span><br><span class="line">    xxlJobSpringExecutor.setPort(port);</span><br><span class="line">    xxlJobSpringExecutor.setAccessToken(accessToken);</span><br><span class="line">    xxlJobSpringExecutor.setLogPath(logPath);</span><br><span class="line">    xxlJobSpringExecutor.setLogRetentionDays(logRetentionDays);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> xxlJobSpringExecutor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SyncLikedJob.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SyncLikedJob</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SubjectLikedDomainService subjectLikedDomainService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŒæ­¥ç‚¹èµæ•°æ®ä»»åŠ¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@XxlJob(&quot;syncLikedJobHandler&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">syncLikedJobHandler</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        XxlJobHelper.log(<span class="string">&quot;syncLikedJobHandler.start&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            subjectLikedDomainService.syncLiked();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            XxlJobHelper.log(<span class="string">&quot;syncLikedJobHandler.error&quot;</span> + e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SubjectLikedDomainServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">syncLiked</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//redisUtil.getHashAndDelete(SUBJECT_LIKED_KEY)ä»Redisä¸­è·å–é”®ä¸ºSUBJECT_LIKED_KEYçš„å“ˆå¸Œè¡¨ï¼Œå¹¶åœ¨è·å–ååˆ é™¤æ­¤å“ˆå¸Œè¡¨ã€‚</span></span><br><span class="line">    Map&lt;Object, Object&gt; subjectLikedMap = redisUtil.getHashAndDelete(SUBJECT_LIKED_KEY);</span><br><span class="line">    <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">        log.info(<span class="string">&quot;syncLiked.subjectLikedMap:&#123;&#125;&quot;</span>, JSON.toJSONString(subjectLikedMap));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (MapUtils.isEmpty(subjectLikedMap)) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æ‰¹é‡åŒæ­¥åˆ°æ•°æ®åº“</span></span><br><span class="line">    List&lt;SubjectLiked&gt; subjectLikedList = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    subjectLikedMap.forEach((key, val) -&gt; &#123;</span><br><span class="line">        <span class="type">SubjectLiked</span> <span class="variable">subjectLiked</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectLiked</span>();</span><br><span class="line">        String[] keyArr = key.toString().split(<span class="string">&quot;:&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">subjectId</span> <span class="operator">=</span> keyArr[<span class="number">0</span>];</span><br><span class="line">        <span class="type">String</span> <span class="variable">likedUser</span> <span class="operator">=</span> keyArr[<span class="number">1</span>];</span><br><span class="line">        subjectLiked.setSubjectId(Long.valueOf(subjectId));</span><br><span class="line">        subjectLiked.setLikeUserId(likedUser);</span><br><span class="line">        subjectLiked.setStatus(Integer.valueOf(val.toString()));</span><br><span class="line">        subjectLiked.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">        subjectLikedList.add(subjectLiked);</span><br><span class="line">    &#125;);</span><br><span class="line">    subjectLikedService.batchInsertOrUpdate(subjectLikedList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SubjectLikedServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">batchInsertOrUpdate</span><span class="params">(List&lt;SubjectLiked&gt; subjectLikedList)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.subjectLikedDao.batchInsertOrUpdate(subjectLikedList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>RedisUtil.java</code></p><ol><li><strong>å®šä¹‰Map</strong>ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„<code>HashMap</code>å®ä¾‹ï¼Œç”¨äºå­˜å‚¨ä»Redisä¸­è·å–çš„é”®å€¼å¯¹ã€‚</li><li><strong>ä½¿ç”¨Cursoréå†å“ˆå¸Œè¡¨</strong>ï¼šé€šè¿‡è°ƒç”¨<code>redisTemplate.opsForHash().scan(key, ScanOptions.NONE)</code>è·å–ä¸€ä¸ª<code>Cursor</code>ï¼Œå®ƒå¯ä»¥ç”¨æ¥éå†Rediså“ˆå¸Œè¡¨ä¸­çš„æ‰€æœ‰æ¡ç›®ã€‚<code>ScanOptions.NONE</code>è¡¨ç¤ºä¸ä½¿ç”¨ä»»ä½•æ‰«æé€‰é¡¹ã€‚</li><li><strong>éå†Cursor</strong>ï¼šä½¿ç”¨<code>while</code>å¾ªç¯éå†<code>Cursor</code>ï¼Œç›´åˆ°æ²¡æœ‰æ›´å¤šçš„æ¡ç›®ã€‚</li><li><strong>è·å–æ¡ç›®</strong>ï¼šåœ¨å¾ªç¯å†…éƒ¨ï¼Œä½¿ç”¨<code>cursor.next()</code>è·å–å½“å‰çš„æ¡ç›®ï¼Œå®ƒæ˜¯ä¸€ä¸ª<code>Map.Entry</code>å¯¹è±¡ã€‚</li><li><strong>æå–é”®å’Œå€¼</strong>ï¼šä»<code>Map.Entry</code>å¯¹è±¡ä¸­æå–é”®ï¼ˆ<code>hashKey</code>ï¼‰å’Œå€¼ï¼ˆ<code>value</code>ï¼‰ã€‚</li><li><strong>å°†é”®å€¼å¯¹æ”¾å…¥Map</strong>ï¼šä½¿ç”¨<code>map.put(hashKey, value)</code>å°†æå–çš„é”®å’Œå€¼æ”¾å…¥ä¹‹å‰åˆ›å»ºçš„Mapä¸­ã€‚</li><li><strong>åˆ é™¤å“ˆå¸Œè¡¨ä¸­çš„æ¡ç›®</strong>ï¼šä½¿ç”¨<code>redisTemplate.opsForHash().delete(key, hashKey)</code>ä»Redisçš„å“ˆå¸Œè¡¨ä¸­åˆ é™¤å½“å‰éå†åˆ°çš„é”®å€¼å¯¹ã€‚</li><li><strong>è¿”å›Map</strong>ï¼šéå†å®Œæˆåï¼Œè¿”å›åŒ…å«æ‰€æœ‰é”®å€¼å¯¹çš„Mapã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Map&lt;Object, Object&gt; <span class="title function_">getHashAndDelete</span><span class="params">(String key)</span> &#123;</span><br><span class="line">    Map&lt;Object, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    Cursor&lt;Map.Entry&lt;Object, Object&gt;&gt; cursor = redisTemplate.opsForHash().scan(key, ScanOptions.NONE);</span><br><span class="line">    <span class="keyword">while</span> (cursor.hasNext()) &#123;</span><br><span class="line">        Map.Entry&lt;Object, Object&gt; entry = cursor.next();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">hashKey</span> <span class="operator">=</span> entry.getKey();</span><br><span class="line">        <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> entry.getValue();</span><br><span class="line">        map.put(hashKey, value);</span><br><span class="line">        redisTemplate.opsForHash().delete(key, hashKey);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> map;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="æˆ‘çš„ç‚¹èµåŠŸèƒ½å¼€å‘"><a href="#æˆ‘çš„ç‚¹èµåŠŸèƒ½å¼€å‘" class="headerlink" title="æˆ‘çš„ç‚¹èµåŠŸèƒ½å¼€å‘"></a>æˆ‘çš„ç‚¹èµåŠŸèƒ½å¼€å‘</h4><p><code>SubjectLikedController.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŸ¥è¯¢æˆ‘çš„ç‚¹èµåˆ—è¡¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/getSubjectLikedPage&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;PageResult&lt;SubjectLikedDTO&gt;&gt; <span class="title function_">getSubjectLikedPage</span><span class="params">(<span class="meta">@RequestBody</span> SubjectLikedDTO subjectLikedDTO)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (log.isInfoEnabled()) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;SubjectController.getSubjectLikedPage.dto:&#123;&#125;&quot;</span>, JSON.toJSONString(subjectLikedDTO));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">SubjectLikedBO</span> <span class="variable">subjectLikedBO</span> <span class="operator">=</span> SubjectLikedDTOConverter.INSTANCE.convertDTOToBO(subjectLikedDTO);</span><br><span class="line">        subjectLikedBO.setPageNo(subjectLikedDTO.getPageNo());</span><br><span class="line">        subjectLikedBO.setPageSize(subjectLikedDTO.getPageSize());</span><br><span class="line">        PageResult&lt;SubjectLikedBO&gt; boPageResult = subjectLikedDomainService.getSubjectLikedPage(subjectLikedBO);</span><br><span class="line">        <span class="keyword">return</span> Result.ok(boPageResult);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;SubjectCategoryController.getSubjectLikedPage.error:&#123;&#125;&quot;</span>, e.getMessage(), e);</span><br><span class="line">        <span class="keyword">return</span> Result.fail(<span class="string">&quot;åˆ†é¡µæŸ¥è¯¢æˆ‘çš„ç‚¹èµå¤±è´¥&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SubjectLikedDomainServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> PageResult&lt;SubjectLikedBO&gt; <span class="title function_">getSubjectLikedPage</span><span class="params">(SubjectLikedBO subjectLikedBO)</span> &#123;</span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªåˆ†é¡µç»“æœå¯¹è±¡</span></span><br><span class="line">    PageResult&lt;SubjectLikedBO&gt; pageResult = <span class="keyword">new</span> <span class="title class_">PageResult</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">// è®¾ç½®å½“å‰é¡µç å’Œæ¯é¡µæ˜¾ç¤ºçš„è®°å½•æ•°</span></span><br><span class="line">    pageResult.setPageNo(subjectLikedBO.getPageNo());</span><br><span class="line">    pageResult.setPageSize(subjectLikedBO.getPageSize());</span><br><span class="line">    <span class="comment">// è®¡ç®—æŸ¥è¯¢çš„èµ·å§‹ç´¢å¼•</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> (subjectLikedBO.getPageNo() - <span class="number">1</span>) * subjectLikedBO.getPageSize();</span><br><span class="line">    <span class="comment">// å°†BOå¯¹è±¡è½¬æ¢ä¸ºEntityå¯¹è±¡</span></span><br><span class="line">    <span class="type">SubjectLiked</span> <span class="variable">subjectLiked</span> <span class="operator">=</span> SubjectLikedBOConverter.INSTANCE.convertBOToEntity(subjectLikedBO);</span><br><span class="line">    <span class="comment">// è®¾ç½®ç‚¹èµç”¨æˆ·çš„IDä¸ºå½“å‰ç™»å½•ç”¨æˆ·çš„ID</span></span><br><span class="line">    subjectLiked.setLikeUserId(LoginUtil.getLoginId());</span><br><span class="line">    <span class="comment">// æ‰§è¡Œæ¡ä»¶æŸ¥è¯¢ï¼Œè·å–ç‚¹èµè®°å½•çš„æ€»æ•°</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> subjectLikedService.countByCondition(subjectLiked);</span><br><span class="line">    <span class="comment">// å¦‚æœæ²¡æœ‰è®°å½•ï¼Œåˆ™ç›´æ¥è¿”å›ç©ºçš„åˆ†é¡µç»“æœ</span></span><br><span class="line">    <span class="keyword">if</span> (count == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> pageResult;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æ‰§è¡Œåˆ†é¡µæŸ¥è¯¢ï¼Œè·å–ç‚¹èµè®°å½•çš„åˆ—è¡¨</span></span><br><span class="line">    List&lt;SubjectLiked&gt; subjectLikedList = subjectLikedService.queryPage(subjectLiked, start,</span><br><span class="line">            subjectLikedBO.getPageSize());</span><br><span class="line">    <span class="comment">// å°†Entityåˆ—è¡¨è½¬æ¢ä¸ºBOåˆ—è¡¨</span></span><br><span class="line">    List&lt;SubjectLikedBO&gt; subjectInfoBOS = SubjectLikedBOConverter.INSTANCE.convertListInfoToBO(subjectLikedList);</span><br><span class="line">    <span class="comment">// éå†BOåˆ—è¡¨ï¼Œä¸ºæ¯ä¸ªç‚¹èµè®°å½•æ·»åŠ ä¸»é¢˜åç§°</span></span><br><span class="line">    subjectInfoBOS.forEach(info -&gt; &#123;</span><br><span class="line">        <span class="type">SubjectInfo</span> <span class="variable">subjectInfo</span> <span class="operator">=</span> subjectInfoService.queryById(info.getSubjectId());</span><br><span class="line">        info.setSubjectName(subjectInfo.getSubjectName());</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">// è®¾ç½®åˆ†é¡µç»“æœä¸­çš„è®°å½•åˆ—è¡¨å’Œæ€»æ•°</span></span><br><span class="line">    pageResult.setRecords(subjectInfoBOS);</span><br><span class="line">    pageResult.setTotal(count);</span><br><span class="line">    <span class="comment">// è¿”å›åˆ†é¡µç»“æœå¯¹è±¡</span></span><br><span class="line">    <span class="keyword">return</span> pageResult;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SubjectLikedServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">countByCondition</span><span class="params">(SubjectLiked subjectLiked)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.subjectLikedDao.countByCondition(subjectLiked);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;SubjectLiked&gt; <span class="title function_">queryPage</span><span class="params">(SubjectLiked subjectLiked, <span class="type">int</span> start, Integer pageSize)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">this</span>.subjectLikedDao.queryPage(subjectLiked, start, pageSize);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å¿«é€Ÿåˆ·é¢˜åŠŸèƒ½å¼€å‘"><a href="#å¿«é€Ÿåˆ·é¢˜åŠŸèƒ½å¼€å‘" class="headerlink" title="å¿«é€Ÿåˆ·é¢˜åŠŸèƒ½å¼€å‘"></a>å¿«é€Ÿåˆ·é¢˜åŠŸèƒ½å¼€å‘</h4><p><code>SubjectInfoDTO.java</code></p><p>æ–°å¢å­—æ®µ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¸‹ä¸€é¢˜</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> Long nextSubjectId;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¸Šä¸€é¢˜</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> Long lastSubjectId;</span><br></pre></td></tr></table></figure><p><code>SubjectInfoDomainService.java</code></p><p><strong>è¿™æ®µä»£ç çš„ä¸»è¦é€»è¾‘æ˜¯ï¼š</strong></p><ol><li>æ ¹æ®é¢˜ç›®IDæŸ¥è¯¢é¢˜ç›®å®ä½“ã€‚</li><li>æ ¹æ®é¢˜ç›®ç±»å‹è·å–ç›¸åº”çš„å¤„ç†å™¨ï¼Œå¹¶ä½¿ç”¨å®ƒæŸ¥è¯¢é¢˜ç›®é€‰é¡¹ä¿¡æ¯ã€‚</li><li>å°†é¢˜ç›®é€‰é¡¹å’Œé¢˜ç›®ä¿¡æ¯è½¬æ¢ä¸ºä¸šåŠ¡å¯¹è±¡BOã€‚</li><li>æŸ¥è¯¢é¢˜ç›®çš„æ ‡ç­¾IDåˆ—è¡¨ï¼Œå¹¶æ‰¹é‡æŸ¥è¯¢æ ‡ç­¾åˆ—è¡¨ã€‚</li><li>æå–æ ‡ç­¾åç§°å¹¶è®¾ç½®åˆ°ä¸šåŠ¡å¯¹è±¡BOä¸­ã€‚</li><li>è®¾ç½®æ˜¯å¦å·²ç‚¹èµçš„çŠ¶æ€å’Œç‚¹èµæ•°é‡ã€‚</li><li>ç»„è£…é¢˜ç›®çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä¸Šä¸€ä¸ªå’Œä¸‹ä¸€ä¸ªé¢˜ç›®çš„IDã€‚</li><li>è¿”å›å°è£…å¥½çš„ä¸šåŠ¡å¯¹è±¡BOã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> SubjectInfoBO <span class="title function_">querySubjectInfo</span><span class="params">(SubjectInfoBO subjectInfoBO)</span> &#123;</span><br><span class="line">    <span class="comment">// æ ¹æ®é¢˜ç›®ä¿¡æ¯BOä¸­çš„IDæŸ¥è¯¢é¢˜ç›®å®ä½“</span></span><br><span class="line">    <span class="type">SubjectInfo</span> <span class="variable">subjectInfo</span> <span class="operator">=</span> subjectInfoService.queryById(subjectInfoBO.getId());</span><br><span class="line">    <span class="comment">// æ ¹æ®é¢˜ç›®ç±»å‹è·å–ç›¸åº”çš„å¤„ç†å™¨</span></span><br><span class="line">    <span class="type">SubjectTypeHandler</span> <span class="variable">handler</span> <span class="operator">=</span> subjectTypeHandlerFactory.getHandler(subjectInfo.getSubjectType());</span><br><span class="line">    <span class="comment">// ä½¿ç”¨å¤„ç†å™¨æŸ¥è¯¢é¢˜ç›®é€‰é¡¹ä¿¡æ¯</span></span><br><span class="line">    <span class="type">SubjectOptionBO</span> <span class="variable">optionBO</span> <span class="operator">=</span> handler.query(subjectInfo.getId().intValue());</span><br><span class="line">    <span class="comment">// å°†é¢˜ç›®é€‰é¡¹å’Œé¢˜ç›®ä¿¡æ¯è½¬æ¢ä¸ºä¸šåŠ¡å¯¹è±¡BO</span></span><br><span class="line">    <span class="type">SubjectInfoBO</span> <span class="variable">bo</span> <span class="operator">=</span> SubjectInfoConverter.INSTANCE.convertOptionAndInfoToBo(optionBO, subjectInfo);</span><br><span class="line">    <span class="comment">// åˆ›å»ºé¢˜ç›®æ˜ å°„å¯¹è±¡ï¼Œè®¾ç½®é¢˜ç›®IDå’Œæœªåˆ é™¤æ ‡å¿—</span></span><br><span class="line">    <span class="type">SubjectMapping</span> <span class="variable">subjectMapping</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SubjectMapping</span>();</span><br><span class="line">    subjectMapping.setSubjectId(subjectInfo.getId());</span><br><span class="line">    subjectMapping.setIsDeleted(IsDeletedFlagEnum.UN_DELETED.getCode());</span><br><span class="line">    <span class="comment">// æŸ¥è¯¢é¢˜ç›®æ ‡ç­¾IDåˆ—è¡¨</span></span><br><span class="line">    List&lt;SubjectMapping&gt; mappingList = subjectMappingService.queryLabelId(subjectMapping);</span><br><span class="line">    <span class="comment">// ä»æ˜ å°„åˆ—è¡¨ä¸­æå–æ ‡ç­¾ID</span></span><br><span class="line">    List&lt;Long&gt; labelIdList = mappingList.stream().map(SubjectMapping::getLabelId).collect(Collectors.toList());</span><br><span class="line">    <span class="comment">// æ‰¹é‡æŸ¥è¯¢æ ‡ç­¾åˆ—è¡¨</span></span><br><span class="line">    List&lt;SubjectLabel&gt; labelList = subjectLabelService.batchQueryById(labelIdList);</span><br><span class="line">    <span class="comment">// ä»æ ‡ç­¾åˆ—è¡¨ä¸­æå–æ ‡ç­¾åç§°</span></span><br><span class="line">    List&lt;String&gt; labelNameList = labelList.stream().map(SubjectLabel::getLabelName).collect(Collectors.toList());</span><br><span class="line">    <span class="comment">// è®¾ç½®æ ‡ç­¾åç§°åˆ°ä¸šåŠ¡å¯¹è±¡BOä¸­</span></span><br><span class="line">    bo.setLabelName(labelNameList);</span><br><span class="line">    <span class="comment">// è®¾ç½®æ˜¯å¦å·²ç‚¹èµçš„çŠ¶æ€</span></span><br><span class="line">    bo.setLiked(subjectLikedDomainService.isLiked(subjectInfoBO.getId().toString(), LoginUtil.getLoginId()));</span><br><span class="line">    <span class="comment">// è®¾ç½®ç‚¹èµæ•°é‡</span></span><br><span class="line">    bo.setLikedCount(subjectLikedDomainService.getLikedCount(subjectInfoBO.getId().toString()));</span><br><span class="line">    <span class="comment">// ç»„è£…é¢˜ç›®çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œå¦‚ä¸Šä¸€ä¸ªå’Œä¸‹ä¸€ä¸ªé¢˜ç›®çš„ID</span></span><br><span class="line">    assembleSubjectCursor(subjectInfoBO, bo);</span><br><span class="line">    <span class="comment">// è¿”å›å°è£…å¥½çš„ä¸šåŠ¡å¯¹è±¡BO</span></span><br><span class="line">    <span class="keyword">return</span> bo;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç§æœ‰æ–¹æ³•ï¼Œç”¨äºç»„è£…é¢˜ç›®çš„ä¸Šä¸‹æ–‡ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">assembleSubjectCursor</span><span class="params">(SubjectInfoBO subjectInfoBO, SubjectInfoBO bo)</span> &#123;</span><br><span class="line">    <span class="comment">// è·å–åˆ†ç±»IDã€æ ‡ç­¾IDå’Œé¢˜ç›®ID</span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">categoryId</span> <span class="operator">=</span> subjectInfoBO.getCategoryId();</span><br><span class="line">    <span class="type">Long</span> <span class="variable">labelId</span> <span class="operator">=</span> subjectInfoBO.getLabelId();</span><br><span class="line">    <span class="type">Long</span> <span class="variable">subjectId</span> <span class="operator">=</span> subjectInfoBO.getId();</span><br><span class="line">    <span class="comment">// å¦‚æœåˆ†ç±»IDæˆ–æ ‡ç­¾IDä¸ºç©ºï¼Œåˆ™ä¸è¿›è¡Œä¸Šä¸‹æ–‡ä¿¡æ¯çš„ç»„è£…</span></span><br><span class="line">    <span class="keyword">if</span> (Objects.isNull(categoryId) || Objects.isNull(labelId)) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// æŸ¥è¯¢ä¸‹ä¸€ä¸ªé¢˜ç›®çš„ID</span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">nextSubjectId</span> <span class="operator">=</span> subjectInfoService.querySubjectIdCursor(subjectId, categoryId, labelId, <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// è®¾ç½®ä¸‹ä¸€ä¸ªé¢˜ç›®çš„IDåˆ°ä¸šåŠ¡å¯¹è±¡BOä¸­</span></span><br><span class="line">    bo.setNextSubjectId(nextSubjectId);</span><br><span class="line">    <span class="comment">// æŸ¥è¯¢ä¸Šä¸€ä¸ªé¢˜ç›®çš„ID</span></span><br><span class="line">    <span class="type">Long</span> <span class="variable">lastSubjectId</span> <span class="operator">=</span> subjectInfoService.querySubjectIdCursor(subjectId, categoryId, labelId, <span class="number">0</span>);</span><br><span class="line">    <span class="comment">// è®¾ç½®ä¸Šä¸€ä¸ªé¢˜ç›®çš„IDåˆ°ä¸šåŠ¡å¯¹è±¡BOä¸­</span></span><br><span class="line">    bo.setLastSubjectId(lastSubjectId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>SubjectInfoDao.xml</code></p><p><code>querySubjectIdCursor</code>å¯¹åº”çš„sqlè¯­å¥</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;querySubjectIdCursor&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;java.lang.Long&quot;</span>&gt;</span></span><br><span class="line">    select a.id</span><br><span class="line">    from subject_info a,</span><br><span class="line">    subject_mapping b</span><br><span class="line">    where a.id = b.subject_id</span><br><span class="line">    and b.category_id = #&#123;categoryId&#125;</span><br><span class="line">    and b.label_id = #&#123;labelId&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;cursor !=null and cursor == 1&quot;</span>&gt;</span></span><br><span class="line">        and a.id &gt; #&#123;subjectId&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">&quot;cursor !=null and cursor == 0&quot;</span>&gt;</span></span><br><span class="line">        and a.id <span class="symbol">&amp;lt;</span> #&#123;subjectId&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    limit 0,1</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> åç«¯ </tag>
            
            <tag> å¾®æœåŠ¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rustå¼‚æ­¥ç¼–ç¨‹</title>
      <link href="/2024/07/09/2024-07-09-Rust%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/"/>
      <url>/2024/07/09/2024-07-09-Rust%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="Rustå¼‚æ­¥ç¼–ç¨‹"><a href="#Rustå¼‚æ­¥ç¼–ç¨‹" class="headerlink" title="Rustå¼‚æ­¥ç¼–ç¨‹"></a>Rustå¼‚æ­¥ç¼–ç¨‹</h1><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">handles</span> = <span class="type">Vec</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line"><span class="keyword">for</span> <span class="variable">index</span> <span class="keyword">in</span> <span class="number">1</span>..=<span class="number">100</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">handle</span> = tokio::<span class="title function_ invoke__">spawn</span>(</span><br><span class="line">        async_http_client.<span class="title function_ invoke__">get</span>(<span class="built_in">format!</span>(<span class="string">&quot;www.example.com/items/&#123;&#125;&quot;</span>, index))</span><br><span class="line">    );</span><br><span class="line">    handles.<span class="title function_ invoke__">push</span>(handle);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> <span class="variable">handle</span> <span class="keyword">in</span> handles &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">result</span> = handle.<span class="keyword">await</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ¯”è¾ƒä½¿ç”¨å¼‚æ­¥ç¼–å†™çš„ç¤ºä¾‹ä¸åŒæ­¥ç¼–å†™çš„ç›¸åŒç¤ºä¾‹ - å¯¹äºå¤§é‡å¹¶å‘ Web è¯·æ±‚ï¼Œå¼‚æ­¥ç‰ˆæœ¬æ¯”åŒæ­¥è¯·æ±‚å¿«çº¦ 60%</p>]]></content>
      
      
      <categories>
          
          <category> Rust </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Rust </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RuståŸºç¡€å­¦ä¹ </title>
      <link href="/2024/07/08/2024-07-08-Rust%E5%AD%A6%E4%B9%A0/"/>
      <url>/2024/07/08/2024-07-08-Rust%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="RuståŸºç¡€å­¦ä¹ "><a href="#RuståŸºç¡€å­¦ä¹ " class="headerlink" title="RuståŸºç¡€å­¦ä¹ "></a>RuståŸºç¡€å­¦ä¹ </h1><p><a href="https://www.rust-lang.org/learn">Learn Rust - Rust Programming Language (rust-lang.org)</a></p><p><a href="https://blog.csdn.net/weixin_47754149/article/details/125701852?ops_request_misc=%7B%22request_id%22:%22172041285316800211535314%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172041285316800211535314&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-125701852-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=Rust&spm=1018.2226.3001.4187">ã€ä¸€èµ·å­¦Rustã€‘Rustä»‹ç»ä¸å¼€å‘ç¯å¢ƒæ­å»º_rustå¼€å‘-CSDNåšå®¢</a></p><p>åŒ…ç®¡ç†å·¥å…·ï¼šcargo</p><p>å‘½ä»¤è¡Œï¼š</p><blockquote><p>cargo new [name]ï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„Rusté¡¹ç›®<br>cargo buildï¼šæ„å»ºé¡¹ç›®<br>cargo runï¼šè¿è¡Œé¡¹ç›®<br>cargo testï¼šè¿è¡Œæµ‹è¯•<br>cargo docï¼šç”Ÿæˆæ–‡æ¡£<br>cargo updateï¼šæ›´æ–°ä¾èµ–é¡¹<br>cargo cleanï¼šæ¸…é™¤æ„å»ºè¾“å‡º<br>cargo publishï¼šå°†è½¯ä»¶åŒ…å‘å¸ƒåˆ°crates.ioä¸Š<br>cargo install [package]: å®‰è£…æŒ‡å®šè½¯ä»¶åŒ…<br>cargo uninstall [package]: å¸è½½æŒ‡å®šè½¯ä»¶åŒ…</p></blockquote><p><a href="https://blog.csdn.net/qq_36678837/article/details/131371856?ops_request_misc=%7B%22request_id%22:%22172041285316800211535314%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172041285316800211535314&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-2-131371856-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=Rust&spm=1018.2226.3001.4187">Rust å…¨é¢æŒ‡å—ï¼šä»åŸºç¡€åˆ°é«˜çº§ï¼Œä¸€ç½‘æ‰“å°½ Rust çš„ç¼–ç¨‹çŸ¥è¯†_rustè¯­è¨€-CSDNåšå®¢</a></p><h2 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h2><h3 id="å˜é‡å£°æ˜"><a href="#å˜é‡å£°æ˜" class="headerlink" title="å˜é‡å£°æ˜"></a>å˜é‡å£°æ˜</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®šä¹‰å˜é‡å¯ä»¥ä½¿ç”¨letå…³é”®å­—ï¼Œä¾‹å¦‚ï¼š</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">x</span> = <span class="number">10</span>; <span class="comment">//ä¼šè¢«è‡ªåŠ¨æ¨æ–­ä¸ºi32ç±»å‹</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">y</span>: <span class="type">i32</span> = <span class="number">20</span>;</span><br><span class="line"><span class="comment">//ä¸Šè¿°é»˜è®¤ä¸ºä¸å¯å˜å˜é‡,è‹¥è¦å¯å˜å˜é‡éœ€è¦åŠ å…¥mutå…³é”®å­—</span></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">z</span>=<span class="number">30</span>;</span><br><span class="line">z=<span class="number">40</span>;</span><br><span class="line"><span class="comment">//constå…³é”®å­—ç”¨äºä»£è¡¨è¿™æ˜¯ä¸€ä¸ªå¸¸äº®ï¼Œä¸èƒ½ä¸mutå…³é”®å­—è¿ç”¨</span></span><br></pre></td></tr></table></figure><h3 id="å…³é”®å­—"><a href="#å…³é”®å­—" class="headerlink" title="å…³é”®å­—"></a>å…³é”®å­—</h3><p>å…³é”®å­—<br>Rust è¯­è¨€æœ‰ä¸€ç»„ä¿ç•™çš„ å…³é”®å­—ï¼ˆkeywordsï¼‰ï¼Œå°±åƒå¤§éƒ¨åˆ†è¯­è¨€ä¸€æ ·ï¼Œå®ƒä»¬åªèƒ½ç”±è¯­è¨€æœ¬èº«ä½¿ç”¨ã€‚è®°ä½ï¼Œä½ ä¸èƒ½ä½¿ç”¨è¿™äº›å…³é”®å­—ä½œä¸ºå˜é‡æˆ–å‡½æ•°çš„åç§°ã€‚å¤§éƒ¨åˆ†å…³é”®å­—æœ‰ç‰¹æ®Šçš„æ„ä¹‰ï¼Œä½ å°†åœ¨ Rust ç¨‹åºä¸­ä½¿ç”¨å®ƒä»¬å®Œæˆå„ç§ä»»åŠ¡ï¼›ä¸€äº›å…³é”®å­—ç›®å‰æ²¡æœ‰ç›¸åº”çš„åŠŸèƒ½ï¼Œæ˜¯ä¸ºå°†æ¥å¯èƒ½æ·»åŠ çš„åŠŸèƒ½ä¿ç•™çš„ã€‚å¯ä»¥åœ¨é™„å½• A ä¸­æ‰¾åˆ°å…³é”®å­—çš„åˆ—è¡¨ã€‚</p><p>ç›®å‰æ­£åœ¨ä½¿ç”¨çš„å…³é”®å­—<br>å¦‚ä¸‹å…³é”®å­—ç›®å‰æœ‰å¯¹åº”å…¶æè¿°çš„åŠŸèƒ½ã€‚</p><p>as - å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œæ¶ˆé™¤ç‰¹å®šåŒ…å«é¡¹çš„ trait çš„æ­§ä¹‰ï¼Œæˆ–è€…å¯¹ use è¯­å¥ä¸­çš„é¡¹é‡å‘½å<br>async - è¿”å›ä¸€ä¸ª Future è€Œä¸æ˜¯é˜»å¡å½“å‰çº¿ç¨‹<br>await - æš‚åœæ‰§è¡Œç›´åˆ° Future çš„ç»“æœå°±ç»ª<br>break - ç«‹åˆ»é€€å‡ºå¾ªç¯<br>const - å®šä¹‰å¸¸é‡æˆ–ä¸å˜è£¸æŒ‡é’ˆï¼ˆconstant raw pointerï¼‰<br>continue - ç»§ç»­è¿›å…¥ä¸‹ä¸€æ¬¡å¾ªç¯è¿­ä»£<br>crate - åœ¨æ¨¡å—è·¯å¾„ä¸­ï¼Œä»£æŒ‡ crate root<br>dyn - åŠ¨æ€åˆ†å‘ trait å¯¹è±¡<br>else - ä½œä¸º if å’Œ if let æ§åˆ¶æµç»“æ„çš„ fallback<br>enum - å®šä¹‰ä¸€ä¸ªæšä¸¾<br>extern - é“¾æ¥ä¸€ä¸ªå¤–éƒ¨å‡½æ•°æˆ–å˜é‡<br>false - å¸ƒå°”å­—é¢å€¼ false<br>fn - å®šä¹‰ä¸€ä¸ªå‡½æ•°æˆ– å‡½æ•°æŒ‡é’ˆç±»å‹ (function pointer type)<br>for - éå†ä¸€ä¸ªè¿­ä»£å™¨æˆ–å®ç°ä¸€ä¸ª trait æˆ–è€…æŒ‡å®šä¸€ä¸ªæ›´é«˜çº§çš„ç”Ÿå‘½å‘¨æœŸ<br>if - åŸºäºæ¡ä»¶è¡¨è¾¾å¼çš„ç»“æœåˆ†æ”¯<br>impl - å®ç°è‡ªæœ‰æˆ– trait åŠŸèƒ½<br>in - for å¾ªç¯è¯­æ³•çš„ä¸€éƒ¨åˆ†<br>let - ç»‘å®šä¸€ä¸ªå˜é‡<br>loop - æ— æ¡ä»¶å¾ªç¯<br>match - æ¨¡å¼åŒ¹é…<br>mod - å®šä¹‰ä¸€ä¸ªæ¨¡å—<br>move - ä½¿é—­åŒ…è·å–å…¶æ‰€æ•è·é¡¹çš„æ‰€æœ‰æƒ<br>mut - è¡¨ç¤ºå¼•ç”¨ã€è£¸æŒ‡é’ˆæˆ–æ¨¡å¼ç»‘å®šçš„å¯å˜æ€§<br>pub - è¡¨ç¤ºç»“æ„ä½“å­—æ®µã€impl å—æˆ–æ¨¡å—çš„å…¬æœ‰å¯è§æ€§<br>ref - é€šè¿‡å¼•ç”¨ç»‘å®š<br>return - ä»å‡½æ•°ä¸­è¿”å›<br>Self - å®šä¹‰æˆ–å®ç° trait çš„ç±»å‹çš„ç±»å‹åˆ«å<br>self - è¡¨ç¤ºæ–¹æ³•æœ¬èº«æˆ–å½“å‰æ¨¡å—<br>static - è¡¨ç¤ºå…¨å±€å˜é‡æˆ–åœ¨æ•´ä¸ªç¨‹åºæ‰§è¡ŒæœŸé—´ä¿æŒå…¶ç”Ÿå‘½å‘¨æœŸ<br>struct - å®šä¹‰ä¸€ä¸ªç»“æ„ä½“<br>super - è¡¨ç¤ºå½“å‰æ¨¡å—çš„çˆ¶æ¨¡å—<br>trait - å®šä¹‰ä¸€ä¸ª trait<br>true - å¸ƒå°”å­—é¢å€¼ true<br>type - å®šä¹‰ä¸€ä¸ªç±»å‹åˆ«åæˆ–å…³è”ç±»å‹<br>union - å®šä¹‰ä¸€ä¸ª union å¹¶ä¸”æ˜¯ union å£°æ˜ä¸­å”¯ä¸€ç”¨åˆ°çš„å…³é”®å­—<br>unsafe - è¡¨ç¤ºä¸å®‰å…¨çš„ä»£ç ã€å‡½æ•°ã€trait æˆ–å®ç°<br>use - å¼•å…¥å¤–éƒ¨ç©ºé—´çš„ç¬¦å·<br>where - è¡¨ç¤ºä¸€ä¸ªçº¦æŸç±»å‹çš„ä»å¥<br>while - åŸºäºä¸€ä¸ªè¡¨è¾¾å¼çš„ç»“æœåˆ¤æ–­æ˜¯å¦è¿›è¡Œå¾ªç¯</p><h3 id="ä½œç”¨åŸŸ"><a href="#ä½œç”¨åŸŸ" class="headerlink" title="ä½œç”¨åŸŸ"></a>ä½œç”¨åŸŸ</h3><p>ç”±å¤§æ‹¬å·æ§åˆ¶</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">a</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;a = &#123;&#125;&quot;</span>, a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h3><p><img src="https://s2.loli.net/2024/07/08/3jEMuSxnkrgJ8bF.png" alt="image-20240708124030796.png"></p><p>å…ƒç»„(tuple)å’Œæ•°ç»„(array)</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å…ƒç»„</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">tup</span>=(<span class="number">100</span>,<span class="string">&#x27;ä½™&#x27;</span>,<span class="literal">true</span>,<span class="number">10.1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…ƒç»„æ˜¯ä»¥<code>()</code>è¡¨ç¤ºçš„ï¼Œé‡Œé¢æ”¾å…¥å„ä¸ªå…ƒç´ ï¼Œä¸”å„ä¸ªå…ƒç´ ä¹‹é—´ç”¨<code>,</code>åˆ†éš”</p><p>ç”±äºrustå¯ä»¥è‡ªåŠ¨æ¨å¯¼å‡ºå…¶ç±»å‹ï¼Œæ‰€ä»¥è¿™é‡Œæ²¡æœ‰æ‰‹åŠ¨ä¸ºå…¶æ ‡æ³¨ç±»å‹ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å…ƒç»„</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">tup</span>:(<span class="type">i32</span>,<span class="type">char</span>,<span class="type">bool</span>,<span class="type">f64</span>)=(<span class="number">100</span>,<span class="string">&#x27;ä½™&#x27;</span>,<span class="literal">true</span>,<span class="number">10.1</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; &#123;&#125; &#123;&#125; &#123;&#125;&quot;</span>,tup.<span class="number">0</span>,)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæ˜¯æ‰‹åŠ¨æ ‡æ³¨ç±»å‹</p><p>è¿˜æœ‰æ•°ç»„ä¹Ÿå¾ˆå¸¸ç”¨ï¼Œå®ƒçš„ä½¿ç”¨æ–¹æ³•ä¸å…ƒç»„è¿˜æ˜¯æœ‰ç‚¹å·®è·çš„ï¼Œå…¶ä¸­æœ€å¤§çš„å·®åˆ«å°±æ˜¯ï¼Œæ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ çš„ç±»å‹å¿…é¡»ç›¸åŒï¼ˆè€Œä¸Šé¢æåˆ°çš„å…ƒç»„å„ä¸ªå…ƒç´ ç±»å‹å¯ä»¥ä¸åŒï¼‰</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">arr</span>=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>];</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; &#123;&#125; &#123;&#125; &#123;&#125;&quot;</span>,arr[<span class="number">0</span>],arr[<span class="number">1</span>],arr[<span class="number">2</span>],arr[<span class="number">3</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h3><p>åˆ†ä¸ºStringï¼ˆå¯å˜ï¼‰å’Œ&amp;strï¼ˆä¸å¯å˜ï¼‰</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//String</span></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">s</span> = <span class="type">String</span>::<span class="title function_ invoke__">new</span>();</span><br><span class="line">s.<span class="title function_ invoke__">push_str</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">s.<span class="title function_ invoke__">push_str</span>(<span class="string">&quot;, world!&quot;</span>);</span><br><span class="line"><span class="comment">//&amp;str</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">s</span> = <span class="string">&quot;hello, world!&quot;</span>;</span><br><span class="line"><span class="comment">//è½¬åŒ–</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">s</span> = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">s2</span> = s.<span class="title function_ invoke__">to_string</span>();</span><br><span class="line">s2.<span class="title function_ invoke__">push_str</span>(<span class="string">&quot;, world!&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="å¯å˜æ•°ç»„Vec"><a href="#å¯å˜æ•°ç»„Vec" class="headerlink" title="å¯å˜æ•°ç»„Vec"></a>å¯å˜æ•°ç»„Vec</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">v</span>: <span class="type">Vec</span>&lt;<span class="type">i32</span>&gt; = <span class="type">Vec</span>::<span class="title function_ invoke__">new</span>(); <span class="comment">// åˆ›å»ºä¸€ä¸ªç©ºå‘é‡(ç”±äºæ˜¯å¯å˜çš„ï¼Œè¦ä½¿ç”¨mutå…³é”®å­—)</span></span><br><span class="line">v.<span class="title function_ invoke__">push</span>(<span class="number">1</span>); <span class="comment">// å‘å‘é‡ä¸­æ·»åŠ å…ƒç´ </span></span><br><span class="line">v.<span class="title function_ invoke__">push</span>(<span class="number">2</span>);</span><br><span class="line">v.<span class="title function_ invoke__">pop</span>();<span class="comment">//å‘é‡ä¸­å¼¹å‡ºå…ƒç´ </span></span><br><span class="line"><span class="comment">//insert,remove</span></span><br></pre></td></tr></table></figure><h3 id="Rust-HashTable-Map"><a href="#Rust-HashTable-Map" class="headerlink" title="Rust HashTable(Map)"></a>Rust HashTable(Map)</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::collections::HashMap;</span><br><span class="line"><span class="comment">//insert</span></span><br><span class="line"><span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">scores</span> = HashMap::<span class="title function_ invoke__">new</span>();</span><br><span class="line">scores.<span class="title function_ invoke__">insert</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Alice&quot;</span>), <span class="number">100</span>); <span class="comment">//è¿™é‡Œåº”è¯¥æ˜¯å°†å­—ç¬¦ä¸²å­—é¢é‡è½¬åŒ–ä¸ºStringç±»</span></span><br><span class="line">scores.<span class="title function_ invoke__">insert</span>(<span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Bob&quot;</span>), <span class="number">90</span>);</span><br><span class="line"><span class="comment">//get</span></span><br><span class="line">scores.<span class="title function_ invoke__">get</span>(<span class="string">&quot;Alice&quot;</span>);</span><br><span class="line"><span class="comment">//æœ‰åºçš„mapæ˜¯BTreeMapï¼Œè¦æ±‚KEYç±»å‹æ˜¯å¯ä»¥æ’åºçš„</span></span><br></pre></td></tr></table></figure><h3 id="é€»è¾‘åˆ¤æ–­"><a href="#é€»è¾‘åˆ¤æ–­" class="headerlink" title="é€»è¾‘åˆ¤æ–­"></a>é€»è¾‘åˆ¤æ–­</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//if else</span></span><br><span class="line"><span class="keyword">if</span> condition &#123;</span><br><span class="line">    <span class="comment">// code block to execute if the condition is true</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// code block to execute if the condition is false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> a&gt;<span class="number">0</span> &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;a&gt;0&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>  a==<span class="number">0</span>&#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;a==0&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;a&lt;0&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//match</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="comment">//æšä¸¾</span></span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">Direction</span> &#123;</span><br><span class="line">        Up,</span><br><span class="line">        Down,</span><br><span class="line">        Left,</span><br><span class="line">        Right,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">direction</span> = Direction::Up;</span><br><span class="line">    <span class="keyword">match</span> direction &#123;</span><br><span class="line">        Direction::Up =&gt; <span class="built_in">println!</span>(<span class="string">&quot;You chose up&quot;</span>), <span class="comment">//åœ¨ä½¿ç”¨matchè¯­å¥çš„æ—¶å€™ï¼Œå¯¹äºæ¯ä¸€ç§ä¸åŒçš„æƒ…å†µè¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœåŒ¹é…æˆåŠŸäº†ä¹‹åï¼Œå°±æ‰§è¡Œè¿™ä¸ª=&gt;ç¬¦å·åé¢æ‰€å¯¹åº”çš„é‚£äº›ä»£ç </span></span><br><span class="line">        Direction::Down =&gt; <span class="built_in">println!</span>(<span class="string">&quot;You chose down&quot;</span>),</span><br><span class="line">        Direction::Left =&gt; <span class="built_in">println!</span>(<span class="string">&quot;You chose left&quot;</span>),</span><br><span class="line">        Direction::Right =&gt; <span class="built_in">println!</span>(<span class="string">&quot;You chose right&quot;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="å¾ªç¯"><a href="#å¾ªç¯" class="headerlink" title="å¾ªç¯"></a>å¾ªç¯</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//while</span></span><br><span class="line"><span class="keyword">while</span> condition &#123;</span><br><span class="line">    <span class="comment">// code block to execute while the condition is true</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//for</span></span><br><span class="line"><span class="keyword">for</span> <span class="variable">variable</span> <span class="keyword">in</span> iterable &#123;</span><br><span class="line">    <span class="comment">// code block to execute for each value in the iterable</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> <span class="variable">i</span> <span class="keyword">in</span> <span class="number">10</span>..<span class="number">20</span>&#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125;&quot;</span>,i);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/*é€šè¿‡è¯­æ³• 10..20å°±å¯ä»¥è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª10åˆ°20çš„èŒƒå›´å¯¹è±¡ï¼Œ</span></span><br><span class="line"><span class="comment">å¹¶å°†è¯¥å¯¹è±¡ä¸­çš„å€¼ï¼Œä¾æ¬¡èµ‹å€¼ç»™foråé¢çš„å˜é‡åiï¼Œ</span></span><br><span class="line"><span class="comment">æ³¨æ„èŒƒå›´è¿ç®—ç¬¦ ..ç”Ÿæˆçš„èŒƒå›´å¯¹è±¡æ˜¯å·¦é—­å³å¼€çš„ï¼Œ</span></span><br><span class="line"><span class="comment">å…·ä½“æ¥è¯´ï¼Œ10..20 ï¼Œiåªä¼šç­‰äº10åˆ°19</span></span><br><span class="line"><span class="comment">ä½†æ˜¯ï¼Œ10..=20åˆ™æ˜¯10åˆ°20</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//loop</span></span><br><span class="line"><span class="keyword">loop</span> &#123;</span><br><span class="line">    <span class="comment">// code block to execute repeatedly until break is called</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/07/09/QTcfLK5GWydksaY.png" alt="image-20240709125242057.png"></p><h3 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h3><p>ä¸€ä¸ªæœ€ç®€å•çš„å‡½æ•°é•¿ä¸‹é¢è¿™æ ·ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">simple</span>()&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡å…³é”®å­—<code>fn</code>åŠ ä¸€ä¸ªå‡½æ•°åå­—ï¼Œ<code>()</code>ä¸<code>&#123;&#125;</code>ç»„æˆï¼Œé™¤æ­¤ä¹‹å¤–ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼ŒåŒæ ·ï¼Œå®ƒä¹Ÿä¸èƒ½åšä»»ä½•äº‹ã€‚</p><p>ä¸ºäº†èƒ½è®©è¿™ä¸ªå‡½æ•°å¹²ä¸€äº›äº‹æƒ…ï¼Œæˆ‘ä»¬å°±éœ€è¦åœ¨å‡½æ•°ä½“ï¼Œä¹Ÿå°±æ˜¯<code>&#123;&#125;</code>ä¸­å†™ä¸€äº›ä»£ç ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">simple</span>()&#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;ä»£ç &quot;</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;code&quot;</span>);</span><br><span class="line">    <span class="comment">//.....</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†åªæ˜¯è¿™æ ·è¿˜ä¸å¤Ÿï¼Œåœ¨æ²¡æœ‰ä»»ä½•è¾“å…¥çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå‡½æ•°èƒ½åšçš„äº‹æƒ…åŸºæœ¬å°±å†™æ­»äº†ï¼šæ— è®ºä»»ä½•åœ°æ–¹è°ƒç”¨å®ƒï¼Œå…¶ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ï¼ˆè°ƒç”¨éšæœºæ•°é™¤å¤–ï¼‰ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å°±éœ€è¦å‡½æ•°å‚æ•°ï¼Œä¹Ÿå°±æ˜¯ä»å‡½æ•°å¤–éƒ¨ä¼ å…¥çš„å˜é‡ï¼Œå¯ä»¥è®©å‡½æ•°å†…éƒ¨æ¥ä½¿ç”¨ï¼Œå‚æ•°å†™åœ¨<code>()</code>ä¸­ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">fn</span> <span class="title function_">simple</span>(i:<span class="type">i32</span>,c:<span class="type">char</span>,f:<span class="type">f64</span>,b:<span class="type">bool</span>)&#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;&#125; &#123;&#125; &#123;&#125; &#123;&#125;&quot;</span>,i,c,f,b);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å¸¦æœ‰è¿”å›å€¼çš„ä¾‹å­</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">sum</span>(a:<span class="type">i32</span>,b:<span class="type">i32</span>) <span class="punctuation">-&gt;</span> <span class="type">i32</span>&#123; <span class="comment">//-&gt;è¿”å›å€¼ç±»å‹</span></span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">s</span>=<span class="title function_ invoke__">sum</span>(<span class="number">100</span>,<span class="number">200</span>);</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;a+b=&#123;&#125;&quot;</span>,s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ç»“æ„"><a href="#ç»“æ„" class="headerlink" title="ç»“æ„"></a>ç»“æ„</h3><p><a href="https://blog.csdn.net/weixin_44786530/article/details/136432672?ops_request_misc=&request_id=&biz_id=102&utm_term=rust%E5%85%B3%E8%81%94%E5%87%BD%E6%95%B0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-2-136432672.142%5Ev100%5Epc_search_result_base8&spm=1018.2226.3001.4187">Rustç»“æ„ä½“è®²è§£å­¦ä¹ ï¼Œä»¥åŠimplç»“æ„ä½“æ–¹æ³•å’Œç»“æ„ä½“å…³è”å‡½æ•°_rust struct impl-CSDNåšå®¢</a></p><p>Rust é‡Œ struct è¯­å¥ä»…ç”¨æ¥å®šä¹‰ï¼Œä¸èƒ½å£°æ˜å®ä¾‹ï¼Œç»“å°¾ä¸éœ€è¦ ; ç¬¦å·ï¼Œè€Œä¸”æ¯ä¸ªå­—æ®µå®šä¹‰ä¹‹åç”¨ , åˆ†éš”ã€‚</p><p>ç»“æ„ä¸­ä¹Ÿæ²¡æœ‰æ–¹æ³•ï¼Œè¦æœ‰æ–¹æ³•åªèƒ½ç”¨implå»å®ç°æ–¹æ³•</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    name: <span class="type">String</span>,</span><br><span class="line">    age: <span class="type">u32</span> = <span class="number">0</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åˆ›å»ºå®ä¾‹</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable">person</span> = Person &#123;</span><br><span class="line">    name: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Alice&quot;</span>),</span><br><span class="line">    age: <span class="number">30</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//è®¿é—®å­—æ®µ </span></span><br><span class="line">person.name</span><br><span class="line"><span class="comment">//å•å…ƒç»“æ„ä½“:ç»“æ„ä½“å¯ä»¥åªä½œä¸ºä¸€ç§è±¡å¾è€Œæ— éœ€ä»»ä½•æˆå‘˜ï¼š</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">UnitStruct</span>;</span><br></pre></td></tr></table></figure><h4 id="ç»“æ„ä½“æ–¹æ³•"><a href="#ç»“æ„ä½“æ–¹æ³•" class="headerlink" title="ç»“æ„ä½“æ–¹æ³•"></a>ç»“æ„ä½“æ–¹æ³•</h4><p>æ–¹æ³•ï¼ˆMethodï¼‰å’Œå‡½æ•°ï¼ˆFunctionï¼‰ç±»ä¼¼ï¼Œåªä¸è¿‡å®ƒæ˜¯ç”¨æ¥æ“ä½œç»“æ„ä½“å®ä¾‹çš„ã€‚</p><p>å¦‚æœä½ å­¦ä¹ è¿‡ä¸€äº›é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œé‚£ä½ ä¸€å®šå¾ˆæ¸…æ¥šå‡½æ•°ä¸€èˆ¬æ”¾åœ¨ç±»å®šä¹‰é‡Œå¹¶åœ¨å‡½æ•°ä¸­ç”¨ this è¡¨ç¤ºæ‰€æ“ä½œçš„å®ä¾‹ã€‚</p><p>Rust è¯­è¨€ä¸æ˜¯é¢å‘å¯¹è±¡çš„ï¼Œä»å®ƒæ‰€æœ‰æƒæœºåˆ¶çš„åˆ›æ–°å¯ä»¥çœ‹å‡ºè¿™ä¸€ç‚¹ã€‚ä½†æ˜¯é¢å‘å¯¹è±¡çš„çè´µæ€æƒ³å¯ä»¥åœ¨ Rust å®ç°ã€‚</p><p><strong>ç»“æ„ä½“æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°å¿…é¡»æ˜¯ &amp;selfï¼Œä¸éœ€å£°æ˜ç±»å‹ï¼Œå› ä¸º self ä¸æ˜¯ä¸€ç§é£æ ¼è€Œæ˜¯å…³é”®å­—</strong>ã€‚</p><p>åœ¨è°ƒç”¨ç»“æ„ä½“æ–¹æ³•çš„æ—¶å€™ä¸éœ€è¦å¡«å†™ self ï¼Œè¿™æ˜¯å‡ºäºå¯¹ä½¿ç”¨æ–¹ä¾¿æ€§çš„è€ƒè™‘:</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è®¡ç®—ä¸€ä¸ªçŸ©å½¢çš„é¢ç§¯ï¼š</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    width: <span class="type">u32</span>,</span><br><span class="line">    height: <span class="type">u32</span>,</span><br><span class="line">&#125;</span><br><span class="line">   </span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">area</span>(&amp;<span class="keyword">self</span>) <span class="punctuation">-&gt;</span> <span class="type">u32</span> &#123;</span><br><span class="line">        <span class="keyword">self</span>.width * <span class="keyword">self</span>.height</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">rect1</span> = Rectangle &#123; width: <span class="number">30</span>, height: <span class="number">50</span> &#125;; <span class="comment">//åˆ›å»ºå®ä¾‹</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;rect1&#x27;s area is &#123;&#125;&quot;</span>, rect1.<span class="title function_ invoke__">area</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ç»“æ„ä½“å…³è”å‡½æ•°"><a href="#ç»“æ„ä½“å…³è”å‡½æ•°" class="headerlink" title="ç»“æ„ä½“å…³è”å‡½æ•°"></a>ç»“æ„ä½“å…³è”å‡½æ•°</h4><p>ä¹‹æ‰€ä»¥â€ç»“æ„ä½“æ–¹æ³•â€ä¸å«â€ç»“æ„ä½“å‡½æ•°â€æ˜¯å› ä¸ºâ€å‡½æ•°â€è¿™ä¸ªåå­—ç•™ç»™äº†è¿™ç§å‡½æ•°ï¼šå®ƒåœ¨ impl å—ä¸­å´æ²¡æœ‰ &amp;self å‚æ•°ã€‚</p><p>è¿™ç§å‡½æ•°ä¸ä¾èµ–å®ä¾‹ï¼Œä½†æ˜¯ä½¿ç”¨å®ƒéœ€è¦å£°æ˜æ˜¯åœ¨å“ªä¸ª impl å—ä¸­çš„ã€‚</p><p>ä¸€ç›´ä½¿ç”¨çš„ String::from å‡½æ•°å°±æ˜¯ä¸€ä¸ªâ€å…³è”å‡½æ•°â€ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#[derive(Debug)]</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    width: <span class="type">u32</span>,</span><br><span class="line">    height: <span class="type">u32</span>,</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Rectangle</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">create</span>(width: <span class="type">u32</span>, height: <span class="type">u32</span>) <span class="punctuation">-&gt;</span> Rectangle &#123; </span><br><span class="line">        Rectangle &#123; width, height &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">rect</span> = Rectangle::<span class="title function_ invoke__">create</span>(<span class="number">30</span>, <span class="number">50</span>); <span class="comment">//è°ƒç”¨çš„æ—¶å€™::</span></span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;&#123;:?&#125;&quot;</span>, rect);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æšä¸¾"><a href="#æšä¸¾" class="headerlink" title="æšä¸¾"></a>æšä¸¾</h3><p><a href="https://blog.csdn.net/qq_21484461/article/details/131544273?ops_request_misc=%7B%22request_id%22:%22172183648416800180669591%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172183648416800180669591&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-131544273-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=rust%E6%9E%9A%E4%B8%BE&spm=1018.2226.3001.4187">ã€Rust åŸºç¡€ç¯‡ã€‘Rust æšä¸¾ç±»å‹_rust enum-CSDNåšå®¢</a></p><h3 id="æ¥å£ï¼ˆTraitï¼‰"><a href="#æ¥å£ï¼ˆTraitï¼‰" class="headerlink" title="æ¥å£ï¼ˆTraitï¼‰"></a>æ¥å£ï¼ˆTraitï¼‰</h3><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">trait</span> <span class="title class_">Fly</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">fly</span>(&amp;<span class="keyword">self</span>); <span class="comment">//è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸€ä¸ªselfå‚æ•°ï¼Œè¡¨ç¤ºå¯¹å®ç°è¿™ä¸ªtraitçš„ç±»å‹çš„å¼•ç”¨</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å®ä¾‹</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Bird</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Fly</span> <span class="keyword">for</span> <span class="title class_">Bird</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">fly</span>(&amp;<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;I can fly!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> <span class="variable">bird</span> = Bird&#123;&#125;;</span><br><span class="line">bird.<span class="title function_ invoke__">fly</span>();</span><br></pre></td></tr></table></figure><h3 id="æ³¨è§£"><a href="#æ³¨è§£" class="headerlink" title="æ³¨è§£"></a>æ³¨è§£</h3><p>Rustçš„æ³¨è§£æ˜¯ä»¥#å­—ç¬¦å¼€å¤´çš„ç‰¹æ®Šæ³¨é‡Šï¼Œå¯ä»¥ä¸ºä»£ç æä¾›æ›´å¤šçš„è¯­ä¹‰ä¿¡æ¯æˆ–è€…ä¿®æ”¹ç¼–è¯‘å™¨çš„è¡Œä¸ºã€‚Rustæ³¨è§£é€šå¸¸æ”¾åœ¨ä»£ç çš„ä¸Šæ–¹ï¼Œç”¨äºæ³¨é‡ŠæŸäº›ç‰¹å®šçš„è¯­æ³•ç»“æ„æˆ–è€…ä»£ç å—ã€‚ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„Rustæ³¨è§£ï¼š</p><ol><li>#[derive(Debug)]ï¼šè¿™ä¸ªæ³¨è§£ç”¨äºæ ‡è®°ä¸€ä¸ªç»“æ„ä½“æˆ–è€…æšä¸¾ï¼Œè®©ç¼–è¯‘å™¨è‡ªåŠ¨ç”ŸæˆDebug traitçš„å®ç°ã€‚è¿™æ ·ï¼Œåœ¨è°ƒè¯•æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨{:?}æ ¼å¼åŒ–è¾“å‡ºç»“æ„ä½“æˆ–è€…æšä¸¾çš„å†…å®¹ï¼Œæ–¹ä¾¿å¿«æ·ã€‚</li><li>#[test]ï¼šè¿™ä¸ªæ³¨è§£ç”¨äºæ ‡è®°ä¸€ä¸ªæµ‹è¯•å‡½æ•°ï¼Œè¡¨ç¤ºå®ƒæ˜¯ä¸€ä¸ªå•å…ƒæµ‹è¯•ã€‚æµ‹è¯•æ¡†æ¶å¯ä»¥é€šè¿‡è¿™ä¸ªæ³¨è§£è‡ªåŠ¨è¯†åˆ«æµ‹è¯•å‡½æ•°å¹¶æ‰§è¡Œæµ‹è¯•ï¼Œæ–¹ä¾¿æˆ‘ä»¬ç¼–å†™å’Œè¿è¡Œæµ‹è¯•ä»£ç ã€‚</li><li>#[allow(unused_variables)]ï¼šè¿™ä¸ªæ³¨è§£ç”¨äºå…³é—­ç¼–è¯‘å™¨çš„æœªä½¿ç”¨å˜é‡è­¦å‘Šã€‚å¦‚æœæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå˜é‡ä½†æ˜¯å¹¶æ²¡æœ‰ä½¿ç”¨å®ƒï¼Œç¼–è¯‘å™¨ä¼šå‘å‡ºè­¦å‘Šï¼Œè¿™ä¸ªæ³¨è§£å¯ä»¥å¸®åŠ©æˆ‘ä»¬å±è”½è¿™ä¸ªè­¦å‘Šã€‚</li><li>#[cfg(target_os &#x3D; â€œwindowsâ€)]ï¼šè¿™ä¸ªæ³¨è§£ç”¨äºæ ¹æ®ä¸åŒçš„æ“ä½œç³»ç»Ÿç¼–è¯‘ä¸åŒçš„ä»£ç ã€‚å¦‚æœæˆ‘ä»¬çš„ä»£ç éœ€è¦åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ³¨è§£æ¥æŒ‡å®šç‰¹å®šçš„ç¼–è¯‘æ¡ä»¶ã€‚</li><li>#[no_mangle]ï¼šè¿™ä¸ªæ³¨è§£ç”¨äºé˜²æ­¢Rustç¼–è¯‘å™¨å¯¹å‡½æ•°åè¿›è¡Œé‡å‘½åï¼Œä¿ç•™åŸå§‹åç§°ã€‚å¦‚æœæˆ‘ä»¬çš„ä»£ç éœ€è¦å’Œå…¶ä»–è¯­è¨€äº¤äº’ï¼Œå°±éœ€è¦ä½¿ç”¨è¿™ä¸ªæ³¨è§£æ¥ä¿è¯å‡½æ•°åçš„ä¸€è‡´æ€§ã€‚</li></ol><p>æ€»ä¹‹ï¼ŒRustæ³¨è§£å¯ä»¥æä¾›é¢å¤–çš„ä¿¡æ¯ï¼Œå¸®åŠ©ç¼–è¯‘å™¨å’Œå¼€å‘è€…æ›´å¥½åœ°ç†è§£å’Œå¤„ç†ä»£ç ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ä¿®æ”¹ç¼–è¯‘å™¨çš„è¡Œä¸ºï¼Œä»¥æ»¡è¶³ç‰¹å®šçš„éœ€æ±‚ã€‚</p><p>Rustå…è®¸å¼€å‘è€…è‡ªå®šä¹‰æ³¨è§£ï¼ˆAttributeï¼‰ï¼Œå¯ä»¥é€šè¿‡å®å®šä¹‰çš„æ–¹å¼å®ç°ã€‚è‡ªå®šä¹‰æ³¨è§£å¯ä»¥ä¸ºä»£ç æä¾›æ›´å¤šçš„è¯­ä¹‰ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹ç¼–è¯‘å™¨çš„è¡Œä¸ºï¼Œæ–¹ä¾¿æˆ‘ä»¬ç¼–å†™é«˜æ•ˆã€ä¼˜é›…çš„ä»£ç ã€‚</p><p>è‡ªå®šä¹‰æ³¨è§£çš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#[my_attribute(arg1, arg2, ...)]</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">my_function</span>() &#123;</span><br><span class="line">    <span class="comment">// code here</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//ä¾‹å­</span></span><br><span class="line"><span class="meta">#[my_attribute(<span class="string">&quot;hello&quot;</span>, 42)]</span></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">my_function</span>() &#123;</span><br><span class="line">    <span class="comment">// code here</span></span><br><span class="line">&#125;</span><br><span class="line">å®šä¹‰äº†ä¸€ä¸ªåä¸ºmy_attributeçš„æ³¨è§£ï¼Œå®ƒå¸¦æœ‰ä¸¤ä¸ªå‚æ•°ï¼šä¸€ä¸ªå­—ç¬¦ä¸²<span class="string">&quot;hello&quot;</span>å’Œä¸€ä¸ªæ•´æ•°<span class="number">42</span>ã€‚æˆ‘ä»¬å¯ä»¥åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨è¿™ä¸ªæ³¨è§£ï¼Œä¾‹å¦‚å¯¹å‡½æ•°è¿›è¡Œæ ‡è®°ï¼Œè¡¨ç¤ºå®ƒæ˜¯ä¸€ä¸ªç‰¹å®šç±»å‹çš„å‡½æ•°ã€‚</span><br></pre></td></tr></table></figure><h3 id="æ¨¡å—"><a href="#æ¨¡å—" class="headerlink" title="æ¨¡å—"></a>æ¨¡å—</h3><p>Rustçš„æ¨¡å—ç³»ç»Ÿæ˜¯åŸºäºæ–‡ä»¶ç³»ç»Ÿçš„ç»„ç»‡æ–¹å¼ã€‚æ¯ä¸ªRustæ–‡ä»¶éƒ½å¯ä»¥è¢«è§†ä¸ºä¸€ä¸ªæ¨¡å—ï¼Œæ¨¡å—åä¸æ–‡ä»¶åç›¸åŒã€‚åœ¨ä¸€ä¸ªæ¨¡å—ä¸­ï¼Œå¯ä»¥ä½¿ç”¨<code>mod</code>å…³é”®å­—å®šä¹‰å­æ¨¡å—ï¼Œä½¿ç”¨<code>use</code>å…³é”®å­—å¼•ç”¨å…¶ä»–æ¨¡å—ä¸­çš„å®šä¹‰ã€‚</p><p>ä¾‹å¦‚ï¼Œå‡è®¾æœ‰å¦‚ä¸‹ç»“æ„çš„æ–‡ä»¶ç³»ç»Ÿï¼š</p><blockquote><p>src&#x2F;<br>â”œâ”€â”€ main.rs<br>â””â”€â”€ my_module&#x2F;<br>    â”œâ”€â”€ mod.rs<br>    â”œâ”€â”€ sub_module.rs<br>    â””â”€â”€ my_struct.rs</p></blockquote><p>åœ¨ä¸Šè¿°ç»“æ„ä¸­ï¼Œsrcç›®å½•æ˜¯Rusté¡¹ç›®çš„æ ¹ç›®å½•ï¼Œmain.rsæ˜¯é¡¹ç›®çš„å…¥å£æ–‡ä»¶ã€‚my_moduleç›®å½•æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œå…¶ä¸‹æœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼š</p><p>mod.rsï¼šå®šä¹‰äº†my_moduleæ¨¡å—çš„<strong>å…¬å…±æ¥å£</strong>ã€‚</p><p>sub_module.rsï¼šå®šä¹‰äº†my_moduleæ¨¡å—çš„<strong>å­æ¨¡å—</strong>sub_moduleã€‚</p><p>my_struct.rsï¼šå®šä¹‰äº†my_moduleæ¨¡å—çš„ä¸€ä¸ª<strong>ç»“æ„ä½“</strong>MyStructã€‚</p><p>åœ¨<code>mod.rs</code>ä¸­ï¼Œå¯ä»¥ä½¿ç”¨modå…³é”®å­—å®šä¹‰å­æ¨¡å—ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">mod</span> sub_module;</span><br><span class="line"></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">struct</span> <span class="title class_">MyStruct</span> &#123;</span><br><span class="line">    <span class="keyword">pub</span> field: <span class="type">i32</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">my_function</span>() &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Hello from my_function!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªåä¸º<code>MyStruct</code>çš„ç»“æ„ä½“ï¼Œè¿˜æœ‰ä¸€ä¸ªåä¸º<code>my_function</code>çš„å‡½æ•°ã€‚åŒæ—¶ï¼Œä½¿ç”¨<code>mod</code>å…³é”®å­—å®šä¹‰äº†ä¸€ä¸ªåä¸º<code>sub_module</code>çš„å­æ¨¡å—ã€‚</p><p>åœ¨<code>sub_module.rs</code>ä¸­ï¼Œå¯ä»¥å®šä¹‰å­æ¨¡å—<code>sub_module</code>ä¸­çš„å†…å®¹ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">sub_function</span>() &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Hello from sub_function!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªåä¸º<code>sub_function</code>çš„å‡½æ•°ã€‚</p><p>åœ¨ä½¿ç”¨<code>my_module</code>æ¨¡å—ä¸­çš„å®šä¹‰æ—¶ï¼Œéœ€è¦ä½¿ç”¨useå…³é”®å­—å¼•ç”¨å®ƒä»¬ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> crate::my_module::&#123;MyStruct, my_function&#125;;</span><br><span class="line"><span class="keyword">use</span> crate::my_module::sub_module::sub_function;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">my_struct</span> = MyStruct &#123; field: <span class="number">42</span> &#125;;</span><br><span class="line">    <span class="title function_ invoke__">my_function</span>();</span><br><span class="line">    <span class="title function_ invoke__">sub_function</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œä½¿ç”¨useå…³é”®å­—å¼•ç”¨äº†MyStructå’Œmy_functionï¼Œä»¥åŠsub_functionã€‚ç„¶åï¼Œå¯ä»¥åœ¨mainå‡½æ•°ä¸­ä½¿ç”¨è¿™äº›å®šä¹‰ã€‚</p><h3 id="Rust-Cargo-toml"><a href="#Rust-Cargo-toml" class="headerlink" title="Rust Cargo.toml"></a>Rust Cargo.toml</h3><p>Rustä½¿ç”¨ Cargo.toml æ–‡ä»¶æè¿°é¡¹ç›®çš„å…ƒæ•°æ®å’Œä¾èµ–å…³ç³»ã€‚ä¸‹é¢æ˜¯å¯¹ Cargo.toml æ–‡ä»¶çš„è¯¦ç»†è®²è§£ã€‚</p><p>Cargo.toml æ–‡ä»¶æ˜¯ä¸€ä¸ª TOMLï¼ˆTomâ€™s Obvious, Minimal Languageï¼Œå³Tomçš„ç®€æ´æ˜äº†è¯­è¨€ï¼‰æ ¼å¼çš„æ–‡ä»¶ï¼Œç”¨äºæè¿° Rust é¡¹ç›®çš„<strong>å…ƒæ•°æ®å’Œä¾èµ–å…³ç³»</strong>ã€‚å®ƒé€šå¸¸ä½äºé¡¹ç›®çš„æ ¹ç›®å½•ä¸‹ï¼Œä¸ src&#x2F; ç›®å½•åŒçº§ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š</p><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[package]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">&quot;myproject&quot;</span></span><br><span class="line"><span class="attr">version</span> = <span class="string">&quot;0.1.0&quot;</span></span><br><span class="line"><span class="attr">authors</span> = [<span class="string">&quot;Your Name &lt;you@example.com&gt;&quot;</span>]</span><br><span class="line"><span class="attr">edition</span> = <span class="string">&quot;2018&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[dependencies]</span></span><br><span class="line"><span class="attr">rand</span> = <span class="string">&quot;0.7.0&quot;</span></span><br><span class="line"><span class="attr">serde</span> = <span class="string">&quot;1.0&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[lib]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">&quot;mylib&quot;</span></span><br><span class="line"><span class="attr">path</span> = <span class="string">&quot;src/mylib.rs&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[[bin]]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">&quot;mybin&quot;</span></span><br><span class="line"><span class="attr">path</span> = <span class="string">&quot;src/mybin.rs&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[[bin]]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">&quot;myotherbin&quot;</span></span><br><span class="line"><span class="attr">path</span> = <span class="string">&quot;src/myotherbin.rs&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[features]</span></span><br><span class="line"><span class="attr">default</span> = [<span class="string">&quot;myfeature1&quot;</span>]</span><br><span class="line"><span class="attr">myfeature1</span> = []</span><br><span class="line"><span class="attr">myfeature2</span> = []</span><br><span class="line"></span><br><span class="line"><span class="section">[dependencies.mydependency]</span></span><br><span class="line"><span class="attr">version</span> = <span class="string">&quot;1.0&quot;</span></span><br><span class="line"><span class="attr">features</span> = [<span class="string">&quot;myfeature1&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="section">[workspace]</span></span><br><span class="line"><span class="attr">members</span> = [</span><br><span class="line">    <span class="string">&quot;mylib&quot;</span>,</span><br><span class="line">    <span class="string">&quot;mybin&quot;</span>,</span><br><span class="line">    <span class="string">&quot;myotherbin&quot;</span>,</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>[package]</code> è¡¨ç¤ºåŒ…çš„å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬åŒ…åã€ç‰ˆæœ¬å·ã€ä½œè€…å’Œ Rust ç‰ˆæœ¬ç­‰ä¿¡æ¯ã€‚<code>[dependencies]</code> è¡¨ç¤ºåŒ…çš„ä¾èµ–é¡¹ï¼Œ<code>[lib]</code> è¡¨ç¤ºåº“çš„é…ç½®ï¼Œ<code>[[bin]]</code> è¡¨ç¤ºå¯æ‰§è¡Œæ–‡ä»¶çš„é…ç½®ï¼Œ<code>[features]</code> è¡¨ç¤ºç‰¹æ€§çš„é…ç½®ï¼Œ<code>[dependencies.mydependency]</code> è¡¨ç¤ºä¾èµ–çš„é…ç½®ï¼Œ<code>[workspace]</code> è¡¨ç¤ºå·¥ä½œç©ºé—´çš„é…ç½®ã€‚</p><p>å¼•å…¥å•ä¸ªæœ¬åœ°æ¨¡å—çš„æ–¹æ³•æ˜¯ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º <code>src/</code> çš„æ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹åˆ›å»º Rust æ¨¡å—ï¼Œä¾‹å¦‚ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/mymodule.rs</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">myfunction</span>() &#123;</span><br><span class="line">    <span class="built_in">println!</span>(<span class="string">&quot;Hello, world!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç„¶åï¼Œåœ¨ <code>main.rs</code>ï¼ˆæˆ–å…¶ä»–ç¨‹åºå…¥å£æ–‡ä»¶ï¼‰ä¸­å¼•å…¥è¯¥æ¨¡å—ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/main.rs</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">mod</span> mymodule;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    mymodule::<span class="title function_ invoke__">myfunction</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¼•å…¥å¤šä¸ªæœ¬åœ°æ¨¡å—ä¹Ÿæ˜¯ç±»ä¼¼çš„ã€‚å‡è®¾åœ¨ src&#x2F; ç›®å½•ä¸‹è¿˜æœ‰ä¸€ä¸ªåä¸º myothermodule.rs çš„ Rust æ¨¡å—ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/main.rs</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">mod</span> mymodule;</span><br><span class="line"><span class="keyword">mod</span> myothermodule;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    mymodule::<span class="title function_ invoke__">myfunction</span>();</span><br><span class="line">    myothermodule::<span class="title function_ invoke__">myotherfunction</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="çš„ç”¨æ³•"><a href="#çš„ç”¨æ³•" class="headerlink" title="::çš„ç”¨æ³•"></a>::çš„ç”¨æ³•</h3><p>åœ¨<a href="https://www.baidu.com/s?word=Rust&sa=re_dqa_zy">Rust</a>ä¸­ï¼ŒåŒå†’å·æœ‰å‡ ç§ç”¨é€”ï¼Œä¸»è¦æ¶‰åŠåˆ°æ¨¡å—ã€ç±»å‹ã€æšä¸¾å˜ä½“æˆ–<a href="https://www.baidu.com/s?word=trait&sa=re_dqa_zy">trait</a>å®ç°çš„å¼•ç”¨ã€‚</p><ol><li><p><strong>æ¨¡å—å’Œç±»å‹çš„å¼•ç”¨</strong>ï¼š<code>::</code>ç”¨äºå¼•ç”¨æ¨¡å—ä¸­çš„ç±»å‹æˆ–å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œ<code>String::from(&quot;hello&quot;)</code>è¡¨ç¤ºè°ƒç”¨<code>String</code>ç±»å‹ä¸­çš„<code>from</code>é™æ€æ–¹æ³•ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ã€‚</p></li><li><p><strong>æšä¸¾å˜ä½“çš„å¼•ç”¨</strong>ï¼šå½“éœ€è¦å¼•ç”¨æšä¸¾çš„æŸä¸ªå˜ä½“æ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>::</code>ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæœ‰ä¸€ä¸ªæšä¸¾<code>Color</code>ï¼Œå…¶ä¸­åŒ…å«<code>Red</code>å’Œ<code>Green</code>ä¸¤ä¸ªå˜ä½“ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡<code>Color::Red</code>å’Œ<code>Color::Green</code>æ¥å¼•ç”¨è¿™äº›å˜ä½“ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">Message</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">Hello</span>(<span class="type">String</span>),</span><br><span class="line">    Goodbye</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">hello</span>(message: Message) &#123;</span><br><span class="line">    <span class="keyword">match</span> message &#123;</span><br><span class="line">        Message::<span class="title function_ invoke__">Hello</span>(s) =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Hello, &#123;&#125;&quot;</span>, s),</span><br><span class="line">        Message::Goodbye =&gt; <span class="built_in">println!</span>(<span class="string">&quot;Goodbye!&quot;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>Traitå®ç°çš„å¼•ç”¨</strong>ï¼šåœ¨Rustä¸­ï¼ŒTraitå¯ä»¥å®šä¹‰ä¸€ç»„æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•å¯ä»¥ç”±å®ç°è¯¥Traitçš„ç±»å‹æä¾›å…·ä½“å®ç°ã€‚ä½¿ç”¨<code>::</code>å¯ä»¥æ˜ç¡®æŒ‡å®šæŸä¸ªç±»å‹å®ç°äº†æŸä¸ªTraitçš„å…·ä½“æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæœ‰ä¸€ä¸ªTrait <code>Greeter</code>ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªç±»å‹<code>Person</code>å®ç°äº†è¿™ä¸ªTraitï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡<code>Person::greet(&amp;person)</code>æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå°½ç®¡è¿™é€šå¸¸ä¸å…·ä½“çš„å®ä¾‹æ— å…³ï¼Œæ›´å¸¸è§çš„æ˜¯ä½¿ç”¨åŠ¨æ€è°ƒåº¦ï¼ˆå¦‚<code>g.greet()</code>ï¼‰ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚éœ€è¦æ˜ç¡®ç±»å‹å’Œæ–¹æ³•çš„å…³ç³»æ—¶ï¼Œè¿™ç§è¯­æ³•æ˜¯æœ‰ç”¨çš„ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">trait</span> <span class="title class_">Greeter</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">greet</span>(&amp;<span class="keyword">self</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Person</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Greeter</span> <span class="keyword">for</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">greet</span>(&amp;<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;Hello from Person!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">use_greeter</span>(g: &amp;<span class="keyword">dyn</span> Greeter) &#123;</span><br><span class="line">    g.<span class="title function_ invoke__">greet</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">person</span> = Person;</span><br><span class="line">    <span class="title function_ invoke__">use_greeter</span>(&amp;person <span class="keyword">as</span> &amp;<span class="keyword">dyn</span> Greeter); <span class="comment">// ä½¿ç”¨ as å…³é”®å­—å’Œ &amp;dyn æ¥åˆ›å»ºä¸€ä¸ª trait å¯¹è±¡</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>åœ¨æ³›å‹å®ä¾‹åŒ–ä¸­æŒ‡å®šç±»å‹å‚æ•°</strong>ï¼šå½“ä½ è¦åˆ›å»ºä¸€ä¸ªæ³›å‹ç±»å‹çš„å®ä¾‹å¹¶æ˜ç¡®æŒ‡å®šå…¶ç±»å‹å‚æ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ <code>::&lt;T&gt;</code>ã€‚è¿™åœ¨ä½ ä¸æƒ³ä¾èµ–ç±»å‹æ¨æ–­ï¼Œæˆ–è€…ç±»å‹æ¨æ–­ä¸èƒ½æ­£ç¡®å·¥ä½œæ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="variable">vec</span> = <span class="type">Vec</span>::&lt;<span class="type">i32</span>&gt;::<span class="title function_ invoke__">new</span>(); <span class="comment">// åˆ›å»ºä¸€ä¸ªåŒ…å« i32 ç±»å‹å…ƒç´ çš„ Vec å®ä¾‹</span></span><br></pre></td></tr></table></figure></li><li><p><strong>æ˜ç¡®æŒ‡å®šä½œç”¨åŸŸ</strong>ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œ<code>::</code>ä¹Ÿç”¨äºæ˜ç¡®æŒ‡å®šä½œç”¨åŸŸï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†ä¸å‘½åç©ºé—´ç›¸å…³çš„é—®é¢˜æ—¶ã€‚è¿™æœ‰åŠ©äºç¼–è¯‘å™¨ç†è§£ä½ çš„æ„å›¾ï¼Œé¿å…åç§°å†²çªã€‚</p><p>ä¾‹å­ï¼š</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::io;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">print_something</span>() &#123;</span><br><span class="line">    io::<span class="built_in">println!</span>(<span class="string">&quot;Hello from io!&quot;</span>); <span class="comment">// ä½¿ç”¨ std::io æ¨¡å—ä¸­çš„ println å‡½æ•°</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="selfå’ŒSelf"><a href="#selfå’ŒSelf" class="headerlink" title="selfå’ŒSelf"></a>selfå’ŒSelf</h3><p><strong>self</strong></p><p>self æ˜¯ä¸€ä¸ªä»£è¡¨<strong>ç±»å‹å®ä¾‹ï¼ˆæˆ–è€…æ˜¯ç±»å‹çš„å¼•ç”¨æˆ–è€…æ˜¯å€¼ï¼‰</strong>çš„å…³é”®å­—ï¼Œåœ¨ Rust çš„æ–¹æ³•ä¸­ä½¿ç”¨ self å¯ä»¥å¼•ç”¨å½“å‰ç±»å‹çš„å®ä¾‹æˆ–è€…ç±»å‹æœ¬èº«ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œå½“æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œä½¿ç”¨ self å…³é”®å­—ä½œä¸ºæ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥è®©æˆ‘ä»¬åœ¨è°ƒç”¨è¯¥æ–¹æ³•æ—¶ç›´æ¥è®¿é—®ç±»å‹å®ä¾‹æœ¬èº«</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Point</span> &#123;</span><br><span class="line">    x: <span class="type">f32</span>,</span><br><span class="line">    y: <span class="type">f32</span>,</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Point</span> &#123;</span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">distance</span>(&amp;<span class="keyword">self</span>, other: &amp;Point) <span class="punctuation">-&gt;</span> <span class="type">f32</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">dx</span> = <span class="keyword">self</span>.x - other.x;</span><br><span class="line">        <span class="keyword">let</span> <span class="variable">dy</span> = <span class="keyword">self</span>.y - other.y;</span><br><span class="line">        (dx * dx + dy * dy).<span class="title function_ invoke__">sqrt</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Self"><a href="#Self" class="headerlink" title="Self"></a>Self</h3><p>é€šå¸¸åœ¨ Rust çš„ trait å’Œ associated function ä¸­ä½¿ç”¨ Self æ¥æŒ‡ä»£å®ç°è¯¥ trait æˆ–è°ƒç”¨è¯¥ associated function çš„ç±»å‹ã€‚</p><figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Point</span> &#123;</span><br><span class="line">    x: <span class="type">f32</span>,</span><br><span class="line">    y: <span class="type">f32</span>,</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Point</span> &#123;</span><br><span class="line">    <span class="comment">//å…³è”å‡½æ•°</span></span><br><span class="line">    <span class="keyword">fn</span> <span class="title function_">origin</span>() <span class="punctuation">-&gt;</span> <span class="keyword">Self</span> &#123;</span><br><span class="line">        Point &#123; x: <span class="number">0.0</span>, y: <span class="number">0.0</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="variable">p</span> = Point::<span class="title function_ invoke__">origin</span>();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure><h2 id="æ‰€æœ‰æƒ"><a href="#æ‰€æœ‰æƒ" class="headerlink" title="æ‰€æœ‰æƒ"></a>æ‰€æœ‰æƒ</h2><p><a href="https://blog.csdn.net/u014388408/article/details/134141656?ops_request_misc=%7B%22request_id%22:%22172183502916800227449484%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172183502916800227449484&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-134141656-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=rust%E6%89%80%E6%9C%89%E6%9D%83&spm=1018.2226.3001.4187">Rustæ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼ˆæ‰€æœ‰æƒï¼‰_rust æ‰€æœ‰æƒ-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/qq_21484461/article/details/131446498?ops_request_misc=%7B%22request_id%22:%22172183502916800227449484%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172183502916800227449484&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-5-131446498-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=rust%E6%89%80%E6%9C%89%E6%9D%83&spm=1018.2226.3001.4187">ã€Rust åŸºç¡€ç¯‡ã€‘Rust æ‰€æœ‰æƒè¯¦è§£_rustæ‰€æœ‰æƒå’Œå†…å­˜åˆ†æå›¾è§£-CSDNåšå®¢</a></p><h2 id="å¼•ç”¨å’Œå€Ÿç”¨"><a href="#å¼•ç”¨å’Œå€Ÿç”¨" class="headerlink" title="å¼•ç”¨å’Œå€Ÿç”¨"></a>å¼•ç”¨å’Œå€Ÿç”¨</h2><p><a href="https://blog.csdn.net/jiang1126/article/details/137867763?ops_request_misc=&request_id=&biz_id=102&utm_term=rust%E5%BC%95%E7%94%A8%E5%92%8C%E5%80%9F%E7%94%A8&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-137867763.142%5Ev100%5Epc_search_result_base8&spm=1018.2226.3001.4187">Rust - å¼•ç”¨å’Œå€Ÿç”¨_rust å€Ÿç”¨å’Œå¼•ç”¨-CSDNåšå®¢</a></p><h2 id="åˆ‡ç‰‡å’Œæ•°ç»„"><a href="#åˆ‡ç‰‡å’Œæ•°ç»„" class="headerlink" title="åˆ‡ç‰‡å’Œæ•°ç»„"></a>åˆ‡ç‰‡å’Œæ•°ç»„</h2><p><a href="https://blog.csdn.net/z974656361/article/details/107596501?ops_request_misc=%7B%22request_id%22:%22172183623316800178526100%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172183623316800178526100&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-1-107596501-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=rust%E5%88%87%E7%89%87%E5%92%8C%E6%95%B0%E7%BB%84&spm=1018.2226.3001.4187">rustä¸­çš„æ•°ç»„å’Œåˆ‡ç‰‡_rust æ•°ç»„åˆ‡ç‰‡-CSDNåšå®¢</a></p><h2 id="å¸¸ç”¨åº“"><a href="#å¸¸ç”¨åº“" class="headerlink" title="å¸¸ç”¨åº“"></a>å¸¸ç”¨åº“</h2><p>Rustå¸¸ç”¨åº“<br>å¥½çš„ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ Rust åº“åŠå…¶å¸¸ç”¨æ–¹æ³•çš„ä¸¾ä¾‹ï¼š</p><ol><li>std åº“<ul><li>println!(): æ‰“å°è¾“å‡ºä¿¡æ¯åˆ°æ§åˆ¶å°</li><li>Vec<T>: åŠ¨æ€æ•°ç»„ç±»å‹</li><li>String: å¯å˜å­—ç¬¦ä¸²ç±»å‹</li><li>HashMap&lt;K, V&gt;: å“ˆå¸Œè¡¨ç±»å‹</li></ul></li><li>serde åº“<ul><li>serde_json::to_string(): å°† Rust ç»“æ„ä½“åºåˆ—åŒ–ä¸º JSON å­—ç¬¦ä¸²</li><li>serde_json::from_str(): å°† JSON å­—ç¬¦ä¸²ååºåˆ—åŒ–ä¸º Rust ç»“æ„ä½“</li><li>serde_yaml::to_string(): å°† Rust ç»“æ„ä½“åºåˆ—åŒ–ä¸º YAML å­—ç¬¦ä¸²</li><li>serde_yaml::from_str(): å°† YAML å­—ç¬¦ä¸²ååºåˆ—åŒ–ä¸º Rust ç»“æ„ä½“</li></ul></li><li>actix åº“<ul><li>actix_web::get(): æ³¨å†Œä¸€ä¸ª GET è¯·æ±‚å¤„ç†å™¨</li><li>actix_web::post(): æ³¨å†Œä¸€ä¸ª POST è¯·æ±‚å¤„ç†å™¨</li><li>actix_web::web::Json<T>: è§£æè¯·æ±‚ä½“ä¸­çš„ JSON æ•°æ®</li></ul></li><li>tokio åº“<ul><li>tokio::net::TcpListener: åˆ›å»ºä¸€ä¸ª TCP ç›‘å¬å™¨</li><li>tokio::net::TcpStream: åˆ›å»ºä¸€ä¸ª TCP è¿æ¥</li><li>tokio::spawn(): åœ¨å¼‚æ­¥ä»»åŠ¡æ± ä¸­å¯åŠ¨ä¸€ä¸ªæ–°çš„å¼‚æ­¥ä»»åŠ¡</li></ul></li><li>reqwest åº“<ul><li>reqwest::get(): å‘é€ä¸€ä¸ª GET è¯·æ±‚</li><li>reqwest::post(): å‘é€ä¸€ä¸ª POST è¯·æ±‚</li><li>reqwest::Client::new(): åˆ›å»ºä¸€ä¸ª HTTP å®¢æˆ·ç«¯å¯¹è±¡</li></ul></li><li>rusoto åº“<ul><li>rusoto_s3::S3Client::new(): åˆ›å»ºä¸€ä¸ª AWS S3 å®¢æˆ·ç«¯å¯¹è±¡</li><li>rusoto_ec2::Ec2Client::new(): åˆ›å»ºä¸€ä¸ª AWS EC2 å®¢æˆ·ç«¯å¯¹è±¡</li><li>rusoto_lambda::LambdaClient::new(): åˆ›å»ºä¸€ä¸ª AWS Lambda å®¢æˆ·ç«¯å¯¹è±¡</li></ul></li><li>diesel åº“<ul><li>diesel::prelude::*: å¯¼å…¥ Diesel çš„é¢„å®šä¹‰ç±»å‹å’Œå‡½æ•°</li><li>diesel::insert_into(): æ’å…¥ä¸€æ¡æ–°çš„è®°å½•</li><li>diesel::load(): åŠ è½½ä¸€ç»„è®°å½•</li></ul></li><li>log åº“<ul><li>log::info(): è®°å½•ä¸€æ¡ä¿¡æ¯çº§åˆ«çš„æ—¥å¿—</li><li>log::error(): è®°å½•ä¸€æ¡é”™è¯¯çº§åˆ«çš„æ—¥å¿—</li><li>log::warn(): è®°å½•ä¸€æ¡è­¦å‘Šçº§åˆ«çš„æ—¥å¿—</li></ul></li><li>rand åº“<ul><li>rand::thread_rng(): åˆ›å»ºä¸€ä¸ªéšæœºæ•°ç”Ÿæˆå™¨å¯¹è±¡</li><li>rand::Rng::gen_range(): ç”Ÿæˆä¸€ä¸ªæŒ‡å®šèŒƒå›´å†…çš„éšæœºæ•°</li><li>rand::Rng::shuffle(): éšæœºæ‰“ä¹±ä¸€ä¸ªæ•°ç»„</li></ul></li><li>image åº“<ul><li>image::open(): æ‰“å¼€ä¸€ä¸ªå›¾åƒæ–‡ä»¶</li><li>image::save(): ä¿å­˜ä¸€ä¸ªå›¾åƒæ–‡ä»¶</li><li>image::DynamicImage::resize(): è°ƒæ•´å›¾åƒå°ºå¯¸å¤§å°</li></ul></li></ol>]]></content>
      
      
      <categories>
          
          <category> Rust </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Rust </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MIT 6.824 Lecture2-RPC and Threads</title>
      <link href="/2024/07/03/MIT-6.824-Lecture2-RPC-and-Threads/"/>
      <url>/2024/07/03/MIT-6.824-Lecture2-RPC-and-Threads/</url>
      
        <content type="html"><![CDATA[<h3 id="Lecture2-RPC-and-Threads"><a href="#Lecture2-RPC-and-Threads" class="headerlink" title="Lecture2-RPC and Threads"></a>Lecture2-RPC and Threads</h3><h4 id="2-1-GOè¯­è¨€"><a href="#2-1-GOè¯­è¨€" class="headerlink" title="2.1 GOè¯­è¨€"></a>2.1 GOè¯­è¨€</h4><p>â“ why we use go in this class</p><p>1ï¸âƒ£ goæä¾›ç±»è®¸å¤šä¾¿æ·çš„å·¥å…·ï¼Œå¦‚threadsã€é”ä»¥åŠçº¿ç¨‹é—´åŒæ­¥ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰RPCåŒ…ä¹Ÿååˆ†é‡è¦ã€‚</p><p>2ï¸âƒ£ goæ˜¯type safe ä»¥åŠmemory safeçš„ï¼Œå…¶åƒåœ¾å›æ”¶æœºåˆ¶ï¼ˆgarbage collectedï¼‰ååˆ†æœ‰æ•ˆ</p><p>3ï¸âƒ£ threads + GC æ˜¯ååˆ†å…·æœ‰å¸å¼•åŠ›çš„</p><h4 id="2-2-threads"><a href="#2-2-threads" class="headerlink" title="2.2 threads"></a>2.2 threads</h4><h5 id="2-2-1-ä¸ºä»€ä¹ˆè¦å…³æ³¨å¤šçº¿ç¨‹"><a href="#2-2-1-ä¸ºä»€ä¹ˆè¦å…³æ³¨å¤šçº¿ç¨‹" class="headerlink" title="2.2.1 ä¸ºä»€ä¹ˆè¦å…³æ³¨å¤šçº¿ç¨‹"></a>2.2.1 ä¸ºä»€ä¹ˆè¦å…³æ³¨å¤šçº¿ç¨‹</h5><p>ğŸ“– å¤šçº¿ç¨‹æ˜¯åœ¨æœ¬è¯¾ç¨‹ä¸­å®ç°å¹¶å‘çš„ä¸€ä¸ªé‡è¦å·¥å…·ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¹¶å‘ååˆ†æœ‰è¶£ã€‚æ¯”è¾ƒå¸¸è§çš„æƒ…å†µæ˜¯ï¼šä¸€ä¸ªç¨‹åºéœ€è¦åŒæ—¶å’Œå¤šå°è®¡ç®—æœºï¼ˆa bunch of other computersï¼‰é€šä¿¡ï¼Œå®¢æˆ·ç«¯å¯èƒ½ä¼šåŒæ—¶å’Œå¤šå°æœåŠ¡å™¨é€šä¿¡ï¼Œä¸€å°æœåŠ¡å™¨å¯èƒ½ä¼šåŒæ—¶å“åº”æ¥è‡ªä¸åŒå®¢æˆ·ç«¯çš„å¤šæ¡è¯·æ±‚ã€‚å‡å¦‚æˆ‘çš„ç¨‹åºåŒæ—¶æœ‰ 7 ä»¶ä¸åŒçš„äº‹æƒ…åœ¨è¿›è¡Œï¼Œæˆ‘æƒ³è¦ä¸€ç§ç®€å•çš„æ–¹å¼å®ç°å®ƒèƒ½åŒæ—¶åš 7 ä»¶ä¸åŒçš„äº‹æƒ…ï¼Œå¤šçº¿ç¨‹å°±èƒ½å¾ˆå¥½çš„è§£å†³å®ƒã€‚</p><p>åœ¨ Go çš„æ–‡æ¡£ä¸­ï¼Œå®ƒæŠŠçº¿ç¨‹ç§°ä¸º goroutineï¼Œgoroutine çœŸçš„å¾ˆåƒå¤§å®¶æ‰€è¯´çš„çº¿ç¨‹ã€‚</p><h5 id="2-2-2-å¦‚ä½•ç†è§£å¤šçº¿ç¨‹"><a href="#2-2-2-å¦‚ä½•ç†è§£å¤šçº¿ç¨‹" class="headerlink" title="2.2.2 å¦‚ä½•ç†è§£å¤šçº¿ç¨‹"></a>2.2.2 å¦‚ä½•ç†è§£å¤šçº¿ç¨‹</h5><p>å‡è®¾æœ‰ä¸€ä¸ªç¨‹åºï¼Œç”¨ä¸€ä¸ªå°ç›’å­è¡¨ç¤ºåœ°å€ç©ºé—´ï¼Œåœ¨è¿™ä¸ªåœ°å€ç©ºé—´é‡Œï¼Œä¸²è¡Œæ‰§è¡Œçš„ç¨‹åºï¼ˆserial programï¼‰æ˜¯æ²¡æœ‰å¤šä¸ªçº¿ç¨‹çš„ï¼Œä½ åªæœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚å®ƒåœ¨è¿™ä¸ªåœ°å€ç©ºé—´ä¸­æ‰§è¡Œä»£ç ï¼Œå®ƒåªæœ‰ä¸€ä¸ªç¨‹åºè®¡æ•°å™¨ï¼ˆPCï¼‰ï¼Œåªæœ‰ä¸€å¥—å¯„å­˜å™¨(registerï¼‰ï¼Œä¸€ä¸ªæ ˆï¼ˆstack)ï¼Œè¿™äº›ä¸œè¥¿å°±èƒ½æè¿°å½“å‰çš„æ‰§è¡ŒçŠ¶æ€ã€‚</p><p>åœ¨ä¸€ä¸ªå¤šçº¿ç¨‹ç¨‹åºä¸­ï¼Œæ¯”æ–¹è¯´ Go ç¨‹åºï¼Œä½ å¯ä»¥æ‹¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œå¦‚æœè¿™äº›çº¿ç¨‹åŒæ—¶æ‰§è¡Œï¼Œé‚£å®ƒä»¬å°±åˆ†åˆ«æœ‰ä¸€ä¸ªå±äºè‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨ï¼Œä¸€å¥—å¯„å­˜å™¨å’Œä¸€ä¸ªæ ˆï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„ä¸€å¥—çº¿ç¨‹æ§åˆ¶ï¼Œä»–ä»¬å¯ä»¥åœ¨ç¨‹åºä¸­ä¸åŒçš„éƒ¨åˆ†æ‰§è¡Œæ¯ä¸ªçº¿ç¨‹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ¯ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªæ ˆï¼Œè¿™äº›æ ˆéƒ½åœ¨ç¨‹åºä¸­çš„åŒä¸€ä¸ªåœ°å€ç©ºé—´ä¸­ï¼ŒçŸ¥é“åœ°å€çš„è¯ä¸åŒçš„çº¿ç¨‹ä¹‹é—´æ˜¯å¯ä»¥äº’ç›¸è®¿é—®ä»–ä»¬çš„æ ˆçš„ã€‚</p><p>å¤šçº¿ç¨‹çš„ä¸€ä¸ªé‡è¦ä½œç”¨å°±æ˜¯å…è®¸ç¨‹åºä¸­ä¸åŒçš„éƒ¨åˆ†éƒ½èƒ½ç‹¬ç«‹çš„æ‰§è¡Œä¸åŒçš„åŠ¨ä½œã€‚</p><p>å¹¶å‘çš„å…³é”®æ˜¯ä½ æœ‰å¤„ç†å¤šä¸ªä»»åŠ¡çš„èƒ½åŠ›ï¼Œä¸ä¸€å®šè¦åŒæ—¶ã€‚</p><p>å¹¶è¡Œçš„å…³é”®æ˜¯ä½ æœ‰åŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡çš„èƒ½åŠ›ã€‚</p><p>2.2.3 ä½¿ç”¨å¤šçº¿ç¨‹çš„åŸå› </p><p><strong>I&#x2F;O Concurrencyâ€”â€”I&#x2F;Oå¹¶å‘</strong><br>IOå¹¶å‘ï¼šä¸€ä¸ªçº¿ç¨‹æ­£åœ¨ç­‰å¾…ä»ç£ç›˜ä¸Šè¯»æ•°æ®ï¼Œå½“å®ƒåœ¨ç­‰å¾…çš„æ—¶å€™ï¼Œä½ åˆæƒ³è¦å¦ä¸€ä¸ªçº¿ç¨‹ï¼Œå¯èƒ½ç”¨æ¥åšè®¡ç®—æˆ–æ˜¯ä»æŸä¸ªç£ç›˜çš„åœ°æ–¹è¯»å–æ•°æ®æˆ–æ˜¯å‘ç½‘ç»œå‘é€ä¸€æ¡æ¶ˆæ¯å¹¶ç­‰å¾…å›å¤ï¼Œæ‰€ä»¥ IO å¹¶å‘æ˜¯ä½¿ç”¨å¤šçº¿ç¨‹çš„åœ°æ–¹ä¹‹ä¸€ã€‚</p><p>æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªç¨‹åºï¼Œå·²ç»å¯åŠ¨å¹¶ä¸”é€šè¿‡ RPC è¯·æ±‚ç½‘ç»œä¸Šä¸åŒçš„æœåŠ¡å™¨ï¼Œç„¶ååŒæ—¶åœ¨ç­‰å¾…å¤šä¸ªå›å¤ã€‚å…·ä½“åšæ³•æ˜¯ï¼Œéœ€è¦ä¸ºæ¯ä¸ª RPC è°ƒç”¨åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½ä¼šé€šè¿‡ RPC å‘é€ request æ¶ˆæ¯ï¼Œç„¶åç­‰å¾…ã€‚å½“å“åº”å›å¤æ—¶ï¼Œè¿™ä¸ªçº¿ç¨‹å°†ä¼šç»§ç»­æ‰§è¡Œï¼Œä½¿ç”¨å¤šçº¿ç¨‹å¯ä»¥è®©æˆ‘ä»¬åŒæ—¶å‘èµ·å¤šä¸ªç½‘ç»œè¯·æ±‚ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½ä¼šç­‰å¾…å›å¤ï¼Œä¹Ÿä¸æ˜¯éå¾—åœ¨åŒä¸€æ—¶é—´å»å‘è¯·æ±‚ï¼Œåªè¦å®ƒæ„¿æ„ï¼Œè¿™äº›çº¿ç¨‹æ€»å¯ä»¥åšä¸åŒçš„äº‹æƒ…ã€‚</p><p>ä¸åŒ IO å¹¶å‘æ´»åŠ¨ï¼ˆactivityï¼‰å¯èƒ½ä¼šæœ‰äº’ç›¸é‡å ï¼ˆoverlappingï¼‰çš„éƒ¨åˆ†ï¼Œä¹Ÿå…è®¸ä¸€ä¸ªæ´»åŠ¨æ­£åœ¨ç­‰å¾…ï¼Œå¦ä¸€ä¸ªæ´»åŠ¨å¯ä»¥ç»§ç»­æ‰§è¡Œ</p><p><strong>Parallelismâ€”â€”å¹¶è¡ŒåŒ–</strong><br>ä½¿ç”¨<strong>å¤šçº¿ç¨‹çš„</strong>å¦ä¸€ä¸ªé‡è¦åŸå› æ˜¯<strong>å¤šæ ¸å¹¶è¡Œ</strong>ï¼ˆmulti-core parallelismï¼‰ï¼Œæˆ‘ä»¬æƒ³é€šè¿‡çº¿ç¨‹æ¥è¾¾åˆ°å¹¶è¡ŒåŒ–çš„ç›®çš„ã€‚å¹¶è¡ŒåŒ–å°±æ˜¯å¦‚æœä½ æœ‰ä¸ªå¤šæ ¸æœºå™¨ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªè®¡ç®—ç¹é‡çš„å·¥ä½œï¼Œå®ƒéœ€è¦æ¶ˆè€—è®¸å¤š CPU æ—¶é’Ÿå‘¨æœŸï¼ˆCPU cyclesï¼‰ï¼Œè¿™æ˜¯ä¸€ä»¶ä¸å¤ªå¥½çš„äº‹æƒ…ã€‚å‡è®¾ä½ çš„ç¨‹åºèƒ½ä½¿ç”¨æœºå™¨ä¸Šæ‰€æœ‰çš„ CPU æ ¸ï¼Œæ¯”æ–¹è¯´å®ƒæ˜¯ç”¨ Go å†™çš„å¤šçº¿ç¨‹ç¨‹åºï¼Œä½ å¯åŠ¨äº†å¤šä¸ª goroutineï¼Œè¿™äº› goroutine æ‰§è¡Œä¸€äº›è®¡ç®—å¯†é›†å‹çš„ä»»åŠ¡ï¼Œæ¯”å¦‚ä¸€ç›´åœ¨é‚£æ‰§è¡Œä¸€ä¸ªå¾ªç¯ï¼Œè®¡ç®— piï¼ˆåœ†å‘¨ç‡)çš„å€¼ï¼Œç›´åˆ°è¾¾åˆ°æœºå™¨ä¸Š cpu æ ¸çš„æé™ï¼Œä½ çš„çº¿ç¨‹å°†ä¼šçœŸæ­£çš„ä»¥å¹¶è¡Œçš„æ–¹å¼è¿è¡Œã€‚<strong>å¦‚æœä½ å¯åŠ¨ 2 ä¸ªçº¿ç¨‹ä»£æ›¿ 1 ä¸ªçº¿ç¨‹ï¼Œä½ å°±èƒ½è·å¾— 2 å€çš„æ€§èƒ½ï¼Œå°±èƒ½ä½¿ç”¨ 2 å€æ•°é‡çš„ CPU æ—¶é’Ÿå‘¨æœŸ</strong></p><p>åœ¨æœ¬æ¬¡è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸ä¼šæŠŠè¿‡å¤šçš„ç²¾åŠ›æ”¾åœ¨æ­¤ç±»å¹¶è¡ŒåŒ–ä¸Šã€‚æ‰€ä»¥å¹¶è¡ŒåŒ–æ˜¯ä½¿ç”¨å¤šçº¿ç¨‹çš„ç¬¬äºŒä¸ªåŸå› </p><p><strong>Convenienceâ€”â€”æ˜“ç”¨æ€§</strong><br>æœ‰æ—¶å€™ä½ åªæ˜¯æƒ³åœ¨åå°åšä¸€äº›äº‹æƒ…ï¼Œæ¯”å¦‚ä½ å°±æƒ³å‘¨æœŸæ€§çš„å»æ‰§è¡Œå®ƒï¼Œä½†ä½ åˆä¸æ„¿æ„åœ¨ä¸»çº¿ç¨‹æ’å…¥ä¸€äº›æ£€æŸ¥ã€‚æ¯”å¦‚æœ‰ä¸€ä¸ª master æœåŠ¡éœ€è¦å‘¨æœŸæ€§çš„æ£€æŸ¥å®ƒçš„ worker æœåŠ¡æ˜¯å¦ä¸€ç›´å­˜æ´»ï¼Œå› ä¸ºè¿™äº› worker ä¹‹ä¸€å®•æœºçš„è¯ï¼Œå°±éœ€è¦æŠŠå·¥ä½œæ‰”åˆ°å¦ä¸€å°æœºå™¨ä¸Šå»æ‰§è¡Œï¼Œå°±åƒ MapReduce é‚£æ ·ã€‚ä½ å¯ä»¥æ¯ç§’ã€æ¯åˆ†é’Ÿé€šè¿‡å‘é€ä¸€æ¡â€œä½ è¿˜æ´»ç€å—ï¼Ÿâ€è¿™æ ·çš„æ¶ˆæ¯åˆ° worker æœåŠ¡ä¸Šï¼Œä½ èƒ½å¯åŠ¨ä¸€ä¸ª goroutineï¼Œç„¶åæ‰§è¡Œä¸€ä¸ªæ­»å¾ªç¯ï¼Œsleep 1 ç§’åï¼Œç„¶ååšéœ€è¦å‘¨æœŸæ‰§è¡Œçš„åŠ¨ä½œï¼Œç„¶ååˆ sleep 1 ç§’ã€‚</p><p>â“ <strong>å¼€å¯goroutineçš„å¼€é”€å¤§å—</strong></p><p>ğŸ“– è¿™ä¸ªå¼€é”€æ˜¯å€¼å¾—çš„ï¼Œè€Œä¸”è¿™ç§å¼€é”€éå¸¸å°‘ï¼Œå–å†³äºåˆ›å»ºçš„çº¿ç¨‹çš„å¤šå°‘ã€‚ä½†æ˜¯ï¼Œè¿™ç§æ–¹æ³•å¯ä»¥èŠ‚çœéå¸¸å¤šçš„æ—¶é—´</p><p>â“ <strong>ä¸ä½¿ç”¨å¤šçº¿ç¨‹å¦‚ä½•è¿½è¸ªä¸åŒæ´»åŠ¨çš„çŠ¶æ€</strong></p><p>ğŸ“– ä½¿ç”¨å¦ä¸€ç§é£æ ¼â€”â€”<strong>å¼‚æ­¥ç¼–ç¨‹</strong>ï¼ˆasynchronous programingï¼‰ï¼Œä¹Ÿç§°ä¸º<strong>äº‹ä»¶é©±åŠ¨ç¼–ç¨‹</strong>ï¼ˆevent-driven programmingï¼‰ã€‚</p><p>äº‹ä»¶é©±åŠ¨ç¼–ç¨‹çš„ä¸€èˆ¬ç»“æ„ï¼Œé€šå¸¸å®ƒæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼ŒåŒæ—¶æœ‰ä¸€ä¸ªå¾ªç¯ï¼Œè¿™ä¸ªå¾ªç¯ç­‰å¾…è¾“å…¥æˆ–è€…æ˜¯å…¶å®ƒä»»ä½•äº‹ä»¶ï¼Œè¿™äº›äº‹ä»¶èƒ½è§¦å‘ç¨‹åºç»§ç»­è¿›è¡Œï¼Œäº‹ä»¶å¯èƒ½æ˜¯ä¸€ä¸ªæ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¯èƒ½æ˜¯å®šæ—¶å™¨åˆ°æœŸã€‚å¦‚æœä½ åœ¨ç¼–å†™windows ç³»ç»Ÿç¨‹åºï¼Œä½ ç”µè„‘ä¸Šçš„è®¸å¤š windows ç³»ç»Ÿç¨‹åºéƒ½æ˜¯é€šè¿‡äº‹ä»¶é©±åŠ¨çš„é£æ ¼æ¥ç¼–å†™çš„ï¼Œå®ƒä»¬ç­‰å¾…çš„ä¸œè¥¿æ˜¯åƒé”®ç›˜å‡»é”®æˆ–è€…æ˜¯é¼ æ ‡ç§»åŠ¨è¿™æ ·çš„äº‹ä»¶ã€‚å› æ­¤ä½ å¯èƒ½ä¼šæœ‰ä¸€ä¸ªå•ä¸€çš„åªæœ‰ä¸€ä¸ªæ§åˆ¶çº¿ç¨‹çš„ç¨‹åºï¼Œè¿™ä¸ªçº¿ç¨‹æœ‰ä¸€ä¸ªå¾ªç¯ä¸€ç›´ç­‰å¾…è¾“å…¥ï¼Œæ— è®ºä½•æ—¶æœ‰è¾“å…¥è¿›æ¥ï¼Œæ¯”å¦‚æ”¶åˆ°æŠ¥æ–‡ï¼Œå®ƒèƒ½å¤Ÿæ‰¾å‡ºæ¥æ˜¯å“ªä¸ªå®¢æˆ·ç«¯å‘é€çš„è¿™ä¸ªæŠ¥æ–‡ã€‚å®ƒæœ‰ä¸€å¼ è¡¨æ ¼è®°å½•è¿™ä¸ªå®¢æˆ·ç«¯åˆ°åº•å¤„äºä»€ä¹ˆæ ·çš„æ´»åŠ¨çŠ¶æ€ã€‚</p><p><strong>ä½¿ç”¨çº¿ç¨‹çš„è¯é€šå¸¸ä¼šå˜çš„æ›´åŠ æ–¹ä¾¿</strong>ï¼Œå› ä¸ºçº¿ç¨‹èƒ½è®©ä½ æ›´å®¹æ˜“æŠŠæŠŠç¨‹åºå†™çš„è¿è´¯æœ‰åºã€‚åœ¨äº‹ä»¶é©±åŠ¨å¾ªç¯é‡Œï¼Œä½ ä¸€æ¬¡åªèƒ½æ‰§è¡Œä¸€ä¸ªæ´»åŠ¨ï¼Œè¿™ç§ç¼–ç¨‹æ¨¡å¼çš„é—®é¢˜åœ¨äºå®ƒå®ç°èµ·æ¥æœ‰ç‚¹ç—›è‹¦ï¼Œå¦ä¸€ä¸ªæ½œåœ¨çš„ç¼ºé™·åœ¨äºå½“ä½ ç”¨è¿™ç§æ–¹æ³•è·å–äº† IO å¹¶å‘åä½ å°±æ²¡æ³•åˆ©ç”¨ CPU çš„å¹¶è¡ŒåŒ–æœºåˆ¶ã€‚</p><p>æ‰€ä»¥å½“ä½ å†™ä¸€ä¸ªè´Ÿè½½å¾ˆé«˜çš„æœåŠ¡ï¼Œä½ å¾—<strong>æƒ³æ–¹è®¾æ³•</strong>æŠŠä¸€å°å¤§å‹æœºå™¨çš„ 32 æ ¸éƒ½ç”¨ä¸Šï¼Œä½¿ç”¨ä¸€ä¸ªå•ä¸€å¾ªç¯çš„è¯ï¼Œå®ƒç›¸å½“çš„ä¸è‡ªç„¶ï¼Œä¹Ÿå¾ˆéš¾è·å¾—å¤šæ ¸çš„æ€§èƒ½ã€‚å¦ä¸€æ–¹é¢ï¼Œå†’è¿™æ ·çš„é£é™©ç¼–ç¨‹é€šå¸¸æ¢æ¥çš„æ€§èƒ½æå‡ç›¸æ¯”å¤šçº¿ç¨‹æ¥è¯´å¹¶ä¸ä¼šå¤ªå¤šã€‚</p><p>è€Œä¸”çº¿ç¨‹ç›¸å¯¹æ¥è¯´ä¹Ÿå¾ˆå»‰ä»·ï¼Œ<strong>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªæ ˆ</strong>ï¼Œæ ˆé€šå¸¸æ˜¯ 1kb æˆ–æ•°åƒå­—èŠ‚ï¼Œå¦‚æœä½ æœ‰ 20 ä¸ªçº¿ç¨‹ï¼Œè¿™äº›æ¶ˆè€—æ ¹æœ¬ä¸ç”¨åœ¨æ„ã€‚ä½†æ˜¯ä½ è‹¥æœ‰ 100 ä¸‡ä¸ªçº¿ç¨‹ï¼Œé‚£å®ƒå°±ä¼šæ¶ˆè€—å¤§é‡çš„å†…å­˜ã€‚</p><p>å¦å¤–ï¼Œçº¿ç¨‹è°ƒåº¦ï¼Œå®ƒæ˜¯æŒ‡ä¸‹ä¸€æ­¥åº”è¯¥é€‰æ‹©å“ªä¸ªçº¿ç¨‹è¿è¡Œï¼Œé€šå¸¸æœ‰ä¸€ä¸ªè°ƒåº¦åˆ—è¡¨ï¼Œä¸Šé¢è®°å½•äº† 1000 ä¸ªçº¿ç¨‹ï¼Œè¿™æ—¶å€™åˆ‡æ¢çº¿ç¨‹æ‰§è¡Œå°†ä»˜å‡ºç›¸å½“æ˜‚è´µçš„ä»£ä»·ã€‚</p><p>æ‰€ä»¥ï¼Œå½“ä½ åªæœ‰ä¸€ä¸ªæœåŠ¡å™¨çš„æ—¶å€™ï¼Œä½ çš„æœåŠ¡å™¨éœ€è¦ä¸º 100 ä¸‡ä¸ªå®¢æˆ·ç«¯æä¾›æœåŠ¡ï¼Œä½ éœ€è¦ä¸ºè¿™ 100 ä¸‡ä¸ªå®¢æˆ·ç«¯è®°å½•ä¸€äº›çŠ¶æ€ï¼Œè¿™ä¸ªä»£ä»·è¿˜æ˜¯æŒºé«˜çš„ã€‚å¦‚æœä½¿ç”¨äº‹ä»¶é©±åŠ¨ç¼–ç¨‹ï¼ŒèŠ±ç‚¹æ—¶é—´çš„è¯ï¼Œåº”è¯¥å®¹æ˜“å†™ä¸€ä¸ªç®€å•çš„è€Œåˆäº”è„ä¿±å…¨é«˜æ€§èƒ½çš„æœåŠ¡ï¼Œå°±æ˜¯ä½ éœ€è¦å¤šåšç‚¹å·¥ä½œã€‚</p><p>[(288æ¡æ¶ˆæ¯) è§£è¯»I&#x2F;Oå¤šè·¯å¤ç”¨åŠå…¶æŠ€æœ¯ï¼Œè®©ä½ å½»åº•äº†è§£I&#x2F;Oå¤šè·¯å¤ç”¨(å†…å«å›¾å½¢è®²è§£)ã€å»ºè®®æ–°æ‰‹æ”¶è—ã€‘_Linuxæƒ…æŠ¥ç«™çš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/m0_50662680/article/details/111273308?ops_request_misc=%7B%22request_id%22:%22166315159916782390556461%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=166315159916782390556461&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~pc_rank_34-1-111273308-null-null.142%5Ev47%5Epc_rank_34_ctr25,201%5Ev3%5Eadd_ask&utm_term=%E5%BC%82%E6%AD%A5">https://blog.csdn.net/m0_50662680/article/details/111273308?ops_request_misc=%7B%22request%5Fid%22%3A%22166315159916782390556461%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D&amp;request_id=166315159916782390556461&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~pc_rank_34-1-111273308-null-null.142^v47^pc_rank_34_ctr25,201^v3^add_ask&amp;utm_term=å¼‚æ­¥</a> å¤šè·¯å¤ç”¨ å›¾è§£&amp;spm&#x3D;1018.2226.3001.4187)</p><p>â“ <strong>å¤šçº¿ç¨‹(threads)å’Œå¤šè¿›ç¨‹(processes)çš„åŒºåˆ«</strong></p><p>ğŸ“– é€šå¸¸ï¼Œå¯¹äºç±» UNIX ç³»ç»Ÿçš„æœºå™¨æ¥è¯´ï¼Œä¸€ä¸ªè¿›ç¨‹å°±<strong>æ˜¯ä¸€ä¸ªå•ç‹¬è¿è¡Œçš„ç¨‹åºï¼Œåªæœ‰ä¸€ä¸ªåœ°å€ç©ºé—´</strong>ï¼Œ<strong>ä¸€å¤§ç‰‡å¯ä¾›è¿›ç¨‹ä½¿ç”¨çš„å†…å­˜</strong>ï¼Œåœ¨è¿™ä¸ªè¿›ç¨‹é‡Œä½ å¯èƒ½åŒæ—¶ä¼šæœ‰å¥½å¤šä¸ªçº¿ç¨‹ã€‚å½“ä½ å‡†å¤‡å¥½ä¸€ä¸ª go ç¨‹åºå¹¶è¿è¡Œï¼Œå°†ä¼šåˆ›å»ºä¸€ä¸ª unix è¿›ç¨‹å’Œä¸€å—å†…å­˜åŒºï¼Œ<strong>å½“ä½ çš„ Go è¿›ç¨‹åˆ›å»º goroutine æ—¶ï¼Œå®ƒä»¬å®é™…ä¸Šéƒ½æ˜¯åœ¨åŒä¸€ä¸ªè¿›ç¨‹é‡Œ</strong>çš„ã€‚</p><p>å®é™…ä¸Šè¿™ä¹Ÿå–å†³äºæ“ä½œç³»ç»Ÿçš„å®ç°ï¼Œç¡®å®æœ‰ä¸ªåˆ«æˆ–ä¸€äº›æ“ä½œç³»ç»Ÿï¼Œå¹¶ä¸å…³å¿ƒä½ çš„è¿›ç¨‹å†…éƒ¨åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆäº‹æƒ…ï¼Œä¹Ÿä¸å…³å¿ƒä½ ä½¿ç”¨ä»€ä¹ˆè¯­è¨€ï¼Œä¸å…³å¿ƒæ“ä½œç³»ç»Ÿå†…éƒ¨çš„ä¸šåŠ¡é€»è¾‘ï¼Œåœ¨è¿›ç¨‹å†…éƒ¨èƒ½è¿è¡Œå¤šä¸ªçº¿ç¨‹å°±è¡Œäº†ã€‚</p><p>å¦‚æœåœ¨ä½ çš„æœºå™¨ä¸Šè¿è¡Œäº†ä¸æ­¢ä¸€ä¸ªè¿›ç¨‹ï¼Œæ¯”å¦‚ä¸€ä¸ªç¼–è¾‘å™¨æˆ–æ˜¯ç¼–è¯‘å™¨ï¼Œæ“ä½œç³»ç»Ÿéœ€è¦è®©å®ƒä»¬å½¼æ­¤åˆ†å¼€ï¼Œ<strong>ä½ çš„ç¼–è¾‘å™¨å’Œä½ çš„ç¼–è¯‘å™¨éƒ½æœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´ï¼Œä»–ä»¬ä¹‹é—´æ— æ³•çœ‹åˆ°å½¼æ­¤çš„å†…å­˜ï¼Œä¸åŒçš„è¿›ç¨‹ä¹‹é—´ä¸ä¼šæœ‰äº¤é›†</strong>ã€‚ä½ çš„ç¼–è¾‘å™¨å¯èƒ½æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œä½ çš„ç¼–è¯‘å™¨ä¹Ÿå¯èƒ½æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œä½†æ˜¯ä»–ä»¬éƒ½å¤„äºå„è‡ªçš„ä¸–ç•Œ<strong>ã€‚ä½†æ˜¯</strong>åœ¨åŒä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œçº¿ç¨‹ä¸çº¿ç¨‹ä¹‹é—´å¯ä»¥å…±äº«å†…å­˜ï¼Œå¯ä»¥ä½¿ç”¨ channel(Goè¯­è¨€ä¸­çš„æ¦‚å¿µ) è¿›è¡ŒåŒæ­¥ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ mutex ç­‰ã€‚ä½†è¿›ç¨‹ä¹‹é—´æ˜¯æ²¡æœ‰äº¤é›†çš„ï¼Œè¿™ç±»è½¯ä»¶çš„ä¼ ç»Ÿç»“æ„å°±æ˜¯è¿™æ ·ã€‚</p><p>â“ <strong>å½“ä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶ï¼Œæ˜¯æ‰€æœ‰çº¿ç¨‹éƒ½åœ¨åˆ‡æ¢å—</strong>(when a context switch happens does it happened for all threads)</p><p>ä½ åªæœ‰ä¸€ä¸ªå•æ ¸æœºå™¨ï¼Œè¿™æ„å‘³ç€åœ¨åŒä¸€ä¸ªæ—¶åˆ»ä½ åªèƒ½åšä¸€ä»¶äº‹æƒ…ã€‚ä½ æ‰“ç®—åœ¨ä½ çš„æœºå™¨ä¸Šè¿è¡Œå¤šè¿›ç¨‹ï¼Œæ“ä½œç³»ç»ŸæŠŠ CPU æ—¶é—´ç‰‡åå¤çš„åˆ†é…ç»™è¿™ä¸¤ä¸ªç¨‹åºï¼Œå½“ç¡¬ä»¶æ—¶é’Ÿåˆ°æœŸæ—¶ï¼Œæ“ä½œç³»ç»Ÿå°±åˆ¤æ–­æ˜¯æ—¶å€™æŠŠ CPU ä»å½“å‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹å‰¥å¤ºï¼Œç„¶åæŠŠ CPU åˆ†é…ç»™å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œè¿™ä»¶äº‹ä»¶æ˜¯åœ¨è¿›ç¨‹çº§åˆ«ä¸Šåšçš„ã€‚</p><p>æˆ‘ä»¬<strong>ä½¿ç”¨çš„çº¿ç¨‹</strong>æœ€ç»ˆ<strong>æ˜¯ç”±æ˜¯æ“ä½œç³»ç»Ÿçº¿ç¨‹æ‰€æä¾›çš„</strong>ï¼Œå½“<strong>æ“ä½œç³»ç»Ÿä¸Šä¸‹æ–‡åˆ‡æ¢æ—¶ï¼Œå°±æ˜¯ä¸åŒçš„çº¿ç¨‹ä¹‹é—´äº§ç”Ÿåˆ‡æ¢</strong>æ—¶ï¼Œæ“ä½œç³»ç»Ÿæ˜¯çŸ¥é“è¿™ä¸€åˆ‡çš„ï¼Œæ‰€ä»¥æ“ä½œç³»ç»Ÿå¯èƒ½ä¼šæ¸…æ¥šè¿™å„¿æœ‰ä¸¤ä¸ªçº¿ç¨‹åœ¨è¿™ä¸ªè¿›ç¨‹ä¸­ï¼Œæœ‰ä¸‰ä¸ªçº¿ç¨‹åœ¨é‚£ä¸ªè¿›ç¨‹ï¼Œå½“æ—¶é’Ÿåˆ°æœŸæ—¶æ“ä½œç³»ç»Ÿä¼šåŸºäºä¸€äº›è°ƒåº¦ç®—æ³•é€‰æ‹©ä¸€ä¸ªä¸åŒçš„çº¿ç¨‹æ¥è¿è¡Œã€‚åœ¨è¿™ä¸ªè¿›ç¨‹ä¸­çš„çº¿ç¨‹å’Œå¦ä¸€è¿›ç¨‹ä¸­çš„çº¿ç¨‹å¯èƒ½æ˜¯ä¸åŒçš„ï¼Œå¦å¤–ï¼Œ<strong>Go ä¼šèªæ˜å¤ç”¨ä¸€ä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹ï¼Œåœ¨ä¸Šé¢è¿è¡Œå°½å¯èƒ½å¤šçš„ goroutine ä»¥èŠ‚çœå¼€æ”¯</strong>ï¼Œæ‰€ä»¥è¿™å¯èƒ½éœ€è¦ä¸¤ä¸ªé˜¶æ®µå»è°ƒåº¦ã€‚</p><p>é¦–å…ˆæ“ä½œç³»ç»Ÿé€‰æ‹©ä¸€ä¸ªçº¿ç¨‹å»è¿è¡Œï¼Œç„¶ååœ¨è¿™ä¸ªè¿›ç¨‹ä¸­ï¼ŒGo ä¼šå†å»é€‰æ‹©å“ªä¸ª goroutine å»è¿è¡Œã€‚</p><h5 id="2-2-4-sharing-memoryâ€”â€”å…±äº«å†…å­˜"><a href="#2-2-4-sharing-memoryâ€”â€”å…±äº«å†…å­˜" class="headerlink" title="2.2.4 sharing memoryâ€”â€”å…±äº«å†…å­˜"></a>2.2.4 <strong>sharing memoryâ€”â€”å…±äº«å†…å­˜</strong></h5><p>äº‹å®ä¸Šå†™å¤šçº¿ç¨‹ç¨‹åºæ˜¯æœ‰äº›æŒ‘æˆ˜çš„ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯<strong>å…±äº«æ•°æ®</strong>ï¼Œå…³äºçº¿ç¨‹æ¨¡å‹ï¼Œé…·çš„åœ°æ–¹åœ¨äºè¿™äº›<strong>çº¿ç¨‹å…±äº«åœ°å€ç©ºé—´</strong>ï¼Œ<strong>å…±äº«å†…å­˜</strong>ï¼Œå¦‚æœæŸä¸ªçº¿ç¨‹åœ¨å†…å­˜ä¸­åˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨å…¶å®ƒçº¿ç¨‹ä¸­ä½ ä¹Ÿèƒ½ä½¿ç”¨å®ƒã€‚ä½ å¯ä»¥åˆ›å»ºä¸ªæ•°ç»„æˆ–æ˜¯åˆ«çš„ä»€ä¹ˆä¸œè¥¿ï¼Œæ‰€æœ‰ä¸åŒçš„çº¿ç¨‹éƒ½èƒ½è¯»å†™ã€‚è¿™å°±å­˜åœ¨ä¸€äº›ä¸´ç•Œæƒ…å†µï¼Œå¦‚æœä½ æŒæœ‰ä¸€äº›ä½ å…³æ³¨çš„çŠ¶æ€ï¼Œå¯èƒ½ä½ ä¼šç¼“å­˜ä¸€äº›æ•°æ®ï¼šä½ çš„ serverï¼Œä½ çš„ç¼“å­˜ï¼Œä½ çš„å†…å­˜ã€‚å½“å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹æ­£å¤„ç†ä¸€ä¸ªå®¢æˆ·ç«¯çš„è¯·æ±‚çš„æ—¶å€™ï¼Œé¦–å…ˆå®ƒä¼šå…ˆæŸ¥ä¸€ä¸‹ç¼“å­˜ä¸­çš„æ•°æ®ï¼Œä½†æ˜¯è¿™ä¸ªå…±äº«ç¼“å­˜ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½èƒ½è¯»ã€‚å½“çº¿ç¨‹é‡Œæœ‰æ–°çš„ä¿¡æ¯æ—¶ï¼Œçº¿ç¨‹å¯èƒ½ä¼šå‘ç¼“å­˜é‡Œå†™å…¥æ•°æ®è¿›è¡Œæ›´æ–°ã€‚</p><p>ä½†æ˜¯äº‹å®ä¹Ÿè¡¨æ˜å¦‚æœä½ ä¸å…³å¿ƒå¤šçº¿ç¨‹ä¹‹é—´å…±äº«å†…å­˜çš„è¯ï¼Œå¾ˆå®¹æ˜“å‡ºç°bugã€‚</p><p>é—®é¢˜ä¸¾ä¾‹<br>å‡è®¾ä½ æœ‰ä¸€ä¸ªå…¨å±€å˜é‡ N åœ¨ä¸åŒçš„çº¿ç¨‹ä¹‹é—´å…±äº«ï¼Œå…¶ä¸­ä¸€ä¸ªçº¿ç¨‹åªæ˜¯å¯¹ N åšè‡ªå¢ï¼Œè¿™å¯èƒ½å°±æ˜¯é€ æˆ bug çš„åŸå› ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">n=n+1</span><br></pre></td></tr></table></figure><p>åœ¨åŒä¸€æ—¶åˆ»ï¼Œæ€»æœ‰å…¶å®ƒçš„çº¿ç¨‹å¯èƒ½ä¹Ÿæ­£åœ¨æŸ¥çœ‹ï¼Œæ‰€ä»¥è¿™é‡Œæœ‰ä¸ªå¾ˆæ˜æ˜¾çš„é—®é¢˜ã€‚<strong>çº¿ç¨‹ 1 æ­£åœ¨æ‰§è¡Œ</strong>ï¼Œä½†æ˜¯å¦ä¸€ä¸ª<strong>ä¸åŒçš„çº¿ç¨‹ 2</strong> ä¹Ÿåœ¨æ‰§è¡Œç›¸åŒçš„ä»£ç ï¼Œ N æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬è¯´çš„è¿™ä¸ª N éƒ½æ˜¯åŒä¸€ä¸ª Nã€‚</p><p>å®é™…ä¸Šæœºå™¨è¿è¡Œçš„å¹¶ä¸æ˜¯è¿™æ ·çš„ä»£ç ï¼Œè€Œæ˜¯ç”±ç¼–è¯‘å™¨åå‡ºæ¥çš„æœºå™¨ç ï¼ˆmachine codeï¼‰ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LD  X , register1</span><br><span class="line">ADD 1 , register1</span><br><span class="line">STORE register1 , X</span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥å‡è®¾æ‰€æœ‰çš„çº¿ç¨‹éƒ½åœ¨æ‰§è¡Œè¿™è¡Œä»£ç ï¼Œä»–ä»¬éƒ½ä¼šæ‰§è¡ŒåŠ è½½ x åˆ°å¯„å­˜å™¨ï¼Œx ä» 0 å¼€å§‹æœ‰æ•ˆï¼Œè¿™æ„å‘³ç€ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½æŠŠ 0 è¯»å…¥å¯„å­˜å™¨ï¼Œç„¶åä»–ä»¬éƒ½ç»™å¯„å­˜å™¨åŠ  1ï¼Œè¿™æ ·æ‰€æœ‰çº¿ç¨‹å„æœ‰è‡ªçš„å¯„å­˜å™¨çš„å€¼æ˜¯ 1ï¼Œæœ€åå†æŠŠå¯„å­˜å™¨çš„å€¼ 1 é‡æ–°ä¿å­˜åˆ°å†…å­˜é‡Œï¼Œç°åœ¨ï¼Œè¿™ä¸¤ä¸ªçº¿ç¨‹å¯¹ N åšè‡ªå¢åï¼Œç»“æœéƒ½æ˜¯ 1ï¼Œä½†æ˜¯ç¢°å·§è¿™æ ·å†™å¹¶ä¸æ­£ç¡®ï¼Œç¢°å·§ç¨‹åºæƒ³è¦çš„ç»“æœä¸æ˜¯ 1ã€‚</p><p>â“ <strong>æŒ‡ä»¤çš„åŸå­æ€§</strong></p><p>è¿™äº›ç‹¬ç«‹çš„æŒ‡ä»¤æ˜¯ä¸æ˜¯åŸå­çš„ï¼ˆatomicï¼‰ï¼Œç­”æ¡ˆæ˜¯æœ‰äº›æ˜¯ï¼Œæœ‰äº›ä¸æ˜¯ï¼Œå¯¹äº <strong>32 ä½çš„ store æŒ‡ä»¤å®ƒææœ‰å¯èƒ½æ˜¯åŸå­çš„</strong>ï¼Œä»æŸç§æ„ä¹‰ä¸Šæ¥è¯´ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªå¤„ç†å™¨ï¼Œæœ€ç»ˆè¦ä¹ˆæ˜¯å…¶ä¸­ä¸€ä¸ªå¤„ç†å™¨ä¸Šçš„ 32 ä½å€¼ï¼Œè¦ä¹ˆæ˜¯å¦ä¸€ä¸ªå¤„ç†å™¨ä¸Šçš„ 32 ä½å€¼ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ··åˆçš„å€¼ã€‚å…¶å®ƒå°ºå¯¸å¤§å°çš„æœªå¿…å°±è¿™ä¹ˆç®€å•ï¼Œæ¯”å¦‚ä¸€ä¸ªå­—èŠ‚çš„å­˜å‚¨è¿™ä¾èµ–äºä½ æ‰€ä½¿ç”¨çš„ CPUã€‚è¿™ä¾èµ–äºå¤„ç†å™¨å’Œæ›´å¤æ‚çš„æŒ‡ä»¤ã€‚</p><p>æ¯”å¦‚å¾®å¤„ç†å™¨ä¸Šçš„è‡ªå¢æŒ‡ä»¤ï¼Œå®ƒèƒ½ç›´æ¥ç»™å†…å­˜ä¸ŠæŸä¸ªåœ°å€çš„å€¼åŠ  1ï¼Œæœªå¿…å°±æ˜¯åŸå­çš„ï¼Œå°½ç®¡è¿™äº›æŒ‡ä»¤å­˜åœ¨åŸå­ç‰ˆæœ¬çš„ã€‚</p><p>æ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªéå¸¸ç»å…¸çš„é”™è¯¯ï¼Œé€šå¸¸æˆ‘ä»¬å«ä»–<strong>â€œç«äº‰â€ï¼ˆraceï¼‰</strong>ï¼Œåé¢æˆ‘æ‰“ç®—ä¼šå¤šæ¬¡æèµ·ã€‚ç§°ä¸º race æ˜¯å› ä¸ºå¦‚æœä¸€ä¸ª CPU å·²ç»å¼€å§‹æ‰§è¡Œè¿™æ®µä»£ç ï¼Œå¦ä¸€äº›çº¿ç¨‹æ­£åœ¨ç»“æŸè¿™æ®µä»£ç ï¼Œè¿™å°±æ˜¯ raceï¼Œç¬¬ä¸€ä¸ªå¤„ç†å™¨èƒ½å¤Ÿåœ¨ç¬¬äºŒä¸ªå¤„ç†å™¨å¼€å§‹æ‰§è¡Œ load å‰æ‰§è¡Œ storeï¼Œå¦‚æœç¬¬ä¸€ä¸ªå¤„ç†å™¨çš„ store(å¯„å­˜å™¨ä¸­çš„æ•°æ®å­˜å…¥å†…å­˜)ç¡®å®æ˜¯åœ¨ç¬¬äºŒä¸ªå¤„ç†å™¨ load ï¼ˆå†…å­˜æ”¾å…¥å¯„å­˜å™¨ï¼‰ä¹‹å‰ï¼Œé‚£ä¹ˆç¬¬äºŒä¸ªå¤„ç†å™¨å°±èƒ½çœ‹åˆ°ç¬¬ä¸€ä¸ªå¤„ç†å™¨å­˜å‚¨çš„å€¼ï¼Œç¬¬äºŒä¸ªå¤„ç†å™¨å°† load å€¼ 1ï¼Œç„¶åå†åŠ  1ï¼Œå†æŠŠ 2 å­˜å…¥ã€‚</p><p>è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹å¼å¾ˆç®€å•ï¼ŒåŠ ä¸ªé”å°±è¡Œäº†ï¼Œåªæœ‰åœ¨æŒæœ‰é”çš„æ—¶å€™ï¼Œè¿™ä¸ªå…±äº«æ•°æ®æ‰èƒ½è¢«ä½¿ç”¨ï¼ŒGo è°ƒç”¨ Lock æ¥é”ä½ mutexï¼Œä½ èƒ½çœ‹åˆ° mu.Lock()åŠ åœ¨è¿™ä¸€æ®µä½¿ç”¨å…±äº«æ•°æ®çš„ä»£ç å‰é¢ï¼Œç„¶ååœ¨ç»“æŸçš„åœ°æ–¹è°ƒç”¨ mu.Unlock()ã€‚æ— è®ºå“ªä¸ªçº¿ç¨‹æ‰§è¡Œåˆ°è¿™é‡Œï¼Œåªæœ‰è¶³å¤Ÿå¹¸è¿çš„é‚£ä¸ªçº¿ç¨‹æ‰èƒ½ç¬¬ä¸€ä¸ªæŠ¢åˆ°é”ï¼Œç„¶åæ‰§è¡Œæ‰€æœ‰è¿™äº›ä»£ç ï¼Œåœ¨ç»“æŸä¹‹å‰ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹éƒ½ä¸èƒ½ç»§ç»­ï¼Œä½ å¯ä»¥è€ƒè™‘æŠŠè¿™äº›åœ¨é”ä¸­é—´çš„ä»£ç å°è£…èµ·æ¥ã€‚</p><p>â“ <strong>Goæ˜¯å¦‚ä½•çŸ¥é“æˆ‘ä»¬æ­£åœ¨é”ä½å“ªäº›å˜é‡</strong></p><p>ç­”æ¡ˆæ˜¯ go å¹¶ä¸çŸ¥é“ï¼Œåœ¨è¿™ä¸ªé”é‡Œçš„ä»»ä½•ä½ç½®ä»–ä»¬ä¸€ç‚¹å…³è”éƒ½æ²¡æœ‰ã€‚æ‰€ä»¥ï¼Œè¿™é‡Œæ–°çš„ä¸œè¥¿æ˜¯è¿™ä¸ªå˜é‡(mu)ï¼Œå®ƒæ˜¯ä¸ª mutexï¼Œåœ¨ lock å’Œä»»ä½•å˜é‡ä¹‹é—´ä»–ä»¬å¹¶æ²¡æœ‰ä»€ä¹ˆå…³è”ã€‚</p><h5 id="2-2-5-Coordinationâ€”â€”åä½œ"><a href="#2-2-5-Coordinationâ€”â€”åä½œ" class="headerlink" title="2.2.5 Coordinationâ€”â€”åä½œ"></a><strong>2.2.5 Coordinationâ€”â€”åä½œ</strong></h5><p>åä½œä¸æŒ‡å¯¼çº¿ç¨‹è¿ä½œæœ‰å…³ï¼Œå½“æˆ‘ä»¬æ­£åœ¨æ‰§è¡Œæ¶‰åŠåˆ°å¤šçº¿ç¨‹æƒ…å†µä¸‹çš„åŠ é”æ—¶ï¼Œå¯èƒ½å¹¶ä¸çŸ¥é“å…¶å®ƒçº¿ç¨‹ä¹Ÿåœ¨åŠ é”ï¼Œä»–ä»¬åªæ˜¯æƒ³åœ¨æ²¡æœ‰äººå¹²æ¶‰çš„æƒ…å†µä¸‹æ‹¿åˆ°æ•°æ®ã€‚ä½†ä¹Ÿæœ‰ä¸€äº›æƒ…å†µä½ ç¡®å®å°±æ˜¯æ•…æ„çš„æƒ³è®©ä¸åŒçš„çº¿ç¨‹ä¹‹é—´äº’ç›¸å—åˆ°åˆ¶çº¦ï¼Œæ¯”å¦‚ä½ ç”Ÿäº§æŸäº›æ•°æ®ï¼Œä½†æ˜¯ä½ åˆå’Œæˆ‘ä¸æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ï¼Œæˆ‘æƒ³åœ¨ä½ ç”Ÿäº§å®Œæ•°æ®å‰ä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°ä½ å®Œæˆåï¼Œæˆ‘å†å»è¯»å–ã€‚æˆ–è€…æ˜¯ä½ å¯åŠ¨äº†ä¸€å †çº¿ç¨‹å»æŠ“å– web é¡µé¢ï¼Œç„¶åéœ€è¦ç­‰å¾…æ‰€æœ‰çº¿ç¨‹éƒ½æ‰§è¡Œç»“æŸã€‚</p><p>æ‰€ä»¥å½“æˆ‘ä»¬æƒ³<strong>ç‰¹æ„çš„äº’ç›¸ç­‰å¾…çš„æ—¶å€™ï¼Œè¿™ç§æƒ…å†µé€šå¸¸å°±ç§°ä¸º coordination (åä½œ)ã€‚</strong>Go ä¸­æœ‰å¾ˆå¤šæŠ€æœ¯å¯ä»¥åšåˆ°ï¼Œæ¯”å¦‚ channel (é€šé“)ï¼Œchannel æ˜¯ä¸€ç§ç”¨äºå‘æ•°æ®ä»è¿™ä¸ªçº¿ç¨‹åˆ°å¦ä¸€ä¸ªçº¿ç¨‹çš„å·¥å…·ã€‚</p><p>ä¹Ÿæœ‰ä¸€äº›å…¶å®ƒå·¥å…·ç”¨äºç‰¹æ®Šçš„ç›®çš„ï¼Œæ¯”å¦‚æœ‰ä¸ªä¸œè¥¿å« condition variables (æ¡ä»¶å˜é‡)ï¼Œè¿˜æœ‰WaitGroupã€‚</p><h5 id="2-2-6-Deadlockâ€”â€”æ­»é”"><a href="#2-2-6-Deadlockâ€”â€”æ­»é”" class="headerlink" title="2.2.6 Deadlockâ€”â€”æ­»é”"></a><strong>2.2.6 Deadlockâ€”â€”æ­»é”</strong></h5><p>æ­»é”Deadlockï¼šè®¡ç®—æœºç³»ç»Ÿä¸­å¤šé“ç¨‹åºå¹¶å‘æ‰§è¡Œæ—¶ï¼Œä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹ç”±äºç«äº‰èµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡ï¼ˆåƒµå±€ï¼‰ï¼Œå¦‚æ— å¤–åŠ›ä½œç”¨ï¼Œè¿™äº›è¿›ç¨‹å°†æ°¸è¿œä¸èƒ½å†å‘å‰æ¨è¿›ã€‚</p><p>å››ä¸ªæ¡ä»¶åŒæ—¶å‡ºç°ï¼Œæ­»é”å°†ä¼šå‘ç”Ÿ</p><p>1ï¸âƒ£ Mutual exclusionäº’æ–¥ï¼šä¸€æ¬¡åªæœ‰ä¸€ä¸ªè¿›ç¨‹å¯ä»¥ä½¿ç”¨ä¸€ä¸ªèµ„æº</p><p>2ï¸âƒ£ Hold and waitå æœ‰å¹¶ç­‰å¾…ï¼šä¸€ä¸ªè¿›ç¨‹åº”è¯¥å æœ‰è‡³å°‘ä¸€ä¸ªèµ„æºï¼Œå¹¶ç­‰å¾…å¦ä¸€ä¸ªèµ„æºï¼Œè€Œè¯¥èµ„æºè¢«å¦ä¸€ä¸ªè¿›ç¨‹æ‰€å æœ‰</p><p>3ï¸âƒ£ No preemptionä¸å¯æŠ¢å ï¼šä¸€ä¸ªèµ„æºåªæœ‰å½“æŒæœ‰å®ƒçš„è¿›ç¨‹å®Œæˆä»»åŠ¡åè‡ªç”±çš„é‡Šæ”¾</p><p>4ï¸âƒ£ Circular waitå¾ªç¯ç­‰å¾…ï¼šç­‰å¾…èµ„æºçš„è¿›ç¨‹ä¹‹é—´å­˜åœ¨ç¯</p><h5 id="2-2-7-Webçˆ¬è™«"><a href="#2-2-7-Webçˆ¬è™«" class="headerlink" title="2.2.7 Webçˆ¬è™«"></a>2.2.7 Webçˆ¬è™«</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;fmt&quot;</span><br><span class="line">&quot;sync&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line">// Several solutions to the crawler exercise from the Go tutorial</span><br><span class="line">// https://tour.golang.org/concurrency/10</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line">// Serial crawler</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">func Serial(url string, fetcher Fetcher, fetched map[string]bool) &#123;</span><br><span class="line">if fetched[url] &#123;</span><br><span class="line">return</span><br><span class="line">&#125;</span><br><span class="line">fetched[url] = true</span><br><span class="line">urls, err := fetcher.Fetch(url)</span><br><span class="line">if err != nil &#123;</span><br><span class="line">return</span><br><span class="line">&#125;</span><br><span class="line">for _, u := range urls &#123;</span><br><span class="line">Serial(u, fetcher, fetched)</span><br><span class="line">&#125;</span><br><span class="line">return</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line">// Concurrent crawler with shared state and Mutex</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">type fetchState struct &#123;</span><br><span class="line">mu      sync.Mutex</span><br><span class="line">fetched map[string]bool</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func ConcurrentMutex(url string, fetcher Fetcher, f *fetchState) &#123;</span><br><span class="line">f.mu.Lock()</span><br><span class="line">already := f.fetched[url]</span><br><span class="line">f.fetched[url] = true</span><br><span class="line">f.mu.Unlock()</span><br><span class="line"></span><br><span class="line">if already &#123;</span><br><span class="line">return</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">urls, err := fetcher.Fetch(url)</span><br><span class="line">if err != nil &#123;</span><br><span class="line">return</span><br><span class="line">&#125;</span><br><span class="line">var done sync.WaitGroup</span><br><span class="line">for _, u := range urls &#123;</span><br><span class="line">done.Add(1)</span><br><span class="line">    u2 := u</span><br><span class="line">go func() &#123;</span><br><span class="line">defer done.Done()</span><br><span class="line">ConcurrentMutex(u2, fetcher, f)</span><br><span class="line">&#125;()</span><br><span class="line">//go func(u string) &#123;</span><br><span class="line">//defer done.Done()</span><br><span class="line">//ConcurrentMutex(u, fetcher, f)</span><br><span class="line">//&#125;(u)</span><br><span class="line">&#125;</span><br><span class="line">done.Wait()</span><br><span class="line">return</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func makeState() *fetchState &#123;</span><br><span class="line">f := &amp;fetchState&#123;&#125;</span><br><span class="line">f.fetched = make(map[string]bool)</span><br><span class="line">return f</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line">// Concurrent crawler with channels</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">func worker(url string, ch chan []string, fetcher Fetcher) &#123;</span><br><span class="line">urls, err := fetcher.Fetch(url)</span><br><span class="line">if err != nil &#123;</span><br><span class="line">ch &lt;- []string&#123;&#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">ch &lt;- urls</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func master(ch chan []string, fetcher Fetcher) &#123;</span><br><span class="line">n := 1</span><br><span class="line">fetched := make(map[string]bool)</span><br><span class="line">for urls := range ch &#123;</span><br><span class="line">for _, u := range urls &#123;</span><br><span class="line">if fetched[u] == false &#123;</span><br><span class="line">fetched[u] = true</span><br><span class="line">n += 1</span><br><span class="line">go worker(u, ch, fetcher)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">n -= 1</span><br><span class="line">if n == 0 &#123;</span><br><span class="line">break</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func ConcurrentChannel(url string, fetcher Fetcher) &#123;</span><br><span class="line">ch := make(chan []string)</span><br><span class="line">go func() &#123;</span><br><span class="line">ch &lt;- []string&#123;url&#125;</span><br><span class="line">&#125;()</span><br><span class="line">master(ch, fetcher)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line">// main</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">fmt.Printf(&quot;=== Serial===\n&quot;)</span><br><span class="line">Serial(&quot;http://golang.org/&quot;, fetcher, make(map[string]bool))</span><br><span class="line"></span><br><span class="line">fmt.Printf(&quot;=== ConcurrentMutex ===\n&quot;)</span><br><span class="line">ConcurrentMutex(&quot;http://golang.org/&quot;, fetcher, makeState())</span><br><span class="line"></span><br><span class="line">fmt.Printf(&quot;=== ConcurrentChannel ===\n&quot;)</span><br><span class="line">ConcurrentChannel(&quot;http://golang.org/&quot;, fetcher)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line">// Fetcher</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">type Fetcher interface &#123;</span><br><span class="line">// Fetch returns a slice of URLs found on the page.</span><br><span class="line">Fetch(url string) (urls []string, err error)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// fakeFetcher is Fetcher that returns canned results.</span><br><span class="line">type fakeFetcher map[string]*fakeResult</span><br><span class="line"></span><br><span class="line">type fakeResult struct &#123;</span><br><span class="line">body string</span><br><span class="line">urls []string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (f fakeFetcher) Fetch(url string) ([]string, error) &#123;</span><br><span class="line">if res, ok := f[url]; ok &#123;</span><br><span class="line">fmt.Printf(&quot;found:   %s\n&quot;, url)</span><br><span class="line">return res.urls, nil</span><br><span class="line">&#125;</span><br><span class="line">fmt.Printf(&quot;missing: %s\n&quot;, url)</span><br><span class="line">return nil, fmt.Errorf(&quot;not found: %s&quot;, url)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// fetcher is a populated fakeFetcher.</span><br><span class="line">var fetcher = fakeFetcher&#123;</span><br><span class="line">&quot;http://golang.org/&quot;: &amp;fakeResult&#123;</span><br><span class="line">&quot;The Go Programming Language&quot;,</span><br><span class="line">[]string&#123;</span><br><span class="line">&quot;http://golang.org/pkg/&quot;,</span><br><span class="line">&quot;http://golang.org/cmd/&quot;,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;,</span><br><span class="line">&quot;http://golang.org/pkg/&quot;: &amp;fakeResult&#123;</span><br><span class="line">&quot;Packages&quot;,</span><br><span class="line">[]string&#123;</span><br><span class="line">&quot;http://golang.org/&quot;,</span><br><span class="line">&quot;http://golang.org/cmd/&quot;,</span><br><span class="line">&quot;http://golang.org/pkg/fmt/&quot;,</span><br><span class="line">&quot;http://golang.org/pkg/os/&quot;,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;,</span><br><span class="line">&quot;http://golang.org/pkg/fmt/&quot;: &amp;fakeResult&#123;</span><br><span class="line">&quot;Package fmt&quot;,</span><br><span class="line">[]string&#123;</span><br><span class="line">&quot;http://golang.org/&quot;,</span><br><span class="line">&quot;http://golang.org/pkg/&quot;,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;,</span><br><span class="line">&quot;http://golang.org/pkg/os/&quot;: &amp;fakeResult&#123;</span><br><span class="line">&quot;Package os&quot;,</span><br><span class="line">[]string&#123;</span><br><span class="line">&quot;http://golang.org/&quot;,</span><br><span class="line">&quot;http://golang.org/pkg/&quot;,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨å¤šçº¿ç¨‹çš„ä¾‹å­ï¼Œæœ‰ä¸‰ç§ä¸åŒé£æ ¼çš„æ–¹æ¡ˆã€‚</p><p>çˆ¬è™«å°±æ˜¯ä½ ç»™å®ƒä¸€ä¸ª URL è®©å®ƒå¼€å§‹è¿è¡Œã€‚åœ¨ web é¡µé¢é‡Œï¼ŒåŒ…å«æœ‰è®¸å¤šé“¾æ¥æŒ‡å‘äº†å…¶å®ƒçš„é¡µé¢ï¼Œæ‰€ä»¥ web çˆ¬è™«è¦åšçš„å°±æ˜¯æŠŠè¿™äº›é“¾æ¥æŒ‡å‘çš„é¡µé¢æå–å‡ºæ¥ï¼ŒæŠ“å–è¿™äº›é¡µé¢åå†æ£€æŸ¥æ‰€æœ‰è¿™äº›é¡µé¢é‡Œçš„ urlï¼Œç„¶åç»§ç»­æŠ“å–è¿™äº› url æŒ‡å‘çš„é¡µé¢ï¼Œå®ƒåº”è¯¥è¦èƒ½å¤Ÿåœæ­¢â€”â€”æ¯”å¦‚ç›´åˆ° web ä¸­æ‰€æœ‰çš„é¡µé¢è¢«æŠ“å–å®Œã€‚</p><p>å¦å¤–ç½‘é¡µæ„æˆçš„ graph å’Œ URL å­˜åœ¨ç¯ï¼Œç¨ä¸æ³¨æ„å¯èƒ½å°±ä¼šé™·å…¥æ°¸æ— æ­¢å¢ƒçš„çˆ¬å–ã€‚æ‰€ä»¥çˆ¬è™«çš„å·¥ä½œä¹‹ä¸€å°±æ˜¯éœ€è¦<strong>è®°ä½å®ƒæŠ“å–è¿‡çš„é¡µé¢</strong>ï¼Œæˆ–æ˜¯å·²ç»å¼€å§‹æŠ“å–çš„é¡µé¢ï¼Œå¯¹äºä»»ä½•æ­£åœ¨æŠ“å–ä¸­çš„é¡µé¢éƒ½ä¸åº”è¯¥æœ‰ç¬¬äºŒæ¬¡æŠ“å–ã€‚</p><p>å®ƒæ˜¯ä¸€ä¸ªæ ‘ç»“æ„ï¼Œè¿™ä¸ªæ ‘ç»“æ„æ˜¯ä¸€ä¸ªåŒ…å«äº†ç¯çš„å®é™…ç½‘é¡µ graph çš„å­é›†ï¼Œæˆ‘ä»¬æƒ³é¿å¼€ç¯ï¼Œä¸æƒ³æŠ“å–åŒä¸€ä¸ªé¡µé¢ 2 æ¬¡ï¼Œå¦å¤–ï¼Œå®è·µè¯æ˜æŠ“å–ä¸€ä¸ª web é¡µé¢éœ€è¦èŠ±ç‚¹æ—¶é—´ï¼Œä½†æ˜¯å› ä¸ºç½‘ç»œæœ‰è¾ƒé•¿çš„å»¶è¿ŸæœåŠ¡å™¨åˆå¾ˆæ…¢ï¼Œæ‰€ä»¥ä½ å®Œå…¨ä¸ä¼šæƒ³ä¸€æ¬¡åªæŠ“å–ä¸€ä¸ªé¡µé¢ã€‚</p><p>ä½ éœ€è¦ä½¿ç”¨å¹¶è¡ŒåŒ–çš„æ–¹å¼æŒç»­çš„å¢åŠ æŠ“å–é¡µé¢çš„æ•°é‡ï¼Œç›´åˆ°è¾¾åˆ°å‘‘åæé™ï¼Œä¹Ÿå°±æ˜¯æ¯ç§’ä½ æŠ“å–çš„é¡µé¢æ•°é‡ä¸å†å¢åŠ ä¸ºæ­¢ï¼Œä¹Ÿå°±æ˜¯å¹¶å‘æ•°çš„å¢åŠ è€—å°½äº†ç½‘ç»œå¸¦å®½ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¸Œæœ›åˆ©ç”¨å¹¶è¡ŒåŒ–çš„æ–¹å¼æŠ“å–ã€‚</p><p>æœ€åä¸€ä¸ªæŒ‘æˆ˜æœ‰æ—¶å€™ä¹Ÿæ˜¯æœ€éš¾è§£å†³çš„é—®é¢˜ï¼Œå½“çˆ¬è™«è¿è¡Œç»“æŸï¼Œä¸€æ—¦æˆ‘ä»¬å·²ç»æŠ“å–äº†æ‰€æœ‰çš„é¡µé¢ï¼Œå°±éœ€è¦åœæ­¢çˆ¬è™«ã€‚ä»€ä¹ˆæ—¶å€™ç»“æŸè¢«è¯æ˜æ˜¯æœ€éš¾çš„ä¸€éƒ¨åˆ†ã€‚</p><p>ä¸²è¡ŒåŒ–é£æ ¼<br>æ‰€ä»¥æˆ‘çš„ç¬¬ä¸€ä¸ªçˆ¬è™«æ˜¯ä¸€ä¸ªä¸²è¡ŒåŒ–çš„çˆ¬è™«ï¼Œä¸Šé¢è¿™æ®µä»£ç æ˜¯å¯ä»¥ç”¨çš„ï¼Œè¿™ä¸ªä¸²è¡Œçˆ¬è™«åœ¨ç½‘é¡µ graph ä¸­è¿›è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢ï¼Œå®ƒä¼šä½¿ç”¨ä¸€ä¸ª map ç±»å‹çš„å˜é‡ fetched ï¼Œå®ƒåªæ˜¯è¢«å½“ä½œä¸€ä¸ª set ä½¿ç”¨æ¥è®°ä½å®ƒæ‰€æŠ“å–è¿‡çš„é¡µé¢ã€‚åœ¨ 18 è¡Œä½ ç»™å®ƒä¸€ä¸ª URLï¼Œå¦‚æœè¿™ä¸ª URL å·²ç»è¢«æŠ“å–è¿‡å®ƒå°±ç›´æ¥ returnï¼Œå¦‚æœæ²¡æœ‰è¢«æŠ“å–è¿‡ï¼Œé¦–å…ˆå®ƒè¦æŠŠè¿™ä¸ª URL è®°ä¸‹ï¼Œç„¶åå¼€å§‹æŠ“å–ï¼Œfetcher ä¼šçœŸæ­£å¼€å§‹æŠ“å–é¡µé¢ï¼Œç„¶åæå–é¡µé¢ä¸­çš„ URLï¼Œæ¥ä¸‹æ¥è¿­ä»£æ‰€æœ‰çš„ URLï¼Œé€’å½’çš„è°ƒç”¨å®ƒè‡ªå·±ï¼Œå¯¹äºæ‰€æœ‰çš„é¡µé¢ï¼Œå®ƒä¼šæŠŠè¿™äº›é¡µé¢ä¼ é€’ç»™è‡ªå·±ã€‚å®ƒåªæœ‰ä¸€ä¸ªè¡¨æ ¼ï¼Œä¸€ä¸ª fetched mapï¼Œå½“æˆ‘è°ƒç”¨é€’å½’çš„æŠ“å–çš„æ—¶å€™ï¼Œå®ƒåˆæŠ“å–äº†å¾ˆå¤šé¡µé¢ã€‚ï¼Œåœ¨æŠ“å–å®ä¾‹ä¹‹å¤–ï¼Œéœ€è¦æ„è¯†åˆ°æŸäº›é¡µé¢æ˜¯å·²ç»æŠ“å–è¿‡çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ååˆ†ä¾èµ–äºåœ¨å‡½æ•°é‡Œä¼ é€’çš„ fetched å¯¹è±¡ã€‚map ä½¿ç”¨å¼•ç”¨è€Œä¸æ˜¯æ‹·è´ï¼Œæ‰€ä»¥åœ¨åº•å±‚go æŠŠæŒ‡å‘mapå¯¹è±¡çš„æŒ‡é’ˆä¼ é€’ç»™æ¯ä¸ªcrawlå‡½æ•°è°ƒç”¨ï¼Œå› æ­¤è¿™äº›è°ƒç”¨å…±äº«åŒä¸€ä¸ªå¯¹è±¡å’Œå†…å­˜çš„æŒ‡é’ˆï¼Œè€Œä¸æ˜¯ï¼ˆå¯¹è±¡ï¼‰çš„æ‹·è´ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">func Serial(url string, fetcher Fetcher, fetched map[string]bool) &#123;</span><br><span class="line">if fetched[url] &#123;</span><br><span class="line">return</span><br><span class="line">&#125;</span><br><span class="line">fetched[url] = true</span><br><span class="line">urls, err := fetcher.Fetch(url)</span><br><span class="line">if err != nil &#123;</span><br><span class="line">return</span><br><span class="line">&#125;</span><br><span class="line">for _, u := range urls &#123;</span><br><span class="line">Serial(u, fetcher, fetched)</span><br><span class="line">&#125;</span><br><span class="line">return</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¹¶å‘é£æ ¼â€”â€”å…±äº«æ•°æ®ä¸äº’æ–¥</strong></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Concurrent crawler with shared state and Mutex</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> fetchState <span class="keyword">struct</span> &#123;</span><br><span class="line">mu      sync.Mutex</span><br><span class="line">fetched <span class="keyword">map</span>[<span class="type">string</span>]<span class="type">bool</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ConcurrentMutex</span><span class="params">(url <span class="type">string</span>, fetcher Fetcher, f *fetchState)</span></span> &#123;</span><br><span class="line">f.mu.Lock()</span><br><span class="line">already := f.fetched[url]</span><br><span class="line">f.fetched[url] = <span class="literal">true</span></span><br><span class="line">f.mu.Unlock()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> already &#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">urls, err := fetcher.Fetch(url)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> done sync.WaitGroup</span><br><span class="line"><span class="keyword">for</span> _, u := <span class="keyword">range</span> urls &#123;</span><br><span class="line">done.Add(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(u <span class="type">string</span>)</span></span> &#123;</span><br><span class="line"><span class="keyword">defer</span> done.Done()</span><br><span class="line">ConcurrentMutex(u, fetcher, f)</span><br><span class="line">&#125;(u)</span><br><span class="line">&#125;</span><br><span class="line">done.Wait()</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">makeState</span><span class="params">()</span></span> *fetchState &#123;</span><br><span class="line">f := &amp;fetchState&#123;&#125;</span><br><span class="line">f.fetched = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="type">bool</span>)</span><br><span class="line"><span class="keyword">return</span> f</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç æ˜æ˜¾æ¯”Serial crawlerè¦å¤æ‚çš„å¤šï¼Œå®ƒä¸ºæ¯ä¸ªfetchåˆ›å»ºä¸€ä¸ªthreadï¼Œæœ€å¤§çš„ä¸åŒä¹‹å¤„åœ¨äºå®ƒåšäº†ä¸¤ä»¶äº‹ï¼šä¸€æ˜¯å¿…è¦çš„ç»Ÿè®¡ä»¥æ³¨æ„åˆ°æ‰€æœ‰çˆ¬å–å®Œæˆçš„æ—¶åˆ»ï¼Œå®ƒä¹Ÿä¼šå¤„ç†å…±äº«è¡¨æ ¼ï¼Œè¿™ä¸ªè¡¨æ ¼è®°å½•äº†å·²çˆ¬å–çš„URLï¼Œæ‰€ä»¥è¿™æ®µä»£ç ä»ç„¶æœ‰URLè¡¨æ ¼å³ f.fetchedï¼Œè¿™ä¸ªè¡¨æ ¼è¢«æ‰€æœ‰çš„crawlerçº¿ç¨‹å…±äº«ï¼Œæ‰€æœ‰çš„crawlerçº¿ç¨‹æ‰§è¡Œåœ¨å‡½æ•° ConcurrentMutex å†… ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»ç„¶æœ‰ ConcurrentMutex çš„æ ‘ç»“æ„æ¥æ¢ç´¢ web graph çš„ä¸åŒéƒ¨åˆ†ã€‚ä½†å®ƒä»¬ä¸­çš„æ¯ä¸€ä¸ªæ˜¯è¢«æ”¾åœ¨å„è‡ªçš„goroutineä¸­å¯åŠ¨ï¼Œè€Œä¸æ˜¯ä½œä¸ºå‡½æ•°è°ƒç”¨ï¼Œå®ƒä»¬éƒ½å…±äº«ä¸€ä¸ªçŠ¶æ€è¡¨è®°å½•å·²çˆ¬å–URLçš„è¡¨æ ¼ï¼Œå› ä¸ºå¦‚æœæœ‰ä¸ªgoroutineçˆ¬å–äº†ä¸€ä¸ªURLï¼Œæˆ‘ä»¬ä¸å¸Œæœ›å¦ä¸€ä¸ªgoroutineæ„å¤–åœ°çˆ¬å–åŒä¸€ä¸ªURL ï¼Œ11è¡Œå’Œ14è¡Œä¹‹é—´åŠ ä¸Šäº†äº’æ–¥é”ï¼Œç”¨äºé˜²æ­¢raceã€‚</p><p>å½“æˆ‘ä»¬æ£€æŸ¥è¡¨ä¸­çš„URLæ¡ç›®ä¹‹åï¼Œåœ¨20è¡ŒURLè¢«ä»¥å¸¸è§çš„æ–¹å¼çˆ¬å–urls, err :&#x3D; fetcher.Fetch(url)ã€‚ä¹‹åå¦ä¸€ä¸ªæœ‰è¶£çš„äº‹æƒ…æ˜¯çº¿ç¨‹çš„å¯åŠ¨ã€‚åœ¨ç¬¬25è¡Œ ï¼Œéå†fetchå‡½æ•°è¿”å›çš„URLsfor _, u :&#x3D; range urlsã€‚ç¬¬27è¡Œï¼Œå¯¹æ¯ä¸ªURLå¯åŠ¨ä¸€ä¸ªgoroutinego func(u string) ã€‚funcè¯­æ³•æ˜¯ä¸€ä¸ªé—­åŒ…ï¼ˆclosureï¼‰æˆ–ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œfuncå…³é”®å­—å£°æ˜äº†ä¸€ä¸ªå‡½æ•°ç„¶åæˆ‘ä»¬è°ƒç”¨äº†è¿™ä¸ªå‡½æ•°ã€‚ç†è§£ï¼ˆè¿™æ®µä»£ç ï¼‰çš„æ–¹å¼æ˜¯ä½ æŠŠä¸€ä¸ªå‡½æ•°å£°æ˜æˆä¸€æ®µæ•°æ® å…ˆå†™ä¸‹funcå…³é”®å­—ï¼Œç„¶åç»™å‡ºå‡½æ•°å‚æ•°ï¼Œä¹‹åå†™å‡ºå‡½æ•°ä½“ ç»“æŸï¼Œç°åœ¨è¿™æ˜¯ä¸€ä¸ªå¯¹è±¡ ã€‚ä¸ºäº†è®©å®ƒæˆä¸ºä¸€ä¸ªgoroutineï¼Œæˆ‘ä»¬è¦åœ¨funcå‰åŠ ä¸Šgoå…³é”®å­—ï¼Œç„¶åæˆ‘ä»¬å¿…é¡»è¦è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå› ä¸ºåœ¨goè¯­æ³•ä¸­goå…³é”®å­—åé¢æ¥å‡½æ•°åä»¥åŠè¦ä¼ é€’çš„å‚æ•°ã€‚ç¬¬24è¡Œçš„<strong>WaitGroup</strong> æ˜¯goè¯­è¨€å®šä¹‰çš„ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œç”¨äºå¸®åŠ©coordinationã€‚WaitGroupå†…éƒ¨æœ‰ä¸€ä¸ªè®¡æ•°å™¨ï¼Œè°ƒç”¨WaitGroup.Add()æ¥å¢åŠ è®¡æ•°å™¨ï¼Œè°ƒç”¨WaitGroup.Done()æ¥å‡å°è®¡æ•°å™¨ã€‚ç¬¬32è¡Œï¼ŒWaitæ–¹æ³•è¢«è°ƒç”¨ï¼Œç­‰å¾…è®¡æ•°å™¨å½’é›¶ï¼Œå› æ­¤WaitGroupæ˜¯ä¸€ç§ç”¨äºç­‰å¾…è‹¥å¹²äº‹ä»¶ç»“æŸçš„æ–¹å¼ï¼Œå®ƒåœ¨å¾ˆå¤šä¸åŒåœºæ™¯ä¸­éƒ½æœ‰åº”ç”¨ï¼Œè¿™é‡Œæˆ‘ä»¬åº”ç”¨å®ƒæ¥ç­‰å¾…æœ€åä¸€ä¸ªgoroutineç»“æŸï¼Œå› ä¸ºæˆ‘ä»¬å¯¹äºæ¯ä¸ªgoroutineéƒ½å¯¹WaitGroupåŠ ä¸€ã€‚</p><p>â“ å¦‚æœæŸä¸ªå­ç¨‹åº(subroutine)å¤±è´¥å¯¼è‡´doneæ²¡è¢«è°ƒç”¨è¯¥æ€ä¹ˆåŠ</p><p>æœ‰äº›æ–¹å¼å¯ä»¥ä½¿functionå¤±è´¥ï¼Œgoroutineæ­»æ‰è€Œæ•´ä¸ªç¨‹åºä¸æ­»ï¼Œè¿™å¯¹æˆ‘ä»¬æ˜¯ä¸ªéº»çƒ¦ã€‚æ‰€ä»¥å®é™…ä¸Š æ­£ç¡®çš„æ–¹å¼æ˜¯defer done.Done()ï¼Œä»¥ç¡®ä¿ä¸è®ºgoroutineæ˜¯æ€ä¹ˆç»“æŸçš„ï¼Œdoneéƒ½ä¼šè¢«è°ƒç”¨ã€‚</p><p>â“ ä¸ºä»€ä¹ˆä¸¤ä¸ªä¸åŒthreadså¯¹doneçš„è°ƒç”¨ä¸æ„æˆrace</p><p>ï¼ˆWaitGroupï¼‰å†…éƒ¨æœ‰äº’æ–¥é”æˆ–ç±»ä¼¼çš„æœºåˆ¶ï¼Œæ¯ä¸ªdoneçš„æ–¹æ³•ä¼šåœ¨æ‰§è¡Œä»»ä½•æŒ‡ä»¤å‰å…ˆå–å¾—é”ï¼Œäºæ˜¯åŒæ—¶è°ƒç”¨WaitGroupçš„æ–¹æ³•å¹¶ä¸æ„æˆrace</p><p>éå¸¸éš¾ææ¸…æ¥šä½ æ˜¯ä¸æœ‰ä¸€ä¸ªraceï¼Œä½ å¯èƒ½ä¼šæœ‰ä¸€æ®µä»£ç çœ‹èµ·æ¥éå¸¸åˆç†ï¼Œä½†å®é™…ä¸Šæœ‰æŸäº›ä½ æœªçŸ¥çš„race æ˜¯ä½¿ç”¨å…±äº«å˜é‡å¯¼è‡´çš„ ï¼Œåœ¨å®è·µä¸­å”¯ä¸€èƒ½å‘ç°raceçš„æ–¹æ³•æ˜¯ä½¿ç”¨è‡ªåŠ¨åŒ–çš„å·¥å…·ã€‚å¹¸è¿çš„æ˜¯goç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå¾ˆä¸é”™çš„raceæ¢æµ‹å™¨ï¼Œgo run -race crawler.goã€‚ä½ åº”è¯¥ä½¿ç”¨å®ƒã€‚å¦‚æœä½ æŠŠ -race ä½œä¸ºå‘½ä»¤è¡Œå‚æ•°ï¼Œraceæ£€æµ‹å™¨ä¼šå‘Šè¯‰æˆ‘ä»¬raceå‘ç”Ÿçš„å‡†ç¡®ä½ç½®ã€‚</p><p>å¦‚æœä½ ä¸æ‰§è¡Œä»»ä½•ä»£ç ï¼Œé‚£ä¹ˆraceæ¢æµ‹å™¨ä¸ä¼šçŸ¥é“ä»»ä½•äº‹ï¼Œå®ƒå°†ä¸ä¼šåˆ†æã€‚å®ƒå¹¶ä¸æ˜¯åšé™æ€åˆ†æï¼Œraceæ¢æµ‹å™¨ä¸ä¼šçœ‹ä½ çš„æºä»£ç ï¼Œä¸ä¼šåŸºäºæºä»£ç ä½œå‡ºåˆ¤æ–­ï¼Œå®ƒè§‚å¯Ÿä¸€æ¬¡å…·ä½“çš„ç¨‹åºè¿è¡Œã€‚æ‰€ä»¥å¦‚æœè¿™æ¬¡å…·ä½“çš„ç¨‹åºè¿è¡Œæ²¡æœ‰æ‰§è¡Œï¼Œraceæ¢æµ‹å™¨ä¸å¯èƒ½çŸ¥é“æŸäº›æ°å¥½è¯»å†™å…±äº«æ•°æ®çš„ä»£ç ï¼Œè¿™æ˜¯éœ€è¦å°å¿ƒçš„åœ°æ–¹ã€‚éœ€è¦è®¾ç½®æŸç§æµ‹è¯•è£…ç½®ä»¥ç¡®ä¿æ‰€æœ‰çš„ä»£ç éƒ½è¢«æ‰§è¡Œã€‚</p><p><strong>å¹¶å‘é£æ ¼â€”â€”channel</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">//</span><br><span class="line">// Concurrent crawler with channels</span><br><span class="line">//</span><br><span class="line"></span><br><span class="line">func worker(url string, ch chan []string, fetcher Fetcher) &#123;</span><br><span class="line">urls, err := fetcher.Fetch(url)</span><br><span class="line">if err != nil &#123;</span><br><span class="line">ch &lt;- []string&#123;&#125;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">ch &lt;- urls</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func master(ch chan []string, fetcher Fetcher) &#123;</span><br><span class="line">n := 1</span><br><span class="line">fetched := make(map[string]bool)</span><br><span class="line">for urls := range ch &#123;</span><br><span class="line">for _, u := range urls &#123;</span><br><span class="line">if fetched[u] == false &#123;</span><br><span class="line">fetched[u] = true</span><br><span class="line">n += 1</span><br><span class="line">go worker(u, ch, fetcher)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">n -= 1</span><br><span class="line">if n == 0 &#123;</span><br><span class="line">break</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func ConcurrentChannel(url string, fetcher Fetcher) &#123;</span><br><span class="line">ch := make(chan []string)</span><br><span class="line">go func() &#123;</span><br><span class="line">ch &lt;- []string&#123;url&#125;</span><br><span class="line">&#125;()</span><br><span class="line">master(ch, fetcher)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ç§å®ç°æ–¹å¼ä¸­ï¼Œä¸éœ€è¦ä½¿ç”¨é”ã€‚æœ‰ä¸€ä¸ªmasterçº¿ç¨‹ï¼Œå®ƒæœ‰ä¸€ä¸ªè¡¨æ ¼ï¼Œä½†æ˜¯è¿™ä¸ªè¡¨æ ¼æ˜¯masterå‡½æ•°ç§æœ‰çš„ï¼Œmasterå‡½æ•°å¹¶ä¸åƒå‰ä¸€ä¸ªç‰ˆæœ¬é‚£æ ·åˆ›å»ºã€‚è¿™ä¸ªç‰ˆæœ¬ä¸ºæ¯ä¸ªURLåˆ›å»ºä¸€ä¸ªgoroutineï¼Œä½†æ˜¯åªç”±masteræ¥åˆ›å»ºï¼Œåªæœ‰å”¯ä¸€ä¸€ä¸ªmasteråˆ›å»ºè¿™äº›çº¿ç¨‹ ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡æœ‰ä¸€ä¸ªå‡½æ•°çš„æ ‘å½¢ç»“æ„ï¼Œæˆ‘ä»¬åªæœ‰ä¸€ä¸ªmasterï¼Œåœ¨16è¡Œåˆ›å»ºäº†è‡ªå·±çš„ç§æœ‰mapfetched :&#x3D; make(map[string]bool)ï¼Œè®°å½•å“ªäº›URLå·²ç»çˆ¬å–ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªchannelï¼Œåªæœ‰ä¸€ä¸ªchannel æ‰€æœ‰çš„workerçº¿ç¨‹éƒ½å°†é€šè¿‡è¿™ä¸ªchannelæ²Ÿé€šã€‚</p><p>è¿™ä¸ªæ€è·¯æ˜¯ï¼Œå¯åŠ¨ä¸€ä¸ªworkerçº¿ç¨‹ï¼Œæ¯ä¸ªworkerçº¿ç¨‹åœ¨ç»“æŸæ—¶åªä¼šé€šè¿‡channelå‘é€æ°å¥½ä¸€ä»½æ•°æ®ç»™masterï¼Œè¿™ä»½æ•°æ®åŒ…å«äº†è¿™ä¸ªworkerä»ç½‘é¡µä¸Šçˆ¬å–çš„ç½‘é¡µä¸­çš„URLçš„åˆ—è¡¨ã€‚masteråœ¨ç¬¬17è¡Œå¾ªç¯ä¸­ ä»channelä¸­è¯»å–æ•°æ®for urls :&#x3D; range chã€‚å¦‚æœURLè¿˜æœªè¢«çˆ¬å–ï¼Œå®ƒå°†åœ¨ç¬¬22è¡Œå¯åŠ¨ä¸€ä¸ªæ–°çš„workerå»çˆ¬å–é‚£ä¸ªURL go worker(u, ch, fetcher)ã€‚</p><p>workerçº¿ç¨‹ä¸å…±äº«ä»»ä½•å¯¹è±¡ï¼Œworkerå’Œmasterä¹‹é—´ä¹Ÿä¸å…±äº«ä»»ä½•å¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¿…æ‹…å¿ƒé”å’Œraceã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åˆ†å¸ƒå¼ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ†å¸ƒå¼ç³»ç»Ÿ </tag>
            
            <tag> 6.824 </tag>
            
            <tag> Golang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MIT 6.824 Lecture3-GFS</title>
      <link href="/2024/07/03/MIT-6.824-Lecture3-GFS/"/>
      <url>/2024/07/03/MIT-6.824-Lecture3-GFS/</url>
      
        <content type="html"><![CDATA[<h3 id="Lecture-3-GFS"><a href="#Lecture-3-GFS" class="headerlink" title="Lecture 3-GFS"></a>Lecture 3-GFS</h3><p>[(289æ¡æ¶ˆæ¯) è°·æ­Œæ–‡ä»¶ç³»ç»ŸGFSç†è§£_å°ç‚®è½¦çš„åšå®¢-CSDNåšå®¢_googleæ–‡ä»¶ç³»ç»Ÿgfs](<a href="https://blog.csdn.net/SwjtuPC/article/details/123652626?ops_request_misc=&request_id=&biz_id=102&utm_term=GFS">https://blog.csdn.net/SwjtuPC/article/details/123652626?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=GFS</a> PRIMARY&amp;utm_medium&#x3D;distribute.pc_search_result.none-task-blog-2<del>all</del>sobaiduweb~default-0-123652626.142^v47^pc_rank_34_ctr25,201^v3^add_ask&amp;spm&#x3D;1018.2226.3001.4187)</p><p>è¿™é—¨è¯¾ç¨‹çš„ä¸»è¦å†…å®¹æ˜¯â€œå¤§å‹å­˜å‚¨â€ï¼ŒGFSæ˜¯è¿™é—¨è¯¾é‡Œæœ‰å…³å¦‚ä½•æ„å»ºå¤§å‹å­˜å‚¨ç³»ç»Ÿçš„ä¼—å¤šæ¡ˆä¾‹å­¦ä¹ çš„ç¬¬ä¸€ç¯‡ã€‚å­˜å‚¨æ˜¯ä¸€ç§å…³é”®çš„æŠ½è±¡ï¼Œå¾ˆå¤šç³»ç»Ÿè¦ä¹ˆæ˜¯è®¾è®¡çš„ç®€å•æ˜“ç”¨çš„å­˜å‚¨æ¥å£ï¼Œè¦ä¹ˆæ˜¯åŸºäºåº•å±‚å­˜å‚¨è¿›è€Œæ„å»ºã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¯èƒ½æœ‰å„ç§å„æ ·é‡è¦çš„æŠ½è±¡å¯ä»¥åº”ç”¨åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œç®€å•çš„å­˜å‚¨æ¥å£å¾€å¾€éå¸¸æœ‰ç”¨ä¸”æå…¶é€šç”¨ã€‚æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿå¤§å¤šéƒ½æ˜¯å…³äºå¦‚ä½•è®¾è®¡å­˜å‚¨ç³»ç»Ÿï¼Œæˆ–æ˜¯è®¾è®¡å…¶å®ƒåŸºäºå¤§å‹åˆ†å¸ƒå¼å­˜å‚¨çš„ç³»ç»Ÿã€‚å› æ­¤æˆ‘ä»¬ä¼šæ›´åŠ å…³æ³¨å¦‚ä½•ä¸ºå¤§å‹åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿè®¾è®¡ä¸€ä¸ªä¼˜ç§€çš„æ¥å£ï¼Œä»¥åŠå¦‚ä½•è®¾è®¡ä¼˜ç§€çš„å­˜å‚¨ç³»ç»Ÿçš„å†…éƒ¨ç»“æ„ã€‚</p><p>æ„Ÿè§‰å°±æ˜¯åˆ†å¸ƒå¼å­˜å‚¨æ˜¯å¾ˆå¤šåˆ†å¸ƒå¼çš„åº•å±‚ï¼Œå› æ­¤ä¸€ä¸ªä¼˜ç§€ã€ç®€å•ã€æŠ½è±¡çš„æ¥å£å’Œä¼˜ç§€çš„å­˜å‚¨å†…éƒ¨ç»“æ„å°±å¾ˆé‡è¦äº†ã€‚è¿™é‡Œä¸€æ–¹é¢æ˜¯è¯´æ˜å­˜å‚¨çš„é‡è¦æ€§ï¼Œå¦ä¸€æ–¹é¢å€¼å¾—å…³æ³¨çš„æ˜¯æ¥å£å’Œå­˜å‚¨å†…éƒ¨ç»“æ„ï¼Œè¿™ä¸¤ç‚¹éƒ½å¾ˆé‡è¦ã€‚</p><h4 id="3-1-Why-HARD"><a href="#3-1-Why-HARD" class="headerlink" title="3.1 Why HARD"></a>3.1 Why HARD</h4><p>ä¸ºä»€ä¹ˆåˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿä¼šå¦‚æ­¤ä¹‹éš¾ï¼Œä»¥è‡³äºä½ éœ€è¦åšå¤§é‡çš„å·¥ä½œæ‰èƒ½è®©å®ƒæ­£ç¡®å·¥ä½œï¼Ÿ</p><ul><li><strong>Performance â€“&gt; Sharding</strong></li><li><strong>Fault â€“&gt; Tolerance</strong></li><li><strong>Tolerance â€“&gt; Replication</strong></li><li><strong>Repl â€“&gt; In Consistency</strong></li><li><strong>Consistency â€“&gt; Low Performance</strong></li></ul><p>äººä»¬è®¾è®¡å¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿæˆ–å¤§å‹å­˜å‚¨ç³»ç»Ÿå‡ºå‘ç‚¹é€šå¸¸æ˜¯æƒ³è·å–å·¨å¤§çš„æ€§èƒ½åŠ æˆï¼Œé€šè¿‡åˆ©ç”¨æ•°ç™¾å°è®¡ç®—æœºçš„èµ„æºæ¥åŒæ—¶å®Œæˆå¤§é‡å·¥ä½œã€‚å› æ­¤ï¼Œæ€§èƒ½performanceé—®é¢˜å°±æˆä¸ºäº†æœ€åˆçš„è¯‰æ±‚ã€‚ ä¹‹åï¼Œå¾ˆè‡ªç„¶çš„æƒ³æ³•å°±æ˜¯å°†æ•°æ®åˆ†å‰²æ”¾åˆ°å¤§é‡çš„æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·å°±å¯ä»¥å¹¶è¡Œçš„ä»å¤šå°æœåŠ¡å™¨è¯»å–æ•°æ®ã€‚æˆ‘ä»¬å°†è¿™ç§æ–¹å¼ç§°ä¹‹ä¸ºåˆ†ç‰‡ï¼ˆShardingï¼‰ã€‚<br>å¦‚æœä½ åœ¨æˆç™¾ä¸Šåƒå°æœåŠ¡å™¨è¿›è¡Œåˆ†ç‰‡ï¼Œä½ å°†ä¼šçœ‹è§å¸¸æ€çš„æ•…éšœã€‚æ•°åƒå°æœåŠ¡å™¨é‡Œæ¯å¤©ä¼šæœ‰ä¸€å°æœåŠ¡å™¨å®•æœºï¼Œç”šè‡³æ¯ä¸ªå°æ—¶éƒ½å¯èƒ½ä¼šå‘ç”Ÿé”™è¯¯ã€‚å› æ­¤éœ€è¦è‡ªåŠ¨åŒ–çš„æ–¹æ³•è€Œä¸æ˜¯äººå·¥ä»‹å…¥æ¥ä¿®å¤é”™è¯¯ã€‚æ¯å¤©éƒ½æœ‰å¤§é‡é”™è¯¯å‘ç”Ÿï¼Œéœ€è¦è‡ªåŠ¨åŒ–çš„å®¹é”™å³fault toleranceã€‚<br>å®ç°å®¹é”™æœ€æœ‰ç”¨çš„ä¸€ç§æ–¹æ³•æ˜¯ä½¿ç”¨å¤åˆ¶ï¼Œåªéœ€è¦ç»´æŠ¤2-3ä¸ªæ•°æ®çš„å‰¯æœ¬ï¼Œå½“å…¶ä¸­ä¸€ä¸ªæ•…éšœäº†ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ªã€‚å¦‚æœæƒ³è¦å®¹é”™èƒ½åŠ›å°±å¾—æœ‰å¤åˆ¶ï¼ˆreplicationï¼‰ã€‚<br>å¦‚æœæœ‰å¤åˆ¶ï¼Œé‚£å°±æœ‰äº†ä¸¤ä»½ä»¥ä¸Šçš„æ•°æ®å‰¯æœ¬ï¼Œè€Œä¸”å¾ˆå®¹æ˜“ä¸ä¸€è‡´ã€‚æœ¬æ¥æƒ³æœ‰äº†å¤šä¸ªå‰¯æœ¬ï¼Œå°±èƒ½é€šè¿‡ä»»ä¸€å®ç°å®¹é”™ï¼Œç°åœ¨å‘ç°å‰¯æœ¬é—´æ•°æ®å¾ˆéš¾å®Œå…¨ä¸€è‡´ï¼ˆä¸¥æ ¼æ¥è¯´ï¼Œå®ƒä»¬å°±ä¸å†äº’ä¸ºå‰¯æœ¬äº†ï¼‰ã€‚è¿™æ—¶å€™å‘ä¸åŒå‰¯æœ¬è¯·æ±‚ï¼Œè·å–çš„æ•°æ®ä¹Ÿå°±ä¸ä¸€æ ·äº†ã€‚å› æ­¤å¤åˆ¶åˆå¸¦æ¥äº†ä¸ä¸€è‡´çš„é—®é¢˜inconsistencyã€‚<br>é€šè¿‡åˆç†çš„è®¾è®¡å¯ä»¥é¿å…ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œå¹¶ä¸”è®©æ•°æ®çœ‹èµ·æ¥ä¹Ÿè¡¨ç°çš„ç¬¦åˆé¢„æœŸã€‚ä½†è¿™æ ·éœ€è¦é¢å¤–çš„å·¥ä½œï¼Œéœ€è¦æœåŠ¡å™¨é—´é¢å¤–çš„ç½‘ç»œäº¤äº’ï¼Œè¿™æ ·åˆå¯¼è‡´æ€§èƒ½é™ä½ã€‚å› æ­¤ä¸ºäº†è·å¾—ä¸€è‡´æ€§ï¼Œåˆéœ€è¦å¯¼è‡´æ€§èƒ½é™ä½ã€‚<br>å®é™…è®¾è®¡ç³»ç»Ÿæ—¶ï¼Œè¿™äº›é—®é¢˜éƒ½éš¾ä»¥é¿å…ï¼Œå› æ­¤å°±è¦åœ¨æ€§èƒ½å’Œä¸€è‡´æ€§ä¹‹é—´æƒè¡¡ï¼Œå¹¶ä¸ºä¸€è‡´æ€§çš„ä¿éšœåšå‡ºæ€§èƒ½ä¸Šçš„è®©æ­¥ï¼Œå¦åˆ™ç³»ç»Ÿå°±ä¼šå‡ºç°å¼‚å¸¸é—®é¢˜ã€‚</p><h4 id="3-2-Strong-Consistency"><a href="#3-2-Strong-Consistency" class="headerlink" title="3.2 Strong Consistency"></a>3.2 Strong Consistency</h4><p><strong>å¯¹äºå…·å¤‡å¼ºä¸€è‡´ strong consistencyæˆ–è€…å¥½çš„ä¸€è‡´æ€§ good consistencyçš„ç³»ç»Ÿï¼Œä»åº”ç”¨ç¨‹åºæˆ–è€…å®¢æˆ·ç«¯çœ‹èµ·æ¥å°±åƒæ˜¯å’Œä¸€å°æœåŠ¡å™¨åœ¨é€šä¿¡ã€‚</strong>å°½ç®¡æˆ‘ä»¬ä¼šé€šè¿‡æ•°ç™¾å°è®¡ç®—æœºæ„å»ºä¸€ä¸ªç³»ç»Ÿï¼Œä½†æ˜¯å¯¹äºä¸€ä¸ªç†æƒ³çš„å¼ºä¸€è‡´æ¨¡å‹ï¼Œä½ çœ‹åˆ°çš„å°±åƒæ˜¯åªæœ‰ä¸€å°æœåŠ¡å™¨ï¼Œä¸€ä»½æ•°æ®ï¼Œå¹¶ä¸”ç³»ç»Ÿä¸€æ¬¡åªåšä¸€ä»¶äº‹æƒ…ã€‚å¯ä»¥è®¤ä¸ºå®Œå…¨å°±æ˜¯å•ä¸ªæœåŠ¡å™¨ä¸Šçš„å•çº¿ç¨‹ï¼ŒåŒä¸€æ—¶é—´åªå¤„ç†æ¥è‡ªå®¢æˆ·ç«¯çš„ä¸€ä¸ªè¯·æ±‚ã€‚<br>ä¸¾ä¾‹æ¥è¯´ï¼šï¼ˆä¸€ä¸ªå¼ºä¸€è‡´æ€§ç³»ç»Ÿçš„ç¤ºä¾‹ï¼‰<br>ä¸€ä¸ªåªæ”¯æŒput, getçš„ key-value ç³»ç»Ÿã€‚ä¸ºäº†è®©æœåŠ¡æœ‰å¯é¢„æœŸçš„è¡Œä¸ºï¼Œéœ€è¦å®šä¹‰ä¸€æ¡è§„åˆ™ï¼š<strong>ä¸€ä¸ªæ—¶é—´åªæ‰§è¡Œä¸€æ¡è¯·æ±‚ã€‚è¿™æ ·æ¯ä¸ªè¯·æ±‚éƒ½å¯ä»¥çœ‹åˆ°ä¹‹å‰æ‰€æœ‰è¯·æ±‚æŒ‰ç…§é¡ºåºæ‰§è¡Œç”Ÿæˆçš„æ•°æ®ã€‚</strong>å¦‚æœæˆ‘ä»¬æœ‰ä¸€äº›å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯C1å‘èµ·å†™è¯·æ±‚å°†Xè®¾ç½®æˆ1ï¼›åœ¨åŒä¸€æ—¶åˆ»ï¼Œå®¢æˆ·ç«¯C2å‘èµ·å†™è¯·æ±‚å°†Xè®¾ç½®æˆ2ã€‚åœ¨C1å’ŒC2çš„å†™è¯·æ±‚éƒ½æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œå®¢æˆ·ç«¯C3ä¼šå‘é€è¯»å–Xçš„è¯·æ±‚ï¼Œå¹¶å¾—åˆ°äº†ä¸€ä¸ªç»“æœã€‚å®¢æˆ·ç«¯C4ä¹Ÿä¼šå‘é€è¯»å–Xçš„è¯·æ±‚ï¼Œä¹Ÿå¾—åˆ°äº†ä¸€ä¸ªç»“æœã€‚ç°åœ¨çš„é—®é¢˜æ˜¯ï¼Œè¿™ä¸¤ä¸ªå®¢æˆ·ç«¯çœ‹åˆ°çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ</p><p>å­¦ç”Ÿæé—®ï¼šä¸ºä»€ä¹ˆä¸€å®šè¦ä¸€æ¬¡åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼Ÿ<br>Robertæ•™æˆï¼šå‡è®¾C1å’ŒC2åœ¨åŒä¸€æ—¶é—´å‘èµ·è¯·æ±‚ï¼Œä¹‹ååœ¨æŸä¸ªæ—¶åˆ»ï¼ŒæœåŠ¡å™¨ä¼šå“åº”å®ƒä»¬ã€‚ä½†æ˜¯æ— æ³•åˆ¤æ–­ä¸¤ä¸ªè¯·æ±‚å¤„ç†çš„å…ˆåé¡ºåºï¼Œå¯èƒ½å…ˆå¤„ç†C1åå¤„ç†C2ï¼Œè¿™æ ·æœ€ç»ˆç»“æœæ˜¯2ï¼›åä¹‹åˆ™æ˜¯1ã€‚è¿™ä¸ªä¾‹å­ä¹Ÿè¯´æ˜ï¼Œå³ä½¿éå¸¸ç®€å•çš„ç³»ç»Ÿï¼Œä»ç„¶ä¼šå‡ºç°ä¸€äº›æ¨¡ç³Šçš„åœºæ™¯ä½¿å¾—ä½ ä¸çŸ¥é“ç³»ç»Ÿçš„æ‰§è¡Œè¿‡ç¨‹ä»¥åŠè¾“å‡ºç»“æœã€‚<strong>èƒ½åšçš„åªæ˜¯ä»äº§ç”Ÿçš„ç»“æœæ¥åˆ¤æ–­ç³»ç»Ÿçš„è¾“å‡ºæ˜¯ä¸€è‡´æ€§è¿˜æ˜¯éä¸€è‡´æ€§ã€‚</strong>å¦‚æœC3è¯»Xå¾—åˆ°2ï¼Œé‚£ä¹ˆC4æœ€å¥½ä¹Ÿæ˜¯è¯»Xå¾—åˆ°2ï¼Œå¦åˆ™å°±ä¸æ˜¯å¼ºä¸€è‡´æ€§äº†ã€‚ä½†æ˜¯è¿™é‡Œçš„å•ç³»ç»Ÿåˆä¼šå¸¦æ¥å®¹é”™èƒ½åŠ›çš„é—®é¢˜ï¼Œåˆéœ€è¦æ„å»ºå¤šå‰¯æœ¬çš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œä½†è¿™å´åˆæ˜¯æ‰€æœ‰é—®é¢˜çš„å¼€å§‹ã€‚</p><h4 id="3-3-Bad-Replication-Design"><a href="#3-3-Bad-Replication-Design" class="headerlink" title="3.3 Bad Replication Design"></a>3.3 Bad Replication Design</h4><p>å‡è®¾æœ‰ä¸€ä¸ªç±»ä¼¼ä¸Šé¢çš„æ”¯æŒput, getçš„ key-value ç³»ç»Ÿï¼Œä½†æ˜¯è¿™é‡Œå¯åŠ¨äº†ä¸¤ä¸ªæœåŠ¡ä»¥ä¾¿äºå®¹é”™ã€‚å‡è®¾å®¢æˆ·ç«¯C1å’ŒC2éƒ½æƒ³æ‰§è¡Œå†™è¯·æ±‚ï¼Œå…¶ä¸­ä¸€ä¸ªè¦å†™Xä¸º1ï¼Œå¦ä¸€ä¸ªå†™Xä¸º2ï¼›æ¯ä¸€ä¸ªè¯·æ±‚åŒæ—¶å‘ç»™ä¸¤ä¸ªæœåŠ¡ã€‚è¿™æ—¶ï¼Œä¸¤ä¸ªæœåŠ¡å¤„ç†C1å’ŒC2çš„å…ˆåé¡ºåºæœ‰å¯èƒ½ä¸ä¸€è‡´ï¼Œå°±ä¼šå¯¼è‡´Xæœ€ç»ˆç»“æœä¸ä¸€è‡´ã€‚å¦‚æœC3ä»S1è¯»æ•°æ®ï¼ŒC4ä»S2è¯»æ•°æ®ï¼Œè¿™ä¸¤ä¸ªå®¢æˆ·ç«¯è¯»å–çš„æ•°æ®ä¸ä¸€æ ·ã€‚å¦‚æœæŒ‚äº†ä¸€ä¸ªæœåŠ¡ï¼Œé‚£ä¹ˆåé¢è¯»å–çš„å¯èƒ½å’Œä¹‹å‰è¯»åˆ°çš„å€¼ä¸åŒã€‚<br>è¿™ä¸ªé—®é¢˜æ˜¯å¯ä»¥è§£å†³çš„ï¼Œä½†æ˜¯éœ€è¦æœåŠ¡å™¨ä¹‹é—´é¢å¤–çš„é€šä¿¡ï¼ŒåŒæ—¶ä¹Ÿä¼šæé«˜ç³»ç»Ÿçš„å¤æ‚åº¦ã€‚è·å–å¼ºä¸€è‡´æ€§ä¼šå¸¦æ¥å¤æ‚åº¦çš„æå‡ï¼Œå½“ç„¶ä¹Ÿæœ‰å¾ˆå¤šæ–¹æ³•èƒ½å¤Ÿåœ¨è¿˜ä¸é”™çš„ä¸€è‡´æ€§å’Œå­˜åœ¨å°ç‘•ç–µä¹‹é—´å¹³è¡¡ã€‚</p><h4 id="3-4-GFSçš„è®¾è®¡ç›®æ ‡"><a href="#3-4-GFSçš„è®¾è®¡ç›®æ ‡" class="headerlink" title="3.4 GFSçš„è®¾è®¡ç›®æ ‡"></a>3.4 GFSçš„è®¾è®¡ç›®æ ‡</h4><p>Googleæœ‰å¤§é‡çš„æ•°æ®ï¼ˆç½‘é¡µã€è§†é¢‘ã€ç´¢å¼•ä¸­é—´æ–‡ä»¶ï¼‰ï¼Œéœ€è¦å¤§é‡çš„ç£ç›˜æ¥å­˜å‚¨è¿™äº›æ•°æ®ï¼ŒåŒæ—¶ä¹Ÿéœ€è¦èƒ½å€ŸåŠ©MapReduceè¿™æ ·çš„å·¥å…·æ¥å¿«é€Ÿå¤„ç†è¿™äº›æ•°æ®ï¼Œå› æ­¤Googleéœ€è¦èƒ½å¤Ÿå¿«é€Ÿçš„å¹¶è¡Œè®¿é—®è¿™äº›æµ·é‡æ•°æ®ã€‚è°·æ­Œæ„å»ºäº†ä¸€ä¸ªå¤§å‹å¿«é€Ÿçš„æ–‡ä»¶ç³»ç»Ÿï¼Œè¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„æ•°æ®æ˜¯å…¨å±€æœ‰æ•ˆçš„ï¼Œä¸åŒåº”ç”¨ç¨‹åºéƒ½å¯ä»¥ä»ä¸­è¯»å–æ•°æ®ã€‚ä¸ºäº†æé«˜å®¹é‡ï¼Œæ–‡ä»¶ä¼šè¢«GFSåˆ†å‰²ä¹‹åå­˜æ”¾åœ¨å¤šä¸ªæœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·ä¸€æ–¹é¢ä»å¤šä¸ªæœåŠ¡å™¨ä¸ŠåŒæ—¶è¯»åŒä¸€ä¸ªæ–‡ä»¶ï¼Œè·å¾—äº†æ›´é«˜çš„ååï¼›å¦ä¸€æ–¹é¢æ–‡ä»¶åˆ†å‰²å­˜å‚¨è¿˜å¯ä»¥ä¿å­˜æ¯”å•ä¸ªç£ç›˜è¿˜è¦å¤§çš„æ–‡ä»¶ã€‚å› ä¸ºåœ¨æ•°ç™¾å°æœåŠ¡å™¨ä¸Šæ„å»ºäº†å­˜å‚¨ç³»ç»Ÿï¼Œç³»ç»Ÿéœ€è¦å…·æœ‰ä¸€å®šçš„æ•…éšœä¿®å¤èƒ½åŠ›ã€‚<br>GFSè¢«è®¾è®¡æˆåªåœ¨ä¸€ä¸ªæ•°æ®ä¸­å¿ƒè¿è¡Œï¼Œå•ä¸ªGFSåªå­˜åœ¨äºå•ä¸ªæ•°æ®ä¸­å¿ƒçš„å•ä¸ªæœºæˆ¿é‡Œã€‚ç†è®ºä¸Šåº”è¯¥å‰¯æœ¬é—´è·¨æ•°æ®ä¸­å¿ƒæ¯”è¾ƒå¥½ï¼Œä½†æ˜¯è¿™æ ·å®ç°èµ·æ¥æ¯”è¾ƒå›°éš¾ã€‚GFSä¹Ÿåªæ˜¯è°·æ­Œå·¥ç¨‹å¸ˆå†…éƒ¨ä½¿ç”¨ã€‚</p><p>å•æ•°æ®ä¸­å¿ƒå¯èƒ½æ˜¯è·ç¦»å¸¦æ¥çš„æ€§èƒ½å½±å“ï¼Œéœ€è¦å¤§é‡é¢å¤–çš„è®¾è®¡é€»è¾‘ã€‚</p><p>GFSåœ¨å„ä¸ªæ–¹é¢å¯¹å¤§å‹çš„é¡ºåºæ–‡ä»¶è¯»å†™åšäº†å®šåˆ¶ï¼Œæ˜¯ä¸ºTBçº§åˆ«çš„æ–‡ä»¶è€Œç”Ÿï¼Œ<strong>åªæ”¯æŒé¡ºåºè®¿é—®</strong>ï¼Œä¸æ”¯æŒéšæœºè®¿é—®ã€‚æŸç§ç¨‹åº¦ä¸Šæ¥è¯´ï¼Œå®ƒæœ‰ç‚¹åƒæ‰¹å¤„ç†çš„é£æ ¼ã€‚GFSå¹¶æ²¡æœ‰èŠ±è´¹è¿‡å¤šçš„ç²¾åŠ›æ¥é™ä½å»¶è¿Ÿï¼Œå®ƒçš„å…³æ³¨ç‚¹åœ¨äºå·¨å¤§çš„ååé‡ä¸Šï¼Œå› æ­¤å•æ¬¡æ“ä½œéƒ½æ¶‰åŠåˆ°MBçº§åˆ«çš„æ•°æ®ã€‚å­˜å‚¨ç³»ç»Ÿæœ‰å•ç‹¬é’ˆå¯¹å°ä»½æ•°æ®ä¼˜åŒ–çš„ç³»ç»Ÿï¼Œä½†GFSå¹¶ä¸æ˜¯ã€‚<br>GFSè®ºæ–‡å‘è¡¨åœ¨2003å¹´çš„SOSPä¼šè®®ä¸Šï¼Œå®ƒæè¿°äº†ä¸€ä¸ªçœŸæ­£è¿è¡Œåœ¨æˆç™¾ä¸Šåƒå°è®¡ç®—æœºä¸Šçš„ç³»ç»Ÿï¼Œè§„æ¨¡è¿œå¤§äºå­¦æœ¯ç•Œã€‚åæ˜ äº†å·¥ä¸šç•Œå¯¹äºä¿éšœç³»ç»Ÿæ­£å¸¸å·¥ä½œå’ŒèŠ‚çœæˆæœ¬çš„ç»éªŒã€‚è®ºæ–‡ä¹Ÿæå‡ºäº†ä¸€ä¸ªå½“æ—¶éå¸¸å¼‚ç±»çš„è§‚ç‚¹ï¼šå­˜å‚¨ç³»ç»Ÿå…·æœ‰å¼±ä¸€è‡´æ€§ä¹Ÿæ˜¯å¯ä»¥çš„ï¼ŒGFSå¹¶ä¸ä¿è¯è¿”å›æ­£ç¡®çš„æ•°æ®ï¼Œå…¶ç›®æ ‡æ˜¯æä¾›æ›´å¥½çš„æ€§èƒ½ã€‚å­¦æœ¯è®ºæ–‡åšå¤šæ˜¯å¤šä¸ªMasterèŠ‚ç‚¹å…±åŒåˆ†æ‹…å·¥ä½œï¼Œä½†GFSå´ä½¿ç”¨å•ä¸ªMasterèŠ‚ç‚¹ï¼ˆActive-Standbyæ¨¡å¼ï¼Œåªæœ‰ä¸€ä¸ªMasterèŠ‚ç‚¹åœ¨å·¥ä½œï¼‰ã€‚</p><p>å­¦ç”Ÿæé—®ï¼šå¦‚æœGFSè¿”å›é”™è¯¯çš„æ•°æ®ï¼Œä¼šä¸ä¼šå½±å“åº”ç”¨ç¨‹åºï¼Ÿ<br>Robertæ•™æˆï¼šå¦‚æœä½ é€šè¿‡æœç´¢å¼•æ“åšæœç´¢ï¼Œ20000ä¸ªæœç´¢ç»“æœä¸­ä¸¢å¤±äº†ä¸€æ¡æˆ–è€…æœç´¢ç»“æœæ’åºæ˜¯é”™è¯¯çš„ï¼Œæ²¡æœ‰äººä¼šæ³¨æ„åˆ°è¿™äº›ã€‚å°½ç®¡GFSå¯èƒ½ä¼šè¿”å›é”™è¯¯çš„æ•°æ®ï¼Œä½†æ˜¯å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­åšä¸€äº›è¡¥å¿ã€‚ä¾‹å¦‚è®ºæ–‡ä¸­æåˆ°ï¼Œåº”ç”¨ç¨‹åºåº”å½“å¯¹æ•°æ®åšæ ¡éªŒï¼Œå¹¶æ˜ç¡®æ ‡è®°æ•°æ®çš„è¾¹ç•Œï¼Œè¿™æ ·åº”ç”¨ç¨‹åºåœ¨GFSè¿”å›ä¸æ­£ç¡®æ•°æ®æ—¶å¯ä»¥æ¢å¤ã€‚</p><p>å…³äºè¿™ä¸ªé—®é¢˜ï¼Œåé¢å…³äºspannerç­‰åŸºäºGFSçš„ç³»ç»Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç­”æ¡ˆã€‚</p><h4 id="3-5-Master-Data"><a href="#3-5-Master-Data" class="headerlink" title="3.5 Master Data"></a>3.5 Master Data</h4><p>äº†è§£ç³»ç»Ÿå¦‚ä½•å®¹é”™ä»¥åŠä¸€è‡´æ€§ï¼Œå°±éœ€è¦çŸ¥é“masterå­˜æ”¾çš„æ•°æ®ã€‚</p><ul><li><strong>ä¸€ä¸ªmasterèŠ‚ç‚¹ï¼ŒActive-Standbyæ¨¡å¼ï¼Œåªæœ‰ä¸€ä¸ªMasterèŠ‚ç‚¹åœ¨å·¥ä½œï¼Œ</strong>ç”¨æ¥ç®¡ç†æ–‡ä»¶å’ŒChunkçš„ä¿¡æ¯</li><li>ä¸Šç™¾ä¸ªå®¢æˆ·ç«¯</li><li>å¤§é‡ChunkæœåŠ¡å™¨ï¼Œæ¯ä¸ªä¸Šé¢æœ‰1-2å—ç£ç›˜ï¼Œç”¨æ¥å­˜å‚¨å®é™…çš„æ•°æ®ã€‚</li></ul><p>MasterèŠ‚ç‚¹çŸ¥é“æ¯ä¸€ä¸ªæ–‡ä»¶å¯¹åº”çš„æ‰€æœ‰çš„Chunkçš„IDï¼Œæ¯ä¸ªChunk 64MBï¼Œå¤šä¸ªChunkå…±åŒæ„æˆäº†ä¸€ä¸ªæ–‡ä»¶ã€‚æ¯”å¦‚ä¸€ä¸ª1Gçš„æ–‡ä»¶ï¼Œå…ˆä»masterèŠ‚ç‚¹æŸ¥è¯¢å¯¹åº”çš„Chunkæ‰€åœ¨æœåŠ¡å™¨ï¼Œä¹‹åç›´æ¥ä»Chunk Serverè¯»å–å¯¹åº”çš„æ•°æ®ã€‚<br>MasterèŠ‚ç‚¹å†…ä¿å­˜çš„æ•°æ®å†…å®¹ä¸»è¦æ˜¯ä¸¤ä¸ªè¡¨å•ï¼š</p><p><img src="https://s2.loli.net/2024/07/03/6Y4QmFa9nyLXcf3.png" alt="a167415c6dd14a278e25fc8cfd3501f4[1].png"></p><ul><li>æ–‡ä»¶ååˆ°Chunk IDæˆ–è€…Chunk Handleæ•°ç»„çš„å¯¹åº”ï¼Œå³ä¸€ä¸ªæ–‡ä»¶å¯¹åº”äº†å“ªäº›ChunkIDã€‚</li><li>Chunk IDåˆ°Chunkæ•°æ®çš„å¯¹åº”å…³ç³»ã€‚è¿™é‡Œçš„æ•°æ®åˆåŒ…æ‹¬äº†ï¼š<ul><li>æ¯ä¸ªChunkå­˜å‚¨åœ¨å“ªäº›æœåŠ¡å™¨ä¸Šï¼Œå³ChunkæœåŠ¡å™¨çš„åˆ—è¡¨</li><li>æ¯ä¸ªChunkå½“å‰çš„ç‰ˆæœ¬å·ï¼Œé€šè¿‡è¿™ä¸ªé€’å¢å­—æ®µï¼Œç”¨æ¥æ ‡è¯†æœ€æ–°çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œcså¯¹åº”çš„chunkå€¼å°åˆ™è®¤ä¸ºæ•°æ®æ˜¯ä¸å‡†ç¡®çš„</li><li>ä¸»Chunkå¯¹åº”çš„æœåŠ¡å™¨ï¼Œå› ä¸ºå¯¹Chunkçš„å†™æ“ä½œéƒ½å¿…é¡»åœ¨Primary Chunk ä¸Šé¡ºåºå¤„ç†</li><li>ä¸»Chunkçš„ç§Ÿçº¦è¿‡æœŸæ—¶é—´ï¼Œä¸»Chunkåªèƒ½åœ¨ç‰¹å®šçš„ç§Ÿçº¦æ—¶é—´å†…æ‹…ä»»ä¸»Chunk</li></ul></li></ul><p>ä»¥ä¸Šæ•°æ®éƒ½å­˜æ”¾åœ¨å†…å­˜ä¸­ï¼ŒåŒæ—¶ä¼šæœ‰logä»¥åŠcheckPointå­˜æ”¾åœ¨ç£ç›˜ä¸Šï¼Œå†…å­˜ä¸­ç”¨äºå¿«é€Ÿè®¿é—®ï¼Œç£ç›˜ä¸­ç”¨äºæŒä¹…åŒ–ã€‚<br>æœ‰äº›æ•°æ®éœ€è¦å­˜åœ¨ç£ç›˜ä¸Šï¼Œè€Œæœ‰äº›ä¸ç”¨ã€‚å®ƒä»¬åˆ†åˆ«æ˜¯ï¼š</p><ul><li>Chunk Handleçš„æ•°ç»„ï¼ˆç¬¬ä¸€ä¸ªè¡¨å•ï¼‰è¦ä¿å­˜åœ¨ç£ç›˜ä¸Šï¼Œæ ‡è®°æˆNVï¼ˆnon-volatile, éæ˜“å¤±ï¼‰è¡¨ç¤ºå¯¹åº”çš„æ•°æ®ä¼šå†™å…¥åˆ°ç£ç›˜ä¸Šã€‚</li><li>ChunkæœåŠ¡å™¨åˆ—è¡¨ä¸ç”¨ä¿å­˜åˆ°ç£ç›˜ä¸Šã€‚å› ä¸ºMasterèŠ‚ç‚¹é‡å¯ä¹‹åå¯ä»¥ä¸æ‰€æœ‰çš„ChunkæœåŠ¡å™¨é€šä¿¡ï¼Œå¹¶æŸ¥è¯¢æ¯ä¸ªChunkæœåŠ¡å™¨å­˜å‚¨äº†å“ªäº›Chunkï¼Œè¿™é‡Œæ ‡è®°æˆVï¼ˆvolatileï¼‰ï¼Œ</li><li>ç‰ˆæœ¬å·è¦ä¸è¦å†™å…¥ç£ç›˜å–å†³äºGFSæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæˆ‘è®¤ä¸ºå®ƒéœ€è¦å†™å…¥ç£ç›˜</li><li>ä¸»Chunkçš„IDï¼ŒMasterèŠ‚ç‚¹é‡å¯ä¹‹åä¼šå¿˜è®°è°æ˜¯ä¸»Chunkï¼Œå®ƒåªéœ€è¦ç­‰å¾…60ç§’ç§Ÿçº¦åˆ°æœŸï¼Œé‚£ä¹ˆå®ƒçŸ¥é“å¯¹äºè¿™ä¸ªChunkæ¥è¯´æ²¡æœ‰ä¸»Chunkï¼Œè¿™ä¸ªæ—¶å€™ï¼ŒMasterèŠ‚ç‚¹å¯ä»¥å®‰å…¨æŒ‡å®šä¸€ä¸ªæ–°çš„ä¸»Chunkï¼Œè¿™é‡Œæ ‡è®°æˆVã€‚</li><li>ç±»ä¼¼çš„ï¼Œç§Ÿçº¦è¿‡æœŸæ—¶é—´ä¹Ÿä¸ç”¨å†™å…¥ç£ç›˜ï¼Œè¿™é‡Œæ ‡è®°æˆVã€‚</li></ul><p>å¦‚æœæ–‡ä»¶å†™æ»¡äº†ä¸€ä¸ª64MB Chunkï¼Œä¹‹åéœ€è¦æ–°å¢ä¸€ä¸ªChunkæˆ–è€…ç”±äºæŒ‡å®šäº†æ–°çš„ä¸»Chunkè€Œå¯¼è‡´ç‰ˆæœ¬å·æ›´æ–°ï¼ŒMasterèŠ‚ç‚¹éœ€è¦å‘ç£ç›˜ä¸­çš„Logè¿½åŠ ä¸€æ¡è®°å½•ï¼Œåˆšåˆšå‘è¿™ä¸ªæ–‡ä»¶æ·»åŠ äº†ä¸€ä¸ªæ–°çš„Chunkæˆ–è€…åˆšåˆšä¿®æ”¹äº†Chunkçš„ç‰ˆæœ¬å·ã€‚è¿™ç§æ›´æ–°éƒ½éœ€è¦è½ç›˜ï¼Œå› ä¸ºç£ç›˜æ›´æ–°é€Ÿåº¦æœ‰é™ï¼Œè¿›è€Œå½±å“masterèŠ‚ç‚¹æ›´æ–°é€Ÿåº¦ï¼Œæ‰€ä»¥è¦å°½å¯èƒ½çš„å°‘å†™å…¥æ•°æ®åˆ°ç£ç›˜ä¸­ã€‚<br>åœ¨ç£ç›˜ä¸­ç»´æŠ¤logè€Œä¸æ˜¯æ•°æ®åº“ã€‚logæ•°æ®éƒ½æ˜¯å‘åŒä¸€ä¸ªåœ°å€è¿½åŠ ï¼Œå¯ä»¥å°†æœ€è¿‘çš„å¤šä¸ªlogè®°å½•ä¸€æ¬¡æ€§çš„å†™å…¥ï¼Œè¿™æ ·åªéœ€è¦ç­‰å¾…ç£ç›˜çš„ç£ç¢Ÿæ—‹è½¬ä¸€æ¬¡ã€‚æ•°æ®åº“æœ¬è´¨ä¸Šæ¥è¯´æ˜¯æŸç§Bæ ‘ï¼ˆb-treeï¼‰æˆ–è€…hash tableã€‚å¯¹äºBæ ‘æ¥è¯´ï¼Œæ¯ä¸€ä»½æ•°æ®éƒ½éœ€è¦åœ¨ç£ç›˜ä¸­éšæœºæ‰¾ä¸ªä½ç½®å†™å…¥ã€‚<br>å½“MasterèŠ‚ç‚¹æ•…éšœé‡å¯ï¼Œå¹¶é‡å»ºå®ƒçš„çŠ¶æ€ï¼Œlogçš„æœ€å¼€å§‹å¯èƒ½æ˜¯å‡ å¹´ä¹‹å‰ï¼Œé€šè¿‡åœ¨ç£ç›˜ä¸­åˆ›å»ºä¸€äº›checkpointç‚¹ï¼Œä»logä¸­çš„æœ€è¿‘ä¸€ä¸ªcheckpointå¼€å§‹æ¢å¤ï¼Œå†é€æ¡æ‰§è¡Œä»Checkpointå¼€å§‹çš„logï¼Œæœ€åæ¢å¤è‡ªå·±çš„çŠ¶æ€ã€‚</p><h4 id="3-6-GFSè¯»æ–‡ä»¶ï¼ˆRead-File"><a href="#3-6-GFSè¯»æ–‡ä»¶ï¼ˆRead-File" class="headerlink" title="3.6 GFSè¯»æ–‡ä»¶ï¼ˆRead File)"></a>3.6 GFSè¯»æ–‡ä»¶ï¼ˆRead File)</h4><p>å®¢æˆ·ç«¯ï¼ˆæˆ–è€…åº”ç”¨ç¨‹åºï¼‰å°†file nameï¼Œoffsetï¼Œsizeå‘é€ç»™Master<br>Masteræ ¹æ®file nameä»¥åŠåç§»é‡&#x2F;64MBå°±å¯ä»¥æ‰¾åˆ°Chunk Handleï¼Œä¹‹åå°†è¿™ä¸ªchunkå¯¹åº”çš„æœåŠ¡å™¨åˆ—è¡¨å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ä¼šç¼“å­˜chunkå’ŒæœåŠ¡å™¨åˆ—è¡¨çš„å¯¹åº”å…³ç³»<br>å®¢æˆ·ç«¯ä¼šé€‰æ‹©ä¸€ä¸ªç½‘ç»œä¸Šæœ€è¿‘çš„æœåŠ¡å™¨ï¼ˆGoogleçš„æ•°æ®ä¸­å¿ƒä¸­ï¼Œå¯ä»¥ä»IPåœ°å€çš„å·®å¼‚åˆ¤æ–­ç½‘ç»œä½ç½®çš„è¿œè¿‘ï¼‰ï¼Œå¹¶å°†Chunk Handleå’Œåç§»é‡å‘é€ç»™é‚£ä¸ªChunk serverï¼Œä¹‹åè¿”å›ç»™å®¢æˆ·ç«¯æ•°æ®</p><blockquote><p>[!CAUTION]</p><p>1.åé¢åŸºäºGFSçš„åº”ç”¨å¯ä»¥çŸ¥é“ï¼Œä¸ºäº†æé«˜æ•ˆç‡ï¼Œè€Œä¸”GFSæ˜¯å¤§æ–‡ä»¶çš„ï¼Œæ‰€ä»¥ä¸€ä¸ªæ–‡ä»¶å¯èƒ½åº”ç”¨åªéœ€è¦è¯»å–å…¶ä¸­çš„ä¸€éƒ¨åˆ†æ•°æ®ï¼Œå› ä¸ºè¿™ä¸ªæ–‡ä»¶æœ¬èº«å°±è¢«åº”ç”¨ç”¨æ¥å¯¹åº”å¤šæ¡ä¸åŒçš„æ•°æ®äº†ã€‚<br>2.å¯èƒ½æœ‰ç‚¹ç»•ç»“åˆ3.5çš„å›¾å³å¯</p></blockquote><p>ChunkæœåŠ¡å™¨ä¼šåœ¨æœ¬åœ°çš„ç¡¬ç›˜ä¸Šï¼Œå°†æ¯ä¸ªChunkå­˜å‚¨æˆç‹¬ç«‹çš„Linuxæ–‡ä»¶ï¼Œå¹¶é€šè¿‡æ™®é€šçš„Linuxæ–‡ä»¶ç³»ç»Ÿç®¡ç†ï¼ŒChunkæ–‡ä»¶ä¼šæŒ‰ç…§Handleï¼ˆä¹Ÿå°±æ˜¯IDï¼‰å‘½åã€‚ChunkæœåŠ¡å™¨éœ€è¦åšçš„å°±æ˜¯æ ¹æ®æ–‡ä»¶åæ‰¾åˆ°å¯¹åº”çš„Chunkæ–‡ä»¶ï¼Œä¹‹åä»æ–‡ä»¶ä¸­è¯»å–å¯¹åº”çš„æ•°æ®æ®µï¼Œå¹¶å°†æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ã€‚<br>å­¦ç”Ÿæé—®ï¼šå¦‚æœå®¢æˆ·ç«¯æœ‰åç§»é‡ä¿¡æ¯ï¼Œé‚£å¯ä»¥ç›´æ¥ç®—å‡ºæ¥æ˜¯ç¬¬å‡ ä¸ªChunkå§ï¼Ÿ<br>Robertæ•™æˆï¼šå®¢æˆ·ç«¯å¯ä»¥ç®—å‡ºæ¥æ˜¯å“ªä¸ªChunkï¼Œä½†æ˜¯å®¢æˆ·ç«¯ä¸çŸ¥é“Chunkåœ¨å“ªä¸ªæœåŠ¡å™¨ä¸Šã€‚ä¸ºäº†è·å–æœåŠ¡å™¨ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯éœ€è¦ä¸Masteräº¤äº’ã€‚MasterèŠ‚ç‚¹æ‰¾åˆ°äº†Chunkå¯¹åº”çš„IDï¼Œå¹¶ç¡®å®šäº†Chunkå­˜å‚¨åœ¨å“ªä¸ªæœåŠ¡å™¨ä¸Šã€‚</p><p>å­¦ç”Ÿæé—®ï¼šå¦‚æœè¯»å–çš„æ•°æ®è¶…è¿‡äº†ä¸€ä¸ªChunkæ€ä¹ˆåŠï¼Ÿ<br>Robertæ•™æˆï¼šä¼šå°†ä¸€ä¸ªè¯»è¯·æ±‚æ‹†åˆ†æˆå¤šä¸ªè¯»è¯·æ±‚ï¼ˆæ–‡ä»¶å¯¹åº”çš„å¤šä¸ªchunkï¼‰å†å‘é€åˆ°MasterèŠ‚ç‚¹ï¼Œä¹‹åå†å‘ä¸¤ä¸ªä¸åŒçš„ChunkæœåŠ¡å™¨è¯»å–æ•°æ®ã€‚</p><p>å­¦ç”Ÿæé—®ï¼šèƒ½å†ä»‹ç»ä¸€ä¸‹è¯»æ•°æ®è·¨è¶Šäº†Chunkè¾¹ç•Œçš„æƒ…å†µå—ï¼Ÿ<br>Robertæ•™æˆï¼šGFSçš„åº“ä¼šå°†è¯»è¯·æ±‚æ‹†åˆ†ï¼Œä¹‹åå†å°†å®ƒä»¬åˆå¹¶èµ·æ¥ã€‚æ¯”å¦‚éœ€è¦Chunk7çš„æœ€åä¸¤ä¸ªå­—èŠ‚ï¼ŒChunk8çš„å¤´ä¸¤ä¸ªå­—èŠ‚ï¼Œè·å–åˆ°è¿™äº›æ•°æ®ä¹‹åï¼Œä¼šå°†å®ƒä»¬æ”¾åœ¨ä¸€ä¸ªbufferä¸­ï¼Œå†è¿”å›ç»™è°ƒç”¨åº“çš„åº”ç”¨ç¨‹åºã€‚MasterèŠ‚ç‚¹ä¼šå‘Šè¯‰åº“æœ‰å…³Chunkçš„ä¿¡æ¯ï¼Œè€ŒGFSåº“å¯ä»¥æ ¹æ®è¿™ä¸ªä¿¡æ¯æ‰¾åˆ°åº”ç”¨ç¨‹åºæƒ³è¦çš„æ•°æ®ã€‚åº”ç”¨ç¨‹åºåªéœ€è¦ç¡®å®šæ–‡ä»¶åå’Œæ•°æ®åœ¨æ•´ä¸ªæ–‡ä»¶ä¸­çš„åç§»é‡ï¼ŒGFSåº“å’ŒMasterèŠ‚ç‚¹å…±åŒåå•†å°†è¿™äº›ä¿¡æ¯è½¬æ¢æˆChunkã€‚</p><p>å­¦ç”Ÿæé—®ï¼šä»å“ªä¸ªChunkæœåŠ¡å™¨è¯»å–æ•°æ®é‡è¦å—ï¼Ÿ<br>Robertæ•™æˆï¼šå®é™…ä¸Šä¸åŒChunkæœåŠ¡å™¨ä¸Šçš„æ•°æ®å¹¶ä¸ä¸€å®šå®Œå…¨ç›¸åŒï¼Œåº”ç”¨ç¨‹åºåº”è¯¥è¦èƒ½å¤Ÿå®¹å¿è¿™ç§æƒ…å†µã€‚å¦‚æœä»ä¸åŒçš„ChunkæœåŠ¡å™¨è¯»å–æ•°æ®ï¼Œå¯èƒ½ä¼šç•¥å¾®ä¸åŒã€‚GFSè®ºæ–‡æåˆ°ï¼Œå®¢æˆ·ç«¯ä¼šå°è¯•ä»åŒä¸€ä¸ªæœºæ¶æˆ–è€…åŒä¸€ä¸ªäº¤æ¢æœºä¸Šçš„æœåŠ¡å™¨è¯»å–æ•°æ®ã€‚</p><h4 id="3-7-GFSå†™æ–‡ä»¶ï¼ˆWrite-Fileï¼‰"><a href="#3-7-GFSå†™æ–‡ä»¶ï¼ˆWrite-Fileï¼‰" class="headerlink" title="3.7 GFSå†™æ–‡ä»¶ï¼ˆWrite Fileï¼‰"></a>3.7 GFSå†™æ–‡ä»¶ï¼ˆWrite Fileï¼‰</h4><p>ä»åº”ç”¨ç¨‹åºçš„è§’åº¦æ¥çœ‹ï¼Œå†™æ–‡ä»¶å’Œè¯»æ–‡ä»¶çš„æ¥å£éƒ½æ˜¯è°ƒç”¨GFSçš„åº“ã€‚å¯¹äºå†™æ–‡ä»¶ï¼Œå®¢æˆ·ç«¯ä¼šå‘MasterèŠ‚ç‚¹å‘é€è¯·æ±‚è¯´ï¼šæˆ‘æƒ³å‘è¿™ä¸ªæ–‡ä»¶åå¯¹åº”çš„æ–‡ä»¶è¿½åŠ æ•°æ®ï¼Œè¯·å‘Šè¯‰æˆ‘æ–‡ä»¶ä¸­æœ€åä¸€ä¸ªChunkçš„ä½ç½®ï¼Œè¿™é‡Œå³ä¸ºè®°å½•è¿½åŠ ï¼ˆRecord Appendï¼‰ã€‚</p><p>å®¢æˆ·ç«¯æ ¹æ®æ–‡ä»¶åè¯·æ±‚masterï¼Œè·å–chunkIDï¼ˆè¿™é‡Œè‚¯å®šæ˜¯æœ€åä¸€ä¸ªï¼Œå½“ç„¶å¦‚æœæ˜¯æ–°æ–‡ä»¶ç¬¬ä¸€ä¸ªchunkIDä¹Ÿæ˜¯æœ€åä¸€ä¸ªï¼‰ï¼Œä»¥åŠå¯¹åº”çš„æœåŠ¡å™¨åˆ—è¡¨ï¼Œè¿›è€Œèƒ½å¤Ÿå¾€primary chunkå†™æ–‡ä»¶ã€‚</p><p>ä¸åŒå®¢æˆ·ç«¯å†™åŒä¸€ä»½æ—¥å¿—æ–‡ä»¶ï¼Œæ²¡æœ‰ä¸€ä¸ªå®¢æˆ·ç«¯ä¼šçŸ¥é“æ–‡ä»¶ç©¶ç«Ÿæœ‰å¤šé•¿ï¼Œå› æ­¤ä¹Ÿå°±ä¸çŸ¥é“è¯¥å¾€ä»€ä¹ˆæ ·çš„åç§»é‡ï¼Œæˆ–è€…è¯´å‘å“ªä¸ªChunkå»è¿½åŠ æ•°æ®ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå®¢æˆ·ç«¯å¯ä»¥å‘MasterèŠ‚ç‚¹æŸ¥è¯¢å“ªä¸ªChunkæœåŠ¡å™¨ä¿å­˜äº†æ–‡ä»¶çš„æœ€åä¸€ä¸ªChunkã€‚</p><p>è¿™é‡Œæœ‰å¾ˆå¤šç»†èŠ‚å†²çªé—®é¢˜ï¼Œè¯¦è§ä¸‹æ–‡åŠ3.8<br>å¹¶å‘é‡å¾ˆé«˜çš„æƒ…å†µä¸‹ï¼Œè¿”å›äº†æœ€åä¸€ä¸ªchunkï¼Œä½†æ˜¯æ­¤æ—¶åˆè¢«å†™æ»¡äº†ï¼Œè¿™ä¸ªå·²ç»ä¸æ˜¯æœ€åä¸€ä¸ªäº†ï¼Ÿè¿™ä¸ªåº”è¯¥æ˜¯é¦–å…ˆä¼šç­‰clientå‘é€çš„æ‰€æœ‰æ•°æ®åˆ°è¾¾ä¹‹åå¼€å§‹å†™ï¼Œè¿™æ—¶å€™chunkå‘ç°æ²¡æœ‰è¶³å¤Ÿç©ºé—´äº†ï¼Œä¼šè¿”å›å®¢æˆ·ç«¯é”™è¯¯<br>æ˜¯ä¸æ˜¯æ–°çš„chunkéƒ½æ˜¯é€šè¿‡masteræŒ‡å®šçš„ï¼Ÿåº”è¯¥æ˜¯çš„ï¼Œä¹‹åæ”¾åœ¨æ–‡ä»¶å¯¹åº”çš„chunk listé‡Œ</p><p><strong>å†™Primary Chunk</strong><br>å†™æ–‡ä»¶å¿…é¡»å†™ä¸»å‰¯æœ¬ï¼Œé€šè¿‡masterè·å–chunkå¯¹åº”çš„æœåŠ¡å™¨åˆ—è¡¨ä¸­çš„ä¸»å‰¯æœ¬ä¿¡æ¯ã€‚ä½†æœ‰æ—¶Masterä¸ä¸€å®šæŒ‡å®šäº†Chunkçš„ä¸»å‰¯æœ¬ï¼Œå› æ­¤éœ€è¦è€ƒè™‘Chunkçš„ä¸»å‰¯æœ¬ä¸å­˜åœ¨çš„æƒ…å†µã€‚å¯¹äºè¯»æ–‡ä»¶æ¥è¯´ï¼Œå¯ä»¥ä»ä»»ä½•æœ€æ–°çš„Chunkå‰¯æœ¬è¯»å–æ•°æ®ã€‚<br>MasterèŠ‚ç‚¹éœ€è¦å‘Šè¯‰å®¢æˆ·ç«¯å‘å“ªä¸ªChunkæœåŠ¡å™¨ï¼ˆä¹Ÿå°±æ˜¯Primary Chunkæ‰€åœ¨çš„æœåŠ¡å™¨ï¼‰å»åšè¿½åŠ æ“ä½œï¼ŒMasterèŠ‚ç‚¹çš„éƒ¨åˆ†å·¥ä½œå°±æ˜¯å¼„æ¸…æ¥šåœ¨è¿½åŠ æ–‡ä»¶æ—¶ï¼Œå®¢æˆ·ç«¯åº”è¯¥ä¸å“ªä¸ªChunkæœåŠ¡å™¨é€šä¿¡ã€‚</p><p><strong>No Primary é€‰ä¸»çš„é€»è¾‘</strong></p><ol><li><p>ä¼šæ‰¾å‡ºæ‰€æœ‰å­˜æœ‰Chunkæœ€æ–°å‰¯æœ¬çš„ChunkæœåŠ¡å™¨ï¼Œå› ä¸ºæŸä¸ªå‰¯æœ¬å¯èƒ½å› ä¸ºå®•æœºå°šæœªæ›´æ–°æ•°æ®</p></li><li><p>æ‰¾å‡ºæ–°çš„Chunkå‰¯æœ¬ã€‚æœ€æ–°çš„å‰¯æœ¬æ˜¯æŒ‡å‰¯æœ¬ä¸­ä¿å­˜çš„ç‰ˆæœ¬å·ä¸Masterä¸­è®°å½•çš„Chunkçš„ç‰ˆæœ¬å·ä¸€è‡´ã€‚Chunkå‰¯æœ¬ä¸­çš„ç‰ˆæœ¬å·æ˜¯ç”±MasterèŠ‚ç‚¹ä¸‹å‘çš„ï¼ŒMasterèŠ‚ç‚¹çŸ¥é“ï¼Œå¯¹äºä¸€ä¸ªç‰¹å®šçš„Chunkï¼Œå“ªä¸ªç‰ˆæœ¬å·æ˜¯æœ€æ–°çš„ã€‚</p><ol><li><p>Masteræ‰¾åˆ°æœ€æ–°çš„å‰¯æœ¬</p></li><li><p>é€‰ä¸€ä¸ªä½œä¸ºPrimaryï¼Œå…¶ä»–çš„ä½œä¸ºSecondary</p></li><li><p>Masterä¼šå¢åŠ ç‰ˆæœ¬å·</p></li><li><p>MasterèŠ‚ç‚¹ä¼šå‘Primaryå’ŒSecondaryå‰¯æœ¬å¯¹åº”çš„æœåŠ¡å™¨å‘é€æ¶ˆæ¯å‘ŠçŸ¥ä¸»å¤‡å…³ç³»ã€æœ€æ–°ç‰ˆæœ¬å·â€“&gt;Lease</p><p>masteræŒä¹…åŒ–ç‰ˆæœ¬å·</p></li><li><p>2.båº”è¯¥æ˜¯masterå‘chunkçš„ä¸»å‰¯æœ¬å‘æ”¾leaseï¼Œå¢åŠ ç‰ˆæœ¬å·</p></li></ol></li></ol><p>å‡ ç‚¹è¯´æ˜ï¼š</p><ul><li>masteré€šè¿‡ç‰ˆæœ¬å·åŒºåˆ«æ­£å¸¸å‰¯æœ¬å’Œæ•°æ®è½åçš„å‰¯æœ¬ï¼ŒåŒæ—¶masteré‡å¯ä¹‹åï¼Œä¾ç„¶å¯ä»¥é€šè¿‡ç‰ˆæœ¬å·åŒºåˆ†å‰¯æœ¬çš„æƒ…å†µã€‚</li><li>masterä¼šç»™primaryä¸€ä¸ª60sçš„ç§Ÿçº¦ï¼ˆ60sä¹‹ååœæ­¢æˆä¸ºprimaryï¼‰ï¼ŒæŒæœ‰ç§Ÿçº¦æ‰èƒ½å¤Ÿæ˜¯primaryï¼Œè¿™ç§æœºåˆ¶å¯ä»¥ç¡®ä¿æˆ‘ä»¬ä¸ä¼šåŒæ—¶æœ‰ä¸¤ä¸ªPrimaryã€‚</li></ul><blockquote><p>[!CAUTION]</p><p>è¿™é‡Œçš„60sï¼Œåé¢å¯ä»¥é€šè¿‡å’Œmasteré€šä¿¡è·å¾—å»¶æœŸï¼Œå®é™…ä¸Š3ä¸ªå‰¯æœ¬ä¸­çš„primaryæ˜¯masterè¯´äº†ç®—</p></blockquote><p>å­¦ç”Ÿæé—®ï¼šä¸ºä»€ä¹ˆä¸å°†æ‰€æœ‰ChunkæœåŠ¡å™¨ä¸Šä¿å­˜çš„æœ€å¤§ç‰ˆæœ¬å·ä½œä¸ºChunkçš„æœ€æ–°ç‰ˆæœ¬å·ï¼Ÿ<br>Robertæ•™æˆï¼šmasteré‡å¯ä¹‹åï¼Œå¯¹äºæ¯ä¸€ä¸ªchunkï¼Œæ±‡æ€»å…¶å„å‰¯æœ¬çš„ç‰ˆæœ¬å·ï¼Œä½†æ˜¯æ— æ³•ç¡®è®¤å½“å‰æœ€å¤§çš„å°±æ˜¯æœ€æ–°çš„ï¼Œå¯èƒ½æœ€æ–°çš„å¹¶æœªå¯åŠ¨ã€‚å½“Masteræ‰¾ä¸åˆ°æŒæœ‰æœ€æ–°Chunkçš„æœåŠ¡å™¨æ—¶ï¼Œæœ‰ä¸¤ç§å¯èƒ½ï¼šè¦ä¹ˆMasterä¼šç­‰å¾…ï¼Œå¹¶ä¸å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼›è¦ä¹ˆä¼šè¿”å›ç»™å®¢æˆ·ç«¯ç°åœ¨è¿˜ä¸çŸ¥é“Chunkåœ¨å“ªï¼Œè¿‡ä¼šå†é‡è¯•å§ã€‚æ¯”å¦‚æœºæˆ¿æ–­ç”µå¯¼è‡´æœåŠ¡å™¨å¤§è§„æ¨¡é‡å¯ï¼Œè¿™æ—¶åªèƒ½ç­‰å¾…ï¼Œå› ä¸ºä¸ä¼šæƒ³ä½¿ç”¨Chunkçš„æ—§æ•°æ®ã€‚</p><blockquote><ol><li>é€šè¿‡ç‰ˆæœ¬å·åŒ¹é…ï¼Œç¡®è®¤æœ€æ–°çš„chunkç‰ˆæœ¬ï¼Œè¿™é‡Œæœ‰ä¸¤ç‚¹æ€è€ƒï¼Œ1ï¼‰åº”è¯¥æ˜¯å¹¶æœªä¿å­˜å½“å‰çš„å‰¯æœ¬éƒ½æœ‰å“ªäº›èŠ‚ç‚¹ï¼Œå…¨é ä¸ŠæŠ¥ï¼Œå½“ç„¶è¿™é‡Œæ˜¯å¯ä»¥ç®€å•ä¼˜åŒ–çš„2ï¼‰é€šè¿‡ç‰ˆæœ¬å·ç¡®å®šæœ€æ–°çš„ï¼Œç¬¬äºŒä¸ªæœ‰ç‚¹ç±»ä¼¼rafté€‰ä¸»ï¼Œæœ€æ–°çš„termå¯ä»¥æˆä¸ºleader</li><li>å› ä¸ºè‚¯å®šä¸æƒ³ä½¿ç”¨æ—§æ•°æ®ï¼Œæ‰€ä»¥åªèƒ½ç­‰å¾…æœ€æ–°ç‰ˆæœ¬çš„chunkä¸Šçº¿</li><li>ä¸€ä¸ªæ€è€ƒï¼šè¿™ç§é€šè¿‡åˆ«äººé€‰ä¸»å’Œraftå‰¯æœ¬ä¹‹é—´è‡ªå·±é€‰ä¸»çš„åŒºåˆ«è”ç³»ä¼˜åŠ£ï¼Ÿ</li></ol></blockquote><p>å­¦ç”Ÿæé—®ï¼šå¦‚æœChunkæœåŠ¡å™¨ä¸ŠæŠ¥çš„ç‰ˆæœ¬å·é«˜äºMasterå­˜å‚¨çš„ç‰ˆæœ¬å·ä¼šæ€ä¹ˆæ ·ï¼Ÿ<br>Robertæ•™æˆï¼šGFSè®ºæ–‡è¯´ï¼Œchunk serverä¸ŠæŠ¥äº†ä¸€ä¸ªæ¯”Masterè®°ä½çš„ç‰ˆæœ¬æ›´é«˜çš„chunkç‰ˆæœ¬ã€‚Masterä¼šè®¤ä¸ºå®ƒåœ¨åˆ†é…æ–°çš„PrimaryæœåŠ¡å™¨æ—¶å‡ºç°äº†é”™è¯¯ï¼Œå¹¶ä¸”ä¼šä½¿ç”¨è¿™ä¸ªæ›´é«˜çš„ç‰ˆæœ¬å·æ¥ä½œä¸ºChunkçš„æœ€æ–°ç‰ˆæœ¬å·ã€‚å½“Masterå‘Primaryå’ŒSecondaryå‘é€å®Œæ¶ˆæ¯ä¹‹åå°±å´©æºƒäº†ï¼Œå¯èƒ½ä¼šå‡ºç°ä¸Šé¢è¿™ç§æƒ…å†µã€‚ä¸ºäº†è®©Masterèƒ½å¤Ÿå¤„ç†è¿™ç§æƒ…å†µï¼ŒMasteråœ¨å‘é€å®Œæ¶ˆæ¯ä¹‹åï¼Œéœ€è¦å°†Chunkçš„æœ€æ–°ç‰ˆæœ¬å†™å…¥åˆ°ç£ç›˜ä¸­ã€‚è¿™é‡Œçš„å†™å…¥æˆ–è®¸éœ€è¦ç­‰åˆ°Primaryå’ŒSecondaryè¿”å›ç¡®è®¤æ¶ˆæ¯ä¹‹åã€‚æˆ‘ï¼ˆRobertæ•™æˆï¼‰ä¹Ÿä¸å¤ªç¡®å®šMasterç©¶ç«Ÿæ˜¯å…ˆå†™æœ¬åœ°ç£ç›˜ä¸­çš„ç‰ˆæœ¬å·ï¼Œç„¶åå†é€šçŸ¥Primaryå’ŒSecondaryï¼Œè¿˜æ˜¯åè¿‡æ¥ã€‚ä½†æ˜¯ä¸ç®¡æ€ä¹ˆæ ·ï¼ŒMasterä¼šæ›´æ–°è‡ªå·±çš„ç‰ˆæœ¬å·ï¼Œå¹¶é€šçŸ¥Primaryå’ŒSecondaryè¯´ï¼Œä½ ä»¬ç°åœ¨æ˜¯Primaryå’ŒSecondaryï¼Œå¹¶ä¸”ç‰ˆæœ¬å·æ›´æ–°äº†ã€‚</p><p>æ„Ÿè§‰æ˜¯è¦ç­‰chunkçš„å‰¯æœ¬ç¡®è®¤ç‰ˆæœ¬å·ä¹‹åï¼Œmasteræ‰èƒ½æŒä¹…åŒ–æ›´æ–°chunkIDï¼Œä¿éšœmasterçš„ç‰ˆæœ¬å·æ°¸è¿œä¸ä¼šå¤§äºchunkçš„ï¼Œä¸ç„¶æ°¸è¿œæ‰¾ä¸åˆ°æœ€æ–°çš„äº†ã€‚åŒæ ·ï¼Œè¿™ç§æƒ…å†µæ‰ä¼šå‡ºç°chunkæœ€æ–°ç‰ˆæœ¬å·æ›´é«˜çš„é—®é¢˜ã€‚ç£ç›˜æ•…éšœä»€ä¹ˆçš„é™¤å¤–ã€‚</p><p><strong>Primaryå†™</strong></p><ol><li>å®¢æˆ·ç«¯æ ¹æ®æ–‡ä»¶åä»masterè·å–åˆ°äº†æœ€åä¸€ä¸ªchunkIDä»¥åŠå¯¹åº”çš„ChunkServeråŠå…¶ä¸­çš„primary</li><li>å®¢æˆ·ç«¯å‘é€è¦è¿½åŠ çš„æ•°æ®</li><li>chunkServerä¼šå°†æ•°æ®å†™å…¥ä¸´æ—¶ä½ç½®ï¼Œå¹¶ä¸ä¼šç›´æ¥è¿½åŠ åˆ°æ–‡ä»¶ä¸­ï¼Œ</li><li>å½“æ‰€æœ‰çš„æœåŠ¡å™¨éƒ½è¿”å›ç¡®è®¤æ¶ˆæ¯è¯´ï¼Œå·²ç»æœ‰äº†è¦è¿½åŠ çš„æ•°æ®ï¼Œå®¢æˆ·ç«¯ä¼šå‘PrimaryæœåŠ¡å™¨å‘é€ä¸€æ¡æ¶ˆæ¯è¯´ï¼Œä½ å’Œæ‰€æœ‰çš„SecondaryæœåŠ¡å™¨éƒ½æœ‰äº†è¦è¿½åŠ çš„æ•°æ®ï¼Œç°åœ¨æˆ‘æƒ³å°†è¿™ä¸ªæ•°æ®è¿½åŠ åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­</li><li>Primaryä¼šæŸ¥çœ‹å½“å‰æ–‡ä»¶ç»“å°¾çš„Chunkï¼Œå¹¶ç¡®ä¿Chunkä¸­æœ‰è¶³å¤Ÿçš„å‰©ä½™ç©ºé—´ï¼Œç„¶åå°†å®¢æˆ·ç«¯è¦è¿½åŠ çš„æ•°æ®å†™å…¥Chunkçš„æœ«å°¾ï¼ŒåŒæ—¶ä¹Ÿä¼šå°†offsetå‘é€ç»™Secondaryæ‰§è¡Œè¿½åŠ </li><li>Secondaryè¿”å›æˆåŠŸç»™primary</li><li>primaryæ”¶åˆ°æ‰€æœ‰æˆåŠŸå›å¤ï¼Œä¼šå‘å®¢æˆ·ç«¯è¿”å›å†™å…¥æˆåŠŸï¼Œå¦‚æœæœ‰ä¸€ä¸ªæœåŠ¡å™¨å†™å¤±è´¥æˆ–è€…è¶…æ—¶ï¼Œä¼šå‘å®¢æˆ·ç«¯è¿”å›å†™å…¥å¤±è´¥</li></ol><p>å‡ ç‚¹è¯´æ˜ï¼š</p><ul><li>PrimaryæœåŠ¡å™¨æˆ–è®¸ä¼šä»å¤§é‡å®¢æˆ·ç«¯æ”¶åˆ°å¤§é‡çš„å¹¶å‘è¯·æ±‚ï¼ŒPrimaryæœåŠ¡å™¨ä¼šä»¥æŸç§é¡ºåºï¼Œä¸€æ¬¡åªæ‰§è¡Œä¸€ä¸ªè¯·æ±‚ã€‚</li><li>å¯¹äºSecondaryæœåŠ¡å™¨æ¥è¯´ï¼Œå¯èƒ½ä¼šæ‰§è¡Œå¤±è´¥ï¼Œæ¯”å¦‚è¯´ç½‘ç»œä¸¢åŒ…ï¼Œç£ç›˜ç©ºé—´ä¸è¶³ï¼Œå‘ç”Ÿæ•…éšœ</li><li>å¦‚æœå®¢æˆ·ç«¯ä»Primaryå¾—åˆ°å†™å…¥å¤±è´¥ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯åº”è¯¥é‡æ–°å‘èµ·æ•´ä¸ªè¿½åŠ è¿‡ç¨‹ï¼Œå®¢æˆ·ç«¯é¦–å…ˆä¼šé‡æ–°ä¸Masteräº¤äº’ï¼Œæ‰¾åˆ°æ–‡ä»¶æœ«å°¾çš„Chunk</li></ul><blockquote><ol><li>primaryæ§åˆ¶å†™å…¥çš„offset</li><li>è¿™é‡Œè¦æ±‚ä¸‰å‰¯æœ¬éƒ½å†™æˆåŠŸæ‰èƒ½è¿”å›ç»™å®¢æˆ·ç«¯æˆåŠŸï¼Œä¹‹åå®¢æˆ·ç«¯å¯ä»¥ç›´æ¥å°±è¿‘è¯»å–</li><li>åªè¦å†™å¤±è´¥ï¼Œå®¢æˆ·ç«¯éƒ½è¦é‡æ–°è¯·æ±‚masterï¼Œå› ä¸ºå¤±è´¥åŸå› å¤šå¤šéš¾ä»¥é¢„æ–™ï¼Œä¿é™©èµ·è§ç›´æ¥é‡æ–°èµ°æµç¨‹</li></ol></blockquote><p><strong>å…³äºmasteræŒ‡å®šprimary ä»¥åŠç‰ˆæœ¬å·çš„é—®ç­”</strong></p><ul><li><p><strong>ä»€ä¹ˆæ—¶å€™ç‰ˆæœ¬å·ä¼šå¢åŠ ï¼Ÿ</strong></p><p>Robertæ•™æˆï¼šç‰ˆæœ¬å·<strong>åªåœ¨MasterèŠ‚ç‚¹è®¤ä¸ºChunkæ²¡æœ‰Primaryæ—¶æ‰ä¼šå¢åŠ </strong>ã€‚åœ¨ä¸€ä¸ªæ­£å¸¸çš„æµç¨‹ä¸­ï¼Œå¦‚æœå¯¹äºä¸€ä¸ªChunkæ¥è¯´ï¼Œå·²ç»å­˜åœ¨äº†Primaryï¼Œé‚£ä¹ˆMasterèŠ‚ç‚¹ä¼šè®°ä½å·²ç»æœ‰ä¸€ä¸ªPrimaryå’Œä¸€äº›Secondaryï¼ŒMasterä¸ä¼šé‡æ–°é€‰æ‹©Primaryï¼Œä¹Ÿä¸ä¼šå¢åŠ ç‰ˆæœ¬å·ã€‚å®ƒåªä¼šå‘Šè¯‰å®¢æˆ·ç«¯è¯´è¿™æ˜¯Primaryï¼Œå¹¶ä¸ä¼šå˜æ›´ç‰ˆæœ¬å·ã€‚</p></li><li><p>å¦‚æœ<strong>MasterèŠ‚ç‚¹å‘ç°PrimaryæŒ‚äº†ä¼šæ€ä¹ˆåŠ</strong>ï¼Ÿ</p><p>Robertæ•™æˆï¼šMasteræŒ‡å®šäº†ä¸€ä¸ªPrimaryï¼Œå¦‚æœä¹‹åpingä¸é€šï¼Œå¹¶ä¸ä¼šç«‹å³é€‰ä¸»ï¼Œå› ä¸ºè¿™é‡Œå¯èƒ½æ˜¯å¤šç§åŸå› å¯¼è‡´ä¸€ä¸¤æ¬¡ä¸é€šï¼Œæ›´ä¸»è¦æ˜¯è¿™æ ·ä¼šå¯¼è‡´åŒæ—¶å­˜ åœ¨ä¸¤ä¸ªprimaryï¼ˆä»å®¢æˆ·ç«¯çš„è§†è§’ï¼Œå®¢æˆ·ç«¯1è®¤ä¸ºAæ˜¯ä¸»ï¼Œåé¢çš„å®¢æˆ·ç«¯2è®¤ä¸ºBæ˜¯ä¸»ï¼‰ï¼Œä¼šåˆ†åˆ«å¤„ç†ä¸åŒçš„å†™è¯·æ±‚ï¼Œæœ€ç»ˆä¼šå¯¼è‡´æœ‰ä¸¤ä¸ªä¸åŒçš„æ•°æ®æ‹·è´ã€‚è¿™è¢«ç§°ä¸º<strong>è„‘è£‚ï¼ˆsplit-brainï¼‰ï¼Œé€šå¸¸æ˜¯ç”±ç½‘ç»œåˆ†åŒºå¼•èµ·çš„ï¼Œæ¯”å¦‚è¯´Masteræ— æ³•ä¸Primaryé€šä¿¡ï¼Œä½†æ˜¯Primaryåˆå¯ä»¥ä¸å®¢æˆ·ç«¯é€šä¿¡ï¼Œè¿™å°±æ˜¯ä¸€ç§ç½‘ç»œåˆ†åŒºé—®é¢˜ï¼Œç½‘ç»œæ•…éšœæ˜¯è¿™ç±»åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿä¸­æœ€éš¾å¤„ç†çš„é—®é¢˜ä¹‹ä¸€ã€‚</strong>è¦é¿å…é”™è¯¯çš„ä¸ºåŒä¸€ä¸ªChunkæŒ‡å®šä¸¤ä¸ªPrimaryçš„å¯èƒ½æ€§ã€‚Masteré‡‡å–çš„æ–¹å¼æ˜¯ï¼Œå½“æŒ‡å®šä¸€ä¸ªPrimaryæ—¶ï¼Œä¸ºå®ƒåˆ†é…ä¸€ä¸ªç§Ÿçº¦ï¼ŒPrimaryåªåœ¨ç§Ÿçº¦å†…æœ‰æ•ˆã€‚Masterå’ŒPrimaryéƒ½ä¼šçŸ¥é“å¹¶è®°ä½ç§Ÿçº¦æœ‰å¤šé•¿ï¼Œå½“ç§Ÿçº¦è¿‡æœŸäº†ï¼ŒPrimaryä¼šåœæ­¢å“åº”å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå®ƒä¼šå¿½ç•¥æˆ–è€…æ‹’ç»å®¢æˆ·ç«¯è¯·æ±‚ã€‚å¦‚æœMasterä¸èƒ½ä¸Primaryé€šä¿¡ï¼Œå¹¶ä¸”æƒ³è¦æŒ‡å®šä¸€ä¸ªæ–°çš„Primaryæ—¶ï¼ŒMasterä¼šç­‰åˆ°å‰ä¸€ä¸ªPrimaryçš„ç§Ÿçº¦åˆ°æœŸã€‚æ‰€ä»¥masterå¿…é¡»ç­‰åˆ°ç§Ÿçº¦åˆ°æœŸä¹‹åï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿ä¸ä¼šå‡ºç°è¿™ç§è„‘è£‚æƒ…å†µã€‚</p></li></ul><p>è¿™é‡Œçš„ç§Ÿçº¦ï¼Œè‚¯å®šä¸èƒ½ç”¨ç³»ç»Ÿæ—¶é—´ï¼Œå¦‚æœç”¨å€’è®¡æ—¶çš„è¯ï¼Œæ˜¯å¦éœ€è¦è€ƒè™‘ç½‘ç»œä¸ŠèŠ±è´¹çš„æ—¶é—´ï¼Ÿæ¯”å¦‚masteræŒ‡å®šprimaryä¹‹åå°±å¼€å§‹è®¡æ—¶ï¼Œæˆ–è€…æ”¶åˆ°primaryçš„å“åº”ä¹‹åå¼€å§‹ï¼Œæ€»ä¹‹masterå’ŒæŒ‡å®šçš„primaryå¿…æœ‰å…ˆåã€‚å¥½åƒleaseçš„è¯ï¼Œä¸€èˆ¬ä¼šåœ¨å—åˆ°æœŸçš„å‰å‡ ç§’æ—¶é—´å°±ç«‹å³å‘é€æ¶ˆæ¯ï¼Œè¿›è¡Œç»­ç§Ÿã€‚ä½†æ˜¯è¿‡æœŸçš„åˆ¤æ–­æ˜¯å¦ä¹ŸåŠ ä¸Šè¿™ä¸ªï¼ŸåŠ ä¸Šè¿™ä¸ªæ˜¯å¦å¸¦æ¥å»¶è¿Ÿã€‚</p><p><strong>å…³äºå†™å…¥çš„é—®ç­”</strong><br>å¦‚æœæ˜¯å¯¹ä¸€ä¸ªæ–°çš„æ–‡ä»¶è¿›è¡Œè¿½åŠ ï¼Œé‚£è¿™ä¸ªæ–°çš„æ–‡ä»¶æ²¡æœ‰å‰¯æœ¬ï¼Œä¼šæ€æ ·ï¼Ÿ<br>Robertæ•™æˆï¼šMasterèŠ‚ç‚¹æˆ–è®¸ä¼šé€šè¿‡éšæœºæ•°ç”Ÿæˆå™¨åˆ›é€ ä¸€ä¸ªæ–°çš„Chunk IDã€‚ä¹‹åMasterèŠ‚ç‚¹ä¼šåˆ›å»ºä¸€æ¡æ–°çš„Chunkè®°å½•ï¼Œå†éšæœºé€‰æ‹©ä¸€ä¸ªPrimaryå’Œä¸€ç»„Secondaryå¹¶å‘Šè¯‰å®ƒä»¬ï¼Œä½ ä»¬å°†å¯¹è¿™ä¸ªç©ºçš„Chunkè´Ÿè´£ï¼Œè¯·å¼€å§‹å·¥ä½œã€‚</p><p>å†™æ–‡ä»¶å¤±è´¥ä¹‹åPrimaryå’ŒSecondaryæœåŠ¡å™¨ä¸Šçš„çŠ¶æ€å¦‚ä½•æ¢å¤ï¼Ÿ<br>Robertæ•™æˆï¼šPrimaryä¼šå›å¤å®¢æˆ·ç«¯è¯´æ‰§è¡Œå¤±è´¥ï¼Œéƒ¨åˆ†å‰¯æœ¬è¿˜æ˜¯æˆåŠŸå°†æ•°æ®è¿½åŠ äº†ã€‚ä¸€ä¸ªChunkçš„éƒ¨åˆ†å‰¯æœ¬æˆåŠŸå®Œæˆäº†æ•°æ®è¿½åŠ ï¼Œè€Œå¦ä¸€éƒ¨åˆ†æ²¡æœ‰æˆåŠŸï¼Œè¿™ç§çŠ¶æ€æ˜¯å¯æ¥å—çš„ï¼Œæ²¡æœ‰ä»€ä¹ˆéœ€è¦æ¢å¤ï¼Œè¿™å°±æ˜¯GFSçš„å·¥ä½œæ–¹å¼ã€‚</p><p>å†™æ–‡ä»¶å¤±è´¥ä¹‹åï¼Œè¯»Chunkæ•°æ®ä¼šæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ<br>Robertæ•™æˆï¼šå¦‚æœå†™æ–‡ä»¶å¤±è´¥ä¹‹åï¼Œä¸€ä¸ªå®¢æˆ·ç«¯è¯»å–ç›¸åŒçš„Chunkï¼Œå®¢æˆ·ç«¯å¯èƒ½å¯ä»¥è¯»åˆ°è¿½åŠ çš„æ•°æ®ï¼Œä¹Ÿå¯èƒ½è¯»ä¸åˆ°ï¼Œå–å†³äºå®¢æˆ·ç«¯è¯»çš„æ˜¯Chunkçš„å“ªä¸ªå‰¯æœ¬ã€‚</p><p>å¯ä¸å¯ä»¥é€šè¿‡ç‰ˆæœ¬å·æ¥åˆ¤æ–­å‰¯æœ¬æ˜¯å¦æœ‰ä¹‹å‰è¿½åŠ çš„æ•°æ®ï¼Ÿ<br>Robertæ•™æˆï¼šæ‰€æœ‰çš„Secondaryéƒ½æœ‰ç›¸åŒçš„ç‰ˆæœ¬å·ï¼Œç‰ˆæœ¬å·åªä¼šåœ¨MasteræŒ‡å®šä¸€ä¸ªæ–°Primaryæ—¶æ‰ä¼šæ”¹å˜ï¼Œé€šå¸¸åªæœ‰åœ¨åŸPrimaryå‘ç”Ÿæ•…éšœäº†ï¼Œæ‰ä¼šæŒ‡å®šä¸€ä¸ªæ–°çš„Primaryã€‚å‰¯æœ¬ï¼ˆå‚ä¸å†™æ“ä½œçš„Primaryå’ŒSecondaryï¼‰éƒ½æœ‰ç›¸åŒçš„ç‰ˆæœ¬å·ï¼Œä½ æ²¡æ³•é€šè¿‡ç‰ˆæœ¬å·æ¥åˆ¤æ–­å®ƒä»¬æ˜¯å¦ä¸€æ ·ï¼Œæˆ–è®¸å®ƒä»¬å°±æ˜¯ä¸ä¸€æ ·çš„ï¼ˆå–å†³äºæ•°æ®è¿½åŠ æˆåŠŸä¸å¦ï¼‰ã€‚</p><p>å®¢æˆ·ç«¯å°†æ•°æ®æ‹·è´ç»™å¤šä¸ªå‰¯æœ¬ä¼šä¸ä¼šé€ æˆç“¶é¢ˆï¼Ÿ<br>Robertæ•™æˆï¼šè€ƒè™‘åˆ°åº•å±‚ç½‘ç»œï¼Œå†™å…¥æ–‡ä»¶æ•°æ®çš„å…·ä½“ä¼ è¾“è·¯å¾„å¯èƒ½ä¼šéå¸¸é‡è¦ã€‚å½“è®ºæ–‡ç¬¬ä¸€æ¬¡è¯´å®¢æˆ·ç«¯ä¼šå°†æ•°æ®å‘é€ç»™æ¯ä¸ªå‰¯æœ¬ã€‚ä¹‹åè®ºæ–‡åˆæ”¹å˜äº†è¯´æ³•ï¼Œè¯´å®¢æˆ·ç«¯åªä¼šå°†æ•°æ®å‘é€ç»™ç¦»å®ƒæœ€è¿‘çš„å‰¯æœ¬ï¼Œä¹‹åé‚£ä¸ªå‰¯æœ¬ä¼šå°†æ•°æ®è½¬å‘åˆ°å¦ä¸€ä¸ªå‰¯æœ¬ï¼Œä»¥æ­¤ç±»æ¨å½¢æˆä¸€æ¡é“¾ï¼Œç›´åˆ°æ‰€æœ‰çš„å‰¯æœ¬éƒ½æœ‰äº†æ•°æ®ã€‚è¿™æ ·ä¸€æ¡æ•°æ®ä¼ è¾“é“¾å¯ä»¥åœ¨æ•°æ®ä¸­å¿ƒå†…å‡å°‘è·¨äº¤æ¢æœºä¼ è¾“ï¼ˆå¦åˆ™ï¼Œæ‰€æœ‰çš„æ•°æ®ååéƒ½åœ¨å®¢æˆ·ç«¯æ‰€åœ¨çš„äº¤æ¢æœºä¸Šï¼‰ã€‚</p><p>ä¸ºä»€ä¹ˆç«‹å³æŒ‡å®šä¸€ä¸ªæ–°çš„Primaryæ˜¯åçš„è®¾è®¡ï¼Ÿ<br>Robertæ•™æˆï¼šå› ä¸ºå®¢æˆ·ç«¯ä¼šé€šè¿‡ç¼“å­˜æé«˜æ•ˆç‡ï¼Œå®¢æˆ·ç«¯ä¼šåœ¨çŸ­æ—¶é—´ç¼“å­˜Primaryçš„èº«ä»½ä¿¡æ¯ï¼ˆè¿™æ ·ï¼Œå®¢æˆ·ç«¯å°±ä¸ç”¨æ¯æ¬¡éƒ½ä¼šå‘Masterè¯·æ±‚Primaryä¿¡æ¯ï¼‰ã€‚å³ä½¿æ²¡æœ‰ç¼“å­˜ï¼Œä¹Ÿæœ‰å¯èƒ½åˆšå‘å®¢æˆ·ç«¯è¿”å›ä¹‹åï¼Œmasterå°±æŒ‡å®šäº†æ–°çš„primaryã€‚å¦‚æœä¸é‡‡ç”¨å…¶å®ƒæœºåˆ¶ï¼Œå‰ä¸€ä¸ªå®¢æˆ·ç«¯æ˜¯æ²¡åŠæ³•çŸ¥é“æ”¶åˆ°çš„Primaryå·²ç»è¿‡æ—¶äº†ï¼Œæ­¤æ—¶å¦‚æœå‰ä¸€ä¸ªå®¢æˆ·ç«¯æ‰§è¡Œå†™æ–‡ä»¶ï¼Œé‚£ä¹ˆå°±ä¼šä¸åæ¥çš„å®¢æˆ·ç«¯äº§ç”Ÿä¸¤ä¸ªå†²çªçš„å‰¯æœ¬ã€‚</p><p>å¦‚æœå†™å…¥æ•°æ®å¤±è´¥äº†ï¼Œä¸æ˜¯åº”è¯¥å…ˆæ‰¾åˆ°é—®é¢˜åœ¨å“ªå†é‡è¯•å—ï¼Ÿ<br>Robertæ•™æˆï¼šè®ºæ–‡ä¸­åœ¨é‡è¯•è¿½åŠ æ•°æ®ä¹‹å‰æ²¡æœ‰ä»»ä½•ä¸­é—´æ“ä½œï¼Œå› ä¸ºå¯èƒ½æ˜¯ç½‘ç»œå¯¼è‡´éƒ¨åˆ†æ•°æ®ä¸¢å¤±ã€‚å®¢æˆ·ç«¯é‡è¯•ï¼Œå¯¹äºå¤§å¤šæ•°é”™è¯¯æ¥è¯´å¯ä»¥ç›´æ¥è§£å†³ã€‚æˆ‘ä»¬å¸Œæœ›å¦‚æœæŸä¸ªå‰¯æœ¬å‡ºé”™ï¼Œmasterèƒ½å¤ŸæŒ‡å®šæ–°çš„ï¼Œå‰”é™¤å‡ºé”™çš„å‰¯æœ¬ï¼ŒåŒæ—¶æŒ‡å®šç‰ˆæœ¬å·å’Œæ–°çš„primaryï¼Œæ—§çš„å‰¯æœ¬ä¹Ÿæ°¸è¿œå› ä¸ºç‰ˆæœ¬å·æ—§è¢«æŠ›å¼ƒã€‚ä½†æ˜¯è®ºæ–‡é‡Œåªæ˜¯è¯´ï¼Œå®¢æˆ·ç«¯é‡è¯•ï¼Œå¹¶ä¸”æœŸæœ›ä¹‹åèƒ½æ­£å¸¸å·¥ä½œã€‚MasterèŠ‚ç‚¹ä¼špingæ‰€æœ‰çš„ChunkæœåŠ¡å™¨ï¼Œå¦‚æœSecondaryæœåŠ¡å™¨æŒ‚äº†ï¼ŒMasterèŠ‚ç‚¹å¯ä»¥å‘ç°å¹¶æ›´æ–°Primaryå’ŒSecondaryçš„é›†åˆï¼Œä¹‹åå†å¢åŠ ç‰ˆæœ¬å·ã€‚ä½†æ˜¯è¿™äº›éƒ½æ˜¯ä¹‹åæ‰ä¼šå‘ç”Ÿï¼ˆè€Œä¸æ˜¯ç«‹å³å‘ç”Ÿï¼‰ã€‚</p><h4 id="3-8-GFSçš„ä¸€è‡´æ€§"><a href="#3-8-GFSçš„ä¸€è‡´æ€§" class="headerlink" title="3.8 GFSçš„ä¸€è‡´æ€§"></a>3.8 GFSçš„ä¸€è‡´æ€§</h4><p>å¯¹äºä¸€ä¸ªæ–°å»ºçš„æ–‡ä»¶f1ï¼Œä¼šæŒ‡å®šä¸€ä¸ªæ–°çš„chunkä»¥åŠå¯¹åº”çš„ä¸‰ä¸ªå‰¯æœ¬ã€‚å®¢æˆ·ç«¯å‘æ–‡ä»¶è¿½åŠ æ•°æ®Aï¼Œæ­¤æ—¶ä¸‰ä¸ªå‰¯æœ¬ï¼ˆä¸€ä¸ªPrimaryå’Œä¸¤ä¸ªSecondaryï¼‰ï¼Œéƒ½æˆåŠŸçš„å°†æ•°æ®è¿½åŠ åˆ°äº†Chunkï¼ŒChunkä¸­çš„ç¬¬ä¸€ä¸ªè®°å½•æ˜¯Aã€‚<br>ç¬¬äºŒä¸ªå®¢æˆ·ç«¯å‘æ–‡ä»¶f1è¿½åŠ æ•°æ®Bï¼Œç”±äºç½‘ç»œé—®é¢˜å¯¼è‡´ä¸€ä¸ªsecondaryå‰¯æœ¬å†™å¤±è´¥ï¼Œç°åœ¨æˆ‘ä»¬æœ‰ä¸¤ä¸ªå‰¯æœ¬æœ‰æ•°æ®Bï¼Œå¦ä¸€ä¸ªæ²¡æœ‰ã€‚<br>ç¬¬ä¸‰ä¸ªå®¢æˆ·ç«¯å‘æ–‡ä»¶f1è¿½åŠ æ•°æ®Cï¼Œå‘é€ç»™ä¸»å‰¯æœ¬ä¹‹åï¼ŒPrimaryé€‰æ‹©äº†åç§»é‡ï¼Œå¹¶å°†åç§»é‡å‘Šè¯‰Secondaryï¼Œå°†æ•°æ®Cå†™åœ¨Chunkçš„è¿™ä¸ªä½ç½®ã€‚<br>ç¬¬äºŒä¸ªå®¢æˆ·ç«¯ä¼šæ”¶åˆ°å†™å¤±è´¥çš„å›å¤ï¼Œä¹‹åä¼šå†æ¬¡è¯·æ±‚è¿½åŠ æ•°æ®Bï¼Œæ­¤æ—¶ä¸€åˆ‡æ­£å¸¸ï¼Œå†™å…¥æˆåŠŸã€‚<br>åˆä¸€ä¸ªå®¢æˆ·ç«¯å‘æ–‡ä»¶f1è¿½åŠ æ•°æ®Dï¼Œæœ€ç»ˆå†™æˆåŠŸä¸¤ä¸ªå‰¯æœ¬ï¼Œä½†æ˜¯è¿™ä¸ªå®¢æˆ·ç«¯æŒ‚äº†ï¼Œå› æ­¤å¹¶ä¸ä¼šå†æ¬¡è¿›è¡Œé‡è¯•ï¼Œæœ€åæ•°æ®Då‡ºç°åœ¨æŸäº›å‰¯æœ¬ä¸­ï¼Œè€Œå…¶ä»–å‰¯æœ¬åˆ™å®Œå…¨æ²¡æœ‰ã€‚<br><strong>åœ¨GFSçš„è¿™ç§å·¥ä½œæ–¹å¼ä¸‹ï¼ŒPrimaryè¿”å›å†™å…¥å¤±è´¥ä¼šå¯¼è‡´ä¸åŒçš„å‰¯æœ¬æœ‰å®Œå…¨ä¸åŒçš„æ•°æ®ã€‚</strong></p><p><img src="https://s2.loli.net/2024/07/03/QavCDUPo59GTjSL.png" alt="59cb609fe1f04e7fa48e278b0d1af47e[1].png"></p><p>å¦‚æœä¸€ä¸ªå®¢æˆ·ç«¯è¯»æ–‡ä»¶f1ï¼Œè¯»åˆ°çš„å†…å®¹å–å†³äºè¯»å–çš„æ˜¯Chunkçš„å“ªä¸ªå‰¯æœ¬ï¼Œä¸åŒçš„å‰¯æœ¬ï¼Œè¯»å–æ•°æ®çš„é¡ºåºæ˜¯ä¸ä¸€æ ·çš„ã€‚å¦‚æœè¯»å–çš„æ˜¯ç¬¬ä¸€ä¸ªå‰¯æœ¬ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å¯ä»¥è¯»åˆ°Aã€Bã€Cï¼Œç„¶åæ˜¯ä¸€ä¸ªé‡å¤çš„Bã€‚å¦‚æœè¯»å–çš„æ˜¯ç¬¬ä¸‰ä¸ªå‰¯æœ¬ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯å¯ä»¥è¯»åˆ°Aï¼Œä¸€ä¸ªç©ºç™½æ•°æ®ï¼Œç„¶åæ˜¯Cã€Bã€‚</p><p>å®¢æˆ·ç«¯é‡æ–°å‘èµ·å†™å…¥çš„è¯·æ±‚æ—¶ä»å“ªä¸€æ­¥å¼€å§‹é‡æ–°æ‰§è¡Œçš„ï¼Ÿ<br>Robertæ•™æˆï¼šæ ¹æ®æˆ‘ä»è®ºæ–‡ä¸­è¯»åˆ°çš„å†…å®¹ï¼Œï¼ˆå½“å†™å…¥å¤±è´¥ï¼Œå®¢æˆ·ç«¯é‡æ–°å‘èµ·å†™å…¥æ•°æ®è¯·æ±‚æ—¶ï¼‰å®¢æˆ·ç«¯ä¼šä»æ•´ä¸ªæµç¨‹çš„æœ€å¼€å§‹é‡å‘ã€‚å®¢æˆ·ç«¯ä¼šå†æ¬¡å‘Masterè¯¢é—®æ–‡ä»¶æœ€åä¸€ä¸ªChunkæ˜¯ä»€ä¹ˆï¼Œå› ä¸ºæ–‡ä»¶å¯èƒ½å› ä¸ºå…¶ä»–å®¢æˆ·ç«¯çš„æ•°æ®è¿½åŠ è€Œå‘ç”Ÿäº†æ”¹å˜ã€‚</p><p>ä¸ºä»€ä¹ˆGFSè¦è®¾è®¡æˆå¤šä¸ªå‰¯æœ¬ä¸ä¸€è‡´ï¼Ÿ<br>Robertæ•™æˆï¼šæˆ‘ä¸æ˜ç™½GFSè®¾è®¡è€…ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšã€‚GFSå¯ä»¥è®¾è®¡æˆå¤šä¸ªå‰¯æœ¬æ˜¯å®Œå…¨ç²¾ç¡®åŒæ­¥çš„ã€‚ä½†æ˜¯ä¸ºäº†ä¿æŒåŒæ­¥ï¼Œè¦ä½¿ç”¨å„ç§å„æ ·çš„æŠ€æœ¯ã€‚å…¶ä¸­ä¸€æ¡è§„åˆ™å°±æ˜¯ä¸èƒ½å…è®¸è¿™ç§åªæ›´æ–°éƒ¨åˆ†æœåŠ¡å™¨çš„ä¸å®Œæ•´æ“ä½œã€‚å³ä½¿å®¢æˆ·ç«¯æŒ‚äº†ï¼Œç³»ç»Ÿåªè¦æ”¶åˆ°äº†è¯·æ±‚ï¼Œå°±è¦ä¿éšœå®Œæˆï¼Œprimaryéœ€è¦ç¡®ä¿æ¯ä¸€ä¸ªå‰¯æœ¬éƒ½å¾—åˆ°æ¯ä¸€æ¡æ¶ˆæ¯ã€‚</p><p>å¦‚æœç¬¬ä¸€æ¬¡å†™Bå¤±è´¥äº†ï¼ŒCåº”è¯¥åœ¨Bçš„ä½ç½®å§ï¼Ÿ<br>Robertæ•™æˆï¼šå®é™…ä¸Šå¹¶æ²¡æœ‰ã€‚Primaryå°†Cæ·»åŠ åˆ°äº†Chunkçš„æœ«å°¾ï¼Œåœ¨Bç¬¬ä¸€æ¬¡å†™å…¥çš„ä½ç½®ä¹‹åã€‚å½“å†™Cçš„è¯·æ±‚å‘é€è¿‡æ¥æ—¶ï¼ŒPrimaryå®é™…ä¸Šå¯èƒ½ä¸çŸ¥é“Bçš„å‘½è¿æ˜¯ä»€ä¹ˆã€‚å› ä¸ºæˆ‘ä»¬é¢å¯¹çš„æ˜¯å¤šä¸ªå®¢æˆ·ç«¯å¹¶å‘æäº¤è¿½åŠ æ•°æ®çš„è¯·æ±‚ï¼Œä¸ºäº†è·å¾—é«˜æ€§èƒ½ï¼Œä½ ä¼šå¸Œæœ›Primaryå…ˆæ‰§è¡Œè¿½åŠ æ•°æ®Bçš„è¯·æ±‚ï¼Œä¸€æ—¦è·å–äº†ä¸‹ä¸€ä¸ªåç§»é‡ï¼Œå†é€šçŸ¥æ‰€æœ‰çš„å‰¯æœ¬æ‰§è¡Œè¿½åŠ æ•°æ®Cçš„è¯·æ±‚ï¼Œè¿™æ ·æ‰€æœ‰çš„äº‹æƒ…å°±å¯ä»¥å¹¶è¡Œçš„å‘ç”Ÿã€‚Primaryä¹Ÿå¯ä»¥åˆ¤æ–­Bå·²ç»å†™å…¥å¤±è´¥äº†ï¼Œç„¶åå†å‘ä¸€è½®æ¶ˆæ¯è®©æ‰€æœ‰å‰¯æœ¬æ’¤é”€æ•°æ®Bçš„å†™æ“ä½œï¼Œä½†æ˜¯è¿™æ ·æ›´å¤æ‚ä¹Ÿæ›´æ…¢ã€‚</p><p>primaryä¸å»æ ¡éªŒå…¶å®ƒå‰¯æœ¬æœ‰æ²¡æœ‰å†™æˆåŠŸï¼Œä¼šæŒ‡å®šå…¶ä»–å‰¯æœ¬å†™å…¥çš„offsetï¼Œè¿™æ ·å¦‚æœè‡ªå·±å†™æˆåŠŸäº†ï¼Œå…¶ä»–å‰¯æœ¬æœ‰å¤±è´¥çš„ï¼Œä¹Ÿä¸ä¼šæœ‰å½±å“ï¼›å¦‚æœè‡ªå·±å†™å¤±è´¥ï¼Œå…¶å®ƒå‰¯æœ¬æˆåŠŸäº†ï¼Œä¹Ÿæ—¶æŒ‰ç…§è‡ªå·±çš„offsetå†™å…¥æ–°çš„ã€‚<br>è¿™æ ·åšçš„ç›®çš„å¤§æ¦‚æ˜¯ä¸ºäº†æé«˜æ€§èƒ½ï¼Œä½†æ˜¯å®¢æˆ·ç«¯å°±è¦è‡ªå·±å¤„ç†è¿™ç§ä¹±åºçš„æ•°æ®é—®é¢˜ã€‚</p><p>GFSè¿™æ ·è®¾è®¡çš„ç†ç”±æ˜¯è¶³å¤Ÿçš„ç®€å•ï¼Œä½†æ˜¯åŒæ—¶ä¹Ÿç»™åº”ç”¨ç¨‹åºæš´éœ²äº†ä¸€äº›å¥‡æ€ªçš„æ•°æ®ã€‚è¿™é‡Œå¸Œæœ›ä¸ºåº”ç”¨ç¨‹åºæä¾›ä¸€ä¸ªç›¸å¯¹ç®€å•çš„å†™å…¥æ¥å£ï¼Œä½†åº”ç”¨ç¨‹åºéœ€è¦å®¹å¿è¯»å–æ•°æ®çš„ä¹±åºã€‚å¦‚æœåº”ç”¨ç¨‹åºä¸èƒ½å®¹å¿ä¹±åºï¼Œåº”ç”¨ç¨‹åºè¦ä¹ˆå¯ä»¥é€šè¿‡åœ¨æ–‡ä»¶ä¸­å†™å…¥åºåˆ—å·ï¼Œè¿™æ ·è¯»å–çš„æ—¶å€™èƒ½è‡ªå·±è¯†åˆ«é¡ºåºï¼Œè¦ä¹ˆå¦‚æœåº”ç”¨ç¨‹åºå¯¹é¡ºåºçœŸçš„éå¸¸æ•æ„Ÿé‚£ä¹ˆå¯¹äºç‰¹å®šçš„æ–‡ä»¶ä¸è¦å¹¶å‘å†™å…¥ã€‚ä¾‹å¦‚ï¼Œå¯¹äºç”µå½±æ–‡ä»¶ï¼Œä½ ä¸ä¼šæƒ³è¦å°†æ•°æ®å¼„ä¹±ï¼Œå½“ä½ å°†ç”µå½±å†™å…¥æ–‡ä»¶æ—¶ï¼Œä½ å¯ä»¥åªç”¨ä¸€ä¸ªå®¢æˆ·ç«¯è¿ç»­é¡ºåºè€Œä¸æ˜¯å¹¶å‘çš„å°†æ•°æ®è¿½åŠ åˆ°æ–‡ä»¶ä¸­ã€‚</p><p><strong>å°†GFSå‡çº§æˆå¼ºä¸€è‡´ç³»ç»Ÿï¼ˆå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ï¼Œå¢åŠ äº†ç³»ç»Ÿå†…éƒ¨ç»„ä»¶çš„äº¤äº’ï¼‰</strong></p><ul><li><p>ä½ å¯èƒ½éœ€è¦è®©Primaryæ¥æ¢æµ‹é‡å¤çš„è¯·æ±‚ï¼Œè¿™æ ·ç¬¬äºŒä¸ªå†™å…¥æ•°æ®Bçš„è¯·æ±‚åˆ°è¾¾æ—¶ï¼ŒPrimaryå°±çŸ¥é“ï¼Œæˆ‘ä»¬ä¹‹å‰çœ‹åˆ°è¿‡è¿™ä¸ªè¯·æ±‚ï¼Œå¯èƒ½æ‰§è¡Œäº†ä¹Ÿå¯èƒ½æ²¡æ‰§è¡ŒæˆåŠŸã€‚Primayè¦å°è¯•ç¡®ä¿Bä¸ä¼šåœ¨æ–‡ä»¶ä¸­å‡ºç°ä¸¤æ¬¡ã€‚é¦–å…ˆéœ€è¦çš„æ˜¯æ¢æµ‹é‡å¤çš„èƒ½åŠ›ã€‚</p><blockquote><p>è¿™é‡Œå¤§æ¦‚æ˜¯è€ƒè™‘åˆ°å®¢æˆ·ç«¯æˆ–è€…ç½‘ç»œä»€ä¹ˆçš„ï¼Œä¼šå‡ºç°é‡å¤çš„è¯·æ±‚ï¼Œé€šè¿‡åºåˆ—å·åº”è¯¥å°±èƒ½æ”¯æŒã€‚</p></blockquote></li><li><p>å¯¹äºSecondaryæ¥è¯´ï¼Œå¦‚æœPrimayè¦æ±‚Secondaryæ‰§è¡Œä¸€ä¸ªæ“ä½œï¼ŒSecondaryå¿…é¡»è¦æ‰§è¡Œè€Œä¸æ˜¯åªè¿”å›ä¸€ä¸ªé”™è¯¯ç»™Primaryã€‚å¯¹äºä¸€ä¸ªä¸¥æ ¼ä¸€è‡´çš„ç³»ç»Ÿæ¥è¯´ï¼Œæ˜¯ä¸å…è®¸Secondaryå¿½ç•¥Primaryçš„è¯·æ±‚è€Œæ²¡æœ‰ä»»ä½•è¡¥å¿æªæ–½çš„ã€‚å¦‚æœSecondaryæœ‰ä¸€äº›æ°¸ä¹…æ€§æ•…éšœï¼Œä¾‹å¦‚ç£ç›˜è¢«é”™è¯¯çš„æ‹”å‡ºäº†ï¼Œä½ éœ€è¦æœ‰ä¸€ç§æœºåˆ¶å°†Secondaryä»ç³»ç»Ÿä¸­ç§»é™¤ï¼Œè¿™æ ·Primaryå¯ä»¥ä¸å‰©ä¸‹çš„Secondaryç»§ç»­å·¥ä½œã€‚ä½†æ˜¯GFSæ²¡æœ‰åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ–è€…è¯´è‡³å°‘æ²¡æœ‰åšå¯¹ã€‚</p><blockquote><p>è¿™é‡Œæ˜¯å¦æœ‰ç‚¹ç»å¯¹ï¼Œé¦–å…ˆæ— æ³•ä¿éšœsecondaryä¸€å®šèƒ½æˆåŠŸï¼Œè¿™æ—¶primaryè®¤ä¸ºå¤§å®¶éƒ½å¤±è´¥äº†å³å¯ã€‚</p></blockquote></li><li><p>å½“Primaryè¦æ±‚Secondaryè¿½åŠ æ•°æ®æ—¶ï¼Œ<strong>ç›´åˆ°Primaryç¡®ä¿¡æ‰€æœ‰çš„Secondaryéƒ½èƒ½æ‰§è¡Œæ•°æ®è¿½åŠ ä¹‹å‰ï¼ŒSecondaryå¿…é¡»å°å¿ƒä¸è¦å°†æ•°æ®æš´éœ²ç»™è¯»è¯·æ±‚ã€‚</strong>åœ¨ç¬¬ä¸€ä¸ªé˜¶æ®µï¼ŒPrimaryå‘Secondaryå‘è¯·æ±‚ï¼Œè¦æ±‚å…¶æ‰§è¡ŒæŸä¸ªæ“ä½œï¼Œå¹¶ç­‰å¾…Secondaryå›å¤è¯´èƒ½å¦å®Œæˆè¯¥æ“ä½œï¼Œè¿™æ—¶Secondaryå¹¶ä¸å®é™…æ‰§è¡Œæ“ä½œã€‚åœ¨ç¬¬äºŒä¸ªé˜¶æ®µï¼Œå¦‚æœæ‰€æœ‰Secondaryéƒ½å›å¤è¯´å¯ä»¥æ‰§è¡Œè¯¥æ“ä½œï¼Œè¿™æ—¶Primaryæ‰ä¼šè¯´ï¼Œå¥½çš„ï¼Œæ‰€æœ‰Secondaryæ‰§è¡Œåˆšåˆšä½ ä»¬å›å¤å¯ä»¥æ‰§è¡Œçš„é‚£ä¸ªæ“ä½œã€‚è¿™æ˜¯ç°å®ä¸–ç•Œä¸­å¾ˆå¤šå¼ºä¸€è‡´ç³»ç»Ÿçš„å·¥ä½œæ–¹å¼ï¼Œè¿™è¢«ç§°ä¸ºä¸¤é˜¶æ®µæäº¤ï¼ˆTwo-phase commitï¼‰ã€‚</p><blockquote><p>è¿™é‡Œæ˜¯ä¸èƒ½è®©å®¢æˆ·ç«¯è¯»åˆ°è„æ•°æ®</p></blockquote></li><li><p>å½“Primaryå´©æºƒæ—¶ï¼Œå¯èƒ½æœ‰ä¸€ç»„æ“ä½œç”±Primaryå‘é€ç»™Secondaryï¼ŒPrimaryåœ¨ç¡®è®¤æ‰€æœ‰çš„Secondaryæ”¶åˆ°äº†è¯·æ±‚ä¹‹å‰å°±å´©æºƒäº†ã€‚å½“ä¸€ä¸ªPrimaryå´©æºƒäº†ï¼Œä¸€ä¸ªSecondaryä¼šæ¥ä»»æˆä¸ºæ–°çš„Primaryï¼Œä½†æ˜¯è¿™æ—¶ï¼Œæ–°Primaryå’Œå‰©ä¸‹çš„Secondaryä¼šåœ¨æœ€åå‡ ä¸ªæ“ä½œæœ‰åˆ†æ­§ï¼Œå› ä¸ºéƒ¨åˆ†å‰¯æœ¬å¹¶æ²¡æœ‰æ”¶åˆ°å‰ä¸€ä¸ªPrimaryå´©æºƒå‰å‘å‡ºçš„è¯·æ±‚ã€‚æ–°çš„Primaryä¸Šä»»æ—¶ï¼Œéœ€è¦æ˜¾å¼çš„ä¸Secondaryè¿›è¡ŒåŒæ­¥ï¼Œä»¥ç¡®ä¿æ“ä½œå†å²çš„ç»“å°¾æ˜¯ç›¸åŒçš„ã€‚</p><blockquote><p>å¯¹äºGFSï¼Œåˆ‡æ¢primaryæ—¶ï¼Œå®¢æˆ·ç«¯ä¼šè¶…æ—¶å¤±è´¥ï¼Œä¹‹åè¯·æ±‚masterï¼Œæœ€ç»ˆå¾—åˆ°äº†æ–°çš„primaryä¿¡æ¯ï¼Œè¿™æ—¶ä¸ç®¡æˆ–è€…primaryå†™æˆåŠŸå¤±è´¥ï¼Œå®ƒä¹Ÿæ— éœ€è€ƒè™‘åˆ«äººä¸Šæ¬¡æ˜¯æˆåŠŸå¤±è´¥ï¼Œå®ƒåªéœ€è¦æŠŠè‡ªå·±æœ€åçš„offsetå‘è¿‡å»ï¼Œä½†æ˜¯è¿™æ ·å®¢æˆ·ç«¯è¯»ä¸åŒçš„å‰¯æœ¬å¾—åˆ°çš„ç»“æœä¸ä¸€è‡´ï¼Œå®¢æˆ·ç«¯éœ€è¦è‡ªå·±å¤„ç†è¿™ç§ä¸ä¸€è‡´ã€‚</p><p>ä¸ºäº†ä¿éšœå¼ºä¸€è‡´æ€§ï¼Œæ–°primaryå°±éœ€è¦æœ‰ä¸€ä¸ªåŒæ­¥æ“ä½œï¼Œè®©å¤§å®¶éƒ½ä¸€è‡´ã€‚</p></blockquote></li><li><p>æœ€åï¼Œæ—¶ä¸æ—¶çš„ï¼ŒSecondaryä¹‹é—´å¯èƒ½ä¼šæœ‰å·®å¼‚ï¼Œæˆ–è€…å®¢æˆ·ç«¯ä»MasterèŠ‚ç‚¹è·å–çš„æ˜¯ç¨å¾®è¿‡æ—¶çš„Secondaryã€‚ç³»ç»Ÿè¦ä¹ˆéœ€è¦å°†æ‰€æœ‰çš„è¯»è¯·æ±‚éƒ½å‘é€ç»™Primaryï¼Œå› ä¸ºåªæœ‰PrimaryçŸ¥é“å“ªäº›æ“ä½œå®é™…å‘ç”Ÿäº†ï¼Œè¦ä¹ˆå¯¹äºSecondaryéœ€è¦ä¸€ä¸ªç§Ÿçº¦ç³»ç»Ÿï¼Œå°±åƒPrimaryä¸€æ ·ï¼Œè¿™æ ·å°±çŸ¥é“Secondaryåœ¨å“ªäº›æ—¶é—´å¯ä»¥åˆæ³•çš„å“åº”å®¢æˆ·ç«¯ã€‚</p><blockquote><p>è¿™é‡Œåº”è¯¥æ˜¯å®¢æˆ·ç«¯è¯»çš„æ—¶å€™ï¼Œå¦‚æœè¯»secondaryï¼Œå¯èƒ½è¿™ä¸ªsecondaryæŒæœ‰çš„æ•°æ®å¹¶ä¸æ˜¯æ–°çš„ï¼ˆæ–°åŠ å…¥çš„ï¼Œè¿˜åœ¨catch upé˜¶æ®µï¼‰ï¼Œè¿™æ—¶å®ƒå°±ä¸åº”è¯¥å“åº”å®¢æˆ·ç«¯ã€‚</p><p>è¯»å–ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆæœ‰è¶£çš„äº‹ï¼Œè¿™é‡Œå¯ä»¥åœ¨raftä¸­è·å¾—æ›´å¤šä½“ä¼šã€‚</p></blockquote></li></ul><p><strong>GFSå•masterçš„é—®é¢˜</strong><br>æœ€åï¼Œè®©æˆ‘èŠ±ä¸€åˆ†é’Ÿæ¥ä»‹ç»GFSåœ¨å®ƒç”Ÿæ¶¯çš„å‰5-10å¹´åœ¨Googleçš„å‡ºè‰²è¡¨ç°ï¼Œæ€»çš„æ¥è¯´ï¼Œå®ƒå–å¾—äº†å·¨å¤§çš„æˆåŠŸï¼Œè®¸å¤šè®¸å¤šGoogleçš„åº”ç”¨éƒ½ä½¿ç”¨äº†å®ƒï¼Œè®¸å¤šGoogleçš„åŸºç¡€æ¶æ„ï¼Œä¾‹å¦‚BigTableå’ŒMapReduceæ˜¯æ„å»ºåœ¨GFSä¹‹ä¸Šï¼ŒGFSåœ¨Googleå†…éƒ¨å¹¿æ³›è¢«åº”ç”¨ã€‚å®ƒæœ€ä¸¥é‡çš„å±€é™å¯èƒ½åœ¨äºï¼Œå®ƒåªæœ‰ä¸€ä¸ªMasterèŠ‚ç‚¹ï¼Œä¼šå¸¦æ¥ä»¥ä¸‹é—®é¢˜ï¼š</p><ul><li><p>MasterèŠ‚ç‚¹å¿…é¡»ä¸ºæ¯ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªChunkç»´æŠ¤è¡¨å•ï¼Œéšç€GFSçš„åº”ç”¨è¶Šæ¥è¶Šå¤šï¼Œè¿™æ„å‘³ç€æ¶‰åŠçš„æ–‡ä»¶ä¹Ÿè¶Šæ¥è¶Šå¤šï¼Œæœ€ç»ˆMasterä¼šè€—å°½å†…å­˜æ¥å­˜å‚¨æ–‡ä»¶è¡¨å•ã€‚ä½ å¯ä»¥å¢åŠ å†…å­˜ï¼Œä½†æ˜¯å•å°è®¡ç®—æœºçš„å†…å­˜ä¹Ÿæ˜¯æœ‰ä¸Šé™çš„ã€‚</p><blockquote><p>è¿™ä¸ªå¤§æ¦‚æ˜¯å•masterå†…å­˜æœ‰é™ï¼Œåé¢å¯ä»¥å°†å…ƒæ•°æ®å‰¥ç¦»å‡ºæ¥ã€‚</p></blockquote></li><li><p>å•ä¸ªMasterèŠ‚ç‚¹è¦æ‰¿è½½æ•°åƒä¸ªå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œè€ŒMasterèŠ‚ç‚¹çš„CPUæ¯ç§’åªèƒ½å¤„ç†æ•°ç™¾ä¸ªè¯·æ±‚ï¼Œå°¤å…¶Masterè¿˜éœ€è¦å°†éƒ¨åˆ†æ•°æ®å†™å…¥ç£ç›˜ï¼Œå¾ˆå¿«å®¢æˆ·ç«¯æ•°é‡è¶…è¿‡äº†å•ä¸ªMasterçš„èƒ½åŠ›ã€‚</p><blockquote><p>å•èŠ‚ç‚¹å¤æ‚æ‰€æœ‰çš„é€‰ä¸»ï¼Œè€Œä¸”å®¢æˆ·ç«¯è¦ä»masterè·å–primaryçš„ä¿¡æ¯ï¼Œè¿™é‡Œèƒ½æƒ³åˆ°çš„ä¸€ä¸ªå°±æ˜¯æ ¹æ®ä¸šåŠ¡æ­å»ºä¸€ä¸ªæ–°çš„é›†ç¾¤ã€‚</p><p>æ€è€ƒï¼šç°å®é—®é¢˜ä¸­åœ¨å¤šé›†ç¾¤å’Œå•ä¸€é›†ç¾¤ä¹‹é—´çš„åˆ©å¼Šä¸æƒè¡¡ï¼Ÿå³æ­å»ºå¤šä¸ªé›†ç¾¤å›ºç„¶ç®€å•ï¼Œæœ‰ä»€ä¹ˆå¼Šç«¯å—ï¼Ÿ</p></blockquote></li><li><p>åº”ç”¨ç¨‹åºå‘ç°å¾ˆéš¾å¤„ç†GFSå¥‡æ€ªçš„è¯­ä¹‰ï¼ˆæœ¬èŠ‚æœ€å¼€å§‹ä»‹ç»çš„GFSçš„å‰¯æœ¬æ•°æ®çš„åŒæ­¥ï¼Œæˆ–è€…å¯ä»¥è¯´ä¸åŒæ­¥ï¼‰ã€‚</p></li><li><p>ä»æˆ‘ä»¬è¯»åˆ°çš„GFSè®ºæ–‡ä¸­ï¼ŒMasterèŠ‚ç‚¹çš„æ•…éšœåˆ‡æ¢ä¸æ˜¯è‡ªåŠ¨çš„ï¼Œéœ€è¦äººå·¥å¹²é¢„æ¥å¤„ç†å·²ç»æ°¸ä¹…æ•…éšœçš„MasterèŠ‚ç‚¹ï¼Œå¹¶æ›´æ¢æ–°çš„æœåŠ¡å™¨ï¼Œè¿™å¯èƒ½éœ€è¦å‡ ååˆ†é’Ÿç”šè‡³æ›´é•¿çš„è€Œæ—¶é—´æ¥å¤„ç†ï¼Œå¯¹äºæŸäº›åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œè¿™ä¸ªæ—¶é—´å¤ªé•¿äº†ã€‚</p><blockquote><p>è¿™ä¸ªæ„Ÿè§‰æ—¶Googleè‡ªå·±ç•™äº†ä¸€æ‰‹ã€‚</p></blockquote></li></ul>]]></content>
      
      
      <categories>
          
          <category> åˆ†å¸ƒå¼ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ†å¸ƒå¼ç³»ç»Ÿ </tag>
            
            <tag> 6.824 </tag>
            
            <tag> GFS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CoRE-learningï¼šLearnability with Time-Sharing Computational Resource Concerns</title>
      <link href="/2024/07/01/CoRE-learning%EF%BC%9A%E5%B8%A6%E6%9C%89%E5%88%86%E6%97%B6%E8%AE%A1%E7%AE%97%E8%B5%84%E6%BA%90%E8%80%83%E8%99%91%E7%9A%84%E5%8F%AF%E5%AD%A6%E4%B9%A0%E6%80%A7%E7%90%86%E8%AE%BA/"/>
      <url>/2024/07/01/CoRE-learning%EF%BC%9A%E5%B8%A6%E6%9C%89%E5%88%86%E6%97%B6%E8%AE%A1%E7%AE%97%E8%B5%84%E6%BA%90%E8%80%83%E8%99%91%E7%9A%84%E5%8F%AF%E5%AD%A6%E4%B9%A0%E6%80%A7%E7%90%86%E8%AE%BA/</url>
      
        <content type="html"><![CDATA[<h1 id="CoRE-learningï¼šLearnability-with-Time-Sharing-Computational-Resource-Concerns"><a href="#CoRE-learningï¼šLearnability-with-Time-Sharing-Computational-Resource-Concerns" class="headerlink" title="CoRE-learningï¼šLearnability with Time-Sharing Computational Resource Concerns"></a>CoRE-learningï¼šLearnability with Time-Sharing Computational Resource Concerns</h1><p><a href="https://doi.org/10.1093/nsr/nwae204">â€https://doi.org/10.1093/nsr/nwae204â€</a></p><p>ä¸€èˆ¬è®¤ä¸ºï¼Œäººå·¥æ™ºèƒ½æœºå™¨å­¦ä¹ æŠ€æœ¯åº”ç”¨æ¶‰åŠç®—æ³•ã€æ•°æ®ã€ç®—åŠ›â€œä¸‰è¦ç´ â€ã€‚ç»å…¸æœºå™¨å­¦ä¹ ç†è®ºå…³æ³¨ç®—æ³•ä¸æ•°æ®å¯¹å­¦ä¹ æ€§èƒ½çš„å½±å“ï¼Œæ¨å¯¼å‡ºçš„æœºå™¨å­¦ä¹ æ³›åŒ–è¯¯å·®ç•Œæ‰€åŒ…å«çš„é‡è¦é¡¹é€šå¸¸æ¶‰åŠå‡è®¾ç±»å¤æ‚åº¦å’Œæ ·æœ¬å¤æ‚åº¦ï¼Œä¸¤è€…åˆ†åˆ«ä¸ç®—æ³•å’Œæ•°æ®æœ‰å…³ï¼Œè€Œå¯¹â€œä¸‰è¦ç´ â€ä¸­çš„ç®—åŠ›ç¼ºä¹è€ƒè™‘ï¼Œå°½ç®¡ç°å®åœºæ™¯ä¸­ç®—åŠ›èµ„æºçš„ä¾›ç»™åˆ†é…ç›´æ¥å½±å“åˆ°æœ€ç»ˆå­¦ä¹ æ€§èƒ½ã€‚</p><p>åœ¨è¿‘æœŸå‘è¡¨äºã€Šå›½å®¶ç§‘å­¦è¯„è®ºã€‹ï¼ˆ<em>National Science Review</em>, NSRï¼‰çš„Perspectiveæ–‡ç« ä¸­ï¼Œ<strong>å—äº¬å¤§å­¦å‘¨å¿—åæ•™æˆæå‡ºäº†â€œè®¡ç®—èµ„æºé«˜æ•ˆå­¦ä¹ ï¼ˆCoRE-learningï¼‰â€ç†è®ºæ¡†æ¶ï¼Œè¿™æ˜¯ç¬¬ä¸€ä¸ªè€ƒè™‘äº†ç®—åŠ›èµ„æºä¾›ç»™è°ƒåº¦å¯¹æœºå™¨å­¦ä¹ æ€§èƒ½å½±å“çš„å­¦ä¹ ç†è®ºæ¡†æ¶ã€‚</strong></p><p><strong>CoREç†è®ºæ¡†æ¶</strong>ï¼š</p><p><img src="https://s2.loli.net/2024/07/01/jt5ZsTLezHfRrlg.png" alt="image-20240630231211322.png"></p><p>ä½œè€…å®šä¹‰äº†â€œæœºå™¨å­¦ä¹ ååç‡â€å¹¶å¼•å…¥äº†å¯¹èµ„æºåŠ¨æ€åˆ†é…è°ƒåº¦ç­–ç•¥çš„è€ƒè™‘ï¼Œä½¿å¾—ç®—åŠ›èµ„æºçš„ä¾›ç»™åˆ†é…å¯¹æœºå™¨å­¦ä¹ æ³›åŒ–æ€§èƒ½çš„å½±å“å¯ä»¥è¢«æŠ½è±¡åœ°åœ¨å­¦ä¹ ç†è®ºä¸­è¿›è¡Œç ”ç©¶ï¼Œä¸ä»…æœ‰åŠ©äºæŒ‡å¯¼è®¾è®¡å‡ºé«˜æ•ˆä½¿ç”¨ç®—åŠ›èµ„æºçš„ç®—æ³•ï¼Œè¿˜å¯æœ›å¼•å¯¼â€œæ™ºç®—ä¸­å¿ƒâ€åœ¨ä¸ºæœºå™¨å­¦ä¹ æ¨¡å‹è®­ç»ƒæä¾›èµ„æºæœåŠ¡æ—¶ä»â€œç‹¬å å¼â€è½¬å˜ä¸ºâ€œåˆ†æ—¶å¼â€ï¼Œä¸ºèƒ½æºçš„é«˜æ•ˆåˆ©ç”¨æä¾›ä¸€ä¸ªæœºå™¨å­¦ä¹ ç†è®ºè§†è§’ã€‚</p><h2 id="åŠ¨æœºï¼ˆMotivationï¼‰ï¼š"><a href="#åŠ¨æœºï¼ˆMotivationï¼‰ï¼š" class="headerlink" title="åŠ¨æœºï¼ˆMotivationï¼‰ï¼š"></a><strong>åŠ¨æœºï¼ˆMotivationï¼‰ï¼š</strong></h2><ul><li>ä¼ ç»Ÿæœºå™¨å­¦ä¹ ç†è®ºé€šå¸¸å‡è®¾æœ‰è¶³å¤Ÿçš„ç”šè‡³æ— é™ä¾›åº”çš„è®¡ç®—èµ„æºæ¥å¤„ç†æ‰€æœ‰æ¥æ”¶åˆ°çš„æ•°æ®ã€‚ç„¶è€Œï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¦‚æµå­¦ä¹ ï¼Œæ•°æ®æµå¯èƒ½æ˜¯æ— é™çš„ï¼Œä¸”æ•°æ®é‡å·¨å¤§ï¼Œä¸å¯èƒ½åŠæ—¶å¤„ç†æ‰€æœ‰æ•°æ®ã€‚ï¼ˆè¿™ä¸ªé—®é¢˜é€šå¸¸ä¸æ˜¯æœºå™¨å­¦ä¹ é¢†åŸŸè€ƒè™‘çš„é—®é¢˜ï¼‰</li><li>ç°ä»£â€œæ™ºèƒ½è¶…çº§è®¡ç®—â€è®¾æ–½é€šå¸¸ä»¥ç‹¬å æ–¹å¼è¿è¡Œï¼Œç”¨æˆ·è¢«åˆ†é…å›ºå®šæ•°é‡çš„èµ„æºæ¥è¿è¡Œæœºå™¨å­¦ä¹ ä»»åŠ¡ã€‚è¿™ç§æ–¹å¼å¯èƒ½è¿‡äºä¹è§‚æˆ–æ‚²è§‚ï¼Œå¯¼è‡´èµ„æºåˆ†é…ä¸åˆç†ã€‚è¿™å°±æœ‰ç‚¹åƒæ—©æœŸçš„è®¡ç®—æœºç³»ç»Ÿäº†ã€‚</li><li>æœºå™¨å­¦ä¹ ç†è®ºåº”è¯¥è€ƒè™‘æ—¶é—´å…±äº«è®¡ç®—èµ„æºçš„é—®é¢˜ï¼Œä»¥æé«˜ç”¨æˆ·æ•ˆç‡å’Œç¡¬ä»¶æ•ˆç‡ï¼Œè¿™ä¸€å…³é”®æŠ€æœ¯å°±æ˜¯åˆ†æ—¶ï¼ˆtime-sharingï¼‰ã€‚</li><li>ç›®æ ‡ï¼š<ul><li>ç”¨æˆ·æ•ˆç‡è§’åº¦ï¼šåœ¨ä¸€å®šæ—¶é—´é¢„ç®—å†…å¾—åˆ°ç†æƒ³çš„æ¨¡å‹ç»“æœã€‚</li><li>ç¡¬ä»¶æ•ˆç‡è§’åº¦ï¼šè®¡ç®—èµ„æºè¢«åˆç†åœ°åˆ©ç”¨ã€‚</li></ul></li></ul><h2 id="å·¥ä½œå†…å®¹ï¼ˆWorkï¼‰ï¼š"><a href="#å·¥ä½œå†…å®¹ï¼ˆWorkï¼‰ï¼š" class="headerlink" title="å·¥ä½œå†…å®¹ï¼ˆWorkï¼‰ï¼š"></a><strong>å·¥ä½œå†…å®¹ï¼ˆWorkï¼‰ï¼š</strong></h2><p>åŸºäºmotivationï¼Œæå‡ºäº†â€œè®¡ç®—èµ„æºé«˜æ•ˆå­¦ä¹ â€ï¼ˆCoRE learningï¼‰çš„æ¦‚å¿µï¼Œå¹¶å»ºç«‹äº†ä¸€ä¸ªç†è®ºæ¡†æ¶ã€‚</p><h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><ul><li><p>ååé‡ï¼šæ¯ç§’å¯ä»¥ä¼ è¾“çš„æ•°æ®é‡&#x2F;æ•°æ®åº“ä¸­å¹³å‡äº‹åŠ¡å¤„ç†æ•°é‡ã€‚</p></li><li><p>å¼•å…¥äº†<strong>æœºå™¨å­¦ä¹ ååé‡</strong>çš„æ¦‚å¿µï¼Œç”¨äºåœ¨æŠ½è±¡å±‚é¢ä¸Šç†è®ºåŒ–è®¡ç®—èµ„æºå’Œè°ƒåº¦çš„å½±å“ã€‚ï¼š</p><ul><li><p><strong>æ•°æ®ååé‡</strong>ï¼šè¡¨ç¤ºæ¯ä¸ªæ—¶é—´å•ä½å†…å¯ä»¥å­¦ä¹ çš„æ•°æ®ç™¾åˆ†æ¯”ã€‚</p></li><li><p><strong>çº¿ç¨‹ååé‡</strong>ï¼šçº¿ç¨‹ååé‡è¡¨ç¤ºåœ¨ä¸€æ®µæ—¶é—´å†…å¯ä»¥å¾ˆå¥½åœ°å­¦ä¹ çš„çº¿ç¨‹çš„ç™¾åˆ†æ¯”ã€‚</p><p><img src="https://s2.loli.net/2024/07/01/jt5ZsTLezHfRrlg.png" alt="image-20240630231211322.png"></p><p>å›¾1(a)ä¸º<strong>æ•°æ®ååé‡</strong>ï¼Œå°†è¿™ä¸ªæ¦‚å¿µå¼•å…¥æœºå™¨å­¦ä¹ ç ”ç©¶ï¼š</p><ul><li>æ•°æ®é‡å’Œè®¡ç®—èµ„æºé¢„ç®—çš„å½±å“å¯ä»¥è¢«æ¶‰åŠã€‚</li><li>ä½†å¹¶æœªè€ƒè™‘åˆ°ä»æ•°æ®ä¸­å­¦ä¹ çš„éš¾åº¦å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–çš„äº‹å®ã€‚</li></ul><p><strong>çº¿ç¨‹</strong>ï¼šè®¡ç®—è®¾å¤‡æ¥æ”¶åˆ°çš„æœºå™¨å­¦ä¹ ä»»åŠ¡ã€‚</p><ul><li>ç”Ÿå‘½å‘¨æœŸï¼šå¼€å§‹æ—¶é—´å’Œæˆªæ­¢&#x2F;æ­»äº¡æ—¶é—´ï¼ˆè¿™é‡Œçš„æˆªæ­¢æ—¶é—´æ˜¯äººä¸ºè®¾ç½®çš„ï¼‰ã€‚</li><li>æˆåŠŸçº¿ç¨‹ï¼šæ—¶é—´è·¨åº¦å†…èƒ½å¾ˆå¥½åœ°å­¦ä¹ ï¼Œè¾¾åˆ°ç”¨æˆ·çš„è¦æ±‚ã€‚</li><li>å¤±è´¥çº¿ç¨‹ï¼šæ—¶é—´è·¨åº¦å†…ä¸èƒ½å¾ˆå¥½åœ°å­¦ä¹ ï¼Œä¸èƒ½è¾¾åˆ°ç”¨æˆ·çš„è¦æ±‚ã€‚</li></ul><p><strong>çº¿ç¨‹ååé‡</strong>ï¼šç”±è¯¥æ—¶é—´æ®µå†…æ‰€æœ‰çº¿ç¨‹ä¸­çš„æˆåŠŸçº¿ç¨‹ç™¾åˆ†æ¯”è®¡ç®—ï¼Œå¦‚å›¾1(b)çº¿ç¨‹ååé‡å³ä¸º3&#x2F;5&#x3D;60%ã€‚</p><p><strong>ä»»åŠ¡æŸï¼ˆtask bundleï¼‰</strong>ï¼šç›¸å…³æ—¶é—´æ®µå†…çš„ä¸€ç»„ä»»åŠ¡çº¿ç¨‹ã€‚</p><p><img src="https://s2.loli.net/2024/07/01/5PweNGyE4qjfkCM.png" alt="image-20240701122812984.png"></p><ul><li>å…¶ä¸­<img src="https://s2.loli.net/2024/07/01/UyIxqoT6D2Oht9g.png" alt="image-20240701122851437.png">ï¼Œ<strong>Dk</strong>è¡¨ç¤ºå…·æœ‰æ•°æ®åˆ†å¸ƒçš„çº¿ç¨‹ï¼Œ<strong>bk</strong>è¡¨ç¤ºèµ·å§‹æ—¶é—´ï¼Œ<strong>dk</strong>æ˜¯æˆªæ­¢æ—¶é—´ï¼Œ<strong>Nt</strong>æ˜¯åœ¨ç»™å®šè®¡ç®—èµ„æºå‰æä¸‹åœ¨æ—¶é—´tæ—¶å¯ä»¥å¤„ç†çš„æ•°æ®é‡ï¼Œ<strong>K</strong>æ˜¯ä»»åŠ¡æŸä¸­çš„æ€»çº¿ç¨‹æ•°ï¼ˆæ€»çš„ä»»åŠ¡æ•°)ï¼ŒTæ˜¯æ€»çš„**æ—¶éš™ï¼ˆtime slots)<strong>æ•°é‡ã€‚å¦‚æœ</strong>bi&#x3D;bj (æ‰€æœ‰iâ‰ j)**ï¼Œåˆ™æ‰€æœ‰ä»»åŠ¡çº¿ç¨‹åŒæ—¶åˆ°è¾¾ã€‚</li></ul></li></ul></li></ul><h4 id="Learning-algorithm"><a href="#Learning-algorithm" class="headerlink" title="Learning algorithm"></a>Learning algorithm</h4><p><strong>å­¦ä¹ ç®—æ³•</strong>ï¼š<img src="https://s2.loli.net/2024/07/01/ndGhjSIHwpRcqoL.png" alt="image-20240701134403028.png"></p><p><strong>è¾“å…¥</strong>ï¼š<img src="https://s2.loli.net/2024/07/01/CPmvKkdSObRQUcL.png" alt="image-20240701134413069.png"></p><p><strong>è¾“å‡ºï¼š</strong><img src="https://s2.loli.net/2024/07/01/QoOyVGNieK7wACm.png" alt="image-20240701134435515.png"></p><ul><li><strong>sk</strong>ä¸ºç®—æ³•ç¡®å®šçš„åˆ‡æ¢æ—¶é—´ã€‚</li><li><strong>Mk</strong>ä¸ºç¬¬kä¸ªçº¿ç¨‹çš„learned modelã€‚</li></ul><p>ç”¨<strong>At</strong>è¡¨ç¤ºåœ¨æ—¶é—´tæ—¶å­˜æ´»çº¿ç¨‹çš„é›†åˆï¼š</p><p><img src="https://s2.loli.net/2024/07/01/QAVty5wKrUbLFhk.png" alt="image-20240701134742442.png"></p><p><strong>å­¦ä¹ è¿‡ç¨‹</strong>å¦‚ä¸‹ï¼š</p><ol><li><p>forå¾ªç¯:æ—¶é—´t&#x3D;1,â€¦,Tï¼Œthe learner </p><p>doï¼š</p><ol><li>æœ€å¤šæ”¶é›† k,tï¼ŒNt åœ¨ k âˆˆ Atæ¡ä»¶ä¸‹çš„æ ·æœ¬ , å…¶ä¸­ Î·k,tä¸ºçº¿ç¨‹kåœ¨æ—¶é—´tçš„æ•°æ®ååé‡ã€‚</li><li>ä¸ºçº¿ç¨‹kæ›´æ–°æ¨¡å‹Mkã€‚</li><li>å¦‚æœçº¿ç¨‹kå®Œæˆï¼Œå°†skè®¾ä¸ºtã€‚</li></ol></li><li><p>ç»ˆæ­¢å¾ªç¯ã€‚</p></li></ol><h5 id="Definition-1-Î·-Îº-L-CoRE-learnability-ï¼š"><a href="#Definition-1-Î·-Îº-L-CoRE-learnability-ï¼š" class="headerlink" title="Definition 1 ((Î·, Îº,L)-CoRE learnability)ï¼š"></a>Definition 1 ((Î·, Îº,L)-CoRE learnability)ï¼š</h5><p>ç°åœ¨å¼•å…¥CoRE learnabilityï¼Œå…¶ä¸­<img src="https://s2.loli.net/2024/07/01/WzpP4XcBDfGN32h.png" alt="image-20240701140345002.png">ä¸ºæ•°æ®ååé‡ï¼Œ<img src="https://s2.loli.net/2024/07/01/pMOLFz14aCht23d.png" alt="image-20240701140353686.png">ä¸ºçº¿ç¨‹ååé‡ã€‚</p><p><img src="https://s2.loli.net/2024/07/01/B7GjcYV5frlUMyd.png" alt="image-20240701141334011.png"></p><p>æ¡ä»¶ï¼ˆ1ï¼‰æ¶‰åŠæ•´ä¸ªæ•°æ®ååé‡ï¼Œçº¦æŸæ‰€æœ‰åœ¨å½“å‰æ—¶åˆ»çš„alive setä¸­çš„çº¿ç¨‹çš„æ€»ä½“èµ„æºé…é¢æ°¸è¿œä¸ä¼šè¶…è¿‡æœ€å¤§èµ„æºé¢„ç®—ã€‚</p><p>æ¡ä»¶ï¼ˆ2ï¼‰æ¶‰åŠçº¿ç¨‹ååé‡ï¼Œè¦æ±‚<strong>è°ƒåº¦ç­–ç•¥Ïˆ</strong>ä½¿<strong>L</strong>èƒ½å¤Ÿå°½å¯èƒ½å¤šåœ°å­¦ä¹ ï¼š</p><ul><li>çº¿ç¨‹çš„å­¦ä¹ åº”åœ¨æˆªæ­¢æ—¶é—´å‰å®Œæˆï¼Œå¦‚æ¡ä»¶ï¼ˆ2aï¼‰æ‰€ç¤ºï¼›</li><li><strong>å¹¶ä¸”çº¿ç¨‹çš„å­¦ä¹ æ€§èƒ½</strong>åº”å½“åœ¨å¦‚æ¡ä»¶ï¼ˆ2bï¼‰æ‰€æŒ‡ç¤ºçš„å°è¯¯å·®æ°´å¹³å†…ã€‚å­¦ä¹ æ€§èƒ½ç”±<img src="https://s2.loli.net/2024/07/01/5uw42qnWrOFLk9V.png" alt="image-20240701142408791.png">æ¥è¡¡é‡ï¼Œå½“ç®—æ³•åˆ©ç”¨æ—¶éš™ï¼ˆbkï¼Œskï¼‰ä¸­æ¥æ”¶åˆ°çš„æ•°æ®å¹¶åœ¨æ—¶é—´ç‚¹skä¹‹å‰å®Œæˆå­¦ä¹ æ—¶ï¼Œ<img src="https://s2.loli.net/2024/07/01/MkaOoVHAUTqbND7.png" alt="image-20240701142328147.png">æ ¹æ®é¢„å®šçš„<img src="https://s2.loli.net/2024/07/01/lz65UHiZhGVtoy3.png" alt="image-20240701142450627.png">æ¥è¯„ä¼°å­¦ä¹ æ€§èƒ½æ˜¯å¦å¯æ¥å—ã€‚</li></ul><p>æ³¨æ„ï¼Œæ¡ä»¶ï¼ˆ1ï¼‰ä¸ç”¨æˆ·æ•ˆç‡æœ‰å…³ï¼Œè€Œæ¡ä»¶ï¼ˆ2)ä¸ç¡¬ä»¶æ•ˆç‡æœ‰å…³ï¼›è°ƒåº¦ç­–ç•¥åº”è¯¥è°¨æ…åœ°å¹³è¡¡è¿™ä¸¤ä¸ªæ–¹é¢ã€‚</p><p>CoRE learnabilityå®šä¹‰ä½¿ç”¨äº†ä¸€ç§<img src="https://s2.loli.net/2024/07/01/rs4HoBikXz7JLhI.png" alt="image-20240701143554651.png">ç±»ä¼¼å¯èƒ½è¿‘ä¼¼æ­£ç¡®çš„PACå­¦ä¹ ç†è®ºã€‚ä¸PACä¸åŒçš„æ˜¯ï¼ŒCoRE learnabilityè€ƒè™‘äº†èµ„æºè°ƒåº¦ç­–ç•¥Ïˆçš„å½±å“ï¼Œå¹¶ä¸”å¯¹äºå…·æœ‰ï¼ˆÎ·ï¼ŒÎºï¼‰ååé‡é—®é¢˜çš„å­¦ä¹ ç®—æ³•Lï¼Œä»…è¦æ±‚å¯æ¥å—çš„<img src="https://s2.loli.net/2024/07/01/rs4HoBikXz7JLhI.png" alt="image-20240701143554651.png">ã€‚</p><p><img src="https://s2.loli.net/2024/07/01/2ax13HhNpGJzjYo.png" alt="image-20240701144633004.png"></p><h5 id="ç®—æ³•æµç¨‹ä¸¾ä¾‹è¯´æ˜ï¼š"><a href="#ç®—æ³•æµç¨‹ä¸¾ä¾‹è¯´æ˜ï¼š" class="headerlink" title="ç®—æ³•æµç¨‹ä¸¾ä¾‹è¯´æ˜ï¼š"></a>ç®—æ³•æµç¨‹ä¸¾ä¾‹è¯´æ˜ï¼š</h5><p>å›¾1(c)ç»™å‡ºäº†ä¸€ä¸ªå›¾ç¤ºï¼Œå…¶ä¸­ä»»åŠ¡åŒ…ç”±<strong>K&#x3D;5</strong>ä¸ªçº¿ç¨‹ç»„æˆã€‚ä¸ºç®€å•èµ·è§ï¼Œå‡è®¾åœ¨æ¯ä¸ªæ—¶é—´å•ä½<img src="https://s2.loli.net/2024/07/01/oSXzG749Wuv2Um6.png" alt="image-20240701144649262.png">ä¸ªæ•°æ®å•ä½å¯ä»¥å¤„ç†ã€‚è¯·æ³¨æ„ï¼ŒCoREå­¦ä¹ å…è®¸ä»»åŠ¡çº¿ç¨‹<img src="https://s2.loli.net/2024/07/01/OSsnXAkj5QzcGm1.png" alt="image-20240701144723031.png">çš„å¼€å§‹æ—¶é—´skå’Œæˆªæ­¢æ—¶é—´dk,ä¸ºä»»ä½•å®é™…å€¼ï¼Œè€Œåœ¨æ­¤å›¾ä¸­ï¼Œæˆ‘ä»¬å‡è®¾å®ƒä»¬æ˜¯å››èˆäº”å…¥çš„ï¼Œä»¥ä¾¿æ›´å¥½åœ°è¯´æ˜ã€‚å¯¹äº<strong>ç»™å®šçš„ç®—æ³•L</strong>ï¼Œä»»åŠ¡æŸæ˜¯**(0.5,0.6,L)-CoRE learnable<strong>çš„ï¼Œå› ä¸ºå­˜åœ¨ä¸€ç§è°ƒåº¦ç­–ç•¥Ïˆï¼Œä½¿å¾—åœ¨ç»™å®š</strong>æ•°æ®ååé‡Î·&#x3D;50%**çš„æƒ…å†µä¸‹ï¼Œå·¥èƒ½å¤ŸæˆåŠŸåœ°å­¦ä¹ 5ä¸ªçº¿ç¨‹ä¸­çš„3ä¸ªã€‚</p><p>å¦‚å›¾1cæ‰€ç¤ºï¼š</p><ol><li>Ïˆå°†èƒ½å¤Ÿå¤„å‹Î·N&#x3D;32ä¸ªæ•°æ®å•å…ƒçš„èµ„æºå¹³ç­‰åœ°åœ¨time slotå¤„äºt0-t1æ—¶åˆ†é…ç»™çº¿ç¨‹1å’Œçº¿ç¨‹3ï¼Œçº¿ç¨‹1ç»§ç»­æ¥æ”¶å¯ä»¥å¤„ç†16ä¸ªæ•°æ®å•å…ƒçš„èµ„æºï¼Œç›´åˆ°åœ¨t3å®Œæˆï¼›å‰©ä½™å¯ä»¥å¤„ç†16ä¸ªæ•°æ®å•å…ƒçš„èµ„æºåœ¨t1-t3ä¸­å¹³å‡åˆ†é…ç»™çº¿ç¨‹2å’Œçº¿ç¨‹3ã€‚</li><li>åœ¨t3-t4æ—¶ï¼Œå› ä¸ºçº¿ç¨‹1ä¸å†éœ€è¦ä»»ä½•èµ„æºï¼Œçº¿ç¨‹2å’Œ3æ¯ä¸ªéƒ½å°†åˆ†é…åˆ°å¯ä»¥å¤„ç†8ä¸ªä»¥ä¸Šæ•°æ®å•å…ƒçš„èµ„æºã€‚</li><li>çº¿ç¨‹4åœ¨t4åˆ°æ¥ï¼ŒÏˆå¯¹çº¿ç¨‹2æ„Ÿåˆ°æ‚²è§‚ï¼Œæ‰€ä»¥æŠŠæ‰€æœ‰èµ„æºåˆ†é…ç»™çº¿ç¨‹3å’Œçº¿ç¨‹4ã€‚</li><li>çº¿ç¨‹5åœ¨t5åˆ°æ¥ï¼Œç”±äºçº¿ç¨‹5å¯¿å‘½å¾ˆçŸ­ï¼Œæ‰€ä»¥Ïˆç»™å®ƒåˆ†é…äº†å°½å¯èƒ½å¤šçš„èµ„æºï¼Œç›´åˆ°åœ¨t7å­¦ä¹ å¤±è´¥ã€‚</li><li>åœ¨t6ï¼ŒÏˆå¯¹çº¿ç¨‹3éå¸¸ä¹è§‚ï¼Œå› æ­¤å†³å®šæš‚æ—¶ç‰ºç‰²çº¿ç¨‹4å°†æ‰€æœ‰å‰©ä½™çš„èµ„æºç»™çº¿ç¨‹3ã€‚</li><li>åœ¨t7ï¼Œåªæœ‰çº¿ç¨‹2å’Œçº¿ç¨‹4è¿˜æ´»ç€ã€‚</li><li>çº¿ç¨‹2å’Œçº¿ç¨‹5å¤±è´¥çš„åŸå› ï¼šçº¿ç¨‹2å› ä¸ºå­¦ä¹ è¡¨ç°ä¸ç†æƒ³ï¼Œè¿åäº†æ¡ä»¶2(b)ï¼Œè€Œçº¿ç¨‹5æ²¡æœ‰åœ¨æˆªæ­¢æ—¶é—´å‰å®Œæˆï¼Œè¿åäº†æ¡ä»¶2(a)ã€‚</li></ol><h5 id="å…³äºè°ƒåº¦ç­–ç•¥Ïˆï¼š"><a href="#å…³äºè°ƒåº¦ç­–ç•¥Ïˆï¼š" class="headerlink" title="å…³äºè°ƒåº¦ç­–ç•¥Ïˆï¼š"></a>å…³äºè°ƒåº¦ç­–ç•¥Ïˆï¼š</h5><p>èµ„æºè°ƒåº¦ç­–ç•¥Ïˆèƒ½å¤Ÿæ ¹æ®å¯¹å­¦ä¹ çŠ¶æ€çš„æ„ŸçŸ¥å’Œå¯¹çº¿ç¨‹å­¦ä¹ è¿›åº¦çš„é¢„æµ‹ï¼Œ<strong>è‡ªé€‚åº”åœ°åˆ†é…èµ„æº</strong>ã€‚</p><p>ç›´è§‚åœ°è¯´ï¼Œå¦‚æœLæ˜¯åŸºäºæ¢¯åº¦è®¡ç®—çš„ï¼Œé‚£ä¹ˆä¸ºä¸€ä¸ªä»»åŠ¡åˆ†é…æ›´å¤šçš„è®¡ç®—èµ„æºæ„å‘³ç€å¯ä»¥ä¸ºè¯¥ä»»åŠ¡æ‰§è¡Œæ›´å¤šçš„æ¢¯åº¦è®¡ç®—</p><ol><li><p><strong>èµ„æºåˆ†é…çš„åŠ¨æ€æ€§</strong>ï¼šåœ¨æ¢¯åº¦ä¸‹é™ç®—æ³•ä¸­ï¼Œå¦‚æœä¸€ä¸ªä»»åŠ¡çº¿ç¨‹ï¼ˆthreadï¼‰è¿›å…¥äº†å¹³å¦çš„æ”¶æ•›åŒºåŸŸï¼Œå³é”™è¯¯ç‡åœ¨è¿‡å»å‡ è½®æ¢¯åº¦è®¡ç®—ä¸­æ²¡æœ‰æ˜¾è‘—ä¸‹é™ï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹è¿›å…¥äº†æ–œç‡åŒºåŸŸï¼Œé”™è¯¯ç‡ä¸‹é™æ›´å¿«ï¼Œèµ„æºè°ƒåº¦ç­–ç•¥Ïˆä¼šæ ¹æ®è¿™äº›ä¿¡æ¯æ¥è°ƒæ•´èµ„æºåˆ†é…ã€‚ä¾‹å¦‚ï¼Œåœ¨è¿­ä»£Ï„1æ—¶ï¼Œå¦‚æœçº¿ç¨‹1è¿›å…¥äº†ä¸€ä¸ªå¹³å¦çš„æ”¶æ•›åŒºåŸŸï¼Œè€Œçº¿ç¨‹2è¿›å…¥äº†æ–œç‡åŒºåŸŸï¼ŒÏˆå°±ä¼šå‡å°‘çº¿ç¨‹1çš„èµ„æºå¹¶é‡æ–°åˆ†é…ç»™çº¿ç¨‹2ã€‚</p></li><li><p><strong>èµ„æºè°ƒåº¦çš„ä¼˜åŒ–</strong>ï¼šèµ„æºè°ƒåº¦ç­–ç•¥Ïˆçš„ç›®æ ‡æ˜¯æé«˜æ•´ä½“çš„ååé‡ï¼ˆthroughputï¼‰ã€‚åœ¨å›¾1(d)çš„ç¤ºä¾‹ä¸­ï¼Œå‡è®¾ä¸¤ä¸ªä»»åŠ¡çº¿ç¨‹æœ€åˆè¢«åˆ†é…äº†ç›¸åŒæ•°é‡çš„èµ„æºã€‚é€šè¿‡åŠ¨æ€è°ƒæ•´èµ„æºåˆ†é…ï¼Œçº¿ç¨‹2å¯ä»¥åœ¨æœ€ç»ˆè¿­ä»£Ï„3è¾¾åˆ°æ›´å¥½çš„çŠ¶æ€bï¼Œè€Œä¸æ˜¯bâ€™ï¼Œè€Œçº¿ç¨‹1åˆ™ç‰ºç‰²äº†è¾¾åˆ°aâ€™çš„æœºä¼šï¼Œè¾¾åˆ°äº†aã€‚è¿™å¯¼è‡´æ•´ä½“ååé‡<strong>ä»0.0æé«˜åˆ°0.5ï¼Œå³çº¿ç¨‹2æ ¹æ®é˜ˆå€¼Ïµ0è¢«åˆ¤å®šä¸ºæˆåŠŸ</strong>ã€‚</p><p><img src="https://s2.loli.net/2024/07/01/ajmr3NCiogPnFVl.png" alt="image-20240701151825121.png"></p></li><li><p><strong>èµ„æºè°ƒåº¦çš„å¹³è¡¡</strong>ï¼šèµ„æºè°ƒåº¦ç­–ç•¥éœ€è¦åœ¨æ¢ç´¢å’Œåˆ©ç”¨ä¹‹é—´æ‰¾åˆ°å¹³è¡¡ã€‚åœ¨æœºå™¨å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½éœ€è¦åœ¨ç»§ç»­åˆ†é…èµ„æºç»™å½“å‰è¡¨ç°ä¸ä½³çš„ä»»åŠ¡çº¿ç¨‹ï¼ˆæ¢ç´¢ï¼‰å’Œå°†èµ„æºé‡æ–°åˆ†é…ç»™è¡¨ç°æ›´å¥½çš„ä»»åŠ¡çº¿ç¨‹ï¼ˆåˆ©ç”¨ï¼‰ä¹‹é—´åšå‡ºé€‰æ‹©ã€‚</p></li><li><p><strong>èµ„æºè°ƒåº¦çš„å¤æ‚æ€§</strong>ï¼šæœºå™¨å­¦ä¹ ä¸­çš„èµ„æºè°ƒåº¦ä¸è®¡ç®—æœºç³»ç»Ÿå’Œæ•°æ®åº“ä¸­çš„èµ„æºè°ƒåº¦ä¸åŒã€‚åœ¨è®¡ç®—æœºç³»ç»Ÿå’Œæ•°æ®åº“ä¸­ï¼Œä¸€æ—¦ä»»åŠ¡æ¥æ”¶åˆ°ï¼Œå®Œæˆè¯¥ä»»åŠ¡æ‰€éœ€çš„èµ„æºé‡é€šå¸¸æ˜¯å·²çŸ¥çš„ï¼Œè€Œåœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œè¿™ä¸ªä¿¡æ¯æ˜¯æœªçŸ¥çš„ï¼Œåªèƒ½é€šè¿‡åœ¨çº¿ç›‘è§†å­¦ä¹ è¿‡ç¨‹æ¥ä¼°è®¡ã€‚</p></li><li><p><strong>åœ¨çº¿æ²»ç†å’ŒçŠ¶æ€ä¼°è®¡</strong>ï¼šåœ¨çº¿æ²»ç†å’ŒçŠ¶æ€ä¼°è®¡éœ€è¦é€šä¿¡å’Œè®¡ç®—èµ„æºï¼Œè¿™å¢åŠ äº†èµ„æºè°ƒåº¦çš„å¤æ‚æ€§ã€‚CoREå­¦ä¹ ç†è®ºè‡ªç„¶æ¶‰åŠåˆ°èµ„æºè°ƒåº¦çš„æ¢ç´¢-åˆ©ç”¨å¹³è¡¡ã€‚</p></li><li><p><strong>CoREå­¦ä¹ ç†è®ºçš„ç›®æ ‡</strong>ï¼šCoREå­¦ä¹ ç†è®ºçš„ä¸€ä¸ªåŸºæœ¬ç›®æ ‡æ˜¯é€šè¿‡å¼•å…¥è°ƒåº¦ï¼Œä½¿æœºå™¨å­¦ä¹ çš„è®¡ç®—èµ„æºèƒ½å¤Ÿä»¥æ—¶é—´å…±äº«çš„æ–¹å¼ä½¿ç”¨ï¼Œè€Œä¸æ˜¯å½“å‰çš„éš¾ä»¥æ‰æ‘¸çš„æ–¹å¼ã€‚è¿™æœ‰åŠ©äºå‡å°‘èµ„æºæµªè´¹ï¼Œå¹¶æé«˜èµ„æºåˆ©ç”¨æ•ˆç‡ã€‚</p></li><li><p><strong>CoREå­¦ä¹ ç®—æ³•çš„è¯æ˜</strong>ï¼šä¸€æ—¦å¼€å‘å‡ºå…·ä½“çš„CoREå­¦ä¹ ç®—æ³•ï¼Œå°±å¯ä»¥è¯æ˜å…¶CoREå¯å­¦ä¹ æ€§ã€‚</p></li></ol><h2 id="æˆæœï¼ˆResultsï¼‰ï¼š"><a href="#æˆæœï¼ˆResultsï¼‰ï¼š" class="headerlink" title="æˆæœï¼ˆResultsï¼‰ï¼š"></a><strong>æˆæœï¼ˆResultsï¼‰ï¼š</strong></h2><ul><li>è®ºæ–‡æå‡ºäº†CoREå­¦ä¹ ç†è®ºï¼Œè¯¥ç†è®ºè€ƒè™‘äº†è®¡ç®—èµ„æºçš„è°ƒåº¦ç­–ç•¥ï¼Œå…è®¸æœºå™¨å­¦ä¹ ä»»åŠ¡åƒè®¡ç®—æœºç³»ç»Ÿå’Œæ•°æ®åº“çš„æ—¶é—´å…±äº«æŠ€æœ¯ä¸€æ ·è¿è¡Œã€‚</li><li>é€šè¿‡å®šä¹‰CoREå¯å­¦ä¹ æ€§ï¼Œä½œè€…æä¾›äº†ä¸€ç§è¯„ä¼°å­¦ä¹ ç®—æ³•åœ¨æœ‰é™èµ„æºä¸‹æ€§èƒ½çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬æ•°æ®ååé‡å’Œçº¿ç¨‹ååé‡çš„é™åˆ¶æ¡ä»¶ã€‚</li></ul><h2 id="ç»“è®ºï¼ˆConclusionï¼‰ï¼š"><a href="#ç»“è®ºï¼ˆConclusionï¼‰ï¼š" class="headerlink" title="ç»“è®ºï¼ˆConclusionï¼‰ï¼š"></a><strong>ç»“è®ºï¼ˆConclusionï¼‰ï¼š</strong></h2><ul><li>CoREå­¦ä¹ ç†è®ºå¼ºè°ƒäº†åœ¨æœºå™¨å­¦ä¹ ä¸­è€ƒè™‘æ—¶é—´å…±äº«è®¡ç®—èµ„æºçš„é‡è¦æ€§ï¼Œç›®æ ‡æ˜¯å®ç°è®¡ç®—èµ„æºçš„é«˜æ•ˆåˆ©ç”¨ï¼Œç±»ä¼¼äºè®¡ç®—æœºç³»ç»Ÿçš„æ—¶é—´å…±äº«æŠ€æœ¯ã€‚</li><li>é€šè¿‡å¼•å…¥è°ƒåº¦ç­–ç•¥ï¼ŒCoREå­¦ä¹ å¯ä»¥æ›´å¥½åœ°å¹³è¡¡ç”¨æˆ·æ•ˆç‡å’Œç¡¬ä»¶æ•ˆç‡ï¼Œæé«˜æœºå™¨å­¦ä¹ ä»»åŠ¡çš„æ•´ä½“ååé‡ã€‚</li><li>è®ºæ–‡æŒ‡å‡ºï¼ŒCoREå­¦ä¹ ç†è®ºä¸ºæœºå™¨å­¦ä¹ ä¸­çš„èµ„æºè°ƒåº¦æä¾›äº†æ–°çš„ç ”ç©¶æ–¹å‘ï¼ŒåŒ…æ‹¬å¦‚ä½•åœ¨çº¿æœ‰æ•ˆåœ°ç®¡ç†å’Œä¼°è®¡æœºå™¨å­¦ä¹ è¿‡ç¨‹çš„çŠ¶æ€å’Œè¿›åº¦ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> æœºå™¨å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æœºå™¨å­¦ä¹  </tag>
            
            <tag> åˆ†æ—¶è®¡ç®— </tag>
            
            <tag> ç³»ç»Ÿä¼˜åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MIT 6.824 Lecture 1-Introduction</title>
      <link href="/2024/07/01/MIT%206.824%20Lecture%201-Introduction/"/>
      <url>/2024/07/01/MIT%206.824%20Lecture%201-Introduction/</url>
      
        <content type="html"><![CDATA[<h2 id="MIT-6-824-Lecture-1-Introduction"><a href="#MIT-6-824-Lecture-1-Introduction" class="headerlink" title="MIT 6.824: Lecture 1-Introduction"></a>MIT 6.824: Lecture 1-Introduction</h2><h3 id="Lecture-1-Introdunction"><a href="#Lecture-1-Introdunction" class="headerlink" title="Lecture 1-Introdunction"></a>Lecture 1-Introdunction</h3><h4 id="1-1ä¸ºä»€ä¹ˆåˆ†å¸ƒå¼ï¼š"><a href="#1-1ä¸ºä»€ä¹ˆåˆ†å¸ƒå¼ï¼š" class="headerlink" title="1.1ä¸ºä»€ä¹ˆåˆ†å¸ƒå¼ï¼š"></a>1.1<strong>ä¸ºä»€ä¹ˆåˆ†å¸ƒå¼ï¼š</strong></h4><ul><li>è¿æ¥ä¸åŒç‰©ç†å®ä½“</li><li>é€šè¿‡éš”ç¦»å®ç°å®‰å…¨</li><li>é€šè¿‡å¤åˆ¶å®ç°å®¹é”™</li><li>å¹¶è¡Œçš„cpuã€memã€diskã€netå®ç°æ‰©å±•</li></ul><h4 id="1-2åˆ†å¸ƒå¼ç³»ç»Ÿï¼š"><a href="#1-2åˆ†å¸ƒå¼ç³»ç»Ÿï¼š" class="headerlink" title="1.2åˆ†å¸ƒå¼ç³»ç»Ÿï¼š"></a>1.2<strong>åˆ†å¸ƒå¼ç³»ç»Ÿï¼š</strong></h4><p>Hadoopï¼ˆ hdfs , yarn , <a href="https://so.csdn.net/so/search?q=MapReduce&spm=1001.2101.3001.7020">MapReduce</a> )<br>Spark æ‰¹å¤„ç†<br>Storm ï¼Œ Flink æµå¤„ç†<br>Hbase K&#x2F;Våˆ†å¸ƒå¼æ•°æ®åº“<br>Kafka æ¶ˆæ¯é˜Ÿåˆ—</p><h4 id="1-3Lab"><a href="#1-3Lab" class="headerlink" title="1.3Lab:"></a>1.3<strong>Lab:</strong></h4><p>1-MapReduce</p><p>2-Raft:ç®¡ç†å¤åˆ¶å’Œå‰”é™¤</p><p>3-k&#x2F;v server</p><p>4-shard k&#x2F;v service</p><h4 id="1-4-Infrastructure-Abstraction"><a href="#1-4-Infrastructure-Abstraction" class="headerlink" title="1.4 Infrastructure-Abstraction"></a>1.4 <strong>Infrastructure-Abstraction</strong></h4><ol><li>storage :star:</li><li>communications</li><li>computation-MapReduce</li></ol><h4 id="1-5-Implementation"><a href="#1-5-Implementation" class="headerlink" title="1.5 Implementation:"></a>1.5 Implementation:</h4><p>examples: RPC, Threads,Lock</p><h4 id="1-6Performance"><a href="#1-6Performance" class="headerlink" title="1.6Performance:"></a>1.6Performance:</h4><p>scalability-&gt; 2 * computers-&gt; 2 * throughput</p><h4 id="1-7-Fault-Tolerance"><a href="#1-7-Fault-Tolerance" class="headerlink" title="1.7 Fault Tolerance:"></a>1.7 Fault Tolerance:</h4><p><strong>Availability</strong></p><p><strong>Recoverability</strong></p><p>tools:</p><p>NV storage</p><p>Replication</p><p><strong>Consistency</strong></p><p>put(k,v)</p><p>get(k)-&gt;v</p><p>strong?weak?</p><h4 id="1-8MapReduce"><a href="#1-8MapReduce" class="headerlink" title="1.8MapReduce"></a>1.8<strong>MapReduce</strong></h4><p>Map Function &amp; <a href="https://so.csdn.net/so/search?q=Reduce&spm=1001.2101.3001.7020">Reduce</a> Function<br>å†™å¥½mapreduceç¨‹åºï¼Œæ— éœ€å…³å¿ƒå…·ä½“åˆ†å¸ƒå¼å®ç°<br>WordCountä¾‹å­</p><p>INPUT1-&gt;MAP a,1 b,1</p><p>INPUT2-&gt;MAP   b,1</p><p>INPUT3-&gt;MAP    a,1         c,1</p><p>get intermediate output</p><p>Then Reduces(åˆ†æ²»æ€æƒ³)</p><p><strong>Map(k,v):</strong></p><p>split v into words</p><p>for each word </p><p>emit(w,â€1)</p><p><strong>Reduce(k,v):</strong></p><p>emit(len(v))</p><p><strong>ç®€è¿°ï¼š</strong></p><p>map&#x2F;shuffle&#x2F;reduce</p><p>masterç»™workersåˆ†é…ä»»åŠ¡ï¼Œè¾“å…¥è¢«åˆ†æˆMä»½ï¼ˆMä¸ªmap taskï¼ŒMæ¯”workerå¤šï¼‰ï¼Œæ¯ä»½æœ‰3ä¸ªå¤‡ä»½ï¼›å¯¹æ¯ä»½è¾“å…¥è°ƒç”¨Map()ï¼Œäº§å‡º(k2,v2)çš„ä¸­é—´ç»“æœï¼Œåœ¨æœ¬åœ°HashæˆRä»½ï¼Œä¼ é€’ç»™Rä¸ªReduce()ï¼Œæ¯ä¸ªReduce taskå†™ä¸€ä¸ªç»“æœæ–‡ä»¶</p><p><strong>éšè—çš„ç»†èŠ‚ï¼š</strong></p><p>è·Ÿè¸ªtaskçš„å®Œæˆæƒ…å†µã€æ•°æ®ç§»åŠ¨ã€é”™è¯¯æ¢å¤</p><p><strong>å¥½çš„è´Ÿè½½å‡è¡¡ï¼š</strong></p><p>tasksæ¯”workerså¤šï¼Œworkerså®Œæˆtaskåmasterç»§ç»­ç»™å®ƒåˆ†é…</p><p><strong>å®¹é”™ï¼š</strong></p><p>æŸä¸ªæœåŠ¡å™¨åœ¨è¿è¡ŒMRä»»åŠ¡æ—¶å´©æºƒï¼Œåªéœ€é‡æ–°è¿è¡Œç›¸åº”çš„Mapå’ŒReduceè€Œä¸ç”¨æ•´ä¸ªä»»åŠ¡é‡æ–°è¿è¡Œï¼›</p><p>è¿™ä¾èµ–Mapå’ŒReduceæ˜¯çº¯å‡½æ•°ï¼Œå³ï¼š</p><p>ä¸ä¿å­˜çŠ¶æ€ã€</p><p>ä¸è¯»å†™é¢å¤–çš„æ–‡ä»¶ã€</p><p>æ²¡æœ‰taské—´éšè—çš„é€šä¿¡</p><p>å´©æºƒæ¢å¤ï¼š</p><p>Map workerå´©æºƒï¼š</p><p>é‡æ–°ç»™åŒ…å«è¯¥è¾“å…¥çš„å‰¯æœ¬çš„workeråˆ†é…è¯¥taskï¼ˆå¯èƒ½ä¸€äº›Reduce workerå·²ç»è¯»å–äº†è¯¥Mapçš„éƒ¨åˆ†è¾“å…¥ï¼Œä¸è¦ç´§ï¼ŒMapæ˜¯çº¯å‡½æ•°ï¼‰ï¼›</p><p>å¦‚æœè¯¥Mapçš„ä¸­é—´ç»“æœéƒ½å·²è¢«è¯»å–ï¼Œåˆ™ä¸ç”¨é‡æ–°è¿è¡Œ</p><p>Reduce workerå´©æºƒï¼š</p><p>è¯¥workerå·²è¿è¡Œå®Œçš„taskä¸ç”¨é‡æ–°è¿è¡Œï¼ˆç»“æœå·²å­˜åˆ°GFSï¼‰</p><p>åªéœ€é‡æ–°è¿è¡Œæœªå®Œæˆçš„task</p><p>å¦‚æœReduce workerå†™æ•°æ®ä¸­é€”å´©æºƒï¼Œä¸è¦ç´§ï¼ŒGFSä¼šåœ¨å†™å…¥å®Œæˆæ—¶æ‰é‡å‘½åæ–‡ä»¶ï¼Œæ‰€ä»¥ç›¸å½“äºåŸå­æ“ä½œï¼Œæœªå†™å…¥å®Œæˆå¯é‡æ–°è¿è¡Œ</p><p>å…¶ä»–é—®é¢˜ï¼š</p><p>ç»™ä¸¤ä¸ªworkeråˆ†é…äº†åŒæ ·çš„Map task â€” åªä¼šå‘Šè¯‰Reduce workerå…¶ä¸­çš„ä¸€ä¸ªï¼›</p><p>ç»™ä¸¤ä¸ªworkeråˆ†é…äº†åŒæ„çš„Reduce task â€” GFSçš„åŸå­å†™å…¥æ“ä½œå¯è§£å†³</p><h5 id="è¯¦è§£MapReduceæµç¨‹"><a href="#è¯¦è§£MapReduceæµç¨‹" class="headerlink" title="è¯¦è§£MapReduceæµç¨‹"></a>è¯¦è§£MapReduceæµç¨‹</h5><p>MapReduce ç¼–ç¨‹æ¨¡å‹å¼€å‘ç®€å•ä¸”åŠŸèƒ½å¼ºå¤§ï¼Œä¸“é—¨ä¸ºå¹¶è¡Œå¤„ç†å¤§è§„æ¨¡æ•°æ®é‡è€Œè®¾è®¡ï¼Œæ¥ä¸‹æ¥ï¼Œé€šè¿‡ä¸€å¼ å›¾æ¥æè¿° MapReduce çš„å·¥ä½œè¿‡ç¨‹ï¼Œå¦‚å›¾æ‰€ç¤º</p><p><img src="https://s2.loli.net/2024/07/01/WUEdQxVR1YjkirO.png" alt="20210617002320632[1].png"></p><h6 id="æ•´ä½“æµç¨‹ï¼ˆ5æ­¥ï¼‰"><a href="#æ•´ä½“æµç¨‹ï¼ˆ5æ­¥ï¼‰" class="headerlink" title="æ•´ä½“æµç¨‹ï¼ˆ5æ­¥ï¼‰"></a><strong>æ•´ä½“æµç¨‹</strong>ï¼ˆ5æ­¥ï¼‰</h6><p>åœ¨ä¸Šå›¾ä¸­ï¼Œ MapReduce çš„å·¥ä½œæµç¨‹å¤§è‡´å¯ä»¥åˆ†ä¸º5æ­¥ï¼Œå…·ä½“å¦‚ä¸‹:</p><p><img src="https://s2.loli.net/2024/07/01/tnpNC4mId71EfB9.png" alt="20210617001737183[1].png"></p><h6 id="1-åˆ†ç‰‡ã€æ ¼å¼åŒ–æ•°æ®æºï¼š"><a href="#1-åˆ†ç‰‡ã€æ ¼å¼åŒ–æ•°æ®æºï¼š" class="headerlink" title="1.åˆ†ç‰‡ã€æ ¼å¼åŒ–æ•°æ®æºï¼š"></a>1.åˆ†ç‰‡ã€æ ¼å¼åŒ–æ•°æ®æºï¼š</h6><p>è¾“å…¥ Map é˜¶æ®µçš„æ•°æ®æºï¼Œå¿…é¡»ç»è¿‡åˆ†ç‰‡å’Œæ ¼å¼åŒ–æ“ä½œã€‚</p><p>åˆ†ç‰‡æ“ä½œï¼šæŒ‡çš„æ˜¯å°†æºæ–‡ä»¶åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„å°æ•°æ®å—( Hadoop 2.x ä¸­é»˜è®¤ 128MB )ï¼Œä¹Ÿå°±æ˜¯åˆ†ç‰‡( split )ï¼Œ<br>Hadoop ä¼šä¸ºæ¯ä¸€ä¸ªåˆ†ç‰‡æ„å»ºä¸€ä¸ª Map ä»»åŠ¡ï¼Œå¹¶ç”±è¯¥ä»»åŠ¡è¿è¡Œè‡ªå®šä¹‰çš„ map() å‡½æ•°ï¼Œä»è€Œå¤„ç†åˆ†ç‰‡é‡Œçš„æ¯ä¸€æ¡è®°å½•;<br>æ ¼å¼åŒ–æ“ä½œï¼šå°†åˆ’åˆ†å¥½çš„åˆ†ç‰‡( split )æ ¼å¼åŒ–ä¸ºé”®å€¼å¯¹&lt;key,value&gt;å½¢å¼çš„æ•°æ®ï¼Œå…¶ä¸­ï¼Œ key ä»£è¡¨åç§»é‡ï¼Œ value ä»£è¡¨æ¯ä¸€è¡Œå†…å®¹ã€‚</p><h6 id="2-æ‰§è¡Œ-MapTask"><a href="#2-æ‰§è¡Œ-MapTask" class="headerlink" title="2.æ‰§è¡Œ MapTask"></a>2.æ‰§è¡Œ MapTask</h6><p>æ¯ä¸ª Map ä»»åŠ¡éƒ½æœ‰ä¸€ä¸ª<strong>å†…å­˜ç¼“å†²åŒº(<strong>ç¼“å†²åŒºå¤§å° 100MB )ï¼Œè¾“å…¥çš„åˆ†ç‰‡( split )æ•°æ®ç»è¿‡ <strong>Map ä»»åŠ¡å¤„ç†åçš„ä¸­é—´ç»“æœä¼šå†™å…¥å†…å­˜ç¼“å†²åŒº</strong>ä¸­ã€‚<br>å¦‚æœå†™å…¥çš„æ•°æ®è¾¾åˆ°å†…å­˜ç¼“å†²çš„é˜ˆå€¼( 80MB )ï¼Œä¼šå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹å°†å†…å­˜ä¸­çš„</strong>æº¢å‡ºæ•°æ®å†™å…¥ç£ç›˜</strong>ï¼ŒåŒæ—¶ä¸å½±å“ Map ä¸­é—´ç»“æœç»§ç»­å†™å…¥ç¼“å†²åŒºã€‚<br>åœ¨æº¢å†™è¿‡ç¨‹ä¸­ï¼Œ MapReduce æ¡†æ¶ä¼šå¯¹ key è¿›è¡Œæ’åºï¼Œå¦‚æœä¸­é—´ç»“æœæ¯”è¾ƒå¤§ï¼Œä¼šå½¢æˆå¤šä¸ªæº¢å†™æ–‡ä»¶ï¼Œæœ€åçš„ç¼“å†²åŒºæ•°æ®ä¹Ÿä¼šå…¨éƒ¨æº¢å†™å…¥ç£ç›˜å½¢æˆä¸€ä¸ªæº¢å†™æ–‡ä»¶ï¼Œå¦‚æœæ˜¯å¤šä¸ªæº¢å†™æ–‡ä»¶ï¼Œåˆ™æœ€ååˆå¹¶æ‰€æœ‰çš„æº¢å†™æ–‡ä»¶ä¸ºä¸€ä¸ªæ–‡ä»¶ã€‚</p><p><img src="https://s2.loli.net/2024/07/01/xX9Zz4vyNIRLVUu.png" alt="20210617001954380[1].png"></p><ol><li><strong>Read é˜¶æ®µ</strong>ï¼š MapTask é€šè¿‡ç”¨æˆ·ç¼–å†™çš„ RecordReader ï¼Œä»è¾“å…¥çš„ InputSplit ä¸­è§£æå‡ºä¸€ä¸ªä¸ª key &#x2F; value ã€‚</li><li><strong>Map é˜¶æ®µ</strong>ï¼šå°†è§£æå‡ºçš„ key &#x2F; value äº¤ç»™ç”¨æˆ·ç¼–å†™çš„ Map ()å‡½æ•°å¤„ç†ï¼Œå¹¶äº§ç”Ÿä¸€ç³»åˆ—æ–°çš„ key &#x2F; value ã€‚</li><li><strong>Collect é˜¶æ®µï¼š</strong>åœ¨ç”¨æˆ·ç¼–å†™çš„ map() å‡½æ•°ä¸­ï¼Œæ•°æ®å¤„ç†å®Œæˆåï¼Œä¸€èˆ¬ä¼šè°ƒç”¨ <strong>outputCollector.collect() è¾“å‡ºç»“æœ</strong>ï¼Œåœ¨è¯¥å‡½æ•°å†…éƒ¨ï¼Œå®ƒä¼šå°†ç”Ÿæˆçš„ key &#x2F; value åˆ†ç‰‡(é€šè¿‡è°ƒç”¨ partitioner )ï¼Œå¹¶å†™å…¥ä¸€ä¸ªç¯å½¢å†…å­˜ç¼“å†²åŒºä¸­(è¯¥ç¼“å†²åŒºé»˜è®¤å¤§å°æ˜¯ 100MB )ã€‚</li><li><strong>Spill é˜¶æ®µ</strong>ï¼šå³â€œæº¢å†™â€ï¼Œå½“ç¼“å†²åŒºå¿«è¦æº¢å‡ºæ—¶(é»˜è®¤è¾¾åˆ°ç¼“å†²åŒºå¤§å°çš„ 80 %)ï¼Œä¼šåœ¨<strong>æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿåˆ›å»ºä¸€ä¸ªæº¢å‡ºæ–‡ä»¶</strong>ï¼Œå°†è¯¥ç¼“å†²åŒºçš„æ•°æ®å†™å…¥è¿™ä¸ªæ–‡ä»¶ã€‚</li></ol><ul><li><p>å°†æ•°æ®å†™å…¥æœ¬åœ°ç£ç›˜å‰ï¼Œå…ˆè¦å¯¹æ•°æ®è¿›è¡Œä¸€æ¬¡<strong>æœ¬åœ°æ’åº</strong>ï¼Œå¹¶åœ¨å¿…è¦æ—¶å¯¹æ•°æ®è¿›è¡Œ<strong>åˆå¹¶ã€å‹ç¼©</strong>ç­‰æ“ä½œã€‚å†™å…¥ç£ç›˜ä¹‹å‰ï¼Œçº¿ç¨‹ä¼šæ ¹æ® ReduceTask çš„æ•°é‡ï¼Œå°†æ•°æ®åˆ†åŒºï¼Œä¸€ä¸ª Reduce ä»»åŠ¡å¯¹åº”ä¸€ä¸ªåˆ†åŒºçš„æ•°æ®ã€‚</p><p>è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†é¿å…æœ‰äº› Reduce ä»»åŠ¡åˆ†é…åˆ°å¤§é‡æ•°æ®ï¼Œè€Œæœ‰äº› Reduce ä»»åŠ¡åˆ†åˆ°å¾ˆå°‘çš„æ•°æ®ï¼Œç”šè‡³æ²¡æœ‰åˆ†åˆ°æ•°æ®çš„å°´å°¬å±€é¢ã€‚</p><p>å¦‚æœæ­¤æ—¶è®¾ç½®äº† Combiner ï¼Œå°†æ’åºåçš„ç»“æœè¿›è¡Œ Combine æ“ä½œï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯å°½å¯èƒ½å°‘åœ°æ‰§è¡Œæ•°æ®å†™å…¥ç£ç›˜çš„æ“ä½œã€‚</p></li></ul><ol start="5"><li><strong>Combine é˜¶æ®µ</strong>ï¼šå½“æ‰€æœ‰æ•°æ®å¤„ç†å®Œæˆä»¥åï¼Œ MapTask ä¼šå¯¹æ‰€æœ‰<strong>ä¸´æ—¶æ–‡ä»¶</strong>è¿›è¡Œä¸€æ¬¡åˆå¹¶ï¼Œä»¥ç¡®ä¿æœ€ç»ˆåªä¼šç”Ÿæˆä¸€ä¸ªæ•°æ®æ–‡ä»¶</li></ol><ul><li>åˆå¹¶çš„è¿‡ç¨‹ä¸­ä¼šä¸æ–­åœ°è¿›è¡Œæ’åºå’Œ Combine æ“ä½œï¼Œ</li><li>å…¶ç›®çš„æœ‰ä¸¤ä¸ªï¼šä¸€æ˜¯å°½é‡å‡å°‘æ¯æ¬¡å†™å…¥ç£ç›˜çš„æ•°æ®é‡;äºŒæ˜¯å°½é‡å‡å°‘ä¸‹ä¸€å¤åˆ¶é˜¶æ®µç½‘ç»œä¼ è¾“çš„æ•°æ®é‡ã€‚</li><li>æœ€ååˆå¹¶æˆäº†ä¸€ä¸ªå·²åˆ†åŒºä¸”å·²æ’åºçš„æ–‡ä»¶ã€‚</li></ul><h6 id="3-æ‰§è¡Œ-Shuffle-è¿‡ç¨‹"><a href="#3-æ‰§è¡Œ-Shuffle-è¿‡ç¨‹" class="headerlink" title="3.æ‰§è¡Œ Shuffle è¿‡ç¨‹"></a>3.æ‰§è¡Œ Shuffle è¿‡ç¨‹</h6><p>MapReduce å·¥ä½œè¿‡ç¨‹ä¸­ï¼Œ Map é˜¶æ®µå¤„ç†çš„æ•°æ®å¦‚ä½•ä¼ é€’ç»™ Reduce é˜¶æ®µï¼Œè¿™æ˜¯ MapReduce æ¡†æ¶ä¸­å…³é”®çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹å«ä½œ Shuffle ã€‚<br>Shuffle ä¼šå°† <strong>MapTask è¾“å‡ºçš„å¤„ç†ç»“æœæ•°æ®åˆ†å‘ç»™ ReduceTask ï¼Œå¹¶åœ¨åˆ†å‘çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹æ•°æ®æŒ‰ key è¿›è¡Œåˆ†åŒºå’Œæ’åºã€‚</strong></p><h6 id="4-æ‰§è¡Œ-ReduceTask"><a href="#4-æ‰§è¡Œ-ReduceTask" class="headerlink" title="4.æ‰§è¡Œ ReduceTask"></a>4.æ‰§è¡Œ ReduceTask</h6><p>è¾“å…¥ ReduceTask çš„æ•°æ®æµæ˜¯&lt;key, {value list}&gt;å½¢å¼ï¼Œç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰ reduce()æ–¹æ³•è¿›è¡Œé€»è¾‘å¤„ç†ï¼Œæœ€ç»ˆä»¥&lt;key, value&gt;çš„å½¢å¼è¾“å‡ºã€‚</p><p><img src="https://s2.loli.net/2024/07/01/NmOz8SnbXaMeAET.png" alt="20210617002008269[1].png"></p><ol><li><p><strong>Copy é˜¶æ®µï¼š</strong> Reduce ä¼šä»å„ä¸ª MapTask ä¸Šè¿œç¨‹å¤åˆ¶ä¸€ç‰‡æ•°æ®ï¼ˆæ¯ä¸ª MapTask ä¼ æ¥çš„æ•°æ®éƒ½æ˜¯æœ‰åºçš„ï¼‰ï¼Œå¹¶é’ˆå¯¹æŸä¸€ç‰‡æ•°æ®ï¼Œ<strong>å¦‚æœå…¶å¤§å°è¶…è¿‡ä¸€å®šåœ‹å€¼ï¼Œåˆ™å†™åˆ°ç£ç›˜ä¸Šï¼Œå¦åˆ™ç›´æ¥æ”¾åˆ°å†…å­˜ä¸­</strong></p></li><li><p><strong>Merge é˜¶æ®µ</strong>ï¼šåœ¨è¿œç¨‹å¤åˆ¶æ•°æ®çš„åŒæ—¶ï¼Œ ReduceTask ä¼šå¯åŠ¨ä¸¤ä¸ªåå°çº¿ç¨‹ï¼Œåˆ†åˆ«å¯¹å†…å­˜å’Œç£ç›˜ä¸Šçš„æ–‡ä»¶è¿›è¡Œåˆå¹¶ï¼Œä»¥é˜²æ­¢å†…å­˜ä½¿ç”¨è¿‡å¤šæˆ–è€…ç£ç›˜æ–‡ä»¶è¿‡å¤šã€‚</p></li><li><p><strong>Sort é˜¶æ®µ</strong>ï¼šç”¨æˆ·ç¼–å†™ reduce() æ–¹æ³•è¾“å…¥æ•°æ®æ˜¯æŒ‰ key è¿›è¡Œèšé›†çš„ä¸€ç»„æ•°æ®ã€‚<br>ä¸ºäº†å°† key ç›¸åŒçš„æ•°æ®èšåœ¨ä¸€èµ·ï¼Œ Hadoop é‡‡ç”¨äº†åŸºäºæ’åºçš„ç­–ç•¥ã€‚<br>ç”±äºå„ä¸ª MapTask å·²ç»å®ç°å¯¹è‡ªå·±çš„å¤„ç†ç»“æœè¿›è¡Œäº†<strong>å±€éƒ¨æ’åº</strong>ï¼Œå› æ­¤ï¼Œ ReduceTask åªéœ€å¯¹æ‰€æœ‰æ•°æ®è¿›è¡Œä¸€æ¬¡<strong>å½’å¹¶æ’åºå³å¯</strong>ã€‚</p></li><li><p><strong>Reduce é˜¶æ®µï¼š</strong>å¯¹æ’åºåçš„é”®å€¼å¯¹è°ƒç”¨ reduce() æ–¹æ³•ï¼Œé”®ç›¸ç­‰çš„é”®å€¼å¯¹è°ƒç”¨ä¸€æ¬¡ reduce()æ–¹æ³•ï¼Œæ¯æ¬¡è°ƒç”¨ä¼šäº§ç”Ÿé›¶ä¸ªæˆ–è€…å¤šä¸ªé”®å€¼å¯¹ï¼Œæœ€åæŠŠè¿™äº›è¾“å‡ºçš„é”®å€¼å¯¹å†™å…¥åˆ° HDFS ä¸­</p></li><li><p><strong>Write é˜¶æ®µ</strong>ï¼š reduce() å‡½æ•°å°†è®¡ç®—ç»“æœå†™åˆ° HDFS ä¸Šã€‚<br>åˆå¹¶çš„è¿‡ç¨‹ä¸­ä¼šäº§ç”Ÿè®¸å¤šçš„ä¸­é—´æ–‡ä»¶(å†™å…¥ç£ç›˜äº†)ï¼Œä½† MapReduce ä¼šè®©å†™å…¥ç£ç›˜çš„æ•°æ®å°½å¯èƒ½åœ°å°‘ï¼Œå¹¶ä¸”æœ€åä¸€æ¬¡åˆå¹¶çš„ç»“æœå¹¶æ²¡æœ‰å†™å…¥ç£ç›˜ï¼Œè€Œæ˜¯ç›´æ¥è¾“å…¥åˆ° Reduce å‡½æ•°ã€‚</p></li></ol><h6 id="5-å†™å…¥æ–‡ä»¶"><a href="#5-å†™å…¥æ–‡ä»¶" class="headerlink" title="5.å†™å…¥æ–‡ä»¶"></a>5.å†™å…¥æ–‡ä»¶</h6><p>MapReduce æ¡†æ¶ä¼šè‡ªåŠ¨æŠŠ ReduceTask ç”Ÿæˆçš„&lt;key, value&gt;ä¼ å…¥ OutputFormat çš„ write æ–¹æ³•ï¼Œå®ç°æ–‡ä»¶çš„å†™å…¥æ“ä½œã€‚</p><h5 id="MapReduceè®ºæ–‡é˜…è¯»"><a href="#MapReduceè®ºæ–‡é˜…è¯»" class="headerlink" title="MapReduceè®ºæ–‡é˜…è¯»"></a>MapReduceè®ºæ–‡é˜…è¯»</h5><h6 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h6><p>MapReduceï¼Œæ˜¯ Google æ—©å¹´æå‡ºäº†ä¸€ç§è½¯ä»¶æ¶æ„æ¨¡å‹ï¼Œæ”¯æŒå¤§è§„æ¨¡æ•°æ®é›†çš„å¹¶è¡Œè¿ç®—ã€‚ç°åœ¨è¿™ä¸ªæ¦‚å¿µè¢«è¿ç”¨åœ¨å¤§é‡åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ã€‚</p><p>ç›¸å…³çš„ç†è®ºç”± Google åœ¨ 2004 å¹´å‘è¡¨åœ¨è®ºæ–‡ã€ŠMapReduce: Simplified Data Processing on Large Clustersã€‹ä¸­ï¼Œå¯ä»¥åœ¨è¿™é‡Œé˜…è¯»å…¨æ–‡ã€‚13 é¡µçš„å°è®ºæ–‡ï¼Œä¿¡æ¯å¯†åº¦æ¯”æŸäº›å°è®ºæ–‡ä¸çŸ¥é“é«˜åˆ°å“ªé‡Œå»äº†ã€‚</p><p>ç”±äºæœ¬æ–‡æ˜¯è¾¹é˜…è¯»è®ºæ–‡è¾¹è®°å½•ä¸‹æ¥çš„ç¬”è®°ï¼Œæ‰€ä»¥å†…å®¹å¯èƒ½æ¯”è¾ƒæ··ä¹±ã€‚</p><h6 id="ç¼–ç¨‹æ¨¡å‹"><a href="#ç¼–ç¨‹æ¨¡å‹" class="headerlink" title="ç¼–ç¨‹æ¨¡å‹"></a>ç¼–ç¨‹æ¨¡å‹</h6><p>MapReduce æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„å¹¶è¡Œå¤„ç†æ¨¡å‹ï¼Œä½¿ç”¨ MapReduce æ¡†æ¶ï¼Œç”¨æˆ·åªéœ€è¦æŒ‡å®šä¸¤ä¸ªå‡½æ•°ï¼š</p><p>Map å‡½æ•°ï¼Œè´Ÿè´£å°†ä¸€ä¸ªé”®å€¼å¯¹å¤„ç†æˆä¸€ç³»åˆ—ä¸­é—´é”®å€¼å¯¹<br>Reduce å‡½æ•°ï¼Œè´Ÿè´£å°†æ‰€æœ‰å…·æœ‰ç›¸åŒ key çš„ä¸­é—´å€¼åˆå¹¶<br>å‰©ä¸‹çš„ï¼Œå°±ç”±æ¡†æ¶è‡ªè¡Œå¤„ç†ï¼ŒåŒ…æ‹¬æ•°æ®åˆ†å‘ã€ä»»åŠ¡åˆ†å‘ã€é”™è¯¯å¤„ç†ã€è´Ÿè½½å‡è¡¡ç­‰ç­‰ç»†èŠ‚ã€‚ç”¨æˆ·æ— éœ€æŒæ¡è¿™äº›ç»†èŠ‚ï¼Œæ›´èƒ½å…³æ³¨äºä¸šåŠ¡é€»è¾‘ã€‚</p><p>ä¸€ä¸ªå¤§è‡´çš„å¤„ç†æµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><p>Map æ¥å—ä¸€ä¸ªè¾“å…¥é”®å€¼å¯¹ï¼Œäº§ç”Ÿä¸€ç³»åˆ—ä¸­é—´é”®å€¼å¯¹ã€‚MapReduce æ¡†æ¶å°†æ‰€æœ‰å…·æœ‰ç›¸åŒçš„ä¸­é—´ key çš„ä¸­é—´å€¼ç»„ç»‡åˆ°ä¸€èµ·ï¼Œä¼ é€’ç»™ Reduce å‡½æ•°ã€‚Reduce å‡½æ•°ï¼Œæ¥æ”¶ä¸€ä¸ªä¸­é—´ key å’Œä¸€ç³»åˆ—ä¸­é—´å€¼ï¼Œå‡½æ•°é€šå¸¸å°†è¿™äº›å€¼èšåˆæˆä¸€ä¸ªè¾ƒå°çš„é›†åˆï¼Œæœ‰æ—¶æ¯æ¬¡ Reduce å‡½æ•°è°ƒç”¨åªä¼šäº§ç”Ÿä¸€ä¸ªç»“æœå€¼ï¼Œç”šè‡³ä¸äº§ç”Ÿç»“æœã€‚</p><p>ä»¥å¤§è§„æ¨¡æ–‡æœ¬å•è¯è®¡æ•°ä¸ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">map(String key, String value):</span><br><span class="line">    // keyï¼šæ–‡ç« åç§°</span><br><span class="line">    // valueï¼šæ–‡ç« å†…å®¹</span><br><span class="line">    for å•è¯ w in value:</span><br><span class="line">        å¢åŠ ä¸­é—´è®¡æ•°(w, &quot;1&quot;)</span><br><span class="line"></span><br><span class="line">reduce(String key, Iterator values):</span><br><span class="line">    // keyï¼šä¸€ä¸ªå•è¯</span><br><span class="line">    // valueï¼šä¸€ç³»åˆ—è®¡æ•°</span><br><span class="line">    int result = 0;</span><br><span class="line">    for v in values:</span><br><span class="line">        result += ParseInt(v);</span><br><span class="line">    è¾“å‡º(ToString(result))</span><br></pre></td></tr></table></figure><h6 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h6><h6 id="æ‰§è¡Œæµç¨‹"><a href="#æ‰§è¡Œæµç¨‹" class="headerlink" title="æ‰§è¡Œæµç¨‹"></a>æ‰§è¡Œæµç¨‹</h6><p>MapReduce ä½œä¸ºä¸€ç§ç¼–ç¨‹æ¨¡å‹æˆ–è€…è¯´ç¼–ç¨‹æ€æƒ³ï¼Œå®ç°æ–¹å¼å¯ä»¥æœ‰å¾ˆå¤šã€‚Google åœ¨è®ºæ–‡ä¸­ç»™å‡ºäº†ä¸€ç§å®ç°æ–¹æ³•ï¼Œç”¨äºå±€åŸŸç½‘å†…äº’ç›¸è¿æ¥çš„å¤§é‡æœºå™¨ã€‚æ‰§è¡Œæµç¨‹å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://s2.loli.net/2024/07/01/8MI6BTnkWy12GSt.jpg" alt="f292944c2748e9621815ada5cdb50bc7[1].png"></p><p>MapReduce æ¡†æ¶é¦–å…ˆå°†è¾“å…¥æ–‡ä»¶åˆ’åˆ†ä¸º M ç‰‡ï¼Œæ¯ç‰‡é€šå¸¸ä¸º 16MB åˆ° 64MB å¤§å°ã€‚éšåä¼šå¯åŠ¨é›†ç¾¤ä¸­çš„æœºå™¨ï¼ˆè¿›ç¨‹ï¼‰ã€‚<br>é›†ç¾¤ä¸­çš„ä¸€ä¸ªè¿›ç¨‹æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„ master è¿›ç¨‹ã€‚å‰©ä½™çš„ worker è¿›ç¨‹éƒ½ç”± master åˆ†é…ä»»åŠ¡ã€‚ä¸€å…±æœ‰ M ä¸ª map ä»»åŠ¡å’Œ R ä¸ª reduce ä»»åŠ¡éœ€è¦åˆ†é…ã€‚master ä¼šæŒ‘é€‰ç©ºé—²çš„ workerï¼Œä¸€æ¬¡åˆ†é…ä¸€ä¸ª map ä»»åŠ¡æˆ–è€…ä¸€ä¸ª reduce ä»»åŠ¡ã€‚<br>è¢«åˆ†é…åˆ° map ä»»åŠ¡çš„ worker è¯»å…¥å¯¹åº”åˆ†ç‰‡çš„è¾“å…¥ï¼Œä»è¾“å…¥ä¸­è§£æå‡ºé”®å€¼å¯¹ï¼Œå¹¶åˆ†åˆ«å°†å…¶ä¼ ç»™ç”¨æˆ·å®šä¹‰çš„ map å‡½æ•°ã€‚map å‡½æ•°è¿”å›çš„ä¸­é—´é”®å€¼å¯¹ä¼šè¢«æš‚æ—¶ç¼“å­˜åœ¨å†…å­˜é‡Œã€‚<br>worker å†…å­˜ä¸­ç¼“å­˜çš„é”®å€¼å¯¹ï¼Œä¼šè¢«åˆ†ç‰‡å‡½æ•°åˆ†æˆ R ä¸ªåˆ†ç‰‡ï¼Œå¹¶å‘¨æœŸæ€§åœ°å†™è¿›æœ¬åœ°ç£ç›˜ã€‚è¿™äº›é”®å€¼å¯¹åœ¨ç£ç›˜ä¸Šçš„ä½ç½®ä¼šè¢«å‘ç”Ÿç»™ masterï¼Œmaster è´Ÿè´£å°†ä½ç½®å‘é€ç»™è¢«åˆ†é…åˆ° reduce ä»»åŠ¡çš„ workerã€‚<br>å½“ä¸€ä¸ª reduce worker æ¥æ”¶åˆ° master å‘é€çš„è¿™äº›ä½ç½®ï¼Œå®ƒä¼šå‘ä¿å­˜è¿™äº›å†…å®¹çš„ map worker å‘é€ RPC è¯·æ±‚æ¥è¯»å–è¿™äº›å†…å®¹ã€‚å½“ä¸€ä¸ª reducer worker è¯»å–å®Œæ‰€æœ‰çš„ä¸­é—´æ•°æ®ï¼Œå°±ä¼šå°†å…¶æ ¹æ® key è¿›è¡Œæ’åºï¼Œè¿™æ ·æ‰€æœ‰ç›¸åŒ key çš„æ•°æ®å°±ä¼šèšåˆåœ¨ä¸€èµ·ã€‚è¿™ç§æ’åºæ˜¯å¿…è¦çš„ï¼Œå› ä¸ºé€šå¸¸è®¸å¤šä¸åŒçš„ key ä¼šç”±åŒä¸€ä¸ª reduce ä»»åŠ¡å¤„ç†ã€‚å¦‚æœæ•°æ®è¿‡å¤§ï¼Œå¯èƒ½ä¼šä½¿ç”¨å¤–éƒ¨æ’åºã€‚<br>reduce worker éå†æœ‰åºçš„ä¸­é—´æ•°æ®ï¼Œå¯¹é‡åˆ°çš„æ‰€æœ‰ keyï¼Œéƒ½ä¼šå°† key å’Œå¯¹åº”çš„å€¼é›†åˆä¼ ç»™ç”¨æˆ·å®šä¹‰çš„ reduce å‡½æ•°ã€‚reduce å‡½æ•°çš„è¾“å‡ºä¼šè¢«è¿½åŠ åˆ°ä¸€ä¸ªæœ€ç»ˆçš„è¾“å‡ºæ–‡ä»¶ï¼ˆæ¯ä¸ª reduce åˆ†ç‰‡ä¸€ä¸ªï¼‰ã€‚<br>å½“æ‰€æœ‰çš„ map ä»»åŠ¡å’Œ reduce ä»»åŠ¡éƒ½å®Œæˆåï¼ŒMapReduce çš„ä»»åŠ¡ä¹Ÿå°±å®Œæˆäº†ã€‚<br>è¿è¡Œç»“æŸåï¼ŒMapReduce çš„è¿è¡Œç»“æœä¿å­˜åœ¨ R ä¸ªè¾“å‡ºæ–‡ä»¶ä¸­ï¼Œé€šå¸¸è¿™äº›æ–‡ä»¶ä¼šè¢«ç”¨ä½œä¸‹ä¸€ä¸ª mapreduce ä»»åŠ¡çš„è¾“å…¥ã€‚</p><h6 id="å®¹é”™"><a href="#å®¹é”™" class="headerlink" title="å®¹é”™"></a>å®¹é”™</h6><p>è¿™é‡Œåªè€ƒè™‘ worker æŒ‚æ‰çš„æƒ…å†µï¼Œä¸è€ƒè™‘ master æŒ‚æ‰çš„æƒ…å†µï¼Œå› ä¸ºè¿™å¯èƒ½æ¶‰åŠé€‰ä¸¾å…±è¯†ç­‰å¤æ‚æƒ…å†µã€‚</p><p>master å’Œ worker ä¼šç»´æŒä¸€ä¸ªå¿ƒè·³ï¼Œå¦‚æœä¸€æ®µæ—¶é—´æ²¡æœ‰æ”¶åˆ° worker çš„å›åº”ï¼Œå°±ä¼šè®¤ä¸ºè¿™ä¸ª worker æŒ‚æ‰äº†ã€‚æ‰€æœ‰ç”±è¿™ä¸ª worker å®Œæˆçš„ map ä»»åŠ¡éƒ½ä¼šè¢«é‡æ–°å˜æˆæœªå¼€å§‹çŠ¶æ€ï¼Œä¼šè¢«é‡æ–°åˆ†é…ç»™å…¶ä»– worker æ‰§è¡Œã€‚æ‰€æœ‰æŒ‚æ‰æ—¶æ­£åœ¨è¿›è¡Œçš„ map æˆ–è€… reduce ä»»åŠ¡ä¼šè¢«æ ‡è®°ä¸ºæœªå¼€å§‹ã€‚</p><p>å·²å®Œæˆçš„ map ä»»åŠ¡éœ€è¦é‡æ–°æ‰§è¡Œæ˜¯å› ä¸ºå®ƒä»¬çš„ç»“æœå­˜å‚¨åœ¨å·²ç»æŒ‚æ‰æœºå™¨çš„æœ¬åœ°ç¡¬ç›˜ä¸Šï¼Œè€Œå·²ç»å®Œæˆçš„ reduce ä»»åŠ¡æ— éœ€é‡æ–°æ‰§è¡Œï¼Œreduce ä»»åŠ¡çš„ç»“æœè¢«æ”¾åœ¨å…¨å±€çš„æ–‡ä»¶ç³»ç»Ÿä¸Šã€‚</p><p>å¦‚æœä¸€ä¸ª map ä»»åŠ¡æœ€åˆç”± A æ‰§è¡Œï¼Œåæ¥ A æŒ‚æ‰äº†ï¼Œè¢«é‡æ–°åˆ†é…ç»™ B æ‰§è¡Œï¼Œè¿™ä¸ªæ¶ˆæ¯ä¼šè¢«é€šçŸ¥åˆ°æ‰€æœ‰æ‰§è¡Œ reduce ä»»åŠ¡çš„ workerã€‚æ‰€æœ‰è¿˜æ²¡æœ‰ä» A ä¸­è¯»å–æ•°æ®çš„ reduce ä»»åŠ¡ä¼šè½¬è€Œé€‰æ‹©ä» B è¯»å–æ•°æ®ã€‚</p><p>æœ‰æ—¶ï¼Œä¼šå‡ºç°è¿™ç§æƒ…å†µï¼šéƒ¨åˆ†æœºå™¨çš„æ€§èƒ½å¾ˆä½ï¼Œä½†æ˜¯ç”±äºç½‘ç»œé€šç•…ï¼Œä¸ä¼šè¢«åˆ¤å®šä¸ºæŒ‚æ‰ï¼Œè¿™ç§æœºå™¨å°±ä¼šæˆä¸ºæ•´ä¸ªç³»ç»Ÿçš„çŸ­æ¿ï¼Œæ•´ä¸ªç³»ç»Ÿä¸å¾—ä¸ç­‰å¾…æ…¢é€Ÿæœºå™¨æ…¢åååœ°æ‰§è¡Œå®Œä»–ä»¬çš„ä»»åŠ¡ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼ŒGoogle çš„å®ç°é‡‡ç”¨çš„ä¸€ç§æœºåˆ¶æ¥æå‡ï¼šåœ¨æ•´ä½“ MapReduce æ“ä½œå¿«è¦ç»“æŸæ—¶ï¼Œmaster ä¼šå°†æ‰€æœ‰ä»ç„¶åœ¨è¿›è¡Œçš„ä»»åŠ¡åˆ†é…ç»™å…¶ä»–ç©ºé—²çš„ worker æ‰§è¡Œã€‚æ— è®ºæ˜¯åŸæ¥çš„ workerï¼Œè¿˜æ˜¯äºŒæ¬¡åˆ†é…çš„ worker å®Œæˆäº†ä»»åŠ¡ï¼Œè¿™ä¸ªä»»åŠ¡éƒ½ç®—æ˜¯æˆåŠŸå®Œæˆã€‚</p><p>æ€§èƒ½æå‡ä¸å°ä¼˜åŒ–å°æ‰©å±•ç•¥å»ã€‚</p><h4 id="GFS"><a href="#GFS" class="headerlink" title="GFS"></a>GFS</h4><ul><li><p>GFSï¼ˆgoogle file systemï¼‰</p><ul><li><p>å¤§æ•°æ®å­˜å‚¨éš¾ç‚¹ï¼šå®¹é”™èƒ½åŠ›ï¼ˆåˆ†ç‰‡å‰¯æœ¬ï¼‰ã€æ•°æ®ä¸€è‡´æ€§ã€æ€§èƒ½ï¼ˆå¿«æ·ï¼‰</p></li><li><p>ç‰¹ç‚¹ï¼šå¤§æ–‡ä»¶ï¼ˆåˆ†ä¸º64Mbçš„å¤šä¸ªchunkå—å­˜å‚¨ï¼‰ã€é€Ÿåº¦å¿«ã€é€šç”¨å­˜å‚¨ç³»ç»Ÿã€chunk serverå‰¯æœ¬ã€è‡ªåŠ¨æ¢å¤ã€é¡ºåºè¯»å–ã€æˆæœ¬ä½</p></li><li><p>GFSæ¶æ„ï¼š<br>clientç»“ç‚¹<br>masterç»“ç‚¹ï¼ˆä¿å­˜å…ƒæ•°æ®ï¼‰ï¼šæ–‡ä»¶åâ€”æ•°æ®å—åˆ—è¡¨æ˜ å°„ã€ç‰ˆæœ¬ã€ä¸»æ•°æ®å—ã€ä½œä¸ºmasterçš„æ—¶é™ã€logã€checkpointï¼Œç£ç›˜å­˜å‚¨æ¥å®¹é”™<br>å—handleï¼ˆå¥æŸ„ï¼‰<br>å—serverç»“ç‚¹ï¼šé»˜è®¤å‰¯æœ¬æ•°ä¸º3æ¥å®¹é”™ï¼Œé¡ºåºå­˜å‚¨æ•°æ®</p><p><img src="https://s2.loli.net/2024/07/01/z8pWkisElhwFQYB.png" alt="20201208211708899[1].png"></p></li><li><p>GFSè¯»ï¼š</p><p>1.clientå°†æƒ³è¯»çš„æ–‡ä»¶åï¼Œåç§»é‡å‘é€åˆ°masteræœåŠ¡å™¨</p><p>2.masterå‘é€<strong>å—handle</strong>å’Œ<strong>å—æœåŠ¡å™¨å·</strong>ç­‰å…ƒæ•°æ®ç»™client</p><p>3.client<strong>ç¼“å­˜</strong>masterå‘å›çš„æ•°æ®</p><p>4.clientå°†è¯·æ±‚æ ¹æ®å…ƒæ•°æ®å‘é€åˆ°æœ€è¿‘çš„å‰¯æœ¬</p><p>5.å‰¯æœ¬è¿”å›æ•°æ®ç»™client</p></li><li><p>GFSå†™ï¼šï¼ˆè¿½åŠ å†™ï¼‰</p><p>æ²¡æœ‰ä¸»æ•°æ®å—ï¼š<br>æ‰¾åˆ°æ›´æ–°åˆ°æœ€æ–°çš„å‰¯æœ¬ä»¬ï¼Œ<br>masteré€‰å–ä¸€ä¸ªä½œä¸º<strong>ä¸»æ•°æ®å—</strong>ï¼Œå†™å…¥ç£ç›˜ï¼Œè®¾ç½®ä¸»æ•°æ®å—çš„<strong>æ—¶æ•ˆ</strong><br>å¢åŠ <strong>ç‰ˆæœ¬å·</strong>ï¼Œå†™å…¥ç£ç›˜<br>ä¸»æ•°æ®å—å†™å…¥ï¼Œå†<strong>åŒæ­¥æ‰€æœ‰å‰¯æœ¬</strong><br>è¿”å›ç»™client æ’å…¥æˆåŠŸ or æ’å…¥å¤±è´¥</p></li></ul></li></ul><h5 id="GFSè¯¦è§£"><a href="#GFSè¯¦è§£" class="headerlink" title="GFSè¯¦è§£"></a>GFSè¯¦è§£</h5><p><strong>æ˜¯ä»€ä¹ˆï¼Ÿ</strong><br>GFSæ˜¯ä¸€ä¸ª<strong>å¯æ‰©å±•çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ</strong>ï¼Œç”¨äºå¤§å‹çš„ã€åˆ†å¸ƒå¼çš„ã€å¯¹å¤§é‡æ•°æ®è¿›è¡Œè®¿é—®çš„åº”ç”¨ã€‚å®ƒè¿è¡Œäºå»‰ä»·çš„æ™®é€šç¡¬ä»¶ä¸Šï¼Œå¹¶æä¾›å®¹é”™åŠŸèƒ½ã€‚å®ƒå¯ä»¥ç»™å¤§é‡çš„ç”¨æˆ·æä¾›æ€»ä½“æ€§èƒ½è¾ƒé«˜çš„æœåŠ¡ã€‚</p><p><strong>ä¸ºä»€ä¹ˆè¦ç”¨GFS?</strong><br>å¤§é‡æ•°æ®çš„å­˜å‚¨ä¼šé¢ä¸´å¾ˆå¤šçš„éš¾ç‚¹ï¼š</p><p>å¤§æ•°æ®ä¸‹éœ€è¦è‰¯å¥½çš„è¡¨ç°å°±éœ€è¦åˆ†ç‰‡å’Œå®¹é”™ã€‚åœ¨å…·ä½“æ“ä½œè¿‡ç¨‹ä¸­ï¼Œæ¶‰åŠåˆ°å®¹é”™ä¸€èˆ¬ä½¿ç”¨å‰¯æœ¬æ¥è§£å†³ï¼Œç„¶è€Œ<strong>å‰¯æœ¬çš„ä½¿ç”¨ä¼šé¢ä¸´ä¸ä¸€è‡´é—®é¢˜</strong>ã€‚å¦‚æœæœ‰ä¸€è‡´æ€§çš„è¦æ±‚ï¼Œå°±ä¼šå¯¼è‡´è¡¨ç°é™ä½ã€‚</p><p>æ‰€è°“çš„ä¸€è‡´æ€§ï¼Œå°±æ˜¯åœ¨é›†ç¾¤ä¸­è¡¨ç°çš„åƒä¸ä¸€å°æœºå™¨æˆ–ä¸€ä¸ªå‰¯æœ¬è¿›è¡Œäº¤äº’é‚£æ ·</p><p>å› ä¸ºGFSä¸ä½†æ˜¯ä¸€ä¸ªç†è®ºæˆç†Ÿçš„æ¡†æ¶ç»“æ„ï¼Œæ›´æ˜¯ä¸€ç§é€šè¿‡é•¿æœŸå®é™…ä½¿ç”¨è¯æ˜äº†å…¶ä¼˜ç§€æ€§èƒ½çš„åˆ†å¸ƒå¼æ¶æ„ã€‚GFSæ˜¯ä¸€ç§æ¾æ•£ä¸€è‡´æ€§æ¨¡å‹ï¼Œè¿™æ˜¯å…¶å…·æœ‰ä¼˜è¶Šçš„æ€§èƒ½ä¸»è¦åŸå› ä¹‹ä¸€ã€‚</p><p>æ¾æ•£ä¸€è‡´æ€§æ¨¡å‹å…³é”®ï¼š</p><p>ä¾é æ·»åŠ è€Œä¸æ˜¯é‡å†™<br>æ£€æŸ¥ç‚¹<br>è‡ªæˆ‘éªŒè¯ï¼ˆæ ¡éªŒå’Œï¼‰<br>è‡ªæˆ‘è®¤è¯è®°å½•</p><p><strong>ç»„æˆï¼Ÿ</strong><br>ä¸€ä¸ªGFSé›†ç¾¤é€šå¸¸ç”±1ä¸ªMasterï¼Œå¤šä¸ªChunkServerç»„æˆï¼Œå¹¶åŒæ—¶æ¥å—å¤šä¸ªClientçš„è®¿é—®ã€‚</p><p><strong>äº¤äº’æ¦‚è¦å›¾</strong></p><p><img src="https://s2.loli.net/2024/07/01/z8pWkisElhwFQYB.png" alt="20201208211708899[1].png"></p><p><strong>æµç¨‹ä»‹ç»ï¼š</strong></p><ol><li><p>clientå‘é€è¯·æ±‚ç»™Masterï¼Œå¯»æ‰¾å­˜å‚¨äº†å¯¹åº”å‰¯æœ¬çš„chunkserverã€‚</p></li><li><p>Masteré€šè¿‡éå†æœ¬åœ°è®°å½•è·å–chunkserverçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬å¤„ç†ä¿¡æ¯å’Œåœ°å€ä¿¡æ¯</p><p>Masterä¸ä½†ä¼šåœ¨<strong>å¯åŠ¨æ—¶è·å–</strong>é›†ç¾¤ä¸­æ‰€æœ‰chunkserverçš„ä¿¡æ¯ï¼Œè¿˜ä¼šåœ¨<strong>åç»­çš„å‘¨æœŸæ€§çš„è·å–</strong>chunkserverä¿¡æ¯ã€‚æ‰€æœ‰çš„ä¿¡æ¯éƒ½æ˜¯å­˜åœ¨Masterçš„<strong>RAMé‡Œ</strong></p></li><li><p>Masterå°†ä¿¡æ¯è¿”å›ç»™client</p></li><li><p>clientä¹‹åç›´æ¥é€šè¿‡åœ°å€ä¿¡æ¯ä¸chunkserveräº¤äº’</p></li></ol><p><strong>GFSäº¤äº’æµç¨‹å›¾ï¼š</strong></p><p><img src="https://s2.loli.net/2024/07/01/KXZtz9TYPAw58mh.png" alt="a72fcfcd40764bc1adaca3eece85a10e[1].png"></p><p>Secondary Replica:è¾…åŠ©å‰¯æœ¬</p><p><strong>è¦ç‚¹ï¼š</strong></p><ol><li><p><strong>Master</strong>é€šè¿‡lease(ç§Ÿçº¦)å’ŒPrimary Replica(ä¸»å‰¯æœ¬)æœ¬æ¥æ„å»ºäº¤äº’çš„æµç¨‹ã€‚</p><p>Masteræ˜¯åšå‡ºå†³ç­–ã€åˆ›å»ºæ–°çš„å—å’Œèµ‹å€¼ï¼Œå¹¶åè°ƒå„ç§ç³»ç»ŸèŒƒå›´çš„æ´»åŠ¨ï¼Œä»¥ä¿è¯å—å®Œå…¨å¤åˆ¶ï¼Œå¹³è¡¡æ‰€æœ‰chunkserverçš„è´Ÿè½½ï¼ŒåŒæ—¶è¿˜è´Ÿè´£åƒåœ¾å›æ”¶ã€‚</p><p>Masterçš„æ“ä½œé€šè¿‡é”æ¥ä¿è¯å‘½åç©ºé—´èŒƒå›´å†…çš„åºåˆ—åŒ–</p></li><li><p><strong>ä¸»å‰¯æœ¬</strong>æ˜¯ä»ä¼—å¤šchunkserverä¸­é€‰å‡ºçš„<strong>å”¯ä¸€ç‰¹æ®Šå‰¯æœ¬</strong>ï¼Œè¯¥å‰¯æœ¬çš„ç‰¹æ®Šæ€§åœ¨äºå…¶ç»´æŠ¤äº†ä¸€ä¸ªå®šæ—¶çš„ç§Ÿçº¦åˆ—è¡¨ã€‚</p></li><li><p><strong>ç§Ÿçº¦</strong>æŒ‡çš„æ˜¯<strong>ä¸€ç»„ç”±ç”¨æˆ·å‘æ¥çš„æœ‰é¡ºåºçš„æŒ‡ä»¤é›†åˆ</strong></p></li><li><p>ä¸»å‰¯æœ¬ä¹‹å¤–çš„å‰¯æœ¬éƒ½éœ€è¦é€šè¿‡ä¸»å‰¯æœ¬ä¸­çš„è¿™ä¸ªåˆ—è¡¨æ¥æ‰§è¡ŒæŒ‡ä»¤ï¼Œä»¥ä¿è¯æ¯ä¸ªå‰¯æœ¬æ‰§è¡Œçš„æœ€ç»ˆç»“æœç›¸åŒã€‚</p></li></ol><p><strong>Masterå¤±æ•ˆæ€ä¹ˆåŠ</strong><br>æœ‰<strong>å‰¯æœ¬master</strong>ï¼Œæ‹¥æœ‰masterçŠ¶æ€çš„å®Œæ•´å‰¯æœ¬ï¼›GFSè®ºæ–‡ä¸­è®¾è®¡éœ€è¦äººå·¥å¹²é¢„æ‰èƒ½åˆ‡æ¢åˆ°å…¶ä¸­ä¸€ç§ä¸»æ•…éšœåçš„å‰¯æœ¬ã€‚</p><p><strong>å¦‚ä½•ä¿éšœå‰¯æœ¬è®°å½•çš„æ­£ç¡®æ€§</strong><br>ä½¿ç”¨<strong>åŸå­è®°å½•</strong>è‡³å°‘è¿½åŠ ä¸€æ¬¡çš„æ–¹æ³•ã€‚</p><p><strong>ä¸ºä»€ä¹ˆä¸ä½¿ç”¨å®Œå…¨è¿½åŠ ï¼Ÿ</strong></p><p>å¦‚æœåœ¨å…¶ä¸­ä¸€ä¸ªå†™å…¥å¤±è´¥æ—¶å®¢æˆ·ç«¯é‡æ–°å°è¯•å†™å…¥ï¼Œè¿™å°†å¯¼è‡´æ•°æ®åœ¨æœªå¤±è´¥çš„å‰¯æœ¬ä¸Šå¤šæ¬¡é™„åŠ ã€‚ä¸åŒçš„è®¾è®¡å¯èƒ½ä¼šæ£€æµ‹åˆ°é‡å¤çš„å®¢æˆ·ç«¯è¯·æ±‚ï¼Œä¾‹å¦‚ï¼ŒåŸå§‹æ•…éšœä¹‹é—´çš„ä¸»è¦æ•…éšœè¯·æ±‚å’Œå®¢æˆ·ç«¯çš„é‡è¯•ã€‚</p><p><strong>åº”ç”¨ç¨‹åºå¦‚ä½•çŸ¥é“å“ªäº›éƒ¨åˆ†ç»„æˆå¡«å……ï¼Œå“ªäº›æ˜¯é‡å¤è®°å½•ï¼Ÿ</strong><br>ä¸ºäº†<strong>æ£€æµ‹å¡«å……</strong>ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥æ”¾ç½®ä¸€ä¸ªå¯é¢„æµ‹çš„å¹»æ•°åœ¨æœ‰æ•ˆè®°å½•çš„å¼€å¤´ï¼Œæˆ–åŒ…å«<strong>ä¸€ä¸ªæ ¡éªŒå’Œ</strong>ï¼Œè¯¥æ ¡éªŒå’Œå¯èƒ½<strong>ä»…å½“è®°å½•æœ‰æ•ˆæ—¶æ‰æœ‰æ•ˆ</strong>ã€‚è¯¥åº”ç”¨ç¨‹åºå¯ä»¥æ£€æµ‹é€šè¿‡åœ¨è®°å½•ä¸­åŒ…å«å”¯ä¸€ ID æ¥å¤åˆ¶ã€‚ç„¶åï¼Œå¦‚æœå®ƒè¯»å–ä¸å…ˆå‰è®°å½•å…·æœ‰ç›¸åŒ ID çš„è®°å½•ï¼Œå®ƒçŸ¥é“å®ƒä»¬æ˜¯å½¼æ­¤çš„é‡å¤ã€‚GFS ä¸ºåº”ç”¨ç¨‹åºæä¾›äº†ä¸€ä¸ªåº“å¤„ç†è¿™äº›æƒ…å†µã€‚</p><p><strong>ä»€ä¹ˆæ˜¯æ ¡éªŒå’Œï¼Ÿ</strong><br>æ ¡éªŒå’Œç®—æ³•å°†<strong>ä¸€ä¸ªå­—èŠ‚å—</strong>ä½œä¸ºè¾“å…¥<strong>å¹¶è¿”å›ä¸€ä¸ªå•ä¸ªæ•°å­—</strong>ï¼Œå®ƒæ˜¯æ‰€æœ‰è¾“å…¥å­—èŠ‚çš„å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç®€å•æ ¡éªŒå’Œå¯èƒ½æ˜¯è¾“å…¥ä¸­æ‰€æœ‰å­—èŠ‚çš„æ€»å’Œï¼ˆmodä¸€äº›å¤§æ•°å­—ï¼‰ã€‚GFS å­˜å‚¨æ¯ä¸ªå—çš„æ ¡éªŒå’Œä»¥åŠå—ã€‚å½“ä¸€ä¸ªchunkserveråœ¨å®ƒçš„ç£ç›˜ä¸Šå†™ä¸€chunkæ—¶ï¼Œå®ƒé¦–å…ˆ<strong>è®¡ç®—æ–°å—çš„æ ¡éªŒå’Œï¼Œå¹¶å°†æ ¡éªŒå’Œä¿å­˜åœ¨ç£ç›˜ä¸Šä»¥åŠå—</strong>ã€‚å½“ä¸€ä¸ªchunkserverä»ç£ç›˜è¯»å–ä¸€ä¸ªchunkæ—¶ï¼Œå®ƒè¿˜è¯»å–å…ˆå‰<strong>ä¿å­˜çš„æ ¡éªŒå’Œ</strong>ï¼Œä»ç£ç›˜<strong>è¯»å–çš„å—</strong>ï¼Œå¹¶æ£€æŸ¥ä¸¤ä¸ªæ ¡éªŒå’Œæ˜¯å¦åŒ¹é…ã€‚å¦‚æœæ•°æ®å·²è¢«ç£ç›˜æŸåï¼Œæ ¡éªŒå’Œä¸åŒ¹é…ï¼Œå¹¶ä¸”chunkserver ä¼šçŸ¥é“è¿”å›é”™è¯¯ã€‚å¦å¤–ï¼Œä¸€äº› GFSåº”ç”¨ç¨‹åºå­˜å‚¨è‡ªå·±çš„æ ¡éªŒå’Œï¼Œè€Œä¸æ˜¯åº”ç”¨ç¨‹åºå®šä¹‰çš„è®°å½•ï¼Œåœ¨ GFS æ–‡ä»¶ä¸­ï¼Œä»¥åŒºåˆ†æ­£ç¡®çš„è®°å½•å’Œå¡«å……ã€‚</p><p><strong>GFS ä»¥æ­£ç¡®æ€§æ¢å–æ€§èƒ½åœ¨å¤šå¤§ç¨‹åº¦ä¸Šå¯ä»¥æ¥å—</strong><br>è¿™æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­åå¤å‡ºç°çš„ä¸»é¢˜ã€‚å¼ºä¸€è‡´æ€§é€šå¸¸å‡ºç°åœ¨éœ€è¦å¤æ‚ä¸”éœ€è¦äº¤äº’çš„åè®®æœºå™¨ä¹‹é—´ã€‚ç»è¿‡åˆ©ç”¨ç‰¹å®šåº”ç”¨ç¨‹åºç±»å¯ä»¥å®¹å¿çš„æ”¾æ¾æ–¹å¼ä¸€è‡´æ€§ï¼Œå¯ä»¥è®¾è®¡å‡ºå…·æœ‰è‰¯å¥½æ€§èƒ½å’Œè¶³å¤Ÿçš„ä¸€è‡´æ€§ã€‚ä¾‹å¦‚ï¼Œ<strong>GFS é’ˆå¯¹ MapReduce è¿›è¡Œäº†ä¼˜åŒ–å¯¹å¤§æ–‡ä»¶éœ€è¦é«˜è¯»å–æ€§èƒ½çš„åº”ç”¨ç¨‹åºå¯ä»¥åœ¨æ–‡ä»¶ä¸­æœ‰æ¼æ´ï¼Œè®°å½•æ˜¾ç¤ºå¤šæ¬¡ï¼Œå¹¶ä¸”ä¸ä¸€è‡´çš„è¯»å–</strong>ã€‚</p><p><strong>Google æ˜¯å¦ä»ä½¿ç”¨ GFSï¼Ÿ</strong><br>æœ‰ä¼ è¨€è¯´ GFS å·²ç»è¢«ä¸€ä¸ªå«åšColossusï¼Œæ€»ä½“ç›®æ ‡ç›¸åŒï¼Œä½†åœ¨ master æ–¹é¢æœ‰æ‰€æ”¹è¿›æ€§èƒ½å’Œå®¹é”™æ€§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åˆ†å¸ƒå¼ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ†å¸ƒå¼ç³»ç»Ÿ </tag>
            
            <tag> 6.824 </tag>
            
            <tag> MapReduce </tag>
            
            <tag> GFS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ—¥æœ¬æ•°æ®åŸºç¡€è®¾æ–½-è°ƒç ”</title>
      <link href="/2024/06/28/%E6%97%A5%E6%9C%AC%E6%95%B0%E6%8D%AE-%E8%B0%83%E7%A0%94/"/>
      <url>/2024/06/28/%E6%97%A5%E6%9C%AC%E6%95%B0%E6%8D%AE-%E8%B0%83%E7%A0%94/</url>
      
        <content type="html"><![CDATA[<h1 id="æ—¥æœ¬æ•°æ®åŸºç¡€è®¾æ–½-è°ƒç ”"><a href="#æ—¥æœ¬æ•°æ®åŸºç¡€è®¾æ–½-è°ƒç ”" class="headerlink" title="æ—¥æœ¬æ•°æ®åŸºç¡€è®¾æ–½-è°ƒç ”"></a>æ—¥æœ¬æ•°æ®åŸºç¡€è®¾æ–½-è°ƒç ”</h1><h3 id="1ï¼‰æ³•å¾‹æ³•è§„"><a href="#1ï¼‰æ³•å¾‹æ³•è§„" class="headerlink" title="1ï¼‰æ³•å¾‹æ³•è§„"></a>1ï¼‰æ³•å¾‹æ³•è§„</h3><h4 id="ä¿ƒè¿›æ•°æ®æµé€šä¸åˆ©ç”¨åŸºæœ¬æ³•"><a href="#ä¿ƒè¿›æ•°æ®æµé€šä¸åˆ©ç”¨åŸºæœ¬æ³•" class="headerlink" title="ä¿ƒè¿›æ•°æ®æµé€šä¸åˆ©ç”¨åŸºæœ¬æ³•"></a>ä¿ƒè¿›æ•°æ®æµé€šä¸åˆ©ç”¨åŸºæœ¬æ³•</h4><p>æ—¥æœ¬çš„ä¿ƒè¿›æ•°æ®æµé€šä¸åˆ©ç”¨åŸºæœ¬æ³•å¹¶ä¸æ˜¯ä¸€ä¸ªå•ç‹¬çš„å…·ä½“æ³•å¾‹åç§°ï¼Œè€Œæ˜¯å¯¹æ—¥æœ¬åœ¨æ•°æ®æµé€šä¸åˆ©ç”¨æ–¹é¢è¿›è¡Œçš„ä¸€ç³»åˆ—æ³•å¾‹å’Œæ”¿ç­–æ¢ç´¢çš„ç»Ÿç§°ã€‚ä»¥ä¸‹æ˜¯ä¸€äº›å…³é”®ç‚¹ï¼Œæ¦‚è¿°äº†æ—¥æœ¬åœ¨è¿™ä¸€é¢†åŸŸçš„å®è·µå’Œæ”¿ç­–æ¡†æ¶ï¼š</p><ol><li><p><strong>å¤šæ–¹åä½œæœºåˆ¶</strong> : æ—¥æœ¬é€šè¿‡æ”¿åºœã€äº§ä¸šç•Œå’Œè¡Œä¸šåä¼šçš„åä½œï¼Œæ¨åŠ¨æ•°æ®æµé€šä¸åˆ©ç”¨ã€‚æ”¿åºœå±‚é¢æˆç«‹æ–°æœºæ„ä¸“é¡¹æ¨è¿›ï¼Œå¦‚â€œæ•°å­—å…â€å–ä»£ITç»¼åˆæˆ˜ç•¥æœ¬éƒ¨ï¼Œç»Ÿç­¹æ¨è¿›å…¨å›½æ•°å­—ç¤¾ä¼šå»ºè®¾ã€æ•°å­—åŒ–è½¬å‹ã€‚</p></li><li><p><strong>ã€Šç»¼åˆæ•°æ®æˆ˜ç•¥ã€‹</strong> : æ•°å­—å…ä½œä¸ºè´£ä»»éƒ¨é—¨æ¨åŠ¨å®æ–½ã€Šç»¼åˆæ•°æ®æˆ˜ç•¥ã€‹ï¼Œæ—¨åœ¨å»ºç«‹ä¸€ä¸ªæ”¾å¿ƒé«˜æ•ˆçš„æ•°æ®ä½¿ç”¨æœºåˆ¶ï¼Œæ¨åŠ¨æ•°æ®åœ¨å›½å†…ä»¥åŠè·¨å›½å®‰å…¨ã€é«˜æ•ˆæµé€šã€‚</p></li><li><p><strong>æ•°æ®åŸºç¡€è®¾æ–½å»ºè®¾</strong> : äº§ä¸šå±‚é¢ç§¯æå»ºè®¾æ•°æ®åŸºç¡€è®¾æ–½ã€ç ”å‘æ•°æ®å®‰å…¨æŠ€æœ¯ã€å»ºè®¾æ•°æ®äº¤æ˜“å¸‚åœºã€‚ä¾‹å¦‚ï¼ŒNTTé›†å›¢æ„å»ºæ•°æ®åä½œå¹³å°â€”â€”å…¨çƒå¯ä¿¡æ•°æ®ç©ºé—´ï¼Œæ¨åŠ¨è·¨ä¼ä¸šã€è·¨è¡Œä¸šã€è·¨å›½ç•Œçš„æ•°æ®åˆ©ç”¨ä¸åä½œã€‚</p></li><li><p><strong>æ•°æ®ç¤¾ä¼šè”ç›Ÿ</strong> : æˆç«‹æ•°æ®ç¤¾ä¼šè”ç›Ÿï¼Œå¯¹äº§ä¸šæ•°æ®ç©ºé—´ç­‰é¢†åŸŸçš„æŠ€æœ¯æ ‡å‡†è¿›è¡Œè§„èŒƒï¼Œæ¨è¿›æ•°å­—æŠ€æœ¯ç ”å‘å’Œæ•°æ®æµé€šé¢†åŸŸæ ‡å‡†åŠè§„èŒƒçš„å»ºç«‹ã€‚ç›®å‰æ­£åœ¨å¼€å‘è·¨å­¦ç§‘çš„æ•°æ®åä½œå¹³å°DATA-EXã€‚</p></li><li><p><strong>æ•°æ®æµé€šåˆ©ç”¨åŸºç¡€</strong> : æ—¥æœ¬æ”¿åºœä»¥åŠå„è¡Œä¸šç»„ç»‡åœ¨æ•°æ®äº¤æ˜“åŸºç¡€åˆ¶åº¦ã€æ•°æ®æµé€šåŸºç¡€è®¾æ–½ç­‰æ–¹é¢å¼€å±•äº†ä¸€ç³»åˆ—æ¢ç´¢ï¼ŒåŒ…æ‹¬æ•°æ®æƒå±ã€å®šä»·ç­‰ç›¸å…³åˆ¶åº¦è§„å®šã€‚</p></li><li><p><strong>è·¨å¢ƒæ•°æ®æµåŠ¨</strong> : æ—¥æœ¬å€¡å¯¼æ•°æ®è‡ªç”±æµåŠ¨ï¼Œå¯»æ±‚åœ¨è·¨å¢ƒæ•°æ®æµåŠ¨æ–¹é¢å‘æŒ¥é¢†å¯¼ä½œç”¨ã€‚ä¾‹å¦‚ï¼Œåœ¨G20å¤§é˜ªå³°ä¼šä¸Šæå‡ºå»ºç«‹â€œæ•°æ®æµé€šåœˆâ€æ¦‚å¿µï¼Œæ¨åŠ¨å»ºç«‹æ–°çš„å›½é™…æ•°æ®ç›‘ç£ä½“ç³»ã€‚</p></li><li><p><strong>æ•°æ®ç©ºé—´å»ºè®¾</strong> : æ¨åŠ¨æ•°æ®ç©ºé—´å»ºè®¾ï¼Œå¦‚æ”¿åŠ¡æ•°æ®GBizå¹³å°ã€å†œä¸šæ•°æ®WAGRIå¹³å°ã€é˜²ç¾ä¿¡æ¯SIP4Då¹³å°ç­‰ï¼Œä»¥å®ç°ä¼ä¸šé—´æ•°æ®å®‰å…¨ã€å¯ä¿¡ã€é«˜æ•ˆæµé€šå…±äº«ã€‚</p></li><li><p><strong>å¤šå±‚æ¬¡æ•°æ®äº¤æ˜“å¸‚åœº</strong> : é¼“åŠ±å¤šå±‚æ¬¡æ•°æ®äº¤æ˜“å¸‚åœºå‘å±•ï¼Œæ¨åŠ¨æ•°æ®èµ„äº§åŒ–ã€èµ„æœ¬åŒ–ï¼Œä¾‹å¦‚â€œä¸ªäººæ•°æ®å•†åº—â€å’Œâ€œæ•°æ®é“¶è¡Œâ€æ¨¡å¼ï¼Œæ¢ç´¢ä¸ªäººæ•°æ®æ”¶ç›Šåˆ†äº«åˆ¶åº¦ã€‚</p></li><li><p><strong>ã€Šæ•°å­—ç¤¾ä¼šå½¢æˆåŸºæœ¬æ³•ã€‹</strong> : è¯¥æ³•å¾‹æ˜¯<strong>æ—¥æœ¬æ•°å­—åŒ–è½¬å‹çš„æ ¸å¿ƒ</strong>ï¼Œå®ƒè§„å®šäº†æ•°å­—ç¤¾ä¼šå½¢æˆæªæ–½çš„åŸºæœ¬åŸåˆ™å’Œæ”¿ç­–ï¼ŒåŒ…æ‹¬è®¾ç«‹æ•°å­—æœºæ„å’Œåˆ¶å®šä¼˜å…ˆè®¡åˆ’ï¼Œå¼ºè°ƒæ•°æ®çš„æµé€šå’Œåˆ©ç”¨æ˜¯æ•°å­—ç¤¾ä¼šçš„é‡è¦åŸºçŸ³ã€‚</p></li><li><p><strong>ä¸ªäººå·ç åˆ¶åº¦</strong> : ä½œä¸ºæ•°å­—åŒ–æ”¿åŠ¡çš„å¤§å‰æï¼Œä¸ªäººå·ç åˆ¶åº¦æ˜¯æ—¥æœ¬æ”¿åºœæ¨è¡Œçš„ä¸€é¡¹ä¸ªäººè¯†åˆ«åˆ¶åº¦ï¼Œé€šè¿‡ä¸ªäººå·ç å¡å®ç°è¡Œæ”¿æ‰‹ç»­çš„â€œä¸€ç«™å¼â€æœåŠ¡ã€‚</p></li></ol><p>è¿™äº›æªæ–½å’Œæ”¿ç­–ä½“ç°äº†æ—¥æœ¬åœ¨ä¿ƒè¿›æ•°æ®æµé€šä¸åˆ©ç”¨æ–¹é¢çš„å…¨é¢æˆ˜ç•¥å’Œå®è·µï¼Œæ—¨åœ¨å»ºç«‹ä¸€ä¸ªå®‰å…¨ã€é«˜æ•ˆã€å¼€æ”¾çš„æ•°æ®ç”Ÿæ€ç³»ç»Ÿã€‚</p><h4 id="2003ï¼šæ—¥æœ¬ä¸ªäººä¿¡æ¯ä¿æŠ¤æ³•"><a href="#2003ï¼šæ—¥æœ¬ä¸ªäººä¿¡æ¯ä¿æŠ¤æ³•" class="headerlink" title="2003ï¼šæ—¥æœ¬ä¸ªäººä¿¡æ¯ä¿æŠ¤æ³•"></a>2003ï¼šæ—¥æœ¬ä¸ªäººä¿¡æ¯ä¿æŠ¤æ³•</h4><p>æ—¥æœ¬çš„ä¸ªäººä¿¡æ¯ä¿æŠ¤æ³•ï¼ˆAct on the Protection of Personal Information, APPIï¼‰åœ¨2003å¹´é¦–æ¬¡åˆ¶å®šï¼Œæ˜¯ä¸€éƒ¨æ—¨åœ¨ä¿æŠ¤ä¸ªäººä¿¡æ¯çš„æ³•å¾‹ï¼Œå®ƒè§„å®šäº†ä¸ªäººæ•°æ®çš„å¤„ç†æ–¹å¼ï¼Œä»¥ç¡®ä¿ä¸ªäººæƒåˆ©å’Œåˆ©ç›Šå¾—åˆ°å°Šé‡ï¼Œå¹¶åœ¨éšåçš„å‡ å¹´ä¸­ç»è¿‡äº†å¤šæ¬¡ä¿®è®¢ï¼Œä»¥åº”å¯¹æ–°çš„æŒ‘æˆ˜å’Œéœ€æ±‚ï¼Œå¦‚æŠ€æœ¯è¿›æ­¥å’Œå›½é™…åˆä½œçš„éœ€è¦ã€‚è¯¥æ³•å¾‹çš„æœ€è¿‘ä¸€æ¬¡é‡å¤§ä¿®è®¢æ˜¯åœ¨2020å¹´ï¼Œé¢„è®¡å°†åœ¨2022å¹´6æœˆ11æ—¥å‰ç”±æ”¿ä»¤è§„å®šçš„æ—¥æœŸèµ·æ–½è¡Œã€‚æ­¤å¤–ï¼Œ2021å¹´9æœˆï¼Œæ—¥æœ¬ä¸ªäººä¿¡æ¯ä¿æŠ¤å§”å‘˜ä¼šæ›´æ–°äº†å…³äºè¯¥æ³•å¾‹çš„æŒ‡å—é—®ç­”ï¼Œæ–°å¢äº†äººè„¸è¯†åˆ«ä¿¡æ¯ä½¿ç”¨ç­‰å…·ä½“è§„å®šã€‚</p><p>ä»¥ä¸‹æ˜¯å…³äºè¯¥æ³•å¾‹çš„ä¸€äº›å…³é”®ç‚¹ï¼š</p><ol><li><strong>ç«‹æ³•ç›®çš„</strong>: è¯¥æ³•å¾‹çš„ç›®çš„æ˜¯ä¿æŠ¤ä¸ªäººä¿¡æ¯çš„åˆç†å’Œæœ‰æ•ˆåº”ç”¨ï¼ŒåŒæ—¶ä¿ƒè¿›æ–°äº§ä¸šçš„åˆ›é€ å’Œç»æµç¤¾ä¼šçš„æ´»åŠ›ï¼Œæé«˜æ—¥æœ¬äººæ°‘çš„ç”Ÿæ´»è´¨é‡ã€‚</li><li><strong>é€‚ç”¨èŒƒå›´</strong>: å®ƒé€‚ç”¨äºæ‰€æœ‰å¤„ç†ä¸ªäººä¿¡æ¯çš„å®ä½“ï¼ŒåŒ…æ‹¬å…¬å¸ã€æ”¿åºœæœºæ„å’Œç‹¬ç«‹è¡Œæ”¿æ³•äººç­‰ã€‚</li><li><strong>å®šä¹‰</strong>: æ³•å¾‹ä¸­å®šä¹‰äº†â€œä¸ªäººä¿¡æ¯â€ï¼ˆpersonal informationï¼‰æ˜¯æŒ‡å¯ä»¥è¯†åˆ«ç‰¹å®šä¸ªäººçš„ä¿¡æ¯ï¼Œä»¥åŠâ€œåŒ¿åå¤„ç†ä¿¡æ¯â€ï¼ˆanonymously processed informationï¼‰ï¼Œå³é€šè¿‡ç³»ç»ŸåŒ–çš„æ–¹å¼å¤„ç†ï¼Œä½¿å…¶æ— æ³•è¯†åˆ«ç‰¹å®šä¸ªäººçš„ä¿¡æ¯ã€‚</li><li><strong>åŸºæœ¬åŸåˆ™</strong>: æ³•å¾‹æå‡ºäº†é€‚å½“å¤„ç†ä¸ªäººä¿¡æ¯çš„æ€»ä½“æ„¿æ™¯ï¼Œå¹¶è¦æ±‚æ”¿åºœåˆ¶å®šåŸºæœ¬æ”¿ç­–æ¥ä¿ƒè¿›ä¸ªäººä¿¡æ¯ä¿æŠ¤æªæ–½çš„å…¨é¢å’Œæ•´ä½“æ¨è¿›ã€‚</li><li><strong>æ•°æ®ä¸»ä½“çš„æƒåˆ©</strong>: æ³•å¾‹èµ‹äºˆæ•°æ®ä¸»ä½“ä¸€ç³»åˆ—æƒåˆ©ï¼ŒåŒ…æ‹¬è®¿é—®æƒã€æ›´æ­£æƒå’Œåˆ é™¤æƒç­‰ï¼Œä»¥ç¡®ä¿ä¸ªäººä¿¡æ¯çš„å‡†ç¡®æ€§å’Œå®‰å…¨ã€‚</li><li><strong>æ•°æ®å¤„ç†è€…çš„ä¹‰åŠ¡</strong>: æ•°æ®å¤„ç†è€…å¿…é¡»é‡‡å–å¿…è¦çš„æªæ–½æ¥ä¿æŠ¤ä¸ªäººä¿¡æ¯ï¼Œé˜²æ­¢æœªç»æˆæƒçš„è®¿é—®ã€æ³„éœ²ã€ä¸¢å¤±æˆ–ç ´åï¼Œå¹¶åœ¨å¤„ç†ä¸ªäººä¿¡æ¯æ—¶éµå®ˆæ³•å¾‹è§„å®šçš„åŸåˆ™å’Œæ ‡å‡†ã€‚</li><li><strong>æ•°æ®æ³„éœ²æŠ¥å‘Š</strong>: å¦‚æœå‘ç”Ÿä¸ªäººä¿¡æ¯æ³„éœ²ï¼Œæ•°æ®å¤„ç†è€…å¿…é¡»æŒ‰ç…§è§„å®šå‘ä¸ªäººä¿¡æ¯ä¿æŠ¤å§”å‘˜ä¼šï¼ˆPersonal Information Protection Commission, PPCï¼‰æŠ¥å‘Šï¼Œå¹¶åœ¨å¿…è¦æ—¶é€šçŸ¥å—å½±å“çš„ä¸ªäººã€‚</li><li><strong>è·¨å¢ƒæ•°æ®ä¼ è¾“</strong>: æ³•å¾‹å¯¹ä¸ªäººä¿¡æ¯çš„è·¨å¢ƒä¼ è¾“æå‡ºäº†è¦æ±‚ï¼Œç¡®ä¿åœ¨å°†ä¸ªäººä¿¡æ¯ä¼ è¾“åˆ°å›½å¤–æ—¶ï¼Œæ¥æ”¶æ–¹æœ‰è¶³å¤Ÿçš„ä¿æŠ¤æªæ–½æ¥ç»´æŠ¤ä¸ªäººä¿¡æ¯çš„å®‰å…¨ã€‚</li><li><strong>ç›‘ç®¡æœºæ„</strong>: æ—¥æœ¬ä¸ªäººä¿¡æ¯ä¿æŠ¤å§”å‘˜ä¼šæ˜¯è´Ÿè´£ç›‘ç£å’Œæ‰§è¡Œä¸ªäººä¿¡æ¯ä¿æŠ¤æ³•çš„ç‹¬ç«‹è¡Œæ”¿æœºæ„ã€‚</li><li><strong>è¿è§„å¤„ç½š</strong>: è¿åä¸ªäººä¿¡æ¯ä¿æŠ¤æ³•çš„è¡Œä¸ºå¯èƒ½ä¼šå—åˆ°è¡Œæ”¿å¤„ç½šï¼ŒåŒ…æ‹¬è´£ä»¤æ”¹æ­£ã€ä¸šåŠ¡æš‚åœæˆ–ç»ˆæ­¢ï¼Œä»¥åŠåœ¨æŸäº›æƒ…å†µä¸‹çš„åˆ‘äº‹å¤„ç½šã€‚</li></ol><h4 id="2021å¹´6æœˆï¼šç»¼åˆæ•°æ®æˆ˜ç•¥"><a href="#2021å¹´6æœˆï¼šç»¼åˆæ•°æ®æˆ˜ç•¥" class="headerlink" title="2021å¹´6æœˆï¼šç»¼åˆæ•°æ®æˆ˜ç•¥"></a>2021å¹´6æœˆï¼šç»¼åˆæ•°æ®æˆ˜ç•¥</h4><ul><li><p><strong>æ³•å¾‹&#x2F;æ”¿ç­–åç§°</strong>: ç»¼åˆæ•°æ®æˆ˜ç•¥</p></li><li><p><strong>æ¦‚è¦ä»‹ç»</strong>:  2021å¹´6æœˆï¼Œæ—¥æœ¬å‘å¸ƒâ€œç»¼åˆæ•°æ®æˆ˜ç•¥â€ï¼Œæ—¨åœ¨â€œé€šè¿‡ç¡®ä¿ä¿¡èµ–å’Œå…¬ç›Šæ€§ï¼Œæ„ç­‘å®‰å¿ƒä¸”é«˜æ•ˆåœ°ä½¿ç”¨æ•°æ®çš„ç»“æ„ï¼Œ<strong>åŒæ—¶ï¼Œä»ä¸–ç•ŒèŒƒå›´å†…ç¡®ä¿å¯¹æ—¥æœ¬æ•°æ®æœ¬èº«åŠå…¶ç”Ÿæˆã€æµé€šæ–¹å¼çš„ä¿¡èµ–ï¼Œåœ¨ä¸–ç•ŒèŒƒå›´å†…æ”¾å¿ƒåœ°åˆ©ç”¨æ—¥æœ¬æ•°æ®ï¼Œä¹Ÿè®©ä¸–ç•Œæ•°æ®èƒ½åœ¨æ—¥æœ¬æ”¾å¿ƒå­˜æ”¾çš„ç¤¾ä¼šâ€ã€‚</strong>æ—¥æœ¬æ”¿åºœè®¡åˆ’ä½¿è¡Œæ”¿æœºæ„æœ¬èº«æˆä¸ºå…¨å›½æœ€å¤§çš„å¹³å°ï¼Œè®©å…¬å…±æ•°æ®å……åˆ†æµåŠ¨ã€‚å…¶ç”±æ—¥æœ¬æ•°å­—æ”¿åºœå†…é˜é˜å‘˜ä¼šè®®ä¸‹è®¾ç½®â€œæ•°æ®æˆ˜ç•¥ç‰¹åˆ«å·¥ä½œç»„â€å…·ä½“åˆ¶å®šã€‚å†…é˜ä¼šè®®å†³å®šå°†è¯¥å·¥ä½œç»„æˆæœä¸ã€Šé¢å‘å®ç°æ•°å­—ç¤¾ä¼šçš„é‡ç‚¹è®¡åˆ’ã€‹åˆå¹¶ä¸ºã€Šç»¼åˆæ•°æ®æˆ˜ç•¥ã€‹ã€‚ã€Šç»¼åˆæ•°æ®æˆ˜ç•¥ã€‹æ—¨åœ¨å»ºè®¾æ—¥æœ¬æ‰“é€ ä¸–ç•Œé¡¶çº§æ•°å­—å›½å®¶æ‰€éœ€çš„æ•°å­—åŸºç¡€ï¼›æ˜ç¡®äº†æ•°æ®æˆ˜ç•¥çš„åŸºæœ¬æ€è·¯ï¼Œåˆ¶å®šäº†ç¤¾ä¼šæ„¿æ™¯ä»¥åŠå®ç°è¯¥æ„¿æ™¯çš„åŸºæœ¬è¡ŒåŠ¨æŒ‡å—ã€‚</p><p><strong>2021å¹´9æœˆï¼Œæ—¥æœ¬æˆç«‹äº†æ•°å­—å…ä»¥å®æ–½è¯¥â€œç»¼åˆæ•°æ®æˆ˜ç•¥â€ã€‚</strong>åœ¨â€œç»¼åˆæ•°æ®æˆ˜ç•¥â€ä¸­ï¼Œæ—¥æœ¬è®¾æƒ³äº†ä¸€ä¸ª<strong>â€œä¸ƒå±‚ä¸¤è¦ç´ â€çš„æ•°æ®æ²»ç†æ¶æ„ï¼š</strong></p><p>è¡¨1ï¼šæ—¥æœ¬â€œç»¼åˆæ•°æ®æˆ˜ç•¥â€æå‡ºçš„æ•°æ®æ²»ç†æ¶æ„</p><table><thead><tr><th>å±‚çº§</th><th>å†…å®¹</th><th>è¦ç´ </th></tr></thead><tbody><tr><td>ç¬¬ä¸ƒå±‚</td><td>æˆ˜ç•¥ã€æ”¿ç­–</td><td>è¦ç´ ä¸€ï¼šç¤¾ä¼šå®æ–½å’Œä¸šåŠ¡æ”¹é©</td></tr><tr><td>ç¬¬å…­å±‚</td><td>ç»„ç»‡ï¼šè¡Œæ”¿åŠæ°‘é—´ä¸šåŠ¡æ”¹é©</td><td></td></tr><tr><td>ç¬¬äº”å±‚</td><td>è§„åˆ™ï¼šé™¤äº†å®Œå–„æ•°æ®æ ‡å‡†å’Œè´¨é‡ç­‰æ•°æ®è”åˆæ‰€éœ€çš„è§„åˆ™å¤–ï¼Œè¿˜å®Œå–„äº†ç”¨äºæ”¾å¿ƒåˆ©ç”¨æ•°æ®çš„ä¿¡ä»»åŸºç¡€ç­‰è§„åˆ™ã€‚</td><td>è¦ç´ äºŒï¼šæ•°æ®ç¯å¢ƒå»ºè®¾</td></tr><tr><td>ç¬¬å››å±‚</td><td>åˆ©ç”¨ç¯å¢ƒï¼šä¸ºå„ç§å„æ ·çš„ä¸»ä½“ç†Ÿç»ƒä½¿ç”¨ä¸ªäººæ•°æ®å­˜å‚¨ã€ä¿¡æ¯é“¶è¡Œå’Œæ•°æ®äº¤æ˜“å¸‚åœºç­‰è”åˆçš„æ•°æ®æä¾›æœ‰åˆ©ç¯å¢ƒã€‚</td><td></td></tr><tr><td>ç¬¬ä¸‰å±‚</td><td>åˆä½œå¹³å°ï¼ˆå·¥å…·ï¼‰ï¼šä¸ºäº†ç³»ç»Ÿåœ°è”åˆä¸Šè¿°æ•°æ®ï¼Œé…å¤‡äº†ç›®å½•ç­‰æ•°æ®è”åˆå·¥å…·ã€‚</td><td></td></tr><tr><td>ç¬¬äºŒå±‚</td><td>æ•°æ®ï¼šä»ç¤¾ä¼šæ´»åŠ¨åŸºç¡€æ•°æ®ç€æ‰‹ï¼Œä»ç»“æ„ä¸Šæ„ç­‘å¿…è¦çš„æ•°æ®ã€‚</td><td></td></tr><tr><td>ç¬¬ä¸€å±‚</td><td>åŸºç¡€è®¾æ–½ï¼šæ”¯æ’‘æ•°å­—ç¤¾ä¼šçš„5Gã€æ•°æ®ä¸­å¿ƒã€è®¡ç®—åŸºç¡€è®¾æ–½ç­‰åŸºç¡€è®¾æ–½</td><td></td></tr></tbody></table><p>ä¹‹æ‰€ä»¥å®æ–½æ•°æ®å…¨äº§ä¸šé“¾æˆ˜ç•¥ï¼Œæ˜¯å› ä¸ºæ—¥æœ¬æ„è¯†åˆ°å…¶å­˜åœ¨æ•°å­—åŒ–è®¾æ–½ä¸å¥å…¨ã€ç¼ºä¹åŸºç¡€æ•°æ®ã€å®˜æ°‘å•†æ•°æ®å…±äº«ä¸å……åˆ†ã€ç¤¾ä¼šæ•´ä½“çš„æ•°æ®ç´ å…»ä½ã€å¯¹éšç§å¼ºçƒˆæ‹…å¿§ç­‰é—®é¢˜ã€‚å¦‚ä¸å®æ–½å…¨é¢çš„æªæ–½ï¼Œæ•°æ®å…±äº«éš¾ä»¥å¼€å±•ã€‚æ­¤å¤–ï¼Œæ—¥æœ¬æ”¿åºœè¿˜è®¡åˆ’ä½¿ä½œä¸ºæœ€å¤§æ•°æ®æŒæœ‰è€…çš„è¡Œæ”¿æœºæ„æœ¬èº«æˆä¸ºå…¨å›½æœ€å¤§çš„å¹³å°ï¼Œè®©å…¬å…±æ•°æ®å……åˆ†æµåŠ¨ã€‚</p></li></ul><h4 id="æ•°å­—æ”¹é©å…³è”å…­æ³•"><a href="#æ•°å­—æ”¹é©å…³è”å…­æ³•" class="headerlink" title="æ•°å­—æ”¹é©å…³è”å…­æ³•"></a>æ•°å­—æ”¹é©å…³è”å…­æ³•</h4><p>ï¼ˆç›¸å½“ä¸€éƒ¨åˆ†æŸ¥ä¸åˆ°ç»†åˆ™ï¼Œé‡ç‚¹æ˜¯ã€Šæ•°å­—ç¤¾ä¼šå½¢æˆåŸºæœ¬æ³•ã€‹ï¼‰</p><p>æ—¥æœ¬å›½ä¼šåœ¨2021å¹´5æœˆé€šè¿‡äº†å…­éƒ¨ä¸æ•°å­—åŒ–æ”¹é©ç›¸å…³çš„æ³•æ¡ˆï¼Œè¿™äº›æ³•æ¡ˆè¢«ç»Ÿç§°ä¸ºâ€œæ•°å­—æ”¹é©å…³è”å…­æ³•â€ã€‚è¿™äº›æ³•æ¡ˆçš„æ ¸å¿ƒç›®æ ‡æ˜¯æ¨åŠ¨æ—¥æœ¬çš„æ•°å­—åŒ–è½¬å‹ï¼ŒåŒ…æ‹¬è®¾ç«‹æ•°å­—å…æ¥ç»Ÿç­¹å…¨å›½ä¿¡æ¯ç³»ç»Ÿçš„ç®¡ç†ï¼Œç¡®ç«‹æ•°å­—åŒ–ç¤¾ä¼šçš„åŸºæœ¬å‘å±•ç†å¿µç­‰ã€‚å…¶ä¸­ï¼Œã€Šæ•°å­—ç¤¾ä¼šå½¢æˆåŸºæœ¬æ³•ã€‹æ˜¯è¿™ä¸€ç³»åˆ—æ³•æ¡ˆä¸­çš„é‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå®ƒè§„å®šäº†æ•°å­—ç¤¾ä¼šå½¢æˆæªæ–½çš„åŸºæœ¬åŸåˆ™å’ŒåŸºæœ¬æ”¿ç­–ï¼Œä»¥åŠä¸­å¤®æ”¿åºœã€åœ°æ–¹æ”¿åºœå’Œä¼ä¸šç»è¥è€…çš„è´£ä»»ã€‚æ—¥æœ¬æ”¿åºœå†³å®šäº2021å¹´9æœˆ1æ—¥æ­£å¼è®¾ç«‹æ•°å­—å…ï¼Œä½œä¸ºæ•°å­—åŒ–æ”¹é©çš„ç»Ÿä¸€é¢†å¯¼éƒ¨é—¨ã€‚è¿™äº›æ³•æ¡ˆçš„é€šè¿‡è¢«è§†ä¸ºæ—¥æœ¬æ•°å­—åŒ–æ”¹é©å‘å‰è¿ˆå‡ºçš„ä¸€å¤§æ­¥ï¼Œæ ‡å¿—ç€æ—¥æœ¬æ•°å­—åŒ–æˆ˜ç•¥é‡å¿ƒä»â€œç½‘ç»œå»ºè®¾â€è½¬å‘â€œæ•°æ®æ´»ç”¨â€çš„æ–°é˜¶æ®µã€‚</p><ol><li><p><strong>ã€Šæ•°å­—ç¤¾ä¼šå½¢æˆåŸºæœ¬æ³•ã€‹</strong>:</p><ul><li>è¯¥æ³•å¾‹æ˜¯æ•°å­—æ”¹é©çš„æ ¸å¿ƒï¼Œè§„å®šäº†æ•°å­—ç¤¾ä¼šå½¢æˆæªæ–½çš„åŸºæœ¬åŸåˆ™å’ŒåŸºæœ¬æ”¿ç­–ï¼Œæ˜ç¡®äº†ä¸­å¤®æ”¿åºœã€åœ°æ–¹æ”¿åºœå’Œä¼ä¸šç»è¥è€…çš„è´£ä»»ï¼Œä»¥åŠè®¾ç«‹æ•°å­—æœºæ„å’Œåˆ¶å®šä¼˜å…ˆè®¡åˆ’çš„è¦æ±‚ã€‚</li></ul></li><li><p><strong>ã€Šæ•°å­—å…è®¾ç½®æ³•ã€‹</strong>:</p><ul><li>è¯¥æ³•å¾‹æ˜ç¡®äº†æ•°å­—å…ä½œä¸ºæ•°å­—åŒ–æ”¹é©çš„ç»Ÿä¸€é¢†å¯¼éƒ¨é—¨çš„ç»„ç»‡å’ŒèŒè´£ï¼Œç¡®ç«‹äº†æ•°å­—å…åœ¨æ•°å­—åŒ–æ”¹é©ä¸­çš„ä¸­å¿ƒåœ°ä½ã€‚</li></ul></li><li><p><strong>ã€Šæ•°å­—æ”¹é©å…³è”æ³•ã€‹</strong>:</p><ul><li>è¯¥æ³•å¾‹æ˜¯æ—¥æœ¬å®˜æ–¹å’Œæ°‘é—´çš„æ•°å­—åŒ–æ”¹é©æŒ‡æŒ¥å¡”ï¼Œæ¶‰åŠå›½å®¶ä¿¡æ¯ç³»ç»Ÿçš„ç»Ÿç­¹ç®¡ç†è§„åˆ™ã€‚</li></ul></li><li><p><strong>ã€Šä¸ªäººä¿¡æ¯ä¿æŠ¤æ³•ã€‹ä¿®æ­£æ¡ˆ</strong>:</p><ul><li>é€šè¿‡ä¿®æ”¹ï¼Œå°†ç»Ÿä¸€æ—¥æœ¬å„åœ°æ–¹è‡ªæ²»ä½“ã€æ°‘é—´æœºæ„ç­‰å„ä¸ç›¸åŒçš„ä¸ªäººä¿¡æ¯ä¿æŠ¤æ³•åˆ™ï¼Œå¹¶å¯¼å…¥å…¨å›½ç»Ÿä¸€çš„ä¸ªäººä¿¡æ¯ä¿æŠ¤åˆ¶åº¦ï¼Œæ¨è¿›æ—¥æœ¬è¡Œæ”¿æ‰‹ç»­çº¿ä¸ŠåŒ–æ”¹é©ç­‰æ•°å­—åŒ–æ”¹é©ã€‚</li></ul></li><li><p><strong>ã€Šåœ°æ–¹å…¬å…±å›¢ä½“ä¿¡æ¯ç³»ç»Ÿæ ‡å‡†åŒ–æ³•ã€‹</strong>:</p><ul><li>è¯¥æ³•å¾‹æ—¨åœ¨ç»Ÿä¸€åœ°æ–¹æ”¿åºœçš„ä¿¡æ¯ç³»ç»Ÿï¼Œè§„å®šåœ°æ–¹æ”¿åºœçš„ä¿¡æ¯ç³»ç»Ÿåº”ç»Ÿä¸€ä¸ºå›½å®¶æŒ‡å®šçš„æ ¼å¼ï¼Œä»¥ä¿ƒè¿›æ•°æ®äº’é€šå’Œæ ‡å‡†åŒ–ã€‚</li></ul></li><li><p><strong>å…¶ä»–ç›¸å…³æ³•å¾‹</strong>:</p><ul><li>é™¤äº†ä¸Šè¿°æ³•å¾‹å¤–ï¼Œè¿˜åŒ…æ‹¬å…¶ä»–ä¸æ•°å­—åŒ–æ”¹é©ç›¸å…³çš„æ³•å¾‹ï¼Œå¦‚ä¿ƒè¿›æ•°æ®çš„å¼€æ”¾å’Œåˆ©ç”¨ã€åŠ å¼ºç½‘ç»œå®‰å…¨ç­‰ã€‚</li></ul></li></ol><p>è¿™å…­éƒ¨æ³•å¾‹å…±åŒæ¨åŠ¨äº†æ—¥æœ¬æ•°å­—åŒ–æ”¹é©ï¼Œæ—¨åœ¨è§£å†³æ•°å­—åŒ–è¿›ç¨‹ä¸­çš„å„ç§é—®é¢˜ï¼Œå¦‚è¡Œæ”¿ç”µå­åŒ–ç¨‹åº¦ä½ä¸‹ã€æ•°æ®å­¤å²›ã€ä¸ªäººä¿¡æ¯ä¿æŠ¤ç­‰ï¼ŒåŒæ—¶ä¿ƒè¿›æ•°æ®çš„å¼€æ”¾ã€æµé€šå’Œåˆ©ç”¨ï¼Œæé«˜è¡Œæ”¿æ•ˆç‡å’Œé€æ˜åº¦ï¼Œæ¨åŠ¨ç»æµç¤¾ä¼šçš„æ•°å­—åŒ–è½¬å‹ã€‚é€šè¿‡è¿™äº›æ³•å¾‹çš„å®æ–½ï¼Œæ—¥æœ¬æ”¿åºœå¸Œæœ›å»ºç«‹ä¸€ä¸ªå®‰å…¨ã€ä¾¿æ·ã€é«˜æ•ˆçš„æ•°å­—ç¤¾ä¼šã€‚</p><h5 id="2021å¹´5æœˆï¼šæ•°å­—ç¤¾ä¼šå½¢æˆåŸºæœ¬æ³•ï¼ˆé‡ç‚¹ï¼‰"><a href="#2021å¹´5æœˆï¼šæ•°å­—ç¤¾ä¼šå½¢æˆåŸºæœ¬æ³•ï¼ˆé‡ç‚¹ï¼‰" class="headerlink" title="2021å¹´5æœˆï¼šæ•°å­—ç¤¾ä¼šå½¢æˆåŸºæœ¬æ³•ï¼ˆé‡ç‚¹ï¼‰"></a>2021å¹´5æœˆï¼šæ•°å­—ç¤¾ä¼šå½¢æˆåŸºæœ¬æ³•ï¼ˆé‡ç‚¹ï¼‰</h5><ul><li><strong>æ³•å¾‹&#x2F;æ”¿ç­–åç§°</strong>: æ•°å­—ç¤¾ä¼šå½¢æˆåŸºæœ¬æ³•</li><li><strong>æ¦‚è¦ä»‹ç»</strong>:  è¯¥æ³•è§„å®šäº†æ•°å­—ç¤¾ä¼šå½¢æˆæªæ–½åˆ¶å®šçš„åŸºæœ¬åŸåˆ™å’ŒåŸºæœ¬æ”¿ç­–ï¼Œä¸­å¤®æ”¿åºœã€åœ°æ–¹æ”¿åºœå’Œä¼ä¸šç»è¥è€…çš„è´£ä»»ï¼Œè®¾ç«‹æ•°å­—æœºæ„ï¼Œåˆ¶å®šä¼˜å…ˆè®¡åˆ’ï¼Œæ ‡å¿—ç€æ—¥æœ¬æ•°å­—åŒ–çš„æˆ˜ç•¥é‡å¿ƒå·²ä»â€œç½‘ç»œå»ºè®¾â€è½¬å‘â€œæ•°æ®æ´»ç”¨â€ã€‚</li><li>ç›¸å…³æ¶‰åŠåè¯ï¼š<ol><li><strong>ä¸ªäººæ•°æ®å•†åº—ï¼ˆPersonal Data Storeï¼ŒPDSï¼‰</strong>:<ul><li><strong>å®šä¹‰</strong>: ä¸ªäººæ•°æ®å•†åº—ä»£è¡¨ç”¨æˆ·ç®¡ç†å…¶ä¸ªäººæ•°æ®ï¼Œå¹¶æ ¹æ®ç”¨æˆ·ä¸ªäººæ„æ„¿å°†å…¶æä¾›ç»™ç¬¬ä¸‰æ–¹ã€‚å®ƒå…è®¸ç”¨æˆ·æ§åˆ¶è‡ªå·±çš„æ•°æ®ï¼Œå¹¶åœ¨ç¬¬ä¸‰æ–¹éœ€è¦æ—¶æä¾›æ•°æ®ï¼Œä»è€Œå®ç°æ•°æ®çš„æœ‰åºæµé€šåŠä»·å€¼å¢å€¼ã€‚</li></ul></li><li><strong>æ•°æ®é“¶è¡Œ</strong>:<ul><li><strong>å®šä¹‰</strong>: æ•°æ®é“¶è¡Œæ¨¡å¼ä¸‹ï¼Œé“¶è¡Œæ ¹æ®ä¸ç”¨æˆ·ä¸ªäººç­¾è®¢çš„åˆåŒç®¡ç†ä¸ªäººæ•°æ®ï¼Œå¹¶æ ¹æ®ä¸ªäººçš„æŒ‡ç¤ºæˆ–é¢„å…ˆæŒ‡å®šçš„æ¡ä»¶å‘ç¬¬ä¸‰æ–¹æä¾›æ•°æ®ã€‚</li></ul></li><li><strong>Data Plaza</strong>:<ul><li><strong>å®šä¹‰</strong>: ç”±å¯Œå£«é€šå…¬å¸åœ¨2013å¹´4æœˆå»ºç«‹ï¼Œæ—¨åœ¨ä¸ºå®¢æˆ·æä¾›ä¸€ä¸ªäº’é€šæœ‰æ— ã€ä¿ƒè¿›åˆä½œåˆ›æ–°çš„å¹³å°ï¼Œæ‰“ç ´æ•°æ®å­¤å²›ï¼Œä½¿ä¸åŒé¢†åŸŸçš„å®¢æˆ·èƒ½å¤Ÿå®‰å…¨ã€é«˜æ•ˆåœ°å…±äº«ä¿¡æ¯ã€‚</li><li><strong>åˆ†ç±»</strong>: Data Plazaå¯ä»¥å½’ç±»ä¸ºâ€œæ•°æ®çš„æµé€šã€å¼€å‘åˆ©ç”¨â€åŸºç¡€è®¾æ–½ï¼Œå› ä¸ºå®ƒä¸ä»…ä¿ƒè¿›äº†æ•°æ®çš„æµé€šï¼Œè¿˜æä¾›äº†æ•°æ®å¢å€¼è§£å†³æ–¹æ¡ˆã€‚</li></ul></li><li><strong>æ•°æ®ä½¿ç”¨æƒäº¤æ˜“å¸‚åœº</strong>:<ul><li><strong>å®šä¹‰</strong>: è¿™æ˜¯ä¸€ä¸ªä»¥â€œæ•°æ®ä½¿ç”¨æƒè¯ä¹¦â€ä½œä¸ºæ•°æ®äº¤æ˜“æ ‡çš„çš„å¸‚åœºï¼Œå°†åˆæ³•ä½¿ç”¨æ•°æ®çš„æƒåˆ©è¯åˆ¸åŒ–ã€‚</li></ul></li><li><strong>ä¸ªäººå·ç åˆ¶åº¦</strong>:<ul><li><strong>å®šä¹‰</strong>: æ¯ä½æ‹¥æœ‰æ—¥æœ¬åœ¨ç•™å¡çš„å±…æ°‘éƒ½å°†æ‹¥æœ‰ä¸€ä¸ª12ä½æ•°å­—çš„å·ç ï¼Œç”¨äºå¤šç§è¡Œæ”¿å’ŒæœåŠ¡åœºåˆã€‚</li></ul></li><li><strong>æ•°å­—å…</strong>:<ul><li><strong>å®šä¹‰</strong>: æ•°å­—å…æ˜¯æ—¥æœ¬æ”¿åºœä¸ºäº†æ¨è¿›æ•°å­—åŒ–æ”¹é©è€Œè®¾ç«‹çš„ç»Ÿä¸€é¢†å¯¼éƒ¨é—¨ã€‚</li></ul></li><li><strong>åœ°æ–¹å…¬å…±å›¢ä½“ä¿¡æ¯ç³»ç»Ÿæ ‡å‡†åŒ–æ³•</strong>:<ul><li><strong>å®šä¹‰</strong>: è¯¥æ³•å¾‹æ—¨åœ¨ç»Ÿä¸€åœ°æ–¹æ”¿åºœçš„ä¿¡æ¯ç³»ç»Ÿï¼Œè§„å®šåœ°æ–¹æ”¿åºœçš„ä¿¡æ¯ç³»ç»Ÿåº”ç»Ÿä¸€ä¸ºå›½å®¶æŒ‡å®šçš„æ ¼å¼ã€‚</li></ul></li></ol></li></ul><h5 id="2021å¹´5æœˆï¼šæ•°å­—å…è®¾ç½®æ³•"><a href="#2021å¹´5æœˆï¼šæ•°å­—å…è®¾ç½®æ³•" class="headerlink" title="2021å¹´5æœˆï¼šæ•°å­—å…è®¾ç½®æ³•"></a>2021å¹´5æœˆï¼šæ•°å­—å…è®¾ç½®æ³•</h5><p>ã€Šæ•°å­—å…è®¾ç½®æ³•ã€‹ æ˜¯æ—¥æœ¬ä¸ºäº†æ¨è¿›è¡Œæ”¿æ•°å­—åŒ–å’Œæ”¹é©è€Œåˆ¶å®šçš„ä¸€é¡¹é‡è¦æ³•å¾‹ã€‚è¯¥æ³•å¾‹ç¡®ç«‹äº†æ•°å­—å…çš„ç»„ç»‡ç»“æ„ã€èŒè´£å’Œè¿ä½œæ–¹å¼ã€‚ä»¥ä¸‹æ˜¯ã€Šæ•°å­—å…è®¾ç½®æ³•ã€‹çš„ä¸€äº›å…³é”®ç‚¹ï¼š</p><ol><li><p><strong>æˆç«‹æ—¶é—´</strong>: 2021å¹´5æœˆï¼Œæ—¥æœ¬å›½ä¼šé€šè¿‡äº†åŒ…æ‹¬ã€Šæ•°å­—å…è®¾ç½®æ³•ã€‹åœ¨å†…çš„å…­éƒ¨â€œæ•°å­—æ”¹é©å…³è”æ³•æ¡ˆâ€ï¼Œå¹¶äº2021å¹´9æœˆ1æ—¥æ­£å¼è®¾ç«‹æ•°å­—å…ã€‚</p></li><li><p><strong>ç›®çš„</strong>: æ•°å­—å…çš„æˆç«‹æ—¨åœ¨åŠ é€Ÿæ—¥æœ¬çš„æ•°å­—åŒ–æ”¹é©ï¼Œæé«˜è¡Œæ”¿æ‰‹ç»­çº¿ä¸Šæ“ä½œçš„ä¾¿æ·æ€§ï¼Œå‰Šå‡è¡Œæ”¿è¿è¥æˆæœ¬ï¼Œå¹¶è§£å†³æ”¿åºœåœ¨æ•°å­—åŒ–æ–¹é¢çš„æ»åé—®é¢˜ã€‚</p></li><li><p><strong>ç»„ç»‡ç»“æ„</strong>: æ•°å­—å…ç”±æ—¥æœ¬é¦–ç›¸æ‹…ä»»å…é•¿ï¼Œä¸‹è®¾æ•°å­—å¤§è‡£è´Ÿè´£å…·ä½“äº‹åŠ¡ã€‚é™¤æ•°å­—å¤§è‡£å¤–ï¼Œè¿˜æœ‰å‰¯å¤§è‡£ã€å¤§è‡£æ”¿åŠ¡å®˜ä»¥åŠæ•°å­—æ€»ç›‘ç­‰èŒä½ã€‚</p></li><li><p><strong>äººå‘˜æ„æˆ</strong>: æ•°å­—å…çš„äººå‘˜è§„æ¨¡çº¦ä¸º600äººï¼Œå…¶ä¸­åŒ…æ‹¬çº¦200åæ¥è‡ªç§è¥éƒ¨é—¨çš„æ•°å­—åŒ–é¢†åŸŸäººæ‰ï¼Œä½“ç°äº†æ”¿åºœå¯¹æ°‘é—´ä¸“ä¸šäººæ‰çš„é‡è§†ã€‚</p></li><li><p><strong>èŒè´£</strong>: æ•°å­—å…è´Ÿè´£ç»Ÿç­¹å…¨å›½ä¿¡æ¯ç³»ç»Ÿçš„ç®¡ç†ï¼Œæ¨è¿›æ”¿åºœå†…éƒ¨çš„æ•°å­—åŒ–æ”¹é©ï¼Œå®ç°ä»â€œæ•°å­—åŒ–â€åˆ°â€œæ•°å­—æ²»ç†â€çš„è´¨çš„æå‡ã€‚æ­¤å¤–ï¼Œæ•°å­—å…è¿˜è´Ÿè´£åˆ¶å®šæ•°å­—ç¤¾ä¼šå½¢æˆçš„åŸºæœ¬æ”¿ç­–å’Œä¼˜å…ˆè®¡åˆ’ã€‚</p></li><li><p><strong>æƒé™</strong>: æ•°å­—å…æ‹¥æœ‰å‘å…¶ä»–ä¸­å¤®æ”¿åºœéƒ¨é—¨å‘å‡ºä¸šåŠ¡ä¿®æ”¹ç­‰å»ºè®®çš„æƒé™ï¼Œä»¥ä¿ƒè¿›ä¸åŒæ”¿åºœéƒ¨é—¨é—´çš„æ ‡å‡†åŒ–å’Œäº’é€šåŒ–ã€‚</p></li><li><p><strong>ç›®æ ‡</strong>: æ•°å­—å…çš„è¿œæœŸç›®æ ‡æ˜¯â€œç”¨æ™ºèƒ½æ‰‹æœºåœ¨60ç§’å†…å®Œæˆæ‰€æœ‰è¡Œæ”¿ç¨‹åºâ€ï¼Œä½“ç°äº†æ—¥æœ¬æ”¿åºœå¯¹äºæé«˜è¡Œæ”¿æ•ˆç‡çš„åšå®šå†³å¿ƒã€‚</p></li><li><p><strong>å…¶ä»–èŒè´£</strong>: æ•°å­—å…è¿˜è´Ÿè´£æ¨å¹¿â€œæˆ‘çš„å·ç â€ç³»ç»Ÿï¼Œä¸ºæ‰€æœ‰å±…æ°‘æä¾›èº«ä»½è¯å·ç ï¼Œè¿™è¢«è§†ä¸ºæ”¹å–„å…¬å…±æ•°å­—æœåŠ¡çš„å…³é”®ã€‚</p></li></ol><p>ã€Šæ•°å­—å…è®¾ç½®æ³•ã€‹çš„åˆ¶å®šå’Œæ•°å­—å…çš„æˆç«‹æ ‡å¿—ç€æ—¥æœ¬æ”¿åºœåœ¨æ•°å­—åŒ–è½¬å‹æ–¹é¢è¿ˆå‡ºäº†é‡è¦ä¸€æ­¥ï¼Œå±•ç°äº†å…¶æ¨åŠ¨å›½å®¶æ²»ç†ç°ä»£åŒ–å’Œæå‡å…¬å…±æœåŠ¡æ•ˆç‡çš„å†³å¿ƒã€‚</p><h5 id="2021å¹´9æœˆï¼šæ•°å­—å…çš„è®¾ç«‹"><a href="#2021å¹´9æœˆï¼šæ•°å­—å…çš„è®¾ç«‹" class="headerlink" title="2021å¹´9æœˆï¼šæ•°å­—å…çš„è®¾ç«‹"></a>2021å¹´9æœˆï¼šæ•°å­—å…çš„è®¾ç«‹</h5><ul><li><strong>æ³•å¾‹&#x2F;æ”¿ç­–åç§°</strong>: æ•°å­—å…çš„è®¾ç«‹</li><li><strong>æ¦‚è¦ä»‹ç»</strong>:  æ•°å­—å…çš„æˆç«‹æ—¨åœ¨è¿…é€Ÿä¸”é‡ç‚¹æ¨è¿›æ•°å­—ç¤¾ä¼šè¿›ç¨‹ï¼Œç»Ÿç­¹æ¨è¿›å…¨å›½æ•°å­—ç¤¾ä¼šå»ºè®¾ã€æ•°å­—åŒ–è½¬å‹ã€‚</li><li>ITæ–¹é¢æŠ€æœ¯æˆ˜ç•¥çš„æ”¿åºœç»„ç»‡ä½“åˆ¶åŒ…æ‹¬ï¼š<ul><li>ç”±å†…é˜çš„ç»¼åˆåˆ›æ–°æˆ˜ç•¥æ¨è¿›ä¼šè®®ï¼Œè´Ÿè´£æ”¿åºœå†…éƒ¨è°ƒæ•´åŠæ¨è¿›ã€Šç»¼åˆåˆ›æ–°æˆ˜ç•¥ã€‹ï¼›</li><li>å†…é˜åºœçš„ç»¼åˆç§‘å­¦æŠ€æœ¯åˆ›æ–°ä¼šè®®ï¼Œæ±‡æ€»å„éƒ¨é—¨çš„ç§‘å­¦æŠ€æœ¯åˆ›æ–°æ–¹é¢ç›¸å…³æ”¿ç­–ï¼Œå®æ–½ç»¼åˆè°ƒæ•´ï¼›</li><li>å„çœå…æœºæ„åœ¨å„è‡ªç®¡è¾–çš„äº§ä¸šå’Œé¢†åŸŸä¸­ï¼Œè´Ÿè´£å…·ä½“æªæ–½çš„åˆ¶å®šå’Œæ‰§è¡Œã€‚</li></ul></li></ul><h5 id="2021å¹´5æœˆï¼šåœ°æ–¹å…¬å…±å›¢ä½“ä¿¡æ¯ç³»ç»Ÿæ ‡å‡†æ³•"><a href="#2021å¹´5æœˆï¼šåœ°æ–¹å…¬å…±å›¢ä½“ä¿¡æ¯ç³»ç»Ÿæ ‡å‡†æ³•" class="headerlink" title="2021å¹´5æœˆï¼šåœ°æ–¹å…¬å…±å›¢ä½“ä¿¡æ¯ç³»ç»Ÿæ ‡å‡†æ³•"></a>2021å¹´5æœˆï¼šåœ°æ–¹å…¬å…±å›¢ä½“ä¿¡æ¯ç³»ç»Ÿæ ‡å‡†æ³•</h5><p>åœ°æ–¹å…¬å…±å›¢ä½“ä¿¡æ¯ç³»ç»Ÿæ ‡å‡†åŒ–æ³•æ˜¯æ—¥æœ¬ä¸ºæ¨è¿›åœ°æ–¹è¡Œæ”¿æ•°å­—åŒ–å’Œä¿¡æ¯ç³»ç»Ÿæ ‡å‡†åŒ–è€Œåˆ¶å®šçš„æ³•å¾‹ã€‚è¿™é¡¹æ³•å¾‹çš„ç›®çš„æ˜¯ç»Ÿä¸€åœ°æ–¹æ”¿åºœçš„ä¿¡æ¯ç³»ç»Ÿï¼Œä»¥ä¿ƒè¿›æ•°æ®äº’é€šå’Œæ ‡å‡†åŒ–ã€‚ä»¥ä¸‹æ˜¯å…³äºè¯¥æ³•å¾‹çš„ä¸€äº›å…³é”®ç‚¹ï¼š</p><ol><li><p><strong>ç»Ÿä¸€ä¿¡æ¯ç³»ç»Ÿ</strong>: è¯¥æ³•å¾‹è¦æ±‚åœ°æ–¹æ”¿åºœçš„ä¿¡æ¯ç³»ç»Ÿåº”ç»Ÿä¸€ä¸ºå›½å®¶æŒ‡å®šçš„æ ¼å¼ï¼Œä»¥å®ç°ä¸åŒåœ°æ–¹æ”¿åºœé—´çš„ä¿¡æ¯å…±äº«å’Œç³»ç»Ÿäº’é€šã€‚</p></li><li><p><strong>æ ‡å‡†åŒ–å¯¹è±¡</strong>: æ ‡å‡†åŒ–çš„å¯¹è±¡åŒ…æ‹¬å„¿ç«¥æ´¥è´´ã€å±…æ°‘åŸºæœ¬å°å¸ã€é€‰ä¸¾äººåç°¿ç®¡ç†ã€å›ºå®šèµ„äº§ç¨ã€ä¸ªäººå±…æ°‘ç¨ã€æ³•äººå±…æ°‘ç¨ã€è½»å‹æ±½è½¦ç¨ã€å°±å­¦ã€å›½æ°‘å¥åº·ä¿é™©ã€å›½æ°‘å¹´é‡‘ã€æ®‹ç–¾äººç¦åˆ©ã€åæœŸé«˜é¾„è€…åŒ»ç–—æŠ¤ç†ä¿é™©ç­‰ã€‚</p></li><li><p><strong>åˆ¶å®šä¸»ä½“</strong>: ç”±ä¸­å¤®æ”¿åºœè´Ÿè´£åˆ¶å®šåœ°æ–¹å…¬å…±å›¢ä½“ä¿¡æ¯ç³»ç»Ÿæ ‡å‡†åŒ–çš„åŸºæœ¬æ–¹é’ˆï¼›å…·ä½“ä¸»ç®¡ä¸Šè¿°é¢†åŸŸçš„è´Ÿè´£äººè´Ÿè´£åˆ¶å®šä¿¡æ¯ç³»ç»Ÿæ ‡å‡†ï¼›é¦–ç›¸å’Œæ€»åŠ¡å¤§è‡£è´Ÿè´£åˆ¶å®šæ•°æ®åä½œã€ç½‘ç»œå®‰å…¨ã€äº‘åˆ©ç”¨ç­‰å„ä¿¡æ¯ç³»ç»Ÿå…±é€šäº‹é¡¹çš„æ ‡å‡†ã€‚</p></li><li><p><strong>åœ°æ–¹æ”¿åºœçš„ä¹‰åŠ¡</strong>: åœ°æ–¹æ”¿åºœå¿…é¡»åœ¨çœå…è§„å®šçš„æœŸé™å†…ä½¿å…¶ä¿¡æ¯ç³»ç»Ÿè¾¾æ ‡ï¼Œå¹¶åŠªåŠ›åœ¨å›½å®¶å‡†å¤‡çš„â€œäº‘æ´»ç”¨â€ç¯å¢ƒä¸­æ´»ç”¨ä¿¡æ¯ç³»ç»Ÿã€‚</p></li><li><p><strong>æé«˜è¡Œæ”¿æ•ˆç‡</strong>: é€šè¿‡æ ‡å‡†åŒ–ï¼Œæ—¨åœ¨æé«˜è¡Œæ”¿æ‰‹ç»­çº¿ä¸Šæ“ä½œçš„ä¾¿æ·æ€§ï¼Œå‰Šå‡è¡Œæ”¿è¿è¥æˆæœ¬ï¼Œå®ç°æ›´é«˜æ•ˆçš„æ”¿åºœæœåŠ¡ã€‚</p></li><li><p><strong>ä¿ƒè¿›æ•°æ®å…±äº«</strong>: è¯¥æ³•å¾‹æœ‰åŠ©äºæ‰“ç ´æ•°æ®å­¤å²›ï¼Œä¿ƒè¿›ä¸åŒåœ°æ–¹æ”¿åºœå’Œä¸­å¤®æ”¿åºœä¹‹é—´æ•°æ®çš„å…±äº«å’Œåˆ©ç”¨ã€‚</p></li><li><p><strong>æ”¯æŒæ•°å­—åŒ–æ”¹é©</strong>: ä½œä¸ºæ•°å­—æ”¹é©å…³è”å…­æ³•çš„ä¸€éƒ¨åˆ†ï¼Œè¯¥æ³•å¾‹æ”¯æŒæ—¥æœ¬æ”¿åºœæ¨åŠ¨çš„å…¨é¢æ•°å­—åŒ–æ”¹é©ï¼ŒåŒ…æ‹¬æ•°å­—å…çš„è®¾ç«‹å’Œè¿ä½œã€‚</p></li></ol><p>åœ°æ–¹å…¬å…±å›¢ä½“ä¿¡æ¯ç³»ç»Ÿæ ‡å‡†åŒ–æ³•æ˜¯æ—¥æœ¬æ•°å­—åŒ–è½¬å‹æˆ˜ç•¥çš„å…³é”®ç»„æˆéƒ¨åˆ†ï¼Œå®ƒé€šè¿‡æ ‡å‡†åŒ–æªæ–½ï¼ŒåŠ å¼ºäº†åœ°æ–¹æ”¿åºœä¿¡æ¯ç³»ç»Ÿçš„æ•´åˆå’Œäº’æ“ä½œæ€§ï¼Œä¸ºå»ºç«‹ä¸€ä¸ªæ›´åŠ é«˜æ•ˆå’Œé€æ˜çš„è¡Œæ”¿ä½“ç³»å¥ å®šäº†åŸºç¡€ã€‚</p><h3 id="2ï¼‰ç›¸å…³åè¯æ¦‚å¿µ"><a href="#2ï¼‰ç›¸å…³åè¯æ¦‚å¿µ" class="headerlink" title="2ï¼‰ç›¸å…³åè¯æ¦‚å¿µ"></a>2ï¼‰ç›¸å…³åè¯æ¦‚å¿µ</h3><table><thead><tr><th>å¹´ä»½</th><th>æ³•è§„&#x2F;æ³•å¾‹&#x2F;æ”¿ç­–&#x2F;å®šä¹‰</th><th>åè¯</th><th>è§£é‡Š</th><th>å±äºå“ªç±»çš„èŒƒå›´</th></tr></thead><tbody><tr><td>2021å¹´</td><td>æ•°å­—ç¤¾ä¼šå½¢æˆåŸºæœ¬æ³•</td><td>ä¸ªäººæ•°æ®å•†åº—ï¼ˆPersonal Data Storeï¼ŒPDSï¼‰</td><td>ä¸ªäººæ•°æ®å•†åº—ä»£è¡¨<strong>ç”¨æˆ·ç®¡ç†å…¶ä¸ªäººæ•°æ®</strong>ï¼Œ<strong>å¹¶æ ¹æ®ç”¨æˆ·ä¸ªäººæ„æ„¿å°†å…¶æä¾›ç»™ç¬¬ä¸‰æ–¹ã€‚å®ƒå…è®¸ç”¨æˆ·æ§åˆ¶è‡ªå·±çš„æ•°æ®ï¼Œå¹¶åœ¨ç¬¬ä¸‰æ–¹éœ€è¦æ—¶æä¾›æ•°æ®ï¼Œä»è€Œå®ç°æ•°æ®çš„æœ‰åºæµé€šåŠä»·å€¼å¢å€¼ã€‚</strong></td><td>ä¸ªäºº</td></tr><tr><td>2021å¹´</td><td>æ•°å­—ç¤¾ä¼šå½¢æˆåŸºæœ¬æ³•</td><td>æ•°æ®é“¶è¡Œ</td><td>æ•°æ®é“¶è¡Œæ¨¡å¼ä¸‹ï¼Œé“¶è¡Œæ ¹æ®ä¸ç”¨æˆ·ä¸ªäººç­¾è®¢çš„åˆåŒç®¡ç†ä¸ªäººæ•°æ®ï¼Œå¹¶æ ¹æ®ä¸ªäººçš„æŒ‡ç¤ºæˆ–é¢„å…ˆæŒ‡å®šçš„æ¡ä»¶å‘ç¬¬ä¸‰æ–¹æä¾›æ•°æ®ã€‚</td><td>æ”¿åºœ</td></tr><tr><td>2021å¹´</td><td>æ•°å­—ç¤¾ä¼šå½¢æˆåŸºæœ¬æ³•</td><td>æ”¿åŠ¡æ•°æ®GBizå¹³å°ã€å†œä¸šæ•°æ®WAGRIå¹³å°ã€é˜²ç¾ä¿¡æ¯SIP4Då¹³å°</td><td>è¿™äº›å¹³å°ä½œä¸º<strong>æ•°æ®ç©ºé—´</strong>ï¼Œä¿ƒè¿›ä¸åŒé¢†åŸŸæ•°æ®çš„å®‰å…¨ã€å¯ä¿¡ã€é«˜æ•ˆæµé€šå…±äº«ï¼Œå±äºæ•°æ®æµé€šçš„åŸºç¡€è®¾æ–½ã€‚</td><td>æ”¿åºœ</td></tr><tr><td>2021å¹´</td><td>æ•°å­—ç¤¾ä¼šå½¢æˆåŸºæœ¬æ³•</td><td>Data Plaza</td><td>å¯Œå£«é€šå…¬å¸2013å¹´4æœˆå»ºç«‹çš„æ•°æ®äº¤æ˜“æœºæ„ï¼Œä¸ºå®¢æˆ·æä¾›äº’é€šæœ‰æ— ã€ä¿ƒè¿›åˆä½œåˆ›æ–°çš„å¹³å°ï¼Œæ‰“ç ´æ•°æ®å­¤å²›ã€‚</td><td>ä¼ä¸š</td></tr><tr><td>2021å¹´</td><td>æ•°å­—ç¤¾ä¼šå½¢æˆåŸºæœ¬æ³•</td><td>æ•°æ®ä½¿ç”¨æƒäº¤æ˜“å¸‚åœº</td><td>è¿™ä¸ªå¸‚åœºå±äºâ€œæ•°æ®çš„æµé€šã€å¼€å‘åˆ©ç”¨â€ç±»åˆ«ï¼Œå› ä¸ºå®ƒæä¾›äº†ä¸€ä¸ªå¹³å°ï¼Œä½¿å¾—æ•°æ®ä½¿ç”¨æƒå¯ä»¥åƒè¯åˆ¸ä¸€æ ·è¢«äº¤æ˜“å’Œæµé€šï¼Œä»è€Œä¿ƒè¿›äº†æ•°æ®çš„å¼€å‘åˆ©ç”¨ã€‚</td><td>ä¼ä¸š&#x2F;æ”¿åºœ</td></tr><tr><td>2021å¹´</td><td>æ•°å­—ç¤¾ä¼šå½¢æˆåŸºæœ¬æ³•</td><td>ä¸ªäººå·ç åˆ¶åº¦</td><td>æ¯ä½æ‹¥æœ‰æ—¥æœ¬åœ¨ç•™å¡çš„å±…æ°‘éƒ½å°†æ‹¥æœ‰ä¸€ä¸ª12ä½æ•°å­—çš„å·ç ï¼Œç”¨äºå¤šç§è¡Œæ”¿å’ŒæœåŠ¡åœºåˆçš„åˆ¶åº¦ã€‚</td><td>æ”¿åºœ</td></tr><tr><td>2021å¹´</td><td>æ•°å­—å…è®¾ç½®æ³•</td><td>æ•°å­—å…</td><td>æ—¥æœ¬æ”¿åºœè®¾ç«‹çš„ç»Ÿä¸€é¢†å¯¼éƒ¨é—¨ï¼Œæ¨è¿›æ•°å­—åŒ–æ”¹é©ï¼Œè´Ÿè´£åˆ¶å®šå’Œæ¨è¿›ç›¸å…³æ”¿ç­–ã€‚</td><td>æ”¿åºœ</td></tr><tr><td>-</td><td>ã€Šç»¼åˆæ•°æ®æˆ˜ç•¥ã€‹çš„èƒŒæ™¯ä¸‹</td><td>DATA-EX</td><td>å»ºç«‹ä¸€ä¸ªæ•°æ®åä½œå¹³å°ï¼Œä¿ƒè¿›ä¸åŒé¢†åŸŸå’Œä¸åŒè¡Œä¸šçš„æ•°æ®äº¤æ¢ä¸åˆ©ç”¨ï¼Œç›®æ ‡æ˜¯è¿æ¥å„è¡Œä¸šçš„ç‰¹å®šæ•°æ®å¹³å°ï¼Œé€šè¿‡æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ•°æ®äº¤æ¢ç¯å¢ƒï¼Œä¿ƒè¿›ä¸åŒé¢†åŸŸçš„æ•°æ®äº¤æ¢å’Œåä½œã€‚</td><td>æ—¥æœ¬æ•°æ®ç¤¾ä¼šè”ç›Ÿ</td></tr></tbody></table><h3 id="3ï¼‰æ•°æ®åŸºç¡€è®¾æ–½ç›¸å…³æ¦‚å¿µä»‹ç»"><a href="#3ï¼‰æ•°æ®åŸºç¡€è®¾æ–½ç›¸å…³æ¦‚å¿µä»‹ç»" class="headerlink" title="3ï¼‰æ•°æ®åŸºç¡€è®¾æ–½ç›¸å…³æ¦‚å¿µä»‹ç»"></a>3ï¼‰æ•°æ®åŸºç¡€è®¾æ–½ç›¸å…³æ¦‚å¿µä»‹ç»</h3><table><thead><tr><th>å¹´ä»½</th><th>æ³•è§„&#x2F;æ³•å¾‹&#x2F;æ”¿ç­–&#x2F;å®šä¹‰</th><th>åè¯</th><th>è§£é‡Š</th><th>å±äºå“ªç±»çš„èŒƒå›´</th><th>å±äºå“ªç§åŸºç¡€è®¾æ–½</th></tr></thead><tbody><tr><td>2021å¹´</td><td>æ•°å­—ç¤¾ä¼šå½¢æˆåŸºæœ¬æ³•</td><td>ä¸ªäººæ•°æ®å•†åº—ï¼ˆPersonal Data Storeï¼ŒPDSï¼‰</td><td>ä¸ªäººæ•°æ®å•†åº—ä»£è¡¨<strong>ç”¨æˆ·ç®¡ç†å…¶ä¸ªäººæ•°æ®</strong>ï¼Œ<strong>å¹¶æ ¹æ®ç”¨æˆ·ä¸ªäººæ„æ„¿å°†å…¶æä¾›ç»™ç¬¬ä¸‰æ–¹ã€‚å®ƒå…è®¸ç”¨æˆ·æ§åˆ¶è‡ªå·±çš„æ•°æ®ï¼Œå¹¶åœ¨ç¬¬ä¸‰æ–¹éœ€è¦æ—¶æä¾›æ•°æ®ï¼Œä»è€Œå®ç°æ•°æ®çš„æœ‰åºæµé€šåŠä»·å€¼å¢å€¼ã€‚</strong></td><td>ä¸ªäºº</td><td>æ•°æ®çš„æµé€š</td></tr><tr><td>2021å¹´</td><td>æ•°å­—ç¤¾ä¼šå½¢æˆåŸºæœ¬æ³•</td><td>æ•°æ®é“¶è¡Œ</td><td>æ•°æ®é“¶è¡Œæ¨¡å¼ä¸‹ï¼Œé“¶è¡Œæ ¹æ®ä¸ç”¨æˆ·ä¸ªäººç­¾è®¢çš„åˆåŒç®¡ç†ä¸ªäººæ•°æ®ï¼Œå¹¶æ ¹æ®ä¸ªäººçš„æŒ‡ç¤ºæˆ–é¢„å…ˆæŒ‡å®šçš„æ¡ä»¶å‘ç¬¬ä¸‰æ–¹æä¾›æ•°æ®ã€‚</td><td>ä¸ªäºº</td><td>æ•°æ®çš„ä¾›ç»™</td></tr><tr><td>2021å¹´</td><td>æ•°å­—ç¤¾ä¼šå½¢æˆåŸºæœ¬æ³•</td><td>æ”¿åŠ¡æ•°æ®GBizå¹³å°ã€å†œä¸šæ•°æ®WAGRIå¹³å°ã€é˜²ç¾ä¿¡æ¯SIP4Då¹³å°</td><td>è¿™äº›å¹³å°ä½œä¸º<strong>æ•°æ®ç©ºé—´</strong>ï¼Œä¿ƒè¿›ä¸åŒé¢†åŸŸæ•°æ®çš„å®‰å…¨ã€å¯ä¿¡ã€é«˜æ•ˆæµé€šå…±äº«ï¼Œå±äºæ•°æ®æµé€šçš„åŸºç¡€è®¾æ–½ã€‚</td><td>æ”¿åºœ</td><td>æ•°æ®çš„æµé€šã€ä¾›ç»™</td></tr><tr><td>2021å¹´</td><td>æ•°å­—ç¤¾ä¼šå½¢æˆåŸºæœ¬æ³•</td><td>Data Plaza</td><td>å¯Œå£«é€šå…¬å¸2013å¹´4æœˆå»ºç«‹çš„æ•°æ®äº¤æ˜“æœºæ„ï¼Œä¸ºå®¢æˆ·æä¾›äº’é€šæœ‰æ— ã€ä¿ƒè¿›åˆä½œåˆ›æ–°çš„å¹³å°ï¼Œæ‰“ç ´æ•°æ®å­¤å²›ã€‚</td><td>ä¼ä¸š</td><td>æ•°æ®çš„ä¾›ç»™ã€æµé€š</td></tr><tr><td>2021å¹´</td><td>æ•°å­—ç¤¾ä¼šå½¢æˆåŸºæœ¬æ³•</td><td>æ•°æ®ä½¿ç”¨æƒäº¤æ˜“å¸‚åœº</td><td>ä»¥â€œæ•°æ®ä½¿ç”¨æƒè¯ä¹¦â€ä½œä¸ºäº¤æ˜“æ ‡çš„ï¼Œå°†åˆæ³•ä½¿ç”¨æ•°æ®çš„æƒåˆ©è¯åˆ¸åŒ–ï¼Œæ¿€æ´»æ•°æ®äº¤æ˜“æµé€šçš„å¸‚åœºã€‚</td><td>ä¼ä¸š&#x2F;æ”¿åºœ</td><td>æ•°æ®çš„æµé€š</td></tr><tr><td>-</td><td>ã€Šç»¼åˆæ•°æ®æˆ˜ç•¥ã€‹çš„èƒŒæ™¯ä¸‹</td><td>DATA-EX</td><td>å»ºç«‹ä¸€ä¸ªæ•°æ®åä½œå¹³å°ï¼Œä¿ƒè¿›ä¸åŒé¢†åŸŸå’Œä¸åŒè¡Œä¸šçš„æ•°æ®äº¤æ¢ä¸åˆ©ç”¨ï¼Œç›®æ ‡æ˜¯è¿æ¥å„è¡Œä¸šçš„ç‰¹å®šæ•°æ®å¹³å°ï¼Œé€šè¿‡æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ•°æ®äº¤æ¢ç¯å¢ƒï¼Œä¿ƒè¿›ä¸åŒé¢†åŸŸçš„æ•°æ®äº¤æ¢å’Œåä½œã€‚</td><td>æ—¥æœ¬æ•°æ®ç¤¾ä¼šè”ç›Ÿï¼ˆæ”¿åºœï¼‰</td><td>æ•°æ®çš„æµé€š</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> è°ƒç ” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŸºç¡€è®¾æ–½ </tag>
            
            <tag> æ•°æ®ç©ºé—´ </tag>
            
            <tag> æ•°å­—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ·±å…¥ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿï¼ˆä¸ƒï¼‰æ¡ˆä¾‹ç ”ç©¶</title>
      <link href="/2024/06/26/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%EF%BC%88%E4%B8%83%EF%BC%89%E6%A1%88%E4%BE%8B%E7%A0%94%E7%A9%B6/"/>
      <url>/2024/06/26/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%EF%BC%88%E4%B8%83%EF%BC%89%E6%A1%88%E4%BE%8B%E7%A0%94%E7%A9%B6/</url>
      
        <content type="html"><![CDATA[<h1 id="æ¡ˆä¾‹ç ”ç©¶"><a href="#æ¡ˆä¾‹ç ”ç©¶" class="headerlink" title="æ¡ˆä¾‹ç ”ç©¶"></a>æ¡ˆä¾‹ç ”ç©¶</h1><h4 id="7-1-åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ"><a href="#7-1-åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="7.1 åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ"></a>7.1 åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ</h4><p>GFS</p><p><a href="https://blog.csdn.net/tianwailaibin/article/details/6722956/?ops_request_misc=&request_id=&biz_id=102&utm_term=%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%8D%B7%E6%98%AF%E4%BB%80%E4%B9%88&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-6722956.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&spm=1018.2226.3001.4187">(459æ¡æ¶ˆæ¯) ä»€ä¹ˆæ˜¯ç°‡ï¼šä»€ä¹ˆæ˜¯å·_tianwailaibinçš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://zhuanlan.zhihu.com/p/354450124">ã€MIT 6.824ã€‘å­¦ä¹ ç¬”è®° 3: GFS - çŸ¥ä¹ (zhihu.com)</a></p><p><img src="https://s2.loli.net/2024/06/26/zCHi1YPJGlQMZUo.webp" alt="v2-75851b9c18c4b4b4b84507a9122129fa_1440w[1].webp"></p><h4 id="7-2-åˆ†å¸ƒå¼åè°ƒæœåŠ¡"><a href="#7-2-åˆ†å¸ƒå¼åè°ƒæœåŠ¡" class="headerlink" title="7.2 åˆ†å¸ƒå¼åè°ƒæœåŠ¡"></a>7.2 åˆ†å¸ƒå¼åè°ƒæœåŠ¡</h4><p>Zookeeper</p><p><a href="https://zhuanlan.zhihu.com/p/62526102">ä»€ä¹ˆæ˜¯ZooKeeperï¼Ÿ - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://zhuanlan.zhihu.com/p/64702090">zookeeperåŸç†è¯¦è§£ - çŸ¥ä¹ (zhihu.com)</a></p><p>[Zookeeperçº¸ä¸Šè°ˆå…µâ€”â€”Zookeeperä¸CAPåŸåˆ™-CSDNåšå®¢](<a href="https://blog.csdn.net/qq_38194699/article/details/109016025?ops_request_misc=%7B%22request_id%22:%22171939403416800178545807%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=171939403416800178545807&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-109016025-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=Zookeeper%E7%BA%B8%E4%B8%8A%E8%B0%88%E5%85%B5%E2%80%94%E2%80%94Zookeeper%E4%B8%8ECAP%E5%8E%9F%E5%88%99_cap">https://blog.csdn.net/qq_38194699/article/details/109016025?ops_request_misc=%7B%22request%5Fid%22%3A%22171939403416800178545807%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D&amp;request_id=171939403416800178545807&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-109016025-null-null.142^v100^pc_search_result_base8&amp;utm_term=Zookeeperçº¸ä¸Šè°ˆå…µâ€”â€”Zookeeperä¸CAPåŸåˆ™_cap</a> zookeeper_Amazing Coderçš„åšå®¢-CSDNåšå®¢]&amp;spm&#x3D;1018.2226.3001.4187)</p>]]></content>
      
      
      <categories>
          
          <category> åˆ†å¸ƒå¼ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ†å¸ƒå¼ç³»ç»Ÿ </tag>
            
            <tag> æ·±å…¥ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ·±å…¥ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿï¼ˆäº”ï¼‰åˆ†å¸ƒå¼äº‹åŠ¡</title>
      <link href="/2024/06/26/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%EF%BC%88%E4%BA%94%EF%BC%89%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/"/>
      <url>/2024/06/26/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%EF%BC%88%E4%BA%94%EF%BC%89%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆ†å¸ƒå¼äº‹åŠ¡"><a href="#åˆ†å¸ƒå¼äº‹åŠ¡" class="headerlink" title="åˆ†å¸ƒå¼äº‹åŠ¡"></a>åˆ†å¸ƒå¼äº‹åŠ¡</h1><h2 id="5-1-ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼äº‹åŠ¡"><a href="#5-1-ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼äº‹åŠ¡" class="headerlink" title="5.1 ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼äº‹åŠ¡"></a>5.1 ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼äº‹åŠ¡</h2><p><strong>ACID:</strong></p><ul><li>åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡è¢«è§†ä¸ºä¸€ä¸ªä¸å¯åˆ†å‰²çš„æœ€å°å·¥ä½œå•ä½ï¼Œäº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå…¨éƒ¨æ’¤é”€å›æ»šï¼Œä¸å…è®¸å‡ºç°éƒ¨åˆ†å®Œæˆçš„æƒ…å†µã€‚</li><li>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šäº‹åŠ¡å¼€å§‹å‰å’Œç»“æŸåï¼Œæ•°æ®åº“å¿…é¡»å¤„äºä¸€è‡´çš„çŠ¶æ€ï¼Œå³äº‹åŠ¡æ‰§è¡Œåæ‰€å¾—çš„ç»“æœå¿…é¡»ç¬¦åˆé¢„æœŸçš„è§„å®šçš„ç»“æ„å’Œçº¦æŸæ¡ä»¶ã€‚</li><li>éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼šå¤šä¸ªäº‹åŠ¡ç›¸äº’éš”ç¦»ä¸å—å¹²æ‰°ï¼Œæ¯ä¸ªäº‹åŠ¡åªèƒ½â€œçœ‹åˆ°â€å…¶æ‰€æ‰§è¡Œçš„æ•°æ®å’Œå…¶ä»–äº‹åŠ¡å·²æäº¤çš„æ•°æ®ï¼Œè€Œçœ‹ä¸åˆ°å…¶ä»–äº‹åŠ¡æœªæäº¤çš„æ•°æ®ã€‚</li><li>æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼šä¸€ä¸ªäº‹åŠ¡æäº¤åï¼Œå®ƒå¯¹æ•°æ®åº“çš„æ”¹å˜å¿…é¡»è¢«æ°¸ä¹…ä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼Œå³ä½¿å‡ºç°æ–­ç”µç­‰æ•…éšœï¼Œå…¶å¯¹æ•°æ®åº“çš„æ”¹å˜ä¹Ÿä¸èƒ½ä¸¢å¤±ã€‚</li></ul><p>åˆ†å¸ƒå¼äº‹åŠ¡ä¸¤ç§å˜ä½“ï¼š</p><ul><li>åŒä¸€ä»½æ•°æ®éœ€è¦åœ¨å¤šä¸ªå‰¯æœ¬ä¸Šæ›´æ–°ï¼Œä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡éœ€è¦æ›´æ–°æ‰€æœ‰çš„å‰¯æœ¬ï¼Œå¦‚æœæœ‰çš„èŠ‚ç‚¹æäº¤äº†äº‹åŠ¡ï¼Œæœ‰çš„èŠ‚ç‚¹å›æ»šäº†äº‹åŠ¡ï¼Œé‚£ä¹ˆè¿™æ ·çš„ç»“æœå¯¹äºç”¨æˆ·æ¥è¯´æ˜¯æ— æ³•æ¥å—çš„ã€‚ï¼ˆå¯åˆ©ç”¨å•ä¸»å¤åˆ¶è§£å†³ï¼‰</li><li>æ•°æ®è¿›è¡Œäº†åˆ†åŒºï¼Œäº‹åŠ¡è·¨è¶Šå¤šä¸ªèŠ‚ç‚¹ï¼Œè¿˜è¦åŒæ—¶ä¿è¯æ•´ä½“æ•°æ®ä¸€è‡´å’Œäº‹åŠ¡çš„ACIDå±æ€§ã€‚ï¼ˆå¸¸è§ä¸”é‡ç‚¹ï¼‰</li></ul><p>åˆ†å¸ƒå¼äº‹åŠ¡é€šå¸¸ä¸è®¨è®ºACIDä¸­çš„ä¸€è‡´æ€§ã€‚</p><p>æƒ³è¦å®ç°æŒä¹…æ€§ï¼Œåªéœ€åœ¨å‘å®¢æˆ·ç«¯è¿”å›å“åº”ä¹‹å‰ï¼Œç¡®ä¿å°†æ•°æ®å­˜å‚¨å†éæ˜“å¤±æ€§å­˜å‚¨è®¾å¤‡å³å¯ï¼Œé€šå¸¸è¿˜ä¼šåŒ…æ‹¬ä¸€äº›WALæˆ–å…¶ä»–æ—¥å¿—æ–‡ä»¶ï¼Œè™½ç„¶éæ˜“å¤±æ€§å­˜å‚¨è®¾å¤‡å¯èƒ½ä¼šæŸåï¼Œä½†ä¸è€ƒè™‘æç«¯çš„æƒ…å†µï¼Œé€šè¿‡å¤‡ä»½å°±å¯ä»¥è§£å†³è¯¥é—®é¢˜ã€‚ã€</p><p>åŸå­æ€§ï¼šåŸå­æäº¤ï¼ˆAtomic Commitï¼‰</p><p>éš”ç¦»æ€§ï¼šå¹¶å‘æ§åˆ¶ï¼ˆConcurrency Controlï¼‰(é”å’ŒMVCC)</p><h2 id="5-2-åŸå­æäº¤"><a href="#5-2-åŸå­æäº¤" class="headerlink" title="5.2 åŸå­æäº¤"></a>5.2 åŸå­æäº¤</h2><p>åŸå­æ€§çš„ä¿è¯åœ¨åˆ†å¸ƒå¼å’Œå•æœºç³»ç»Ÿä¸­éƒ½å¾ˆéš¾ã€‚</p><p>æ–¹æ³•ï¼šæ—¥å¿—&#x2F;WALï¼Œå¯ä»¥å›æ»šï¼Œæ’¤é”€</p><p>åˆ†å¸ƒå¼çš„åŸå­æ€§çš„å®ç°ï¼š</p><ul><li>åŸå­æäº¤åè®®ï¼ˆAtomic Commit Protocolï¼‰<ul><li>åå®šæ€§ï¼šæ‰€æœ‰çš„éƒ½åŒæ„ä¸€ä¸ªå€¼ï¼Œé‚£ä¹ˆæ‰€æœ‰è¿›ç¨‹è¦ä¹ˆä¸€èµ·æäº¤äº‹åŠ¡ï¼Œè¦ä¹ˆä¸€èµ·ç»ˆæ­¢äº‹åŠ¡</li><li>æœ‰æ•ˆæ€§ï¼šå¦‚æœæ‰€æœ‰è¿›ç¨‹éƒ½æ²¡é—®é¢˜ï¼Œå°±æäº¤ï¼Œä½†å‡¡æœ‰ä¸€ä¸ªæœ‰é—®é¢˜ï¼Œå°±ç»ˆæ­¢</li><li>ç»ˆæ­¢æ€§ï¼š<ul><li>å¼±ç»ˆæ­¢æ¡ä»¶ï¼šå¦‚æœæ²¡æœ‰ä»»ä½•æ•…éšœå‘ç”Ÿï¼Œé‚£ä¹ˆ<strong>æ‰€æœ‰è¿›ç¨‹</strong>æœ€ç»ˆéƒ½ä¼šä½œå‡ºå†³è®®</li><li>å¼ºç»ˆæ­¢æ¡ä»¶ï¼š<strong>æ²¡æœ‰å‘ç”Ÿæ•…éšœçš„è¿›ç¨‹</strong>æœ€ç»ˆä¼šåšå‡ºå†³è®®</li></ul></li></ul></li></ul><h3 id="5-2-1-ä¸¤é˜¶æ®µæäº¤åè®®"><a href="#5-2-1-ä¸¤é˜¶æ®µæäº¤åè®®" class="headerlink" title="5.2.1 ä¸¤é˜¶æ®µæäº¤åè®®"></a>5.2.1 ä¸¤é˜¶æ®µæäº¤åè®®</h3><p><img src="https://s2.loli.net/2024/06/26/ngkdOJCI5bAxcLz.png" alt="ä¸¤é˜¶æ®µæäº¤.png"></p><p><a href="https://blog.csdn.net/a1102325298/article/details/96481642">(443æ¡æ¶ˆæ¯) ä¸¤é˜¶æ®µæäº¤åè®®ï¼ˆtwo phase commit protocolï¼Œ2PCï¼‰è¯¦è§£_ä¸¤é˜¶æ®µåè®®_å»¶è¿Ÿæ»¡è¶³çš„åšå®¢-CSDNåšå®¢</a></p><p>ä¸¤é˜¶æ®µåè®®å­˜åœ¨çš„é—®é¢˜ï¼š</p><ul><li>åŒæ­¥é˜»å¡é—®é¢˜</li><li>å•ç‚¹æ•…éšœé—®é¢˜</li><li>æ•°æ®ä¸ä¸€è‡´é—®é¢˜</li><li>æäº¤é˜¶æ®µä¸ç¡®å®šé—®é¢˜</li></ul><p>åŸºäº 2PC å­˜åœ¨çš„é—®é¢˜ï¼Œåæ¥æœ‰äººæå‡ºäº†ä¸‰é˜¶æ®µæäº¤åè®®ï¼Œåœ¨å…¶ä¸­å¼•å…¥è¶…æ—¶çš„æœºåˆ¶ï¼Œå°†é˜¶æ®µ 1 åˆ†è§£ä¸ºä¸¤ä¸ªé˜¶æ®µï¼šåœ¨è¶…æ—¶å‘ç”Ÿä»¥å‰ï¼Œç³»ç»Ÿå¤„äºä¸ç¡®å®šé˜¶æ®µï¼›åœ¨è¶…æ—¶å‘ç”Ÿä»¥åï¼Œç³»ç»Ÿåˆ™è½¬å…¥ç¡®å®šé˜¶æ®µã€‚</p><p>è¿˜æœ‰è§£å†³æ–¹æ³•ï¼šParallel Commitsï¼Œç¬¬ä¸€é˜¶æ®µçš„ç»“æœå·²çŸ¥ï¼ˆå†™å…¥å…¨å±€æ—¥å¿—ä¸­ï¼‰ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå¼‚æ­¥æ‰§è¡Œç¬¬äºŒé˜¶æ®µï¼Œè¯¥æ–¹æ³•è¦è·Ÿå…±è¯†ç®—æ³•ä¸€èµ·å·¥ä½œã€‚</p><h3 id="5-2-2-ä¸‰é˜¶æ®µæäº¤"><a href="#5-2-2-ä¸‰é˜¶æ®µæäº¤" class="headerlink" title="5.2.2 ä¸‰é˜¶æ®µæäº¤"></a>5.2.2 ä¸‰é˜¶æ®µæäº¤</h3><p>éé˜»å¡åè®®ï¼Œå¯ä»¥åœ¨åè°ƒè€…å¯„äº†çš„æ—¶å€™é€‰å‡ºæ–°çš„åè°ƒè€…æ¨è¿›äº‹åŠ¡æ‰§è¡Œ</p><p><a href="https://blog.csdn.net/m0_37840000/article/details/119743288?ops_request_misc=%7B%22request_id%22:%22168174759216800225586584%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168174759216800225586584&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-119743288-null-null.142%5Ev84%5Epc_search_v2,239%5Ev2%5Einsert_chatgpt&utm_term=%E4%B8%89%E9%98%B6%E6%AE%B5%E6%8F%90%E4%BA%A4%E5%8D%8F%E8%AE%AE&spm=1018.2226.3001.4187">(443æ¡æ¶ˆæ¯) ä¸‰é˜¶æ®µæäº¤åè®®(3PC)_æ„¿å¥½çš„åšå®¢-CSDNåšå®¢</a></p><p>ç¼ºç‚¹ï¼šå¹¶æ²¡æœ‰è§£å†³æ‰€æœ‰çš„é—®é¢˜ã€‚</p><ul><li>å¯ç”¨æ€§ä»¥æ­£ç¡®æ€§ä¸ºä»£ä»·ï¼ŒåŒæ—¶å¾ˆå®¹æ˜“æ”¶åˆ°ç½‘ç»œåˆ†åŒºçš„å½±å“ï¼ˆå¯¼è‡´è„‘è£‚é€‰å‡ºå¤šä¸ªåè°ƒè€…ï¼‰</li><li>è‡³å°‘ä¸‰è½®å¾€è¿”æ¶ˆæ¯ï¼Œå¢åŠ äº†äº‹åŠ¡çš„å®Œæˆæ—¶é—´</li></ul><p>æ»¡è¶³å¼ºç»ˆæ­¢æ€§</p><p>äºŒé˜¶æ®µæäº¤ä¾ç„¶æ˜¯</p><h3 id="5-2-3-Paxosæäº¤ç®—æ³•"><a href="#5-2-3-Paxosæäº¤ç®—æ³•" class="headerlink" title="5.2.3 Paxosæäº¤ç®—æ³•"></a>5.2.3 Paxosæäº¤ç®—æ³•</h3><p><img src="https://s2.loli.net/2024/06/26/zKvrtxhjepDL52d.jpg" alt="B8468E68C68D719758DFA7091B1C834D.jpg"></p><h3 id="5-2-4-åŸºäºQuorumçš„æäº¤åè®®"><a href="#5-2-4-åŸºäºQuorumçš„æäº¤åè®®" class="headerlink" title="5.2.4 åŸºäºQuorumçš„æäº¤åè®®"></a>5.2.4 åŸºäºQuorumçš„æäº¤åè®®</h3><p>æ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸€ç¥¨ï¼Œæ€»å…±Vç¥¨ï¼š</p><ul><li>Vcï¼šæœ€å°æäº¤ç¥¨æ•°ï¼Œè¦æäº¤å¿…é¡»è¾¾åˆ°è¿™ä¸ªç¥¨æ•°ï¼Œ0&lt;Vc&lt;&#x3D;V</li><li>Vaï¼šæœ€å°ä¸­æ­¢ç¥¨æ•°ï¼Œè¦ä¸­æ­¢å¿…é¡»è¾¾åˆ°è¿™ä¸ªç¥¨æ•°ï¼Œ0&lt;Va&lt;&#x3D;V</li></ul><p>Vc+Va&gt;V</p><p>ä¸‰ä¸ªå­åè®®ï¼š</p><ul><li>æäº¤åè®®ï¼šäº‹åŠ¡å¼€å§‹æ—¶ä½¿ç”¨ï¼ˆç±»ä¼¼ä¸‰é˜¶æ®µä¸­çš„pre commitï¼Œä½†æ˜¯éœ€è¦ç­‰å¾…Vcç¥¨æ•°ï¼‰</li><li>ä¸­æ­¢åè®®ï¼šç½‘ç»œåˆ†åŒºæ—¶å¼€å§‹ä½¿ç”¨ï¼ˆå‡ºç°ç½‘ç»œåˆ†åŒºï¼Œä¼šåœ¨ä¸åè°ƒè€…å¤±è”çš„åˆ†åŒºä¸­é€‰å‡ºä»£ç†åè°ƒè€…ï¼Œå¦‚æœåœ¨å¤±è”åˆ†åŒºä¸­æœ‰åœ¨æäº¤&#x2F;ä¸­æ­¢çŠ¶æ€ï¼ˆå“ªæ€•ä¸€ä¸ªï¼‰ï¼Œéƒ½æ¨è¿›æ‰€æœ‰å‚ä¸è€…åˆ°è¯¥çŠ¶æ€ï¼›å¦‚æœè‡³å°‘æœ‰ä¸€ä¸ªå‚ä¸è€…å¤„äºé¢„æäº¤çŠ¶æ€ï¼Œå¹¶ä¸”è‡³å°‘Vcä¸ªå‚ä¸è€…åœ¨ç­‰å¾…æäº¤æŠ•ç¥¨çš„ç»“æœï¼Œåˆ™ä»£ç†åè°ƒè€…å‘æ‰€æœ‰å‚ä¸è€…å‘é€é¢„æäº¤æ¶ˆæ¯ï¼Œå¦‚æœæœ‰è¶…è¿‡Vcä¸ªå‚ä¸è€…æ¢å¤å“åº”ï¼Œé‚£ä¹ˆä»£ç†åè°ƒè€…å°±ä¼šå‘é€çœŸæ­£çš„æäº¤æ¶ˆæ¯;å¦‚æœæ²¡æœ‰å¤„äºå‡†å¤‡æäº¤çŠ¶æ€çš„å‚ä¸è€…ï¼Œå¹¶ä¸”è‡³å°‘Vaä¸ªå‚ä¸è€…åœ¨ç­‰å¾…ä¸­æ­¢äº‹åŠ¡çš„æŠ•ç¥¨ç»“æœï¼Œé‚£ä¹ˆä»£ç†åè°ƒè€…å°±ä¼šå‘é€çœŸæ­£çš„ä¸­æ­¢æ¶ˆæ¯ï¼‰</li><li>åˆå¹¶åè®®ï¼šå½“ç³»ç»Ÿä»ç½‘ç»œåˆ†åŒºä¸­æ¢å¤è¿‡æ¥çš„æ—¶å€™ä½¿ç”¨</li></ul><h3 id="5-2-5-Sagaäº‹åŠ¡"><a href="#5-2-5-Sagaäº‹åŠ¡" class="headerlink" title="5.2.5 Sagaäº‹åŠ¡"></a>5.2.5 Sagaäº‹åŠ¡</h3><p>ç”¨æ¥å¤„ç†é•¿æ´»äº‹åŠ¡ï¼ˆLong-Lived Transactionï¼ŒLLTï¼‰</p><p><a href="https://blog.csdn.net/flynetcn/article/details/124592621?ops_request_misc=%7B%22request_id%22:%22168183647416800211561980%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168183647416800211561980&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-124592621-null-null.142%5Ev84%5Epc_search_v2,239%5Ev2%5Einsert_chatgpt&utm_term=saga%E4%BA%8B%E5%8A%A1&spm=1018.2226.3001.4187">(443æ¡æ¶ˆæ¯) åˆ†å¸ƒå¼äº‹åŠ¡ç³»åˆ—ï¼šSaga_sagaäº‹åŠ¡_ç å‡ºé’èƒ½åŠ›çš„åšå®¢-CSDNåšå®¢</a></p><h2 id="5-3-å¹¶å‘æ§åˆ¶"><a href="#5-3-å¹¶å‘æ§åˆ¶" class="headerlink" title="5.3 å¹¶å‘æ§åˆ¶"></a>5.3 å¹¶å‘æ§åˆ¶</h2><p>æ‚²è§‚å¹¶å‘æ§åˆ¶ï¼ˆPessimistic Concurrency Controlï¼‰ï¼šå‡è®¾å¤šä¸ªäº‹åŠ¡ä¹‹é—´ä¼šç›¸äº’å¹²æ‰°ï¼Œå› æ­¤åœ¨ä»»ä½•æ—¶å€™éƒ½å°†èµ„æºåŠ é”ï¼Œé¿å…å…¶ä»–äº‹åŠ¡ä¿®æ”¹è¯¥èµ„æºã€‚æ‚²è§‚å¹¶å‘æ§åˆ¶çš„ä¸»è¦ä¼˜ç‚¹æ˜¯ç®€å•æ˜“æ‡‚ï¼Œä½†ç”±äºé¢‘ç¹åŠ é”å¯¼è‡´æ•ˆç‡ä½ä¸‹ï¼Œä¸é€‚åˆé«˜å¹¶å‘åœºæ™¯ã€‚</p><p>ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆOptimistic Concurrency Controlï¼‰ï¼šå‡è®¾å¤šä¸ªäº‹åŠ¡ä¹‹é—´ä¸ä¼šç›¸äº’å¹²æ‰°ï¼Œå¹¶è¡Œè®¿é—®æ•°æ®ï¼Œè€Œåœ¨æäº¤æ—¶è¿›è¡Œå†²çªæ£€æµ‹ã€‚å¦‚æœä¸¤ä¸ªäº‹åŠ¡çš„ä¿®æ”¹å‘ç”Ÿå†²çªï¼Œåˆ™å…¶ä¸­ä¸€ä¸ªäº‹åŠ¡å¿…é¡»å›æ»šå¹¶é‡è¯•ã€‚ä¹è§‚å¹¶å‘æ§åˆ¶å¯ä»¥æœ€å¤§ç¨‹åº¦åœ°æé«˜å¹¶å‘æ€§ï¼Œä½†éœ€è¦å¼€å‘äººå‘˜è‡ªå·±å®ç°æ•°æ®ç‰ˆæœ¬æ§åˆ¶ï¼Œç›¸å¯¹è¾ƒä¸ºå¤æ‚ã€‚</p><p>å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆMulti-Version Concurrency Controlï¼‰ï¼šæ¯å½“ä¸€ä¸ªäº‹åŠ¡å¯¹æ•°æ®åº“è¿›è¡Œæ›´æ–°æ“ä½œæ—¶ï¼Œä¼šå°†å½“å‰æ•°æ®çš„å¿«ç…§å­˜å‚¨ä¸ºæ–°çš„ç‰ˆæœ¬ï¼Œå¹¶ä½¿ç”¨ç‰ˆæœ¬å·è¿›è¡Œæ ‡è¯†ã€‚åœ¨è¯»å–æ•°æ®æ—¶ï¼Œäº‹åŠ¡ä¸ä¼šé˜»å¡å…¶ä»–äº‹åŠ¡çš„è¯»å†™æ“ä½œï¼ŒåŒæ—¶ä¹Ÿä¸ä¼šé”å®šå½“å‰ç‰ˆæœ¬çš„æ•°æ®ã€‚å¦‚æœå‘ç°å…¶ä»–äº‹åŠ¡å·²ç»æ›´æ–°äº†æ•°æ®ï¼Œåˆ™ä¼šä»å‰ä¸€ä¸ªç‰ˆæœ¬ä¸­è·å–æ•°æ®ã€‚å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶çš„ä¸»è¦ä¼˜ç‚¹æ˜¯é«˜æ•ˆã€å¯æ‰©å±•æ€§å¥½ï¼Œä½†éœ€è¦å ç”¨æ›´å¤šçš„ç£ç›˜ç©ºé—´ã€‚</p><h3 id="5-3-1-ä¸¤é˜¶æ®µé”"><a href="#5-3-1-ä¸¤é˜¶æ®µé”" class="headerlink" title="5.3.1 ä¸¤é˜¶æ®µé”"></a>5.3.1 ä¸¤é˜¶æ®µé”</h3><p>ä¸¤é˜¶æ®µé”ï¼ˆTwo-Phase Lockingï¼‰æ˜¯ä¸€ç§å¸¸ç”¨äºå¹¶å‘æ§åˆ¶çš„æŠ€æœ¯ï¼Œæ—¨åœ¨è§£å†³å¹¶å‘æ“ä½œä¸‹å‡ºç°çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚</p><p>åœ¨ä¸¤é˜¶æ®µé”ç­–ç•¥ä¸­ï¼Œäº‹åŠ¡å¿…é¡»åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼šå¢é•¿é˜¶æ®µå’Œæ”¶ç¼©é˜¶æ®µã€‚</p><ol><li><p>å¢é•¿é˜¶æ®µï¼šå½“äº‹åŠ¡è¯·æ±‚èµ„æºæ—¶ï¼Œè¯¥äº‹åŠ¡ä¼šå…ˆç”³è¯·é”å®šæ‰€éœ€èµ„æºã€‚åœ¨æ­¤é˜¶æ®µä¸­ï¼Œé”å¯ä»¥è¢«å ç”¨ä½†ä¸èƒ½è¢«é‡Šæ”¾ï¼Œæ¯ä¸ªäº‹åŠ¡åªèƒ½é€æ¸è·å¾—é”ï¼Œä¸èƒ½é‡Šæ”¾é”ã€‚</p></li><li><p>æ”¶ç¼©é˜¶æ®µï¼šå½“äº‹åŠ¡å®Œæˆæ‰€éœ€å·¥ä½œæ—¶ï¼Œå®ƒå°†é‡Šæ”¾æ‰€æœ‰å·²ç»é”å®šçš„èµ„æºï¼Œå¹¶ä¸”è¿™äº›é”ä¸å†è¢«ä½¿ç”¨ã€‚åœ¨æ­¤é˜¶æ®µä¸­ï¼Œé”å¯ä»¥è¢«é‡Šæ”¾ä½†ä¸èƒ½è¢«ç»§ç»­å ç”¨ï¼Œæ¯ä¸ªäº‹åŠ¡åªèƒ½é€æ¸é‡Šæ”¾é”ã€‚</p></li></ol><p>åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œé”çš„çŠ¶æ€ä¿æŒä¸å˜ã€‚æ‰€æœ‰çš„äº‹åŠ¡éƒ½å¿…é¡»éµå¾ªè¿™äº›è§„åˆ™ï¼Œä»¥ç¡®ä¿å¹¶å‘æ“ä½œçš„æ­£ç¡®æ€§å’Œä¸€è‡´æ€§ã€‚</p><p>ä¸¤é˜¶æ®µé”çš„ä¼˜ç‚¹æ˜¯å¯ä»¥é¿å…æ­»é”çš„å‘ç”Ÿï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ï¼Œä¾‹å¦‚å¯èƒ½ä¼šå¯¼è‡´äº‹åŠ¡ç­‰å¾…æ—¶é—´è¾ƒé•¿ï¼Œä»è€Œå½±å“ç³»ç»Ÿçš„å“åº”é€Ÿåº¦ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰è®¸å¤šå…¶ä»–çš„å¹¶å‘æ§åˆ¶æŠ€æœ¯ï¼Œå¦‚ä¹è§‚å¹¶å‘æ§åˆ¶ã€åŸºäºæ—¶é—´æˆ³çš„å¹¶å‘æ§åˆ¶ç­‰ï¼Œå¯ä»¥ç”¨äºæ›¿ä»£æˆ–è¡¥å……ä¸¤é˜¶æ®µé”ã€‚</p><p><strong>ä¸‰ç§æ–¹æ³•é¿å…æ­»é”ï¼š</strong></p><p>æ­»é”æ˜¯ä¸€ç§å¹¶å‘æ§åˆ¶é—®é¢˜ï¼ŒæŒ‡ä¸¤ä¸ªæˆ–å¤šä¸ªäº‹åŠ¡æˆ–è¿›ç¨‹ç›¸äº’ç­‰å¾…é‡Šæ”¾å·²ç»å ç”¨çš„èµ„æºï¼Œå¯¼è‡´æ‰€æœ‰äº‹åŠ¡æˆ–è¿›ç¨‹éƒ½æ— æ³•ç»§ç»­æ‰§è¡Œã€‚ä¸ºäº†é¿å…æ­»é”ï¼Œå¯ä»¥é‡‡å–ä»¥ä¸‹å‡ ç§æ–¹æ³•ï¼š</p><ol><li>æ­»é”é¢„é˜²ï¼ˆç ´åæ­»é”æ¡ä»¶ï¼‰ï¼šé€šè¿‡çº¦å®šåŠ é”é¡ºåºã€å¼•å…¥è¶…æ—¶æœºåˆ¶ã€é™åˆ¶æŸäº›è¿›ç¨‹å¯¹èµ„æºçš„è®¿é—®ç­‰æ–¹å¼ï¼Œåœ¨ç¨‹åºè®¾è®¡æ—¶ç›´æ¥é¿å…æ­»é”å‘ç”Ÿã€‚</li><li>æ­»é”é¿å…ï¼ˆé“¶è¡Œå®¶ç®—æ³•ï¼‰ï¼šé€šè¿‡å®‰å…¨åºåˆ—ç®—æ³•å¯¹æ¯ä¸ªäº‹åŠ¡æˆ–è¿›ç¨‹çš„èµ„æºè¯·æ±‚è¿›è¡Œå®‰å…¨æ€§æ£€æŸ¥ï¼Œåªæœ‰å½“è¯¥äº‹åŠ¡æˆ–è¿›ç¨‹çš„èµ„æºè¯·æ±‚ä¸ä¼šå¯¼è‡´æ­»é”æ—¶æ‰ä¼šè¢«å…è®¸ã€‚<ul><li>ç­‰å¾…-æ­»äº¡ï¼šè¯¥æ–¹æ¡ˆæ˜¯åŸºäºéå‰¥å¤ºæ–¹æ³•ã€‚å½“è¿›ç¨‹Piè¯·æ±‚çš„èµ„æºæ­£è¢«è¿›ç¨‹Pjå æœ‰æ—¶ï¼Œåªæœ‰å½“Piçš„æ—¶é—´æˆ³æ¯”è¿›ç¨‹Pjçš„æ—¶é—´æˆ³å°æ—¶ï¼ŒPiæ‰èƒ½ç­‰å¾…ã€‚å¦åˆ™Piè¢«å·å›ï¼ˆroll-backï¼‰ï¼Œå³æ­»äº¡ã€‚</li><li>ä¼¤å®³-ç­‰å¾…ï¼šå®ƒæ˜¯ä¸€ç§åŸºäºå‰¥å¤ºçš„æ–¹æ³•ã€‚å½“è¿›ç¨‹Piè¯·æ±‚çš„èµ„æºæ­£è¢«è¿›ç¨‹Pjå æœ‰æ—¶ï¼Œåªæœ‰å½“è¿›ç¨‹Piçš„æ—¶é—´æˆ³æ¯”è¿›ç¨‹Pjçš„æ—¶é—´æˆ³å¤§æ—¶ï¼ŒPiæ‰èƒ½ç­‰å¾…ã€‚å¦åˆ™Pjè¢«å·å›ï¼ˆroll-backï¼‰ï¼Œå³æ­»äº¡ã€‚</li></ul></li><li>æ­»é”æ£€æµ‹ä¸æ¢å¤ï¼šåœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå‘¨æœŸæ€§åœ°ç›‘æµ‹ç³»ç»Ÿä¸­æ˜¯å¦å‘ç”Ÿäº†æ­»é”ï¼Œä¸€æ—¦æ£€æµ‹åˆ°æ­»é”ï¼Œå°±é‡‡å–èµ„æºæŠ¢å¤ºæˆ–äº‹åŠ¡å›æ»šç­‰æ–¹å¼ï¼Œè¿›è¡Œæ­»é”æ¢å¤ã€‚</li></ol><p>ä»¥ä¸Šä¸‰ç§æ–¹æ³•å¯ä»¥å•ç‹¬æˆ–ç»„åˆä½¿ç”¨ï¼Œä»¥è¾¾åˆ°æ›´å¥½çš„æ­»é”é¢„é˜²æ•ˆæœã€‚åŒæ—¶ï¼Œåœ¨ç¨‹åºè®¾è®¡æ—¶ï¼Œåº”æ³¨æ„ä¸è¦é€šè¿‡ä¸åˆç†çš„ä»£ç é€»è¾‘ã€æ•°æ®åº“è®¾è®¡ç­‰å¯¼è‡´æ­»é”ç°è±¡çš„å‡ºç°ã€‚</p><h3 id="5-3-2-ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆä¸è¦é”ï¼‰"><a href="#5-3-2-ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆä¸è¦é”ï¼‰" class="headerlink" title="5.3.2 ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆä¸è¦é”ï¼‰"></a>5.3.2 ä¹è§‚å¹¶å‘æ§åˆ¶ï¼ˆä¸è¦é”ï¼‰</h3><p>ä¸¤ç±»ï¼ŒåŸºäºæ£€æŸ¥çš„å¹¶å‘æ§åˆ¶å’ŒåŸºäºæ—¶é—´æˆ³çš„å¹¶å‘æ§åˆ¶ã€‚</p><ol><li><p>åŸºäºæ£€æŸ¥çš„å¹¶å‘æ§åˆ¶</p><ul><li>è¯»å–ï¼šåˆ›å»ºå‰¯æœ¬ï¼Œæ”¾åˆ°ç§æœ‰ç©ºé—´ï¼Œè¯»æ˜¯è¯»çš„å‰¯æœ¬ï¼Œå†™æ“ä½œè¢«è®°å½•åˆ°ç§æœ‰ç©ºé—´çš„ä¸´æ—¶æ–‡ä»¶ä¸­ã€‚</li><li>æ ¡éªŒï¼šæ²¡æœ‰å†²çªå°±æäº¤ï¼Œæœ‰å†²çªå°±ä¸­æ­¢ã€‚</li><li>å†™å…¥ï¼šæ ¡éªŒæ²¡é—®é¢˜ï¼Œå°±æŠŠç§æœ‰ç©ºé—´çš„æ•°æ®æŒä¹…åŒ–å­˜å‚¨ã€‚</li></ul></li><li><p>åŸºäºæ—¶é—´æˆ³çš„å¹¶å‘æ§åˆ¶</p><p>æ¯ä¸ªæ•°æ®é¡¹æœ‰ä¸¤ä¸ªæ—¶é—´æˆ³</p><ul><li><p>å†™æ—¶é—´æˆ³ï¼š W-TS(X)</p></li><li><p>è¯»æ—¶é—´æˆ³ï¼šR-TS(X)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#1.è¯»æ“ä½œ</span><br><span class="line">if TS(T_i) &lt; W-TS(X)&#123;</span><br><span class="line">abort(R_i(X))</span><br><span class="line">&#125;else&#123;</span><br><span class="line">accept(R_i(X))</span><br><span class="line">R-TS(X)=TS(T_i)</span><br><span class="line">&#125;</span><br><span class="line">#2.å†™æ“ä½œ</span><br><span class="line">TS(T_i)å¿…é¡»å¤§äºR-TS(X)å’ŒW-TS(X)ï¼Œå¦åˆ™ä¸¢å¼ƒ</span><br><span class="line">if TS(T_i)&lt;R-TS(X)||TS(T_i)&lt;W-TS(X)&#123;</span><br><span class="line">abort(W_i(X))</span><br><span class="line">&#125;else &#123;</span><br><span class="line">accept(W_i(X))</span><br><span class="line">W-TS(X)=TS(T_i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éš¾ç‚¹ï¼š</p><ol><li>æ—¶é—´æˆ³çš„ç²¾ç¡®æ€§</li><li>å¯èƒ½äº§ç”Ÿä¸å¯æ¢å¤çš„æ“ä½œï¼ˆåé¢çš„è¯»äº‹åŠ¡åŸºäºå‰é¢çš„å†™äº‹åŠ¡ï¼Œä½†å‰é¢çš„å†™äº‹åŠ¡å›æ»šï¼‰</li></ol><p>çœ‹èµ·æ¥æ²¡æœ‰é”ï¼Œä½†æ˜¯å®é™…ä¸Šåœ¨ä¿®æ”¹æ—¶é—´æˆ³çš„æ—¶å€™ï¼Œä»å¯èƒ½è¦è·å–é”</p></li></ul></li></ol><h3 id="5-3-3-å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆå¾ˆåƒcelldbå•Šï¼‰"><a href="#5-3-3-å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆå¾ˆåƒcelldbå•Šï¼‰" class="headerlink" title="5.3.3 å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆå¾ˆåƒcelldbå•Šï¼‰"></a>5.3.3 å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼ˆå¾ˆåƒcelldbå•Šï¼‰</h3><p>å¯ä»¥çœ‹ä½œåœ¨ä¹è§‚å¹¶å‘æ§åˆ¶çš„åŸºç¡€ä¸Šå¢åŠ äº†å¤šä¸ªç‰ˆæœ¬ï¼Œä¸ºæ¯ä¸ªæ•°æ®é¡¹å­˜å‚¨å¤šä¸ªç‰ˆæœ¬</p><p>è¯»åˆ°çš„æ˜¯æŸä¸ªç‰ˆæœ¬çš„æ•°æ®ï¼Œå†™æ˜¯å¢åŠ ç‰ˆæœ¬è€Œå¹¶éè¦†ç›–</p><p>è¡ç”Ÿå‡ºä¸‰ç§ä¸»æµå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼š</p><ul><li>å¤šç‰ˆæœ¬ä¸¤é˜¶æ®µé”</li><li>å¤šç‰ˆæœ¬ä¹è§‚å¹¶å‘æ§åˆ¶</li><li>å¤šç‰ˆæœ¬æ—¶é—´æˆ³æ’åº</li></ul><p>å…ƒæ•°æ®ï¼ˆTupleå­˜å‚¨åˆ°æ•°æ®é¡¹å¤´éƒ¨ï¼‰ï¼š</p><ul><li><p>Tidï¼šå”¯ä¸€å•è°ƒé€’å¢çš„æ—¶é—´æˆ³ï¼ˆäº‹åŠ¡å¼€å§‹çš„æ—¶é—´æˆ³ï¼‰</p></li><li><p>txn-idï¼šè·å¾—å½“å‰å†™é”çš„äº‹åŠ¡çš„Tidï¼Œå¦‚æœæ²¡æœ‰äº‹åŠ¡æŒæœ‰è¯¥æ•°æ®çš„å†™é”ï¼Œåˆ™ä¸º0ï¼Œå¯é€šè¿‡<strong>CAS</strong>æ¥ä¿®æ”¹æ­¤å­—æ®µï¼Œé¿å…ä½¿ç”¨é”</p><ul><li><p>CASï¼Œå³ Compare-And-Swapï¼Œæ˜¯ä¸€ç§åŸå­æ“ä½œï¼Œç”¨äºå®ç°å¹¶å‘æ§åˆ¶ã€‚åœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ï¼ŒCASå¯ä»¥ä¿è¯å¯¹å…±äº«å˜é‡çš„æ“ä½œåœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹èƒ½å¤Ÿæ­£ç¡®åœ°æ‰§è¡Œã€‚</p><p>CASæ“ä½œéœ€è¦ä¸‰ä¸ªå‚æ•°ï¼šå†…å­˜åœ°å€ Vã€æ—§çš„é¢„æœŸå€¼ A å’Œæ–°å€¼ Bã€‚å½“ä¸”ä»…å½“å½“å‰å†…å­˜åœ°å€çš„å€¼ç­‰äºæ—§çš„é¢„æœŸå€¼ A æ—¶ï¼Œæ‰ä¼šå°†è¯¥å†…å­˜åœ°å€çš„å€¼æ›´æ–°ä¸ºæ–°å€¼ Bã€‚å¦åˆ™ï¼Œä¸åšä»»ä½•æ“ä½œã€‚</p><p>CASæ“ä½œçš„åŸºæœ¬æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li>çº¿ç¨‹è¯»å–å†…å­˜åœ°å€ V çš„å½“å‰å€¼ï¼›</li><li>çº¿ç¨‹æ¯”è¾ƒå†…å­˜åœ°å€ V çš„å½“å‰å€¼ä¸æ—§çš„é¢„æœŸå€¼ A æ˜¯å¦ç›¸ç­‰ï¼›</li><li>å¦‚æœç›¸ç­‰ï¼Œçº¿ç¨‹å°†æ–°å€¼ B å†™å…¥å†…å­˜åœ°å€ Vï¼Œå¹¶è¿”å›æ“ä½œæˆåŠŸï¼›</li><li>å¦‚æœä¸ç›¸ç­‰ï¼Œçº¿ç¨‹ä¸åšä»»ä½•æ“ä½œï¼Œå¹¶è¿”å›æ“ä½œå¤±è´¥ã€‚</li></ol><p>é€šè¿‡CASæ“ä½œï¼Œå¯ä»¥é¿å…ä¼ ç»Ÿå¹¶å‘æ§åˆ¶æ–¹æ³•ï¼ˆå¦‚é”å®šï¼‰çš„ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚æ­»é”å’Œç«äº‰æ¡ä»¶ã€‚ä½†åŒæ—¶ï¼Œä¹Ÿå­˜åœ¨ä¸€äº›é™åˆ¶ã€‚ä¾‹å¦‚ï¼ŒCASåªèƒ½åº”ç”¨äºå•ä¸ªå˜é‡çš„æ“ä½œï¼›å¦‚æœéœ€è¦å¯¹å¤šä¸ªå˜é‡è¿›è¡Œè”åˆæ“ä½œï¼Œåˆ™éœ€è¦ä½¿ç”¨å…¶ä»–å¹¶å‘æ§åˆ¶æ–¹å¼ã€‚</p></li></ul></li><li><p>begin-ts: åˆ›å»ºè¯¥ç‰ˆæœ¬çš„æ•°æ®é¡¹çš„äº‹åŠ¡æäº¤çš„æ—¶é—´æˆ³ï¼ˆå¼€å§‹è‚¯å®šæ˜¯æäº¤äº†æ‰æœ‰å˜›ï¼‰,Tcommit</p></li><li><p>end-tsï¼šæœ€æ–°ç‰ˆæœ¬çš„è¯ï¼Œåˆ™ä¸ºæ— é™å¤§ï¼Œå¦åˆ™è¯¥æ•°æ®é¡¹ç­‰äºä¸Šä¸€ä¸ªæˆ–ä¸‹ä¸€ä¸ªç‰ˆæœ¬æ•°æ®é¡¹çš„begin-ts</p></li></ul><ol><li><p>å¤šç‰ˆæœ¬ä¸¤é˜¶æ®µé”(è¿™é‡Œçš„é”ï¼Œæ˜¯æ ¹æ®å¯¹äºæ•°æ®çš„å…ƒæ•°æ®çš„ç‰ˆæœ¬æ¥è¿›è¡Œåˆ¤æ–­æ¥å®ç°çš„)ï¼š</p><p>ä»£è¡¨MySQL,Oracle,Postgres</p><ul><li><p>txn-id</p></li><li><p>read-cntï¼šå½“å‰æ•°æ®çš„è¯»é”çš„æ•°é‡ã€‚å¯ä»¥å°†read-cntå’Œtxn-idç»„åˆæˆä¸€ä¸ª64ä½æ•´å‹å€¼ï¼Œç”¨CASæ¥æ›´æ–°ä¸¤ä¸ª</p></li><li><p>begin-ts</p></li><li><p>end-ts</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#å¯¹äºè¯»æ“ä½œTi Xvä¸ºç‰ˆæœ¬</span><br><span class="line">find Xv where begin-ts(Xv) &lt;= Ti &lt;end-ts(Xv)</span><br><span class="line">if txn-id(Xv)==0 || txn-id(Xv)==Ti&#123;</span><br><span class="line">read-cnt(Xv)+=1</span><br><span class="line">accept(Read(Xv))</span><br><span class="line">&#125;else&#123;</span><br><span class="line">abort()and rollback(T)</span><br><span class="line">&#125;</span><br><span class="line">#å¯¹äºå†™æ“ä½œ æ‰¾åˆ°æœ€æ–°ç‰ˆæœ¬Xv</span><br><span class="line">finx Xv where end-ts(Xv) ==INF</span><br><span class="line">if txn-id(Xv)==0||txn-id(Xv)==Ti&#123;</span><br><span class="line">txn-id(Xv)=Ti</span><br><span class="line">new(Xv+1)</span><br><span class="line">txn-id(Xv+1)=Ti</span><br><span class="line">accept(Write(Xv+1))</span><br><span class="line">&#125;else&#123;</span><br><span class="line">abort() and rollback(T)</span><br><span class="line">&#125;</span><br><span class="line">#å–„å</span><br><span class="line">#for write</span><br><span class="line">for all write data item&#123;</span><br><span class="line">txn-id(Xv+1)=0</span><br><span class="line">begin-ts(Xv+1)=Tcommit</span><br><span class="line">end-ts(Xv+1)=INF</span><br><span class="line">txn-id(Xv)=0</span><br><span class="line">end-ts(Xv)=Tcommit</span><br><span class="line">&#125;</span><br><span class="line">#for read</span><br><span class="line">for all read data item&#123;</span><br><span class="line">read-cnt(Xv) -=1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>å¤šç‰ˆæœ¬ä¹è§‚å¹¶å‘æ§åˆ¶</p><p>MemSQLç”¨è¿™ä¸ª</p><p>Metadata:</p><ul><li>txn-id</li><li>begin-ts</li><li>end-ts</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#è¯»</span><br><span class="line">find Xv where begin-ts(Xv)&lt;= Ti &lt; end-ts(Xv)</span><br><span class="line">if txn-id(Xv)==0 || txn-id(Xv)==Ti&#123;</span><br><span class="line">accept(Read(Xv))</span><br><span class="line">&#125;else&#123;</span><br><span class="line">abort()and rollback(T)</span><br><span class="line">&#125;</span><br><span class="line">#å†™</span><br><span class="line">find Xv where end-ts(Xv) == INF //ç¡®ä¿æœ€æ–°</span><br><span class="line">if txn-id(Xv) == 0 ||txn-id(Xv)==Ti&#123;</span><br><span class="line">txn-id(Xv) = Ti</span><br><span class="line">new(Xv+1)</span><br><span class="line">txn-id(Xv+1) = Ti</span><br><span class="line">begin-ts(Xv+1) = INF</span><br><span class="line">accept(Write(Xv+1))</span><br><span class="line">&#125;else&#123;</span><br><span class="line">abort() and rollback(T)</span><br><span class="line">&#125;</span><br><span class="line">#æäº¤äº‹åŠ¡</span><br><span class="line">for all read data item&#123;</span><br><span class="line">if begin-ts(Xv) &gt;Ti&#123;</span><br><span class="line"> //æ•°æ®é¡¹è¢«å…¶ä»–äº‹åŠ¡ä¿®æ”¹è¿‡ï¼Œè¯»åˆ°äº†è¿‡æœŸçš„æ•°æ®</span><br><span class="line"> abort() and rollback(T)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">for all write data item&#123;</span><br><span class="line">txn-id(Xv+1) = 0</span><br><span class="line">begin-ts(Xv+1) = Tcommit</span><br><span class="line">end-ts(Xv+1) = INF</span><br><span class="line">txn-id(Xv) = 0</span><br><span class="line">end-ts(Xv) = Tcommit</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>å¤šç‰ˆæœ¬æ—¶é—´æˆ³æ’åº</p><ul><li><p>txn-id</p></li><li><p>read-ts(æœ€å¤§çš„è¯»è¿‡çš„äº‹åŠ¡çš„Tid)</p></li><li><p>begin-ts</p></li><li><p>end-ts</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#è¯»</span><br><span class="line">find Xv where begin-ts(Xv)&lt;=Ti&lt;end-ts(Xv)</span><br><span class="line">if txn-id(Xv) == 0 || txn-id(Xv) == Ti&#123;</span><br><span class="line">accept(read(Xv))</span><br><span class="line">read-ts(Xv)=max(Ti,read-ts(xV))</span><br><span class="line">&#125;else&#123;</span><br><span class="line"> abort() rollback(T)</span><br><span class="line">&#125;</span><br><span class="line">#å†™</span><br><span class="line">find Xv where end-ts(Xv) ==INF</span><br><span class="line">if txn-id(Xv)=0&amp;&amp;Ti &gt; read-ts(Xv)&#123;</span><br><span class="line">txn-id(Xv) = Ti</span><br><span class="line">new(Xv+1)</span><br><span class="line">txn-id(Xv+1) =Ti</span><br><span class="line">read-ts(Xv+1) = 0</span><br><span class="line">accept(Write(Xv+1))</span><br><span class="line">&#125;else &#123;</span><br><span class="line">abort() and rollback(T)</span><br><span class="line">&#125;</span><br><span class="line">#å–„å</span><br><span class="line">for all write data item&#123;</span><br><span class="line">txn-id(Xv+1) = 0</span><br><span class="line">begin-ts(Xv+1) = Ti</span><br><span class="line">end-ts(Xv+1) = INF</span><br><span class="line">txn-id(Xv) = 0</span><br><span class="line">end-ts(Xv) = Ti</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>ç‰ˆæœ¬å­˜å‚¨å’Œåƒåœ¾å›æ”¶</p><p>ç‰ˆæœ¬å­˜å‚¨ï¼š</p><ol><li>ä»…è¿½åŠ å­˜å‚¨ï¼ˆAppend-Only Storageï¼‰<ul><li>æœ‰æŒ‡é’ˆ</li><li>å¦‚æœè¯´æ°å¥½æœ‰å¾ˆå¤§æ•°æ®çš„ä¸€ä¸ªå±æ€§ï¼Œåœ¨æ–°ç‰ˆæœ¬ä¸­åˆä¸å‘ç”Ÿæ”¹å˜ï¼Œåˆ™å¾ˆå ç©ºé—´ï¼ˆæ‰€ä»¥è¦å¤ç”¨ï¼‰</li><li>MemSQLã€PG</li></ul></li><li>æ—¶é—´æ—…è¡Œå­˜å‚¨ï¼ˆTime-Travel Storageï¼‰<ul><li>å•ç‹¬ç”¨ä¸€ä¸ªæ—¶é—´æ—…è¡Œè¡¨æ¥å­˜å‚¨å†å²ç‰ˆæœ¬</li><li>æœ€æ–°ç‰ˆæœ¬çš„æ•°æ®å­˜å‚¨åˆ°ä¸»è¡¨</li></ul></li><li>å¢é‡å­˜å‚¨ï¼ˆDelta Storageï¼‰<ul><li>åªå°†å‘ç”Ÿå˜åŒ–çš„å­—æ®µä¿¡æ¯å­˜å‚¨åˆ°å¢é‡å­˜å‚¨ä¸­</li><li>å¢é‡å­˜å‚¨åœ¨MySQLå’ŒOracleä¸­è¢«ç§°ä¸ºå›æ»šæ®µ</li><li>å¯¹äºæ›´æ–°é¢‘ç¹çš„å·¥ä½œè´Ÿè½½ï¼Œå¯ä»¥å‡å°‘å†…å­˜åˆ†é…ï¼Œå¯¹äºè¯»æ“ä½œé¢‘ç¹çš„å·¥ä½œè´Ÿè½½ï¼Œéœ€è¦è®¿é—®å›æ»šæ®µæ‰èƒ½é‡æ–°æ‹¼å‡ºéœ€è¦çš„ä¿¡æ¯ï¼Œå¼€é”€ä¼šæ›´é«˜</li></ul></li></ol><p>åƒåœ¾å›æ”¶ï¼š</p><ol><li>å…ƒç»„çº§åˆ«ï¼ˆTuple-Level Garbage Collection) ï¼š<ul><li>åå°æ¸…ç†ï¼ˆBackground Vaccuuming, VACï¼‰:åå°çº¿ç¨‹å‘¨æœŸæ€§æ¸…ç†:star2:</li><li>ååŒæ¸…ç† (Cooperative Cleaning, COOP)ï¼šéå†æœ€è€åˆ°æœ€æ–°ï¼Œäº‹åŠ¡æ‰§è¡Œæ—¶æ¸…ç†</li></ul></li><li>äº‹åŠ¡çº§åˆ«åƒåœ¾å›æ”¶ï¼ˆTransaction-Level Garbage Collectionï¼‰:<ul><li>å¦‚æœä¸€ä¸ªäº‹åŠ¡åˆ›å»ºçš„ç‰ˆæœ¬ä¸è¢«ä»»ä½•æ´»è·ƒäº‹åŠ¡è®¿é—®ï¼Œæ„å‘³ç€è¯¥äº‹åŠ¡å·²ç»è¿‡æœŸã€‚</li><li>ç³»ç»Ÿä¼šæ ¹æ®è¯¥äº‹åŠ¡è¯»å†™çš„æ•°æ®é›†åˆï¼ˆRead&#x2F;Write Setsï¼‰æ¸…ç†ç›¸å¯¹åº”çš„ç‰ˆæœ¬</li></ul></li></ol></li></ol><h2 id="5-4-Percolator"><a href="#5-4-Percolator" class="headerlink" title="5.4 Percolator"></a>5.4 Percolator</h2><p>åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼šPercolator</p><p>æ„å»ºäºBigtableçš„åŸºç¡€ä¸Šï¼Œä¸»è¦ç”¨äºç½‘é¡µæœç´¢ç´¢å¼•ç­‰æœåŠ¡</p><p>æ”¯æŒå¤šè¡Œäº‹åŠ¡</p><p>ä¾èµ–ä¸€ä¸ªå•ç‚¹æˆæ—¶ï¼Œå•æ—¶é—´æºçš„æˆæ—¶æœåŠ¡ï¼ˆTSOï¼ŒTimestamp Oracleï¼‰</p><p>ä½¿ç”¨å¤šç‰ˆæœ¬æ—¶é—´æˆ³æ’åºæ¥å®ç°å¿«ç…§éš”ç¦»</p><p>åˆ©ç”¨å¦‚ä¸‹å…ƒæ•°æ®å®ç°å¿«ç…§éš”ç¦»ï¼š</p><ul><li>lock:é”ä¿¡æ¯</li><li>writeï¼šäº‹åŠ¡æäº¤æ—¶é—´æˆ³</li><li>dataï¼šæ•°æ®</li></ul><p>äº‹åŠ¡å¤„ç†æ­¥éª¤ï¼š</p><ol><li><p>åˆ†é…äº‹åŠ¡å¼€å§‹æ—¶é—´æˆ³:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start_ts=oracle.GetTimestamp()</span><br></pre></td></tr></table></figure></li><li><p>å°†æ‰€æœ‰å†™æ“ä½œç¼“å†²èµ·æ¥ï¼Œç›´åˆ°æäº¤æ—¶å†ä¸€å¹¶å†™å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">void set(Write w)&#123;</span><br><span class="line">writes_.push_back(w)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>preWrite:</p><ul><li><p>æ‰€æœ‰å†™æ“ä½œæŒ‘é€‰ä¸€ä¸ªä½œä¸ºä¸»é”ï¼ˆéšæ„æŒ‘é€‰ï¼Œå›ºå®šä½¿ç”¨ç¬¬ä¸€ä¸ªå†™æ“ä½œä½œä¸ºä¸»é”ï¼‰ï¼šé”ä½äº‹åŠ¡ä¸­å†™æ“ä½œæ¶‰åŠçš„æ‰€æœ‰æ•°æ®</p></li><li><p>å…¶ä»–å†™æ“ä½œä½œä¸ºæ¬¡é”</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">bool preWrite(Write w,Write primary)&#123;</span><br><span class="line"> Column c = w.col;</span><br><span class="line"> bigtable::Txn T = bigtable::StartRowTransaction(w.row);</span><br><span class="line"> //å¦‚æœäº‹åŠ¡å¼€å§‹åè¯¥æ•°æ®è¢«ä¿®æ”¹ï¼Œåˆ™ä¸­æ­¢äº‹åŠ¡</span><br><span class="line"> if (T.Read(w.row,c+&quot;write&quot;,[start_ts,INF]))return false;</span><br><span class="line"> //å°è¯•è·å–é”</span><br><span class="line"> if (T.Read(w.row,c+&quot;lock&quot;,[0,INF]))return fasle;</span><br><span class="line">  </span><br><span class="line"> T.Write(w.row,c+&quot;data&quot;,start_ts,w.value);</span><br><span class="line"> T.Write(w.row,c+&quot;lock&quot;,start_ts,&#123;primary.row,primary.col&#125;);</span><br><span class="line"> return T.Commit();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>æäº¤äº‹åŠ¡</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">#å†™</span><br><span class="line">bool Commit()&#123;</span><br><span class="line">Write Primary = writes_[0];</span><br><span class="line">vector&lt;Write&gt; secondaries(writes_.begin()+1,wirtes_.end());</span><br><span class="line">if (!PreWrite(primary,primary))return false;</span><br><span class="line">for (Write w:secondaries)</span><br><span class="line">if (!PreWrite(w,parimary)) return false;</span><br><span class="line"></span><br><span class="line">int commit_ts = oracle.GetTimestamp();</span><br><span class="line">//å…ˆæäº¤ä¸»é”çš„å†™æ“ä½œ</span><br><span class="line">Write p = primary;</span><br><span class="line">bigtable::Txn T= bigtable::StartRowTransaction(p.row);</span><br><span class="line">if (!T.Read(p.row,p.col+&quot;lock&quot;,[start_ts,start_ts]))</span><br><span class="line">return false;</span><br><span class="line">T.Write(p.row,p.col+&quot;write&quot;,commit_ts,start_ts);</span><br><span class="line">T.Erase(p.row,p.col+&quot;lock&quot;,commit_ts);</span><br><span class="line">if (!T.commit())return false;</span><br><span class="line">//ç¬¬äºŒé˜¶æ®µï¼Œæ›´æ–°æ‰€æœ‰æ¬¡(secondary)é”çš„å†™æ“ä½œ</span><br><span class="line">for (Write w:secondaries)&#123;</span><br><span class="line">bigtable::Write(w.row,w.rol+&quot;write&quot;,commit_ts,start_ts);</span><br><span class="line">bigtable::Erase(w.row,w.rol+&quot;lock&quot;,commit_ts);</span><br><span class="line">&#125;</span><br><span class="line">return true;</span><br><span class="line">&#125;</span><br><span class="line">#è¯»</span><br><span class="line">bool Get(Row row,Column c,string *value)&#123;</span><br><span class="line">while(true)&#123;</span><br><span class="line">bigtable::Txn T = bigtable::StartRowTransaction(row);</span><br><span class="line">//æ£€æŸ¥æ˜¯å¦æœ‰å¹¶å‘å†™å…¥çš„é”</span><br><span class="line">if (T.Read(row,c+&quot;lock&quot;,[0,start_ts]))&#123;</span><br><span class="line">//å­˜åœ¨é”ï¼Œå°è¯•æ¸…ç†å¹¶ç­‰å¾…é”é‡Šæ”¾</span><br><span class="line">BackoffAndMaybeCleanupLock(row,c);</span><br><span class="line">Continue;</span><br><span class="line">&#125;</span><br><span class="line">//æ‰¾åˆ°å°äºå¼€å§‹æ—¶é—´æˆ³çš„æœ€æ–°å†™å…¥ç‰ˆæœ¬</span><br><span class="line">latest_write=T.Read(row,c+&quot;write&quot;,[0,start_ts]);</span><br><span class="line">if (!latest_write.found()) return false; //æ²¡æœ‰æ‰¾åˆ°</span><br><span class="line">int data_ts =latest_write.start_timestamp();</span><br><span class="line">*value = T.Read(row,c+&quot;data&quot;,[data_ts,data_ts]);</span><br><span class="line">return true;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> åˆ†å¸ƒå¼ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ†å¸ƒå¼ç³»ç»Ÿ </tag>
            
            <tag> æ·±å…¥ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ·±å…¥ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿï¼ˆä¸‰ï¼‰åˆ†å¸ƒå¼ç³»ç»ŸåŸºç¡€</title>
      <link href="/2024/06/26/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%EF%BC%88%E4%B8%89%EF%BC%89%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/"/>
      <url>/2024/06/26/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%EF%BC%88%E4%B8%89%EF%BC%89%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆ†å¸ƒå¼ç³»ç»ŸåŸºç¡€"><a href="#åˆ†å¸ƒå¼ç³»ç»ŸåŸºç¡€" class="headerlink" title="åˆ†å¸ƒå¼ç³»ç»ŸåŸºç¡€"></a>åˆ†å¸ƒå¼ç³»ç»ŸåŸºç¡€</h1><h2 id="3-1-åˆ†åŒº"><a href="#3-1-åˆ†åŒº" class="headerlink" title="3.1 åˆ†åŒº"></a>3.1 åˆ†åŒº</h2><p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œåˆ†åŒºæ˜¯æŒ‡å°†æ•°æ®åˆ†æˆè‹¥å¹²ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«å­˜å‚¨åœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼Œä»¥è¾¾åˆ°æé«˜ç³»ç»Ÿæ€§èƒ½å’Œå¯æ‰©å±•æ€§çš„ç›®çš„ã€‚åˆ†åŒºæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æ•°æ®ç®¡ç†çš„åŸºç¡€ã€‚</p><p>åœ¨åˆ†åŒºä¸­ï¼Œé€šå¸¸é‡‡ç”¨å“ˆå¸Œç®—æ³•å¯¹æ•°æ®è¿›è¡Œåˆ’åˆ†ã€‚å…·ä½“æ¥è¯´ï¼Œé¦–å…ˆæ ¹æ®æ•°æ®çš„æŸä¸ªå±æ€§è¿›è¡Œå“ˆå¸Œè®¡ç®—ï¼Œå¾—åˆ°ä¸€ä¸ªå“ˆå¸Œå€¼ï¼Œç„¶åå°†è¿™ä¸ªå“ˆå¸Œå€¼æ˜ å°„åˆ°æŸä¸ªèŠ‚ç‚¹ä¸Šï¼Œå°†å¯¹åº”çš„æ•°æ®å­˜å‚¨åˆ°è¿™ä¸ªèŠ‚ç‚¹ä¸Šã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œç›¸åŒå±æ€§çš„æ•°æ®ä¼šè¢«åˆ†é…åˆ°åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œä»è€Œæé«˜æ•°æ®è®¿é—®çš„æ•ˆç‡ã€‚</p><p>åˆ†åŒºå¯ä»¥å¸¦æ¥ä»¥ä¸‹å¥½å¤„ï¼š</p><ol><li>æé«˜ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ï¼šç”±äºæ•°æ®è¢«åˆ†å‰²æˆå¤šä¸ªéƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†å¯ä»¥åˆ†åˆ«å­˜å‚¨åœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼Œå› æ­¤å¯ä»¥æ›´å®¹æ˜“åœ°è¿›è¡Œæ¨ªå‘æ‰©å±•ï¼Œå¢åŠ èŠ‚ç‚¹æ•°é‡æ¥æé«˜ç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›ã€‚</li><li>æé«˜ç³»ç»Ÿçš„æ€§èƒ½ï¼šç”±äºç›¸åŒå±æ€§çš„æ•°æ®è¢«åˆ†é…åˆ°åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œå› æ­¤å¯ä»¥æ›´å¿«åœ°è®¿é—®è¿™äº›æ•°æ®ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¤„ç†æ•ˆç‡ã€‚</li><li>æé«˜ç³»ç»Ÿçš„å®¹é”™æ€§ï¼šå½“æŸä¸ªèŠ‚ç‚¹å‘ç”Ÿæ•…éšœæ—¶ï¼Œåªæœ‰è¯¥èŠ‚ç‚¹ä¸Šçš„æ•°æ®ä¼šå—åˆ°å½±å“ï¼Œè€Œå…¶ä»–èŠ‚ç‚¹ä¸Šçš„æ•°æ®ä»ç„¶å¯ä»¥æ­£å¸¸è®¿é—®ï¼Œä»è€Œæé«˜äº†ç³»ç»Ÿçš„å®¹é”™æ€§ã€‚</li></ol><p>ä½†æ˜¯ï¼Œåˆ†åŒºä¹Ÿä¼šå¸¦æ¥ä¸€äº›æŒ‘æˆ˜å’Œé—®é¢˜ï¼Œå¦‚æ•°æ®çš„ä¸€è‡´æ€§å’Œåˆ†åŒºç­–ç•¥çš„é€‰æ‹©ç­‰ã€‚å› æ­¤ï¼Œåœ¨è®¾è®¡åˆ†å¸ƒå¼ç³»ç»Ÿæ—¶ï¼Œéœ€è¦ä»”ç»†è€ƒè™‘åˆ†åŒºç­–ç•¥å’Œæ•°æ®ä¸€è‡´æ€§ç­‰é—®é¢˜ï¼Œä»¥ç¡®ä¿ç³»ç»Ÿçš„æ­£ç¡®æ€§å’Œç¨³å®šæ€§ã€‚</p><p>æ°´å¹³åˆ†åŒºã€å‚ç›´åˆ†åŒºã€åˆ—å¼æ•°æ®åº“å’Œè¡Œå¼æ•°æ®åº“æ˜¯å…³ç³»å‹æ•°æ®åº“çš„å››ç§å¸¸è§çš„æ•°æ®åˆ†åŒºå’Œå­˜å‚¨æ–¹å¼ã€‚</p><ol><li><strong>æ°´å¹³åˆ†åŒº</strong></li></ol><p>æ°´å¹³åˆ†åŒºæ˜¯æŒ‡å°†æ•°æ®æŒ‰ç…§è¡Œè¿›è¡Œåˆ‡åˆ†ï¼Œå°†æ¯ä¸ªåˆ†åŒºçš„æ•°æ®å­˜å‚¨åœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šã€‚æ¯ä¸ªèŠ‚ç‚¹ç‹¬ç«‹ç»´æŠ¤ä¸€ä¸ªæ•°æ®å­é›†ï¼Œè¿™äº›æ•°æ®å­é›†ä¹‹é—´ç›¸äº’ç‹¬ç«‹ã€‚é€šå¸¸ï¼Œæ°´å¹³åˆ†åŒºçš„æ•°æ®åˆ‡åˆ†ä¾æ®æ˜¯æ•°æ®çš„å…³é”®å­—æˆ–è€…æŸä¸ªå±æ€§ï¼Œä»¥ä¾¿äºæŸ¥è¯¢æ—¶èƒ½å¤Ÿå¿«é€Ÿåœ°å®šä½æ•°æ®ã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼šæ°´å¹³åˆ†åŒºé€šå¸¸é€‚ç”¨äº<strong>æ•°æ®è®¿é—®å‹åŠ›æ¯”è¾ƒå¤§çš„åœºæ™¯</strong>ï¼Œå¦‚äº’è”ç½‘åº”ç”¨ã€é‡‘èç­‰é¢†åŸŸï¼Œè¿™äº›åœºæ™¯ä¸­<strong>éœ€è¦é«˜æ•ˆçš„è¯»å†™æ“ä½œå’Œæ•°æ®è®¿é—®</strong>ã€‚</p><p>ç‰¹ç‚¹ï¼šæ°´å¹³åˆ†åŒºçš„ä¼˜ç‚¹æ˜¯èƒ½å¤Ÿå°†æ•°æ®åˆ†æ•£åœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šï¼Œå‡å°‘å•èŠ‚ç‚¹çš„å‹åŠ›ï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½å’Œå¯æ‰©å±•æ€§ã€‚ç¼ºç‚¹æ˜¯éœ€è¦è€ƒè™‘æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ï¼Œå½“æŸä¸ªèŠ‚ç‚¹å‘ç”Ÿæ•…éšœæ—¶ï¼Œéœ€è¦é‡‡å–ç›¸åº”çš„æªæ–½ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚</p><ol start="2"><li><strong>å‚ç›´åˆ†åŒº</strong></li></ol><p>å‚ç›´åˆ†åŒºæ˜¯æŒ‡å°†æ•°æ®æŒ‰ç…§åˆ—è¿›è¡Œåˆ‡åˆ†ï¼Œå°†ä¸åŒçš„åˆ—å­˜å‚¨åœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šã€‚ä¸åŒçš„èŠ‚ç‚¹ç»´æŠ¤ä¸åŒçš„æ•°æ®å­é›†ï¼Œä½†æ˜¯æ•°æ®ä¹‹é—´å­˜åœ¨å…³è”å…³ç³»ã€‚å‚ç›´åˆ†åŒºçš„ç›®çš„æ˜¯å°†æ•°æ®åˆ†å¼€å­˜å‚¨ï¼Œå‡å°‘èŠ‚ç‚¹ä¹‹é—´çš„å†—ä½™æ•°æ®ã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼šå‚ç›´åˆ†åŒºé€‚ç”¨äºéœ€è¦å¯¹æ•°æ®è¿›<strong>è¡Œå¤æ‚æŸ¥è¯¢å’Œåˆ†æ</strong>çš„åœºæ™¯ï¼Œå¦‚æ•°æ®ä»“åº“ç­‰ã€‚</p><p>ç‰¹ç‚¹ï¼šå‚ç›´åˆ†åŒºçš„ä¼˜ç‚¹æ˜¯å¯ä»¥å‡å°‘å†—ä½™æ•°æ®ï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½å’Œå­˜å‚¨æ•ˆç‡ï¼ŒåŒæ—¶ä¹Ÿèƒ½æé«˜æ•°æ®çš„å®‰å…¨æ€§ã€‚ç¼ºç‚¹æ˜¯å¯èƒ½ä¼šå¢åŠ ç³»ç»Ÿçš„å¤æ‚åº¦ï¼ŒåŒæ—¶éœ€è¦è¿›è¡Œå¤šè¡¨è¿æ¥æŸ¥è¯¢ï¼Œå¯¹ç³»ç»Ÿæ€§èƒ½æœ‰ä¸€å®šå½±å“ã€‚</p><ol start="3"><li>åˆ—å¼æ•°æ®åº“</li></ol><p>åˆ—å¼æ•°æ®åº“æ˜¯æŒ‡å°†æ•°æ®æŒ‰ç…§åˆ—è¿›è¡Œå­˜å‚¨å’Œè®¿é—®çš„æ•°æ®åº“ç³»ç»Ÿã€‚ç›¸æ¯”äºä¼ ç»Ÿçš„è¡Œå¼æ•°æ®åº“ï¼Œåˆ—å¼æ•°æ®åº“æ›´åŠ é€‚ç”¨äºå¤§è§„æ¨¡æ•°æ®çš„åˆ†æå’ŒæŸ¥è¯¢ï¼Œèƒ½å¤Ÿæä¾›æ›´é«˜çš„æŸ¥è¯¢æ•ˆç‡å’Œå­˜å‚¨æ•ˆç‡ã€‚åˆ—å¼æ•°æ®åº“å°†æ¯åˆ—æ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶æˆ–æ•°æ®å—ä¸­ï¼Œè¿™æ ·å¯ä»¥é¿å…è¯»å–ä¸å¿…è¦çš„æ•°æ®ï¼Œä»è€Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼šåˆ—å¼æ•°æ®åº“é€‚ç”¨äºå¤§è§„æ¨¡æ•°æ®çš„åˆ†æå’ŒæŸ¥è¯¢ï¼Œå¦‚æ•°æ®ä»“åº“ã€åœ¨çº¿åˆ†æå¤„ç†ç­‰é¢†åŸŸã€‚</p><p>ç‰¹ç‚¹ï¼šåˆ—å¼æ•°æ®åº“çš„ä¼˜ç‚¹æ˜¯<strong>æŸ¥è¯¢æ•ˆç‡é«˜ï¼Œå­˜å‚¨æ•ˆç‡é«˜ï¼Œèƒ½å¤Ÿå¿«é€Ÿå“åº”å¤æ‚æŸ¥è¯¢è¯·æ±‚ã€‚ç¼ºç‚¹æ˜¯æ›´æ–°æ•ˆç‡ç›¸å¯¹è¾ƒä½ï¼Œä¸é€‚ç”¨äºéœ€è¦é¢‘ç¹è¿›è¡Œæ›´æ–°æ“ä½œçš„åœºæ™¯</strong>ã€‚</p><ol start="4"><li>è¡Œå¼æ•°æ®åº“</li></ol><p>è¡Œå¼æ•°æ®åº“æ˜¯æŒ‡å°†æ•°æ®æŒ‰ç…§è¡Œè¿›è¡Œå­˜å‚¨å’Œè®¿é—®çš„æ•°æ®åº“ç³»ç»Ÿã€‚è¡Œå¼æ•°æ®åº“å°†åŒä¸€è¡Œçš„æ•°æ®å­˜å‚¨åœ¨ä¸€èµ·ï¼Œè¿™æ ·èƒ½å¤Ÿæé«˜æ•°æ®çš„æ’å…¥å’Œæ›´æ–°æ•ˆç‡ã€‚ç›¸æ¯”äºåˆ—å¼æ•°æ®åº“ï¼Œè¡Œå¼æ•°æ®åº“æ›´é€‚ç”¨äºéœ€è¦é¢‘ç¹è¿›è¡Œæ›´æ–°æ“ä½œçš„åœºæ™¯ã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼šè¡Œå¼æ•°æ®åº“é€‚ç”¨äºéœ€è¦é¢‘ç¹è¿›è¡Œæ›´æ–°æ“ä½œçš„åœºæ™¯ï¼Œå¦‚åœ¨çº¿äº¤æ˜“ç³»ç»Ÿã€å®¢æˆ·å…³ç³»ç®¡ç†ç­‰é¢†åŸŸã€‚</p><p>ç‰¹ç‚¹ï¼šè¡Œå¼æ•°æ®åº“çš„ä¼˜ç‚¹æ˜¯<strong>æ”¯æŒé«˜å¹¶å‘çš„å†™å…¥æ“ä½œï¼Œé€‚ç”¨äºéœ€è¦é¢‘ç¹è¿›è¡Œæ›´æ–°æ“ä½œçš„åœºæ™¯ã€‚ç¼ºç‚¹æ˜¯æŸ¥è¯¢æ•ˆç‡ç›¸å¯¹è¾ƒä½ï¼Œå°¤å…¶æ˜¯å¯¹äºå¤§è§„æ¨¡æ•°æ®çš„æŸ¥è¯¢</strong>ï¼ŒæŸ¥è¯¢æ•ˆç‡æ˜æ˜¾ä½äºåˆ—å¼æ•°æ®åº“ã€‚</p><h3 id="3-1-1-æ°´å¹³åˆ†åŒºç®—æ³•"><a href="#3-1-1-æ°´å¹³åˆ†åŒºç®—æ³•" class="headerlink" title="3.1.1 æ°´å¹³åˆ†åŒºç®—æ³•"></a>3.1.1 æ°´å¹³åˆ†åŒºç®—æ³•</h3><p>æ°´å¹³åˆ†åŒºç®—æ³•æ˜¯æŒ‡å°†æ•°æ®æŒ‰ç…§æŸä¸ªå±æ€§å€¼è¿›è¡Œåˆ†åŒºçš„ä¸€ç§ç®—æ³•ã€‚ä»¥ä¸‹æ˜¯å‡ ç§å¸¸è§çš„æ°´å¹³åˆ†åŒºç®—æ³•ï¼š</p><ol><li>èŒƒå›´åˆ†åŒº</li></ol><p>èŒƒå›´åˆ†åŒºæ˜¯å°†æ•°æ®æŒ‰ç…§æŸä¸ªå±æ€§å€¼çš„èŒƒå›´è¿›è¡Œåˆ†åŒºçš„ç®—æ³•ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¸€ä¸ªå­¦ç”Ÿè¡¨ï¼Œå¯ä»¥å°†å­¦ç”ŸæŒ‰ç…§å¹´é¾„èŒƒå›´è¿›è¡Œåˆ†åŒºï¼Œæ¯”å¦‚0-10å²ã€11-20å²ã€21-30å²ç­‰ç­‰ã€‚</p><ol start="2"><li>å“ˆå¸Œåˆ†åŒº</li></ol><p>å“ˆå¸Œåˆ†åŒºæ˜¯å°†æ•°æ®æŒ‰ç…§æŸä¸ªå±æ€§å€¼çš„å“ˆå¸Œå€¼è¿›è¡Œåˆ†åŒºçš„ç®—æ³•ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¸€ä¸ªå­¦ç”Ÿè¡¨ï¼Œå¯ä»¥å°†å­¦ç”ŸæŒ‰ç…§å­¦ç”Ÿç¼–å·è¿›è¡Œå“ˆå¸Œåˆ†åŒºï¼Œå°†ç›¸åŒå“ˆå¸Œå€¼çš„å­¦ç”Ÿå­˜å‚¨åœ¨åŒä¸€ä¸ªåˆ†åŒºä¸­ã€‚</p><ol start="3"><li>è½®è¯¢åˆ†åŒº</li></ol><p>è½®è¯¢åˆ†åŒºæ˜¯å°†æ•°æ®æŒ‰ç…§ä¸€å®šçš„è½®è¯¢æ–¹å¼è¿›è¡Œåˆ†åŒºçš„ç®—æ³•ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¸€ä¸ªè´Ÿè½½å‡è¡¡ç³»ç»Ÿï¼Œå¯ä»¥å°†è¯·æ±‚æŒ‰ç…§è½®è¯¢çš„æ–¹å¼åˆ†é…ç»™ä¸åŒçš„æœåŠ¡å™¨å¤„ç†ï¼Œä»¥è¾¾åˆ°è´Ÿè½½å‡è¡¡çš„æ•ˆæœã€‚</p><p>ä»¥ä¸Šç®—æ³•åªæ˜¯æ°´å¹³åˆ†åŒºçš„å‡ ç§å¸¸è§æ–¹æ³•ï¼Œå®é™…åº”ç”¨ä¸­è¿˜å¯ä»¥æ ¹æ®å…·ä½“çš„éœ€æ±‚å’Œæ•°æ®ç‰¹ç‚¹è¿›è¡Œé€‚å½“çš„è°ƒæ•´å’Œä¼˜åŒ–ã€‚</p><p><strong>ä¸€è‡´æ€§å“ˆå¸Œï¼š</strong></p><p><strong>ä¸€è‡´æ€§å“ˆå¸Œ</strong>ï¼ˆConsistent Hashingï¼‰æ˜¯ä¸€ç§åˆ†å¸ƒå¼å“ˆå¸Œç®—æ³•ï¼Œå®ƒå¯ä»¥å°†æ•°æ®å’ŒèŠ‚ç‚¹æ˜ å°„åˆ°åŒä¸€ä¸ªå“ˆå¸Œç¯ä¸Šï¼Œä»è€Œæ–¹ä¾¿è¿›è¡Œæ•°æ®çš„åˆ†å¸ƒå¼å­˜å‚¨å’Œè®¿é—®ã€‚ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡å“ˆå¸Œå‡½æ•°å°†æ•°æ®å’ŒèŠ‚ç‚¹æ˜ å°„åˆ°åŒä¸€ä¸ªç¯ä¸Šï¼Œç„¶åæ ¹æ®æ•°æ®çš„å“ˆå¸Œå€¼åœ¨ç¯ä¸ŠæŸ¥æ‰¾èŠ‚ç‚¹ï¼Œä»è€Œå®ç°åˆ†å¸ƒå¼å­˜å‚¨å’Œè®¿é—®ã€‚</p><p>ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥æœ‰æ•ˆåœ°è§£å†³èŠ‚ç‚¹çš„åŠ¨æ€å¢åŠ å’Œåˆ é™¤é—®é¢˜ã€‚å½“æ–°çš„èŠ‚ç‚¹åŠ å…¥ç³»ç»Ÿæ—¶ï¼Œåªéœ€è¦å°†å®ƒçš„å“ˆå¸Œå€¼æ’å…¥åˆ°å“ˆå¸Œç¯ä¸Šï¼Œç„¶åå°†ç›¸é‚»çš„æ•°æ®é‡æ–°æ˜ å°„åˆ°æ–°èŠ‚ç‚¹ä¸Šå³å¯ã€‚å½“èŠ‚ç‚¹ç¦»å¼€ç³»ç»Ÿæ—¶ï¼Œåªéœ€è¦å°†å®ƒçš„å“ˆå¸Œå€¼ä»å“ˆå¸Œç¯ä¸Šç§»é™¤ï¼Œç„¶åå°†ç›¸é‚»çš„æ•°æ®é‡æ–°æ˜ å°„åˆ°å…¶ä»–èŠ‚ç‚¹ä¸Šå³å¯ã€‚</p><p>å¦å¤–ï¼Œä¸€è‡´æ€§å“ˆå¸Œç®—æ³•ä¹Ÿå¯ä»¥æœ‰æ•ˆåœ°è§£å†³æ•°æ®å€¾æ–œé—®é¢˜ã€‚ç”±äºå“ˆå¸Œå‡½æ•°çš„éšæœºæ€§ï¼Œä¸€äº›èŠ‚ç‚¹å¯èƒ½ä¼šè´Ÿè´£æ›´å¤šçš„æ•°æ®ï¼Œä»è€Œå¯¼è‡´è´Ÿè½½ä¸å‡è¡¡çš„é—®é¢˜ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸€è‡´æ€§å“ˆå¸Œç®—æ³•å¼•å…¥äº†è™šæ‹ŸèŠ‚ç‚¹çš„æ¦‚å¿µï¼Œå°†æ¯ä¸ªç‰©ç†èŠ‚ç‚¹æ˜ å°„åˆ°å¤šä¸ªè™šæ‹ŸèŠ‚ç‚¹ä¸Šï¼Œä»è€Œå¹³è¡¡èŠ‚ç‚¹çš„è´Ÿè½½ã€‚</p><p>æ€»ä¹‹ï¼Œä¸€è‡´æ€§å“ˆå¸Œç®—æ³•æ˜¯ä¸€ç§ç®€å•æœ‰æ•ˆçš„åˆ†å¸ƒå¼å“ˆå¸Œç®—æ³•ï¼Œå¯ä»¥åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å®ç°æ•°æ®çš„é«˜æ•ˆåˆ†å¸ƒå¼å­˜å‚¨å’Œè®¿é—®ã€‚</p><h3 id="3-1-2-åˆ†åŒºçš„æŒ‘æˆ˜"><a href="#3-1-2-åˆ†åŒºçš„æŒ‘æˆ˜" class="headerlink" title="3.1.2 åˆ†åŒºçš„æŒ‘æˆ˜"></a>3.1.2 åˆ†åŒºçš„æŒ‘æˆ˜</h3><p>æŸ¥è¯¢å›°éš¾å’Œäº‹åŠ¡</p><h2 id="3-2-å¤åˆ¶"><a href="#3-2-å¤åˆ¶" class="headerlink" title="3.2 å¤åˆ¶"></a>3.2 å¤åˆ¶</h2><p>  åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¤åˆ¶ï¼ˆReplicationï¼‰æ˜¯ä¸€ç§å¸¸è§çš„æŠ€æœ¯ï¼Œå®ƒå°†æ•°æ®å’Œè®¡ç®—èµ„æºå¤åˆ¶åˆ°å¤šä¸ªèŠ‚ç‚¹ä¸Šã€‚å¤åˆ¶çš„å¥½å¤„åŒ…æ‹¬ï¼š</p><ol><li>é«˜å¯ç”¨æ€§ï¼šå¦‚æœä¸€ä¸ªèŠ‚ç‚¹å¤±æ•ˆï¼Œå¤åˆ¶çš„æ•°æ®å’Œè®¡ç®—èµ„æºå¯ä»¥åœ¨å…¶ä»–èŠ‚ç‚¹ä¸Šç»§ç»­è¿è¡Œï¼Œä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚</li><li>æ”¹å–„æ€§èƒ½ï¼šé€šè¿‡å°†æ•°æ®å’Œè®¡ç®—èµ„æºå¤åˆ¶åˆ°å¤šä¸ªèŠ‚ç‚¹ä¸Šï¼Œå¯ä»¥å‡å°‘ç½‘ç»œå»¶è¿Ÿå’Œç“¶é¢ˆï¼Œæé«˜ç³»ç»Ÿçš„å“åº”é€Ÿåº¦å’Œååé‡ã€‚</li><li>å®¹é”™æ€§ï¼šå¤åˆ¶å¯ä»¥æé«˜ç³»ç»Ÿçš„å®¹é”™æ€§ï¼Œå³ä½¿æŸä¸ªèŠ‚ç‚¹å‘ç”Ÿæ•…éšœï¼Œä¹Ÿå¯ä»¥åœ¨å…¶ä»–èŠ‚ç‚¹ä¸Šç»§ç»­è¿è¡Œï¼Œä»è€Œä¿éšœæ•°æ®çš„å®Œæ•´æ€§å’Œå¯ç”¨æ€§ã€‚</li><li>æé«˜å¯æ‰©å±•æ€§ï¼šå¤åˆ¶å¯ä»¥æé«˜ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ï¼Œå› ä¸ºå¤åˆ¶çš„æ•°æ®å’Œè®¡ç®—èµ„æºå¯ä»¥åœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šè¿›è¡Œå¹¶è¡Œå¤„ç†ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›ã€‚</li></ol><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¤åˆ¶ä¹Ÿä¼šå¸¦æ¥ä¸€äº›è´Ÿé¢å½±å“ï¼Œä¾‹å¦‚å¢åŠ ç³»ç»Ÿçš„å¤æ‚åº¦å’Œç»´æŠ¤æˆæœ¬ï¼Œä»¥åŠå¯èƒ½å¯¼è‡´æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨å¤åˆ¶æŠ€æœ¯æ—¶ï¼Œéœ€è¦ä»”ç»†è€ƒè™‘å„ç§å› ç´ ï¼Œå¹¶æ ¹æ®å…·ä½“æƒ…å†µè¿›è¡Œæƒè¡¡ã€‚</p><h3 id="3-2-1-å•ä¸»å¤åˆ¶"><a href="#3-2-1-å•ä¸»å¤åˆ¶" class="headerlink" title="3.2.1 å•ä¸»å¤åˆ¶"></a>3.2.1 å•ä¸»å¤åˆ¶</h3><p>å•ä¸»å¤åˆ¶æ˜¯æŒ‡åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹æ‹¥æœ‰å†™å…¥æƒé™ï¼Œå…¶ä»–èŠ‚ç‚¹åªèƒ½è¿›è¡Œè¯»å–æ“ä½œï¼Œå¹¶ä¸”è¯¥èŠ‚ç‚¹è´Ÿè´£å°†å†™å…¥çš„æ•°æ®å¤åˆ¶åˆ°å…¶ä»–èŠ‚ç‚¹ä¸Šã€‚å•ä¸»å¤åˆ¶çš„å¥½å¤„åŒ…æ‹¬ï¼š</p><ol><li>ç®€å•æ˜“ç”¨ï¼šå•ä¸»å¤åˆ¶ç›¸å¯¹äºå…¶ä»–å¤åˆ¶æ–¹æ¡ˆæ¥è¯´æ¯”è¾ƒç®€å•ï¼Œæ˜“äºå®ç°å’Œç»´æŠ¤ã€‚</li><li>æ•°æ®ä¸€è‡´æ€§ï¼šç”±äºåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹æ‹¥æœ‰å†™å…¥æƒé™ï¼Œæ‰€ä»¥æ•°æ®çš„ä¸€è‡´æ€§ç›¸å¯¹è¾ƒå®¹æ˜“ç»´æŠ¤ï¼Œå¯ä»¥é¿å…å¤šä¸ªèŠ‚ç‚¹åŒæ—¶å¯¹åŒä¸€æ•°æ®è¿›è¡Œå†™å…¥æ“ä½œå¯¼è‡´çš„æ•°æ®ä¸ä¸€è‡´é—®é¢˜ã€‚</li><li>å®‰å…¨æ€§ï¼šå•ä¸»å¤åˆ¶å¯ä»¥é¿å…å¤šä¸ªèŠ‚ç‚¹åŒæ—¶å†™å…¥æ•°æ®å¯èƒ½å¯¼è‡´çš„æ•°æ®å†²çªé—®é¢˜ï¼Œä»è€Œä¿è¯æ•°æ®çš„å®‰å…¨æ€§ã€‚</li></ol><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå•ä¸»å¤åˆ¶ä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ï¼Œä¾‹å¦‚ï¼š</p><ol><li>å•ç‚¹æ•…éšœï¼šç”±äºåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹æ‹¥æœ‰å†™å…¥æƒé™ï¼Œå¦‚æœè¯¥èŠ‚ç‚¹å‘ç”Ÿæ•…éšœï¼Œæ•´ä¸ªç³»ç»Ÿå°†ä¸å¯ç”¨ã€‚</li><li>æ€§èƒ½ç“¶é¢ˆï¼šç”±äºæ‰€æœ‰çš„å†™å…¥æ“ä½œéƒ½è¦ç»è¿‡å•ä¸ªèŠ‚ç‚¹ï¼Œå¯èƒ½ä¼šæˆä¸ºæ€§èƒ½ç“¶é¢ˆï¼Œé™åˆ¶äº†ç³»ç»Ÿçš„æ‰©å±•æ€§å’Œååé‡ã€‚</li><li>å¯ç”¨æ€§é—®é¢˜ï¼šå¦‚æœèŠ‚ç‚¹ä¹‹é—´çš„ç½‘ç»œè¿æ¥å‡ºç°é—®é¢˜ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®æ— æ³•åŠæ—¶å¤åˆ¶åˆ°å…¶ä»–èŠ‚ç‚¹ï¼Œä»è€Œå½±å“ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚</li></ol><p>å› æ­¤ï¼Œåœ¨ä½¿ç”¨å•ä¸»å¤åˆ¶æŠ€æœ¯æ—¶ï¼Œéœ€è¦ä»”ç»†è€ƒè™‘å„ç§å› ç´ ï¼Œå¹¶æ ¹æ®å…·ä½“æƒ…å†µè¿›è¡Œæƒè¡¡ã€‚</p><p>åœ¨å•ä¸»å¤åˆ¶ä¸­ï¼Œå¯ä»¥è¿›ä¸€æ­¥åˆ†ä¸ºä»¥ä¸‹ä¸¤ç§ç±»å‹ï¼š</p><ol><li>ä¸»ä»å¤åˆ¶ï¼ˆMaster-Slave Replicationï¼‰ï¼šåœ¨ä¸»ä»å¤åˆ¶ä¸­ï¼Œåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆä¸»èŠ‚ç‚¹ï¼‰æ‹¥æœ‰å†™å…¥æƒé™ï¼Œå…¶ä»–èŠ‚ç‚¹ï¼ˆä»èŠ‚ç‚¹ï¼‰åªèƒ½è¿›è¡Œè¯»å–æ“ä½œï¼Œå¹¶ä¸”ä¸»èŠ‚ç‚¹è´Ÿè´£å°†å†™å…¥çš„æ•°æ®å¤åˆ¶åˆ°ä»èŠ‚ç‚¹ä¸Šã€‚ä¸»èŠ‚ç‚¹çš„å†™å…¥æ“ä½œä¼šè¢«å¼‚æ­¥åœ°å¤åˆ¶åˆ°ä»èŠ‚ç‚¹ä¸Šï¼Œä»èŠ‚ç‚¹çš„æ•°æ®ä¸ä¸»èŠ‚ç‚¹å¯èƒ½<strong>å­˜åœ¨ä¸€å®šçš„å»¶è¿Ÿ</strong>ï¼Œä½†ä»èŠ‚ç‚¹çš„æ•°æ®æœ€ç»ˆä¼šä¸ä¸»èŠ‚ç‚¹ä¿æŒä¸€è‡´ã€‚ä¸»ä»å¤åˆ¶å¯ä»¥æä¾›é«˜å¯ç”¨æ€§å’Œæ•°æ®ä¸€è‡´æ€§ï¼Œå¹¶ä¸”ç›¸å¯¹ç®€å•æ˜“ç”¨ã€‚</li><li>ä¸»å¤‡å¤åˆ¶ï¼ˆMaster-Standby Replicationï¼‰ï¼šåœ¨ä¸»å¤‡å¤åˆ¶ä¸­ï¼Œä¹Ÿåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼ˆä¸»èŠ‚ç‚¹ï¼‰æ‹¥æœ‰å†™å…¥æƒé™ï¼Œå…¶ä»–èŠ‚ç‚¹ï¼ˆå¤‡èŠ‚ç‚¹ï¼‰åªèƒ½è¿›è¡Œè¯»å–æ“ä½œï¼Œå¹¶ä¸”å¤‡èŠ‚ç‚¹ä¸ä¸»èŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®åŒæ­¥æ˜¯<strong>å®æ—¶çš„</strong>ã€‚å½“ä¸»èŠ‚ç‚¹å‘ç”Ÿæ•…éšœæ—¶ï¼Œå¤‡èŠ‚ç‚¹ä¼šæ¥ç®¡ä¸»èŠ‚ç‚¹çš„åŠŸèƒ½ï¼Œæˆä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œä»è€Œä¿è¯ç³»ç»Ÿçš„é«˜å¯ç”¨æ€§ã€‚ä¸»å¤‡å¤åˆ¶ç›¸å¯¹äºä¸»ä»å¤åˆ¶æ¥è¯´ï¼Œå¯ç”¨æ€§æ›´é«˜ï¼Œä½†æ˜¯å®ç°å’Œç»´æŠ¤çš„å¤æ‚åº¦æ›´é«˜ã€‚</li></ol><p><strong>è„‘è£‚ï¼š</strong></p><p>è„‘è£‚ï¼ˆSplit-Brainï¼‰æ˜¯æŒ‡åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç”±äºç½‘ç»œåˆ†åŒºæˆ–è€…å…¶ä»–åŸå› ï¼Œå¯¼è‡´ç³»ç»Ÿä¸­çš„èŠ‚ç‚¹å¤±å»è”ç³»ï¼Œæ— æ³•è¿›è¡Œé€šä¿¡ï¼Œè¿›è€Œå¯¼è‡´ç³»ç»Ÿå‡ºç°æ•°æ®ä¸ä¸€è‡´æˆ–è€…æ“ä½œå†²çªçš„é—®é¢˜ã€‚</p><p>å½“å‡ºç°ç½‘ç»œåˆ†åŒºæ—¶ï¼Œç³»ç»Ÿä¸­çš„èŠ‚ç‚¹å¯èƒ½ä¼šè¢«åˆ†ä¸ºä¸¤ä¸ªæˆ–è€…å¤šä¸ªç‹¬ç«‹çš„éƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†éƒ½è®¤ä¸ºè‡ªå·±æ˜¯æ•´ä¸ªç³»ç»Ÿçš„å”¯ä¸€éƒ¨åˆ†ï¼Œè€Œä¸”å¯èƒ½ä¼šç‹¬ç«‹åœ°è¿›è¡Œå†™å…¥æ“ä½œï¼Œå¯¼è‡´æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚è¿™ç§æƒ…å†µè¢«ç§°ä¸ºè„‘è£‚ã€‚</p><p>è„‘è£‚å¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿæ•°æ®çš„ä¸ä¸€è‡´æ€§ï¼Œä»è€Œå½±å“ç³»ç»Ÿçš„æ­£ç¡®æ€§å’Œå¯ç”¨æ€§ã€‚ä¸ºäº†é¿å…è„‘è£‚çš„å‘ç”Ÿï¼Œå¯ä»¥é‡‡å–ä»¥ä¸‹æªæ–½ï¼š</p><ol><li>ä½¿ç”¨å¤åˆ¶æŠ€æœ¯ï¼šé€šè¿‡å°†æ•°æ®å’Œè®¡ç®—èµ„æºå¤åˆ¶åˆ°å¤šä¸ªèŠ‚ç‚¹ä¸Šï¼Œå¯ä»¥æé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œå®¹é”™æ€§ï¼Œå‡å°‘è„‘è£‚çš„å¯èƒ½æ€§ã€‚</li><li>ä½¿ç”¨æŠ•ç¥¨æœºåˆ¶ï¼šåœ¨ç³»ç»Ÿä¸­ä½¿ç”¨æŠ•ç¥¨æœºåˆ¶ï¼Œå¯ä»¥é¿å…è„‘è£‚çš„å‘ç”Ÿã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸»ä»å¤åˆ¶ä¸­ï¼Œä¸»èŠ‚ç‚¹å¯ä»¥å°†å†™å…¥æ“ä½œåŒæ­¥åˆ°å¤šä¸ªä»èŠ‚ç‚¹ä¸Šï¼Œç„¶åé€šè¿‡æŠ•ç¥¨æœºåˆ¶æ¥ç¡®å®šå“ªä¸ªä»èŠ‚ç‚¹åº”è¯¥æˆä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œä»è€Œé¿å…è„‘è£‚çš„å‘ç”Ÿã€‚</li><li>é™åˆ¶èŠ‚ç‚¹çš„æ•°é‡ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¯ä»¥é™åˆ¶èŠ‚ç‚¹çš„æ•°é‡ï¼Œä»è€Œå‡å°‘ç³»ç»Ÿçš„å¤æ‚åº¦å’Œå®¹é”™éš¾åº¦ï¼Œé™ä½è„‘è£‚çš„é£é™©ã€‚</li><li>ç›‘æ§ç³»ç»ŸçŠ¶æ€ï¼šå¯¹ç³»ç»ŸçŠ¶æ€è¿›è¡Œç›‘æ§ï¼ŒåŠæ—¶å‘ç°å’Œè§£å†³æ½œåœ¨çš„é—®é¢˜ï¼Œå¯ä»¥æœ‰æ•ˆåœ°é¿å…è„‘è£‚çš„å‘ç”Ÿã€‚</li></ol><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡ä¸Šè¿°æªæ–½æ¥å‡å°‘è„‘è£‚çš„é£é™©ï¼Œä½†æ˜¯å®Œå…¨é¿å…è„‘è£‚æ˜¯éå¸¸å›°éš¾çš„ï¼Œå› æ­¤éœ€è¦åœ¨è®¾è®¡å’Œå®ç°åˆ†å¸ƒå¼ç³»ç»Ÿæ—¶å……åˆ†è€ƒè™‘è„‘è£‚çš„é£é™©ï¼Œå¹¶åˆ¶å®šç›¸åº”çš„åº”å¯¹ç­–ç•¥ã€‚</p><h3 id="3-2-2-å¤šä¸»å¤åˆ¶"><a href="#3-2-2-å¤šä¸»å¤åˆ¶" class="headerlink" title="3.2.2 å¤šä¸»å¤åˆ¶"></a>3.2.2 å¤šä¸»å¤åˆ¶</h3><p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¤šä¸»å¤åˆ¶ï¼ˆMulti-Master Replicationï¼‰æ˜¯æŒ‡å¤šä¸ªèŠ‚ç‚¹æ‹¥æœ‰å†™å…¥æƒé™ï¼Œå¹¶ä¸”å¯ä»¥åŒæ—¶è¿›è¡Œå†™å…¥æ“ä½œçš„ä¸€ç§å¤åˆ¶æ–¹å¼ã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥ç‹¬ç«‹åœ°è¿›è¡Œå†™å…¥æ“ä½œï¼Œå†™å…¥çš„æ•°æ®ä¼šè¢«å¼‚æ­¥åœ°å¤åˆ¶åˆ°å…¶ä»–èŠ‚ç‚¹ä¸Šï¼Œä»è€Œå®ç°æ•°æ®çš„å¤åˆ¶å’ŒåŒæ­¥ã€‚</p><p>å¤šä¸»å¤åˆ¶ç›¸å¯¹äºå•ä¸»å¤åˆ¶æ¥è¯´ï¼Œå…·æœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹ï¼š</p><ol><li><strong>é«˜å¹¶å‘æ€§</strong>ï¼šå¤šä¸»å¤åˆ¶å…è®¸å¤šä¸ªèŠ‚ç‚¹åŒæ—¶è¿›è¡Œå†™å…¥æ“ä½œï¼Œå¯ä»¥æé«˜ç³»ç»Ÿçš„å¹¶å‘æ€§å’Œååé‡ï¼Œä»è€Œæ»¡è¶³é«˜å¹¶å‘åœºæ™¯ä¸‹çš„éœ€æ±‚ã€‚</li><li><strong>é«˜å¯ç”¨æ€§</strong>ï¼šå¤šä¸»å¤åˆ¶å…è®¸å¤šä¸ªèŠ‚ç‚¹åŒæ—¶æ‹¥æœ‰å†™å…¥æƒé™ï¼Œå½“æŸä¸ªèŠ‚ç‚¹å‡ºç°æ•…éšœæ—¶ï¼Œå…¶ä»–èŠ‚ç‚¹å¯ä»¥ç»§ç»­è¿›è¡Œå†™å…¥æ“ä½œï¼Œä»è€Œä¿è¯ç³»ç»Ÿçš„é«˜å¯ç”¨æ€§å’Œå®¹é”™æ€§ã€‚</li><li><strong>çµæ´»æ€§</strong>ï¼šå¤šä¸»å¤åˆ¶å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚è¿›è¡Œçµæ´»é…ç½®ï¼Œå¯ä»¥åœ¨å¤šä¸ªèŠ‚ç‚¹ä¹‹é—´å¹³è¡¡è´Ÿè½½ï¼Œæé«˜ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚</li></ol><p>ä½†æ˜¯ï¼Œå¤šä¸»å¤åˆ¶ä¹Ÿå­˜åœ¨ä¸€äº›æŒ‘æˆ˜å’Œé™åˆ¶ï¼š</p><ol><li>å†²çªé—®é¢˜ï¼šå½“å¤šä¸ªèŠ‚ç‚¹åŒæ—¶è¿›è¡Œå†™å…¥æ“ä½œæ—¶ï¼Œå¯èƒ½ä¼šå‘ç”Ÿæ•°æ®å†²çªçš„é—®é¢˜ï¼Œéœ€è¦é‡‡å–ç›¸åº”çš„å†²çªè§£å†³ç­–ç•¥æ¥é¿å…æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</li><li>ä¸€è‡´æ€§é—®é¢˜ï¼šå¤šä¸»å¤åˆ¶éœ€è¦ä¿è¯èŠ‚ç‚¹ä¹‹é—´æ•°æ®çš„ä¸€è‡´æ€§ï¼Œéœ€è¦ä½¿ç”¨ç›¸åº”çš„åè°ƒæœºåˆ¶æ¥ä¿è¯æ•°æ®çš„æ­£ç¡®æ€§å’Œä¸€è‡´æ€§ã€‚</li><li>å®ç°å’Œç»´æŠ¤çš„å¤æ‚åº¦ï¼šå¤šä¸»å¤åˆ¶çš„å®ç°å’Œç»´æŠ¤ç›¸å¯¹å¤æ‚ï¼Œéœ€è¦è€ƒè™‘èŠ‚ç‚¹ä¹‹é—´çš„åŒæ­¥å’Œå†²çªè§£å†³ç­‰é—®é¢˜ï¼Œå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦å’Œç»´æŠ¤éš¾åº¦ã€‚</li></ol><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è®¾è®¡å’Œå®ç°å¤šä¸»å¤åˆ¶æ—¶ï¼Œéœ€è¦ç»¼åˆè€ƒè™‘ç³»ç»Ÿçš„æ€§èƒ½ã€å¯ç”¨æ€§å’Œä¸€è‡´æ€§ç­‰æ–¹é¢çš„éœ€æ±‚ï¼Œä»¥åŠå„ç§å†²çªè§£å†³å’Œåè°ƒæœºåˆ¶çš„å¤æ‚åº¦å’Œå®ç°éš¾åº¦ï¼Œä»è€Œé€‰æ‹©æœ€åˆé€‚çš„å¤åˆ¶æ–¹å¼ã€‚</p><p><strong>è§£å†³å†²çªï¼š</strong></p><p>åœ¨å¤šä¸»å¤åˆ¶ä¸­ï¼Œå½“å¤šä¸ªèŠ‚ç‚¹åŒæ—¶å¯¹åŒä¸€ä¸ªæ•°æ®è¿›è¡Œå†™å…¥æ“ä½œæ—¶ï¼Œå¯èƒ½ä¼šå‘ç”Ÿå†²çªï¼Œä»è€Œå¯¼è‡´æ•°æ®çš„ä¸ä¸€è‡´æ€§ã€‚ä¸ºäº†é¿å…å†²çªé—®é¢˜ï¼Œå¯ä»¥é‡‡ç”¨ä»¥ä¸‹å‡ ç§è§£å†³åŠæ³•ï¼š</p><ol><li><p>ä¹è§‚é”æœºåˆ¶ï¼šæ¯ä¸ªèŠ‚ç‚¹åœ¨è¿›è¡Œå†™å…¥æ“ä½œå‰ï¼Œå…ˆè·å–å½“å‰æ•°æ®çš„ç‰ˆæœ¬å·ï¼Œå¹¶åœ¨å†™å…¥æ—¶é™„å¸¦ç‰ˆæœ¬å·ä¿¡æ¯ã€‚å½“å…¶ä»–èŠ‚ç‚¹è¿›è¡Œå†™å…¥æ—¶ï¼Œä¼šå‘ç°ç‰ˆæœ¬å·ä¸ä¸€è‡´ï¼Œä»è€Œå¼•å‘å†²çªã€‚æ­¤æ—¶ï¼ŒèŠ‚ç‚¹å¯ä»¥æ ¹æ®å…·ä½“çš„ç­–ç•¥è¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œä¾‹å¦‚é€‰æ‹©æœ€æ–°çš„ç‰ˆæœ¬è¿›è¡Œæ›´æ–°ï¼Œæˆ–è€…æ”¾å¼ƒå½“å‰çš„å†™å…¥æ“ä½œç­‰ã€‚</p></li><li><p>æ‚²è§‚é”æœºåˆ¶ï¼šæ¯ä¸ªèŠ‚ç‚¹åœ¨è¿›è¡Œå†™å…¥æ“ä½œæ—¶ï¼Œå…ˆå°è¯•è·å–å¯¹åº”çš„é”ï¼Œå¦‚æœè·å–ä¸åˆ°ï¼Œåˆ™è¯´æ˜æœ‰å…¶ä»–èŠ‚ç‚¹æ­£åœ¨è¿›è¡Œå†™å…¥æ“ä½œï¼Œæ­¤æ—¶å¯ä»¥ç­‰å¾…ä¸€æ®µæ—¶é—´åå†æ¬¡å°è¯•è·å–é”ï¼Œæˆ–è€…æ”¾å¼ƒå½“å‰çš„å†™å…¥æ“ä½œã€‚</p></li><li><p>æ—¶åºå¤åˆ¶æœºåˆ¶ï¼šåœ¨å¤šä¸»å¤åˆ¶ä¸­ï¼Œé€šè¿‡ä½¿ç”¨å…¨å±€å”¯ä¸€çš„æ—¶é—´æˆ³æˆ–åºåˆ—å·æ¥åè°ƒå¤šä¸ªèŠ‚ç‚¹ä¹‹é—´çš„å†™å…¥æ“ä½œï¼Œä»è€Œé¿å…å†²çªã€‚æ¯ä¸ªèŠ‚ç‚¹åœ¨è¿›è¡Œå†™å…¥æ“ä½œæ—¶ï¼Œéœ€è¦å¸¦ä¸Šå¯¹åº”çš„æ—¶é—´æˆ³æˆ–åºåˆ—å·ï¼Œå½“å…¶ä»–èŠ‚ç‚¹æ¥æ”¶åˆ°å†™å…¥è¯·æ±‚æ—¶ï¼Œä¼šæ ¹æ®æ—¶é—´æˆ³æˆ–åºåˆ—å·æ¥ç¡®å®šå†™å…¥çš„å…ˆåé¡ºåºï¼Œä»è€Œä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚</p></li><li><p>åŸºäºç‰ˆæœ¬å‘é‡çš„æœºåˆ¶ï¼šæ¯ä¸ªèŠ‚ç‚¹åœ¨è¿›è¡Œå†™å…¥æ“ä½œæ—¶ï¼Œä¸ä»…è®°å½•å½“å‰æ•°æ®çš„ç‰ˆæœ¬å·ï¼Œè¿˜è®°å½•å…¶ä»–èŠ‚ç‚¹æœ€è¿‘çš„ç‰ˆæœ¬å·ä¿¡æ¯ã€‚å½“å…¶ä»–èŠ‚ç‚¹è¿›è¡Œå†™å…¥æ—¶ï¼Œä¼šå°†è‡ªå·±çš„ç‰ˆæœ¬å·ä¿¡æ¯ä¼ é€’ç»™å…¶ä»–èŠ‚ç‚¹ï¼Œä»è€Œå½¢æˆä¸€ä¸ªç‰ˆæœ¬å‘é‡ï¼Œç”¨äºåˆ¤æ–­ä¸åŒèŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®å†²çªå’Œä¸€è‡´æ€§ã€‚</p></li><li><p>ç”±å®¢æˆ·ç«¯è§£å†³å†²çª</p></li><li><p>â€œæœ€åå†™å…¥èƒœåˆ©â€ï¼ˆLast Writer Winsï¼ŒLWWï¼‰æ˜¯ä¸€ç§å¸¸è§çš„å¤šä¸»å¤åˆ¶å†²çªè§£å†³ç­–ç•¥ã€‚è¯¥ç­–ç•¥çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼Œå½“å¤šä¸ªèŠ‚ç‚¹å¯¹åŒä¸€ä¸ªæ•°æ®è¿›è¡Œå†™å…¥æ—¶ï¼Œä»¥æœ€åå†™å…¥çš„èŠ‚ç‚¹ä¸ºå‡†ï¼Œå³åæ¥çš„å†™å…¥æ“ä½œä¼šè¦†ç›–ä¹‹å‰çš„å†™å…¥æ“ä½œã€‚</p><p>å…·ä½“å®ç°æ—¶ï¼Œæ¯ä¸ªèŠ‚ç‚¹åœ¨è¿›è¡Œå†™å…¥æ“ä½œæ—¶ï¼Œéƒ½ä¼šè®°å½•å¯¹åº”çš„æ—¶é—´æˆ³æˆ–ç‰ˆæœ¬å·ï¼Œå½“å…¶ä»–èŠ‚ç‚¹æ”¶åˆ°å†™å…¥è¯·æ±‚æ—¶ï¼Œä¼šæ¯”è¾ƒå½“å‰èŠ‚ç‚¹çš„æ—¶é—´æˆ³æˆ–ç‰ˆæœ¬å·å’Œè‡ªèº«è®°å½•çš„æ—¶é—´æˆ³æˆ–ç‰ˆæœ¬å·ï¼Œä»¥æ­¤æ¥åˆ¤æ–­å“ªä¸ªå†™å…¥æ“ä½œæ›´æ™šï¼Œä»è€Œå†³å®šæ˜¯å¦æ¥å—è¯¥å†™å…¥è¯·æ±‚ã€‚å½“å‘ç”Ÿå†²çªæ—¶ï¼Œä»¥æœ€åå†™å…¥çš„èŠ‚ç‚¹ä¸ºå‡†ï¼Œæ›´æ–°æ•°æ®ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒLWWç­–ç•¥è™½ç„¶ç®€å•æ˜“å®ç°ï¼Œä½†ä¹Ÿå­˜åœ¨ä¸€äº›æ½œåœ¨çš„é—®é¢˜ï¼Œä¾‹å¦‚å¯èƒ½å¯¼è‡´æ•°æ®çš„ä¸¢å¤±ã€æ•°æ®çš„ä¸ä¸€è‡´æ€§ç­‰ã€‚å› æ­¤ï¼Œåœ¨é€‰æ‹©å†²çªè§£å†³ç­–ç•¥æ—¶ï¼Œéœ€è¦æ ¹æ®å…·ä½“çš„åº”ç”¨åœºæ™¯å’Œéœ€æ±‚è¿›è¡Œç»¼åˆè€ƒè™‘ï¼Œæƒè¡¡ä¸åŒç­–ç•¥çš„ä¼˜ç¼ºç‚¹ã€‚</p></li><li><p>å› æœå…³ç³»è·Ÿè¸ª</p><p>å› æœå…³ç³»è·Ÿè¸ªï¼ˆCausal tracingï¼‰æ˜¯ä¸€ç§åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ç”¨äºè·Ÿè¸ªä¸åŒèŠ‚ç‚¹ä¹‹é—´äº¤äº’çš„æŠ€æœ¯ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¸åŒèŠ‚ç‚¹ä¹‹é—´çš„äº¤äº’å¾€å¾€æ˜¯å¼‚æ­¥çš„ï¼Œå¹¶ä¸”å¯èƒ½ç»è¿‡å¤šä¸ªä¸­é—´èŠ‚ç‚¹ï¼Œå› æ­¤éœ€è¦ä¸€ç§æœºåˆ¶æ¥è·Ÿè¸ªäº¤äº’çš„å› æœå…³ç³»ï¼Œä»¥ä¾¿åˆ†æå’Œè°ƒè¯•ç³»ç»Ÿçš„è¡Œä¸ºã€‚</p><p>å› æœå…³ç³»è·Ÿè¸ªé€šå¸¸åŸºäºäº‹ä»¶æ¨¡å‹ï¼Œå³å°†ç³»ç»Ÿçš„è¡Œä¸ºæŠ½è±¡ä¸ºä¸€ç³»åˆ—äº‹ä»¶ï¼Œå¹¶è®°å½•äº‹ä»¶ä¹‹é—´çš„å› æœå…³ç³»ã€‚å…·ä½“æ¥è¯´ï¼Œå½“ä¸€ä¸ªèŠ‚ç‚¹å‘é€è¯·æ±‚ç»™å¦ä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼Œéœ€è¦å°†è¯·æ±‚çš„ç›¸å…³ä¿¡æ¯ï¼ˆä¾‹å¦‚è¯·æ±‚IDã€æ—¶é—´æˆ³ç­‰ï¼‰é™„åŠ åˆ°è¯·æ±‚ä¸­ï¼Œå¹¶åœ¨æ¥æ”¶åˆ°å“åº”æ—¶å°†å“åº”çš„ç›¸å…³ä¿¡æ¯ï¼ˆä¾‹å¦‚å“åº”IDã€æ—¶é—´æˆ³ç­‰ï¼‰é™„åŠ åˆ°å“åº”ä¸­ã€‚è¿™æ ·ï¼Œæ¯ä¸ªäº‹ä»¶å°±å¯ä»¥é€šè¿‡ç›¸å…³çš„ä¿¡æ¯ä¸ä¹‹å‰å’Œä¹‹åçš„äº‹ä»¶å»ºç«‹å› æœå…³ç³»ã€‚</p><p>é€šè¿‡å› æœå…³ç³»è·Ÿè¸ªï¼Œå¯ä»¥å®ç°åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ•…éšœå®šä½ã€æ€§èƒ½è°ƒä¼˜ã€å®¹é”™å¤„ç†ç­‰åŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œåœ¨è¿›è¡Œæ•…éšœå®šä½æ—¶ï¼Œå¯ä»¥æ ¹æ®äº‹ä»¶ä¹‹é—´çš„å› æœå…³ç³»ï¼Œè¿½æº¯å‡ºæ•…éšœçš„æ¥æºï¼›åœ¨è¿›è¡Œæ€§èƒ½è°ƒä¼˜æ—¶ï¼Œå¯ä»¥é€šè¿‡åˆ†æäº‹ä»¶ä¹‹é—´çš„æ—¶é—´å…³ç³»ï¼Œæ‰¾å‡ºç³»ç»Ÿä¸­çš„ç“¶é¢ˆå’Œä¼˜åŒ–ç©ºé—´ï¼›åœ¨è¿›è¡Œå®¹é”™å¤„ç†æ—¶ï¼Œå¯ä»¥æ ¹æ®å› æœå…³ç³»åˆ¤æ–­ä¸åŒèŠ‚ç‚¹ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä»è€Œå†³å®šå¦‚ä½•è¿›è¡Œå®¹é”™å¤„ç†ã€‚</p><p>ç›®å‰ï¼Œå› æœå…³ç³»è·Ÿè¸ªå·²ç»æˆä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ä¸€ä¸ªé‡è¦ç»„æˆéƒ¨åˆ†ï¼Œå¹¶ä¸”åœ¨å¼€æºå·¥å…·å’Œäº‘æœåŠ¡å¹³å°ä¸­å¾—åˆ°äº†å¹¿æ³›åº”ç”¨ï¼Œä¾‹å¦‚OpenTelemetryã€Zipkinã€Jaegerç­‰ã€‚</p></li></ol><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸åŒçš„è§£å†³åŠæ³•é€‚ç”¨äºä¸åŒçš„åœºæ™¯å’Œéœ€æ±‚ï¼Œé€‰æ‹©åˆé€‚çš„å†²çªè§£å†³ç­–ç•¥éœ€è¦ç»¼åˆè€ƒè™‘å¤šæ–¹é¢çš„å› ç´ ï¼ŒåŒ…æ‹¬ç³»ç»Ÿçš„æ€§èƒ½ã€å¯é æ€§ã€ä¸€è‡´æ€§å’Œå¤æ‚åº¦ç­‰ã€‚</p><h3 id="3-2-3-æ— ä¸»å¤åˆ¶"><a href="#3-2-3-æ— ä¸»å¤åˆ¶" class="headerlink" title="3.2.3 æ— ä¸»å¤åˆ¶"></a>3.2.3 æ— ä¸»å¤åˆ¶</h3><p>æ— ä¸»å¤åˆ¶ï¼ˆMasterless replicationï¼‰æ˜¯ä¸€ç§åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¸¸è§çš„æ•°æ®å¤åˆ¶ç­–ç•¥ï¼Œä¸å•ä¸»å¤åˆ¶å’Œå¤šä¸»å¤åˆ¶ä¸åŒï¼Œæ— ä¸»å¤åˆ¶ä¸éœ€è¦æŒ‡å®šç‰¹å®šçš„èŠ‚ç‚¹ä½œä¸ºä¸»èŠ‚ç‚¹ï¼Œè€Œæ˜¯è®©<strong>æ‰€æœ‰èŠ‚ç‚¹éƒ½èƒ½å¤Ÿè¯»å–å’Œå†™å…¥æ•°æ®</strong>ã€‚å…·ä½“æ¥è¯´ï¼Œæ— ä¸»å¤åˆ¶é€šå¸¸é‡‡ç”¨ä»¥ä¸‹ä¸¤ç§æ–¹å¼å®ç°ï¼š</p><ol><li>åŸºäº<strong>å‰¯æœ¬é›†</strong>ï¼šæ— ä¸»å¤åˆ¶å¯ä»¥åŸºäºå‰¯æœ¬é›†å®ç°ï¼Œå³å°†æ•°æ®å¤åˆ¶åˆ°å¤šä¸ªèŠ‚ç‚¹ä¸Šï¼Œå¹¶ä¿è¯æ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„æ•°æ®å‰¯æœ¬æ˜¯ä¸€è‡´çš„ã€‚å½“è¿›è¡Œå†™å…¥æ“ä½œæ—¶ï¼Œæ‰€æœ‰èŠ‚ç‚¹éƒ½å¯ä»¥æ¥å—å†™å…¥è¯·æ±‚ï¼Œå¹¶å°†<strong>å†™å…¥æ“ä½œå¹¿æ’­</strong>ç»™å…¶ä»–èŠ‚ç‚¹è¿›è¡Œæ›´æ–°ã€‚å½“è¿›è¡Œè¯»å–æ“ä½œæ—¶ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥ä»è‡ªå·±æœ¬åœ°çš„æ•°æ®å‰¯æœ¬ä¸­è¯»å–æ•°æ®ã€‚</li><li>åŸºäº<strong>åˆ†ç‰‡</strong>ï¼šæ— ä¸»å¤åˆ¶ä¹Ÿå¯ä»¥åŸºäºåˆ†ç‰‡å®ç°ï¼Œå³å°†æ•°æ®åˆ’åˆ†ä¸ºå¤šä¸ªåˆ†ç‰‡ï¼Œå¹¶å°†æ¯ä¸ªåˆ†ç‰‡å¤åˆ¶åˆ°å¤šä¸ªèŠ‚ç‚¹ä¸Šã€‚å½“è¿›è¡Œå†™å…¥æ“ä½œæ—¶ï¼Œåªéœ€è¦å°†<strong>å†™å…¥æ“ä½œå‘é€ç»™å¯¹åº”çš„åˆ†ç‰‡æ‰€åœ¨çš„èŠ‚ç‚¹</strong>ï¼Œå¹¶æ›´æ–°è¯¥èŠ‚ç‚¹ä¸Šçš„æ•°æ®å‰¯æœ¬ã€‚å½“è¿›è¡Œè¯»å–æ“ä½œæ—¶ï¼Œåªéœ€è¦æ ¹æ®è¯»å–è¯·æ±‚æ‰€æ¶‰åŠçš„åˆ†ç‰‡ï¼Œä»å¯¹åº”çš„èŠ‚ç‚¹ä¸­è¯»å–æ•°æ®ã€‚</li></ol><p>æ— ä¸»å¤åˆ¶ç›¸æ¯”äºå•ä¸»å¤åˆ¶å’Œå¤šä¸»å¤åˆ¶ï¼Œå…·æœ‰<strong>æ›´å¥½çš„å¯ä¼¸ç¼©æ€§å’Œå®¹é”™æ€§</strong>ï¼Œå› ä¸ºæ¯ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥ç‹¬ç«‹åœ°æ¥å—è¯»å†™è¯·æ±‚ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡å¢åŠ èŠ‚ç‚¹æ•°ç›®æ¥æé«˜ç³»ç»Ÿçš„å®¹é”™èƒ½åŠ›å’Œååé‡ã€‚ä½†åŒæ—¶ï¼Œæ— ä¸»å¤åˆ¶ä¹Ÿéœ€è¦è€ƒè™‘æ•°æ®ä¸€è‡´æ€§å’Œå†²çªè§£å†³ç­‰é—®é¢˜ï¼Œä¾‹å¦‚å¦‚ä½•è§£å†³å¹¶å‘å†™å…¥æ“ä½œå¯¼è‡´çš„å†²çªï¼Œå¦‚ä½•ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ç­‰ã€‚</p><p>Dynamoæ¶æ„ä¸­çš„ä¸¤ç§æ•°æ®ä¿®å¤æ–¹æ³•ï¼š</p><ol><li><p>è¯»ä¿®å¤ï¼ˆRead repairï¼‰ï¼šè¯»ä¿®å¤æ˜¯ä¸€ç§åœ¨è¯»å–æ•°æ®æ—¶è‡ªåŠ¨ä¿®å¤æŸåæˆ–ä¸ä¸€è‡´æ•°æ®çš„æŠ€æœ¯ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç”±äºæ•°æ®å‰¯æœ¬ä¹‹é—´å¯èƒ½å­˜åœ¨ç½‘ç»œåˆ†åŒºæˆ–å†™å†²çªç­‰é—®é¢˜ï¼Œå¯¼è‡´æŸäº›èŠ‚ç‚¹ä¸Šçš„æ•°æ®å‰¯æœ¬å¯èƒ½å·²ç»è¿‡æœŸæˆ–æŸåã€‚å½“å®¢æˆ·ç«¯<strong>ä»ä¸€ä¸ªèŠ‚ç‚¹è¯»å–æ•°æ®æ—¶ï¼Œå¦‚æœå‘ç°è¯¥èŠ‚ç‚¹ä¸Šçš„æ•°æ®å‰¯æœ¬å·²ç»è¿‡æœŸæˆ–ä¸å…¶ä»–èŠ‚ç‚¹ä¸Šçš„å‰¯æœ¬ä¸ä¸€è‡´ï¼Œè¯¥èŠ‚ç‚¹ä¼šå°è¯•ä»å…¶ä»–èŠ‚ç‚¹ä¸­è¯»å–æœ€æ–°çš„æ•°æ®ï¼Œå¹¶å°†å…¶ä¸è‡ªå·±çš„æ•°æ®å‰¯æœ¬è¿›è¡Œæ¯”è¾ƒå’Œåˆå¹¶ï¼Œä»è€Œå®ç°æ•°æ®çš„ä¿®å¤ã€‚</strong></p></li><li><p>åç†µè¿‡ç¨‹ï¼ˆAnti-entropyï¼‰ï¼šåç†µè¿‡ç¨‹æ˜¯ä¸€ç§<strong>å®šæœŸæ£€æŸ¥</strong>å’Œä¿®å¤æ•°æ®ä¸ä¸€è‡´é—®é¢˜çš„æŠ€æœ¯ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç”±äºç½‘ç»œæ•…éšœæˆ–å…¶ä»–åŸå› ï¼Œä¸åŒèŠ‚ç‚¹ä¸Šçš„æ•°æ®å‰¯æœ¬å¯èƒ½ä¼šå‡ºç°ä¸ä¸€è‡´çš„æƒ…å†µï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç³»ç»Ÿå¯ä»¥å®šæœŸå¯åŠ¨åç†µè¿‡ç¨‹æ¥æ£€æŸ¥å’Œä¿®å¤æ•°æ®ä¸ä¸€è‡´ã€‚å…·ä½“æ¥è¯´ï¼Œåç†µè¿‡ç¨‹ä¼š<strong>å‘¨æœŸæ€§åœ°æ¯”è¾ƒä¸åŒèŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®å‰¯æœ¬ï¼Œå°†ä¸åŒçš„æ•°æ®å‰¯æœ¬è¿›è¡Œåˆå¹¶ï¼Œä»è€Œå®ç°æ•°æ®çš„ä¸€è‡´æ€§ã€‚</strong></p><p><strong>åç†µè¿‡ç¨‹é€šå¸¸ä¼šä½¿ç”¨Merkleæ ‘æ¥æ£€æµ‹å’Œä¿®å¤æ•°æ®ä¸ä¸€è‡´é—®é¢˜ã€‚</strong></p><p>Merkleæ ‘æ˜¯ä¸€ç§æ ‘å½¢ç»“æ„ï¼Œå®ƒå¯ä»¥ç”¨æ¥éªŒè¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ•°æ®ä¸€è‡´æ€§ã€‚åœ¨Merkleæ ‘ä¸­ï¼Œæ¯ä¸ªå¶å­èŠ‚ç‚¹éƒ½æ˜¯æ•°æ®å—çš„å“ˆå¸Œå€¼ï¼Œæ¯ä¸ªéå¶å­èŠ‚ç‚¹éƒ½æ˜¯å…¶å­èŠ‚ç‚¹å“ˆå¸Œå€¼çš„å“ˆå¸Œå€¼ã€‚é€šè¿‡æ¯”è¾ƒä¸åŒèŠ‚ç‚¹ä¹‹é—´çš„Merkleæ ‘ï¼Œå¯ä»¥å¿«é€Ÿæ£€æµ‹æ•°æ®ä¸ä¸€è‡´çš„ä½ç½®ï¼Œå¹¶å°†ä¸åŒçš„æ•°æ®å—è¿›è¡Œåˆå¹¶ã€‚</p><p>åœ¨åç†µè¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿä¼šå¯¹ä¸åŒèŠ‚ç‚¹ä¹‹é—´çš„Merkleæ ‘è¿›è¡Œæ¯”è¾ƒï¼Œæ£€æµ‹ä¸ä¸€è‡´çš„ä½ç½®ï¼Œå¹¶å°†ä¸åŒçš„æ•°æ®å—è¿›è¡Œåˆå¹¶ã€‚å…·ä½“æ¥è¯´ï¼Œåç†µè¿‡ç¨‹ä¼šå‘¨æœŸæ€§åœ°å¯¹æ‰€æœ‰èŠ‚ç‚¹çš„Merkleæ ‘è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå‘ç°ä¸¤ä¸ªèŠ‚ç‚¹çš„Merkleæ ‘æœ‰ä¸ä¸€è‡´çš„ä½ç½®ï¼Œç³»ç»Ÿä¼šå°†ä¸åŒçš„æ•°æ®å—è¿›è¡Œåˆå¹¶ï¼Œå¹¶æ›´æ–°ç›¸åº”çš„èŠ‚ç‚¹ã€‚</p><p>ä½¿ç”¨Merkleæ ‘æ¥è¿›è¡Œåç†µè¿‡ç¨‹æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š</p><ol><li>é«˜æ•ˆæ€§ï¼šMerkleæ ‘å…·æœ‰é«˜æ•ˆçš„éªŒè¯å’Œåˆå¹¶æ€§èƒ½ï¼Œå¯ä»¥å¿«é€Ÿæ£€æµ‹å’Œä¿®å¤æ•°æ®ä¸ä¸€è‡´é—®é¢˜ã€‚</li><li>å®‰å…¨æ€§ï¼šMerkleæ ‘å¯ä»¥æœ‰æ•ˆåœ°ä¿æŠ¤æ•°æ®çš„å®‰å…¨æ€§ï¼Œå› ä¸ºå¦‚æœä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹çš„æ•°æ®å‘ç”Ÿäº†æ”¹å˜ï¼Œå…¶å¯¹åº”çš„å“ˆå¸Œå€¼ä¹Ÿä¼šå‘ç”Ÿæ”¹å˜ï¼Œä»è€Œå¯¼è‡´æ•´ä¸ªMerkleæ ‘çš„å“ˆå¸Œå€¼å‘ç”Ÿæ”¹å˜ã€‚</li></ol><p>å› æ­¤ï¼ŒMerkleæ ‘æ˜¯åç†µè¿‡ç¨‹ä¸­å¸¸ç”¨çš„æŠ€æœ¯ä¹‹ä¸€ï¼Œå¯ä»¥æœ‰æ•ˆåœ°æ£€æµ‹å’Œä¿®å¤åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ•°æ®ä¸ä¸€è‡´é—®é¢˜ã€‚</p></li></ol><p><strong>Quorumçš„æ•°æ®å†—ä½™æœºåˆ¶ï¼š</strong></p><p>Quorumæ˜¯ä¸€ç§åŸºäºRaftåè®®çš„åˆ†å¸ƒå¼ä¸€è‡´æ€§ç®—æ³•ï¼Œå®ƒå…è®¸åœ¨ä¸€ä¸ªé›†ç¾¤ä¸­åŒæ—¶è¿è¡Œå¤šä¸ªå‰¯æœ¬æ¥æé«˜ç³»ç»Ÿçš„å¯é æ€§å’Œå®¹é”™æ€§ã€‚åœ¨Quorumä¸­ï¼Œæ•°æ®å†—ä½™æœºåˆ¶é€šå¸¸é€šè¿‡å‰¯æœ¬é›†ç¾¤æ¥å®ç°ã€‚</p><p>å…·ä½“æ¥è¯´ï¼ŒQuorumé€šè¿‡å°†æ•°æ®å¤åˆ¶åˆ°å¤šä¸ªèŠ‚ç‚¹æ¥å®ç°æ•°æ®å†—ä½™ã€‚åœ¨ä¸€ä¸ªQuorumé›†ç¾¤ä¸­ï¼Œé€šå¸¸ä¼šæœ‰å¤šä¸ªèŠ‚ç‚¹è¿è¡Œç›¸åŒçš„åº”ç”¨ç¨‹åºï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ½æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå‰¯æœ¬å­˜å‚¨ç›¸åŒçš„æ•°æ®ã€‚è¿™äº›å‰¯æœ¬å¯ä»¥ä¿è¯åœ¨èŠ‚ç‚¹æ•…éšœæˆ–ç½‘ç»œæ•…éšœæ—¶ï¼Œæ•°æ®ä»ç„¶å¯ç”¨ã€‚</p><p>Quorumçš„æ•°æ®å†—ä½™æœºåˆ¶å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ol><li>å¤šå‰¯æœ¬ï¼šæ¯ä¸ªèŠ‚ç‚¹ä¸Šé€šå¸¸ä¼šè¿è¡Œå¤šä¸ªå‰¯æœ¬ï¼Œç¡®ä¿æ•°æ®çš„å¯é æ€§å’Œå®¹é”™æ€§ã€‚</li><li>å¤åˆ¶åŒæ­¥ï¼šQuorumä½¿ç”¨Raftåè®®æ¥ä¿è¯å¤šä¸ªå‰¯æœ¬ä¹‹é—´çš„æ•°æ®åŒæ­¥ï¼Œç¡®ä¿æ¯ä¸ªå‰¯æœ¬éƒ½å­˜å‚¨ç›¸åŒçš„æ•°æ®ã€‚</li><li>å‰¯æœ¬æ•°é‡ï¼šQuorumè¦æ±‚åœ¨é›†ç¾¤ä¸­<strong>è‡³å°‘æœ‰ä¸€åŠä»¥ä¸Šçš„èŠ‚ç‚¹å­˜å‚¨ç›¸åŒçš„æ•°æ®</strong>ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿åœ¨ä¸€å®šç¨‹åº¦ä¸ŠæŠµå¾¡èŠ‚ç‚¹æ•…éšœå’Œç½‘ç»œæ•…éšœã€‚</li><li>å®¹é”™æ€§ï¼šQuorumå¯ä»¥åœ¨èŠ‚ç‚¹æ•…éšœæˆ–ç½‘ç»œæ•…éšœçš„æƒ…å†µä¸‹ç»§ç»­å·¥ä½œï¼Œç¡®ä¿æ•°æ®çš„å¯ç”¨æ€§ã€‚</li></ol><p>é™¤äº†æ•°æ®å†—ä½™æœºåˆ¶ï¼ŒQuorumè¿˜æ”¯æŒå…¶ä»–ä¸€äº›åŠŸèƒ½ï¼Œå¦‚æ•°æ®å¤åˆ¶å’Œæ•°æ®æ¢å¤ã€‚æ•°æ®å¤åˆ¶æ˜¯æŒ‡åœ¨é›†ç¾¤ä¸­å°†æ•°æ®ä»ä¸€ä¸ªèŠ‚ç‚¹å¤åˆ¶åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»¥ç¡®ä¿æ•°æ®çš„å¯é æ€§å’Œå®¹é”™æ€§ã€‚æ•°æ®æ¢å¤æ˜¯æŒ‡åœ¨èŠ‚ç‚¹æ•…éšœæˆ–ç½‘ç»œæ•…éšœçš„æƒ…å†µä¸‹ï¼Œå°†æ•°æ®ä»å¤‡ä»½èŠ‚ç‚¹æ¢å¤åˆ°æ•…éšœèŠ‚ç‚¹ï¼Œä»¥ç¡®ä¿æ•°æ®çš„å¯ç”¨æ€§ã€‚è¿™äº›åŠŸèƒ½éƒ½å¯ä»¥æé«˜Quorumé›†ç¾¤çš„å¯é æ€§å’Œå®¹é”™æ€§ã€‚</p><p>W&gt;N&#x2F;2</p><p>Wå’ŒRé€šå¸¸æ¯”Nå°ï¼ˆå› ä¸ºä¸ºäº†é™ä½å»¶è¿Ÿï¼‰</p><h2 id="3-3-CAPå®šç†"><a href="#3-3-CAPå®šç†" class="headerlink" title="3.3 CAPå®šç†"></a>3.3 CAPå®šç†</h2><p>CAPå®šç†æ˜¯æŒ‡åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰å’Œåˆ†åŒºå®¹é”™æ€§ï¼ˆPartition Toleranceï¼‰è¿™ä¸‰ä¸ªç‰¹æ€§æ— æ³•åŒæ—¶æ»¡è¶³ï¼Œåªèƒ½æ»¡è¶³å…¶ä¸­çš„ä¸¤ä¸ªã€‚</p><p>å…·ä½“æ¥è¯´ï¼š</p><ul><li>ä¸€è‡´æ€§ï¼šæ‰€æœ‰èŠ‚ç‚¹åœ¨åŒä¸€æ—¶åˆ»çœ‹åˆ°çš„æ•°æ®æ˜¯ç›¸åŒçš„ã€‚</li><li>å¯ç”¨æ€§ï¼šå®¢æˆ·ç«¯èƒ½å¤Ÿè·å¾—ç³»ç»Ÿçš„å“åº”ï¼Œå³ä½¿æŸäº›èŠ‚ç‚¹å‡ºç°æ•…éšœã€‚</li><li>åˆ†åŒºå®¹é”™æ€§ï¼šå³ä½¿ç½‘ç»œä¸­æ–­æˆ–èŠ‚ç‚¹æ•…éšœï¼Œç³»ç»Ÿä»èƒ½ç»§ç»­è¿è¡Œã€‚</li></ul><p>CAPå®šç†çš„æ ¸å¿ƒè§‚ç‚¹æ˜¯ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå½“ç½‘ç»œåˆ†åŒºå‘ç”Ÿæ—¶ï¼Œç³»ç»Ÿå¿…é¡»è¦åšå‡ºé€‰æ‹©ï¼šæ˜¯ä¿è¯ä¸€è‡´æ€§è¿˜æ˜¯å¯ç”¨æ€§ã€‚ç”±äºåˆ†å¸ƒå¼ç³»ç»Ÿä¸å¯é¿å…åœ°ä¼šå‘ç”Ÿç½‘ç»œåˆ†åŒºï¼Œå› æ­¤ç³»ç»Ÿå¿…é¡»è¦å®¹å¿åˆ†åŒºï¼Œå¦åˆ™ä¼šå¯¼è‡´ç³»ç»Ÿçš„ä¸å¯ç”¨æ€§ã€‚å› æ­¤ï¼ŒCAPå®šç†çš„å®è´¨æ˜¯ï¼Œåœ¨ç½‘ç»œåˆ†åŒºå‘ç”Ÿæ—¶ï¼Œç³»ç»Ÿå¿…é¡»è¦åœ¨ä¸€è‡´æ€§å’Œå¯ç”¨æ€§ä¹‹é—´åšå‡ºå–èˆã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCAPå®šç†ä¸­æåˆ°çš„ä¸€è‡´æ€§å’Œå¯ç”¨æ€§æ˜¯æŒ‡å¼ºä¸€è‡´æ€§å’Œé«˜å¯ç”¨æ€§ï¼Œè€Œä¸æ˜¯æœ€ç»ˆä¸€è‡´æ€§å’Œå¯æ¥å—çš„å¯ç”¨æ€§ã€‚æœ€ç»ˆä¸€è‡´æ€§æ˜¯æŒ‡åœ¨ä¸€å®šæ—¶é—´å†…ï¼Œç³»ç»Ÿæœ€ç»ˆä¼šè¾¾åˆ°ä¸€è‡´çš„çŠ¶æ€ï¼›è€Œå¯æ¥å—çš„å¯ç”¨æ€§æ˜¯æŒ‡ç³»ç»Ÿå¯ä»¥åœ¨ä¸€å®šæ—¶é—´å†…ä¿è¯å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œä½†å¯èƒ½ä¸æ˜¯å®æ—¶çš„ã€‚</p><p>CAPå®šç†æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿè®¾è®¡å’Œå®ç°çš„åŸºç¡€åŸåˆ™ä¹‹ä¸€ï¼Œå®ƒæé†’æˆ‘ä»¬åœ¨è®¾è®¡åˆ†å¸ƒå¼ç³»ç»Ÿæ—¶è¦å……åˆ†è€ƒè™‘ç³»ç»Ÿçš„ä¸€è‡´æ€§ã€å¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™æ€§ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶æ ¹æ®å…·ä½“éœ€æ±‚è¿›è¡Œå–èˆã€‚</p><p>åœ¨ç½‘ç»œåˆ†åŒºå‘ç”Ÿæ—¶ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿå¯èƒ½æ— æ³•åŒæ—¶æ»¡è¶³é«˜å¯ç”¨æ€§å’Œå¼ºä¸€è‡´æ€§ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å®ç°æœ€ç»ˆä¸€è‡´æ€§æ¥ä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§ï¼Œå¹¶åœ¨ä¸€å®šæ—¶é—´å†…è¾¾åˆ°ä¸€è‡´çš„çŠ¶æ€ã€‚åŒæ—¶ï¼Œå¦‚æœç³»ç»Ÿå¯¹ä¸€è‡´æ€§è¦æ±‚ä¸æ˜¯éå¸¸é«˜ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨å¯æ¥å—çš„å¯ç”¨æ€§æ¥æ»¡è¶³ç³»ç»Ÿçš„éœ€æ±‚ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæœ€ç»ˆä¸€è‡´æ€§å¹¶ä¸æ˜¯ä¸€ä¸ªå…·ä½“çš„ç®—æ³•æˆ–åè®®ï¼Œè€Œæ˜¯ä¸€ç§è®¾è®¡æ€æƒ³æˆ–èŒƒå¼ã€‚ä¸åŒçš„åˆ†å¸ƒå¼ç³»ç»Ÿå¯ä»¥é‡‡ç”¨ä¸åŒçš„æœ€ç»ˆä¸€è‡´æ€§ç­–ç•¥ï¼Œä¾‹å¦‚åŸºäºç‰ˆæœ¬çš„æ§åˆ¶ã€åŸºäºæ—¶é—´æˆ³çš„æ§åˆ¶ã€åŸºäºå‘é‡æ—¶é’Ÿçš„æ§åˆ¶ç­‰ï¼Œæ¥ä¿è¯æ•°æ®åœ¨ä¸åŒèŠ‚ç‚¹ä¹‹é—´çš„æœ€ç»ˆä¸€è‡´æ€§ã€‚</p><p><strong>æ„ä¹‰ï¼š</strong></p><ul><li>ç³»ç»Ÿå¼€å‘éœ€è¦å–èˆï¼ä¸å­˜åœ¨å®Œç¾çš„ç³»ç»Ÿï¼</li><li>CP</li><li>AP</li></ul><h3 id="3-3-1-PACELCå®šç†"><a href="#3-3-1-PACELCå®šç†" class="headerlink" title="3.3.1 PACELCå®šç†"></a>3.3.1 PACELCå®šç†</h3><p><a href="https://zhuanlan.zhihu.com/p/348923238">åˆ†å¸ƒå¼ç†è®º PACELC äº†è§£ä¹ˆï¼Ÿ - çŸ¥ä¹ (zhihu.com)</a></p><p>PACELCå®šç†æ˜¯æŒ‡ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰ã€åˆ†åŒºå®¹é”™æ€§ï¼ˆPartition toleranceï¼‰ä¸‰è€…ä¸å¯åŒæ—¶å…¼å¤‡ï¼Œåªèƒ½é€‰æ‹©å…¶ä¸­çš„ä¸¤é¡¹ã€‚</p><p>PACELCå®šç†æ˜¯åŸºäºCAPå®šç†å‘å±•è€Œæ¥çš„ã€‚CAPå®šç†æŒ‡å‡ºï¼Œåœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒConsistencyï¼ˆä¸€è‡´æ€§ï¼‰ã€Availabilityï¼ˆå¯ç”¨æ€§ï¼‰ã€Partition toleranceï¼ˆåˆ†åŒºå®¹é”™æ€§ï¼‰è¿™ä¸‰ä¸ªå› ç´ ä¸å¯åŒæ—¶ä¿è¯ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿå‡ºç°ç½‘ç»œåˆ†åŒºæ—¶ï¼Œå¿…é¡»é€‰æ‹©æ”¾å¼ƒä¸€è‡´æ€§è¿˜æ˜¯å¯ç”¨æ€§ä¸­çš„ä¸€é¡¹ï¼Œä»¥ä¿è¯ç³»ç»Ÿçš„å¯é æ€§ã€‚</p><p>PACELCå®šç†æ˜¯å¯¹CAPå®šç†çš„è¿›ä¸€æ­¥æ‰©å±•å’Œç»†åŒ–ï¼Œå°†ä¸€è‡´æ€§è¿›ä¸€æ­¥åˆ’åˆ†ä¸ºäº†å¼ºä¸€è‡´æ€§ï¼ˆStrong Consistencyï¼‰å’Œå¼±ä¸€è‡´æ€§ï¼ˆWeak Consistencyï¼‰ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šæå‡ºäº†ä¸‰ç§æƒ…å†µï¼šå½“å‡ºç°ç½‘ç»œåˆ†åŒºæ—¶ï¼Œç³»ç»Ÿåªèƒ½ä¿è¯ä¸¤é¡¹ä¸­çš„å…¶ä¸­ä¹‹ä¸€ï¼Œè€Œå…·ä½“ä¿è¯å“ªä¸¤é¡¹åˆ™å–å†³äºåˆ†å¸ƒå¼ç³»ç»Ÿçš„è®¾è®¡å’Œåº”ç”¨åœºæ™¯ã€‚</p><p>å…·ä½“æ¥è¯´ï¼ŒPACELCå®šç†è®¤ä¸ºï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå½“å‘ç”Ÿç½‘ç»œåˆ†åŒºæ—¶ï¼Œå¯ä»¥é€‰æ‹©ä»¥ä¸‹ä¸‰ç§ç­–ç•¥ï¼š</p><ol><li>ä¿è¯åˆ†åŒºå®¹é”™æ€§å’Œå¼ºä¸€è‡´æ€§ï¼Œæ”¾å¼ƒå¯ç”¨æ€§ï¼ˆPA&#x2F;ECï¼‰ï¼šè¿™ç§æƒ…å†µä¸‹ï¼Œç³»ç»Ÿä¼šåœ¨ç½‘ç»œåˆ†åŒºå‘ç”Ÿæ—¶ï¼Œåœæ­¢æ¥å—è¯·æ±‚ï¼Œä»¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚</li><li>ä¿è¯åˆ†åŒºå®¹é”™æ€§å’Œå¯ç”¨æ€§ï¼Œæ”¾å¼ƒå¼ºä¸€è‡´æ€§ï¼ˆPA&#x2F;ELï¼‰ï¼šè¿™ç§æƒ…å†µä¸‹ï¼Œç³»ç»Ÿä¼šå…è®¸ä¸åŒèŠ‚ç‚¹çš„æ•°æ®å‡ºç°çŸ­æ—¶é—´çš„ä¸ä¸€è‡´ï¼Œä»¥ä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚</li><li>ä¿è¯å¯ç”¨æ€§å’Œå¼ºä¸€è‡´æ€§ï¼Œæ”¾å¼ƒåˆ†åŒºå®¹é”™æ€§ï¼ˆCA&#x2F;ELï¼‰ï¼šè¿™ç§æƒ…å†µä¸‹ï¼Œç³»ç»Ÿä¼šåœ¨ç½‘ç»œåˆ†åŒºå‘ç”Ÿæ—¶ï¼Œä»ç„¶ç»§ç»­æ¥å—è¯·æ±‚ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´èŠ‚ç‚¹ä¹‹é—´çš„æ•°æ®ä¸ä¸€è‡´ï¼Œä»¥ä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œæ•°æ®çš„ä¸€è‡´æ€§ã€‚</li></ol><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé€‰æ‹©å“ªç§ç­–ç•¥å–å†³äºå…·ä½“çš„åº”ç”¨åœºæ™¯å’Œéœ€æ±‚ï¼Œéœ€è¦æ ¹æ®ç³»ç»Ÿçš„æ€§èƒ½è¦æ±‚ã€å¯ç”¨æ€§è¦æ±‚ã€æ•°æ®ä¸€è‡´æ€§è¦æ±‚ä»¥åŠæˆæœ¬ç­‰å› ç´ è¿›è¡Œæƒè¡¡å’Œé€‰æ‹©ã€‚</p><h3 id="3-3-2-BASE"><a href="#3-3-2-BASE" class="headerlink" title="3.3.2 BASE"></a>3.3.2 BASE</h3><p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸Šä¸‹æ–‡ä¸­ï¼ŒBASE æ˜¯ â€œBasically Available, Soft state, Eventually consistentâ€ çš„ç¼©å†™ã€‚è¿™æ˜¯ä¸€ç»„åŸåˆ™ï¼Œå¯ç”¨äºè®¾è®¡å’Œå®ç°åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œä¼˜å…ˆè€ƒè™‘å¯ç”¨æ€§å’Œåˆ†åŒºå®¹å¿æ€§ï¼Œè€Œä¸æ˜¯å¼ºä¸€è‡´æ€§ã€‚</p><p>Basically Available æŒ‡çš„æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿåº”å§‹ç»ˆèƒ½å¤Ÿå“åº”å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå³ä½¿ç³»ç»Ÿé‡åˆ°æ•…éšœæˆ–ç½‘ç»œåˆ†åŒºã€‚Soft state æŒ‡çš„æ˜¯ç³»ç»ŸçŠ¶æ€éšæ—¶é—´å˜åŒ–çš„æƒ³æ³•ï¼Œåªè¦å˜åŒ–ä¸æ˜¯å…³é”®çš„ï¼Œç³»ç»Ÿæœ€ç»ˆèƒ½å¤Ÿæ”¶æ•›åˆ°ä¸€è‡´çš„çŠ¶æ€ï¼Œå°±æ˜¯å¯æ¥å—çš„ã€‚Eventually consistent æŒ‡çš„æ˜¯åœ¨è¶³å¤Ÿçš„æ—¶é—´å’Œé€‚å½“çš„åŒæ­¥ä¸‹ï¼Œç³»ç»Ÿæœ€ç»ˆä¼šåœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šå˜å¾—ä¸€è‡´ã€‚</p><p>ä¸ä¼˜å…ˆè€ƒè™‘å¼ºä¸€è‡´æ€§çš„ ACIDï¼ˆåŸå­æ€§ï¼Œä¸€è‡´æ€§ï¼Œéš”ç¦»æ€§ï¼ŒæŒä¹…æ€§ï¼‰åŸåˆ™ä¸åŒï¼ŒBASE æ˜¯ä¸€ç§æ›´ä¸ºæ¾æ•£çš„æ–¹æ³•ï¼Œå¯ä»¥åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å®ç°æ›´é«˜çš„å¯ç”¨æ€§å’Œå¯ä¼¸ç¼©æ€§ï¼Œä½†ä»£ä»·æ˜¯ä¸€äº›ä¸€è‡´æ€§ä¸Šçš„æƒè¡¡ã€‚</p><h2 id="3-4-ä¸€è‡´æ€§æ¨¡å‹"><a href="#3-4-ä¸€è‡´æ€§æ¨¡å‹" class="headerlink" title="3.4 ä¸€è‡´æ€§æ¨¡å‹"></a>3.4 ä¸€è‡´æ€§æ¨¡å‹</h2><p>ä¸€è‡´æ€§æ¨¡å‹æ˜¯æŒ‡åœ¨åˆ†å¸ƒå¼è®¡ç®—ä¸­ï¼Œç¡®ä¿å¤šä¸ªèŠ‚ç‚¹ä¹‹é—´æ•°æ®çš„ä¸€è‡´æ€§å’Œå¯é æ€§çš„æ¨¡å‹ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒèŠ‚ç‚¹å¯èƒ½ä¼šåŒæ—¶è¯»å–å’Œå†™å…¥å…±äº«æ•°æ®ï¼Œå› æ­¤å¿…é¡»ç¡®ä¿åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šæ•°æ®çš„çŠ¶æ€æ˜¯ä¸€è‡´çš„ã€‚</p><p>å¸¸è§çš„ä¸€è‡´æ€§æ¨¡å‹åŒ…æ‹¬ï¼š</p><ol><li>å¼ºä¸€è‡´æ€§æ¨¡å‹ï¼ˆçº¿æ€§ä¸€è‡´æ€§ï¼‰ï¼šåœ¨ä»»ä½•æ—¶å€™ï¼Œæ‰€æœ‰èŠ‚ç‚¹éƒ½èƒ½å¤Ÿè¯»å–åˆ°ç›¸åŒçš„æ•°æ®ã€‚å¼ºä¸€è‡´æ€§æ¨¡å‹å¯ä»¥ä¿è¯æ•°æ®çš„å®Œå…¨ä¸€è‡´æ€§ï¼Œä½†å¯èƒ½ä¼šå½±å“ç³»ç»Ÿçš„æ€§èƒ½ã€‚</li><li>å¼±ä¸€è‡´æ€§æ¨¡å‹ï¼šåœ¨ä»»ä½•æ—¶å€™ï¼Œä¸åŒèŠ‚ç‚¹è¯»å–åˆ°çš„æ•°æ®å¯èƒ½ä¼šä¸ä¸€æ ·ã€‚å¼±ä¸€è‡´æ€§æ¨¡å‹é€šå¸¸å¯ä»¥æé«˜ç³»ç»Ÿçš„æ€§èƒ½ï¼Œä½†éœ€è¦æ›´å¤æ‚çš„ç®—æ³•æ¥ç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§ã€‚</li><li>æœ€ç»ˆä¸€è‡´æ€§æ¨¡å‹ï¼šåœ¨ä¸€å®šæ—¶é—´å†…ï¼Œæ‰€æœ‰èŠ‚ç‚¹æœ€ç»ˆéƒ½èƒ½å¤Ÿè¯»å–åˆ°ç›¸åŒçš„æ•°æ®ã€‚æœ€ç»ˆä¸€è‡´æ€§æ¨¡å‹é€šå¸¸æ˜¯å¼±ä¸€è‡´æ€§æ¨¡å‹å’Œå¼ºä¸€è‡´æ€§æ¨¡å‹ä¹‹é—´çš„ä¸€ç§å¦¥åæ–¹æ¡ˆã€‚</li></ol><p>ä¸€è‡´æ€§æ¨¡å‹çš„é€‰æ‹©å–å†³äºç³»ç»Ÿçš„éœ€æ±‚å’Œè®¾è®¡ç›®æ ‡ï¼Œéœ€è¦ç»¼åˆè€ƒè™‘ç³»ç»Ÿçš„æ€§èƒ½ã€å¯é æ€§ã€ä¸€è‡´æ€§å’Œå¯æ‰©å±•æ€§ç­‰æ–¹é¢ã€‚</p><h3 id="3-4-1-çº¿æ€§ä¸€è‡´æ€§æ¨¡å‹"><a href="#3-4-1-çº¿æ€§ä¸€è‡´æ€§æ¨¡å‹" class="headerlink" title="3.4.1 çº¿æ€§ä¸€è‡´æ€§æ¨¡å‹"></a>3.4.1 çº¿æ€§ä¸€è‡´æ€§æ¨¡å‹</h3><p>çº¿æ€§ä¸€è‡´æ€§æ¨¡å‹æ˜¯ä¸€ç§å¼ºä¸€è‡´æ€§æ¨¡å‹ï¼Œå®ƒä¿è¯åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æ‰€æœ‰èŠ‚ç‚¹è¯»å–åˆ°çš„æ•°æ®æ˜¯ä¸€è‡´çš„ï¼Œå³å¦‚æœä¸€ä¸ªèŠ‚ç‚¹åœ¨æ—¶é—´è½´ä¸Šæ¯”å¦ä¸€ä¸ªèŠ‚ç‚¹å…ˆå†™å…¥æ•°æ®ï¼Œåˆ™å…ˆå†™å…¥çš„æ•°æ®ä¸€å®šå…ˆäºåå†™å…¥çš„æ•°æ®è¢«è¯»å–åˆ°ã€‚çº¿æ€§ä¸€è‡´æ€§æ¨¡å‹æ˜¯å¯¹å¼ºä¸€è‡´æ€§æ¨¡å‹çš„ä¸€ç§åŠ å¼ºå½¢å¼ï¼Œå®ƒè¦æ±‚æ‰€æœ‰èŠ‚ç‚¹è¯»å–åˆ°çš„æ•°æ®çš„é¡ºåºä¸å®ƒä»¬å†™å…¥çš„é¡ºåºä¸€è‡´ï¼Œå³æ•°æ®çš„å…¨å±€é¡ºåºä¸å®ƒä»¬çš„æ—¶é—´æˆ³æœ‰å…³ã€‚</p><p>çº¿æ€§ä¸€è‡´æ€§æ¨¡å‹çš„å®ç°é€šå¸¸éœ€è¦ä½¿ç”¨ä¸€äº›ç‰¹æ®Šçš„ç®—æ³•å’ŒæŠ€æœ¯ï¼Œä¾‹å¦‚åŸºäºå‘é‡æ—¶é’Ÿï¼ˆvector clockï¼‰çš„æ•°æ®ç‰ˆæœ¬æ§åˆ¶æœºåˆ¶ã€åˆ†å¸ƒå¼é”æœºåˆ¶ç­‰ã€‚è¿™äº›æŠ€æœ¯å¯ä»¥ç¡®ä¿æ‰€æœ‰èŠ‚ç‚¹è¯»å–åˆ°çš„æ•°æ®çš„é¡ºåºæ˜¯ä¸€è‡´çš„ï¼ŒåŒæ—¶è¿˜å¯ä»¥ä¿è¯ç³»ç»Ÿçš„æ€§èƒ½å’Œå¯æ‰©å±•æ€§ã€‚</p><p>çº¿æ€§ä¸€è‡´æ€§æ¨¡å‹é€šå¸¸ç”¨äºéœ€è¦å¼ºä¸€è‡´æ€§ä¿è¯çš„åˆ†å¸ƒå¼åº”ç”¨ï¼Œä¾‹å¦‚é‡‘èäº¤æ˜“ç³»ç»Ÿã€åœ¨çº¿æ¸¸æˆç­‰ã€‚</p><p><strong>å‘é‡æ—¶é’Ÿï¼š</strong></p><p>å‘é‡æ—¶é’Ÿæ˜¯ä¸€ç§ç”¨äºåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ç»´æŠ¤äº‹ä»¶é¡ºåºçš„æ•°æ®ç»“æ„ã€‚å®ƒå¯ä»¥å¸®åŠ©åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ä¸åŒèŠ‚ç‚¹ç¡®å®šäº‹ä»¶çš„å…ˆåé¡ºåºï¼Œå¹¶ä¿è¯åœ¨ä¸åŒèŠ‚ç‚¹ä¸­çš„æ—¶é—´æˆ³çš„ä¸€è‡´æ€§ã€‚</p><p>å‘é‡æ—¶é’Ÿçš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šæ¯ä¸ªèŠ‚ç‚¹éƒ½ç»´æŠ¤ä¸€ä¸ªå‘é‡ï¼Œå‘é‡çš„é•¿åº¦ç­‰äºèŠ‚ç‚¹çš„æ•°é‡ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„å‘é‡å…ƒç´ è¡¨ç¤ºè¯¥èŠ‚ç‚¹ä¸Šçš„äº‹ä»¶æ•°ç›®ã€‚å½“èŠ‚ç‚¹ä¸Šå‘ç”Ÿä¸€ä¸ªäº‹ä»¶æ—¶ï¼Œå®ƒä¼šå°†è¯¥èŠ‚ç‚¹çš„å‘é‡å…ƒç´ åŠ 1ï¼Œå¹¶å°†æ•´ä¸ªå‘é‡å‘é€ç»™å…¶å®ƒèŠ‚ç‚¹ã€‚æ¥æ”¶åˆ°å‘é‡åï¼ŒèŠ‚ç‚¹ä¼šå°†å®ƒçš„æœ¬åœ°å‘é‡ä¸æ¥æ”¶åˆ°çš„å‘é‡è¿›è¡Œåˆå¹¶ï¼Œå¹¶æ›´æ–°æœ¬åœ°å‘é‡çš„å…ƒç´ å€¼ï¼Œä»¥åæ˜ å‡ºå…¶å®ƒèŠ‚ç‚¹ä¸Šå‘ç”Ÿçš„äº‹ä»¶æƒ…å†µã€‚è¿™æ ·ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥é€šè¿‡æ¯”è¾ƒå‘é‡æ¥åˆ¤æ–­äº‹ä»¶çš„å…ˆåé¡ºåºã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œå¦‚æœå‘é‡Vå’ŒWéƒ½æ˜¯èŠ‚ç‚¹æ•°ä¸ºNçš„å‘é‡æ—¶é’Ÿï¼Œåˆ™V &lt;&#x3D; Wçš„å«ä¹‰æ˜¯Vä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½å°äºç­‰äºWä¸­å¯¹åº”å…ƒç´ ã€‚å¦‚æœV &lt;&#x3D; Wå¹¶ä¸”W &lt;&#x3D; Vï¼Œåˆ™Vå’ŒWæ˜¯ç›¸ç­‰çš„ã€‚å½“å‘é‡Vå’ŒWä¸ç›¸ç­‰æ—¶ï¼Œå°±å¯ä»¥æ ¹æ®å®ƒä»¬çš„æ¯”è¾ƒç»“æœæ¥åˆ¤æ–­äº‹ä»¶çš„å…ˆåé¡ºåºã€‚</p><p>å‘é‡æ—¶é’Ÿé€šå¸¸ç”¨äºå®ç°ä¸€äº›éœ€è¦ç»´æŠ¤äº‹ä»¶é¡ºåºçš„åˆ†å¸ƒå¼åº”ç”¨ï¼Œä¾‹å¦‚åˆ†å¸ƒå¼æ•°æ®åº“ç³»ç»Ÿã€åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€åˆ†å¸ƒå¼å…±è¯†ç®—æ³•ç­‰ã€‚</p><p><strong>åˆ†å¸ƒå¼é”ï¼š</strong></p><p>åˆ†å¸ƒå¼é”æ˜¯ä¸€ç§åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å®ç°äº’æ–¥è®¿é—®çš„æœºåˆ¶ï¼Œå®ƒå¯ä»¥å¸®åŠ©ä¸åŒèŠ‚ç‚¹ä¹‹é—´åè°ƒå¹¶å‘æ“ä½œï¼Œé¿å…å‡ºç°å†²çªå’Œç«äº‰æ¡ä»¶ã€‚</p><p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¤šä¸ªèŠ‚ç‚¹å¯èƒ½åŒæ—¶è®¿é—®å…±äº«èµ„æºï¼Œä¾‹å¦‚æ•°æ®åº“ã€æ–‡ä»¶ç³»ç»Ÿç­‰ã€‚ä¸ºäº†é¿å…å¤šä¸ªèŠ‚ç‚¹åŒæ—¶ä¿®æ”¹åŒä¸€ä»½æ•°æ®ï¼Œéœ€è¦ä½¿ç”¨åˆ†å¸ƒå¼é”æ¥ä¿è¯èµ„æºçš„äº’æ–¥è®¿é—®ã€‚å½“ä¸€ä¸ªèŠ‚ç‚¹æƒ³è¦è®¿é—®å…±äº«èµ„æºæ—¶ï¼Œå®ƒéœ€è¦å…ˆè·å–ä¸€ä¸ªåˆ†å¸ƒå¼é”ï¼Œç¡®ä¿å…¶ä»–èŠ‚ç‚¹ä¸èƒ½åŒæ—¶è®¿é—®è¯¥èµ„æºã€‚å½“èŠ‚ç‚¹å®Œæˆæ“ä½œåï¼Œéœ€è¦é‡Šæ”¾é”ï¼Œä»¥å…è®¸å…¶ä»–èŠ‚ç‚¹ç»§ç»­è®¿é—®èµ„æºã€‚</p><p>å®ç°åˆ†å¸ƒå¼é”çš„æ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œå…¶ä¸­æ¯”è¾ƒå¸¸è§çš„åŒ…æ‹¬ï¼š</p><ol><li>åŸºäºæ•°æ®åº“å®ç°çš„åˆ†å¸ƒå¼é”ï¼šå°†é”çŠ¶æ€ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼ŒèŠ‚ç‚¹éœ€è¦å…ˆè·å–æ•°æ®åº“çš„ä¸€ä¸ªæ’ä»–é”ï¼Œæ‰èƒ½å¯¹é”è¿›è¡Œæ“ä½œã€‚</li><li>åŸºäºZooKeeperå®ç°çš„åˆ†å¸ƒå¼é”ï¼šåˆ©ç”¨ZooKeeperæä¾›çš„åŸå­æ“ä½œå’Œä¸´æ—¶èŠ‚ç‚¹æœºåˆ¶ï¼Œå®ç°åˆ†å¸ƒå¼é”ã€‚</li><li>åŸºäºRediså®ç°çš„åˆ†å¸ƒå¼é”ï¼šåˆ©ç”¨Redisæä¾›çš„SETNXå‘½ä»¤å’Œexpireå‘½ä»¤ï¼Œå®ç°åˆ†å¸ƒå¼é”ã€‚</li></ol><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä½¿ç”¨åˆ†å¸ƒå¼é”æ—¶ï¼Œéœ€è¦è€ƒè™‘é”çš„ç²’åº¦å’Œæ€§èƒ½ç­‰é—®é¢˜ã€‚å¦‚æœé”çš„ç²’åº¦è¿‡å¤§ï¼Œå¯èƒ½ä¼šå¯¼è‡´é”ç«äº‰å’Œæ€§èƒ½ç“¶é¢ˆï¼›å¦‚æœé”çš„ç²’åº¦è¿‡å°ï¼Œå¯èƒ½ä¼šå¯¼è‡´é”å†²çªå’Œæ­»é”ç­‰é—®é¢˜ã€‚å› æ­¤ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œéœ€è¦æ ¹æ®å…·ä½“æƒ…å†µé€‰æ‹©åˆé€‚çš„é”ç²’åº¦ï¼Œå¹¶è¿›è¡Œæ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–ã€‚</p><p><a href="https://blog.csdn.net/m0_67645544/article/details/124768505?ops_request_misc=%7B%22request_id%22:%22168594407216800192234961%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168594407216800192234961&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-124768505-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81&spm=1018.2226.3001.4187">(459æ¡æ¶ˆæ¯) ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼é”ï¼Ÿå‡ ç§åˆ†å¸ƒå¼é”åˆ†åˆ«æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ_Javaåç«¯æ¶æ„çŒ›çŒ›çš„åšå®¢-CSDNåšå®¢</a></p><h3 id="3-4-2-çº¿æ€§ä¸€è‡´æ€§çš„ä»£ä»·"><a href="#3-4-2-çº¿æ€§ä¸€è‡´æ€§çš„ä»£ä»·" class="headerlink" title="3.4.2 çº¿æ€§ä¸€è‡´æ€§çš„ä»£ä»·"></a>3.4.2 çº¿æ€§ä¸€è‡´æ€§çš„ä»£ä»·</h3><p>çº¿æ€§ä¸€è‡´æ€§é€šå¸¸éœ€è¦ä»˜å‡ºè¾ƒé«˜çš„ä»£ä»·ï¼Œå› ä¸ºè¦ä¿è¯æ•°æ®çš„å…¨å±€é¡ºåºä¸€è‡´æ€§ï¼Œéœ€è¦ç‰ºç‰²ä¸€å®šçš„å¯ç”¨æ€§å’Œå»¶è¿Ÿã€‚</p><p>åœ¨å®ç°çº¿æ€§ä¸€è‡´æ€§æ—¶ï¼Œéœ€è¦è€ƒè™‘ä»¥ä¸‹å‡ ä¸ªæ–¹é¢çš„ä»£ä»·ï¼š</p><ol><li>é€šä¿¡ä»£ä»·ï¼šä¸ºäº†ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œéœ€è¦ä¸æ–­è¿›è¡ŒèŠ‚ç‚¹é—´çš„é€šä¿¡å’ŒåŒæ­¥æ“ä½œï¼Œè¿™ä¼šå¢åŠ ç½‘ç»œå¸¦å®½çš„ä½¿ç”¨å’Œå»¶è¿Ÿã€‚</li><li>ååé‡ä»£ä»·ï¼šç”±äºè¦å¯¹æ‰€æœ‰çš„æ“ä½œè¿›è¡Œå…¨å±€æ’åºï¼Œéœ€è¦åœ¨æ•´ä¸ªç³»ç»ŸèŒƒå›´å†…åè°ƒæ‰€æœ‰èŠ‚ç‚¹çš„æ“ä½œï¼Œè¿™ä¼šå¯¹ç³»ç»Ÿçš„ååé‡äº§ç”Ÿå½±å“ã€‚</li><li>å¯ç”¨æ€§ä»£ä»·ï¼šåœ¨å®ç°çº¿æ€§ä¸€è‡´æ€§æ—¶ï¼Œå¦‚æœæŸä¸ªèŠ‚ç‚¹å‘ç”Ÿæ•…éšœï¼Œä¼šå½±å“æ•´ä¸ªç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚å› æ­¤ï¼Œåœ¨å®ç°çº¿æ€§ä¸€è‡´æ€§æ—¶ï¼Œéœ€è¦é‡‡å–ä¸€äº›æœºåˆ¶æ¥ä¿è¯æ•…éšœæ—¶çš„å®¹é”™å’Œæ¢å¤èƒ½åŠ›ã€‚</li><li>æ€§èƒ½ä»£ä»·ï¼šç”±äºè¦ä¿è¯å…¨å±€é¡ºåºä¸€è‡´æ€§ï¼Œç³»ç»Ÿå¯èƒ½éœ€è¦è¿›è¡Œå¤šè½®æ“ä½œå’Œåè°ƒï¼Œè¿™ä¼šå¢åŠ ç³»ç»Ÿçš„å»¶è¿Ÿå’Œå“åº”æ—¶é—´ã€‚</li></ol><p>å› æ­¤ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ï¼Œéœ€è¦æ ¹æ®å…·ä½“éœ€æ±‚å’Œåœºæ™¯ï¼Œç»¼åˆè€ƒè™‘å„ç§ä»£ä»·ï¼Œé€‰æ‹©åˆé€‚çš„ä¸€è‡´æ€§æ¨¡å‹å’Œå®ç°æ–¹å¼ï¼Œä»¥è¾¾åˆ°æœ€ä¼˜çš„æ€§èƒ½å’Œå¯ç”¨æ€§ã€‚</p><h3 id="3-4-3-é¡ºåºä¸€è‡´æ€§"><a href="#3-4-3-é¡ºåºä¸€è‡´æ€§" class="headerlink" title="3.4.3 é¡ºåºä¸€è‡´æ€§"></a>3.4.3 é¡ºåºä¸€è‡´æ€§</h3><p>é¡ºåºä¸€è‡´æ€§æ˜¯ä¸€ç§å¼±ä¸€è‡´æ€§æ¨¡å‹ï¼Œå®ƒè¦æ±‚ç³»ç»Ÿçš„æ“ä½œæŒ‰ç…§æäº¤çš„é¡ºåºæ‰§è¡Œï¼Œä½†ä¸è¦æ±‚æ‰€æœ‰èŠ‚ç‚¹éƒ½çœ‹åˆ°ç›¸åŒçš„æ‰§è¡Œé¡ºåºã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œå¯¹äºä»»æ„ä¸¤ä¸ªæ“ä½œï¼Œå¦‚æœå®ƒä»¬åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šæ‰§è¡Œå¹¶ä¸”æäº¤çš„é¡ºåºæ˜¯ç›¸åŒçš„ï¼Œåˆ™åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šçš„æ‰§è¡Œé¡ºåºå¿…é¡»ä¿æŒä¸€è‡´ã€‚ä½†æ˜¯ï¼Œå¦‚æœä¸¤ä¸ªæ“ä½œåœ¨ä¸åŒèŠ‚ç‚¹ä¸Šæ‰§è¡Œï¼Œåˆ™å¯èƒ½å­˜åœ¨ä¸åŒçš„æ‰§è¡Œé¡ºåºï¼Œå³å­˜åœ¨å¹¶å‘æ‰§è¡Œçš„å¯èƒ½æ€§ã€‚å› æ­¤ï¼Œé¡ºåºä¸€è‡´æ€§ä¿è¯äº†æ“ä½œçš„æœ‰åºæ€§ï¼Œä½†æ˜¯ä¸ä¿è¯å…¨å±€çš„ä¸€è‡´æ€§ã€‚</p><p>åœ¨å®ç°é¡ºåºä¸€è‡´æ€§æ—¶ï¼Œç³»ç»Ÿå¯ä»¥é‡‡ç”¨ä¸€äº›æœºåˆ¶æ¥ä¿è¯æ“ä½œçš„æœ‰åºæ€§ï¼Œä¾‹å¦‚å¯¹æ“ä½œè¿›è¡Œæ—¶é—´æˆ³æˆ–åºåˆ—å·æ ‡è®°ï¼Œæˆ–è€…é‡‡ç”¨åŸºäºå‘é‡æ—¶é’Ÿçš„ç®—æ³•æ¥å®ç°ã€‚</p><p>ç›¸å¯¹äºçº¿æ€§ä¸€è‡´æ€§æ¥è¯´ï¼Œé¡ºåºä¸€è‡´æ€§çš„ä»£ä»·è¾ƒä½ï¼Œå› ä¸ºå®ƒä¸éœ€è¦ä¿è¯æ‰€æœ‰èŠ‚ç‚¹éƒ½çœ‹åˆ°ç›¸åŒçš„æ‰§è¡Œé¡ºåºã€‚å› æ­¤ï¼Œé¡ºåºä¸€è‡´æ€§é€šå¸¸ç”¨äºä¸€äº›å¯¹ä¸€è‡´æ€§è¦æ±‚ä¸æ˜¯ç‰¹åˆ«é«˜çš„åœºæ™¯ï¼Œä¾‹å¦‚ç¤¾äº¤ç½‘ç»œåº”ç”¨ã€åœ¨çº¿æ¸¸æˆç­‰ã€‚</p><h3 id="3-4-4-å› æœä¸€è‡´æ€§ï¼ˆå¾®ä¿¡æœ‹å‹åœˆï¼‰"><a href="#3-4-4-å› æœä¸€è‡´æ€§ï¼ˆå¾®ä¿¡æœ‹å‹åœˆï¼‰" class="headerlink" title="3.4.4 å› æœä¸€è‡´æ€§ï¼ˆå¾®ä¿¡æœ‹å‹åœˆï¼‰"></a>3.4.4 å› æœä¸€è‡´æ€§ï¼ˆå¾®ä¿¡æœ‹å‹åœˆï¼‰</h3><p>å› æœä¸€è‡´æ€§æ˜¯ä¸€ç§å¼±ä¸€è‡´æ€§æ¨¡å‹ï¼Œå®ƒè¦æ±‚ç³»ç»Ÿçš„æ“ä½œæŒ‰ç…§å› æœå…³ç³»æ‰§è¡Œï¼Œå³å¦‚æœä¸€ä¸ªæ“ä½œAåœ¨å¦ä¸€ä¸ªæ“ä½œBä¹‹å‰å‘ç”Ÿï¼Œé‚£ä¹ˆæ“ä½œBåœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šçš„æ‰§è¡Œå¿…é¡»åœ¨æ“ä½œAä¹‹åã€‚è¿™æ„å‘³ç€ï¼Œå› æœä¸€è‡´æ€§å¯ä»¥ä¿è¯æ“ä½œçš„æœ‰åºæ€§å’Œå› æœå…³ç³»ï¼Œä½†ä¸è¦æ±‚æ‰€æœ‰èŠ‚ç‚¹éƒ½çœ‹åˆ°ç›¸åŒçš„æ‰§è¡Œé¡ºåºã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œå› æœä¸€è‡´æ€§è¦æ±‚ç³»ç»Ÿä¸­çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½æŒ‰ç…§ç›¸åŒçš„å› æœé¡ºåºæ‰§è¡Œæ“ä½œã€‚åœ¨å®ç°å› æœä¸€è‡´æ€§æ—¶ï¼Œé€šå¸¸é‡‡ç”¨å‘é‡æ—¶é’Ÿæˆ–å…¶ä»–ç±»ä¼¼çš„æœºåˆ¶æ¥ç»´æŠ¤æ“ä½œçš„å› æœå…³ç³»ã€‚</p><p>å› æœä¸€è‡´æ€§ç›¸å¯¹äºçº¿æ€§ä¸€è‡´æ€§å’Œé¡ºåºä¸€è‡´æ€§æ¥è¯´ï¼Œä»£ä»·æ›´ä½ï¼Œå› ä¸ºå®ƒä¸éœ€è¦å¯¹æ‰€æœ‰æ“ä½œè¿›è¡Œå…¨å±€æ’åºï¼Œåªéœ€è¦ä¿è¯æ“ä½œçš„å› æœå…³ç³»å³å¯ã€‚å› æ­¤ï¼Œå› æœä¸€è‡´æ€§é€šå¸¸ç”¨äºä¸€äº›å¯¹ä¸€è‡´æ€§è¦æ±‚ä¸æ˜¯ç‰¹åˆ«é«˜çš„åœºæ™¯ï¼Œä¾‹å¦‚åˆ†å¸ƒå¼æ—¥å¿—ç³»ç»Ÿã€åˆ†å¸ƒå¼æ•°æ®åº“ç­‰ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå› æœä¸€è‡´æ€§ä»…ä»…ä¿è¯äº†æ“ä½œçš„å› æœå…³ç³»å’Œæœ‰åºæ€§ï¼Œè€Œä¸ä¿è¯æ“ä½œçš„ç»“æœå’Œå€¼ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨å› æœä¸€è‡´æ€§æ—¶ï¼Œéœ€è¦è€ƒè™‘æ•°æ®ä¸€è‡´æ€§å’Œå¯ç”¨æ€§ç­‰æ–¹é¢çš„é—®é¢˜ã€‚</p><h3 id="3-4-5-æœ€ç»ˆä¸€è‡´æ€§ï¼ˆæœç´¢å¼•æ“ã€ç¤¾äº¤ç½‘ç»œï¼‰"><a href="#3-4-5-æœ€ç»ˆä¸€è‡´æ€§ï¼ˆæœç´¢å¼•æ“ã€ç¤¾äº¤ç½‘ç»œï¼‰" class="headerlink" title="3.4.5 æœ€ç»ˆä¸€è‡´æ€§ï¼ˆæœç´¢å¼•æ“ã€ç¤¾äº¤ç½‘ç»œï¼‰"></a>3.4.5 æœ€ç»ˆä¸€è‡´æ€§ï¼ˆæœç´¢å¼•æ“ã€ç¤¾äº¤ç½‘ç»œï¼‰</h3><p>æœ€ç»ˆä¸€è‡´æ€§æ˜¯ä¸€ç§å¼±ä¸€è‡´æ€§æ¨¡å‹ï¼Œå®ƒå…è®¸ç³»ç»Ÿä¸­çš„ä¸åŒèŠ‚ç‚¹åœ¨ä¸€æ®µæ—¶é—´å†…ä¿æŒæ•°æ®çš„ä¸ä¸€è‡´æ€§ï¼Œä½†æœ€ç»ˆä¼šè¾¾åˆ°ä¸€è‡´çš„çŠ¶æ€ã€‚è¿™æ„å‘³ç€ï¼Œå½“ç³»ç»Ÿä¸­å­˜åœ¨å¤šä¸ªå‰¯æœ¬æ—¶ï¼Œè¿™äº›å‰¯æœ¬åœ¨æŸä¸ªæ—¶é—´ç‚¹ä¸Šçš„çŠ¶æ€å¯èƒ½ä¸åŒï¼Œä½†ç»è¿‡ä¸€æ®µæ—¶é—´çš„åŒæ­¥å’Œåè°ƒåï¼Œæœ€ç»ˆä¼šè¾¾åˆ°ä¸€è‡´çš„çŠ¶æ€ã€‚</p><p>åœ¨å®ç°æœ€ç»ˆä¸€è‡´æ€§æ—¶ï¼Œé€šå¸¸é‡‡ç”¨å¼‚æ­¥å¤åˆ¶æˆ–å»¶è¿Ÿå¤åˆ¶çš„æ–¹å¼ï¼Œå³ä¸è¦æ±‚æ‰€æœ‰èŠ‚ç‚¹åœ¨çŸ­æ—¶é—´å†…è¾¾åˆ°ä¸€è‡´çš„çŠ¶æ€ï¼Œè€Œæ˜¯å…è®¸èŠ‚ç‚¹åœ¨æœ¬åœ°æ›´æ–°æ•°æ®ï¼Œå¹¶åœ¨åç»­çš„æ—¶é—´ç‚¹ä¸Šå°†æ›´æ–°çš„æ•°æ®åŒæ­¥åˆ°å…¶ä»–èŠ‚ç‚¹ã€‚è¿™æ ·åšå¯ä»¥æé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œæ€§èƒ½ï¼Œå¹¶å‡å°‘ç³»ç»Ÿä¹‹é—´çš„é€šä¿¡è´Ÿæ‹…ã€‚</p><p>æœ€ç»ˆä¸€è‡´æ€§é€‚ç”¨äºä¸€äº›å¯¹æ•°æ®ä¸€è‡´æ€§è¦æ±‚ä¸æ˜¯ç‰¹åˆ«é«˜çš„åœºæ™¯ï¼Œä¾‹å¦‚<strong>æœç´¢å¼•æ“ã€ç¤¾äº¤ç½‘ç»œ</strong>ç­‰ã€‚ä½†æ˜¯ï¼Œæœ€ç»ˆä¸€è‡´æ€§ä¹Ÿå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚æ•°æ®å†²çªå’Œåˆå¹¶ã€æ•°æ®åŒæ­¥çš„å»¶è¿Ÿç­‰ï¼Œéœ€è¦åœ¨å®é™…åº”ç”¨ä¸­è¿›è¡Œé€‚å½“çš„å¤„ç†å’Œè§£å†³ã€‚</p><h3 id="3-4-6-ä»¥å®¢æˆ·ç«¯ä¸ºä¸­å¿ƒçš„ä¸€è‡´æ€§æ¨¡å‹"><a href="#3-4-6-ä»¥å®¢æˆ·ç«¯ä¸ºä¸­å¿ƒçš„ä¸€è‡´æ€§æ¨¡å‹" class="headerlink" title="3.4.6 ä»¥å®¢æˆ·ç«¯ä¸ºä¸­å¿ƒçš„ä¸€è‡´æ€§æ¨¡å‹"></a>3.4.6 ä»¥å®¢æˆ·ç«¯ä¸ºä¸­å¿ƒçš„ä¸€è‡´æ€§æ¨¡å‹</h3><p> ä»¥å®¢æˆ·ç«¯ä¸ºä¸­å¿ƒçš„ä¸€è‡´æ€§æ¨¡å‹æ˜¯ä¸€ç§åº”ç”¨ç¨‹åºåœ¨å®¢æˆ·ç«¯ä¸Šç»´æŠ¤æ•°æ®ä¸€è‡´æ€§çš„æ¨¡å‹ã€‚åœ¨è¿™ä¸ªæ¨¡å‹ä¸­ï¼Œå®¢æˆ·ç«¯è´Ÿè´£ç»´æŠ¤æ•°æ®çš„ä¸€è‡´æ€§ï¼Œè€Œä¸æ˜¯ä¾èµ–äºåˆ†å¸ƒå¼ç³»ç»Ÿæ¥ç»´æŠ¤æ•°æ®çš„ä¸€è‡´æ€§ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œä»¥å®¢æˆ·ç«¯ä¸ºä¸­å¿ƒçš„ä¸€è‡´æ€§æ¨¡å‹é€šå¸¸é‡‡ç”¨ä¹è§‚å¹¶å‘æ§åˆ¶çš„ç­–ç•¥ã€‚åœ¨è¿™ä¸ªç­–ç•¥ä¸­ï¼Œå®¢æˆ·ç«¯é€šè¿‡åœ¨æœ¬åœ°ç¼“å­˜ä¸­ä¿å­˜æ•°æ®å‰¯æœ¬æ¥ç»´æŠ¤æ•°æ®çš„ä¸€è‡´æ€§ï¼Œå¹¶åœ¨ä¿®æ”¹æ•°æ®æ—¶å¯¹ç¼“å­˜ä¸­çš„æ•°æ®è¿›è¡ŒéªŒè¯ã€‚å¦‚æœæ•°æ®æœªè¢«å…¶ä»–å®¢æˆ·ç«¯ä¿®æ”¹ï¼Œåˆ™å®¢æˆ·ç«¯å¯ä»¥ç›´æ¥æäº¤ä¿®æ”¹ã€‚å¦åˆ™ï¼Œå®¢æˆ·ç«¯éœ€è¦å¤„ç†æ•°æ®å†²çªï¼Œå¹¶æ ¹æ®ä¸€äº›ç­–ç•¥æ¥è§£å†³å†²çªã€‚</p><p>ä»¥å®¢æˆ·ç«¯ä¸ºä¸­å¿ƒçš„ä¸€è‡´æ€§æ¨¡å‹é€‚ç”¨äºä¸€äº›å¯¹ä¸€è‡´æ€§è¦æ±‚ä¸æ˜¯ç‰¹åˆ«é«˜çš„åœºæ™¯ï¼Œä¾‹å¦‚ç§»åŠ¨åº”ç”¨ã€ç¦»çº¿åº”ç”¨ç­‰ã€‚è¿™ç§æ¨¡å‹å…·æœ‰è‰¯å¥½çš„å¯ç”¨æ€§å’Œæ€§èƒ½ï¼Œå› ä¸ºå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡æœ¬åœ°ç¼“å­˜å¿«é€Ÿè¯»å†™æ•°æ®ï¼Œè€Œä¸å¿…ä¾èµ–äºåˆ†å¸ƒå¼ç³»ç»Ÿè¿›è¡Œé€šä¿¡ã€‚ä½†æ˜¯ï¼Œå®ƒä¹Ÿå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚æ•°æ®å†²çªå’Œåˆå¹¶ã€æ•°æ®åŒæ­¥çš„å»¶è¿Ÿç­‰ï¼Œéœ€è¦åœ¨å®é™…åº”ç”¨ä¸­è¿›è¡Œé€‚å½“çš„å¤„ç†å’Œè§£å†³ã€‚</p><p>å•è°ƒè¯»ï¼ˆMonotonic Readsï¼‰å’Œå•è°ƒå†™ï¼ˆMonotonic Writesï¼‰æ˜¯æŒ‡ä¸€ä¸ªçº¿ç¨‹å¯¹äºä¸€ä¸ªç‰¹å®šå˜é‡çš„è¯»æ“ä½œæˆ–å†™æ“ä½œï¼Œå¿…é¡»æŒ‰ç…§æ‰§è¡Œé¡ºåºï¼ŒæŒ‰ç…§å…ˆåé¡ºåºçœ‹åˆ°æœ€è¿‘çš„æ“ä½œç»“æœã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœçº¿ç¨‹Aå…ˆå†™å…¥å˜é‡xï¼Œç„¶åçº¿ç¨‹Bè¯»å–å˜é‡xï¼Œé‚£ä¹ˆçº¿ç¨‹Bå¿…é¡»çœ‹åˆ°çº¿ç¨‹Açš„å†™å…¥ç»“æœï¼Œè€Œä¸æ˜¯ä¹‹å‰çš„æ—§å€¼ã€‚</p><p>è¯»ä½ æ‰€å†™ï¼ˆRead Your Writesï¼ŒRYWï¼‰æ˜¯æŒ‡ä¸€ä¸ªçº¿ç¨‹å¯¹äºä¸€ä¸ªç‰¹å®šå˜é‡çš„è¯»æ“ä½œï¼Œå¿…é¡»åœ¨å®ƒè‡ªå·±çš„æœ€è¿‘çš„å†™æ“ä½œä¹‹åè¿›è¡Œã€‚è¿™ä¸ªç‰¹æ€§åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­éå¸¸é‡è¦ï¼Œå› ä¸ºå®ƒå¯ä»¥ä¿è¯ä¸€ä¸ªçº¿ç¨‹åœ¨å†™å…¥æŸä¸ªå˜é‡ä¹‹åï¼Œèƒ½å¤Ÿçœ‹åˆ°å®ƒè‡ªå·±çš„å†™å…¥ç»“æœï¼Œè€Œä¸æ˜¯å…¶ä»–çº¿ç¨‹çš„æ—§å€¼ã€‚</p><p>PRAMï¼ˆParallel Random Access Machineï¼‰æ˜¯ä¸€ç§å¹¶è¡Œè®¡ç®—æ¨¡å‹ï¼Œå®ƒæè¿°äº†ä¸€ç§åœ¨å…±äº«å†…å­˜å¹¶è¡Œè®¡ç®—æœºä¸Šè¿›è¡Œå¹¶è¡Œè®¡ç®—çš„æ–¹å¼ã€‚PRAMæ¨¡å‹ä¸­ï¼Œæ‰€æœ‰å¤„ç†å™¨å…±äº«ä¸€ä¸ªå…¨å±€å†…å­˜ï¼Œå¹¶ä¸”å¯ä»¥åœ¨O(1)æ—¶é—´å†…è¿›è¡Œè¯»å†™æ“ä½œã€‚</p><p>åœ¨PRAMæ¨¡å‹ä¸­ï¼Œå•è°ƒè¯»ã€å•è°ƒå†™å’Œè¯»ä½ æ‰€å†™æ˜¯éå¸¸é‡è¦çš„ä¸€äº›æ€§è´¨ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥ä¿è¯åœ¨å¹¶è¡Œè®¡ç®—ä¸­ä¸ä¼šå‘ç”Ÿæ•°æ®å†²çªå’Œæ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œä»è€Œä¿è¯å¹¶è¡Œè®¡ç®—çš„æ­£ç¡®æ€§å’Œæ€§èƒ½ã€‚</p><h2 id="3-5-éš”ç¦»çº§åˆ«"><a href="#3-5-éš”ç¦»çº§åˆ«" class="headerlink" title="3.5 éš”ç¦»çº§åˆ«"></a>3.5 éš”ç¦»çº§åˆ«</h2><p>éš”ç¦»çº§åˆ«æ˜¯æŒ‡åœ¨æ•°æ®åº“äº‹åŠ¡ä¸­ä¸åŒäº‹åŠ¡ä¹‹é—´å¯¹æ•°æ®çš„è¯»å†™æ‰€é‡‡ç”¨çš„ä¸åŒçš„éš”ç¦»ç­–ç•¥ã€‚å¸¸è§çš„éš”ç¦»çº§åˆ«æœ‰å››ç§ï¼šè¯»æœªæäº¤ã€è¯»å·²æäº¤ã€å¯é‡å¤è¯»å’Œä¸²è¡ŒåŒ–ã€‚</p><ol><li>è¯»æœªæäº¤ï¼ˆRead Uncommittedï¼‰ï¼šæœ€ä½çš„éš”ç¦»çº§åˆ«ï¼Œå…è®¸ä¸€ä¸ªäº‹åŠ¡è¯»å–å¦ä¸€ä¸ªäº‹åŠ¡æœªæäº¤çš„æ•°æ®ï¼Œå¯èƒ½å¯¼è‡´è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»ç­‰é—®é¢˜ã€‚</li><li>è¯»å·²æäº¤ï¼ˆRead Committedï¼‰ï¼šåœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œè¯»å–æ•°æ®æ—¶åªèƒ½è¯»å–å·²ç»æäº¤çš„æ•°æ®ï¼Œå¯ä»¥é¿å…è„è¯»é—®é¢˜ï¼Œä½†æ˜¯å¯èƒ½ä¼šå‡ºç°ä¸å¯é‡å¤è¯»å’Œå¹»è¯»é—®é¢˜ã€‚</li><li>å¯é‡å¤è¯»ï¼ˆRepeatable Readï¼‰ï¼šä¿è¯ä¸€ä¸ªäº‹åŠ¡åœ¨å¤šæ¬¡è¯»å–åŒä¸€æ•°æ®æ—¶ï¼Œèƒ½å¤Ÿçœ‹åˆ°åŒæ ·çš„æ•°æ®ï¼Œå³åŒä¸€äº‹åŠ¡å†…å¤šæ¬¡æŸ¥è¯¢ç»“æœé›†ç›¸åŒã€‚ä½†æ˜¯ï¼Œå…¶ä»–äº‹åŠ¡å¯ä»¥å‘è¯¥æ•°æ®è¡¨ä¸­æ’å…¥æ–°çš„æ•°æ®ï¼Œå¯¼è‡´å¹»è¯»é—®é¢˜ã€‚</li><li>ä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰ï¼šæœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œå®Œå…¨éš”ç¦»æ¯ä¸ªäº‹åŠ¡ï¼Œäº‹åŠ¡åªèƒ½ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°æ‰§è¡Œï¼Œé¿å…äº†æ‰€æœ‰å¹¶å‘é—®é¢˜ï¼Œä½†æ˜¯æ•ˆç‡è¾ƒä½ã€‚</li></ol><p>ä¸åŒçš„éš”ç¦»çº§åˆ«åœ¨äº‹åŠ¡å¤„ç†ä¸­çš„æ€§èƒ½å’Œæ­£ç¡®æ€§ä¸Šæœ‰ä¸åŒçš„å½±å“ï¼Œéœ€è¦æ ¹æ®å…·ä½“çš„ä¸šåŠ¡éœ€æ±‚è¿›è¡Œé€‰æ‹©ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¯»å·²æäº¤å’Œå¯é‡å¤è¯»æ˜¯åº”ç”¨æ¯”è¾ƒå¹¿æ³›çš„éš”ç¦»çº§åˆ«ã€‚</p><h2 id="3-6-ä¸€è‡´æ€§å’Œéš”ç¦»çº§åˆ«çš„å¯¹æ¯”"><a href="#3-6-ä¸€è‡´æ€§å’Œéš”ç¦»çº§åˆ«çš„å¯¹æ¯”" class="headerlink" title="3.6 ä¸€è‡´æ€§å’Œéš”ç¦»çº§åˆ«çš„å¯¹æ¯”"></a>3.6 ä¸€è‡´æ€§å’Œéš”ç¦»çº§åˆ«çš„å¯¹æ¯”</h2><p>çº¿æ€§ä¸€è‡´æ€§å’Œä¸²è¡ŒåŒ–éƒ½æ˜¯æ•°æ®åº“ä¸­ä¿è¯äº‹åŠ¡æ­£ç¡®æ€§çš„æœºåˆ¶ï¼Œä½†æ˜¯å®ƒä»¬æœ‰ä¸åŒçš„å®ç°æ–¹å¼å’Œåº”ç”¨åœºæ™¯ã€‚</p><p>çº¿æ€§ä¸€è‡´æ€§ï¼ˆLinearizabilityï¼‰æ˜¯æŒ‡ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªæ“ä½œéƒ½æœ‰ä¸€ä¸ªå…¨å±€çš„å…ˆåé¡ºåºï¼Œè¯¥é¡ºåºæ»¡è¶³åŸå­æ€§ã€é¡ºåºæ€§ã€ä¸€è‡´æ€§å’Œå®æ—¶æ€§çš„è¦æ±‚ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œçº¿æ€§ä¸€è‡´æ€§ä¿è¯äº†åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ“ä½œé¡ºåºä¸å•ä¸ªç³»ç»Ÿä¸­çš„æ“ä½œé¡ºåºç›¸åŒï¼Œè€Œä¸”ä¿è¯äº†æ“ä½œçš„åŸå­æ€§ã€ä¸€è‡´æ€§å’Œå®æ—¶æ€§ã€‚çº¿æ€§ä¸€è‡´æ€§ä¿è¯äº†åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ“ä½œè¡¨ç°å‡ºå’Œå•ä¸ªç³»ç»Ÿä¸€æ ·çš„è¡Œä¸ºï¼Œå¯¹äºåº”ç”¨ç¨‹åºæ¥è¯´ï¼Œæ„ŸçŸ¥ä¸åˆ°åˆ†å¸ƒå¼ç¯å¢ƒçš„å­˜åœ¨ã€‚</p><p>ä¸²è¡ŒåŒ–ï¼ˆSerializationï¼‰æ˜¯æŒ‡ï¼Œåœ¨å¤šä¸ªäº‹åŠ¡å¹¶å‘è®¿é—®åŒä¸€ä»½æ•°æ®æ—¶ï¼Œæ•°æ®åº“ç³»ç»Ÿä¼šæŠŠè¿™äº›äº‹åŠ¡ä¸²è¡Œæ‰§è¡Œï¼Œä»¥ä¿è¯æ•°æ®çš„æ­£ç¡®æ€§ã€‚ä¸²è¡ŒåŒ–å¯ä»¥æ¶ˆé™¤è„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ç­‰é—®é¢˜ï¼Œä½†æ˜¯ä¼šé™ä½å¹¶å‘æ€§èƒ½ã€‚</p><p>è™½ç„¶çº¿æ€§ä¸€è‡´æ€§å’Œä¸²è¡ŒåŒ–éƒ½èƒ½ä¿è¯æ•°æ®çš„æ­£ç¡®æ€§ï¼Œä½†æ˜¯å®ƒä»¬çš„åº”ç”¨åœºæ™¯ä¸åŒã€‚çº¿æ€§ä¸€è‡´æ€§æ›´é€‚ç”¨äºåˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„ç³»ç»Ÿï¼Œä¾‹å¦‚åˆ†å¸ƒå¼ç¼“å­˜ã€åˆ†å¸ƒå¼é˜Ÿåˆ—ç­‰ã€‚è€Œä¸²è¡ŒåŒ–æ›´é€‚ç”¨äºäº‹åŠ¡å¹¶å‘è®¿é—®åŒä¸€ä»½æ•°æ®æ—¶ï¼Œéœ€è¦ä¸¥æ ¼æ§åˆ¶å¹¶å‘æ‰§è¡Œé¡ºåºçš„åœºæ™¯ï¼Œä¾‹å¦‚é“¶è¡Œè½¬è´¦ã€è®¢å•å¤„ç†ç­‰ã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œçº¿æ€§ä¸€è‡´æ€§å’Œä¸²è¡ŒåŒ–éƒ½ä¼šå½±å“æ•°æ®åº“çš„å¹¶å‘æ€§èƒ½ï¼Œå› æ­¤éœ€è¦æ ¹æ®å…·ä½“çš„ä¸šåŠ¡éœ€æ±‚å’Œç³»ç»Ÿæ¶æ„æ¥é€‰æ‹©é€‚åˆçš„ä¸€è‡´æ€§æ§åˆ¶æœºåˆ¶ï¼Œä»¥ä¿è¯ç³»ç»Ÿçš„æ­£ç¡®æ€§å’Œå¹¶å‘æ€§èƒ½ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åˆ†å¸ƒå¼ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ†å¸ƒå¼ç³»ç»Ÿ </tag>
            
            <tag> æ·±å…¥ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ·±å…¥ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿï¼ˆå››ï¼‰åˆ†å¸ƒå¼å…±è¯†</title>
      <link href="/2024/06/26/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%EF%BC%88%E5%9B%9B%EF%BC%89%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B1%E8%AF%86/"/>
      <url>/2024/06/26/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%EF%BC%88%E5%9B%9B%EF%BC%89%E5%88%86%E5%B8%83%E5%BC%8F%E5%85%B1%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆ†å¸ƒå¼å…±è¯†"><a href="#åˆ†å¸ƒå¼å…±è¯†" class="headerlink" title="åˆ†å¸ƒå¼å…±è¯†"></a>åˆ†å¸ƒå¼å…±è¯†</h1><h2 id="4-1-åˆ†å¸ƒå¼å…±è¯†ç®€ä»‹"><a href="#4-1-åˆ†å¸ƒå¼å…±è¯†ç®€ä»‹" class="headerlink" title="4.1 åˆ†å¸ƒå¼å…±è¯†ç®€ä»‹"></a>4.1 åˆ†å¸ƒå¼å…±è¯†ç®€ä»‹</h2><p>åˆ†å¸ƒå¼å…±è¯†ï¼ˆDistributed Consensusï¼‰æ˜¯æŒ‡åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¤šä¸ªèŠ‚ç‚¹ï¼ˆæˆ–è¿›ç¨‹ï¼‰ååŒå®ŒæˆæŸä¸ªä»»åŠ¡æˆ–è¾¾æˆæŸä¸ªå†³ç­–çš„è¿‡ç¨‹ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹éœ€è¦å°±è¯¥ä»»åŠ¡æˆ–å†³ç­–è¾¾æˆä¸€è‡´ï¼Œå¹¶ä¸”èƒ½å¤Ÿäº’ç›¸é€šä¿¡ã€åè°ƒã€åä½œã€‚</p><p>åˆ†å¸ƒå¼å…±è¯†çš„ä¸€ä¸ªé‡è¦åº”ç”¨æ˜¯åœ¨åŒºå—é“¾æŠ€æœ¯ä¸­ï¼Œç”¨äºè§£å†³åŒèŠ±é—®é¢˜ï¼ˆDouble-spending problemï¼‰å’Œç¡®å®šå“ªäº›äº¤æ˜“ä¼šè¢«å†™å…¥åŒºå—é“¾ã€‚æ¯”ç‰¹å¸ç­‰åŠ å¯†è´§å¸å°±æ˜¯é€šè¿‡å…±è¯†ç®—æ³•æ¥å®ç°å»ä¸­å¿ƒåŒ–çš„äº¤æ˜“è®°å½•ã€‚</p><p>å¸¸è§çš„åˆ†å¸ƒå¼å…±è¯†ç®—æ³•åŒ…æ‹¬æ‹œå åº­å°†å†›é—®é¢˜ï¼ˆByzantine fault tolerance, BFTï¼‰ã€Raftã€Paxosã€Proof of Workï¼ˆPoWï¼‰ã€Proof of Stakeï¼ˆPoSï¼‰ç­‰ã€‚è¿™äº›ç®—æ³•éƒ½æœ‰å„è‡ªçš„ä¼˜ç¼ºç‚¹ï¼Œé€‚ç”¨äºä¸åŒçš„åœºæ™¯ã€‚ä¾‹å¦‚ï¼ŒPoW ç®—æ³•è¢«åº”ç”¨åœ¨æ¯”ç‰¹å¸ç­‰åŠ å¯†è´§å¸ä¸­ï¼Œè€Œ PoS ç®—æ³•åˆ™è¢«ç”¨åœ¨ä»¥å¤ªåŠç­‰åŒºå—é“¾å¹³å°ä¸­ã€‚</p><h3 id="4-1-1-ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼å…±è¯†"><a href="#4-1-1-ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼å…±è¯†" class="headerlink" title="4.1.1 ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼å…±è¯†"></a>4.1.1 ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼å…±è¯†</h3><p>åˆ†å¸ƒå¼å…±è¯†æ˜¯æŒ‡åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¤šä¸ªèŠ‚ç‚¹ä¹‹é—´éœ€è¦å°±æŸäº›å†³ç­–è¾¾æˆä¸€è‡´æ„è§çš„è¿‡ç¨‹ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå„ä¸ªèŠ‚ç‚¹é€šè¿‡ç›¸äº’é€šä¿¡å’Œåä½œæ¥è¾¾æˆå…±è¯†ï¼Œä»¥ä¿è¯ç³»ç»Ÿèƒ½å¤Ÿæ­£å¸¸è¿ä½œå¹¶é¿å…å‡ºç°é”™è¯¯æˆ–å†²çªã€‚</p><p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç”±äºèŠ‚ç‚¹ä¹‹é—´çš„ç½‘ç»œå»¶è¿Ÿã€èŠ‚ç‚¹æ•…éšœç­‰åŸå› ï¼Œä¸åŒèŠ‚ç‚¹çš„çŠ¶æ€å¯èƒ½å­˜åœ¨ä¸ä¸€è‡´çš„æƒ…å†µã€‚å› æ­¤ï¼Œéœ€è¦é€šè¿‡åˆ†å¸ƒå¼å…±è¯†ç®—æ³•æ¥è§£å†³è¿™äº›é—®é¢˜ã€‚å¸¸ç”¨çš„åˆ†å¸ƒå¼å…±è¯†ç®—æ³•åŒ…æ‹¬ Paxosã€Raftã€Byzantine Fault Tolerance ç­‰ã€‚</p><p>åˆ†å¸ƒå¼å…±è¯†ç®—æ³•çš„åŸºæœ¬æ€è·¯æ˜¯ï¼Œé€šè¿‡èŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡å’Œåä½œï¼Œé€‰å‡ºä¸€ä¸ªâ€œé¢†å¯¼è€…â€èŠ‚ç‚¹æ¥è´Ÿè´£æå‡ºæŸä¸ªå†³ç­–ï¼Œå…¶ä»–èŠ‚ç‚¹é€šè¿‡æŠ•ç¥¨å’Œç¡®è®¤çš„æ–¹å¼æ¥è¾¾æˆå…±è¯†ï¼Œä»¥ä¿è¯ç³»ç»Ÿåœ¨å¤šä¸ªèŠ‚ç‚¹ä¹‹é—´çš„ä¸€è‡´æ€§å’Œå¯é æ€§ã€‚è¿™ç§ç®—æ³•åœ¨åˆ†å¸ƒå¼æ•°æ®åº“ã€åŒºå—é“¾ç­‰ç³»ç»Ÿä¸­éƒ½å¾—åˆ°äº†å¹¿æ³›åº”ç”¨ã€‚</p><h3 id="4-1-2-ä¸ºä»€ä¹ˆè¦è¾¾æˆå…±è¯†"><a href="#4-1-2-ä¸ºä»€ä¹ˆè¦è¾¾æˆå…±è¯†" class="headerlink" title="4.1.2 ä¸ºä»€ä¹ˆè¦è¾¾æˆå…±è¯†"></a>4.1.2 ä¸ºä»€ä¹ˆè¦è¾¾æˆå…±è¯†</h3><p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒèŠ‚ç‚¹ä¹‹é—´çš„çŠ¶æ€å¯èƒ½å­˜åœ¨ä¸ä¸€è‡´çš„æƒ…å†µï¼Œå¦‚æœä¸å¯¹è¿™äº›çŠ¶æ€è¿›è¡Œåè°ƒï¼Œå°±å¯èƒ½å¯¼è‡´ç³»ç»Ÿå‡ºç°é”™è¯¯æˆ–å†²çªã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µçš„å‘ç”Ÿï¼Œéœ€è¦åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å®ç°å…±è¯†æœºåˆ¶ï¼Œä¿è¯å„ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„çŠ¶æ€è¾¾æˆä¸€è‡´ï¼Œä»è€Œä¿è¯ç³»ç»Ÿçš„æ­£ç¡®æ€§å’Œå¯é æ€§ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œå¦‚æœåœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒæŸäº›èŠ‚ç‚¹çš„çŠ¶æ€å‘ç”Ÿäº†å˜åŒ–ï¼Œä½†å…¶ä»–èŠ‚ç‚¹è¿˜æ²¡æœ‰æ”¶åˆ°è¿™ä¸ªå˜åŒ–çš„é€šçŸ¥ï¼Œé‚£ä¹ˆè¿™äº›èŠ‚ç‚¹å°±ä¼šåŸºäºè¿‡æœŸçš„çŠ¶æ€è¿›è¡Œæ“ä½œï¼Œä»è€Œå¯¼è‡´æ•°æ®ä¸ä¸€è‡´æˆ–æ“ä½œå†²çªã€‚é€šè¿‡åˆ†å¸ƒå¼å…±è¯†ç®—æ³•ï¼Œå¯ä»¥ç¡®ä¿æ‰€æœ‰èŠ‚ç‚¹åœ¨è¿›è¡Œæ“ä½œå‰éƒ½å·²ç»è¾¾æˆäº†å…±è¯†ï¼Œä»è€Œä¿è¯äº†æ•°æ®çš„ä¸€è‡´æ€§å’Œæ“ä½œçš„æ­£ç¡®æ€§ã€‚</p><p>å¦å¤–ï¼Œåˆ†å¸ƒå¼å…±è¯†è¿˜èƒ½å¤Ÿé˜²æ­¢æ‹œå åº­é”™è¯¯çš„å‘ç”Ÿã€‚æ‹œå åº­é”™è¯¯æ˜¯æŒ‡åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å­˜åœ¨æ¶æ„èŠ‚ç‚¹æˆ–ç½‘ç»œæ”»å‡»ï¼Œå¯¼è‡´èŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡å—åˆ°å¹²æ‰°æˆ–ä¼ªé€ ã€‚é€šè¿‡åˆ†å¸ƒå¼å…±è¯†ç®—æ³•ï¼Œå¯ä»¥æ£€æµ‹å’Œæ’é™¤è¿™äº›æ¶æ„è¡Œä¸ºï¼Œç¡®ä¿ç³»ç»Ÿçš„å®‰å…¨æ€§å’Œå¯é æ€§ã€‚</p><h2 id="4-2-å¼‚æ­¥ç³»ç»Ÿä¸­çš„å…±è¯†"><a href="#4-2-å¼‚æ­¥ç³»ç»Ÿä¸­çš„å…±è¯†" class="headerlink" title="4.2 å¼‚æ­¥ç³»ç»Ÿä¸­çš„å…±è¯†"></a>4.2 å¼‚æ­¥ç³»ç»Ÿä¸­çš„å…±è¯†</h2><h3 id="4-2-1-FLPä¸å¯èƒ½å®šç†"><a href="#4-2-1-FLPä¸å¯èƒ½å®šç†" class="headerlink" title="4.2.1 FLPä¸å¯èƒ½å®šç†"></a>4.2.1 FLPä¸å¯èƒ½å®šç†</h3><p>FLPä¸å¯èƒ½å®šç†æ˜¯æŒ‡ï¼Œ<strong>åœ¨ä¸€ä¸ªå¼‚æ­¥çš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¸å­˜åœ¨ä¸€ä¸ªç®—æ³•èƒ½å¤Ÿä¿è¯åœ¨å­˜åœ¨è‡³å°‘ä¸€ä¸ªèŠ‚ç‚¹æ•…éšœçš„æƒ…å†µä¸‹ï¼Œä»ç„¶èƒ½å¤Ÿä¿è¯æ‰€æœ‰èŠ‚ç‚¹èƒ½å¤Ÿåœ¨æœ‰é™æ—¶é—´å†…è¾¾æˆå…±è¯†ã€‚</strong></p><p>è¯¥å®šç†ç”±Fischerã€Lynchå’ŒPatersonåœ¨1985å¹´æå‡ºï¼Œæ˜¯åˆ†å¸ƒå¼å…±è¯†é¢†åŸŸçš„ä¸€ä¸ªé‡è¦ç†è®ºã€‚å…¶åŸºæœ¬æ€æƒ³æ˜¯ï¼Œç”±äºèŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡å­˜åœ¨å»¶è¿Ÿå’Œä¸å¯é æ€§ï¼Œå› æ­¤åœ¨å­˜åœ¨æ•…éšœèŠ‚ç‚¹çš„æƒ…å†µä¸‹ï¼Œæ— æ³•ç¡®å®šæŸä¸ªèŠ‚ç‚¹æ˜¯å¦å·²ç»åœæ­¢å·¥ä½œæˆ–è€…åªæ˜¯å»¶è¿Ÿã€‚è¿™ç§ä¸ç¡®å®šæ€§ä¼šå¯¼è‡´å…±è¯†è¿‡ç¨‹æ— æ³•å®Œæˆã€‚</p><p>FLPä¸å¯èƒ½å®šç†çš„è¯æ˜ä½¿ç”¨äº†å¡æ…•å°”å¼‚æ­¥é€šä¿¡æ¨¡å‹ï¼Œå³å‡è®¾èŠ‚ç‚¹ä¹‹é—´çš„æ¶ˆæ¯ä¼ è¾“å¯ä»¥æ— é™åˆ¶åœ°å»¶è¿Ÿï¼Œä½†å¿…é¡»ä¿è¯æ¯ä¸ªèŠ‚ç‚¹æœ€ç»ˆèƒ½å¤Ÿæ”¶åˆ°æ‰€æœ‰æ¶ˆæ¯ã€‚åŸºäºè¿™ç§é€šä¿¡æ¨¡å‹ï¼Œå¯ä»¥è¯æ˜åœ¨å­˜åœ¨è‡³å°‘ä¸€ä¸ªèŠ‚ç‚¹æ•…éšœçš„æƒ…å†µä¸‹ï¼Œæ— æ³•ä¿è¯æ‰€æœ‰èŠ‚ç‚¹èƒ½å¤Ÿåœ¨æœ‰é™æ—¶é—´å†…è¾¾æˆå…±è¯†ã€‚</p><p>è™½ç„¶FLPä¸å¯èƒ½å®šç†æŒ‡å‡ºäº†åˆ†å¸ƒå¼å…±è¯†é—®é¢˜çš„å›°éš¾æ€§ï¼Œä½†æ˜¯åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¾€å¾€ä¼šä½¿ç”¨ä¸€äº›è¿‘ä¼¼ç®—æ³•æ¥è§£å†³å…±è¯†é—®é¢˜ã€‚ä¾‹å¦‚ï¼ŒPaxosç®—æ³•ã€Raftç®—æ³•ç­‰å°±æ˜¯é€šè¿‡ä¸€äº›ç‰¹æ®Šçš„çº¦æŸæ¡ä»¶æ¥å®ç°äº†å…±è¯†ï¼Œä»è€Œåœ¨å®é™…åº”ç”¨ä¸­å¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ã€‚</p><ul><li>å®‰å…¨æ€§: åœ¨ä¸€ä¸ªä»»æœŸå†…åªä¼šç¡®å®šä¸€ä¸ªå€¼ï¼ˆsomething wrong not happenï¼‰</li><li>æ´»æ€§ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿæœ€ç»ˆä¼šè®¤åŒæŸä¸€ä¸ªå€¼(something right must happen)</li><li>å®¹é”™æ€§</li></ul><p><a href="https://lrita.github.io/2018/10/23/safety-and-liveness-in-distributed/">åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ safety å’Œ liveness â€” æºä»£ç  (lrita.github.io)</a></p><p>å’ŒCAPä¸€æ ·ï¼Œä¸‰é€‰äºŒ</p><p><strong>è¯æ˜ï¼š</strong></p><p>FLPä¸å¯èƒ½å®šç†çš„è¯æ˜æ˜¯åŸºäºå¡æ…•å°”å¼‚æ­¥é€šä¿¡æ¨¡å‹çš„ï¼Œè¯¥æ¨¡å‹å‡è®¾èŠ‚ç‚¹ä¹‹é—´çš„æ¶ˆæ¯ä¼ è¾“å¯ä»¥æ— é™åˆ¶åœ°å»¶è¿Ÿï¼Œä½†å¿…é¡»ä¿è¯æ¯ä¸ªèŠ‚ç‚¹æœ€ç»ˆèƒ½å¤Ÿæ”¶åˆ°æ‰€æœ‰æ¶ˆæ¯ã€‚åœ¨è¿™ç§é€šä¿¡æ¨¡å‹ä¸‹ï¼Œè¯æ˜FLPä¸å¯èƒ½å®šç†çš„åŸºæœ¬æ€è·¯æ˜¯ï¼Œé€šè¿‡æ„é€ ä¸€ä¸ªåä¾‹æ¥è¯´æ˜åœ¨å¼‚æ­¥é€šä¿¡æ¨¡å‹ä¸‹ï¼Œä¸å­˜åœ¨ä¸€ä¸ªç®—æ³•èƒ½å¤Ÿä¿è¯åœ¨å­˜åœ¨è‡³å°‘ä¸€ä¸ªèŠ‚ç‚¹æ•…éšœçš„æƒ…å†µä¸‹ï¼Œä»ç„¶èƒ½å¤Ÿä¿è¯æ‰€æœ‰èŠ‚ç‚¹èƒ½å¤Ÿåœ¨æœ‰é™æ—¶é—´å†…è¾¾æˆå…±è¯†ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œå‡è®¾æœ‰ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå…¶ä¸­åŒ…å«nä¸ªèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹ä¹‹é—´é€šè¿‡æ¶ˆæ¯ä¼ é€’æ¥è¾¾æˆå…±è¯†ã€‚ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œå‡è®¾ç³»ç»Ÿä¸­åªæœ‰ä¸¤ç§çŠ¶æ€ï¼š0å’Œ1ã€‚åˆå§‹çŠ¶æ€ä¸‹ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€éƒ½æ˜¯ä¸ç¡®å®šçš„ã€‚èŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡æ˜¯å¼‚æ­¥çš„ï¼Œæ¶ˆæ¯ä¼ è¾“å¯ä»¥æ— é™åˆ¶åœ°å»¶è¿Ÿï¼Œä¸”æ— æ³•ä¿è¯æ¶ˆæ¯çš„å¯é æ€§ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œå‡è®¾æœ‰ä¸€ä¸ªç®—æ³•Aï¼Œå¯ä»¥åœ¨å­˜åœ¨è‡³å°‘ä¸€ä¸ªèŠ‚ç‚¹æ•…éšœçš„æƒ…å†µä¸‹ï¼Œä»ç„¶èƒ½å¤Ÿä¿è¯æ‰€æœ‰èŠ‚ç‚¹èƒ½å¤Ÿåœ¨æœ‰é™æ—¶é—´å†…è¾¾æˆå…±è¯†ã€‚ä¸ºäº†è¯æ˜FLPä¸å¯èƒ½å®šç†ï¼Œéœ€è¦æ„é€ ä¸€ä¸ªåä¾‹æ¥è¯´æ˜è¿™ä¸ªç®—æ³•æ˜¯ä¸å¯è¡Œçš„ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œå‡è®¾å­˜åœ¨ä¸¤ä¸ªèŠ‚ç‚¹på’Œqï¼Œå®ƒä»¬çš„çŠ¶æ€åˆå§‹æ—¶å‡ä¸ºä¸ç¡®å®šçŠ¶æ€ã€‚ä¸ºäº†è¾¾æˆå…±è¯†ï¼ŒèŠ‚ç‚¹på‘é€ä¸€ä¸ªæ¶ˆæ¯mç»™èŠ‚ç‚¹qï¼Œå‘Šè¯‰èŠ‚ç‚¹qå®ƒå½“å‰çš„çŠ¶æ€æ˜¯0ã€‚ä½†ç”±äºé€šä¿¡æ˜¯å¼‚æ­¥çš„ï¼Œæ¶ˆæ¯må¯èƒ½ä¼šè¢«å»¶è¿Ÿæˆ–è€…ä¸¢å¤±ï¼Œå¯¼è‡´èŠ‚ç‚¹qæ— æ³•çŸ¥é“èŠ‚ç‚¹pçš„çŠ¶æ€ã€‚å› æ­¤ï¼ŒèŠ‚ç‚¹qå¯ä»¥é€‰æ‹©ç»§ç»­ç­‰å¾…æ¶ˆæ¯mï¼Œæˆ–è€…çŒœæµ‹èŠ‚ç‚¹pçš„çŠ¶æ€æ˜¯1ã€‚å¦‚æœèŠ‚ç‚¹qçŒœæµ‹èŠ‚ç‚¹pçš„çŠ¶æ€æ˜¯1ï¼Œé‚£ä¹ˆèŠ‚ç‚¹qä¼šå‘é€ä¸€ä¸ªæ¶ˆæ¯nç»™èŠ‚ç‚¹pï¼Œå‘Šè¯‰èŠ‚ç‚¹på®ƒå½“å‰çš„çŠ¶æ€æ˜¯1ã€‚ç”±äºèŠ‚ç‚¹pä¹Ÿæ— æ³•ç¡®å®šèŠ‚ç‚¹qçš„çŠ¶æ€ï¼ŒèŠ‚ç‚¹pä¹Ÿæœ‰å¯èƒ½ä¼šçŒœæµ‹èŠ‚ç‚¹qçš„çŠ¶æ€æ˜¯0ï¼Œä»è€Œå‘é€ä¸€ä¸ªæ¶ˆæ¯kç»™èŠ‚ç‚¹qï¼Œå‘Šè¯‰èŠ‚ç‚¹qå®ƒå½“å‰çš„çŠ¶æ€æ˜¯0ã€‚è¿™æ ·ï¼Œå°±å½¢æˆäº†ä¸€ä¸ªæ­»é”çŠ¶æ€ï¼Œå¯¼è‡´èŠ‚ç‚¹på’Œqæ— æ³•è¾¾æˆå…±è¯†ã€‚</p><p>ä»ä¸Šè¿°åˆ†æå¯ä»¥çœ‹å‡ºï¼Œç”±äºå¼‚æ­¥é€šä¿¡æ¨¡å‹çš„å­˜åœ¨ï¼Œæ— æ³•ä¿è¯æ¶ˆæ¯çš„å¯é æ€§å’ŒèŠ‚ç‚¹çŠ¶æ€çš„ä¸€è‡´æ€§ï¼Œä»è€Œå¯¼è‡´FLPä¸å¯èƒ½å®šç†çš„å­˜åœ¨ã€‚è™½ç„¶è¯¥å®šç†è¯æ˜äº†åœ¨å¼‚æ­¥é€šä¿¡æ¨¡å‹ä¸‹ï¼Œä¸å­˜åœ¨ä¸€ä¸ªç®—æ³•èƒ½å¤Ÿä¿è¯åœ¨å­˜åœ¨è‡³å°‘ä¸€ä¸ªèŠ‚ç‚¹æ•…éšœçš„æƒ…å†µä¸‹ï¼Œä»ç„¶èƒ½å¤Ÿä¿è¯æ‰€æœ‰èŠ‚ç‚¹èƒ½å¤Ÿåœ¨æœ‰é™æ—¶é—´å†…è¾¾æˆå…±è¯†ï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¯ä»¥é‡‡ç”¨ä¸€äº›è¿‘ä¼¼ç®—æ³•æ¥è§£å†³å…±è¯†é—®é¢˜ã€‚</p><ul><li>æ•…éšœå±è”½</li><li>ä½¿ç”¨æ•…éšœæ£€æµ‹å™¨</li><li>ä½¿ç”¨éšæœºæ€§ç®—æ³•</li></ul><p>è¿™ä¸‰ç§æ–¹æ³•å¯ä»¥ç»•å¼€FLPä¸å¯èƒ½å®šç†</p><h3 id="4-2-2-æ•…éšœå±è”½"><a href="#4-2-2-æ•…éšœå±è”½" class="headerlink" title="4.2.2 æ•…éšœå±è”½"></a>4.2.2 æ•…éšœå±è”½</h3><p>æ•…éšœå±è”½ï¼ˆFault toleranceï¼‰å’Œæ•…éšœæ£€æµ‹å™¨ï¼ˆFault detectionï¼‰æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¸¸ç”¨çš„æŠ€æœ¯ï¼Œç”¨äºæé«˜ç³»ç»Ÿçš„å¯é æ€§å’Œé²æ£’æ€§ã€‚ä½¿ç”¨éšæœºæ€§ç®—æ³•æ˜¯å®ç°è¿™äº›æŠ€æœ¯çš„ä¸€ç§å¸¸ç”¨æ–¹æ³•ã€‚</p><p>æ•…éšœå±è”½æ˜¯ä¸€ç§æŠ€æœ¯ï¼Œå¯ä»¥åœ¨ç³»ç»Ÿä¸­å‘ç”Ÿæ•…éšœæ—¶ä¿è¯ç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œã€‚ä¸€ç§å¸¸è§çš„æ•…éšœå±è”½æŠ€æœ¯æ˜¯å†—ä½™å¤‡ä»½ï¼ˆRedundancyï¼‰ï¼Œå³åœ¨ç³»ç»Ÿä¸­å¢åŠ å¤šä¸ªå¤‡ä»½ï¼Œå½“ä¸€ä¸ªèŠ‚ç‚¹å‘ç”Ÿæ•…éšœæ—¶ï¼Œå¤‡ä»½èŠ‚ç‚¹å¯ä»¥æ¥ç®¡å…¶ä»»åŠ¡ï¼Œä¿è¯ç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œã€‚åœ¨å®ç°å†—ä½™å¤‡ä»½æ—¶ï¼Œå¸¸å¸¸ä½¿ç”¨éšæœºæ€§ç®—æ³•ï¼Œå¦‚éšæœºåŒ–é€‰ä¸¾ï¼ˆRandomized electionï¼‰å’ŒéšæœºåŒ–å¤åˆ¶ï¼ˆRandomized replicationï¼‰ç­‰æŠ€æœ¯ï¼Œæ¥æé«˜ç³»ç»Ÿçš„å¯é æ€§å’Œé²æ£’æ€§ã€‚</p><h3 id="4-2-3-ä½¿ç”¨æ•…éšœæ£€æµ‹å™¨"><a href="#4-2-3-ä½¿ç”¨æ•…éšœæ£€æµ‹å™¨" class="headerlink" title="4.2.3 ä½¿ç”¨æ•…éšœæ£€æµ‹å™¨"></a>4.2.3 ä½¿ç”¨æ•…éšœæ£€æµ‹å™¨</h3><p>æ•…éšœæ£€æµ‹å™¨æ˜¯ä¸€ç§æŠ€æœ¯ï¼Œç”¨äºæ£€æµ‹åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ•…éšœèŠ‚ç‚¹ã€‚ä¸€ç§å¸¸è§çš„æ•…éšœæ£€æµ‹å™¨æ˜¯å¿ƒè·³æ£€æµ‹ï¼ˆHeartbeat detectionï¼‰ï¼Œå³æ¯ä¸ªèŠ‚ç‚¹å®šæœŸå‘å…¶ä»–èŠ‚ç‚¹å‘é€å¿ƒè·³æ¶ˆæ¯ï¼Œæ£€æµ‹æ˜¯å¦æœ‰èŠ‚ç‚¹æ•…éšœã€‚åœ¨å®ç°å¿ƒè·³æ£€æµ‹æ—¶ï¼Œå¸¸å¸¸ä½¿ç”¨éšæœºæ€§ç®—æ³•ï¼Œå¦‚éšæœºåŒ–æ—¶é—´é—´éš”ï¼ˆRandomized intervalï¼‰å’ŒéšæœºåŒ–è·¯çº¿ï¼ˆRandomized routingï¼‰ç­‰æŠ€æœ¯ï¼Œæ¥é¿å…æ•…éšœæ£€æµ‹è¿‡ç¨‹ä¸­çš„æ­»é”å’Œç“¶é¢ˆç­‰é—®é¢˜ï¼Œæé«˜æ£€æµ‹çš„å‡†ç¡®æ€§å’Œæ•ˆç‡ã€‚</p><p>è™½ç„¶å®Œç¾çš„æ•…éšœæ£€æµ‹å™¨å…·å¤‡ä»¥ä¸‹æ¡ä»¶ï¼š</p><ul><li>å®Œå…¨æ€§ï¼šæ¯ä¸€ä¸ªæ•…éšœçš„è¿›ç¨‹éƒ½ä¼šè¢«æ¯ä¸€ä¸ªæ­£ç¡®çš„è¿›ç¨‹æ€€ç–‘</li><li>ç²¾ç¡®æ€§ï¼šæ¯ä¸€ä¸ªæ­£ç¡®çš„è¿›ç¨‹éƒ½ä¸ä¼šè¢«å…¶ä»–è¿›ç¨‹æ€€ç–‘</li></ul><p>ä½†å®é™…ä¸Šï¼Œå®ç°å›°éš¾ã€‚è€Œè®ºæ–‡è¯æ˜ï¼Œå³ä½¿ä½¿ç”¨â€ä¸å®Œç¾â€çš„æ•…éšœæ£€æµ‹å™¨ï¼Œåªè¦é€šä¿¡å¯é ï¼Œå¤±æ•ˆè¿›ç¨‹ä¸è¶…è¿‡ä¸€åŠï¼Œä¾ç„¶å¯ä»¥ç”¨æ¥è§£å†³å…±è¯†é—®é¢˜ã€‚å› æ­¤å®ç°æœ€ç»ˆå¼±æ•…éšœæ£€æµ‹å™¨ï¼š</p><ul><li>æœ€ç»ˆå¼±å®Œå…¨æ€§ï¼šæ¯ä¸€ä¸ªæ•…éšœçš„è¿›ç¨‹æœ€ç»ˆéƒ½ä¼šè¢«ä¸€äº›æ­£ç¡®çš„è¿›ç¨‹æ£€æµ‹åˆ°ã€‚</li><li>æœ€ç»ˆå¼±ç²¾ç¡®æ€§ï¼šç»è¿‡ä¸€æ®µæ—¶é—´åï¼Œä¸€ä¸ªæ­£ç¡®çš„è¿›ç¨‹ä¸ä¼šè¢«å…¶ä»–æ­£ç¡®çš„è¿›ç¨‹æ€€ç–‘ã€‚</li></ul><h3 id="4-2-4-ä½¿ç”¨éšæœºæ€§ç®—æ³•"><a href="#4-2-4-ä½¿ç”¨éšæœºæ€§ç®—æ³•" class="headerlink" title="4.2.4 ä½¿ç”¨éšæœºæ€§ç®—æ³•"></a>4.2.4 ä½¿ç”¨éšæœºæ€§ç®—æ³•</h3><p>éšæœºæ€§ç®—æ³•æ˜¯æŒ‡åœ¨ç®—æ³•è®¾è®¡å’Œå®ç°ä¸­å¼•å…¥éšæœºæ€§çš„ä¸€ç§æŠ€æœ¯ï¼Œå¯ä»¥ç”¨äºè§£å†³ä¸€äº›åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å¤æ‚é—®é¢˜ï¼Œå¦‚åˆ†å¸ƒå¼è®¡ç®—ã€åˆ†å¸ƒå¼å­˜å‚¨ã€åˆ†å¸ƒå¼å…±è¯†ç­‰é—®é¢˜ã€‚éšæœºæ€§ç®—æ³•å…·æœ‰ä¸€äº›ä¼˜ç‚¹ï¼Œå¦‚ç®€å•ã€å¿«é€Ÿã€å®¹æ˜“å®ç°å’Œåˆ†å¸ƒå¼åŒ–ç­‰ç‰¹ç‚¹ï¼Œå¯ä»¥æé«˜åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ€§èƒ½å’Œæ•ˆç‡ã€‚</p><p><strong>åŒºå—é“¾ï¼š</strong></p><p>Proof of Workï¼ˆPoWï¼‰å’ŒProof of Stakeï¼ˆPoSï¼‰æ˜¯ä¸¤ç§å¸¸è§çš„åŒºå—é“¾å…±è¯†æœºåˆ¶ï¼Œç”¨äºä¿è¯åŒºå—é“¾çš„å®‰å…¨æ€§å’Œå»ä¸­å¿ƒåŒ–ç‰¹æ€§ã€‚å®ƒä»¬çš„ä¸»è¦åŒºåˆ«åœ¨äºå¦‚ä½•é€‰ä¸¾å‡ºä¸‹ä¸€ä¸ªåŒºå—çš„è®°è´¦èŠ‚ç‚¹ã€‚</p><p>PoWæœºåˆ¶æ˜¯é€šè¿‡è®¡ç®—ä¸€å®šéš¾åº¦çš„å·¥ä½œé‡æ¥é€‰ä¸¾å‡ºä¸‹ä¸€ä¸ªåŒºå—çš„è®°è´¦èŠ‚ç‚¹ã€‚çŸ¿å·¥éœ€è¦é€šè¿‡è®¡ç®—ä¸€ä¸ªéšæœºæ•°ï¼Œä½¿å¾—è®¡ç®—ç»“æœç¬¦åˆä¸€å®šçš„è§„åˆ™ï¼Œä»¥æ­¤è·å¾—è®°è´¦æƒã€‚è¿™ç§æœºåˆ¶éœ€è¦å¤§é‡çš„è®¡ç®—èƒ½åŠ›å’Œç”µåŠ›æ¶ˆè€—ï¼Œå› æ­¤å­˜åœ¨èƒ½æºæµªè´¹å’Œç¯å¢ƒæ±¡æŸ“ç­‰é—®é¢˜ã€‚</p><p>PoSæœºåˆ¶åˆ™æ˜¯é€šè¿‡æ‹¥æœ‰ä¸€å®šæ•°é‡çš„ä»£å¸æ¥é€‰ä¸¾å‡ºä¸‹ä¸€ä¸ªåŒºå—çš„è®°è´¦èŠ‚ç‚¹ã€‚æŒæœ‰æ›´å¤šä»£å¸çš„ç”¨æˆ·ä¼šæœ‰æ›´å¤§çš„æ¦‚ç‡è¢«é€‰ä¸­ä½œä¸ºè®°è´¦èŠ‚ç‚¹ã€‚è¿™ç§æœºåˆ¶å¯ä»¥é¿å…è®¡ç®—èµ„æºå’Œèƒ½æºçš„æµªè´¹ï¼Œä½†éœ€è¦è€ƒè™‘å¦‚ä½•é¿å…å¯¡å¤´å„æ–­å’Œæ¿€åŠ±æœºåˆ¶çš„é—®é¢˜ã€‚</p><p>ä»¥ä¸‹æ˜¯PoWå’ŒPoSæœºåˆ¶çš„ä¸€äº›ä¼˜ç¼ºç‚¹ï¼š</p><p>Proof of Workï¼ˆPoWï¼‰:</p><ul><li>ä¼˜ç‚¹ï¼šå®‰å…¨æ€§é«˜ï¼Œæ”»å‡»æˆæœ¬é«˜ï¼Œå¯é¢„æµ‹æ€§å¥½ã€‚</li><li>ç¼ºç‚¹ï¼šèƒ½æºæµªè´¹ï¼Œç¯å¢ƒæ±¡æŸ“ï¼Œæ•ˆç‡ä½ï¼Œä¸­å¿ƒåŒ–é—®é¢˜ã€‚</li></ul><p>Proof of Stakeï¼ˆPoSï¼‰:</p><ul><li>ä¼˜ç‚¹ï¼šèŠ‚çœèƒ½æºï¼Œç¯ä¿ï¼Œæ•ˆç‡é«˜ï¼Œå¯æ‰©å±•æ€§å¥½ï¼Œåˆ†æ•£åŒ–ç¨‹åº¦é«˜ã€‚</li><li>ç¼ºç‚¹ï¼šå¯èƒ½å¯¼è‡´å¯¡å¤´å„æ–­ï¼Œæ¿€åŠ±æœºåˆ¶éš¾ä»¥è®¾è®¡ï¼Œå®‰å…¨æ€§æœ‰å¾…éªŒè¯ã€‚</li></ul><p>[(459æ¡æ¶ˆæ¯) [åŒºå—é“¾]å…±è¯†ç®—æ³•ï¼ˆPOW,POS,DPOS,PBFTï¼‰ä»‹ç»å’Œå¿ƒå¾—_dposå…±è¯†æœºåˆ¶_ä¹æ‰£è€å¸ˆlekkoliuçš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/lsttoy/article/details/61624287?ops_request_misc=%7B%22request_id%22:%22168594614916800186538613%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168594614916800186538613&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-2-61624287-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=pow">https://blog.csdn.net/lsttoy/article/details/61624287?ops_request_misc=%7B%22request%5Fid%22%3A%22168594614916800186538613%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=168594614916800186538613&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-2-61624287-null-null.142^v88^control_2,239^v2^insert_chatgpt&amp;utm_term=pow</a> pos&amp;spm&#x3D;1018.2226.3001.4187)</p><p>[(459æ¡æ¶ˆæ¯) åŒºå—é“¾å¿…çŸ¥åŸºç¡€çŸ¥è¯†ã€POSã€POWã€DPOSã€å…¬æœ‰é“¾ã€ç§æœ‰é“¾ã€è”ç›Ÿé“¾_åŒºå—é“¾pos_yida&amp;yuedaçš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/qq_40585384/article/details/124678390?ops_request_misc=&request_id=&biz_id=102&utm_term=pow">https://blog.csdn.net/qq_40585384/article/details/124678390?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=pow</a> pos&amp;utm_medium&#x3D;distribute.pc_search_result.none-task-blog-2<del>all</del>sobaiduweb~default-0-124678390.142^v88^control_2,239^v2^insert_chatgpt&amp;spm&#x3D;1018.2226.3001.4187)</p><h2 id="4-3-åŒæ­¥ç³»ç»Ÿä¸­çš„å…±è¯†"><a href="#4-3-åŒæ­¥ç³»ç»Ÿä¸­çš„å…±è¯†" class="headerlink" title="4.3 åŒæ­¥ç³»ç»Ÿä¸­çš„å…±è¯†"></a>4.3 åŒæ­¥ç³»ç»Ÿä¸­çš„å…±è¯†</h2><p>Dolev-Strongç®—æ³•æ˜¯ä¸€ç§ç”¨äºè§£å†³å¯†ç å­¦ä¸­çš„å®‰å…¨å¤šæ–¹è®¡ç®—ï¼ˆSecure Multiparty Computationï¼ŒSMCï¼‰é—®é¢˜çš„ç®—æ³•ã€‚è¯¥ç®—æ³•ç”±Danny Dolevå’ŒHadas Shachnai-Strongäº1991å¹´æå‡ºã€‚</p><p>å®‰å…¨å¤šæ–¹è®¡ç®—æ˜¯ä¸€ç§åŠ å¯†æŠ€æœ¯ï¼Œå…è®¸å¤šä¸ªå‚ä¸è€…åœ¨ä¸æ³„éœ²ç§æœ‰ä¿¡æ¯çš„æƒ…å†µä¸‹å…±åŒè®¡ç®—å‡ºä¸€ä¸ªç»“æœã€‚åœ¨å®‰å…¨å¤šæ–¹è®¡ç®—ä¸­ï¼Œæ¯ä¸ªå‚ä¸è€…éœ€è¦è´Ÿè´£ä¿æŠ¤è‡ªå·±çš„ç§æœ‰ä¿¡æ¯ï¼ŒåŒæ—¶åè°ƒè®¡ç®—è¿‡ç¨‹ä»¥è¾¾åˆ°é¢„æœŸçš„ç»“æœã€‚Dolev-Strongç®—æ³•å°±æ˜¯ä¸€ç§ç”¨äºå®ç°å®‰å…¨å¤šæ–¹è®¡ç®—çš„ç®—æ³•ä¹‹ä¸€ã€‚</p><p>Dolev-Strongç®—æ³•åŸºäºä¸€ç§åä¸ºäº¤äº’å¼éªŒè¯åè®®ï¼ˆInteractive Verification Protocolï¼ŒIVPï¼‰çš„æŠ€æœ¯ï¼Œé€šè¿‡å¤šè½®çš„é€šä¿¡å’ŒéªŒè¯æ¥ç¡®ä¿è®¡ç®—çš„æ­£ç¡®æ€§å’Œå®‰å…¨æ€§ã€‚è¯¥ç®—æ³•å¯ä»¥åœ¨ä¸éœ€è¦ä¿¡ä»»ç¬¬ä¸‰æ–¹çš„æƒ…å†µä¸‹å®Œæˆå®‰å…¨è®¡ç®—ï¼Œå› æ­¤å…·æœ‰å¾ˆå¥½çš„å»ä¸­å¿ƒåŒ–ç‰¹æ€§ã€‚</p><p>Dolev-Strongç®—æ³•çš„ä¸»è¦æ€æƒ³æ˜¯ï¼Œ<strong>å°†è®¡ç®—ä»»åŠ¡åˆ†è§£æˆå¤šä¸ªå­ä»»åŠ¡ï¼Œæ¯ä¸ªå‚ä¸è€…åªè´Ÿè´£è®¡ç®—å…¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶å°†è®¡ç®—ç»“æœåŠ å¯†åä¼ é€’ç»™ä¸‹ä¸€ä¸ªå‚ä¸è€…ã€‚åœ¨æ¯ä¸ªå­ä»»åŠ¡ä¹‹é—´ï¼Œå‚ä¸è€…éœ€è¦è¿›è¡ŒéªŒè¯ï¼Œä»¥ç¡®ä¿è®¡ç®—çš„æ­£ç¡®æ€§å’Œå®‰å…¨æ€§ã€‚é€šè¿‡å¤šè½®çš„äº¤äº’å’ŒéªŒè¯ï¼Œå‚ä¸è€…æœ€ç»ˆå¯ä»¥å¾—åˆ°æ­£ç¡®çš„è®¡ç®—ç»“æœï¼ŒåŒæ—¶ä¿æŠ¤è‡ªå·±çš„ç§æœ‰ä¿¡æ¯ä¸è¢«æ³„éœ²ã€‚</strong></p><p>æ€»çš„æ¥è¯´ï¼ŒDolev-Strongç®—æ³•æ˜¯ä¸€ç§åŸºäº<strong>äº¤äº’å¼éªŒè¯åè®®</strong>çš„å®‰å…¨å¤šæ–¹è®¡ç®—ç®—æ³•ï¼Œå¯ä»¥åœ¨ä¸éœ€è¦ä¿¡ä»»ç¬¬ä¸‰æ–¹çš„æƒ…å†µä¸‹å®ç°å®‰å…¨è®¡ç®—ï¼Œå…·æœ‰å¾ˆå¥½çš„<strong>å»ä¸­å¿ƒåŒ–ç‰¹æ€§</strong>ï¼Œè¢«å¹¿æ³›åº”ç”¨äºå¯†ç å­¦ã€åŒºå—é“¾å’Œåˆ†å¸ƒå¼ç³»ç»Ÿç­‰é¢†åŸŸã€‚</p><h2 id="4-4-Paxos"><a href="#4-4-Paxos" class="headerlink" title="4.4 Paxos"></a>4.4 Paxos</h2><p><a href="https://blog.csdn.net/weixin_45525272/article/details/127698249?ops_request_misc=%7B%22request_id%22:%22168174848616800213085420%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168174848616800213085420&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-2-127698249-null-null.142%5Ev84%5Epc_search_v2,239%5Ev2%5Einsert_chatgpt&utm_term=paxos&spm=1018.2226.3001.4187">(443æ¡æ¶ˆæ¯) åˆ†å¸ƒå¼å…±è¯†ç®—æ³•â€”â€”Paxosç®—æ³•ï¼ˆå›¾è§£ï¼‰_æ¨ æˆ¬çš„åšå®¢-CSDNåšå®¢</a></p><p>Paxosç®—æ³•æ˜¯ä¸€ç§ç”¨äºè§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿä¸­è¾¾æˆä¸€è‡´æ€§çš„ç®—æ³•ï¼Œç”±Leslie Lamportäº1998å¹´æå‡ºã€‚Paxosç®—æ³•çš„ç›®çš„æ˜¯ä¿è¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å„ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„çŠ¶æ€ä¸€è‡´æ€§ï¼Œå³åœ¨ä¸å¯é çš„ç½‘ç»œç¯å¢ƒä¸‹ï¼Œä¿è¯ä¸åŒèŠ‚ç‚¹å¯¹å…±äº«èµ„æºçš„æ“ä½œå…·æœ‰ç›¸åŒçš„æ•ˆæœã€‚</p><p>Paxosç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡ä¸€ä¸ªåè°ƒè€…ï¼ˆcoordinatorï¼‰å’Œå¤šä¸ªå‚ä¸è€…ï¼ˆacceptorï¼‰ä¹‹é—´çš„åä½œæ¥è¾¾æˆå…±è¯†ã€‚åœ¨Paxosç®—æ³•ä¸­ï¼Œåè°ƒè€…çš„ä¸»è¦ä»»åŠ¡æ˜¯å‘å‚ä¸è€…å‘èµ·ææ¡ˆï¼ˆproposalï¼‰ï¼Œè€Œå‚ä¸è€…çš„ä¸»è¦ä»»åŠ¡æ˜¯æ¥å—å¹¶å†³ç­–æ˜¯å¦é€šè¿‡ææ¡ˆï¼Œè¿›è€Œè¾¾æˆä¸€è‡´æ€§ã€‚</p><p>å…·ä½“æ¥è¯´ï¼ŒPaxosç®—æ³•åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š</p><ol><li>å‡†å¤‡é˜¶æ®µï¼ˆprepare phaseï¼‰ï¼šåè°ƒè€…å‘å‚ä¸è€…å‘èµ·ææ¡ˆï¼Œå¹¶è¯·æ±‚å‚ä¸è€…å‘é€è‡ªå·±æ›¾ç»æ¥å—çš„æœ€å¤§ææ¡ˆç¼–å·ï¼ˆproposal numberï¼‰ï¼Œä»¥ä¾¿åè°ƒè€…äº†è§£å½“å‰çš„ææ¡ˆçŠ¶æ€ã€‚</li><li>æ¥å—é˜¶æ®µï¼ˆaccept phaseï¼‰ï¼šå¦‚æœåè°ƒè€…è·å¾—äº†å¤§å¤šæ•°å‚ä¸è€…çš„åé¦ˆï¼Œå¹¶ä¸”æ²¡æœ‰å…¶ä»–ææ¡ˆæ­£åœ¨è¿›è¡Œï¼Œé‚£ä¹ˆåè°ƒè€…å°±å¯ä»¥å‘å‚ä¸è€…å‘èµ·æ–°çš„ææ¡ˆï¼Œå¹¶è¯·æ±‚å‚ä¸è€…æ¥å—è¯¥ææ¡ˆã€‚</li><li>å­¦ä¹ é˜¶æ®µï¼ˆlearn phaseï¼‰ï¼šä¸€æ—¦åè°ƒè€…æˆåŠŸåœ°å‘å¤§å¤šæ•°å‚ä¸è€…å‘é€äº†æ–°çš„ææ¡ˆï¼Œå¹¶å¾—åˆ°äº†åé¦ˆï¼Œé‚£ä¹ˆåè°ƒè€…å°±å¯ä»¥é€šçŸ¥æ‰€æœ‰å‚ä¸è€…æ¥å—è¯¥ææ¡ˆï¼Œä»è€Œå®Œæˆä¸€è‡´æ€§è¾¾æˆçš„è¿‡ç¨‹ã€‚</li></ol><p>æ€»çš„æ¥è¯´ï¼ŒPaxosç®—æ³•æ˜¯ä¸€ç§ç”¨äºè§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿä¸­è¾¾æˆä¸€è‡´æ€§çš„ç®—æ³•ï¼Œé€šè¿‡åè°ƒè€…å’Œå‚ä¸è€…ä¹‹é—´çš„åä½œæ¥å®ç°å…±è¯†ã€‚è¯¥ç®—æ³•è¢«å¹¿æ³›åº”ç”¨äºåˆ†å¸ƒå¼å­˜å‚¨ã€åˆ†å¸ƒå¼è®¡ç®—ã€åˆ†å¸ƒå¼æ•°æ®åº“å’ŒåŒºå—é“¾ç­‰é¢†åŸŸã€‚</p><p>Paxosç®—æ³•æ˜¯ä¸€ç§éå¸¸å¤æ‚çš„ç®—æ³•ï¼Œå®ç°å’Œç†è§£ä¸Šæœ‰ä¸€äº›ç»†èŠ‚éœ€è¦æ³¨æ„ï¼š</p><ol><li>ææ¡ˆç¼–å·ï¼ˆproposal numberï¼‰çš„ç”Ÿæˆæ–¹å¼éœ€è¦ç¡®ä¿å”¯ä¸€æ€§å’Œå¯æ¯”è¾ƒæ€§ï¼Œä¸€èˆ¬ä½¿ç”¨æ—¶é—´æˆ³å’ŒèŠ‚ç‚¹ç¼–å·ç­‰ä¿¡æ¯ç»„åˆè€Œæˆã€‚</li><li>åœ¨å‡†å¤‡é˜¶æ®µï¼Œå‚ä¸è€…éœ€è¦æ£€æŸ¥å½“å‰ææ¡ˆçš„ç¼–å·æ˜¯å¦æ¯”è‡ªå·±ä¹‹å‰æ¥å—çš„æ‰€æœ‰ææ¡ˆç¼–å·éƒ½è¦å¤§ã€‚å¦‚æœæœ‰æ›´å¤§çš„ææ¡ˆç¼–å·ï¼Œå‚ä¸è€…å°±éœ€è¦è¿”å›è¯¥ææ¡ˆçš„ç¼–å·å’Œå¯¹åº”çš„å€¼ï¼Œä»¥ä¾¿åè°ƒè€…åšå‡ºå†³ç­–ã€‚</li><li>åœ¨æ¥å—é˜¶æ®µï¼Œåè°ƒè€…éœ€è¦ç¡®ä¿è‡³å°‘æœ‰åŠæ•°çš„å‚ä¸è€…æ¥å—äº†æ–°çš„ææ¡ˆï¼Œå¹¶å°†å…¶å€¼å†™å…¥æ—¥å¿—ã€‚å¦‚æœæ— æ³•è¾¾æˆä¸€è‡´ï¼Œåè°ƒè€…éœ€è¦å›é€€å¹¶é‡æ–°å‘èµ·ææ¡ˆã€‚</li><li>åœ¨å­¦ä¹ é˜¶æ®µï¼Œåè°ƒè€…éœ€è¦é€šçŸ¥æ‰€æœ‰å‚ä¸è€…å·²ç»è¾¾æˆå…±è¯†ï¼Œå¹¶å°†ææ¡ˆå€¼å†™å…¥å…±äº«å­˜å‚¨ä¸­ã€‚</li><li>Paxosç®—æ³•è¿˜éœ€è¦è€ƒè™‘ä¸€äº›å¼‚å¸¸æƒ…å†µï¼Œä¾‹å¦‚èŠ‚ç‚¹å®•æœºã€ç½‘ç»œå»¶è¿Ÿå’Œç½‘ç»œåˆ†åŒºç­‰ï¼Œéœ€è¦é€šè¿‡å¤æ‚çš„åè®®æ¥ä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œä¸€è‡´æ€§ã€‚</li></ol><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPaxosç®—æ³•æ˜¯ä¸€ç§éå¸¸å¤æ‚çš„ç®—æ³•ï¼Œå¯¹äºåˆå­¦è€…æ¥è¯´ç†è§£èµ·æ¥æ¯”è¾ƒå›°éš¾ã€‚å› æ­¤ï¼Œå»ºè®®åœ¨å®è·µä¸­ç»“åˆé˜…è¯»ç›¸å…³æ–‡çŒ®å’Œä»£ç å®ç°ï¼Œé€æ­¥ç†è§£å…¶ç»†èŠ‚å’ŒåŸç†ã€‚</p><p><strong>ä¸ºä»€ä¹ˆè¦ææ¡ˆç¼–å·ï¼Ÿ</strong></p><ul><li>åˆ†å¸ƒå¼ç³»ç»Ÿä½¿ç”¨æ—¶é—´æˆ³ä¹‹ç±»çš„ç‰©ç†æ—¶é—´å¯èƒ½å¹¶ä¸å‡†ç¡®</li><li>è½®æ¬¡+æœåŠ¡å™¨id</li></ul><h2 id="4-5-Goå®ç°Paxos"><a href="#4-5-Goå®ç°Paxos" class="headerlink" title="4.5 Goå®ç°Paxos"></a>4.5 Goå®ç°Paxos</h2><h2 id="4-6-Multi-Paxos"><a href="#4-6-Multi-Paxos" class="headerlink" title="4.6 Multi-Paxos"></a>4.6 Multi-Paxos</h2><p>Multi-Paxosæ˜¯Paxosç®—æ³•çš„ä¸€ä¸ªå˜ç§ï¼Œç”¨äºä¼˜åŒ–Paxosç®—æ³•åœ¨å¤šæ¬¡ææ¡ˆçš„æƒ…å†µä¸‹çš„æ€§èƒ½ã€‚åœ¨Paxosç®—æ³•ä¸­ï¼Œæ¯æ¬¡ææ¡ˆéƒ½éœ€è¦æ‰§è¡Œä¸€æ¬¡å®Œæ•´çš„Paxosæµç¨‹ï¼ŒåŒ…æ‹¬å‡†å¤‡ã€æ¥å—å’Œå­¦ä¹ ä¸‰ä¸ªé˜¶æ®µï¼Œè¿™ä¼šå¯¼è‡´Paxosç®—æ³•çš„æ€§èƒ½æ¯”è¾ƒä½ã€‚</p><p>Multi-Paxosé€šè¿‡å¼•å…¥é¢†å¯¼è€…ï¼ˆleaderï¼‰çš„æ¦‚å¿µæ¥ä¼˜åŒ–Paxosç®—æ³•çš„æ€§èƒ½ã€‚åœ¨Multi-Paxosä¸­ï¼Œé¢†å¯¼è€…è´Ÿè´£å‘å‚ä¸è€…å‘èµ·ææ¡ˆï¼Œè€Œå‚ä¸è€…åˆ™åªéœ€è¦æ ¹æ®é¢†å¯¼è€…çš„æŒ‡ç¤ºæ¥å†³ç­–æ˜¯å¦æ¥å—ææ¡ˆã€‚å› æ­¤ï¼Œé¢†å¯¼è€…å¯ä»¥åœ¨ä¸€æ®µæ—¶é—´å†…å‘èµ·å¤šä¸ªææ¡ˆï¼Œä»è€Œé¿å…äº†æ¯æ¬¡ææ¡ˆéƒ½éœ€è¦æ‰§è¡Œå®Œæ•´çš„Paxosæµç¨‹çš„é—®é¢˜ã€‚</p><p>å…·ä½“æ¥è¯´ï¼ŒMulti-Paxosçš„æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li>é¢†å¯¼è€…å‘å‚ä¸è€…å‘èµ·ä¸€ä¸ªææ¡ˆï¼ŒåŒ…æ‹¬ææ¡ˆç¼–å·å’Œææ¡ˆå€¼ã€‚</li><li>å‚ä¸è€…æ ¹æ®ææ¡ˆç¼–å·è¿›è¡Œå†³ç­–ï¼šå¦‚æœå½“å‰çš„ææ¡ˆç¼–å·æ¯”ä¹‹å‰æ¥å—çš„æ‰€æœ‰ææ¡ˆç¼–å·éƒ½è¦å¤§ï¼Œé‚£ä¹ˆå‚ä¸è€…å°±æ¥å—è¯¥ææ¡ˆï¼Œå¹¶å‘é¢†å¯¼è€…å‘é€æ¥å—æ¶ˆæ¯ï¼›å¦åˆ™ï¼Œå‚ä¸è€…å°±æ‹’ç»è¯¥ææ¡ˆï¼Œå¹¶å‘é¢†å¯¼è€…å‘é€æ‹’ç»æ¶ˆæ¯ã€‚</li><li>å¦‚æœé¢†å¯¼è€…æ”¶åˆ°äº†å¤§å¤šæ•°å‚ä¸è€…çš„æ¥å—æ¶ˆæ¯ï¼Œé‚£ä¹ˆè¯¥ææ¡ˆå°±è¢«ç¡®å®šï¼Œå¹¶å‘æ‰€æœ‰å‚ä¸è€…å‘é€ç¡®å®šæ¶ˆæ¯ï¼Œå®Œæˆè¯¥ææ¡ˆçš„å­¦ä¹ é˜¶æ®µã€‚</li><li>å¦‚æœé¢†å¯¼è€…æ”¶åˆ°äº†å¤§å¤šæ•°å‚ä¸è€…çš„æ‹’ç»æ¶ˆæ¯ï¼Œé‚£ä¹ˆé¢†å¯¼è€…å°±éœ€è¦é‡æ–°é€‰æ‹©ä¸€ä¸ªææ¡ˆç¼–å·ï¼Œå¹¶é‡æ–°å‘èµ·ææ¡ˆã€‚</li></ol><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒMulti-Paxosä»ç„¶éœ€è¦ä¿è¯Paxosç®—æ³•çš„æ­£ç¡®æ€§å’Œä¸€è‡´æ€§ï¼Œä½†é€šè¿‡å¼•å…¥é¢†å¯¼è€…æ¥ä¼˜åŒ–æ€§èƒ½ï¼Œä½¿å¾—Multi-Paxosåœ¨å®é™…åº”ç”¨ä¸­æ›´åŠ é«˜æ•ˆã€‚</p><h2 id="4-8-Raftç®—æ³•"><a href="#4-8-Raftç®—æ³•" class="headerlink" title="4.8 Raftç®—æ³•"></a>4.8 Raftç®—æ³•</h2><p><strong>è¦æŒä¹…åŒ–å­˜å‚¨çš„ä¿¡æ¯ï¼š</strong></p><ul><li>currentTermï¼šå½“å‰ä»»æœŸï¼Œç”¨äºæ¢å¤</li><li>votefor:å‘è°æŠ•ç¥¨ï¼ŒåªæŠ•ä¸ªç¬¬ä¸€ä¸ªå‘é€RequestVote RPCçš„äººè€Œæ‹’ç»å…¶ä»–å‘é€RequestVote RPCçš„äºº</li><li>æ—¥å¿—ï¼šåŒ…å«ç´¢å¼•ä½ç½®ï¼Œä»»æœŸå·ï¼Œå‘½ä»¤æœ¬èº«ï¼Œå¦‚æœæ—¥å¿—åœ¨åŠæ•°èŠ‚ç‚¹ä¸Šè¢«å­˜å‚¨ï¼Œåˆ™è¯¥è®°å½•å¯æäº¤ã€‚æ³¨æ„ï¼Œé¢†å¯¼è€…å…ˆå°†æ—¥å¿—æŒä¹…åŒ–å­˜å‚¨åˆ°æœ¬åœ°ï¼Œå†å¹¶è¡Œç”¨AppendEntries RPCå‘é€åˆ°å…¶ä»–èŠ‚ç‚¹ä¸Šã€‚è¿™æ—¶ï¼Œå¦‚æœæ”¶åˆ°è¶…è¿‡åŠæ•°çš„å“åº”ï¼Œåˆ™é¢†å¯¼è€…å°†å‘½ä»¤åº”ç”¨äºè‡ªå·±çš„çŠ¶æ€æœºï¼Œæäº¤è¯¥æ—¥å¿—ï¼Œç„¶åå‘å®¢æˆ·ç«¯è¿”å›å“åº”ã€‚åç»­çš„æ—¥å¿—å¤åˆ¶RPCä¸­è¿˜åŒ…å«LeaderCommitè¡¨æ˜é¢†å¯¼è€…å·²ç»æäº¤çš„æ—¥å¿—çš„æœ€å¤§ç´¢å¼•ï¼Œè·Ÿéšè€…æ”¶åˆ°æ­¤RPCæ—¶ä¹Ÿä¼šæäº¤æ‰€æœ‰å°äºè¯¥ç´¢å¼•çš„æ—¥å¿—</li></ul><p><strong>ä¸¤ä¸ªRPCï¼š</strong></p><ul><li>RequestVote RPC ï¼šç”¨äºé¢†å¯¼è€…é€‰ä¸¾ï¼ŒåŒ…å«term,id,lastLogIndex,lastLogTermï¼ŒåŒæ ·åœ¨ç”¨äºé¢†å¯¼è€…é€‰ä¸¾ä¸­ï¼Œæœ€åä¸¤ä¸ªå±æ€§è‹¥term&gt;è·Ÿéšè€…çš„termæˆ–è€…termç›¸ç­‰ä½†indexå¤§äºè·Ÿéšè€…æœ€åä¸€æ¡æ—¥å¿—çš„indexï¼Œåˆ™è·Ÿéšè€…æ‰ä¼šæŠ•ç¥¨ï¼ŒåŒç†ä¹Ÿéœ€è¦ä¸€åŠæŠ•ç¥¨æ‰è¡Œï¼Œè¿™ç¡®ä¿äº†é¢†å¯¼è€…åœ¨è¶…è¿‡åŠæ•°ç»™ä»–æŠ•ç¥¨çš„èŠ‚ç‚¹ä¸­æ‹¥æœ‰æœ€å®Œæ•´çš„æ—¥å¿—ã€‚</li><li>AppendEntries RPC ï¼š ç”¨äºå¤åˆ¶æ—¥å¿—&#x2F;å‘é€å¿ƒè·³ä¿¡æ¯ï¼Œåç»­çš„æ—¥å¿—å¤åˆ¶RPCä¸­è¿˜åŒ…å«LeaderCommitè¡¨æ˜é¢†å¯¼è€…å·²ç»æäº¤çš„æ—¥å¿—çš„æœ€å¤§ç´¢å¼•ï¼Œè·Ÿéšè€…æ”¶åˆ°æ­¤RPCæ—¶ä¹Ÿä¼šæäº¤æ‰€æœ‰å°äºè¯¥ç´¢å¼•çš„æ—¥å¿—</li></ul><p><strong>èŠ‚ç‚¹è½¬æ¢æµç¨‹ï¼š</strong></p><ul><li><p><img src="https://s2.loli.net/2024/06/26/Ta59hwiKOP8bEAI.jpg" alt="184BF7AF3986E254E406FB773D48170F.jpg"></p></li><li><p>åªæœ‰å‘ç”Ÿä»¥ä¸‹ä¸‰ç§æƒ…å†µä¹‹ä¸€æ‰æ›´æ–°è‡ªå·±çš„çŠ¶æ€</p><ul><li>RequestVote RPCæ”¶åˆ°è¶…è¿‡åŠæ•°çš„é€‰ç¥¨ï¼Œå˜ä¸ºé¢†å¯¼è€…</li><li>æ”¶åˆ°æ¥è‡ªå…¶ä»–é¢†å¯¼è€…çš„AppendEntriesï¼Œé€€åŒ–ä¸ºè·Ÿéšè€…</li><li>æ²¡å‘ç”Ÿä¸Šè¿°ä¸¤ç§æƒ…å†µï¼Œä»»æœŸ++ï¼ŒæŠ•è‡ªå·±ä¸€ç¥¨</li><li><img src="https://s2.loli.net/2024/06/26/PAk64Yw2OWc7rzm.jpg" alt="D2DEF7CFA7530BD2C2B1301FAA8C0159.jpg"></li></ul></li></ul><p><strong>ä¿è¯ä¸¤ä¸ªç‰¹æ€§ï¼š</strong></p><ul><li>å®‰å…¨æ€§ï¼šä¸€ä¸ªä»»æœŸå†…æœ€å¤šåªæœ‰ä¸€ä¸ªé¢†å¯¼è€…è¢«é€‰å‡ºæ¥</li><li>æ´»æ€§ï¼šç³»ç»Ÿæœ€ç»ˆèƒ½é€‰å‡ºä¸€ä¸ªé¢†å¯¼è€…</li></ul><p><strong>è§£å†³æ´»é”é—®é¢˜ï¼ˆæ²¡äººå¯ä»¥è·å¾—è¶…è¿‡ä¸€åŠé€‰ç¥¨ï¼‰ï¼š</strong></p><ul><li>èŠ‚ç‚¹éšæœºé€‰æ‹©è¶…æ—¶æ—¶é—´ï¼ˆT-2TæœŸé—´ï¼ŒTè¶Šå¤§äºç½‘ç»œä¼ æ’­æ—¶é—´æ•ˆæœè¶ŠåŠ ï¼Œä½†åŒæ—¶ä¸èƒ½å¤ªå¤§ï¼Œå¦åˆ™æ€§èƒ½ä¼šå—åˆ°å½±å“ï¼‰</li></ul><p><strong>ä¸¤ä¸ªç‰¹æ€§ï¼š</strong></p><ul><li>å¦‚æœä»»æœŸå’Œç´¢å¼•ç›¸åŒï¼Œåˆ™æ—¥å¿—æ¡ç›®å®Œå…¨ç›¸åŒï¼Œæ—¥å¿—å†…å®¹ç›¸åŒï¼Œä¸”ä¹‹å‰çš„æ—¥å¿—ä¹Ÿå®Œå…¨ç›¸åŒï¼ˆæ•°å­¦å½’çº³æ³•ï¼Ÿï¼‰</li><li>RAFTä¸å…è®¸å‡ºç°æ—¥å¿—ç©ºæ´ï¼Œå¿…é¡»è¿ç»­æäº¤æ—¥å¿—</li><li>ä¸ºäº†ç»´æŠ¤è¿™ä¸¤ä¸ªç‰¹æ€§ï¼Œåœ¨AppendEntriesä¸­è¿˜æœ‰ä¹‹å‰ä¸€ä¸ªæ—¥å¿—çš„prevLogIndexå’Œä»»æœŸprevLogTermï¼Œè·Ÿéšè€…æ”¶åˆ°åï¼Œä¼šæ£€æŸ¥è‡ªå·±æœ€åä¸€æ¡æ—¥å¿—çš„indexå’Œtermæ˜¯å¦åŒ¹é…ï¼Œè‹¥åŒ¹é…ï¼Œåˆ™æ¥å—ï¼Œå¦åˆ™æ‹’ç»ã€‚ï¼ˆä¸€è‡´æ€§æ£€æŸ¥ï¼‰</li></ul><p><strong>å»¶è¿Ÿæäº¤ï¼š</strong></p><ul><li>ä¸ºä»€ä¹ˆéœ€è¦å»¶è¿Ÿæäº¤ï¼Ÿ<ul><li>è‹¥å‡ºç°ç½‘ç»œåˆ†åŒºï¼Œå¯¼è‡´Båˆ†åŒºä¸­çš„ä¸€ä¸ªæœåŠ¡å™¨æ‹¥æœ‰æ›´æ–°ä»»æœŸçš„æ—¥å¿—ï¼ˆæ¯”å¦‚3ï¼‰ï¼Œè€ŒAåˆ†åŒºä¸­çš„é¢†å¯¼è€…ï¼ˆæ­¤æ—¶åœ¨ä»»æœŸ4ï¼Œè€Œæœ€æ–°çš„æ—¥å¿—ä»»æœŸä¸º2ï¼‰ï¼Œè‹¥æäº¤åå®•æœºï¼ˆè€ŒAåˆ†åŒºä¸­å…¶ä»–æœåŠ¡å™¨çš„æ—¥å¿—ä»»æœŸä¹Ÿä¸º2ï¼Œä½†æœªæäº¤ï¼‰ï¼Œè€ŒBåˆ†åŒºä¸­çš„æœåŠ¡å™¨æ­¤æ—¶æ°å¥½åˆæˆä¸ºæ–°çš„é¢†å¯¼è€…ï¼ˆä»»æœŸ5ï¼‰ï¼Œæ­¤æ—¶åˆ™ä¼šè¦†ç›–æ‰Aåˆ†åŒºä¸­æœªæäº¤ä»»æœŸä¸ºæ—¥å¿—2çš„æœåŠ¡å™¨çš„æ—¥å¿—ï¼Œè€Œå®é™…ä¸Šï¼ŒAåˆ†åŒºä¹‹å‰çš„é¢†å¯¼è€…å®é™…ä¸Šå·²ç»æäº¤äº†è¯¥æ—¥å¿—ï¼Œè¿™ä¸ç¬¦åˆå·²æäº¤æ—¥å¿—ä¸èƒ½è¢«ä¿®æ”¹çš„éœ€æ±‚</li></ul></li><li>æ€ä¹ˆå»¶è¿Ÿæäº¤<ul><li>æ—¥å¿—å¿…é¡»å­˜å‚¨åœ¨è¶…è¿‡åŠæ•°èŠ‚ç‚¹ä¸Š</li><li>é¢†å¯¼è€…å¿…é¡»çœ‹åˆ°è¶…è¿‡åŠæ•°èŠ‚ç‚¹ä¸Šè¿˜å­˜å‚¨ç€è‡³å°‘ä¸€æ¡è‡ªå·±ä»»æœŸå†…çš„è®°å½•</li><li>é¢†å¯¼è€…åªèƒ½æäº¤è‡ªå·±ä»»æœŸçš„æ—¥å¿—ï¼Œä»è€Œé—´æ¥æäº¤ä¹‹å‰ä»»æœŸçš„æ—¥å¿—</li><li>no-opæ—¥å¿—ï¼šåªæœ‰ç´¢å¼•å’Œæ—¥æœŸï¼Œä¿æŒé¢†å¯¼è€…çš„æƒå¨<ul><li>åœ¨é¢†å¯¼è€…åˆšé€‰ä¸¾æˆåŠŸæ—¶ï¼Œå°±æœ¬åœ°è¿½åŠ no-opæ—¥å¿—ï¼ˆåªåŒ…å«ä»»æœŸï¼‰ï¼ŒåŒæ—¶appendEntriesåˆ°å…¶ä»–çš„èŠ‚ç‚¹ï¼Œæ˜¾ç„¶ï¼Œno-opæ—¥å¿—çš„ä»»æœŸå°±æ˜¯é¢†å¯¼è€…å½“å‰çš„ä»»æœŸï¼Œå½“ç„¶èƒ½æäº¤ï¼Œä»è€Œé—´æ¥æäº¤ä¹‹å‰çš„ä»»æœŸçš„æ—¥å¿—</li></ul></li></ul></li></ul><p><strong>æ¸…ç†ä¸ä¸€æ ·çš„æ—¥å¿—ï¼š</strong></p><ul><li>ä¸¤ç§ä¸ä¸€æ ·çš„æ—¥å¿—ï¼Œç¼ºå¤±&#x2F;å¤šå‡ºæ¥çš„<ul><li>å‰è€…ç›´æ¥AppendEntriesæ¥è¡¥é½ï¼ˆä¹Ÿè¦ç”¨åˆ°nextIndexï¼‰</li><li>åè€…ï¼Œé¢†å¯¼è€…ä¸ºæ¯ä¸ªè·Ÿéšè€…ä¿å­˜nextIndex[]å˜é‡ï¼Œå­˜å‚¨é¢†å¯¼è€…æœ€åä¸€æ¡æ—¥å¿—çš„ç´¢å¼•+1</li></ul></li><li>æµç¨‹<ul><li>é’ˆå¯¹ç¼ºå¤±çš„ï¼šé¢†å¯¼è€…æ£€æŸ¥è‡ªå·±çš„æ—¥å¿—ï¼Œæœ€æ–°indexä¸º10ï¼Œç„¶åæ¯”å¦‚å¯¹äºè·Ÿéšè€…1ï¼ŒnextIndex[1]&#x3D;11,å¸¦ä¸Šå‰ä¸€ä¸ªæ—¥å¿—æ¡ç›®çš„å”¯ä¸€æ ‡è¯†ï¼ˆ10ï¼Œä»»æœŸ6ï¼‰ï¼Œè·Ÿéšè€…1ç´¢å¼•ä¸º10å¤„æ²¡æœ‰æ—¥å¿—ï¼Œé€’å‡nextIndex[1],ç›´åˆ°nextIndex[1]&#x3D;5,ç´¢å¼•4ä¸”ä»»æœŸ4çš„æ—¥å¿—åŒ¹é…ï¼Œè¡¥é½ç´¢å¼•5-10</li><li>é’ˆå¯¹å¤šå‡ºæ¥çš„ï¼Œè·Ÿä¸Šé¢ä¸€æ ·ï¼Œç›´åˆ°æ‰¾åˆ°åŒ¹é…çš„indexï¼Œè€Œä¹‹åçš„å…¨éƒ¨åˆ é™¤å³å¯</li></ul></li></ul><p><strong>å¤„ç†æ—§é¢†å¯¼è€…ï¼š</strong></p><ul><li>RPCè¯·æ±‚æœ‰è‡ªå·±çš„ä»»æœŸï¼Œå¦‚æœå‘ç”Ÿç½‘ç»œåˆ†åŒºï¼Œè€çš„é¢†å¯¼è€…è¿˜ä»¥ä¸ºè‡ªå·±æ˜¯é¢†å¯¼è€…ï¼Œä»–çš„RPCåœ¨è¢«å…¶ä»–Followeræ¥æ”¶åˆ°çš„æ—¶å€™ï¼Œä½†å‡¡Followerå·²çŸ¥çš„ä»»æœŸæ¯”ä»–æ–°ï¼Œéƒ½ä¼šè¿”å›æ‹’ç»æ¶ˆæ¯ï¼Œä½†å‡¡æ¥æ”¶åˆ°æ‹’ç»æ¶ˆæ¯ï¼Œè€çš„é¢†å¯¼è€…å°±è·Ÿå’½äº†æ°”çš„çš®çƒä¼¼çš„å˜ä¸ºè·Ÿéšè€…ã€‚</li></ul><p><strong>é…ç½®å˜æ›´ï¼š</strong></p><ul><li>ä½¿ç”¨ <strong>Joint Consensus</strong>ï¼ˆè”åˆå…±è¯†ï¼‰å®Œæˆä¸¤é˜¶æ®µåè®®<ul><li>ç¬¬ä¸€é˜¶æ®µ,C<strong>old+new</strong>ï¼Œå¤šæ•°æ´¾ï¼Œæäº¤</li><li>ç¬¬äºŒé˜¶æ®µ,Cnewï¼Œå¤šæ•°æ´¾ï¼Œæäº¤ï¼Œæäº¤ååç»­é…ç½®éƒ½åŸºäºCnewï¼ˆä¸åœ¨Cnewçš„é¢†å¯¼è€…ä¸‹å°ï¼‰<ul><li>ä¸åœ¨Cnewçš„é¢†å¯¼è€…ä¸‹å°ä¼šå¯¼è‡´ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œä¸åœ¨Cnewçš„è·Ÿéšè€…å°†ä¸å†æ”¶åˆ°å¿ƒè·³ï¼Œå› æ­¤å…¶ä¼šå‚ä¸é¢†å¯¼è€…é€‰ä¸¾ï¼ˆå°½ç®¡ä¼šå› ä¸ºæ—¥å¿—ä¸å¤Ÿæ–°è€Œå¯¼è‡´ç«é€‰å¤±è´¥ï¼Œä½†æ˜¯è¿˜æ˜¯ä¼šå½±å“ç«é€‰è¿‡ç¨‹å¯¼è‡´å¯ç”¨æ€§å˜å·®ï¼‰<ul><li>è§£å†³ï¼šPre-Voteé˜¶æ®µï¼Œå°±è¿˜æ˜¯å‘é€Pre-Voteè¯·æ±‚è¯¢é—®æ•´ä¸ªç³»ç»Ÿâ€œæˆ‘åˆ°åº•æœ‰æ²¡æœ‰èµ„æ ¼å‚ä¸ç«é€‰â€ï¼ˆè¿™ä¸ªèµ„æ ¼è¿˜æ˜¯æ ¹æ®ä»»æœŸä»¥åŠæ—¥å¿—Indexæ¥åˆ¤æ–­çš„ï¼‰ã€‚ä½†è¿™æ ·ä¼šæœ‰ä¸ªé—®é¢˜å°±æ˜¯ï¼Œå¦‚æœåœ¨Cnewé›†ç¾¤ä¸­çš„é¢†å¯¼è€…è¿˜æ²¡æœ‰æŠŠCnewçš„æ—¥å¿—å‘åˆ°å…¶è·Ÿéšè€…ä¸Šï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè·Ÿéšè€…çš„æ—¥å¿—è¿˜ä¸å¤Ÿæ–°ï¼Œé‚£ä¹ˆå°±ç®—æœ‰Pre-Voteï¼Œå¯èƒ½è¿˜æ˜¯ä¼šå½±å“é€‰ä¸¾ï¼Œå¯¼è‡´ä¸åœ¨Cnewçš„æœåŠ¡èŠ‚ç‚¹ç«é€‰æˆåŠŸ</li><li>å¢å¼ºPre-Voteåˆ¤æ–­æ¡ä»¶ï¼š<ul><li>ä»»æœŸæ›´å¤§ï¼Œæˆ–è€…ä»»æœŸç›¸åŒç´¢å¼•æ›´å¤§</li><li>è‡³å°‘ä¸€æ¬¡é€‰ä¸¾æ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°é¢†å¯¼è€…å¿ƒè·³</li></ul></li><li>æ³¨æ„åˆ°åœ¨Pre-Voteé˜¶æ®µä¸ä¼šå¢åŠ è‡ªå·±çš„ä»»æœŸï¼Œæ‰€ä»¥Pre-Voteä¸ä»…å¯ä»¥è§£å†³é…ç½®æ›´æ”¹å¹²æ‰°é¢†å¯¼è€…çš„é—®é¢˜ï¼Œè¿˜èƒ½è§£å†³ç½‘ç»œåˆ†åŒºè„‘è£‚å’Œä»»æœŸçˆ†ç‚¸å¢é•¿çš„é—®é¢˜</li><li>ç¤ºä¾‹ï¼šetcdï¼Œå°†å€™é€‰è€…ç»†åˆ†ä¸ºé¢„å€™é€‰è€…å’Œå€™é€‰è€…ï¼Œå‰è€…å‘é€Pre-Voteï¼Œä¸å¢åŠ æ—¥æœŸï¼Œåè€…å‘é€RequestVoteï¼Œä¼šå¢åŠ ä»»æœŸ</li></ul></li></ul></li></ul></li></ul><p><strong>æ—¥å¿—å‹ç¼©ï¼š</strong></p><ul><li>å…³æ³¨æœ€ç»ˆçŠ¶æ€</li><li>å‹ç¼©åå¾—åˆ°å¿«ç…§ï¼ŒæŒä¹…åŒ–å­˜å‚¨</li><li>æ¯ä¸ªæœåŠ¡å™¨ç‹¬ç«‹åœ°å‹ç¼©å…¶å·²æäº¤çš„æ—¥å¿—</li><li>ä¿å­˜æœ€åä¸€æ¡è¢«ä¸¢å¼ƒçš„æ—¥å¿—çš„ç´¢å¼•å’Œä»»æœŸï¼Œç”¨AppendEntriesè¿›è¡Œæ—¥å¿—ä¸€è‡´æ€§çš„æ£€æŸ¥</li><li>ä¸€æ—¦ä¸¢å¼ƒäº†å‰é¢éƒ¨åˆ†çš„æ—¥å¿—ï¼Œé¢†å¯¼è€…è¦æ‰¿æ‹…ä¸¤ä¸ªè´£ä»»ï¼š<ul><li>å¦‚æœæœåŠ¡å™¨é‡å¯äº†ï¼Œåˆ™éœ€è¦å°†æœ€æ–°çš„å¿«ç…§åŠ è½½åˆ°çŠ¶æ€æœºåå†æ¥æ”¶æ—¥å¿—</li><li>å‘è¾ƒæ…¢çš„è·Ÿéšç€å‘é€ä¸€è‡´çš„çŠ¶æ€å¿«ç…§(InstrallSnapshot RPC)</li></ul></li><li>LastIncludeIndexå’ŒLastIncludeTermï¼Œè®°å½•çŠ¶æ€ï¼Œä¹‹å‰çš„æ—¥å¿—å…¨éƒ¨ä¸¢å¼ƒ</li><li>åœ¨æ­£å¸¸è¿è¡ŒæœŸé—´é€šè¿‡å†™æ—¶å¤åˆ¶æŠ€æœ¯ï¼ˆCOWï¼‰ç”Ÿæˆå¿«ç…§ï¼ˆå¼€æºLogCabinï¼‰</li></ul><h2 id="4-9-Raftå’ŒPaxos"><a href="#4-9-Raftå’ŒPaxos" class="headerlink" title="4.9 Raftå’ŒPaxos"></a>4.9 Raftå’ŒPaxos</h2><p>Raftå’ŒPaxoséƒ½æ˜¯åˆ†å¸ƒå¼ä¸€è‡´æ€§ç®—æ³•ï¼Œå®ƒä»¬éƒ½è¢«å¹¿æ³›åº”ç”¨äºæ„å»ºé«˜å¯ç”¨æ€§ã€é«˜å¯é æ€§çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚</p><p>Paxosæ˜¯æœ€æ—©æå‡ºçš„åˆ†å¸ƒå¼ä¸€è‡´æ€§ç®—æ³•ä¹‹ä¸€ï¼Œç”±Leslie Lamportåœ¨1990å¹´ä»£åˆæœŸæå‡ºã€‚Paxosç®—æ³•åŒ…å«äº†ä¸¤ä¸ªä¸»è¦çš„ç»„ä»¶ï¼šleaderé€‰ä¸¾å’ŒçŠ¶æ€å¤åˆ¶ã€‚å®ƒçš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡åœ¨èŠ‚ç‚¹ä¹‹é—´è¾¾æˆå…±è¯†æ¥å®ç°çŠ¶æ€çš„å¤åˆ¶å’Œä¸€è‡´æ€§ã€‚</p><p>Raftæ˜¯ä¸€ç§æ–°è¿‘å‡ºç°çš„åˆ†å¸ƒå¼ä¸€è‡´æ€§ç®—æ³•ï¼Œç”±Diego Ongaroå’ŒJohn Ousterhoutäº2013å¹´æå‡ºã€‚Raftç®—æ³•ä¹ŸåŒ…å«äº†leaderé€‰ä¸¾å’ŒçŠ¶æ€å¤åˆ¶ä¸¤ä¸ªä¸»è¦éƒ¨åˆ†ï¼Œå®ƒå¼ºåŒ–äº†å®¹é”™æœºåˆ¶å’Œå¯è¯»æ€§ï¼Œä½¿å¾—å®ƒæ›´å®¹æ˜“è¢«ç†è§£å’Œå®ç°ã€‚</p><p>ç›¸æ¯”è€Œè¨€ï¼ŒRaftä¸Paxosç›¸æ¯”è¾ƒå…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p><ol><li>ç†è§£å’Œå®ç°å®¹æ˜“ï¼šRaftç®—æ³•æŠŠåˆ†å¸ƒå¼ä¸€è‡´æ€§é—®é¢˜åˆ†æˆäº†å‡ ä¸ªç‹¬ç«‹çš„å­é—®é¢˜ï¼Œåˆ†åˆ«å¤„ç†ï¼Œæ¯ä¸ªå­é—®é¢˜éƒ½æ¯”è¾ƒå®¹æ˜“ç†è§£å’Œå®ç°ï¼Œä½¿å¾—æ•´ä¸ªç®—æ³•æ›´åŠ å®¹æ˜“ç†è§£å’Œå®ç°ã€‚</li><li>æ›´å¥½çš„å¯è¯»æ€§ï¼šRaftçš„ç®—æ³•æè¿°æ›´æ¥è¿‘æ—¥å¸¸ä½¿ç”¨ä¸­çš„æœ¯è¯­ï¼Œæ›´å®¹æ˜“ç†è§£ï¼Œåœ¨é˜…è¯»å’Œä¿®æ”¹ä»£ç æ—¶æ›´åŠ æ–¹ä¾¿ã€‚</li><li>æ›´å¥½çš„æ€§èƒ½ï¼šRaftç®—æ³•çš„æ€§èƒ½æ¯”Paxosç®—æ³•æ›´å¥½ï¼Œç‰¹åˆ«æ˜¯åœ¨ç½‘ç»œä¸ç¨³å®šæˆ–è€…å‡ºç°ç½‘ç»œåˆ†åŒºçš„æƒ…å†µä¸‹ï¼ŒRaftç®—æ³•çš„è¡¨ç°æ›´åŠ ä¼˜ç§€ã€‚</li></ol><p>æ€»ä¹‹ï¼Œè™½ç„¶Raftå’ŒPaxoséƒ½æ˜¯ç”¨äºå®ç°åˆ†å¸ƒå¼ä¸€è‡´æ€§çš„ç®—æ³•ï¼Œä½†æ˜¯å®ƒä»¬æœ‰ç€ä¸åŒçš„è®¾è®¡æ€è·¯å’Œå®ç°æ–¹å¼ã€‚Raftç®—æ³•åœ¨æ˜“ç”¨æ€§å’Œå¯è¯»æ€§æ–¹é¢ï¼Œç›¸å¯¹Paxosç®—æ³•æ›´èƒœä¸€ç­¹ï¼Œä½†åœ¨å®é™…çš„åº”ç”¨åœºæ™¯ä¸­ï¼Œä¸åŒçš„é—®é¢˜éœ€è¦é€‰æ‹©æœ€é€‚åˆçš„ç®—æ³•æ¥è§£å†³ã€‚</p><h2 id="4-10-æ‹œå åº­å®¹é”™å’ŒPBFTç®—æ³•"><a href="#4-10-æ‹œå åº­å®¹é”™å’ŒPBFTç®—æ³•" class="headerlink" title="4.10 æ‹œå åº­å®¹é”™å’ŒPBFTç®—æ³•"></a>4.10 æ‹œå åº­å®¹é”™å’ŒPBFTç®—æ³•</h2><p>Raftå’ŒPaxosï¼Œéƒ½æ˜¯éå¸¸é«˜æ•ˆçš„ç®—æ³•ï¼Œä»–ä»¬åªæ”¯æŒCFTï¼ˆCrash fault toleranceï¼‰ï¼Œåªå…è®¸ç³»ç»Ÿå†…èŠ‚ç‚¹å®•æœºï¼ˆcrashï¼‰ï¼Œå¹¶ä¸è€ƒè™‘ç³»ç»Ÿå†…æœ‰ä½œæ¶èŠ‚ç‚¹ã€‚</p><p><a href="https://zhuanlan.zhihu.com/p/53897982">å…±è¯†ç®—æ³•ç³»åˆ—ï¼šPBFTç®—æ³•å…³é”®ç‚¹ç»¼è¿°ã€ä¼˜ç¼ºç‚¹æ€»ç»“ - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://zhuanlan.zhihu.com/p/35847127">å…±è¯†ç®—æ³•ç³»åˆ—ä¹‹ä¸€ï¼šraftå’Œpbftç®—æ³• - çŸ¥ä¹ (zhihu.com)</a></p><p><img src="https://s2.loli.net/2024/06/26/KorHVJc7exkftXw.webp" alt="v2-1b29af254f0cc338876f232e32415878_1440w[1].webp"></p>]]></content>
      
      
      <categories>
          
          <category> åˆ†å¸ƒå¼ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ†å¸ƒå¼ç³»ç»Ÿ </tag>
            
            <tag> æ·±å…¥ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ·±å…¥ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿï¼ˆå…­ï¼‰æ—¶é—´å’Œäº‹ä»¶é¡ºåº</title>
      <link href="/2024/06/26/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%EF%BC%88%E5%85%AD%EF%BC%89%E6%97%B6%E9%97%B4%E5%92%8C%E4%BA%8B%E4%BB%B6%E9%A1%BA%E5%BA%8F/"/>
      <url>/2024/06/26/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%EF%BC%88%E5%85%AD%EF%BC%89%E6%97%B6%E9%97%B4%E5%92%8C%E4%BA%8B%E4%BB%B6%E9%A1%BA%E5%BA%8F/</url>
      
        <content type="html"><![CDATA[<h1 id="æ—¶é—´å’Œäº‹ä»¶é¡ºåº"><a href="#æ—¶é—´å’Œäº‹ä»¶é¡ºåº" class="headerlink" title="æ—¶é—´å’Œäº‹ä»¶é¡ºåº"></a>æ—¶é—´å’Œäº‹ä»¶é¡ºåº</h1><h2 id="6-1-ç‰©ç†æ—¶é’Ÿ"><a href="#6-1-ç‰©ç†æ—¶é’Ÿ" class="headerlink" title="6.1 ç‰©ç†æ—¶é’Ÿ"></a>6.1 ç‰©ç†æ—¶é’Ÿ</h2><ul><li>æœºæ¢°æ—¶é’Ÿ</li><li>çŸ³è‹±æ—¶é’Ÿ</li><li>åŸå­é’Ÿï¼šåŸå­å…±æŒ¯é¢‘ç‡æ ‡å‡†æ¥è®¡ç®—</li><li>GPS</li></ul><h2 id="6-2-æ—¶é’ŸåŒæ­¥"><a href="#6-2-æ—¶é’ŸåŒæ­¥" class="headerlink" title="6.2 æ—¶é’ŸåŒæ­¥"></a>6.2 æ—¶é’ŸåŒæ­¥</h2><p>NTP:<a href="https://blog.csdn.net/weixin_45057618/article/details/120200341?ops_request_misc=%7B%22request_id%22:%22168243248816800182751293%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168243248816800182751293&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-1-120200341-null-null.142%5Ev86%5Einsert_down38v5,239%5Ev2%5Einsert_chatgpt&utm_term=NTP%E5%8D%8F%E8%AE%AE&spm=1018.2226.3001.4187">(430æ¡æ¶ˆæ¯) NTPè¯¦è§£(ç½‘ç»œæ—¶é—´åè®®)_127.127.1.0 ntpå«ä¹‰_æ€ç¦è¿ªå°ç™½çš„åšå®¢-CSDNåšå®¢</a></p><p>é’ˆå¯¹NTPåŒæ­¥å¯¼è‡´æ—¶é—´å›é€€ç”šè‡³æ˜¯è´Ÿæ•°çš„æƒ…å†µâ€“å•è°ƒæ—¶é’Ÿï¼Œä¿è¯è¿”å›çš„æ—¶é—´ä¸¥æ ¼å•è°ƒå¢é•¿</p><p>Cloudflareæ²¡ç”¨å•è°ƒæ—¶é’Ÿï¼Œè€Œæ˜¯åœ¨å‘ç°æ—¶é—´å·®ä¸ºè´Ÿæ•°æˆ–è€…0æ—¶å˜ä¸ºä¸€ä¸ªé»˜è®¤å€¼ï¼ˆgolangæ²¡æš´éœ²å•è°ƒæ—¶é’Ÿï¼‰</p><p>å•è°ƒæ—¶é’Ÿçš„å±€é™æ€§ï¼šä»¥è‡ªèº«æ‰€åœ¨çš„è®¡ç®—æœºçš„æŸä¸ªæ—¶é—´ä¸ºèµ·ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¥è‡ªåŒä¸€ä¸ªèŠ‚ç‚¹çš„å•è°ƒæ—¶é’Ÿæ‰æœ‰æ„ä¹‰ã€‚</p><p>å¦‚ä½•å‘æ˜åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„å•è°ƒæ—¶é’Ÿï¼Ÿ</p><h2 id="6-3-é€»è¾‘æ—¶é’Ÿ"><a href="#6-3-é€»è¾‘æ—¶é’Ÿ" class="headerlink" title="6.3 é€»è¾‘æ—¶é’Ÿ"></a>6.3 é€»è¾‘æ—¶é’Ÿ</h2><p>Lamport Clock</p><p>Happens-Before:</p><p>â€‹if a-&gt;b</p><ul><li>if a and b are in the same process, and a is before b, then a-&gt;b</li><li>if a is the event that sends a message , b is the event that receives the message, then a-&gt;b.</li><li>if a-&gt;b and b-&gt;c, then a-&gt;c; if a &#x2F;-&gt;b or b&#x2F;-&gt;a, then a and b are in concurrency(a||b).</li></ul><p>a-&gt;b, then C(a)&lt;C(b)</p><p>C(a)&lt;C(b), a&#x2F;-&gt;b</p><ul><li>æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„é€»è¾‘æ—¶é’Ÿï¼Œåˆå§‹å€¼ä¸º0</li><li>å¦‚æœè¿›ç¨‹iå†…éƒ¨å‘ç”Ÿä¸€ä¸ªæ–°çš„äº‹ä»¶ï¼Œé‚£ä¹ˆå°†å…¶é€»è¾‘æ—¶é’ŸåŠ ä¸€ï¼Œå³Ci&#x3D; Ci+1</li><li>if process i sends a message to process j , and the logic clock in process i is C(i), then, firstly, C(i)&#x3D;C(i)+1, and then, i sends Ci and the message to process j, and then, process j updates its logic clock Cj&#x3D; max(Ci,Cj)+1</li></ul><p>æ ¹æ®ç¦»æ•£æ•°å­¦çš„å…³ç³»è€Œè¨€ï¼Œé€»è¾‘æ—¶é’Ÿå’Œç‰©ç†æ—¶é’Ÿçš„åŒºåˆ«åœ¨äºï¼Œç‰©ç†æ—¶é’Ÿçš„å…ˆåå…³ç³»æ˜¯ä¸€ç§total orderingï¼Œæ˜¯å…¨å±€å¯è§çš„ä¸€ç§å…³ç³»ï¼Œè°å…ˆè°åä¸€ç›®äº†ç„¶ï¼›ç„¶è€Œé€»è¾‘æ—¶é’Ÿ is a kind of partial orderingï¼Œåªæœ‰éƒ¨åˆ†å…ƒç´ çš„å…ˆåå…³ç³»ï¼ˆæœ¬è´¨åŸå› æ˜¯ï¼Œæˆ‘ä»¬ä¸èƒ½æ ¹æ®é€»è¾‘æ—¶é—´çš„å…ˆåå»åˆ¤å®šé€»è¾‘ä¸šåŠ¡çš„å…ˆåï¼‰</p><p>å¦‚ä½•ä½¿é€»è¾‘æ—¶é’Ÿä¹Ÿå…·æœ‰å…¨åºå…³ç³»ï¼Ÿç»™è¿›ç¨‹åŠ ä¸Šä¼˜å…ˆçº§ï¼Œä½†æ˜¯èµ‹äºˆè¿›ç¨‹ä¸åŒçš„ä¼˜å…ˆçº§æ’åºä¼šæœ‰ä¸åŒçš„å…¨åºå…³ç³»</p><p>RAFTçš„ä»»æœŸã€é€‰ä¸¾ç®—æ³•ã€æ—¥å¿—å’ŒçŠ¶æ€æœºçš„æ€æƒ³ç­‰éƒ½å‡ºè‡ªè¿™ç¯‡è®ºæ–‡ï¼ˆLamport,Leslie.â€Time,clocks,and the ordering of events in a distributed system.â€Concurrency: the Works of Leslie Lamport. 2019.179-196ï¼‰ï¼š</p><ul><li>ä¸€ä¸ª<strong>å»ä¸­å¿ƒåŒ–çš„ç®—æ³•</strong>ï¼Œé€šè¿‡é€»è¾‘æ—¶é’Ÿå®ç°åˆ†å¸ƒå¼èµ„æºäº’æ–¥æ¥åˆ†é…èµ„æº</li><li>æ¯ä¸ªè¿›ç¨‹ç»´æŠ¤ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ¶ˆæ¯çš„æ ¼å¼ä¸ºTm: Pi, å³ä¸ºç¬¬iä¸ªè¿›ç¨‹åœ¨Tmçš„é€»è¾‘æ—¶é’Ÿä¸‹å‘é€çš„æ¶ˆæ¯</li><li>è¿›ç¨‹ç»´æŠ¤è‡ªå·±çš„æ¶ˆæ¯ï¼Œä¹Ÿæ¥æ”¶åˆ«äººçš„æ¶ˆæ¯ï¼Œå†³å®šè‡ªå·±æ˜¯å¦èƒ½å¤Ÿè·å–èµ„æºçš„æ¡ä»¶<ul><li>æ¶ˆæ¯é˜Ÿåˆ—ä¸­é™¤å¼€è‡ªå·±çš„æ¶ˆæ¯ä¹‹å¤–çš„æ¶ˆæ¯çš„é€»è¾‘æ—¶é—´ï¼Œå‡å¤§äºè‡ªå·±çš„æ¶ˆæ¯</li><li>æ’åœ¨é˜Ÿå¤´çš„æ¶ˆæ¯æ˜¯è‡ªå·±çš„æ¶ˆæ¯ï¼ˆè¿™é‡Œæ¶ˆæ¯çš„æ’å…¥å¯ä»¥æ˜¯å¯¹å¤´é˜Ÿå°¾ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸­é—´ï¼‰</li></ul></li></ul><h2 id="6-4-å‘é‡æ—¶é’Ÿ"><a href="#6-4-å‘é‡æ—¶é’Ÿ" class="headerlink" title="6.4 å‘é‡æ—¶é’Ÿ"></a>6.4 å‘é‡æ—¶é’Ÿ</h2><p>è·Ÿé€»è¾‘æ—¶é’Ÿå¾ˆç±»ä¼¼ï¼Œåªä¸è¿‡é€»è¾‘æ—¶é’Ÿåªè€ƒè™‘äº†æœ¬åœ°çš„é€»è¾‘æ—¶é—´ï¼Œè€Œå‘é‡æ—¶é’Ÿçš„ç»´åº¦ä¸ºèŠ‚ç‚¹æ•°ï¼Œç»´æŠ¤å…¨å±€çš„æ—¶é—´ã€‚</p><p>å‘é‡æ—¶é’Ÿï¼ˆVector Clockï¼‰æ˜¯ä¸€ç§åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ç”¨äºè®°å½•äº‹ä»¶å‘ç”Ÿé¡ºåºçš„æœºåˆ¶ã€‚å®ƒé€šè¿‡ç»™æ¯ä¸ªèŠ‚ç‚¹åˆ†é…ä¸€ä¸ªç‹¬ç‰¹çš„å‘é‡æ¥è·Ÿè¸ªæ¯ä¸ªèŠ‚ç‚¹ä¸Šçš„äº‹ä»¶å‘ç”Ÿæ¬¡æ•°ï¼Œè¿™ä¸ªå‘é‡è¢«ç§°ä¸ºå‘é‡æ—¶é’Ÿã€‚</p><p>å‘é‡æ—¶é’Ÿçš„å¤§å°ç­‰äºèŠ‚ç‚¹æ•°ï¼Œæ¯ä¸ªå…ƒç´ ä»£è¡¨äº†ä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶é—´æˆ³ã€‚å½“ä¸€ä¸ªäº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå¯¹åº”èŠ‚ç‚¹çš„æ—¶é—´æˆ³ä¼šè‡ªå¢1ã€‚å¦‚æœä¸¤ä¸ªäº‹ä»¶å‘ç”Ÿåœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼Œé‚£ä¹ˆå®ƒä»¬çš„æ—¶é—´æˆ³æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œæ— æ³•æ¯”è¾ƒå…ˆåé¡ºåºï¼›ä½†å¦‚æœå®ƒä»¬å‘ç”Ÿåœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œå°±å¯ä»¥ç”¨å‘é‡æ—¶é’Ÿæ¥æ¯”è¾ƒå®ƒä»¬çš„å…ˆåé¡ºåºã€‚æ¯”å¦‚è¯´ï¼Œè®¾æœ‰A,B,Cä¸‰ä¸ªèŠ‚ç‚¹ï¼Œæ­¤æ—¶åœ¨AèŠ‚ç‚¹ä¸Šå‘ç”Ÿäº†ä¸€ä¸ªäº‹ä»¶ï¼Œé‚£ä¹ˆå…¶å‘é‡æ—¶é’Ÿä¼šå˜ä¸º[1,0,0]ï¼Œå› ä¸ºè¿™æ˜¯AèŠ‚ç‚¹ä¸Šç¬¬ä¸€ä¸ªäº‹ä»¶ã€‚å¦‚æœéšååœ¨CèŠ‚ç‚¹ä¸Šå‘ç”Ÿäº†ä¸€ä¸ªäº‹ä»¶ï¼Œé‚£ä¹ˆå…¶å‘é‡æ—¶é’Ÿä¼šå˜ä¸º[0,0,1]ï¼Œå› ä¸ºè¿™æ˜¯CèŠ‚ç‚¹ä¸Šç¬¬ä¸€ä¸ªäº‹ä»¶ã€‚å¦‚æœå†åœ¨BèŠ‚ç‚¹ä¸Šå‘ç”Ÿäº†ä¸€ä¸ªäº‹ä»¶ï¼Œé‚£ä¹ˆå…¶å‘é‡æ—¶é’Ÿä¼šå˜ä¸º[0,1,0]ï¼Œå› ä¸ºè¿™æ˜¯BèŠ‚ç‚¹ä¸Šç¬¬ä¸€ä¸ªäº‹ä»¶ã€‚è¿™æ ·ï¼Œåœ¨æ•´ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°äº†Aä¸º[1,0,0]ï¼ŒBä¸º[0,1,0]ï¼ŒCä¸º[0,0,1]çš„å‘é‡æ—¶é’Ÿã€‚</p><p>å½“ä¸€æ¡æ¶ˆæ¯ä»ä¸€ä¸ªèŠ‚ç‚¹ä¼ é€’åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼Œæ¶ˆæ¯ä¸­ä¼šåŒ…å«å‘é€æ–¹çš„å‘é‡æ—¶é’Ÿã€‚æ¥æ”¶æ–¹åœ¨æ”¶åˆ°æ¶ˆæ¯åï¼Œå°†å®ƒè‡ªå·±çš„å‘é‡æ—¶é’Ÿå’Œæ¥æ”¶åˆ°çš„æ¶ˆæ¯ä¸­çš„å‘é‡æ—¶é’Ÿè¿›è¡Œæ¯”è¾ƒï¼Œå–æ¯ä¸ªä½ç½®ä¸Šè¾ƒå¤§çš„å€¼ä½œä¸ºæ–°çš„æ—¶é—´æˆ³ã€‚ç„¶åå°†æ¥æ”¶åˆ°çš„æ¶ˆæ¯çš„æ—¶é—´æˆ³åŒæ­¥åˆ°æœ¬åœ°ï¼Œå†åŠ ä¸Š1ï¼Œè¡¨ç¤ºæ¥æ”¶åˆ°äº†è¿™æ¡æ¶ˆæ¯ã€‚è¿™æ ·ï¼Œæ¥æ”¶æ–¹å°±å¯ä»¥çŸ¥é“è¿™æ¡æ¶ˆæ¯æ˜¯åœ¨å“ªä¸ªèŠ‚ç‚¹ä¸Šå‘é€çš„ï¼Œä»¥åŠè¿™æ¡æ¶ˆæ¯çš„å…ˆåé¡ºåºã€‚</p><p>å‘é‡æ—¶é’Ÿä¸ä»…èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬æ¯”è¾ƒäº‹ä»¶é—´çš„å…ˆåå…³ç³»ï¼Œè¿˜èƒ½æ£€æµ‹å‡ºå¹¶å‘äº‹ä»¶ã€‚æ¯”å¦‚è¯´ï¼Œå¦‚æœä¸¤ä¸ªäº‹ä»¶Aå’ŒBåŒæ—¶å‘ç”Ÿï¼Œé‚£ä¹ˆå®ƒä»¬å¯¹å„è‡ªæŒæœ‰çš„å‘é‡æ—¶é’Ÿéƒ½ä¼šå½±å“åˆ°ç›¸åº”çš„ä½ç½®ä¸Šï¼Œå¯¼è‡´è¿™ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šçš„å‘é‡æ—¶é’Ÿä¸ä¸€è‡´ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ£€æµ‹å‡ºè¿™ä¸¤ä¸ªäº‹ä»¶çš„å¹¶å‘æ€§ã€‚</p><p>ç¼ºç‚¹åœ¨äºï¼Œå‘é‡çš„ç»´åº¦ä¸èŠ‚ç‚¹æ•°æ­£ç›¸å…³ï¼Œéšç€èŠ‚ç‚¹å¢å¤šï¼Œå‘é‡æ—¶é’Ÿè¶Šå¤§ï¼Œå‘é‡æ—¶é’Ÿéœ€è¦å¤§é‡çš„ç£ç›˜å’Œå†…å­˜ç©ºé—´ï¼ŒåŒæ—¶éœ€è¦æ›´é•¿çš„æ—¶é—´æ¥è®¡ç®—å’Œæ¯”è¾ƒã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åˆ†å¸ƒå¼ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ†å¸ƒå¼ç³»ç»Ÿ </tag>
            
            <tag> æ·±å…¥ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P4&amp;SRV6</title>
      <link href="/2024/06/24/B-EP2/"/>
      <url>/2024/06/24/B-EP2/</url>
      
        <content type="html"><![CDATA[<h1 id="B-EP2"><a href="#B-EP2" class="headerlink" title="B-EP2"></a>B-EP2</h1><p>èƒŒæ™¯ï¼šäº’è”ç½‘å˜å¾—è‡ƒè‚¿ï¼Œç½‘ç»œç®¡ç†å‘˜è¿«åˆ‡éœ€è¦ä¸€ç§å¿«é€Ÿé«˜æ•ˆçš„<strong>ç½‘ç»œé¥æµ‹æ–¹æ¡ˆ</strong>ï¼Œèƒ½å¤Ÿåˆ©ç”¨é‡‡é›†åˆ°çš„å®æ—¶å‡†ç¡®çš„ç½‘ç»œçŠ¶æ€ä¿¡æ¯æ¥å¿«é€Ÿæ£€æµ‹å’Œå®šä½å¸¸è§ç½‘ç»œæ•…éšœï¼Œç„¶åéœ€è¦ä¸€ä¸ªæœ‰æ•ˆçš„<strong>ç½‘ç»œæ§åˆ¶å’Œç®¡ç†ï¼ˆNC&amp;Mï¼‰æ–¹æ¡ˆ</strong>ï¼Œä»¥å®ç°åªèƒ½åŠæ—¶å†³ç­–ä»¥åœ¨ç½‘ç»œè·¯å¾„ä¸Š<strong>æ¢³ç†å’Œè·¯ç”±æµé‡</strong>ï¼Œä»¥åŒæ—¶å®ç°<strong>é«˜æ•ˆçš„åˆ©ç”¨å’Œé«˜è´¨é‡çš„æœåŠ¡ï¼ˆQoS</strong>ï¼‰ã€‚</p><ul><li>é‡‡é›†ç½‘ç»œä¿¡æ¯ï¼Œå®šä½æ•…éšœ</li><li>æœ‰æ•ˆçš„ç½‘ç»œæ§åˆ¶å’Œç®¡ç†æ–¹æ¡ˆ</li></ul><p><a href="https://blog.csdn.net/hjxzb/article/details/91141685?ops_request_misc=%7B%22request_id%22:%22168753985816782427413509%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168753985816782427413509&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-91141685-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=P4&spm=1018.2226.3001.4187">(465æ¡æ¶ˆæ¯) P4å­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰åˆè¯†P4_p4æ¥å£æ˜¯å¹²å˜›çš„_ç¨‹åºå‘˜å­¦ç¼–ç¨‹çš„åšå®¢-CSDNåšå®¢</a></p><ol><li><p>åŸºäºP4çš„ä¸»åŠ¨é¥æµ‹</p><ul><li><p>æ¢é’ˆä»£æ›¿æ•°æ®åˆ†ç»„è¿›è¡Œé¥æµ‹ï¼Œé™ä½äº†é¥æµ‹å¼€é”€ï¼ˆå› ä¸ºæ•°ç»„åˆ†ç»„æ¯”å¦‚INTå³å¸¦å†…ç½‘ç»œé¥æµ‹<a href="https://blog.csdn.net/weixin_47104688/article/details/123229563?ops_request_misc=%7B%22request_id%22:%22168606788516800222871187%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168606788516800222871187&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-123229563-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=INT%E5%B8%A6%E5%86%85&spm=1018.2226.3001.4187">(460æ¡æ¶ˆæ¯) å¸¦å†…ç½‘ç»œé¥æµ‹INTâ€“In-band Network Telemetry_è¢å†¬è‡³çš„åšå®¢-CSDNåšå®¢</a></p><p><img src="https://s2.loli.net/2024/06/24/pdxWMcIf7mgeRLJ.jpg" alt="SDN.png"></p><p><a href="https://www.sdnlab.com/23822.html">https://www.sdnlab.com/23822.html</a></p><p><a href="https://blog.csdn.net/changqing1234/article/details/103669835?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromBaidu~Rate-1-103669835-blog-123229563.235%5Ev38%5Epc_relevant_anti_t3&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromBaidu~Rate-1-103669835-blog-123229563.235%5Ev38%5Epc_relevant_anti_t3&utm_relevant_index=1">(465æ¡æ¶ˆæ¯) Telemetry æŠ€æœ¯æ¦‚è¿°_LeocenaYçš„åšå®¢-CSDNåšå®¢</a></p><p>ï¼Œåœ¨è½¬å‘æ•°æ®åˆ†ç»„æ—¶èƒ½å¤Ÿåœ¨æ•°æ®åœ¨ç½‘ç»œç»“æ„æµåŠ¨çš„è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡åœ¨è·¯å¾„ä¸­é—´èŠ‚ç‚¹æ’å…¥å…ƒæ•°æ®ï¼Œç›‘æ§ç³»ç»Ÿå¯ä»¥é€šè¿‡è¿™äº›å…ƒæ•°æ®è¿›è¡Œæ”¶é›†ç½‘ç»œçŠ¶æ€ï¼Œä½†è¿™æ ·è½½è·æ¯”å°±å¤§)ï¼ŒINTä¹‹ç±»çš„å¸¦å†…ç½‘ç»œé¥æµ‹ä¹Ÿå­˜åœ¨ä¸€äº›å±€é™æ€§ï¼Œéš¾ä»¥è·å–å…¨å±€ç½‘ç»œè¯•å›¾ã€‚è¿™æ ·å°±åŠ å…¥äº†æ¢é’ˆè¿›è¡Œä¸»åŠ¨é¥æµ‹ï¼Œæé«˜æ•°æ®åˆ†ç»„çš„æœ‰æ•ˆè½½è·æ¯”ã€‚</p><p><a href="https://www.sdnlab.com/23822.html">ä¸€æ–‡è¯»æ‡‚å¸¦å†…ç½‘ç»œé¥æµ‹æŠ€æœ¯ | SDNLAB | ä¸“æ³¨ç½‘ç»œåˆ›æ–°æŠ€æœ¯</a></p></li></ul></li><li><p>åŸºäºæ®µè·¯ç”±ï¼ˆåŸºäºIPV6çš„ä¸€å‘æŠ€æœ¯ï¼‰</p><p><img src="https://s2.loli.net/2024/06/26/CJNZUQIAzHT2E6O.png" alt="image-20230607005803362.png"></p><p><a href="https://blog.csdn.net/m0_49864110/article/details/123591943?ops_request_misc=%7B%22request_id%22:%22168606977016800225513092%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168606977016800225513092&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-123591943-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=SRV6&spm=1018.2226.3001.4187">(460æ¡æ¶ˆæ¯) å¹¿åŸŸç½‘æŠ€æœ¯â€”â€”SRv6 SIDè®²è§£_é™ä¸‹å¿ƒæ¥æ•²æœ¨é±¼çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/Ether_Dzh/article/details/119847548?ops_request_misc=%7B%22request_id%22:%22168754187716800227440687%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168754187716800227440687&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-2-119847548-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=SRV6&spm=1018.2226.3001.4187">(465æ¡æ¶ˆæ¯) 1.2ã€SRv6(Segment Routing Over IPv6) ä»‹ç»_srv6æŠ€æœ¯æ˜¯ä»€ä¹ˆ_Ether_Dzhçš„åšå®¢-CSDNåšå®¢</a></p><p><img src="https://s2.loli.net/2024/06/24/zMpDeVWXRC46Fnd.jpg" alt="ç½‘ç»œç¼–ç¨‹.png"></p><ul><li>æ”¹å˜SRæ ‡ç­¾å’Œæ’åˆ—é¡ºåºæŒ‡å®šæ¢æµ‹è·¯å¾„</li><li>æ¢é’ˆåŠ å…¥SRæ ‡ç­¾æ ˆè·å–å…¨é¢çš„ç½‘ç»œè§†å›¾ï¼Œç¯å½¢æ¢æµ‹è·¯å¾„ï¼Œå•ä¸ªæ¢æµ‹ç‚¹å…·å¤‡æ¢é’ˆå‘é€ç«¯å’Œæ¥æ”¶ç«¯åŠŸèƒ½ï¼Œå‡å°‘å¤šä¸ªæ¢æµ‹ç‚¹ä¹‹é—´åŒæ­¥åè°ƒæ¢é’ˆç­‰å¤æ‚æ“ä½œã€‚</li><li>å‡å°‘é¥æµ‹å†—ä½™ï¼Œæ¢é’ˆåˆ†ç»„ä¸­åŠ å…¥é¥æµ‹æŒ‡ç¤ºåŸŸï¼ŒæŒ‡å®šéœ€è¦é‡‡é›†çš„é¥æµ‹æ•°æ®</li><li>å°†å¯ç¼–ç¨‹è®¾å¤‡çš„å†…éƒ¨çŠ¶æ€çš„çŠ¶æ€ä¿¡æ¯åµŒå…¥åˆ°æ¢é’ˆä¸­ï¼Œé€šè¿‡å¯ç¼–ç¨‹è®¾å¤‡çš„å®šåˆ¶åŒ–èƒ½åŠ›è‡ªå®šä¹‰æ•°æ®åˆ†ç»„å¤„ç†é€»è¾‘æ¥æ˜¯å®ç°ã€‚</li></ul></li></ol><p>SDNæ§åˆ¶é¢ï¼šå¯ç¼–ç¨‹ç¯å¢ƒ</p><p>å¯é›†ä¸­æ§åˆ¶ç½‘ç»œï¼šSDNåŸŸç”±é›†ä¸­ç»Ÿä¸€çš„æ§åˆ¶å•å…ƒå®æ–½ç®¡ç†</p><p>è½¬å‘å’Œæ§åˆ¶åˆ†ç¦»</p><p>P4ï¼š</p><ul><li><p>å¯ä»¥å¯¹ç½‘ç»œè®¾å¤‡èŠ¯ç‰‡é€»è¾‘è¿›è¡Œç¼–ç¨‹</p></li><li><p>å¯é‡é…ç½®æ€§ï¼šæ”¯æŒè½¬å‘é€»è¾‘ä»£ç ç»è¿‡ç¼–è¯‘éƒ¨ç½²åˆ°å…·ä½“å¹³å°ä¸Šä¹‹ååŠ¨æ€ä¿®æ”¹æŠ¥æ–‡</p></li><li><p>ä¸ç»‘å®šæŸä¸ªå…·ä½“çš„ç½‘ç»œåè®®</p></li><li><p>å¹³å°æ— å…³æ€§ï¼šç‹¬ç«‹äºç‰¹å®šçš„åº•å±‚è¿è¡Œå¹³å°æ¥ç¼–å†™æ•°æ®æŠ¥æ–‡å¤„ç†é€»è¾‘</p></li><li><p>éœ€è¦ç‰¹å®šäº¤æ¢æœºçš„æ”¯æŒ</p></li><li><p>æ•°æ®é‡‡é›†ä¸æ„ŸçŸ¥ï¼š</p><ol><li>é€šè¿‡ONOSï¼ˆä¸€ä½“åŒ–çš„ç½‘ç»œæ“ä½œç³»ç»Ÿï¼‰çš„RestfulåŒ—å‘æ¥å£æŸ¥è¯¢å¾—åˆ°çš„ONOSç‰¹æœ‰æ•°æ®åº“å†…çš„å…¨å±€ç½‘ç»œä¿¡æ¯ï¼ˆä½†å¿½ç•¥ç»†èŠ‚ï¼‰<a href="https://blog.csdn.net/weixin_34384681/article/details/91849632?ops_request_misc=%7B%22request_id%22:%22168606907716800227458444%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168606907716800227458444&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-6-91849632-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=ONOS&spm=1018.2226.3001.4187">(460æ¡æ¶ˆæ¯) ONOSé¢„çƒ­ç¯‡ä¹‹ONOSç®€ä»‹_weixin_34384681çš„åšå®¢-CSDNåšå®¢</a></li><li>æ•°æ®å±‚äº¤æ¢æœºä¸­çš„æ•°æ®æµï¼Œæ’å…¥æ¢é’ˆï¼Œæ•°æ®é‡‡é›†æœåŠ¡é“¾ï¼Œæå–å„ä¸ªåŒ…çš„ç‰¹å¾è¿›è¡Œç»Ÿè®¡</li><li>åŸºäºæ®µè·¯ç”±æœºåˆ¶ï¼Œè¿›è¡ŒINTä¸»åŠ¨é¥æµ‹ï¼ˆINTæœ¬èº«æ˜¯æœ‰å±€é™æ€§çš„ï¼Œæ¢æµ‹è·¯å¾„éœ€è¦æå‰æŒ‡å®šï¼Œè€Œå€ŸåŠ©æ®µè·¯ç”±æœºåˆ¶è¿›è¡Œä¸»åŠ¨ç½‘ç»œé¥æµ‹ï¼Œé™ä½æˆæœ¬æé«˜äº†çµæ´»æ€§ï¼‰ï¼Œæµé‡åŒ…ä¸­æ’å…¥æ¢é’ˆï¼Œå¿«é€Ÿè·å–æ¢æµ‹åŒ…è·¯å¾„ä¸Šçš„ç¬¬ä¸€æ‰‹æ•°æ®å¹³é¢é¥æµ‹æ•°æ®</li></ol></li><li><p>è¿™é‡Œçš„æ™ºèƒ½åˆ†æä¸å†³ç­–é‡‡ç”¨æ·±åº¦å­¦ä¹ ç›¸å…³çš„ä¸œè¥¿</p></li><li><p>å¯ç¼–ç¨‹åŠ¨æ€ç®¡æ§ï¼ˆP4ï¼‰ï¼šä»…ç®¡ç†æ•°æ®å¹³é¢å¦‚ä½•å¤„ç†æ•°æ®åŒ…ï¼Œå®šä¹‰æ§åˆ¶å¹³é¢ä¸æ•°æ®å¹³é¢é€šä¿¡çš„æ¥å£ï¼Œä½†ä¸æè¿°æ§åˆ¶å¹³é¢åŠŸèƒ½</p></li><li><p>ä¼ ç»Ÿäº¤æ¢æœºå’ŒP4äº¤æ¢æœº</p><p>åœ¨ä¼ ç»Ÿäº¤æ¢æœºä¸­ï¼Œåˆ¶é€ å•†å®šä¹‰äº†æ•°æ®å¹³é¢çš„åŠŸèƒ½ï¼Œæ§åˆ¶å¹³é¢é€šè¿‡ä¸€äº›ç®¡ç†è¡¨ï¼ˆå¦‚è·¯ç”±è¡¨ï¼‰ä¸­çš„æ¡ç›®ä»¥åŠå¤„ç†æ§åˆ¶æ•°æ®åŒ…ï¼ˆå¦‚è·¯ç”±åè®®æ•°æ®åŒ…ï¼‰æˆ–å¼‚æ­¥äº‹ä»¶ï¼ˆå¦‚é“¾è·¯çŠ¶æ€æ›´æ”¹æˆ–å­¦ä¹ é€šçŸ¥ï¼‰æ¥æ§åˆ¶æ•°æ®å¹³é¢ã€‚</p><p>P4å¯ç¼–ç¨‹äº¤æ¢æœºä¸ä¼ ç»Ÿäº¤æ¢æœºçš„åŒºåˆ«ä¸»è¦ä½“ç°åœ¨ä¸¤ä¸ªæ–¹é¢ï¼š</p><ul><li>æ•°æ®å¹³é¢åŠŸèƒ½ä¸æ˜¯é¢„å…ˆå›ºå®šçš„ï¼Œè€Œæ˜¯ç”± P4 ç¨‹åºå®šä¹‰çš„ã€‚æ•°æ®å¹³é¢åœ¨åˆå§‹åŒ–æ—¶é…ç½®ä¸ºå®ç° P4 ç¨‹åºæè¿°çš„åŠŸèƒ½ï¼ˆç”±çº¢è‰²é•¿ç®­å¤´æ˜¾ç¤ºï¼‰ï¼Œå¹¶ä¸”æ²¡æœ‰ç°æœ‰ç½‘ç»œåè®®çš„å†…ç½®çŸ¥è¯†ã€‚</li><li>æ§åˆ¶å¹³é¢ä½¿ç”¨ä¸å›ºå®šåŠŸèƒ½è®¾å¤‡ä¸­ç›¸åŒçš„é€šé“ä¸æ•°æ®å¹³é¢è¿›è¡Œé€šä¿¡ï¼Œä½†æ•°æ®å¹³é¢ä¸­çš„è¡¨é›†åˆå’Œå…¶ä»–å¯¹è±¡ä¸å†æ˜¯å›ºå®šçš„ï¼Œå› ä¸ºå®ƒä»¬ç”± P4 ç¨‹åºå®šä¹‰ã€‚P4 ç¼–è¯‘å™¨ç”Ÿæˆæ§åˆ¶å¹³é¢ç”¨äºä¸æ•°æ®å¹³é¢é€šä¿¡çš„ APIã€‚</li></ul></li><li><p>æ§åˆ¶å¹³é¢ï¼ˆSDNæ§åˆ¶å™¨ï¼‰å¦‚ä½•ä¸P4çš„è®¾å¤‡è¿›è¡Œé€šä¿¡ï¼Ÿ</p><ul><li><p>P4Runtimeï¼ˆåŸºäºgRPCæ¡†æ¶ï¼‰</p></li><li><p>OpenFlowåè®®ä¸­ï¼Œæ§åˆ¶å™¨å’Œè®¾å¤‡æ˜¯ç”±æ§åˆ¶å™¨å¼€æ”¾ç«¯å£ï¼Œè®¾å¤‡æ‰èƒ½è¿æ¥ä¸Šæ§åˆ¶å™¨ï¼›è€ŒP4Runtimeæ˜¯è®¾å¤‡ä¸Šå¼€å§‹gRPC,æ§åˆ¶å™¨è¿æ¥è®¾å¤‡ï¼Œå› æ­¤ï¼Œåœ¨æ”¯æŒP4çš„è®¾å¤‡ä¸Šä¹Ÿä¼šæœ‰ä¸€ä¸ªä»£ç†çš„Agentå»å¤„ç†æ§åˆ¶å™¨æ¥çš„è¿æ¥</p></li></ul></li></ul><p>é‰´äºåŸºäºP4çš„è¢«åŠ¨ç½‘ç»œé¥æµ‹å¯æ‰©å±•æ€§ä¸è¶³çš„ç¼ºç‚¹ï¼Œé¦–å…ˆè¦ä¿è¯çš„å°±æ˜¯ä¸»åŠ¨é¥æµ‹çš„æ¢æµ‹è·¯å¾„åœ¨è¿è¡Œæ—¶æ˜¯çµæ´»å¯æ§çš„ï¼Œæˆ‘ä»¬é‡‡ç”¨æ®µè·¯ç”±æœºåˆ¶æ¥çµæ´»æ§åˆ¶æ¢é’ˆçš„æ¢æµ‹è·¯å¾„ï¼ˆè¿™é‡Œçš„è·¯å¾„ç”Ÿæˆé‡‡ç”¨äº†<a href="https://blog.csdn.net/KCDCY/article/details/124732427?ops_request_misc=%7B%22request_id%22:%22168606887816800222897225%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168606887816800222897225&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-124732427-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=%E6%AC%A7%E6%8B%89%E9%80%9A%E8%B7%AF%E7%AE%97%E6%B3%95">Hierholzer <em>ç®—æ³•</em>ï¼Œæ¬§æ‹‰å›è·¯</a>ï¼‰ã€‚æ®µè·¯ç”±æœºåˆ¶ç®€å•æ˜“ç”¨ï¼Œä¸éœ€è¦é¢å¤–çš„åè®®æ”¯æŒï¼Œé€šè¿‡ç»„åˆä¸€ç³»åˆ—ç®€å•çš„ç½‘ç»œæ“ä½œæŒ‡ä»¤å°±å¯ä»¥å®Œå…¨æ§åˆ¶æ•°æ®åˆ†ç»„çš„è½¬å‘è·¯å¾„ã€‚åœ¨é™ä½äº†ç½‘ç»œæˆæœ¬çš„åŒæ—¶ä¹Ÿæé«˜äº†çµæ´»æ€§ã€‚æœ€åæ®µè·¯ç”±èƒ½å¤Ÿæ”¯æŒå¢é‡éƒ¨ç½²ï¼Œé™ä½äº†éƒ¨ç½²éš¾åº¦ï¼Œå¯è¡Œæ€§å¥½ã€‚è¯¥ç³»ç»Ÿä¸‹å¯ä»¥çµæ´»å®šä¹‰é¥æµ‹è·¯å¾„ï¼ŒæŒ‰éœ€æ¢æµ‹å¯èƒ½æˆ–å·²ç»å‡ºç°é—®é¢˜çš„è·¯å¾„ï¼Œå¿«é€Ÿå®šä½æ•…éšœä½ç½®ã€‚åŒæ—¶ï¼Œå¯ä»¥åœ¨æ¢é’ˆæ ¼å¼ä¸­åŠ å…¥æ¢æµ‹é¥æµ‹æ•°æ®ç±»å‹çš„å­—æ®µæ¥æ”¯æŒæŒ‰éœ€è·å–é¥æµ‹æ•°æ®ã€‚åŒæ—¶è¦ä¿è¯èƒ½å¤Ÿé‡‡é›†åˆ°ç½‘ç»œè®¾å¤‡å†…éƒ¨çš„çŠ¶æ€ä¿¡æ¯ç­‰ç»†ç²’åº¦å‡†ç¡®çš„é¥æµ‹æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹å¯ç¼–ç¨‹è®¾å¤‡çš„æ•°æ®å¹³é¢å¤„ç†é€»è¾‘æ¥åŒºåˆ†æ­£å¸¸æ•°æ®åˆ†ç»„å’Œæ¢é’ˆæ•°æ®åˆ†ç»„ï¼Œå¯¹äºæ­£å¸¸æ•°æ®åˆ†ç»„ç›´æ¥æ­£å¸¸è½¬å‘ï¼Œè€Œå¯¹äºæ¢é’ˆæ•°æ®åˆ†ç»„åŒ¹é…å…¶ä¸­çš„è·¯å¾„è½¬å‘æ ‡ç­¾ä»¥åŠé¥æµ‹æŒ‡ä»¤å­—æ®µï¼Œå°†å®æ—¶çš„ç½‘ç»œçŠ¶æ€ä¿¡æ¯å°è£…åœ¨æ¢é’ˆæ•°æ®åˆ†ç»„ä¸­ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> SDN </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SDN </tag>
            
            <tag> P4 </tag>
            
            <tag> SRV6 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿ç ”å¤ä¹ å‡†å¤‡</title>
      <link href="/2024/06/24/%E4%BF%9D%E7%A0%94/"/>
      <url>/2024/06/24/%E4%BF%9D%E7%A0%94/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¿ç ”"><a href="#ä¿ç ”" class="headerlink" title="ä¿ç ”"></a>ä¿ç ”</h1><p><a href="https://blog.csdn.net/zqm_0015/article/details/109236372">(453æ¡æ¶ˆæ¯) 2021å¹´è®¡ç®—æœºä¿ç ”é¢è¯•é¢˜_ä¸€ä¸ªä¸»æœºå°†ä¸¤ä¸ªç«¯å£æ¥åˆ°ç½‘ç»œä¸Šæ˜¯å¦ä¼šæå‡ååé‡_Challowçš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/Baoyan_cs/article/details/124314177">(453æ¡æ¶ˆæ¯) åè¡€æ•´ç†ï¼Œ20ä¸ªè®¡ç®—æœºä¿ç ”å¸¸è§é—®é¢˜åŠå›ç­”æ¨¡æ¿_è®¡ç®—æœºä¸“ä¸š20ä¸ªé¢è¯•å¸¸è§é—®é¢˜_Baoyan_csçš„åšå®¢-CSDNåšå®¢</a></p><p>[(453æ¡æ¶ˆæ¯) 2021è®¡ç®—æœºä¿ç ”ç»å†(æ¸…è½¯, åŒ—æ·±, æµ™å¤§, å—å¤§, ä¸­ç§‘å¤§, åŒ—èˆª, å“ˆæ·±, å—å¼€, åç§‘, æ­¦å¤§, ä¸­å¤§)_inichoçš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/qq_43280818/article/details/123450451?ops_request_misc=&request_id=&biz_id=102&utm_term=%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C">https://blog.csdn.net/qq_43280818/article/details/123450451?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=è®¡ç®—æœºç½‘ç»œ</a> ä¿ç ”&amp;utm_medium&#x3D;distribute.pc_search_result.none-task-blog-2<del>all</del>sobaiduweb~default-9-123450451.142^v87^insert_down28,239^v2^insert_chatgpt&amp;spm&#x3D;1018.2226.3001.4187)</p><h2 id="è®¡ç½‘"><a href="#è®¡ç½‘" class="headerlink" title="è®¡ç½‘"></a>è®¡ç½‘</h2><p>[(453æ¡æ¶ˆæ¯) è®¡ç®—æœºç½‘ç»œä¿ç ”é¢è¯•é¢˜æ•´ç†ï¼ˆè‡ªç”¨ï¼‰_ä¹Œé¸¡æ‘¸é±¼çš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/m0_52571748/article/details/119513761?ops_request_misc=&request_id=&biz_id=102&utm_term=%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C">https://blog.csdn.net/m0_52571748/article/details/119513761?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=è®¡ç®—æœºç½‘ç»œ</a> ä¿ç ”&amp;utm_medium&#x3D;distribute.pc_search_result.none-task-blog-2<del>all</del>sobaiduweb~default-1-119513761.142^v87^insert_down28,239^v2^insert_chatgpt&amp;spm&#x3D;1018.2226.3001.4187)</p><p>[(453æ¡æ¶ˆæ¯) è®¡ç®—æœºä¸“ä¸šä¿ç ”é¢è¯•å¤ä¹ ç¬”è®°â€”â€”è®¡ç®—æœºç½‘ç»œ_è®¡ç®—æœºä¿ç ”å¤ä¹ _æ¬§äºŒlordçš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/weixin_43117620/article/details/109198194?ops_request_misc=%7B%22request_id%22:%22168433738716800227438825%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168433738716800227438825&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-109198194-null-null.142%5Ev87%5Einsert_down28,239%5Ev2%5Einsert_chatgpt&utm_term=%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C">https://blog.csdn.net/weixin_43117620/article/details/109198194?ops_request_misc=%7B%22request%5Fid%22%3A%22168433738716800227438825%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=168433738716800227438825&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-109198194-null-null.142^v87^insert_down28,239^v2^insert_chatgpt&amp;utm_term=è®¡ç®—æœºç½‘ç»œ</a> ä¿ç ”&amp;spm&#x3D;1018.2226.3001.4187)</p><p><a href="https://blog.csdn.net/weixin_46893257/article/details/116306838?ops_request_misc=%7B%22request_id%22:%22168470925916800215052847%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168470925916800215052847&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-116306838-null-null.142%5Ev87%5Einsert_down28,239%5Ev2%5Einsert_chatgpt&utm_term=IPv6%E6%B5%81%E6%A0%87%E7%AD%BE&spm=1018.2226.3001.4187">(454æ¡æ¶ˆæ¯) IPV6åŸºæœ¬æŠ¥å¤´_ipv6æŠ¥å¤´_yibasuo18176çš„åšå®¢-CSDNåšå®¢</a></p><p>[(454æ¡æ¶ˆæ¯) BGPã€IBGPã€EBGPã€IGPã€EGP_bgpå’Œegpçš„åŒºåˆ«_zhaomaxçš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/zhaomax/article/details/52399403?ops_request_misc=&request_id=&biz_id=102&utm_term=IGP">https://blog.csdn.net/zhaomax/article/details/52399403?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=IGP</a> BGP&amp;utm_medium&#x3D;distribute.pc_search_result.none-task-blog-2<del>all</del>sobaiduweb~default-4-52399403.142^v87^insert_down28,239^v2^insert_chatgpt&amp;spm&#x3D;1018.2226.3001.4187)</p><h2 id="æ“ä½œç³»ç»Ÿ"><a href="#æ“ä½œç³»ç»Ÿ" class="headerlink" title="æ“ä½œç³»ç»Ÿ"></a>æ“ä½œç³»ç»Ÿ</h2><p><a href="https://blog.csdn.net/m0_52571748/article/details/119512934">(453æ¡æ¶ˆæ¯) è®¡ç®—æœºæ“ä½œç³»ç»Ÿä¿ç ”é¢è¯•é¢˜æ•´ç†ï¼ˆè‡ªç”¨ï¼‰_ä¹Œé¸¡æ‘¸é±¼csdn_ä¹Œé¸¡æ‘¸é±¼çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/love521314123/article/details/119682266">(453æ¡æ¶ˆæ¯) æ“ä½œç³»ç»Ÿç¬”è®°ï¼ˆå«ç‹é“è®¡ç®—æœºè€ƒç ”â€”â€”æ“ä½œç³»ç»Ÿè¯¾ä»¶ï¼‰_æ“ä½œç³»ç»Ÿè€ƒç ”ç¬”è®°_ä¸€åªä¸åƒè€é¼ çš„çŒ«çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/lishanleilixin/article/details/89709194">(454æ¡æ¶ˆæ¯) OSä¹‹å­˜å‚¨ç®¡ç† â€” ç£ç›˜è°ƒåº¦ç®—æ³•_os å¯¹ç£ç›˜æ“ä½œ å†™ä¼˜å…ˆ_å¦‚æ˜¯è¯´å¦‚æ˜¯çš„åšå®¢-CSDNåšå®¢</a></p><h2 id="è®¡ç»„"><a href="#è®¡ç»„" class="headerlink" title="è®¡ç»„"></a>è®¡ç»„</h2><p><a href="https://blog.csdn.net/m0_52571748/article/details/119530739?ops_request_misc=%7B%22request_id%22:%22168433894316800197057897%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168433894316800197057897&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-119530739-null-null.142%5Ev87%5Einsert_down28,239%5Ev2%5Einsert_chatgpt&utm_term=%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86%E4%BF%9D%E7%A0%94&spm=1018.2226.3001.4187">(453æ¡æ¶ˆæ¯) è®¡ç®—æœºç»„æˆåŸç†ä¿ç ”é¢è¯•é¢˜æ•´ç†ï¼ˆè‡ªç”¨ï¼‰_è®¡ç®—æœºç»„æˆåŸç†é¢è¯•é¢˜_ä¹Œé¸¡æ‘¸é±¼çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/love521314123/article/details/122825247#comments_26524593">(453æ¡æ¶ˆæ¯) ç‹é“è®¡ç®—æœºè€ƒç ”â€”â€”è®¡ç®—æœºç»„æˆåŸç†ç¬”è®°_ç‹é“è®¡ç®—æœºç»„æˆåŸç†_ä¸€åªä¸åƒè€é¼ çš„çŒ«çš„åšå®¢-CSDNåšå®¢</a></p><h2 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h2><p><a href="https://blog.csdn.net/weixin_43790779/article/details/120934734?ops_request_misc=%7B%22request_id%22:%22168433902416800226547104%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168433902416800226547104&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-120934734-null-null.142%5Ev87%5Einsert_down28,239%5Ev2%5Einsert_chatgpt&utm_term=%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%BF%9D%E7%A0%94&spm=1018.2226.3001.4187">(453æ¡æ¶ˆæ¯) ä¿ç ”é¢è¯•å¤ä¹ ä¹‹æ•°æ®ç»“æ„ç¯‡_æ•°æ®ç»“æ„ä¿ç ”å¤ä¹ _abtguçš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/weixin_40113925/article/details/100938378?spm=1001.2101.3001.6650.2&utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-2-100938378-blog-120934734.235%5Ev36%5Epc_relevant_anti_vip&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-2-100938378-blog-120934734.235%5Ev36%5Epc_relevant_anti_vip&utm_relevant_index=3">(453æ¡æ¶ˆæ¯) æ•°æ®ç»“æ„åŸºç¡€æ¦‚å¿µçŸ¥è¯†ç‚¹_ä¿ç ”&#x2F;è€ƒç ”&#x2F;é¢è¯•å¤ä¹ _é¡ºåºå“ˆå¸Œåˆ†å—æŠ˜åŠ_Raising_çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/whz_zb/article/details/7425152?ops_request_misc=%7B%22request_id%22:%22168465798116800182114693%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168465798116800182114693&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-7425152-null-null.142%5Ev87%5Einsert_down28,239%5Ev2%5Einsert_chatgpt&utm_term=%E8%83%9C%E8%80%85%E6%A0%91%E5%92%8C%E8%B4%A5%E8%80%85%E6%A0%91&spm=1018.2226.3001.4187">(454æ¡æ¶ˆæ¯) èƒœè€…æ ‘ä¸è´¥è€…æ ‘_èƒœè€…æ ‘å’Œè´¥è€…æ ‘_whz_zbçš„åšå®¢-CSDNåšå®¢</a></p><p>[(454æ¡æ¶ˆæ¯) è¯¦è§£å…¨å±€å˜é‡ï¼Œå…¨å±€å˜é‡ä¸é™æ€å˜é‡çš„åŒºåˆ«_é™æ€å˜é‡å’Œå…¨å±€å˜é‡_èˆ’æ³±çš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/weixin_43222324/article/details/106989714?ops_request_misc=%7B%22request_id%22:%22168474123716800226594104%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168474123716800226594104&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-106989714-null-null.142%5Ev87%5Einsert_down28,239%5Ev2%5Einsert_chatgpt&utm_term=%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F">https://blog.csdn.net/weixin_43222324/article/details/106989714?ops_request_misc=%7B%22request%5Fid%22%3A%22168474123716800226594104%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=168474123716800226594104&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-106989714-null-null.142^v87^insert_down28,239^v2^insert_chatgpt&amp;utm_term=å…¨å±€å˜é‡</a> é™æ€å˜é‡&amp;spm&#x3D;1018.2226.3001.4187)</p><h2 id="æ¦‚ç‡è®º"><a href="#æ¦‚ç‡è®º" class="headerlink" title="æ¦‚ç‡è®º"></a>æ¦‚ç‡è®º</h2><p><a href="https://uestc.feishu.cn/file/boxcnT7mKncOLwyhbDjSGrCPhed">æ¦‚ç‡è®º.pdf - æˆç”µé£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)</a></p><h2 id="é«˜ç­‰æ•°å­¦"><a href="#é«˜ç­‰æ•°å­¦" class="headerlink" title="é«˜ç­‰æ•°å­¦"></a>é«˜ç­‰æ•°å­¦</h2><p><a href="https://uestc.feishu.cn/file/QdMtbKWaDofazmxMw6EcHqFyndc">é«˜ç­‰æ•°å­¦çŸ¥è¯†ç‚¹æœ€å…¨æ±‡æ€».pdf - æˆç”µé£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)</a></p><p><a href="https://blog.csdn.net/crj0926/article/details/101761433?ops_request_misc=&request_id=&biz_id=102&utm_term=%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0%E5%92%8C%E5%8F%98%E6%8D%A2%E5%8C%BA%E5%88%AB&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-5-101761433.142%5Ev87%5Einsert_down28,239%5Ev2%5Einsert_chatgpt&spm=1018.2226.3001.4187">(454æ¡æ¶ˆæ¯) å‚…é‡Œå¶çº§æ•°å’Œå‚…é‡Œå¶å˜æ¢ç®€ä»‹å’Œæ¨å¯¼_å‚…é‡Œå¶çº§æ•°å’Œå‚…é‡Œå¶å˜æ¢çš„åŒºåˆ«å’Œè”ç³»_HKDERçš„åšå®¢-CSDNåšå®¢</a></p><h2 id="ç¦»æ•£æ•°å­¦"><a href="#ç¦»æ•£æ•°å­¦" class="headerlink" title="ç¦»æ•£æ•°å­¦"></a>ç¦»æ•£æ•°å­¦</h2><p><a href="https://uestc.feishu.cn/file/PjBcbDESvoKrngxSYHScvkCInJd">ç¦»æ•£æ•°å­¦.docx - æˆç”µé£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)</a></p><h2 id="çº¿ä»£"><a href="#çº¿ä»£" class="headerlink" title="çº¿ä»£"></a>çº¿ä»£</h2><p><a href="https://uestc.feishu.cn/file/HzV3b1Wxno1LFaxF6G9c1VKunzg">çº¿ä»£.pdf - æˆç”µé£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)</a></p><h2 id="æ•°æ®åº“"><a href="#æ•°æ®åº“" class="headerlink" title="æ•°æ®åº“"></a>æ•°æ®åº“</h2><p><a href="https://uestc.feishu.cn/file/boxcn0xg2vSIlKrccY2Y32c7Hye">æ•°æ®åº“.pdf - æˆç”µé£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)</a></p><h2 id="è½¯ä»¶å·¥ç¨‹"><a href="#è½¯ä»¶å·¥ç¨‹" class="headerlink" title="è½¯ä»¶å·¥ç¨‹"></a>è½¯ä»¶å·¥ç¨‹</h2><h2 id="JAVA-C"><a href="#JAVA-C" class="headerlink" title="JAVA&amp;C++"></a>JAVA&amp;C++</h2><p>[(454æ¡æ¶ˆæ¯) javaâ€”åƒåœ¾å›æ”¶ç®—æ³•(GC)_ä¼šé£çš„çŒªzhuçš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/m0_58196614/article/details/126426266?ops_request_misc=&request_id=&biz_id=102&utm_term=Java">https://blog.csdn.net/m0_58196614/article/details/126426266?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=Java</a> çš„åƒåœ¾å›æ”¶ç®—æ³•&amp;utm_medium&#x3D;distribute.pc_search_result.none-task-blog-2<del>all</del>sobaiduweb~default-0-126426266.142^v87^insert_down28,239^v2^insert_chatgpt&amp;spm&#x3D;1018.2226.3001.4187)</p><h2 id="ç»éªŒè´´"><a href="#ç»éªŒè´´" class="headerlink" title="ç»éªŒè´´"></a>ç»éªŒè´´</h2><p><a href="https://zhuanlan.zhihu.com/p/415169966">2021å¹´è®¡ç®—æœºä¿ç ”ç»éªŒå¸– - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://zhuanlan.zhihu.com/p/569448591">2022å—å¤§cså¤ä»¤è¥ç¬”è¯•é¢è¯•å‡†å¤‡ - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://www.rstk.cn/news/624725.html?action=onClick">https://www.rstk.cn/news/624725.html?action=onClick</a></p><p><a href="https://zhuanlan.zhihu.com/p/377444777">2021å¹´åŠè·¨CSä¿ç ”ç»å†ï¼ˆå·²ä¸Šå²¸pkuï¼‰ - çŸ¥ä¹ (zhihu.com)</a></p><h2 id="æœºè¯•çœŸé¢˜"><a href="#æœºè¯•çœŸé¢˜" class="headerlink" title="æœºè¯•çœŸé¢˜"></a>æœºè¯•çœŸé¢˜</h2><p><a href="https://github.com/Muyiyunzi/BUAA-CS-Codes">Muyiyunzi&#x2F;BUAA-CS-Codes: åŒ—äº¬èˆªç©ºèˆªå¤©å¤§å­¦è®¡ç®—æœºå­¦é™¢ç ”ç©¶ç”Ÿè€ƒè¯•å¤è¯•ä¸Šæœºéƒ¨åˆ†å¾€å¹´è¯•é¢˜åŠè§£ç­” (github.com)</a></p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¿ç ” </tag>
            
            <tag> ç®—æ³• </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
            <tag> è®¡ç®—æœºç½‘ç»œ </tag>
            
            <tag> é«˜ç­‰æ•°å­¦ </tag>
            
            <tag> çº¿æ€§ä»£æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿ç ”ç»éªŒè´´</title>
      <link href="/2024/06/24/%E4%BF%9D%E7%A0%94%E7%BB%8F%E9%AA%8C%E8%B4%B4/"/>
      <url>/2024/06/24/%E4%BF%9D%E7%A0%94%E7%BB%8F%E9%AA%8C%E8%B4%B4/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¿ç ”ç»éªŒè´´"><a href="#ä¿ç ”ç»éªŒè´´" class="headerlink" title="ä¿ç ”ç»éªŒè´´"></a>ä¿ç ”ç»éªŒè´´</h1><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>ä»Šå¤©è¢«ä¸¤ä¸‰ä¸ª25å±Šçš„åŒå­¦é—®åˆ°ä¿ç ”çš„äº‹ å°˜å°è®¸ä¹…çš„è®°å¿†å†æ¬¡æ‰“å¼€ å†æ¬¡æ±‡æ€»äº†ä¹‹å‰æ”¶åˆ°çš„æ‰€æœ‰ä¿¡æ¯å’Œä»…å­˜çš„è®°å¿† ç»™ä¸€ç‚¹æ¨¡æ¿ä¸Šçš„å‚è€ƒ<br>æ³¨:æ˜¯ç–«æƒ…è§£å°åç¬¬ä¸€æ¬¡çº¿ä¸‹ æ•…ä¹‹å‰å¾ˆå¤šç»éªŒè´´æ²¡æœ‰å‚è€ƒæ€§</p><p>bg: 985æœ¬SE</p><p>rank: 3&#x2F;181 3.99&#x2F;4.00</p><p>è®ºæ–‡: æ— </p><p>ç«èµ›: åŒå›½ä¸‰ åŒçœä¸€ ä¸€çœä¸‰ næ ¡å¥–</p><p>å¥–å­¦é‡‘: ä¸¤å¹´å›½å¥–</p><p>æ–¹å‘: åˆ†å¸ƒå¼ç³»ç»Ÿ&#x2F;å­˜å‚¨ åæ¶æ„å’Œç³»ç»Ÿè®¾è®¡æ–¹å‘</p><p>å®ä¹ : æŸè‡ªé©¾å…¬å¸åœ°å›¾å­˜å‚¨ç³»ç»Ÿ&#x2F;å­—èŠ‚æŠ–éŸ³ç”µå•†å¼€å‘å²—</p><p>ç”±äºå¤ä»¤è¥å·²ç»ä¸Šå²¸ æ•…æ²¡æœ‰å‚åŠ åç»­é¢„æ¨å…</p><p>å…¥è¥:</p><p>å¤ä»¤è¥:</p><p>â‘ åŒ—å¤§è®¡ç®—æœº ç›´åšï¼ˆæ”¾å¼ƒä¸”æ„æ„¿ä¸å¼º çœŸä¸æƒ³è¯»åšï¼‰</p><p>â‘¡åŒ—å¤§è½¯å¾® ç¡•å£«ï¼ˆè®¡ç®—æœºå­¦é™¢ç»„â•è€å¸ˆ æœ€ç»ˆå»å‘ï¼‰</p><p>â‘¢ä¸­å›½ç§‘å­¦é™¢è®¡ç®—æ‰€ ç¡•å£«</p><p>â‘£ä¸Šæµ·äº¤é€šå¤§å­¦ç”µé™¢ ç¡•å£«</p><p>â‘¤å—äº¬å¤§å­¦è®¡ç®—æœºå­¦é™¢ ç¡•å£«</p><p>â‘¥åŒ—äº¬èˆªç©ºèˆªå¤©å¤§å­¦è®¡ç®—æœºå­¦é™¢ ç¡•å£«ï¼ˆæ”¾å¼ƒï¼‰</p><p>â‘¦ä¸­å›½äººæ°‘å¤§å­¦ä¿¡é™¢ ç¡•å£«</p><p>â‘§è¥¿å®‰äº¤é€šå¤§å­¦è®¡ç®—æœºå­¦é™¢ ç¡•å£«</p><p>è¢«æ‹’:</p><p>â‘ å¤æ—¦å¤§å­¦è®¡ç®—æœºå­¦é™¢ï¼ˆåªè¦ç¬¬ä¸€æˆ‘ä¹Ÿæ²¡åŠæ³•ï¼‰</p><p>å‚åŠ :</p><p>ç”±äºåœ¨å®ä¹ çœŸæŠ½ä¸å¼€æ—¶é—´å»å…¶ä»–åœ°æ–¹å‚è¥</p><p>â‘ åŒ—å¤§è½¯å¾®</p><p>â‘¡åŒ—èˆªè®¡ç®—æœº</p><p>â‘¢å—å¤§è®¡ç®—æœºï¼ˆå‚åŠ äº†éƒ¨åˆ† è·å¾—è½¯ä»¶æ‰€çš„é€šè¿‡äº†ä½†åé¢ä¸æ˜¯å¾ˆæƒ³å»å‚åŠ äº†â€¦è·ŸåŒ—å¤§æœ‰å†²çªä¹Ÿæ˜¯ä¸ªé‡è¦åŸå› ï¼‰<br>ä¼˜è¥</p><p>â‘ åŒ—å¤§è½¯å¾®</p><p>â‘¡åŒ—èˆªè®¡ç®—æœº</p><h2 id="å‡†å¤‡é˜¶æ®µ"><a href="#å‡†å¤‡é˜¶æ®µ" class="headerlink" title="å‡†å¤‡é˜¶æ®µ"></a>å‡†å¤‡é˜¶æ®µ</h2><p>æ•°å­¦æ–¹é¢:</p><p>â‘ æ¦‚ç‡è®ºâ‘¡çº¿æ€§ä»£æ•°â‘¢å¾®ç§¯åˆ†â‘£ç¦»æ•£æ•°å­¦</p><p>è¿™éƒ¨åˆ†éœ€è¦ä»å¤´åˆ°å°¾è¿‡ä¸€é ç›¸å…³æ¦‚å¿µã€è”ç³»ä¸€å®šè¦ç†Ÿï¼Œå„éƒ¨åˆ†é‡ç‚¹å…¶å®ç½‘ä¸Šæ€»ç»“ğŸ‰ååˆ†è¯¦ç»†äº† ä¸€å®šå¥½å¥½å‡†å¤‡ï¼</p><p>è‹±è¯­æ–¹é¢:</p><p>â‘ å„ç§æ—¥å¸¸å£è¯­â•éƒ¨åˆ†è®¡ç®—æœºç›¸å…³ä¸“ä¸šçš„è¯æ±‡ ä¸éœ€è¦ç‰¹åˆ«è¯¦ç»† ä½†æˆ‘å»ºè®®ææ—©ä¸€ä¸ªæœˆè¿›å…¥çŠ¶æ€</p><p>ä¸“ä¸šçŸ¥è¯†:</p><p>â‘ æ•°æ®ç»“æ„â‘¡è®¡ç®—æœºç½‘ç»œâ‘¢æ“ä½œç³»ç»Ÿâ‘£è®¡ç»„â‘¤ç¼–è¯‘åŸç†â‘¥æœºè¯•ï¼ï¼ï¼ï¼ˆåˆ«è¯´å…¶ä»–è¯­è¨€äº† ç°åœ¨å­¦c++è¿˜æ¥å¾—åŠ STLå¼„ç†Ÿâ•ç‹é“æœºè¯•æŒ‡å—â•åŠ›æ‰£â•åˆ°å¤„æœé›†çœŸé¢˜ çˆ†ï¼ï¼ï¼ï¼‰</p><p>å››äº”å¾ˆå°‘è€ƒ å—å¤§è®¡ç®—æœºçš„ç¬”è¯•ç‰¹åˆ«å–œæ¬¢è€ƒç¼–è¯‘åŸç†â€”â€”é¢˜ç®€ç›´åˆå¤šåˆé•¿åˆéš¾ æ•°æ®ç»“æ„é‡ä¸­ä¹‹é‡ æœºè¯•ä¸€å®šå¥½å¥½å‡†å¤‡ï¼ï¼ï¼</p><h2 id="æ‰§è¡Œé˜¶æ®µ"><a href="#æ‰§è¡Œé˜¶æ®µ" class="headerlink" title="æ‰§è¡Œé˜¶æ®µ"></a>æ‰§è¡Œé˜¶æ®µ</h2><p>å—å¤§è®¡ç®—æœºï¼ˆæµç¨‹ç¹çï¼‰</p><p>â‘ æœ€å¼€å§‹æˆ‘è®°å¾—æ˜¯è½¯ä»¶æ‰€æœ‰ä¸ªé¢è¯•ï¼Œçº¿ä¸Šçš„ï¼Œä¼šé—®ä¸€äº›ç¦»æ•£æ•°å­¦ï¼ˆå¹³é¢å›¾ å“ˆå¯†é¡¿å›¾ç­‰ç­‰ï¼‰å’Œä¸€äº›æ•°æ®ç»“æ„çš„é¢˜ å·®ä¸å¤šåäº”åˆ†é’Ÿï¼ˆè¿™ä¸€éƒ¨åˆ†æ˜¯æå‰äº†å·®ä¸å¤šä¸¤ä¸ªæœˆè¿›è¡Œçš„ï¼‰</p><p>â‘¡åç»­åœ¨ä¸´è¿‘å¤ä»¤è¥çš„æ—¶å€™è¿˜æœ‰ä¸€è½®çº¿ä¸Šç¬”è¯• å·¨éš¾ï¼ˆå¦‚æœæ²¡å­¦è¿‡ç¼–è¯‘åŸç†å°±å¯„äº†ï¼‰</p><p>â‘¢åç»­å°±æ˜¯å»çº¿ä¸‹å•¦ ä½†é—æ†¾æ²¡å»çœ‹çœ‹ç¾ä¸½çš„ä»™æ—æ ¡åŒºğŸ˜­</p><p>åŒ—èˆªè®¡ç®—æœºï¼ˆç‰¹è‰²å¤§æ¨¡æ‹Ÿâ•ä¸æŠ¥é”€è½¦è´¹è·¯è´¹ ç”šè‡³ä¸åŒ…åƒï¼‰</p><p>â‘ ç¬¬ä¸€å¤©å°±æ˜¯ä¸¤é“æœºè¯• æ€»å…±ä¸¤å°æ—¶ ç¬¬ä¸€é“å¤§æ¨¡æ‹ŸçœŸçš„æçš„å¤´å¤§ï¼ˆå¥½åœ¨è¿˜æ˜¯å†™å¯¹äº†ï¼‰ ç¬¬äºŒé“çœŸæ˜¯å®Œå…¨ä¸€ç‚¹ä¸ä¼šï¼ˆä¸æ˜¯å¸¸è§„çš„ç®—æ³•é¢˜ï¼‰ è¿™ä¸€è½®ğŸ‰è‡³å°‘åšå¯¹ä¸€ä¸ªæ‰èƒ½è¿›å…¥ä¸‹ä¸€è½®</p><p>â‘¡ç¬¬äºŒå¤©é¢è¯• æ•°å­¦â•è‹±è¯­â•å„ç§ä¸“ä¸šé—®é¢˜ ç”šè‡³è¿˜é—®äº†æˆ‘å‰ç«¯â•åç«¯â•javaå’Œc++ pythonè¯­è¨€ç‰¹æ€§ä½¿ç”¨åœºæ™¯ï¼ˆå¥½åœ¨å“¥ä»¬ä¹Ÿæ˜¯å®ä¹ é¢è¯•äº†å‡ åè½®è¿˜æ˜¯ä¿¡æ‰‹æ‹ˆæ¥çš„ï¼‰</p><p>è€å¸ˆå…¨ç¨‹å‹åŠ›é¢ï¼Œä¸èƒ½æ€‚ï¼</p><p>ç„¶åä¼˜è¥å‘çš„å¾ˆå¿«ï¼Œæˆ‘è®°å¾—æ˜¯7æœˆ2å·å°±å‘äº†ï¼Œä¹Ÿæ˜¯æˆ‘ç¬¬ä¸€ä¸ªä¼˜è¥</p><p>åŒ—å¤§è½¯å¾®</p><p>è½¯å¾®ä»22å¹´å¼€å§‹æ¯”è¾ƒç‰¹æ®Šï¼Œé¦–å…ˆæ®è¯´è¦é€€å­¦è´¹ï¼Œå…¶æ¬¡å¤ä»¤è¥çš„å¸ˆèµ„å’Œå®éªŒå®¤å¯ä»¥æ˜¯è®¡ç®—æœºå­¦é™¢&#x2F;æ™ºèƒ½å­¦é™¢çš„ï¼ŒåŠ ä¸Šè¿˜æ˜¯ç¡•å£«ç®€ç›´ä¸è¦å¤ªé¦™å¥½å§</p><p>â‘ ç¬¬ä¸€å¤©é—²èŠå¹æ°´ æˆ‘å°±è®°å¾—ç´«ç‡•ç™¾å‘³é¸¡å¤–å–è¿˜æŒºå¥½åƒ</p><p>â‘¡å…ˆæ¥ä¸‰é“ç®—æ³•é¢˜ï¼ï¼ˆ30min æˆ‘ä»¬ç»„è·Ÿç³»ç»Ÿæ–¹å‘å¼ºç›¸å…³ä¸‰é“åˆ†åˆ«æ˜¯mid mid hardéš¾åº¦çš„ å¯ä»¥å†™ä¼ªä»£ç ï¼‰å…¶å®æˆ‘ç¬¬ä¸‰é“æœ‰ç‚¹é—®é¢˜ä½†ç”±äºå¤ªè‡ªä¿¡ç”šè‡³åç»­é¢è¯•å½“åœºç»™å‡ºæ¥æ•°å­¦è¯æ˜è®©è€å¸ˆä¹Ÿç–‘æƒ‘ä½äº†</p><p>â‘¢é¢è¯•: è‡ªæˆ‘ä»‹ç»â•å„ç§é—®é¢˜çš„æé—® ç”šè‡³é—®åˆ°æˆ‘ä¸€äº›å…³äºå®ä¹ ç”¨åˆ°çš„juiceFSå’Œä¸€äº›åº•å±‚çš„æ¦‚å¿µ&#x2F;åˆ†å¸ƒå¼å…±è¯†&#x2F;è¿ç»´&#x2F;ç¼“å­˜ç­‰ï¼Œè¿˜é—®åˆ°ä»£ç é‡ï¼ˆå¿…ç„¶æ˜¯å¤šå¤šï¼‰ï¼Œä»¥åŠæ•°å­¦ä¸Šé¢çš„è¯æ˜â•ç®—æ³•é¢˜å¤ç›˜â•ä¸€äº›å…¶ä»–çš„é—®é¢˜ï¼Œå…¶å®éƒ½è¿˜å¥½ï¼Œè™½ç„¶æ²¡å…¨å‡†å¤‡è¿‡ä½†æ„å¤–è¾¾çš„éå¸¸å¥½ï¼ˆæœ€ç»ˆæ‹Ÿå½•å–çœ‹å¤è¯•åˆ†æ•°æ’åç«Ÿç„¶å·®ä¸å¤šå‰1ï¼…ï¼‰</p><p>ä¼˜è¥éš”äº†å‡ å¤©å°±å‘äº† </p><h2 id="ä¸€äº›è¢«é—®åˆ°çš„é—®é¢˜"><a href="#ä¸€äº›è¢«é—®åˆ°çš„é—®é¢˜" class="headerlink" title="ä¸€äº›è¢«é—®åˆ°çš„é—®é¢˜"></a>ä¸€äº›è¢«é—®åˆ°çš„é—®é¢˜</h2><ol><li><p>è®ºæ–‡æ˜¯å¿…é¡»çš„å—ï¼Ÿ</p><p>æœ‰æœ€å¥½ï¼Œå¦‚æœæaiå¿…é¡»æœ‰ç›¸å…³å®ä¹ &#x2F;ç§‘ç ”ç»å†ï¼Œå¦‚æœèµ°systemè·¯çº¿æœ‰å®ä¹ æˆ–è€…ç»å†éƒ½è¡Œ</p></li><li><p>å››å…­çº§çœŸçš„é‡è¦å—ï¼Ÿ</p><p>æˆ‘è§‰å¾—ä¸€èˆ¬é‡è¦ ä¸è¦å¤ªä½å°±è¡Œ</p></li><li><p>ç»™è®¡ç®—æœºä¸“ä¸šè¯¾é‡è¦ç¨‹åº¦æ’ä¸ªåº</p><p>æ•°æ®ç»“æ„ï¼è®¡ç®—æœºç½‘ç»œ&#x3D;æ“ä½œç³»ç»Ÿï¼è®¡ç»„ï¼ç¼–è¯‘åŸç†</p></li><li><p>äº‹å…ˆå¥—ç£äº†å—ï¼Ÿ</p><p>äº”æœˆä»½å¥—äº†ä¸€ä¸ªï¼Œä½†å¼ºcomã€‚æˆ‘å»ºè®®ç°åœ¨3æœˆä»½å°±å¯ä»¥å¼€å§‹å¥—äº†ï¼Œè¶Šæ—©è¶Šå¥½ï¼</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> ç»éªŒè´´ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¿ç ” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaåˆ·é¢˜</title>
      <link href="/2024/06/24/Java%20algo/"/>
      <url>/2024/06/24/Java%20algo/</url>
      
        <content type="html"><![CDATA[<h1 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h1><p><a href="https://blog.csdn.net/leader_song/article/details/132094080?ops_request_misc=%7B%22request_id%22:%22171151104816800211548110%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=171151104816800211548110&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-132094080-null-null.142%5Ev100%5Epc_search_result_base2&utm_term=java%E9%9D%A2%E8%AF%95%E5%85%AB%E8%82%A1%E6%96%872023&spm=1018.2226.3001.4187">2024å¹´ Java é¢è¯•å…«è‚¡æ–‡ï¼ˆ20wå­—ï¼‰_javaå…«è‚¡æ–‡2023-CSDNåšå®¢</a></p><h2 id="SQL"><a href="#SQL" class="headerlink" title="SQL"></a>SQL</h2><p><a href="https://blog.csdn.net/weixin_43004044/article/details/126557968?ops_request_misc=%7B%22request_id%22:%22172025351316800188511203%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172025351316800188511203&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-126557968-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=SQL%E9%A2%98&spm=1018.2226.3001.4187">SQL 50 é¢˜ï¼ˆMySQL ç‰ˆï¼ŒåŒ…æ‹¬å»ºåº“å»ºè¡¨ã€æ’å…¥æ•°æ®ç­‰å®Œæ•´è¿‡ç¨‹ï¼Œé€‚åˆå¤ä¹  SQL çŸ¥è¯†ç‚¹ï¼‰_sql50é¢˜-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/weixin_47882020/article/details/120826208?ops_request_misc=%7B%22request_id%22:%22172025532416800215087064%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172025532416800215087064&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-120826208-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=sql%E8%AF%AD%E8%A8%80%E8%AF%AD%E6%B3%95&spm=1018.2226.3001.4187">SQLå¸¸è§è¯­å¥åŠç”¨æ³•_sqlè¯­å¥å¤§å…¨åŠç”¨æ³•-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/qq7652401741/article/details/100121549?ops_request_misc=%7B%22request_id%22:%22172033820916800188561235%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172033820916800188561235&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-100121549-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=SQL%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0%E5%92%8Cwhere&spm=1018.2226.3001.4187">SQLä¸­çš„ èšåˆå‡½æ•° ,where ,having_whereåé¢å¯ä»¥è·Ÿèšåˆå‡½æ•°å—-CSDNåšå®¢</a></p><h2 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h2><p><a href="https://blog.csdn.net/qq_62124267/article/details/135418799?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_utm_term~default-0-135418799-blog-124295453.235%5Ev43%5Epc_blog_bottom_relevance_base7&spm=1001.2101.3001.4242.1&utm_relevant_index=1">é¢è¯•è¢«é—®äº†å‡ ç™¾éçš„ IOC å’Œ AOP ï¼Œä¸€ç¯‡æ–‡ç« å¸¦ä½ ææ¸…æ¥šï¼ï¼ï¼_iocå’Œaopçš„åŸç†é¢è¯•-CSDNåšå®¢</a></p><h2 id="Sentinel"><a href="#Sentinel" class="headerlink" title="Sentinel"></a>Sentinel</h2><p><a href="https://blog.csdn.net/crazymakercircle/article/details/125059491?ops_request_misc=%7B%22request_id%22:%22171164453116800225568300%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=171164453116800225568300&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-125059491-null-null.142%5Ev100%5Epc_search_result_base2&utm_term=sentinel&spm=1018.2226.3001.4187">sentinel ï¼ˆå²ä¸Šæœ€å…¨ï¼‰-CSDNåšå®¢</a></p><h2 id="Gradle-Maven"><a href="#Gradle-Maven" class="headerlink" title="Gradle&amp;Maven"></a>Gradle&amp;Maven</h2><p><a href="https://flydean.blog.csdn.net/article/details/113803536?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-1-113803536-blog-133955312.235%5Ev43%5Epc_blog_bottom_relevance_base7&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-1-113803536-blog-133955312.235%5Ev43%5Epc_blog_bottom_relevance_base7&utm_relevant_index=2">gradleä¸­çš„build scriptè¯¦è§£_gradle buildscript-CSDNåšå®¢</a></p><p>[Gradleå’ŒMavençš„åŒºåˆ«-CSDNåšå®¢](<a href="https://blog.csdn.net/weixin_45626288/article/details/131973787?ops_request_misc=%7B%22request_id%22:%22172024305816800185819613%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172024305816800185819613&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-131973787-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=gradle">https://blog.csdn.net/weixin_45626288/article/details/131973787?ops_request_misc=%7B%22request%5Fid%22%3A%22172024305816800185819613%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=172024305816800185819613&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-131973787-null-null.142^v100^pc_search_result_base8&amp;utm_term=gradle</a> maven&amp;spm&#x3D;1018.2226.3001.4187)</p><h2 id="çº¿ç¨‹æ± å’Œé”"><a href="#çº¿ç¨‹æ± å’Œé”" class="headerlink" title="çº¿ç¨‹æ± å’Œé”"></a>çº¿ç¨‹æ± å’Œé”</h2><p><a href="https://blog.csdn.net/qq_54070103/article/details/124108541?ops_request_misc=%7B%22request_id%22:%22172024328716800184129598%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172024328716800184129598&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-124108541-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=%E7%BA%BF%E7%A8%8B%E6%B1%A0%E5%92%8C%E9%94%81&spm=1018.2226.3001.4187">é¢è¯•+åŸºç¡€â€”â€“è¯¦ç»†è§£è¯»å¤šçº¿ç¨‹ï¼ˆçº¿ç¨‹æ± ã€é”ã€æ­»é”â€¦ï¼‰_å¤šçº¿ç¨‹äº•å‘ã€æ­»é”é—®é¢˜ã€çº¿ç¨‹æ± åŸç†ç­‰-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/u013541140/article/details/95225769?ops_request_misc=%7B%22request_id%22:%22172024532116800211519152%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172024532116800211519152&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-95225769-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=%E7%BA%BF%E7%A8%8B%E6%B1%A0&spm=1018.2226.3001.4187">Java å¤šçº¿ç¨‹ï¼šå½»åº•ææ‡‚çº¿ç¨‹æ± _javaçº¿ç¨‹æ± -CSDNåšå®¢</a></p><h2 id="Netty"><a href="#Netty" class="headerlink" title="Netty"></a>Netty</h2><p><a href="https://blog.csdn.net/qq_35190492/article/details/113174359?ops_request_misc=%7B%22request_id%22:%22172024555916800184190893%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172024555916800184190893&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-113174359-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=netty&spm=1018.2226.3001.4187">ã€ç¡¬æ ¸ã€‘è‚äº†ä¸€æœˆçš„NettyçŸ¥è¯†ç‚¹-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/qq_33384191/article/details/129187707?ops_request_misc=%7B%22request_id%22:%22172024555916800184190893%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172024555916800184190893&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-2-129187707-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=netty&spm=1018.2226.3001.4187">è¶…è¯¦ç»†Nettyå…¥é—¨ï¼Œçœ‹è¿™ç¯‡å°±å¤Ÿäº†ï¼_nettyæ¡†æ¶-CSDNåšå®¢</a></p><h2 id="JUnit"><a href="#JUnit" class="headerlink" title="JUnit"></a>JUnit</h2><p><a href="https://blog.csdn.net/qq_41317495/article/details/108553894?ops_request_misc=%7B%22request_id%22:%22172024618916800185817050%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172024618916800185817050&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-108553894-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=JUnit&spm=1018.2226.3001.4187">JUnitè¯¦è§£-CSDNåšå®¢</a></p><h2 id="Pytest"><a href="#Pytest" class="headerlink" title="Pytest"></a>Pytest</h2><p><a href="https://blog.csdn.net/lovedingd/article/details/98952868?ops_request_misc=%7B%22request_id%22:%22172024619416800226527972%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172024619416800226527972&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-98952868-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=pytest&spm=1018.2226.3001.4187">Pythonæµ‹è¯•æ¡†æ¶ä¹‹pytestè¯¦è§£_pytestæ¡†æ¶è¯¦è§£-CSDNåšå®¢</a></p><h2 id="Docker"><a href="#Docker" class="headerlink" title="Docker"></a>Docker</h2><p><a href="https://blog.csdn.net/m0_61503020/article/details/125456520?ops_request_misc=%7B%22request_id%22:%22172024335816800225519741%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172024335816800225519741&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-125456520-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=docker&spm=1018.2226.3001.4187">dockerå…¥é—¨ï¼Œè¿™ä¸€ç¯‡å°±å¤Ÿäº†ã€‚-CSDNåšå®¢</a></p><blockquote><p>docker run [å¯é€‰å‚æ•°] image å‘½ä»¤ #å¯åŠ¨å®¹å™¨ï¼ˆæ— é•œåƒä¼šå…ˆä¸‹è½½é•œåƒï¼‰<br>#å‚æ•°è¯´æ˜<br>â€“name &#x3D; â€œNameâ€   å®¹å™¨åå­—<br>-c   åé¢è·Ÿå¾…å®Œæˆçš„å‘½ä»¤<br>-d   ä»¥åå°æ–¹å¼è¿è¡Œå¹¶ä¸”è¿”å›IDï¼Œå¯åŠ¨å®ˆæŠ¤è¿›ç¨‹å¼å®¹å™¨<br>-i   ä½¿ç”¨äº¤äº’æ–¹å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸tåŒæ—¶ä½¿ç”¨<br>-t   ä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ã€‚ä¹Ÿå³å¯åŠ¨äº¤äº’å¼å®¹å™¨<br>-p   æŒ‡å®šå®¹å™¨ç«¯å£    -p å®¹å™¨ç«¯å£:ç‰©ç†æœºç«¯å£  æ˜ å°„ç«¯å£<br>-P   éšæœºæŒ‡å®šç«¯å£<br>-v   ç»™å®¹å™¨æŒ‚è½½å­˜å‚¨å·</p></blockquote><h2 id="JVM"><a href="#JVM" class="headerlink" title="JVM"></a>JVM</h2><p>[JAVAå†…å­˜åˆ†é…åŸç†è§£æâ€“æ ˆã€å †ã€å¸¸é‡æ± _å †,æ ˆ,å¸¸é‡æ± è¯¦è§£-CSDNåšå®¢](<a href="https://blog.csdn.net/gb702250823/article/details/92801716?ops_request_misc=%7B%22request_id%22:%22171151029816800225558425%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=171151029816800225558425&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-92801716-null-null.142%5Ev100%5Epc_search_result_base2&utm_term=java">https://blog.csdn.net/gb702250823/article/details/92801716?ops_request_misc=%7B%22request%5Fid%22%3A%22171151029816800225558425%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=171151029816800225558425&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-92801716-null-null.142^v100^pc_search_result_base2&amp;utm_term=java</a> å¸¸é‡æ±  æ ˆ å †&amp;spm&#x3D;1018.2226.3001.4187)</p><p><a href="https://blog.csdn.net/LJWfbj666/article/details/139120947?ops_request_misc=&request_id=&biz_id=102&utm_term=java%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-139120947.142%5Ev100%5Epc_search_result_base8&spm=1018.2226.3001.4187">javaçš„åƒåœ¾å›æ”¶(GC)è¯¦è§£_java gc-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/ZHHX666/article/details/124484199?ops_request_misc=%7B%22request_id%22:%22172025262616800182710898%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=172025262616800182710898&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-124484199-null-null.142%5Ev100%5Epc_search_result_base8&utm_term=java%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8&spm=1018.2226.3001.4187">Java - ç±»åŠ è½½å™¨_javaç±»åŠ è½½å™¨-CSDNåšå®¢</a></p><h2 id="å¸¸ç”¨æ•°æ®ç»“æ„å’Œåº“"><a href="#å¸¸ç”¨æ•°æ®ç»“æ„å’Œåº“" class="headerlink" title="å¸¸ç”¨æ•°æ®ç»“æ„å’Œåº“"></a>å¸¸ç”¨æ•°æ®ç»“æ„å’Œåº“</h2><p><a href="https://blog.csdn.net/CodePlayMe/article/details/130724568?ops_request_misc=%7B%22request_id%22:%22170261719316777224420083%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=170261719316777224420083&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-130724568-null-null.142%5Ev96%5Epc_search_result_base2&utm_term=java%E5%88%B7%E9%A2%98%E5%B8%B8%E7%94%A8%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84&spm=1018.2226.3001.4187">javaåˆ·é¢˜å‰å¸¸ç”¨çš„æ•°æ®ç»“æ„åŠæ–¹æ³•_javaåˆ·é¢˜å¸¸ç”¨æ–¹æ³•-CSDNåšå®¢</a></p><h3 id="ACMæ¨¡å¼"><a href="#ACMæ¨¡å¼" class="headerlink" title="ACMæ¨¡å¼"></a>ACMæ¨¡å¼</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨æ„ç±»åå¿…é¡»ä¸º Main, ä¸è¦æœ‰ä»»ä½• package xxx ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è¾“å…¥è¾“å‡º"><a href="#è¾“å…¥è¾“å‡º" class="headerlink" title="è¾“å…¥è¾“å‡º"></a>è¾“å…¥è¾“å‡º</h3><p>1ã€è¾“å…¥æ•´æ•°ã€å­—ç¬¦ä¸²æ•°ç»„<br>ç¬¬ä¸€è¡Œè¾“å…¥n, m</p><p>ç¬¬äºŒè¡Œè¾“å…¥nä¸ªæ•´æ•°</p><p>ç¬¬ä¸‰è¡Œè¾“å…¥mä¸ªå­—ç¬¦ä¸²</p><pre><code>//å¯¼å…¥åŒ…import java.util.Scanner;import java.util.Arrays;public class MyScanner &#123;public static void main(String[] args) &#123;        //åˆ›å»ºå¯¹è±¡    Scanner sc = new Scanner(System.in);    System.out.println(&quot;è¾“å…¥æ•°æ®:&quot;);    //å¤šè¡Œè¾“å…¥    int n = sc.nextInt();    int m = sc.nextInt();    int[] arr = new int[n];    String[] str = new String[m];        //intç­‰åŸºæœ¬æ•°æ®ç±»å‹çš„æ•°ç»„,ç”¨nextInt()ï¼ŒåŒè¡Œæˆ–ä¸åŒéƒ½å¯ä»¥    for(int i=0; i&lt;n; i++) &#123;        arr[i] = sc.nextInt();    &#125;    //Stringå­—ç¬¦ä¸²æ•°ç»„, è¯»å–ç”¨next()ï¼Œä»¥ç©ºæ ¼åˆ’åˆ†    for(int i=0; i&lt;m; i++) &#123;        str[i] = sc.next();    &#125;        //è°ƒç”¨æ–¹æ³•è¿›è¡Œæ“ä½œ    TestSc(n, m, arr);    TestStr(str);        System.out.println(&quot;Test01 End&quot;);        //å…³é—­    sc.close();&#125;public static void TestSc(int n, int m, int[] arr) &#123;    System.out.println(&quot;æ•°æ®nï¼š&quot; + n + &quot;, æ•°æ®mï¼š&quot; + m);    System.out.println(Arrays.toString(arr));&#125;public static void TestStr(String[] str) &#123;    System.out.println(Arrays.toString(str));&#125;&#125;</code></pre><p>è‹¥è¾“å…¥çš„å­—ç¬¦ä¸²ä¸­æƒ³è¦åŒ…å«ç©ºæ ¼ï¼Œä½¿ç”¨scanner.nextLine()æ¢è¡Œåç”¨scanner.nextLine()è¿›è¡Œè¯»å…¥ï¼Œè§æƒ…å½¢7.</p><p>2ã€è¾“å…¥äºŒç»´æ•°ç»„<br>ç¬¬ä¸€è¡Œè¾“å…¥n, m</p><p>ç¬¬äºŒè¡Œå¼€å§‹è¾“å…¥äºŒç»´æ•°ç»„ã€‚</p><pre><code>import java.util.Arrays;import java.util.Scanner;public class MyScanner2 &#123;public static void main(String[] args) &#123;        Scanner sc = new Scanner(System.in);    System.out.println(&quot;è¾“å…¥æ•°æ®:&quot;);     //äºŒç»´æ•°ç»„    int n = sc.nextInt();    int m = sc.nextInt();    int[][] arr2 = new int[n][m];    System.out.println(&quot;Test02 è¾“å…¥äºŒç»´æ•°ç»„æ•°æ®ï¼š&quot;);     //å¯ä»¥ç›´æ¥è¯»å…¥    for(int i=0; i&lt;n; i++) &#123;        for(int j=0; j&lt;m; j++) &#123;            arr2[i][j] = sc.nextInt();        &#125;    &#125;     TestSc(n, m, arr2);    //å…³é—­    sc.close();&#125;public static void TestSc(int n, int m, int[][] arr) &#123;    System.out.println(&quot;æ•°æ®nï¼š&quot; + n + &quot;, æ•°æ®mï¼š&quot; + m);    for(int i=0; i&lt;n; i++) &#123;        System.out.println(Arrays.toString(arr[i]));    &#125;    System.out.println(&quot;æ•°ç»„è¡Œæ•°ï¼š arr.length= &quot;+ arr.length);    System.out.println(&quot;æ•°ç»„åˆ—æ•°ï¼š arr[0].length= &quot;+ arr[0].length);&#125;&#125;</code></pre><p>3ã€è¾“å…¥å­—ç¬¦ä¸²<br>è¾“å…¥å­—ç¬¦ä¸²ï¼Œç”¨ç©ºæ ¼éš”å¼€ã€‚</p><p>next()å’ŒnextLine()åŒºåˆ«ã€‚</p><p>import java.util.Scanner;<br>&#x2F;*<br> *next()è¯»å–åˆ°ç©ºç™½åœæ­¢ï¼Œåœ¨è¯»å–è¾“å…¥åå°†å…‰æ ‡æ”¾åœ¨åŒä¸€è¡Œä¸­ã€‚<br> *nextLine()è¯»å–åˆ°å›è½¦åœæ­¢ ï¼Œåœ¨è¯»å–è¾“å…¥åå°†å…‰æ ‡æ”¾åœ¨ä¸‹ä¸€è¡Œã€‚<br> *&#x2F;</p><pre><code>public class MyScanner3 &#123;public static void main(String[] args) &#123;        Scanner sc = new Scanner(System.in);    System.out.println(&quot;è¾“å…¥å­—ç¬¦ä¸²:&quot;);        //next():åªè¯»å–è¾“å…¥ç›´åˆ°ç©ºæ ¼ã€‚    String str = sc.next();     //nextLine():è¯»å–è¾“å…¥ï¼ŒåŒ…æ‹¬å•è¯ä¹‹é—´çš„ç©ºæ ¼å’Œé™¤å›è½¦ä»¥å¤–çš„æ‰€æœ‰ç¬¦å·    String str2 = sc.nextLine();     System.out.println(&quot;strï¼š&quot; + str);    System.out.println(&quot;str2ï¼š&quot; + str2);        //å…³é—­    sc.close();&#125;&#125;</code></pre><p>4ã€è¾“å…¥å­—ç¬¦ä¸²åˆ†å‰²ä¸ºæ•°ç»„<br>å…ˆç”¨scanner.nextLine()è¯»å…¥å­—ç¬¦ä¸²ï¼Œå†å°†å­—ç¬¦ä¸²åˆ†å‰²ä¸ºå­—ç¬¦æ•°ç»„æˆ–å­—ç¬¦ä¸²æ•°ç»„ã€‚</p><pre><code>import java.util.*;public class MyScanner4 &#123;public static void main(String[] args) &#123;        Scanner sc = new Scanner(System.in);    System.out.println(&quot;è¾“å…¥å­—ç¬¦ä¸²æ•°ç»„ï¼š&quot;);        String str;    str = sc.nextLine();        char[] ch = new char[str.length()];    for(int i=0; i&lt;str.length(); i++) &#123;        //ç”¨charAt();è¿›è¡Œå®šä½åˆ†éš”        ch[i] = str.charAt(i);        System.out.println(ch[i] + &quot; &quot;);    &#125;    System.out.println(&quot;END&quot;);        //è¯»å…¥å­—ç¬¦ä¸²å,ç”¨ç©ºæ ¼åˆ†éš”ä¸ºæ•°ç»„    String[] strs = str.split(&quot; &quot;);    System.out.println(Arrays.toString(strs)); &#125;&#125;</code></pre><p>5ã€è¿ç»­è¾“å…¥æ•°å­—å’Œå­—ç¬¦ä¸²<br>åŒºåˆ«äºæƒ…å½¢1ï¼Œå¯¹äºä¸èƒ½é‡‡ç”¨forå¾ªç¯çš„æ–¹å¼è·å–Stringã€‚é‡‡ç”¨æƒ…å½¢5,6ç”¨æ¥å¤„ç†ã€‚</p><p>é‡‡ç”¨while(scanner.hasNext()) å¾ªç¯ï¼Œå®ç°è¿ç»­è¾“å…¥ã€‚</p><p>æ ¼å¼ï¼šæ•°å­—ï¼Œç©ºæ ¼ï¼Œå­—ç¬¦ä¸²ã€‚</p><p>æˆ–ï¼š æ•°å­—ï¼Œå›è½¦ï¼Œå­—ç¬¦ä¸²</p><pre><code>import java.util.Scanner;public class MyScanner5 &#123;public static void main(String[] args) &#123;        Scanner sc = new Scanner(System.in);        while(sc.hasNext()) &#123;        int n = sc.nextInt();        String str = sc.next();        Tes(n, str);    &#125;            sc.close();&#125;public static void Tes(int n, String str) &#123;    System.out.println(&quot;n = &quot; + n);    System.out.println(&quot;str = &quot; + str);    System.out.println(&quot;str.length = &quot; + str.length());&#125;&#125;</code></pre><p>6ã€æ¢è¡Œè¾“å…¥æ•°å­—å’Œå­—ç¬¦ä¸²<br>ä¹Ÿé‡‡ç”¨scanner.nextLine()ï¼Œå°†å…‰æ ‡ç§»åˆ°ä¸‹ä¸€è¡Œã€‚å†ç»§ç»­è¯»å…¥å­—ç¬¦ä¸²ã€‚</p><p>ç¬¬ä¸€è¡Œè¾“å…¥æ•´æ•°nï¼Œmï¼Œç¬¬äºŒè¡Œå¼€å§‹è¾“å…¥å­—ç¬¦ä¸²ã€‚æˆ–</p><p>ç¬¬ä¸€è¡Œè¾“å…¥æ•´æ•°nï¼Œç¬¬äºŒè¡Œè¾“å…¥mï¼Œç¬¬ä¸‰è¡Œå¼€å§‹è¾“å…¥å­—ç¬¦ä¸²ã€‚</p><pre><code>import java.util.*;public class MyScanner6 &#123;public static void main(String[] args) &#123;    Scanner sc = new Scanner(System.in);    int n = sc.nextInt();    int m = sc.nextInt();        //æ³¨æ„ï¼ï¼ï¼å…‰æ ‡æ¢åˆ°ä¸‹ä¸€è¡Œ    sc.nextLine();        String s = sc.nextLine();    String str = sc.nextLine();        System.out.println(&quot;n = &quot; + n + &quot; , m = &quot; + m);    System.out.println(&quot;s = &quot; + s);    System.out.println(&quot;str = &quot; + str);                sc.close();&#125;&#125;</code></pre><p>7ã€æ¢è¡Œè¾“å…¥æ•°å­—å’Œå­—ç¬¦ä¸²(éœ€è¦åŒ…å«ç©ºæ ¼)<br>é‡‡ç”¨scanner.nextLine()ï¼Œå°†å…‰æ ‡ç§»åˆ°ä¸‹ä¸€è¡Œã€‚å†ç»§ç»­è¯»å…¥å­—ç¬¦ä¸²ã€‚</p><p>ç¬¬ä¸€è¡Œè¾“å…¥nï¼Œ</p><p>ç¬¬äºŒè¡Œå¼€å§‹è¾“å…¥nè¡Œå­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²ä¸­åŒ…å«ç©ºæ ¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyScanner7</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line"><span class="type">Scanner</span> <span class="variable">sc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> sc.nextInt();</span><br><span class="line">String[] strs = <span class="keyword">new</span> <span class="title class_">String</span>[n]; </span><br><span class="line"></span><br><span class="line">sc.nextLine();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;n; i++) &#123;</span><br><span class="line"><span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> sc.nextLine();</span><br><span class="line">strs[i] = str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Tes2(strs);</span><br><span class="line">System.out.println(<span class="string">&quot;End&quot;</span>);</span><br><span class="line">sc.close();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Tes2</span><span class="params">(String[] strs)</span> &#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;strs.length; i++) &#123;</span><br><span class="line"><span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> strs[i];</span><br><span class="line">System.out.println(str);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="int-è½¬Integer"><a href="#int-è½¬Integer" class="headerlink" title="int è½¬Integer"></a>int è½¬Integer</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> num=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">Integer</span> <span class="variable">i</span> <span class="operator">=</span> Integer.valueOf(num);</span><br></pre></td></tr></table></figure><h3 id="Integerè½¬int"><a href="#Integerè½¬int" class="headerlink" title="Integerè½¬int"></a>Integerè½¬int</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> integer.intValue();</span><br></pre></td></tr></table></figure><h3 id="intåˆ°Stringæ•°æ®ç±»å‹çš„è½¬æ¢"><a href="#intåˆ°Stringæ•°æ®ç±»å‹çš„è½¬æ¢" class="headerlink" title="intåˆ°Stringæ•°æ®ç±»å‹çš„è½¬æ¢"></a><strong>intåˆ°Stringæ•°æ®ç±»å‹çš„è½¬æ¢</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> num;</span><br><span class="line"></span><br><span class="line">Integer.toString(num);</span><br></pre></td></tr></table></figure><p>æˆ–è€…<strong>String.valueOf(num);</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorld</span> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">   <span class="comment">// å¼•å·å¸¦ä¸Šæ•°æ®</span></span><br><span class="line">    <span class="type">int</span> num=<span class="number">100</span>;</span><br><span class="line">    String a=<span class="string">&quot;&quot;</span>+num;</span><br><span class="line">    System.out.println(a);</span><br><span class="line">   <span class="comment">// ç›´æ¥ç±»å‹è½¬æ¢</span></span><br><span class="line">    Integer num2=<span class="number">100</span>;</span><br><span class="line">    String b=Integer.toString(num2);</span><br><span class="line">    System.out.println(b);</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å­—ç¬¦ä¸²å®šä¹‰</span></span><br><span class="line">    String c=String.valueOf(num2);</span><br><span class="line">    System.out.println(c);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Stringåˆ°intç±»å‹çš„è½¬æ¢"><a href="#Stringåˆ°intç±»å‹çš„è½¬æ¢" class="headerlink" title="Stringåˆ°intç±»å‹çš„è½¬æ¢"></a><strong>Stringåˆ°intç±»å‹çš„è½¬æ¢</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="string">&quot;100&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">d</span> <span class="operator">=</span> Integer.parseInt(s);</span><br><span class="line">    <span class="comment">// parseInt</span></span><br><span class="line">    <span class="comment">// åŠ ä¸Šstaticçš„æ–¹æ³•ï¼Œæ–¹æ³•å±äºç±»ï¼Œéœ€è¦ä½¿ç”¨ç±»åè¿›è¡Œè°ƒç”¨ï¼Œæ²¡æœ‰åŠ ä¸Šstaticçš„ï¼Œæ–¹æ³•å±äºå¯¹è±¡ï¼Œå¯ä»¥newä¸€ä¸ªå¯¹è±¡å†è°ƒç”¨</span></span><br><span class="line">    <span class="type">int</span> e=Integer.parseInt(s);</span><br><span class="line">    System.out.println(e);</span><br></pre></td></tr></table></figure><h3 id="ArrayListåŠ¨æ€è½¬æ¢ä¸ºArrayæ•°ç»„"><a href="#ArrayListåŠ¨æ€è½¬æ¢ä¸ºArrayæ•°ç»„" class="headerlink" title="ArrayListåŠ¨æ€è½¬æ¢ä¸ºArrayæ•°ç»„"></a>ArrayListåŠ¨æ€è½¬æ¢ä¸ºArrayæ•°ç»„</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String [] array=list.toArray(<span class="keyword">new</span> <span class="title class_">String</span>[size]);</span><br></pre></td></tr></table></figure><p>é™¤æ­¤ä¹‹å¤–ï¼Œ<strong>ArrayList</strong>è¿˜æœ‰ä»¥ä¸‹çš„å¸¸ç”¨çš„æ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index, E element)</span> å°†æŒ‡å®šå…ƒç´ æ’å…¥æ­¤åˆ—è¡¨ä¸­çš„æŒ‡å®šä½ç½®ã€‚</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">add</span><span class="params">(E e)</span>å°†æŒ‡å®šçš„å…ƒç´ è¿½åŠ åˆ°æ­¤åˆ—è¡¨çš„æœ«å°¾ã€‚</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(Object o)</span>å¦‚æœæ­¤åˆ—è¡¨åŒ…å«æŒ‡å®šçš„å…ƒç´ ï¼Œåˆ™è¿”å› <span class="literal">true</span> ã€‚</span><br><span class="line">E <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span> è¿”å›æ­¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚</span><br><span class="line"><span class="type">int</span> <span class="title function_">indexOf</span><span class="params">(Object o)</span> è¿”å›æ­¤åˆ—è¡¨ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ çš„ç´¢å¼•ï¼Œå¦‚æœæ­¤åˆ—è¡¨ä¸åŒ…å«è¯¥å…ƒç´ ï¼Œåˆ™è¿”å›-<span class="number">1</span>ã€‚</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> å¦‚æœæ­¤åˆ—è¡¨ä¸åŒ…å«ä»»ä½•å…ƒç´ ï¼Œåˆ™è¿”å› <span class="literal">true</span> ã€‚</span><br><span class="line"><span class="type">int</span> <span class="title function_">lastIndexOf</span><span class="params">(Object o)</span>è¿”å›æ­¤åˆ—è¡¨ä¸­æŒ‡å®šå…ƒç´ æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œå¦‚æœæ­¤åˆ—è¡¨ä¸åŒ…å«è¯¥å…ƒç´ ï¼Œåˆ™è¿”å›-<span class="number">1</span>ã€‚</span><br><span class="line">E <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span> åˆ é™¤æ­¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">remove</span><span class="params">(Object o)</span>ä»è¯¥åˆ—è¡¨ä¸­åˆ é™¤æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ï¼ˆå¦‚æœå­˜åœ¨ï¼‰</span><br><span class="line">E <span class="title function_">set</span><span class="params">(<span class="type">int</span> index, E element)</span> ç”¨æŒ‡å®šçš„å…ƒç´ æ›¿æ¢æ­¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚</span><br><span class="line"><span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> è¿”å›æ­¤åˆ—è¡¨ä¸­çš„å…ƒç´ æ•°ã€‚</span><br></pre></td></tr></table></figure><h3 id="Arrayæ•°ç»„è½¬ä¸ºArrayList"><a href="#Arrayæ•°ç»„è½¬ä¸ºArrayList" class="headerlink" title="Arrayæ•°ç»„è½¬ä¸ºArrayList"></a>Arrayæ•°ç»„è½¬ä¸ºArrayList</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt;list= Arrays.asList(array)</span><br></pre></td></tr></table></figure><h3 id="Arraysçš„å¸¸ç”¨æ–¹æ³•"><a href="#Arraysçš„å¸¸ç”¨æ–¹æ³•" class="headerlink" title="Arraysçš„å¸¸ç”¨æ–¹æ³•"></a>Arraysçš„å¸¸ç”¨æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ›å»ºæ•°ç»„</span></span><br><span class="line"><span class="type">int</span> nums[]=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">100</span>];</span><br><span class="line"><span class="comment">//è·å–é•¿åº¦</span></span><br><span class="line">nums.length;</span><br><span class="line"></span><br><span class="line">Arrays.toString(nums)</span><br><span class="line">Arrays.sort(nums)<span class="comment">//å‡åº</span></span><br><span class="line">Arrays.fill(nums)<span class="comment">//åˆå§‹åŒ–æ•°ç»„çš„æ—¶å€™ä¼šç”¨åˆ°ï¼ˆæ¯”å¦‚å…¨éƒ¨ç»™-1ï¼‰</span></span><br><span class="line">Arrays.equal(nums)</span><br><span class="line">Arrays.copyof(nums)</span><br><span class="line">Arrays.compare(nums)</span><br><span class="line">Arrays.binarySearch(nums)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><code>Arrays.sort()</code>é‡å†™Comparator:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆå¹¶åŒºé—´çš„ä¾‹å­</span></span><br><span class="line">Arrays.sort(nums,<span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;<span class="type">int</span> []&gt;()&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(<span class="type">int</span>[]nums1, <span class="type">int</span>[]nums2)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> nums1[<span class="number">0</span>]-nums2[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h3 id="ArrayListçš„å¸¸ç”¨ç”¨æ³•"><a href="#ArrayListçš„å¸¸ç”¨ç”¨æ³•" class="headerlink" title="ArrayListçš„å¸¸ç”¨ç”¨æ³•"></a>ArrayListçš„å¸¸ç”¨ç”¨æ³•</h3><p>Arrayï¼šåªå¯å­˜å‚¨åŸºæœ¬æ•°æ®ç±»å‹å’Œå¯¹è±¡ã€‚è¢«è®¾ç½®ä¸º<strong>å›ºå®šå¤§å°</strong>ã€‚æ‰€åŒ…å«çš„æ–¹æ³•æ²¡æœ‰ArrayListå¤š<br>ArrayListï¼šåªèƒ½<strong>å­˜å‚¨å¯¹è±¡</strong>ã€‚æ˜¯ä¸€ä¸ª<strong>å¯å˜æ•°ç»„</strong>ï¼Œå¤§å°å¯è‡ªåŠ¨è°ƒæ•´ã€‚æœ‰å¾ˆå¤šæ“ä½œæ–¹æ³•ï¼š<a href="https://so.csdn.net/so/search?q=addAll&spm=1001.2101.3001.7020">addAll</a>ã€removeAllã€iterationç­‰ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ·»åŠ å…ƒç´ </span></span><br><span class="line"><span class="type">ArrayList</span> <span class="variable">list</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">list.add(<span class="string">&quot;è¿ªä¸½çƒ­å·´&quot;</span>);</span><br><span class="line">ArrayList&lt;String&gt; sites = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line">        sites.add(<span class="string">&quot;Google&quot;</span>);</span><br><span class="line">        sites.add(<span class="string">&quot;Runoob&quot;</span>);</span><br><span class="line">        sites.add(<span class="string">&quot;Taobao&quot;</span>);</span><br><span class="line">        sites.add(<span class="string">&quot;Weibo&quot;</span>);</span><br><span class="line">        sites.remove(<span class="number">3</span>); <span class="comment">// åˆ é™¤ç¬¬å››ä¸ªå…ƒç´ </span></span><br><span class="line"><span class="comment">//è®¡ç®—å¤§å°</span></span><br><span class="line">sites.size();</span><br><span class="line"><span class="comment">//æ’åº</span></span><br><span class="line">Collections.sort(sites);</span><br><span class="line"><span class="comment">//æ˜¯å¦åŒ…å«</span></span><br><span class="line">sites.contains();</span><br><span class="line"><span class="comment">//addAll()</span></span><br><span class="line">è¿™ä¸ªæ–¹æ³•æ‹¬å·ä¸­ç±»å‹æ˜¯listï¼Œæ‹¼æ¥</span><br><span class="line">    </span><br><span class="line"><span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index, E element)</span> å°†æŒ‡å®šå…ƒç´ æ’å…¥æ­¤åˆ—è¡¨ä¸­çš„æŒ‡å®šä½ç½®ã€‚</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">add</span><span class="params">(E e)</span>å°†æŒ‡å®šçš„å…ƒç´ è¿½åŠ åˆ°æ­¤åˆ—è¡¨çš„æœ«å°¾ã€‚</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(Object o)</span>å¦‚æœæ­¤åˆ—è¡¨åŒ…å«æŒ‡å®šçš„å…ƒç´ ï¼Œåˆ™è¿”å› <span class="literal">true</span> ã€‚</span><br><span class="line">E <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span> è¿”å›æ­¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚</span><br><span class="line"><span class="type">int</span> <span class="title function_">indexOf</span><span class="params">(Object o)</span> è¿”å›æ­¤åˆ—è¡¨ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ çš„ç´¢å¼•ï¼Œå¦‚æœæ­¤åˆ—è¡¨ä¸åŒ…å«è¯¥å…ƒç´ ï¼Œåˆ™è¿”å›-<span class="number">1</span>ã€‚</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> å¦‚æœæ­¤åˆ—è¡¨ä¸åŒ…å«ä»»ä½•å…ƒç´ ï¼Œåˆ™è¿”å› <span class="literal">true</span> ã€‚</span><br><span class="line"><span class="type">int</span> <span class="title function_">lastIndexOf</span><span class="params">(Object o)</span>è¿”å›æ­¤åˆ—è¡¨ä¸­æŒ‡å®šå…ƒç´ æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œå¦‚æœæ­¤åˆ—è¡¨ä¸åŒ…å«è¯¥å…ƒç´ ï¼Œåˆ™è¿”å›-<span class="number">1</span>ã€‚</span><br><span class="line">E <span class="title function_">remove</span><span class="params">(<span class="type">int</span> index)</span> åˆ é™¤æ­¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">remove</span><span class="params">(Object o)</span>ä»è¯¥åˆ—è¡¨ä¸­åˆ é™¤æŒ‡å®šå…ƒç´ çš„ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ï¼ˆå¦‚æœå­˜åœ¨ï¼‰</span><br><span class="line">E <span class="title function_">set</span><span class="params">(<span class="type">int</span> index, E element)</span> ç”¨æŒ‡å®šçš„å…ƒç´ æ›¿æ¢æ­¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚</span><br><span class="line"><span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> è¿”å›æ­¤åˆ—è¡¨ä¸­çš„å…ƒç´ æ•°ã€‚</span><br></pre></td></tr></table></figure><h3 id="Collectionsç±»"><a href="#Collectionsç±»" class="headerlink" title="Collectionsç±»"></a><strong>Collectionsç±»</strong></h3><p>å¯¹listè¿›è¡Œåè½¬</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Collections.reverse(list)</span><br></pre></td></tr></table></figure><h3 id="Stringç±»"><a href="#Stringç±»" class="headerlink" title="Stringç±»"></a>Stringç±»</h3><p>Stringè·å–é•¿åº¦æ˜¯.length()ï¼ˆè¦åŠ æ‹¬å·ï¼‰</p><p><a href="https://blog.csdn.net/weixin_62756510/article/details/124698100?ops_request_misc=%7B%22request_id%22:%22171013865416777224481954%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=171013865416777224481954&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-124698100-null-null.142%5Ev99%5Epc_search_result_base2&utm_term=stringbuilder&spm=1018.2226.3001.4187">Stringã€StringBuilderç±»è¶…è¯¦ç»†ç¬”è®°_stringbuilderå¯ä»¥ç”¨equalsignorecase-CSDNåšå®¢</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">é‡è¦ï¼š<span class="type">char</span> charAtâ€‹(<span class="type">int</span> index) è¿”å›æŒ‡å®šç´¢å¼•å¤„çš„ <span class="type">char</span>å€¼ã€‚</span><br><span class="line"><span class="type">int</span> indexOfâ€‹(String ch) è¿”å›æŒ‡å®šå­—ç¬¦ç¬¬ä¸€æ¬¡å‡ºç°çš„å­—ç¬¦ä¸²ä¸­çš„ç´¢å¼•ã€‚</span><br><span class="line">    <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> String.valueOf(<span class="string">&#x27;c&#x27;</span>); <span class="comment">//æ•ˆç‡æœ€é«˜çš„æ–¹æ³•</span></span><br><span class="line">- <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> ï¼Œå½“ä¸”ä»…å½“ï¼Œ length()æ˜¯ <span class="number">0</span> è¿”å› <span class="literal">true</span></span><br><span class="line"><span class="type">int</span> lastIndexOfâ€‹(<span class="type">int</span> ch) è¿”å›æŒ‡å®šå­—ç¬¦æœ€åä¸€æ¬¡å‡ºç°çš„å­—ç¬¦ä¸²ä¸­çš„ç´¢å¼•ã€‚</span><br><span class="line"><span class="type">int</span> <span class="title function_">length</span><span class="params">()</span> è¿”å›æ­¤å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚</span><br><span class="line">    String <span class="title function_">trim</span><span class="params">()</span> å»é™¤ä¸¤ç«¯çš„ç©ºæ ¼</span><br><span class="line">String replaceâ€‹(CharSequence target, CharSequence replacement) å°†æ­¤å­—ç¬¦ä¸²ä¸­ä¸æ–‡å­—ç›®æ ‡åºåˆ—åŒ¹é…çš„æ¯ä¸ªå­å­—ç¬¦ä¸²æ›¿æ¢ä¸ºæŒ‡å®šçš„æ–‡å­—æ›¿æ¢åºåˆ—ã€‚</span><br><span class="line">String replaceAllâ€‹(String regex, String replacement) å°†ç»™å®šæ›¿æ¢çš„ç»™å®š regular expressionåŒ¹é…çš„æ­¤å­—ç¬¦ä¸²çš„æ¯ä¸ªå­å­—ç¬¦ä¸²æ›¿æ¢ã€‚</span><br><span class="line">String[] splitâ€‹(String regex) <span class="comment">//å°†æ­¤å­—ç¬¦ä¸²æ‹†åˆ†ä¸ºç»™å®š regular expressionçš„åŒ¹é… é¡¹ ã€‚ï¼ˆå¦‚æœæœ‰å¤šä¸ªç©ºæ ¼ï¼Œåˆ™ä¼šåœ¨Arraysä¸­æœ‰ç©ºçš„&quot;&quot;å‡ºç°ï¼‰</span></span><br><span class="line"><span class="type">boolean</span> startsWithâ€‹(String prefix) æµ‹è¯•æ­¤å­—ç¬¦ä¸²æ˜¯å¦ä»¥æŒ‡å®šçš„å‰ç¼€å¼€å¤´ã€‚</span><br><span class="line">String substringâ€‹(<span class="type">int</span> beginIndex) è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²æ˜¯æ­¤å­—ç¬¦ä¸²çš„å­å­—ç¬¦ä¸²ã€‚</span><br><span class="line"><span class="type">char</span>[] toCharArray() å°†æ­¤å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ–°çš„å­—ç¬¦æ•°ç»„ã€‚</span><br><span class="line">String <span class="title function_">toLowerCase</span><span class="params">()</span> ä½¿ç”¨é»˜è®¤è¯­è¨€ç¯å¢ƒçš„è§„åˆ™å°†æ­¤ Stringæ‰€æœ‰å­—ç¬¦è½¬æ¢ä¸ºå°å†™ã€‚</span><br><span class="line">String <span class="title function_">toUpperCase</span><span class="params">()</span> ä½¿ç”¨é»˜è®¤è¯­è¨€ç¯å¢ƒçš„è§„åˆ™å°†æ­¤ Stringæ‰€æœ‰å­—ç¬¦è½¬æ¢ä¸ºå¤§å†™ã€‚</span><br><span class="line">æ¯”è¾ƒå¤§å°çš„è¯</span><br><span class="line">    String c= <span class="string">&quot;123&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">b</span> <span class="operator">=</span> <span class="string">&quot;123&quot;</span>;</span><br><span class="line">c.compareTo(b);</span><br><span class="line">æˆ–è€…</span><br><span class="line">    c.equals(b);</span><br></pre></td></tr></table></figure><h3 id="å­—ç¬¦ç±»Chracter"><a href="#å­—ç¬¦ç±»Chracter" class="headerlink" title="å­—ç¬¦ç±»Chracter"></a>å­—ç¬¦ç±»Chracter</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//charè½¬Character</span></span><br><span class="line">Character.valueOf(<span class="string">&#x27;I&#x27;</span>);</span><br><span class="line">Character.compare(<span class="type">char</span> x, <span class="type">char</span> y) ä»¥æ•°å­—æ–¹å¼æ¯”è¾ƒä¸¤ä¸ª <span class="type">char</span>å€¼ã€‚</span><br><span class="line">Character.equals(Object obj) å°†æ­¤å¯¹è±¡ä¸æŒ‡å®šçš„å¯¹è±¡è¿›è¡Œæ¯”è¾ƒã€‚</span><br><span class="line">Character.isDigit(<span class="type">char</span> ch) ç¡®å®šæŒ‡å®šçš„å­—ç¬¦æ˜¯å¦ä¸ºæ•°å­—ã€‚</span><br><span class="line">Character.isLetter(<span class="type">char</span> ch) ç¡®å®šæŒ‡å®šçš„å­—ç¬¦æ˜¯å¦ä¸ºå­—æ¯ã€‚</span><br><span class="line">Character.isLowerCase(<span class="type">char</span> ch) ç¡®å®šæŒ‡å®šçš„å­—ç¬¦æ˜¯å¦ä¸ºå°å†™å­—ç¬¦ã€‚</span><br><span class="line">Character.isUpperCase(<span class="type">char</span> ch) ç¡®å®šæŒ‡å®šçš„å­—ç¬¦æ˜¯å¦ä¸ºå¤§å†™å­—ç¬¦ã€‚</span><br><span class="line">Character.toString(<span class="type">char</span> c) è¿”å›è¡¨ç¤ºæŒ‡å®šçš„ <span class="type">char</span>çš„ Stringå¯¹è±¡ã€‚</span><br><span class="line">Character.valueOf(<span class="type">char</span> c) è¿”å›è¡¨ç¤ºæŒ‡å®šçš„ <span class="type">char</span>å€¼çš„ Characterå®ä¾‹ã€‚</span><br><span class="line">Character.toLowerCase(<span class="string">&quot;A&quot;</span>); è½¬ä¸ºå°å†™</span><br><span class="line">Character.toUpperCase(<span class="string">&quot;a&quot;</span>); è½¬ä¸ºå¤§å†™</span><br><span class="line"><span class="comment">//charæ•°ç»„è½¬String</span></span><br><span class="line"><span class="type">char</span>[] data = <span class="keyword">new</span> <span class="title class_">char</span>[] &#123;<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>&#125;;</span><br><span class="line"><span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(data);</span><br><span class="line">System.out.println(str);  <span class="comment">//è¾“å‡ºabc</span></span><br></pre></td></tr></table></figure><h3 id="å­—ç¬¦ä¸²æ„é€ å™¨StringBuilder"><a href="#å­—ç¬¦ä¸²æ„é€ å™¨StringBuilder" class="headerlink" title="å­—ç¬¦ä¸²æ„é€ å™¨StringBuilder"></a>å­—ç¬¦ä¸²æ„é€ å™¨StringBuilder</h3><p><a href="https://blog.csdn.net/qq_46634307/article/details/126283200?ops_request_misc=%7B%22request_id%22:%22171014028016800192229813%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=171014028016800192229813&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-1-126283200-null-null.142%5Ev99%5Epc_search_result_base2&utm_term=stringbuilder%E4%BF%AE%E6%94%B9%E6%8C%87%E5%AE%9A%E4%BD%8D%E7%BD%AE%E7%9A%84%E5%AD%97%E7%AC%A6&spm=1018.2226.3001.4187">Java-ä¿®æ”¹ String æŒ‡å®šä½ç½®çš„å­—ç¬¦æœ€å…¨æ–¹æ³•æ€»ç»“ï¼ˆStringBuilder å’Œ StringBuffer çš„ä½¿ç”¨ä»¥åŠåŒºåˆ«ï¼‰_stringæ›¿æ¢æŒ‡å®šä½ç½®å­—ç¬¦-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/itchuxuezhe_yang/article/details/89966303?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromBaidu~Rate-1-89966303-blog-124698100.235%5Ev43%5Epc_blog_bottom_relevance_base1&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromBaidu~Rate-1-89966303-blog-124698100.235%5Ev43%5Epc_blog_bottom_relevance_base1&utm_relevant_index=1">Stringã€StringBufferä¸StringBuilderä¹‹é—´åŒºåˆ«_string stringbuffer stringbuilderåŒºåˆ«-CSDNåšå®¢</a></p><p>å¯å˜å­—ç¬¦ä¸²ï¼ŒStringBuilderå¯¹è±¡çš„å†…å®¹å¯ä»¥ä¿®æ”¹ã€‚</p><ol><li><p>StringBuilderç±»çš„å¸¸ç”¨æ–¹æ³•</p><ol><li><p>append()æ–¹æ³•<br>ä½¿ç”¨append()æ–¹æ³•å¯å®ç°å­—ç¬¦ä¸²çš„æ‹¼æ¥æ“ä½œï¼Œè¿”å›æ‹¼æ¥åçš„StringBuilderå¯¹è±¡ã€‚</p></li><li><p>reverse()æ–¹æ³•<br>ä½¿ç”¨reverse()æ–¹æ³•å¯å®ç°StringBuilderå­—ç¬¦ä¸²çš„åè½¬æ“ä½œã€‚</p></li><li><p>delete(int start, int end)æ–¹æ³•<br>åˆ é™¤å­—ç¬¦ä¸²ä¸­æŒ‡å®šç´¢å¼•èŒƒå›´ä¸º [start,end) çš„æ‰€æœ‰å†…å®¹ã€‚</p><p>Javaä¸­å¤§å¤šæ•°èŒƒå›´å‡ä¸ºå·¦é—­å³å¼€åŒºé—´ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">sb.append(<span class="string">&quot;world&quot;</span>);</span><br><span class="line">sb.delete(<span class="number">5</span>,<span class="number">8</span>);  <span class="comment">//åˆ é™¤ç´¢å¼•èŒƒå›´ä¸º[5,8)å†…çš„æ‰€æœ‰å†…å®¹ï¼Œå³ä»wå¼€å§‹åˆ é™¤åˆ°lä¹‹å‰</span></span><br><span class="line">System.out.println(sb);  <span class="comment">//è¾“å‡ºhellold</span></span><br></pre></td></tr></table></figure></li><li><p>insert(int start, ä»»æ„æ•°æ®ç±»å‹)æ–¹æ³•<br>åœ¨ç´¢å¼•startå¤„å¼€å§‹æ’å…¥ä»»æ„æ•°æ®ç±»å‹çš„å†…å®¹ã€‚æ’å…¥å†…å®¹çš„èµ·å§‹ç´¢å¼•æ˜¯startã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">StringBuilder</span> <span class="variable">sb1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">sb1.insert(<span class="number">2</span>,<span class="number">77</span>);</span><br><span class="line">System.out.println(sb1);  <span class="comment">//è¾“å‡ºhe77llo</span></span><br><span class="line">sb1.insert(<span class="number">3</span>,<span class="string">&quot;ooo&quot;</span>);</span><br><span class="line">System.out.println(sb1);  <span class="comment">//è¾“å‡ºhe7ooo7llo</span></span><br></pre></td></tr></table></figure></li><li><p>setCharAt(index,character)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sb.setCharAt(j,Character.toUpperCase(sb.charAt(j)));</span><br></pre></td></tr></table></figure></li></ol></li><li><p>StringBuilderä¸Stringçš„ç›¸äº’è½¬æ¢<br> 1ï¼‰Stringè½¬ä¸ºStringBuilder<br> â‘  æ„é€ æ–¹æ³•StringBuilder(String str)</p></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="string">&quot;hello&quot;</span>); </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>â‘¡ å­—ç¬¦ä¸²æ‹¼æ¥æ–¹æ³•append(String str)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">sb.append(<span class="string">&quot;123&quot;</span>);</span><br></pre></td></tr></table></figure><p>2ï¼‰StringBuilderè½¬ä¸ºString<br>é€šè¿‡StringBuilderå¯¹è±¡è°ƒç”¨toString()æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> sb.toString();</span><br><span class="line">Stringã€StringBuilderã€StringBufferçš„åŒºåˆ«</span><br><span class="line">Stringä¸ºä¸å¯å˜å­—ç¬¦ä¸²ç±»ï¼ŒStringBuilderã€StringBufferä¸ºå¯å˜å­—ç¬¦ä¸²ç±»ã€‚</span><br><span class="line">StringBuilderç±»æ€§èƒ½è¾ƒé«˜ï¼Œä½†å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜; StringBufferç±»çº¿ç¨‹å®‰å…¨ï¼Œä½†æ€§èƒ½è¾ƒå·®ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="åŒé“¾è¡¨LinkedList"><a href="#åŒé“¾è¡¨LinkedList" class="headerlink" title="åŒé“¾è¡¨LinkedList"></a>åŒé“¾è¡¨LinkedList</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">size</span><span class="params">()</span></span><br><span class="line"><span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(Object o)</span> <span class="comment">// åˆ¤æ–­é“¾è¡¨ä¸­æ˜¯å¦å­˜åœ¨å…ƒç´ o å¤æ‚åº¦O(N)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">addFirst</span><span class="params">(E e)</span></span><br><span class="line">E <span class="title function_">removeFirst</span><span class="params">()</span> <span class="comment">//åˆ é™¤ï¼Œè¿”å›çš„æ˜¯åˆ é™¤çš„å…ƒç´ </span></span><br><span class="line">E getFirst/Last()</span><br><span class="line"><span class="type">int</span> <span class="title function_">indexOf</span><span class="params">( E e)</span></span><br><span class="line">Collections.reverse(link); <span class="comment">// ç¿»è½¬é“¾è¡¨</span></span><br></pre></td></tr></table></figure><h3 id="å“ˆå¸Œè¡¨Hashmap"><a href="#å“ˆå¸Œè¡¨Hashmap" class="headerlink" title="å“ˆå¸Œè¡¨Hashmap"></a>å“ˆå¸Œè¡¨Hashmap</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="title function_">containsKey</span><span class="params">(Object key)</span>å¦‚æœè¿™ä¸ªæ˜ å°„åŒ…å«æŒ‡å®šé”®æ˜ å°„ï¼Œåˆ™è¿”å›<span class="literal">true</span></span><br><span class="line"><span class="type">boolean</span> <span class="title function_">containsValue</span><span class="params">(Object value)</span> å¦‚æœæ­¤æ˜ å°„å°†ä¸€ä¸ªæˆ–å¤šä¸ªé”®æ˜ å°„åˆ°æŒ‡å®šå€¼ï¼Œåˆ™è¿”å› <span class="literal">true</span> ã€‚</span><br><span class="line">V <span class="title function_">get</span><span class="params">(Object key)</span> è¿”å›æŒ‡å®šé”®æ˜ å°„åˆ°çš„å€¼ï¼Œå¦‚æœæ­¤æ˜ å°„ä¸åŒ…å«é”®çš„æ˜ å°„ï¼Œåˆ™è¿”å› <span class="literal">null</span> ã€‚</span><br><span class="line">V <span class="title function_">put</span><span class="params">(K key, V value)</span> å°†æŒ‡å®šçš„å€¼ä¸æ­¤æ˜ å°„ä¸­çš„æŒ‡å®šé”®ç›¸å…³è”ã€‚</span><br><span class="line">V <span class="title function_">remove</span><span class="params">(Object key)</span> ä»æ­¤æ˜ å°„ä¸­åˆ é™¤æŒ‡å®šé”®çš„æ˜ å°„ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚</span><br><span class="line"><span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> è¿”å›æ­¤æ˜ å°„ä¸­é”® - å€¼æ˜ å°„çš„æ•°é‡ã€‚</span><br><span class="line">Collection&lt;V&gt; <span class="title function_">values</span><span class="params">()</span> è¿”å›æ­¤æ˜ å°„ä¸­åŒ…å«çš„å€¼çš„Collectionè§†å›¾ã€‚</span><br><span class="line">Set&lt;K&gt; <span class="title function_">keySet</span><span class="params">()</span> è¿”å›æ­¤æ˜ å°„ä¸­åŒ…å«çš„é”®çš„Setè§†å›¾ã€‚</span><br><span class="line"><span class="keyword">default</span> V <span class="title function_">getOrDefault</span><span class="params">(Object key, V defaultValue)</span> è¿”å›æŒ‡å®šé”®æ˜ å°„åˆ°çš„å€¼ï¼Œå¦‚æœæ­¤æ˜ å°„ä¸åŒ…å«é”®çš„æ˜ å°„ï¼Œåˆ™è¿”å› defaultValue ã€‚è¿™ä¸ªæ–¹æ³•ç»§æ‰¿è‡ªMapæ¥å£</span><br><span class="line"><span class="keyword">default</span> V <span class="title function_">putIfAbsent</span><span class="params">(K key, V value)</span> å¦‚æœkeyå­˜åœ¨åˆ™ä»€ä¹ˆéƒ½ä¸åšï¼Œå¦åˆ™put()ï¼Œå¹¶ä¸”è¿”å›å½“å‰å€¼</span><br><span class="line">Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet() è¿”å›æ­¤æ˜ å°„ä¸­åŒ…å«çš„æ˜ å°„çš„Setè§†å›¾ã€‚</span><br><span class="line">    </span><br><span class="line"><span class="comment">/* åˆå§‹åŒ–å“ˆå¸Œè¡¨ */</span></span><br><span class="line">Map&lt;Integer, String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* æ·»åŠ æ“ä½œ */</span></span><br><span class="line"><span class="comment">// åœ¨å“ˆå¸Œè¡¨ä¸­æ·»åŠ é”®å€¼å¯¹ (key, value)</span></span><br><span class="line">map.put(<span class="number">12836</span>, <span class="string">&quot;å°å“ˆ&quot;</span>);   </span><br><span class="line">map.put(<span class="number">15937</span>, <span class="string">&quot;å°å•°&quot;</span>);   </span><br><span class="line">map.put(<span class="number">16750</span>, <span class="string">&quot;å°ç®—&quot;</span>);   </span><br><span class="line">map.put(<span class="number">13276</span>, <span class="string">&quot;å°æ³•&quot;</span>);</span><br><span class="line">map.put(<span class="number">10583</span>, <span class="string">&quot;å°é¸­&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* æŸ¥è¯¢æ“ä½œ */</span></span><br><span class="line"><span class="comment">// å‘å“ˆå¸Œè¡¨ä¸­è¾“å…¥é”® key ï¼Œå¾—åˆ°å€¼ value</span></span><br><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> map.get(<span class="number">15937</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* åˆ é™¤æ“ä½œ */</span></span><br><span class="line"><span class="comment">// åœ¨å“ˆå¸Œè¡¨ä¸­åˆ é™¤é”®å€¼å¯¹ (key, value)</span></span><br><span class="line">map.remove(<span class="number">10583</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* éå†å“ˆå¸Œè¡¨ */</span></span><br><span class="line"><span class="comment">// éå†é”®å€¼å¯¹ key-&gt;value</span></span><br><span class="line"><span class="keyword">for</span> (Map.Entry &lt;Integer, String&gt; kv: map.entrySet()) &#123;</span><br><span class="line">    System.out.println(kv.getKey() + <span class="string">&quot; -&gt; &quot;</span> + kv.getValue());</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å•ç‹¬éå†é”® key</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> key: map.keySet()) &#123;</span><br><span class="line">    System.out.println(key);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å•ç‹¬éå†å€¼ value</span></span><br><span class="line"><span class="keyword">for</span> (String val: map.values()) &#123;</span><br><span class="line">    System.out.println(val);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å“ˆå¸Œé›†åˆHashSet"><a href="#å“ˆå¸Œé›†åˆHashSet" class="headerlink" title="å“ˆå¸Œé›†åˆHashSet"></a>å“ˆå¸Œé›†åˆHashSet</h3><p>[ã€Java åŸºç¡€ç¯‡ã€‘Java Set è¯¦è§£-CSDNåšå®¢](<a href="https://blog.csdn.net/qq_21484461/article/details/131383848?ops_request_misc=%7B%22request_id%22:%22171015290416800180682690%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=171015290416800180682690&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-131383848-null-null.142%5Ev99%5Epc_search_result_base2&utm_term=Java">https://blog.csdn.net/qq_21484461/article/details/131383848?ops_request_misc=%7B%22request%5Fid%22%3A%22171015290416800180682690%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=171015290416800180682690&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-131383848-null-null.142^v99^pc_search_result_base2&amp;utm_term=Java</a> set&amp;spm&#x3D;1018.2226.3001.4187)</p><p>ä¸èƒ½ä¿è¯é›†åˆè¿­ä»£çš„é¡ºåº</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="title function_">add</span><span class="params">(E e)</span> å¦‚æœæŒ‡å®šçš„å…ƒç´ å°šä¸å­˜åœ¨ï¼Œåˆ™å°†å…¶æ·»åŠ åˆ°æ­¤é›†åˆä¸­ã€‚</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">remove</span><span class="params">(Object o)</span> å¦‚æœå­˜åœ¨ï¼Œåˆ™ä»è¯¥é›†åˆä¸­ç§»é™¤æŒ‡å®šçš„å…ƒç´ ã€‚</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">contains</span><span class="params">(Object o)</span> å¦‚æœæ­¤setåŒ…å«æŒ‡å®šçš„å…ƒç´ ï¼Œåˆ™è¿”å› <span class="literal">true</span> ã€‚</span><br></pre></td></tr></table></figure><h3 id="æ ˆ-Stack"><a href="#æ ˆ-Stack" class="headerlink" title="æ ˆ Stack"></a>æ ˆ Stack</h3><p>æ ˆï¼Œåè¿›å…ˆå‡º</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* åˆå§‹åŒ–æ ˆ */</span></span><br><span class="line">Stack&lt;Integer&gt; stack = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å…ƒç´ å…¥æ ˆ */</span></span><br><span class="line">stack.push(<span class="number">1</span>);</span><br><span class="line">stack.push(<span class="number">3</span>);</span><br><span class="line">stack.push(<span class="number">2</span>);</span><br><span class="line">stack.push(<span class="number">5</span>);</span><br><span class="line">stack.push(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* è®¿é—®æ ˆé¡¶å…ƒç´  */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">peek</span> <span class="operator">=</span> stack.peek();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å…ƒç´ å‡ºæ ˆ */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">pop</span> <span class="operator">=</span> stack.pop();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* è·å–æ ˆçš„é•¿åº¦ */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> stack.size();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* åˆ¤æ–­æ˜¯å¦ä¸ºç©º */</span></span><br><span class="line"><span class="type">boolean</span> <span class="variable">isEmpty</span> <span class="operator">=</span> stack.isEmpty();</span><br></pre></td></tr></table></figure><h3 id="é˜Ÿåˆ—Queueã€åŒç«¯é˜Ÿåˆ—Dequeï¼ˆéƒ½å¯ç”¨LinkedListæ¥å®ä¾‹åŒ–ï¼Œå› ä¸ºäºŒè€…éƒ½æ˜¯æ¥å£ï¼‰"><a href="#é˜Ÿåˆ—Queueã€åŒç«¯é˜Ÿåˆ—Dequeï¼ˆéƒ½å¯ç”¨LinkedListæ¥å®ä¾‹åŒ–ï¼Œå› ä¸ºäºŒè€…éƒ½æ˜¯æ¥å£ï¼‰" class="headerlink" title="é˜Ÿåˆ—Queueã€åŒç«¯é˜Ÿåˆ—Dequeï¼ˆéƒ½å¯ç”¨LinkedListæ¥å®ä¾‹åŒ–ï¼Œå› ä¸ºäºŒè€…éƒ½æ˜¯æ¥å£ï¼‰"></a>é˜Ÿåˆ—Queueã€åŒç«¯é˜Ÿåˆ—Dequeï¼ˆéƒ½å¯ç”¨LinkedListæ¥å®ä¾‹åŒ–ï¼Œå› ä¸ºäºŒè€…éƒ½æ˜¯æ¥å£ï¼‰</h3><p>é˜Ÿåˆ—ï¼Œå…ˆè¿›å…ˆå‡ºï¼ŒQueueå’ŒDequeéƒ½æ˜¯æ¥å£ï¼Œè€ŒLinkedListç±»ç»§æ‰¿äº†è¿™ä¸¤ä¸ªé˜Ÿåˆ—ï¼Œ<strong>å¯ä»¥æ˜¯ç”¨LinkedListæ¥å®ä¾‹åŒ–Queueæˆ–è€…Deque</strong>ï¼Œå¯ä»¥ä½œä¸ºå•å‘é˜Ÿåˆ—æˆ–è€…åŒå‘é˜Ÿåˆ—æ¥ä½¿ç”¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Queue</span> <span class="variable">q</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">add</span><span class="params">(<span class="type">int</span> index, E element)</span> å°†æŒ‡å®šå…ƒç´ æ’å…¥æ­¤åˆ—è¡¨ä¸­çš„æŒ‡å®šä½ç½®ã€‚</span><br><span class="line">E <span class="title function_">element</span><span class="params">()</span> æ£€ç´¢ä½†ä¸åˆ é™¤æ­¤åˆ—è¡¨çš„å¤´éƒ¨ï¼ˆç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰ã€‚</span><br><span class="line">E <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span> è¿”å›æ­¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚</span><br><span class="line"><span class="type">int</span> <span class="title function_">indexOf</span><span class="params">(Object o)</span> è¿”å›æ­¤åˆ—è¡¨ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„æŒ‡å®šå…ƒç´ çš„ç´¢å¼•ï¼Œå¦‚æœæ­¤åˆ—è¡¨ä¸åŒ…å«è¯¥å…ƒç´ ï¼Œåˆ™è¿”å›-<span class="number">1</span>ã€‚</span><br><span class="line"><span class="type">int</span> <span class="title function_">lastIndexOf</span><span class="params">(Object o)</span> è¿”å›æ­¤åˆ—è¡¨ä¸­æŒ‡å®šå…ƒç´ æœ€åä¸€æ¬¡å‡ºç°çš„ç´¢å¼•ï¼Œå¦‚æœæ­¤åˆ—è¡¨ä¸åŒ…å«è¯¥å…ƒç´ ï¼Œåˆ™è¿”å›-<span class="number">1</span>ã€‚</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">offer</span><span class="params">(E e)</span> å°†æŒ‡å®šçš„å…ƒç´ æ·»åŠ ä¸ºæ­¤åˆ—è¡¨çš„å°¾éƒ¨ï¼ˆæœ€åä¸€ä¸ªå…ƒç´ ï¼‰ã€‚</span><br><span class="line">E <span class="title function_">peek</span><span class="params">()</span> æ£€ç´¢ä½†ä¸åˆ é™¤æ­¤åˆ—è¡¨çš„å¤´éƒ¨ï¼ˆç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰</span><br><span class="line">E <span class="title function_">poll</span><span class="params">()</span> æ£€ç´¢å¹¶åˆ é™¤æ­¤åˆ—è¡¨çš„å¤´éƒ¨ï¼ˆç¬¬ä¸€ä¸ªå…ƒç´ ï¼‰ã€‚</span><br><span class="line">E <span class="title function_">set</span><span class="params">(<span class="type">int</span> index, E element)</span> ç”¨æŒ‡å®šçš„å…ƒç´ æ›¿æ¢æ­¤åˆ—è¡¨ä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚</span><br><span class="line"><span class="comment">/* ç¿»è½¬é˜Ÿåˆ— */</span></span><br><span class="line">Collections.reverse(queue) </span><br><span class="line"><span class="comment">/* è·å–é˜Ÿåˆ—çš„é•¿åº¦ */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> queue.size();</span><br><span class="line"><span class="comment">/* åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º */</span></span><br><span class="line"><span class="type">boolean</span> <span class="variable">isEmpty</span> <span class="operator">=</span> queue.isEmpty();</span><br></pre></td></tr></table></figure><p>åŒç«¯é˜Ÿåˆ—</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* åˆå§‹åŒ–åŒå‘é˜Ÿåˆ— */</span></span><br><span class="line">Deque&lt;Integer&gt; deque = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å…ƒç´ å…¥é˜Ÿ */</span></span><br><span class="line">deque.offerLast(<span class="number">2</span>);   <span class="comment">// æ·»åŠ è‡³é˜Ÿå°¾</span></span><br><span class="line">deque.offerLast(<span class="number">5</span>);</span><br><span class="line">deque.offerLast(<span class="number">4</span>);</span><br><span class="line">deque.offerFirst(<span class="number">3</span>);  <span class="comment">// æ·»åŠ è‡³é˜Ÿé¦–</span></span><br><span class="line">deque.offerFirst(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* è®¿é—®å…ƒç´  */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">peekFirst</span> <span class="operator">=</span> deque.peekFirst();  <span class="comment">// é˜Ÿé¦–å…ƒç´ </span></span><br><span class="line"><span class="type">int</span> <span class="variable">peekLast</span> <span class="operator">=</span> deque.peekLast();    <span class="comment">// é˜Ÿå°¾å…ƒç´ </span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* å…ƒç´ å‡ºé˜Ÿ */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">popFirst</span> <span class="operator">=</span> deque.pollFirst();  <span class="comment">// é˜Ÿé¦–å…ƒç´ å‡ºé˜Ÿ</span></span><br><span class="line"><span class="type">int</span> <span class="variable">popLast</span> <span class="operator">=</span> deque.pollLast();    <span class="comment">// é˜Ÿå°¾å…ƒç´ å‡ºé˜Ÿ</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* è·å–åŒå‘é˜Ÿåˆ—çš„é•¿åº¦ */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> deque.size();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* åˆ¤æ–­åŒå‘é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º */</span></span><br><span class="line"><span class="type">boolean</span> <span class="variable">isEmpty</span> <span class="operator">=</span> deque.isEmpty();</span><br></pre></td></tr></table></figure><p>â€¦</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">LinkedListå¯ä»¥ä½œä¸ºå †æ ˆä½¿ç”¨ï¼Œå¹¶ä¸”åœ¨ç±»ä¸­å®ç°äº†å¯¹åº”çš„æ–¹æ³•</span><br><span class="line">E <span class="title function_">pop</span><span class="params">()</span> å¼¹å‡ºæ­¤åˆ—è¡¨æ‰€ä»£è¡¨çš„å †æ ˆä¸­çš„å…ƒç´ ã€‚</span><br><span class="line"><span class="keyword">void</span> <span class="title function_">push</span><span class="params">(E e)</span> å°†å…ƒç´ æ¨é€åˆ°æ­¤åˆ—è¡¨æ‰€è¡¨ç¤ºçš„å †æ ˆä¸Šã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä¼˜å…ˆé˜Ÿåˆ—-ä½œä¸ºå †æ¥ç”¨"><a href="#ä¼˜å…ˆé˜Ÿåˆ—-ä½œä¸ºå †æ¥ç”¨" class="headerlink" title="ä¼˜å…ˆé˜Ÿåˆ—(ä½œä¸ºå †æ¥ç”¨)"></a>ä¼˜å…ˆé˜Ÿåˆ—(ä½œä¸ºå †æ¥ç”¨)</h3><p>é»˜è®¤å°é¡¶å †ï¼Œä½†å¦‚æœæ˜¯æ•°æ®ç»“æ„å°±è¿˜æ˜¯è¦é‡å†™comparator</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.PriorityQueue;</span><br><span class="line"></span><br><span class="line">PriorityQueue&lt;Integer&gt; minHeap = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;();</span><br><span class="line"><span class="comment">//è¯»</span></span><br><span class="line">minHeap.peek();</span><br><span class="line">minHeap.poll();(ä¼šå¼¹å‡º)</span><br><span class="line"><span class="comment">//æ·»åŠ </span></span><br><span class="line">minHeap.add();</span><br><span class="line">minHeap.offer();</span><br><span class="line"><span class="comment">//ä¼˜å…ˆé˜Ÿåˆ—è‡ªç„¶æ’åºç¤ºä¾‹</span></span><br><span class="line">Queue&lt;Integer&gt; integerPriorityQueue = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;(<span class="number">7</span>);<span class="comment">//å®¹é‡ä¸º7</span></span><br><span class="line"><span class="comment">//ä¼˜å…ˆé˜Ÿåˆ—ä½¿ç”¨ç¤ºä¾‹</span></span><br><span class="line">Queue&lt;Customer&gt; customerPriorityQueue = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;(idComparator);</span><br><span class="line"><span class="comment">//åŒ¿åComparatorå®ç°</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Comparator&lt;Customer&gt; idComparator = <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;Customer&gt;()&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Customer c1, Customer c2)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="type">int</span>) (c1.getId() - c2.getId());<span class="comment">//è¿™æ˜¯å°é¡¶å †ï¼Œåç€å†™å°±æ˜¯å¤§é¡¶å †</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="comment">//æˆ–è€…å®ç°Comparatoræ¥å£ä¹Ÿè¡Œ</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">idComparator</span> <span class="keyword">implements</span> <span class="title class_">Comparator</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(Customer c1, Customer c2)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="type">int</span>)(c1.getId()-c2.getId)());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* åˆå§‹åŒ–å † */</span></span><br><span class="line"><span class="comment">// åˆå§‹åŒ–å°é¡¶å †</span></span><br><span class="line">Queue&lt;Integer&gt; minHeap = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;();</span><br><span class="line"><span class="comment">// åˆå§‹åŒ–å¤§é¡¶å †ï¼ˆä½¿ç”¨ lambda è¡¨è¾¾å¼ä¿®æ”¹ Comparator å³å¯ï¼‰</span></span><br><span class="line">Queue&lt;Integer&gt; maxHeap = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;((a, b) -&gt; b - a);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å…ƒç´ å…¥å † */</span></span><br><span class="line">maxHeap.offer(<span class="number">1</span>);</span><br><span class="line">maxHeap.offer(<span class="number">3</span>);</span><br><span class="line">maxHeap.offer(<span class="number">2</span>);</span><br><span class="line">maxHeap.offer(<span class="number">5</span>);</span><br><span class="line">maxHeap.offer(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* è·å–å †é¡¶å…ƒç´  */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">peek</span> <span class="operator">=</span> maxHeap.peek(); <span class="comment">// 5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* å †é¡¶å…ƒç´ å‡ºå † */</span></span><br><span class="line"><span class="comment">// å‡ºå †å…ƒç´ ä¼šå½¢æˆä¸€ä¸ªä»å¤§åˆ°å°çš„åºåˆ—</span></span><br><span class="line">peek = maxHeap.poll(); <span class="comment">// 5</span></span><br><span class="line">peek = maxHeap.poll(); <span class="comment">// 4</span></span><br><span class="line">peek = maxHeap.poll(); <span class="comment">// 3</span></span><br><span class="line">peek = maxHeap.poll(); <span class="comment">// 2</span></span><br><span class="line">peek = maxHeap.poll(); <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* è·å–å †å¤§å° */</span></span><br><span class="line"><span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> maxHeap.size();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* åˆ¤æ–­å †æ˜¯å¦ä¸ºç©º */</span></span><br><span class="line"><span class="type">boolean</span> <span class="variable">isEmpty</span> <span class="operator">=</span> maxHeap.isEmpty();</span><br><span class="line"></span><br><span class="line"><span class="comment">/* è¾“å…¥åˆ—è¡¨å¹¶å»ºå † */</span></span><br><span class="line">minHeap = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;(Arrays.asList(<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">4</span>));</span><br></pre></td></tr></table></figure><h3 id="æ•°å­¦åº“"><a href="#æ•°å­¦åº“" class="headerlink" title="æ•°å­¦åº“"></a>æ•°å­¦åº“</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Math.ceil(<span class="number">3.3</span>); <span class="comment">//å‘ä¸Šå–æ•´</span></span><br><span class="line">Math.floor(<span class="number">3.3</span>); <span class="comment">//å‘ä¸‹å–æ•´</span></span><br><span class="line">Math.round(<span class="number">3.4</span>); <span class="comment">//å››èˆäº”å…¥</span></span><br><span class="line">Math.pow(<span class="number">3</span>,<span class="number">2</span>) <span class="comment">//å¹‚è¿ç®—</span></span><br><span class="line">Math.abs(-<span class="number">1</span>); <span class="comment">//ç»å¯¹å€¼ </span></span><br><span class="line">Math.max(<span class="number">9999</span>,<span class="number">10000</span>);</span><br><span class="line">Math.min(<span class="number">9999</span>,<span class="number">10000</span>);</span><br><span class="line">Math.ramdom(); <span class="comment">//è¿”å›0-1çš„éšæœºæ•°ï¼Œå·¦é—­å³å¼€</span></span><br><span class="line">Math.sqrt(<span class="number">3.644</span>); <span class="comment">//å¼€æ–¹</span></span><br></pre></td></tr></table></figure><h1 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h1><h2 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MergeSort</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">mergeSort</span><span class="params">(<span class="type">int</span>[]arr, <span class="type">int</span> l, <span class="type">int</span> r)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l&gt;=r)<span class="keyword">return</span> ;</span><br><span class="line">        <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> l+(r-l)/<span class="number">2</span>;</span><br><span class="line">        mergeSort(arr,l,mid);</span><br><span class="line">        mergeSort(arr,mid+<span class="number">1</span>,r);</span><br><span class="line">        merge(arr,l,mid,r);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">merge</span><span class="params">(<span class="type">int</span>[] arr, <span class="type">int</span> l ,<span class="type">int</span> mid,<span class="type">int</span> r)</span>&#123;</span><br><span class="line">        <span class="type">int</span> temp[] = <span class="keyword">new</span> <span class="title class_">int</span>[r-l+<span class="number">1</span>];</span><br><span class="line">        <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> l;</span><br><span class="line">        <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> mid+<span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(left&lt;=mid&amp;&amp; right&lt;=r)&#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[left]&lt;arr[right])&#123;</span><br><span class="line">                temp[start++] = arr[left++];</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                temp[start++] = arr[right++];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(left&lt;=mid)&#123;</span><br><span class="line">            temp[start++] = arr[left++];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(right&lt;=r)&#123;</span><br><span class="line">            temp[start++] = arr[right++];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;temp.length;i++)&#123;</span><br><span class="line">                arr[l+i] = temp[i];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        <span class="type">int</span> nums[] = <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;</span><br><span class="line">            <span class="number">1</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">7</span></span><br><span class="line">        &#125;;</span><br><span class="line">        mergeSort(nums,<span class="number">0</span>,nums.length-<span class="number">1</span>);</span><br><span class="line">        System</span><br><span class="line">        .out.println(Arrays.toString(nums));</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å›¾"><a href="#å›¾" class="headerlink" title="å›¾"></a>å›¾</h2><p>é‚»æ¥çŸ©é˜µ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* åŸºäºé‚»æ¥çŸ©é˜µå®ç°çš„æ— å‘å›¾ç±» */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GraphAdjMat</span> &#123;</span><br><span class="line">    List&lt;Integer&gt; vertices; <span class="comment">// é¡¶ç‚¹åˆ—è¡¨ï¼Œå…ƒç´ ä»£è¡¨â€œé¡¶ç‚¹å€¼â€ï¼Œç´¢å¼•ä»£è¡¨â€œé¡¶ç‚¹ç´¢å¼•â€</span></span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; adjMat; <span class="comment">// é‚»æ¥çŸ©é˜µï¼Œè¡Œåˆ—ç´¢å¼•å¯¹åº”â€œé¡¶ç‚¹ç´¢å¼•â€</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æ„é€ æ–¹æ³• */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">GraphAdjMat</span><span class="params">(<span class="type">int</span>[] vertices, <span class="type">int</span>[][] edges)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.vertices = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="built_in">this</span>.adjMat = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// æ·»åŠ é¡¶ç‚¹</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> val : vertices) &#123;</span><br><span class="line">            addVertex(val);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ·»åŠ è¾¹</span></span><br><span class="line">        <span class="comment">// è¯·æ³¨æ„ï¼Œedges å…ƒç´ ä»£è¡¨é¡¶ç‚¹ç´¢å¼•ï¼Œå³å¯¹åº” vertices å…ƒç´ ç´¢å¼•</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span>[] e : edges) &#123;</span><br><span class="line">            addEdge(e[<span class="number">0</span>], e[<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* è·å–é¡¶ç‚¹æ•°é‡ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> vertices.size();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æ·»åŠ é¡¶ç‚¹ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addVertex</span><span class="params">(<span class="type">int</span> val)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> size();</span><br><span class="line">        <span class="comment">// å‘é¡¶ç‚¹åˆ—è¡¨ä¸­æ·»åŠ æ–°é¡¶ç‚¹çš„å€¼</span></span><br><span class="line">        vertices.add(val);</span><br><span class="line">        <span class="comment">// åœ¨é‚»æ¥çŸ©é˜µä¸­æ·»åŠ ä¸€è¡Œ</span></span><br><span class="line">        List&lt;Integer&gt; newRow = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">            newRow.add(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        adjMat.add(newRow);</span><br><span class="line">        <span class="comment">// åœ¨é‚»æ¥çŸ©é˜µä¸­æ·»åŠ ä¸€åˆ—</span></span><br><span class="line">        <span class="keyword">for</span> (List&lt;Integer&gt; row : adjMat) &#123;</span><br><span class="line">            row.add(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* åˆ é™¤é¡¶ç‚¹ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeVertex</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (index &gt;= size())</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IndexOutOfBoundsException</span>();</span><br><span class="line">        <span class="comment">// åœ¨é¡¶ç‚¹åˆ—è¡¨ä¸­ç§»é™¤ç´¢å¼• index çš„é¡¶ç‚¹</span></span><br><span class="line">        vertices.remove(index);</span><br><span class="line">        <span class="comment">// åœ¨é‚»æ¥çŸ©é˜µä¸­åˆ é™¤ç´¢å¼• index çš„è¡Œ</span></span><br><span class="line">        adjMat.remove(index);</span><br><span class="line">        <span class="comment">// åœ¨é‚»æ¥çŸ©é˜µä¸­åˆ é™¤ç´¢å¼• index çš„åˆ—</span></span><br><span class="line">        <span class="keyword">for</span> (List&lt;Integer&gt; row : adjMat) &#123;</span><br><span class="line">            row.remove(index);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æ·»åŠ è¾¹ */</span></span><br><span class="line">    <span class="comment">// å‚æ•° i, j å¯¹åº” vertices å…ƒç´ ç´¢å¼•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addEdge</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span> &#123;</span><br><span class="line">        <span class="comment">// ç´¢å¼•è¶Šç•Œä¸ç›¸ç­‰å¤„ç†</span></span><br><span class="line">        <span class="keyword">if</span> (i &lt; <span class="number">0</span> || j &lt; <span class="number">0</span> || i &gt;= size() || j &gt;= size() || i == j)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IndexOutOfBoundsException</span>();</span><br><span class="line">        <span class="comment">// åœ¨æ— å‘å›¾ä¸­ï¼Œé‚»æ¥çŸ©é˜µå…³äºä¸»å¯¹è§’çº¿å¯¹ç§°ï¼Œå³æ»¡è¶³ (i, j) == (j, i)</span></span><br><span class="line">        adjMat.get(i).set(j, <span class="number">1</span>);</span><br><span class="line">        adjMat.get(j).set(i, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* åˆ é™¤è¾¹ */</span></span><br><span class="line">    <span class="comment">// å‚æ•° i, j å¯¹åº” vertices å…ƒç´ ç´¢å¼•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">removeEdge</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j)</span> &#123;</span><br><span class="line">        <span class="comment">// ç´¢å¼•è¶Šç•Œä¸ç›¸ç­‰å¤„ç†</span></span><br><span class="line">        <span class="keyword">if</span> (i &lt; <span class="number">0</span> || j &lt; <span class="number">0</span> || i &gt;= size() || j &gt;= size() || i == j)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IndexOutOfBoundsException</span>();</span><br><span class="line">        adjMat.get(i).set(j, <span class="number">0</span>);</span><br><span class="line">        adjMat.get(j).set(i, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* æ‰“å°é‚»æ¥çŸ©é˜µ */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.print(<span class="string">&quot;é¡¶ç‚¹åˆ—è¡¨ = &quot;</span>);</span><br><span class="line">        System.out.println(vertices);</span><br><span class="line">        System.out.println(<span class="string">&quot;é‚»æ¥çŸ©é˜µ =&quot;</span>);</span><br><span class="line">        PrintUtil.printMatrix(adjMat);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚»æ¥è¡¨çš„BFS</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å¹¿åº¦ä¼˜å…ˆéå† */</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨é‚»æ¥è¡¨æ¥è¡¨ç¤ºå›¾ï¼Œä»¥ä¾¿è·å–æŒ‡å®šé¡¶ç‚¹çš„æ‰€æœ‰é‚»æ¥é¡¶ç‚¹</span></span><br><span class="line">List&lt;Vertex&gt; <span class="title function_">graphBFS</span><span class="params">(GraphAdjList graph, Vertex startVet)</span> &#123;</span><br><span class="line">    <span class="comment">// é¡¶ç‚¹éå†åºåˆ—</span></span><br><span class="line">    List&lt;Vertex&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">// å“ˆå¸Œè¡¨ï¼Œç”¨äºè®°å½•å·²è¢«è®¿é—®è¿‡çš„é¡¶ç‚¹</span></span><br><span class="line">    Set&lt;Vertex&gt; visited = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">    visited.add(startVet);</span><br><span class="line">    <span class="comment">// é˜Ÿåˆ—ç”¨äºå®ç° BFS</span></span><br><span class="line">    Queue&lt;Vertex&gt; que = <span class="keyword">new</span> <span class="title class_">LinkedList</span>&lt;&gt;();</span><br><span class="line">    que.offer(startVet);</span><br><span class="line">    <span class="comment">// ä»¥é¡¶ç‚¹ vet ä¸ºèµ·ç‚¹ï¼Œå¾ªç¯ç›´è‡³è®¿é—®å®Œæ‰€æœ‰é¡¶ç‚¹</span></span><br><span class="line">    <span class="keyword">while</span> (!que.isEmpty()) &#123;</span><br><span class="line">        <span class="type">Vertex</span> <span class="variable">vet</span> <span class="operator">=</span> que.poll(); <span class="comment">// é˜Ÿé¦–é¡¶ç‚¹å‡ºé˜Ÿ</span></span><br><span class="line">        res.add(vet);            <span class="comment">// è®°å½•è®¿é—®é¡¶ç‚¹</span></span><br><span class="line">        <span class="comment">// éå†è¯¥é¡¶ç‚¹çš„æ‰€æœ‰é‚»æ¥é¡¶ç‚¹</span></span><br><span class="line">        <span class="keyword">for</span> (Vertex adjVet : graph.adjList.get(vet)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (visited.contains(adjVet))</span><br><span class="line">                <span class="keyword">continue</span>;        <span class="comment">// è·³è¿‡å·²è¢«è®¿é—®çš„é¡¶ç‚¹</span></span><br><span class="line">            que.offer(adjVet);   <span class="comment">// åªå…¥é˜Ÿæœªè®¿é—®çš„é¡¶ç‚¹</span></span><br><span class="line">            visited.add(adjVet); <span class="comment">// æ ‡è®°è¯¥é¡¶ç‚¹å·²è¢«è®¿é—®</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è¿”å›é¡¶ç‚¹éå†åºåˆ—</span></span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‚»æ¥è¡¨çš„DFS</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* æ·±åº¦ä¼˜å…ˆéå†è¾…åŠ©å‡½æ•° */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">dfs</span><span class="params">(GraphAdjList graph, Set&lt;Vertex&gt; visited, List&lt;Vertex&gt; res, Vertex vet)</span> &#123;</span><br><span class="line">    res.add(vet);     <span class="comment">// è®°å½•è®¿é—®é¡¶ç‚¹</span></span><br><span class="line">    visited.add(vet); <span class="comment">// æ ‡è®°è¯¥é¡¶ç‚¹å·²è¢«è®¿é—®</span></span><br><span class="line">    <span class="comment">// éå†è¯¥é¡¶ç‚¹çš„æ‰€æœ‰é‚»æ¥é¡¶ç‚¹</span></span><br><span class="line">    <span class="keyword">for</span> (Vertex adjVet : graph.adjList.get(vet)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (visited.contains(adjVet))</span><br><span class="line">            <span class="keyword">continue</span>; <span class="comment">// è·³è¿‡å·²è¢«è®¿é—®çš„é¡¶ç‚¹</span></span><br><span class="line">        <span class="comment">// é€’å½’è®¿é—®é‚»æ¥é¡¶ç‚¹</span></span><br><span class="line">        dfs(graph, visited, res, adjVet);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* æ·±åº¦ä¼˜å…ˆéå† */</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨é‚»æ¥è¡¨æ¥è¡¨ç¤ºå›¾ï¼Œä»¥ä¾¿è·å–æŒ‡å®šé¡¶ç‚¹çš„æ‰€æœ‰é‚»æ¥é¡¶ç‚¹</span></span><br><span class="line">List&lt;Vertex&gt; <span class="title function_">graphDFS</span><span class="params">(GraphAdjList graph, Vertex startVet)</span> &#123;</span><br><span class="line">    <span class="comment">// é¡¶ç‚¹éå†åºåˆ—</span></span><br><span class="line">    List&lt;Vertex&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">// å“ˆå¸Œè¡¨ï¼Œç”¨äºè®°å½•å·²è¢«è®¿é—®è¿‡çš„é¡¶ç‚¹</span></span><br><span class="line">    Set&lt;Vertex&gt; visited = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">    dfs(graph, visited, res, startVet);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Floyd"><a href="#Floyd" class="headerlink" title="Floyd"></a>Floyd</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MatrixUDG</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> mEdgNum;        <span class="comment">// è¾¹çš„æ•°é‡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">char</span>[] mVexs;       <span class="comment">// é¡¶ç‚¹é›†åˆ</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span>[][] mMatrix;    <span class="comment">// é‚»æ¥çŸ©é˜µ</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">INF</span> <span class="operator">=</span> Integer.MAX_VALUE;   <span class="comment">// æœ€å¤§å€¼</span></span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * floydæœ€çŸ­è·¯å¾„ã€‚</span></span><br><span class="line"><span class="comment"> * å³ï¼Œç»Ÿè®¡å›¾ä¸­å„ä¸ªé¡¶ç‚¹é—´çš„æœ€çŸ­è·¯å¾„ã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * å‚æ•°è¯´æ˜ï¼š</span></span><br><span class="line"><span class="comment"> *     path -- è·¯å¾„ã€‚path[i][j]=kè¡¨ç¤ºï¼Œ&quot;é¡¶ç‚¹i&quot;åˆ°&quot;é¡¶ç‚¹j&quot;çš„æœ€çŸ­è·¯å¾„ä¼šç»è¿‡é¡¶ç‚¹kã€‚</span></span><br><span class="line"><span class="comment"> *     dist -- é•¿åº¦æ•°ç»„ã€‚å³ï¼Œdist[i][j]=sumè¡¨ç¤ºï¼Œ&quot;é¡¶ç‚¹i&quot;åˆ°&quot;é¡¶ç‚¹j&quot;çš„æœ€çŸ­è·¯å¾„çš„é•¿åº¦æ˜¯sumã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">floyd</span><span class="params">(<span class="type">int</span>[][] path, <span class="type">int</span>[][] dist)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; mVexs.length; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; mVexs.length; j++) &#123;</span><br><span class="line">            dist[i][j] = mMatrix[i][j];    <span class="comment">// &quot;é¡¶ç‚¹i&quot;åˆ°&quot;é¡¶ç‚¹j&quot;çš„è·¯å¾„é•¿åº¦ä¸º&quot;iåˆ°jçš„æƒå€¼&quot;ã€‚</span></span><br><span class="line">            path[i][j] = j;                <span class="comment">// &quot;é¡¶ç‚¹i&quot;åˆ°&quot;é¡¶ç‚¹j&quot;çš„æœ€çŸ­è·¯å¾„æ˜¯ç»è¿‡é¡¶ç‚¹jã€‚</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®¡ç®—æœ€çŸ­è·¯å¾„</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>; k &lt; mVexs.length; k++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; mVexs.length; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; mVexs.length; j++) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// å¦‚æœç»è¿‡ä¸‹æ ‡ä¸ºké¡¶ç‚¹è·¯å¾„æ¯”åŸä¸¤ç‚¹é—´è·¯å¾„æ›´çŸ­ï¼Œåˆ™æ›´æ–°dist[i][j]å’Œpath[i][j]</span></span><br><span class="line">                <span class="type">int</span> <span class="variable">tmp</span> <span class="operator">=</span> (dist[i][k]==INF || dist[k][j]==INF) ? INF : (dist[i][k] + dist[k][j]);</span><br><span class="line">                <span class="keyword">if</span> (dist[i][j] &gt; tmp) &#123;</span><br><span class="line">                    <span class="comment">// &quot;iåˆ°jæœ€çŸ­è·¯å¾„&quot;å¯¹åº”çš„å€¼è®¾ï¼Œä¸ºæ›´å°çš„ä¸€ä¸ª(å³ç»è¿‡k)</span></span><br><span class="line">                    dist[i][j] = tmp;</span><br><span class="line">                    <span class="comment">// &quot;iåˆ°jæœ€çŸ­è·¯å¾„&quot;å¯¹åº”çš„è·¯å¾„ï¼Œç»è¿‡k</span></span><br><span class="line">                    path[i][j] = path[i][k];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ‰“å°floydæœ€çŸ­è·¯å¾„çš„ç»“æœ</span></span><br><span class="line">    System.out.printf(<span class="string">&quot;floyd: \n&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; mVexs.length; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; mVexs.length; j++)</span><br><span class="line">            System.out.printf(<span class="string">&quot;%2d  &quot;</span>, dist[i][j]);</span><br><span class="line">        System.out.printf(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="è¿ªæ°æ–¯ç‰¹æ‹‰"><a href="#è¿ªæ°æ–¯ç‰¹æ‹‰" class="headerlink" title="è¿ªæ°æ–¯ç‰¹æ‹‰"></a>è¿ªæ°æ–¯ç‰¹æ‹‰</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MatrixUDG</span> &#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> mEdgNum;        <span class="comment">// è¾¹çš„æ•°é‡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">char</span>[] mVexs;       <span class="comment">// é¡¶ç‚¹é›†åˆ</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span>[][] mMatrix;    <span class="comment">// é‚»æ¥çŸ©é˜µ</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">INF</span> <span class="operator">=</span> Integer.MAX_VALUE;   <span class="comment">// æœ€å¤§å€¼</span></span><br><span class="line"> </span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Dijkstraæœ€çŸ­è·¯å¾„ã€‚</span></span><br><span class="line"><span class="comment"> * å³ï¼Œç»Ÿè®¡å›¾ä¸­&quot;é¡¶ç‚¹vs&quot;åˆ°å…¶å®ƒå„ä¸ªé¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * å‚æ•°è¯´æ˜ï¼š</span></span><br><span class="line"><span class="comment"> *       vs -- èµ·å§‹é¡¶ç‚¹(start vertex)ã€‚å³è®¡ç®—&quot;é¡¶ç‚¹vs&quot;åˆ°å…¶å®ƒé¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚</span></span><br><span class="line"><span class="comment"> *     prev -- å‰é©±é¡¶ç‚¹æ•°ç»„ã€‚å³ï¼Œprev[i]çš„å€¼æ˜¯&quot;é¡¶ç‚¹vs&quot;åˆ°&quot;é¡¶ç‚¹i&quot;çš„æœ€çŸ­è·¯å¾„æ‰€ç»å†çš„å…¨éƒ¨é¡¶ç‚¹ä¸­ï¼Œä½äº&quot;é¡¶ç‚¹i&quot;ä¹‹å‰çš„é‚£ä¸ªé¡¶ç‚¹ã€‚</span></span><br><span class="line"><span class="comment"> *     dist -- é•¿åº¦æ•°ç»„ã€‚å³ï¼Œdist[i]æ˜¯&quot;é¡¶ç‚¹vs&quot;åˆ°&quot;é¡¶ç‚¹i&quot;çš„æœ€çŸ­è·¯å¾„çš„é•¿åº¦ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">dijkstra</span><span class="params">(<span class="type">int</span> vs, <span class="type">int</span>[] prev, <span class="type">int</span>[] dist)</span> &#123;</span><br><span class="line">    <span class="comment">// flag[i]=trueè¡¨ç¤º&quot;é¡¶ç‚¹vs&quot;åˆ°&quot;é¡¶ç‚¹i&quot;çš„æœ€çŸ­è·¯å¾„å·²æˆåŠŸè·å–</span></span><br><span class="line">    <span class="type">boolean</span>[] flag = <span class="keyword">new</span> <span class="title class_">boolean</span>[mVexs.length];</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; mVexs.length; i++) &#123;</span><br><span class="line">        flag[i] = <span class="literal">false</span>;          <span class="comment">// é¡¶ç‚¹içš„æœ€çŸ­è·¯å¾„è¿˜æ²¡è·å–åˆ°ã€‚</span></span><br><span class="line">        prev[i] = <span class="number">0</span>;              <span class="comment">// é¡¶ç‚¹içš„å‰é©±é¡¶ç‚¹ä¸º0ã€‚</span></span><br><span class="line">        dist[i] = mMatrix[vs][i];  <span class="comment">// é¡¶ç‚¹içš„æœ€çŸ­è·¯å¾„ä¸º&quot;é¡¶ç‚¹vs&quot;åˆ°&quot;é¡¶ç‚¹i&quot;çš„æƒã€‚</span></span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// å¯¹&quot;é¡¶ç‚¹vs&quot;è‡ªèº«è¿›è¡Œåˆå§‹åŒ–</span></span><br><span class="line">    flag[vs] = <span class="literal">true</span>;</span><br><span class="line">    dist[vs] = <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// éå†mVexs.length-1æ¬¡ï¼›æ¯æ¬¡æ‰¾å‡ºä¸€ä¸ªé¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚</span></span><br><span class="line">    <span class="type">int</span> k=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; mVexs.length; i++) &#123;</span><br><span class="line">        <span class="comment">// å¯»æ‰¾å½“å‰æœ€å°çš„è·¯å¾„ï¼›</span></span><br><span class="line">        <span class="comment">// å³ï¼Œåœ¨æœªè·å–æœ€çŸ­è·¯å¾„çš„é¡¶ç‚¹ä¸­ï¼Œæ‰¾åˆ°ç¦»vsæœ€è¿‘çš„é¡¶ç‚¹(k)ã€‚</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">min</span> <span class="operator">=</span> INF;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; mVexs.length; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (flag[j]==<span class="literal">false</span> &amp;&amp; dist[j]&lt;min) &#123;</span><br><span class="line">                min = dist[j];</span><br><span class="line">                k = j;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ ‡è®°&quot;é¡¶ç‚¹k&quot;ä¸ºå·²ç»è·å–åˆ°æœ€çŸ­è·¯å¾„</span></span><br><span class="line">        flag[k] = <span class="literal">true</span>;</span><br><span class="line"> </span><br><span class="line">        <span class="comment">// ä¿®æ­£å½“å‰æœ€çŸ­è·¯å¾„å’Œå‰é©±é¡¶ç‚¹</span></span><br><span class="line">        <span class="comment">// å³ï¼Œå½“å·²ç»&quot;é¡¶ç‚¹kçš„æœ€çŸ­è·¯å¾„&quot;ä¹‹åï¼Œæ›´æ–°&quot;æœªè·å–æœ€çŸ­è·¯å¾„çš„é¡¶ç‚¹çš„æœ€çŸ­è·¯å¾„å’Œå‰é©±é¡¶ç‚¹&quot;ã€‚</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; mVexs.length; j++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">tmp</span> <span class="operator">=</span> (mMatrix[k][j]==INF ? INF : (min + mMatrix[k][j]));</span><br><span class="line">            <span class="keyword">if</span> (flag[j]==<span class="literal">false</span> &amp;&amp; (tmp&lt;dist[j]) ) &#123;</span><br><span class="line">                dist[j] = tmp;</span><br><span class="line">                prev[j] = k;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// æ‰“å°dijkstraæœ€çŸ­è·¯å¾„çš„ç»“æœ</span></span><br><span class="line">    System.out.printf(<span class="string">&quot;dijkstra(%c): \n&quot;</span>, mVexs[vs]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>; i &lt; mVexs.length; i++)</span><br><span class="line">        System.out.printf(<span class="string">&quot;  shortest(%c, %c)=%d\n&quot;</span>, mVexs[vs], mVexs[i], dist[i]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ ‘"><a href="#æ ‘" class="headerlink" title="æ ‘"></a>æ ‘</h2><h3 id="æ„å»ºæ ‘ï¼ˆå‰åº-ä¸­åºï¼‰"><a href="#æ„å»ºæ ‘ï¼ˆå‰åº-ä¸­åºï¼‰" class="headerlink" title="æ„å»ºæ ‘ï¼ˆå‰åº+ä¸­åºï¼‰"></a>æ„å»ºæ ‘ï¼ˆå‰åº+ä¸­åºï¼‰</h3><p><a href="https://www.hello-algo.com/chapter_divide_and_conquer/build_binary_tree_problem/#3">12.3  æ„å»ºæ ‘é—®é¢˜ - Hello ç®—æ³• (hello-algo.com)</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* æ„å»ºäºŒå‰æ ‘ï¼šåˆ†æ²» */</span></span><br><span class="line">TreeNode <span class="title function_">dfs</span><span class="params">(<span class="type">int</span>[] preorder, Map&lt;Integer, Integer&gt; inorderMap, <span class="type">int</span> i, <span class="type">int</span> l, <span class="type">int</span> r)</span> &#123;</span><br><span class="line">    <span class="comment">// å­æ ‘åŒºé—´ä¸ºç©ºæ—¶ç»ˆæ­¢</span></span><br><span class="line">    <span class="keyword">if</span> (r - l &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    <span class="type">TreeNode</span> <span class="variable">root</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeNode</span>(preorder[i]);</span><br><span class="line">    <span class="comment">// æŸ¥è¯¢ m ï¼Œä»è€Œåˆ’åˆ†å·¦å³å­æ ‘</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> inorderMap.get(preorder[i]);</span><br><span class="line">    <span class="comment">// å­é—®é¢˜ï¼šæ„å»ºå·¦å­æ ‘</span></span><br><span class="line">    root.left = dfs(preorder, inorderMap, i + <span class="number">1</span>, l, m - <span class="number">1</span>);</span><br><span class="line">    <span class="comment">// å­é—®é¢˜ï¼šæ„å»ºå³å­æ ‘</span></span><br><span class="line">    root.right = dfs(preorder, inorderMap, i + <span class="number">1</span> + m - l, m + <span class="number">1</span>, r);</span><br><span class="line">    <span class="comment">//æ„å»ºå³å­æ ‘ç¨å¾®å¤æ‚ä¸€äº›ã€‚é¦–å…ˆï¼Œéœ€è¦ç¡®å®šå³å­æ ‘çš„æ ¹èŠ‚ç‚¹åœ¨å‰åºéå†ä¸­çš„ä½ç½®ã€‚ç”±äºå·¦å­æ ‘çš„æ ¹èŠ‚ç‚¹ä¹‹åçš„æ‰€æœ‰å…ƒç´ éƒ½å±äºå³å­æ ‘ï¼Œæ‰€ä»¥å³å­æ ‘çš„æ ¹èŠ‚ç‚¹åœ¨å‰åºéå†ä¸­çš„ä½ç½®æ˜¯ i + 1 + (m - l)ã€‚è¿™é‡Œçš„ m - l è¡¨ç¤ºå·¦å­æ ‘çš„å¤§å°ï¼Œå³å·¦å­æ ‘æœ‰å¤šå°‘ä¸ªèŠ‚ç‚¹ã€‚</span></span><br><span class="line">    <span class="comment">// è¿”å›æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* æ„å»ºäºŒå‰æ ‘ */</span></span><br><span class="line">TreeNode <span class="title function_">buildTree</span><span class="params">(<span class="type">int</span>[] preorder, <span class="type">int</span>[] inorder)</span> &#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–å“ˆå¸Œè¡¨ï¼Œå­˜å‚¨ inorder å…ƒç´ åˆ°ç´¢å¼•çš„æ˜ å°„</span></span><br><span class="line">    Map&lt;Integer, Integer&gt; inorderMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; inorder.length; i++) &#123;</span><br><span class="line">        inorderMap.put(inorder[i], i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">TreeNode</span> <span class="variable">root</span> <span class="operator">=</span> dfs(preorder, inorderMap, <span class="number">0</span>, <span class="number">0</span>, inorder.length - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="åˆ¤æ–­æ˜¯ä¸æ˜¯äºŒå‰å¹³è¡¡æ ‘"><a href="#åˆ¤æ–­æ˜¯ä¸æ˜¯äºŒå‰å¹³è¡¡æ ‘" class="headerlink" title="åˆ¤æ–­æ˜¯ä¸æ˜¯äºŒå‰å¹³è¡¡æ ‘"></a>åˆ¤æ–­æ˜¯ä¸æ˜¯äºŒå‰å¹³è¡¡æ ‘</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * public class TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     TreeNode left;</span></span><br><span class="line"><span class="comment"> *     TreeNode right;</span></span><br><span class="line"><span class="comment"> *     TreeNode(int x) &#123; val = x; &#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isBalanced</span><span class="params">(TreeNode root)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(root == <span class="literal">null</span>)    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">//æ±‚å·¦å­æ ‘çš„æ·±åº¦</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> deepFind(root.left);</span><br><span class="line">        <span class="comment">//æ±‚å³å­æ ‘çš„æ·±åº¦</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> deepFind(root.right);</span><br><span class="line">        <span class="comment">//åˆ¤æ–­æ¯ä¸ªèŠ‚ç‚¹æ˜¯å¦æ»¡è¶³å¹³è¡¡äºŒå‰æ ‘çš„å®šä¹‰ï¼Œå…¨éƒ¨éƒ½æ˜¯ï¼Œæ‰æ˜¯çœŸæ­£çš„å¹³è¡¡äºŒå‰æ ‘</span></span><br><span class="line">        <span class="keyword">return</span> (Math.abs(left - right) &lt; <span class="number">2</span> ? <span class="literal">true</span> : <span class="literal">false</span>) &amp;&amp; isBalanced(root.left) &amp;&amp; isBalanced(root.right);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åˆ¤æ–­ä¸€æ£µæ ‘çš„æ·±åº¦</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">deepFind</span><span class="params">(TreeNode node)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(node == <span class="literal">null</span>)    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> Math.max(deepFind(node.left), deepFind(node.right))+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="å›æº¯é—®é¢˜"><a href="#å›æº¯é—®é¢˜" class="headerlink" title="å›æº¯é—®é¢˜"></a>å›æº¯é—®é¢˜</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å›æº¯ç®—æ³•æ¡†æ¶ */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">backtrack</span><span class="params">(State state, List&lt;Choice&gt; choices, List&lt;State&gt; res)</span> &#123;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­æ˜¯å¦ä¸ºè§£</span></span><br><span class="line">    <span class="keyword">if</span> (isSolution(state)) &#123;</span><br><span class="line">        <span class="comment">// è®°å½•è§£</span></span><br><span class="line">        recordSolution(state, res);</span><br><span class="line">        <span class="comment">// ä¸å†ç»§ç»­æœç´¢</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// éå†æ‰€æœ‰é€‰æ‹©</span></span><br><span class="line">    <span class="keyword">for</span> (Choice choice : choices) &#123;</span><br><span class="line">        <span class="comment">// å‰ªæï¼šåˆ¤æ–­é€‰æ‹©æ˜¯å¦åˆæ³•</span></span><br><span class="line">        <span class="keyword">if</span> (isValid(state, choice)) &#123;</span><br><span class="line">            <span class="comment">// å°è¯•ï¼šåšå‡ºé€‰æ‹©ï¼Œæ›´æ–°çŠ¶æ€</span></span><br><span class="line">            makeChoice(state, choice);</span><br><span class="line">            backtrack(state, choices, res);</span><br><span class="line">            <span class="comment">// å›é€€ï¼šæ’¤é”€é€‰æ‹©ï¼Œæ¢å¤åˆ°ä¹‹å‰çš„çŠ¶æ€</span></span><br><span class="line">            undoChoice(state, choice);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å…¨æ’åˆ—é—®é¢˜"><a href="#å…¨æ’åˆ—é—®é¢˜" class="headerlink" title="å…¨æ’åˆ—é—®é¢˜"></a>å…¨æ’åˆ—é—®é¢˜</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å›æº¯ç®—æ³•ï¼šå…¨æ’åˆ— I */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">backtrack</span><span class="params">(List&lt;Integer&gt; state, <span class="type">int</span>[] choices, <span class="type">boolean</span>[] selected, List&lt;List&lt;Integer&gt;&gt; res)</span> &#123;</span><br><span class="line">    <span class="comment">// å½“çŠ¶æ€é•¿åº¦ç­‰äºå…ƒç´ æ•°é‡æ—¶ï¼Œè®°å½•è§£</span></span><br><span class="line">    <span class="keyword">if</span> (state.size() == choices.length) &#123;</span><br><span class="line">        res.add(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Integer&gt;(state));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// éå†æ‰€æœ‰é€‰æ‹©</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; choices.length; i++) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">choice</span> <span class="operator">=</span> choices[i];</span><br><span class="line">        <span class="comment">// å‰ªæï¼šä¸å…è®¸é‡å¤é€‰æ‹©å…ƒç´ </span></span><br><span class="line">        <span class="keyword">if</span> (!selected[i]) &#123;</span><br><span class="line">            <span class="comment">// å°è¯•ï¼šåšå‡ºé€‰æ‹©ï¼Œæ›´æ–°çŠ¶æ€</span></span><br><span class="line">            selected[i] = <span class="literal">true</span>;</span><br><span class="line">            state.add(choice);</span><br><span class="line">            <span class="comment">// è¿›è¡Œä¸‹ä¸€è½®é€‰æ‹©</span></span><br><span class="line">            backtrack(state, choices, selected, res);</span><br><span class="line">            <span class="comment">// å›é€€ï¼šæ’¤é”€é€‰æ‹©ï¼Œæ¢å¤åˆ°ä¹‹å‰çš„çŠ¶æ€</span></span><br><span class="line">            selected[i] = <span class="literal">false</span>;</span><br><span class="line">            state.remove(state.size() - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* å…¨æ’åˆ— I */</span></span><br><span class="line">List&lt;List&lt;Integer&gt;&gt; <span class="title function_">permutationsI</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;List&lt;Integer&gt;&gt;();</span><br><span class="line">    backtrack(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Integer&gt;(), nums, <span class="keyword">new</span> <span class="title class_">boolean</span>[nums.length], res);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å­é›†å’Œé—®é¢˜"><a href="#å­é›†å’Œé—®é¢˜" class="headerlink" title="å­é›†å’Œé—®é¢˜"></a>å­é›†å’Œé—®é¢˜</h3><p>ç±»ä¼¼äºå…¨æ’åˆ—é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå­é›†çš„ç”Ÿæˆè¿‡ç¨‹æƒ³è±¡æˆä¸€ç³»åˆ—é€‰æ‹©çš„ç»“æœï¼Œå¹¶åœ¨é€‰æ‹©è¿‡ç¨‹ä¸­å®æ—¶æ›´æ–°â€œå…ƒç´ å’Œâ€ï¼Œå½“å…ƒç´ å’Œç­‰äº <code>target</code> æ—¶ï¼Œå°±å°†å­é›†è®°å½•è‡³ç»“æœåˆ—è¡¨ã€‚</p><p>è€Œä¸å…¨æ’åˆ—é—®é¢˜ä¸åŒçš„æ˜¯ï¼Œ<strong>æœ¬é¢˜é›†åˆä¸­çš„å…ƒç´ å¯ä»¥è¢«æ— é™æ¬¡é€‰å–</strong>ï¼Œå› æ­¤æ— é¡»å€ŸåŠ© <code>selected</code> å¸ƒå°”åˆ—è¡¨æ¥è®°å½•å…ƒç´ æ˜¯å¦å·²è¢«é€‰æ‹©ã€‚æˆ‘ä»¬å¯ä»¥å¯¹å…¨æ’åˆ—ä»£ç è¿›è¡Œå°å¹…ä¿®æ”¹ï¼Œåˆæ­¥å¾—åˆ°è§£é¢˜ä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å›æº¯ç®—æ³•ï¼šå­é›†å’Œ I */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">backtrack</span><span class="params">(List&lt;Integer&gt; state, <span class="type">int</span> target, <span class="type">int</span> total, <span class="type">int</span>[] choices, List&lt;List&lt;Integer&gt;&gt; res)</span> &#123;</span><br><span class="line">    <span class="comment">// å­é›†å’Œç­‰äº target æ—¶ï¼Œè®°å½•è§£</span></span><br><span class="line">    <span class="keyword">if</span> (total == target) &#123;</span><br><span class="line">        res.add(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(state));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// éå†æ‰€æœ‰é€‰æ‹©</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; choices.length; i++) &#123;</span><br><span class="line">        <span class="comment">// å‰ªæï¼šè‹¥å­é›†å’Œè¶…è¿‡ target ï¼Œåˆ™è·³è¿‡è¯¥é€‰æ‹©</span></span><br><span class="line">        <span class="keyword">if</span> (total + choices[i] &gt; target) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å°è¯•ï¼šåšå‡ºé€‰æ‹©ï¼Œæ›´æ–°å…ƒç´ å’Œ total</span></span><br><span class="line">        state.add(choices[i]);</span><br><span class="line">        <span class="comment">// è¿›è¡Œä¸‹ä¸€è½®é€‰æ‹©</span></span><br><span class="line">        backtrack(state, target, total + choices[i], choices, res);</span><br><span class="line">        <span class="comment">// å›é€€ï¼šæ’¤é”€é€‰æ‹©ï¼Œæ¢å¤åˆ°ä¹‹å‰çš„çŠ¶æ€</span></span><br><span class="line">        state.remove(state.size() - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* æ±‚è§£å­é›†å’Œ Iï¼ˆåŒ…å«é‡å¤å­é›†ï¼‰ */</span></span><br><span class="line">List&lt;List&lt;Integer&gt;&gt; <span class="title function_">subsetSumINaive</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">    List&lt;Integer&gt; state = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(); <span class="comment">// çŠ¶æ€ï¼ˆå­é›†ï¼‰</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">total</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">// å­é›†å’Œ</span></span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(); <span class="comment">// ç»“æœåˆ—è¡¨ï¼ˆå­é›†åˆ—è¡¨ï¼‰</span></span><br><span class="line">    backtrack(state, target, total, nums, res);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½†è¿™æ ·çš„é—®é¢˜æ˜¯ï¼Œå…¶åœ¨è¿›è¡Œé€‰å–çš„æ—¶å€™ï¼Œä¼šé€ æˆé‡å¤ï¼Œè§£å†³åŠæ³•æ˜¯å…ˆæ’åº</p><ul><li>åœ¨å¼€å¯æœç´¢å‰ï¼Œå…ˆå°†æ•°ç»„ <code>nums</code> æ’åºã€‚åœ¨éå†æ‰€æœ‰é€‰æ‹©æ—¶ï¼Œ<strong>å½“å­é›†å’Œè¶…è¿‡ <code>target</code> æ—¶ç›´æ¥ç»“æŸå¾ªç¯</strong>ï¼Œå› ä¸ºåè¾¹çš„å…ƒç´ æ›´å¤§ï¼Œå…¶å­é›†å’Œä¸€å®šè¶…è¿‡ <code>target</code> ã€‚</li><li>çœå»å…ƒç´ å’Œå˜é‡ <code>total</code> ï¼Œ<strong>é€šè¿‡åœ¨ <code>target</code> ä¸Šæ‰§è¡Œå‡æ³•æ¥ç»Ÿè®¡å…ƒç´ å’Œ</strong>ï¼Œå½“ <code>target</code> ç­‰äº 0 æ—¶è®°å½•è§£ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å›æº¯ç®—æ³•ï¼šå­é›†å’Œ I */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">backtrack</span><span class="params">(List&lt;Integer&gt; state, <span class="type">int</span> target, <span class="type">int</span>[] choices, <span class="type">int</span> start, List&lt;List&lt;Integer&gt;&gt; res)</span> &#123;</span><br><span class="line">    <span class="comment">// å­é›†å’Œç­‰äº target æ—¶ï¼Œè®°å½•è§£</span></span><br><span class="line">    <span class="keyword">if</span> (target == <span class="number">0</span>) &#123;</span><br><span class="line">        res.add(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(state));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// éå†æ‰€æœ‰é€‰æ‹©</span></span><br><span class="line">    <span class="comment">// å‰ªæäºŒï¼šä» start å¼€å§‹éå†ï¼Œé¿å…ç”Ÿæˆé‡å¤å­é›†</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> start; i &lt; choices.length; i++) &#123;</span><br><span class="line">        <span class="comment">// å‰ªæä¸€ï¼šè‹¥å­é›†å’Œè¶…è¿‡ target ï¼Œåˆ™ç›´æ¥ç»“æŸå¾ªç¯</span></span><br><span class="line">        <span class="comment">// è¿™æ˜¯å› ä¸ºæ•°ç»„å·²æ’åºï¼Œåè¾¹å…ƒç´ æ›´å¤§ï¼Œå­é›†å’Œä¸€å®šè¶…è¿‡ target</span></span><br><span class="line">        <span class="keyword">if</span> (target - choices[i] &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å°è¯•ï¼šåšå‡ºé€‰æ‹©ï¼Œæ›´æ–° target, start</span></span><br><span class="line">        state.add(choices[i]);</span><br><span class="line">        <span class="comment">// è¿›è¡Œä¸‹ä¸€è½®é€‰æ‹©</span></span><br><span class="line">        backtrack(state, target - choices[i], choices, i, res);</span><br><span class="line">        <span class="comment">// å›é€€ï¼šæ’¤é”€é€‰æ‹©ï¼Œæ¢å¤åˆ°ä¹‹å‰çš„çŠ¶æ€</span></span><br><span class="line">        state.remove(state.size() - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* æ±‚è§£å­é›†å’Œ I */</span></span><br><span class="line">List&lt;List&lt;Integer&gt;&gt; <span class="title function_">subsetSumI</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">    List&lt;Integer&gt; state = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(); <span class="comment">// çŠ¶æ€ï¼ˆå­é›†ï¼‰</span></span><br><span class="line">    Arrays.sort(nums); <span class="comment">// å¯¹ nums è¿›è¡Œæ’åº</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">// éå†èµ·å§‹ç‚¹</span></span><br><span class="line">    List&lt;List&lt;Integer&gt;&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(); <span class="comment">// ç»“æœåˆ—è¡¨ï¼ˆå­é›†åˆ—è¡¨ï¼‰</span></span><br><span class="line">    backtrack(state, target, nums, start, res);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Nçš‡åé—®é¢˜ï¼ˆç»å…¸ï¼‰"><a href="#Nçš‡åé—®é¢˜ï¼ˆç»å…¸ï¼‰" class="headerlink" title="Nçš‡åé—®é¢˜ï¼ˆç»å…¸ï¼‰"></a>Nçš‡åé—®é¢˜ï¼ˆç»å…¸ï¼‰</h3><p><a href="https://www.hello-algo.com/chapter_backtracking/n_queens_problem/#3">13.4  N çš‡åé—®é¢˜ - Hello ç®—æ³• (hello-algo.com)</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å›æº¯ç®—æ³•ï¼šn çš‡å */</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">backtrack</span><span class="params">(<span class="type">int</span> row, <span class="type">int</span> n, List&lt;List&lt;String&gt;&gt; state, List&lt;List&lt;List&lt;String&gt;&gt;&gt; res,</span></span><br><span class="line"><span class="params">        <span class="type">boolean</span>[] cols, <span class="type">boolean</span>[] diags1, <span class="type">boolean</span>[] diags2)</span> &#123;</span><br><span class="line">    <span class="comment">// å½“æ”¾ç½®å®Œæ‰€æœ‰è¡Œæ—¶ï¼Œè®°å½•è§£</span></span><br><span class="line">    <span class="keyword">if</span> (row == n) &#123;</span><br><span class="line">        List&lt;List&lt;String&gt;&gt; copyState = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (List&lt;String&gt; sRow : state) &#123;</span><br><span class="line">            copyState.add(<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(sRow));</span><br><span class="line">        &#125;</span><br><span class="line">        res.add(copyState);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// éå†æ‰€æœ‰åˆ—</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">col</span> <span class="operator">=</span> <span class="number">0</span>; col &lt; n; col++) &#123;</span><br><span class="line">        <span class="comment">// è®¡ç®—è¯¥æ ¼å­å¯¹åº”çš„ä¸»å¯¹è§’çº¿å’Œæ¬¡å¯¹è§’çº¿</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">diag1</span> <span class="operator">=</span> row - col + n - <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">diag2</span> <span class="operator">=</span> row + col;</span><br><span class="line">        <span class="comment">// å‰ªæï¼šä¸å…è®¸è¯¥æ ¼å­æ‰€åœ¨åˆ—ã€ä¸»å¯¹è§’çº¿ã€æ¬¡å¯¹è§’çº¿ä¸Šå­˜åœ¨çš‡å</span></span><br><span class="line">        <span class="keyword">if</span> (!cols[col] &amp;&amp; !diags1[diag1] &amp;&amp; !diags2[diag2]) &#123;</span><br><span class="line">            <span class="comment">// å°è¯•ï¼šå°†çš‡åæ”¾ç½®åœ¨è¯¥æ ¼å­</span></span><br><span class="line">            state.get(row).set(col, <span class="string">&quot;Q&quot;</span>);</span><br><span class="line">            cols[col] = diags1[diag1] = diags2[diag2] = <span class="literal">true</span>;</span><br><span class="line">            <span class="comment">// æ”¾ç½®ä¸‹ä¸€è¡Œ</span></span><br><span class="line">            backtrack(row + <span class="number">1</span>, n, state, res, cols, diags1, diags2);</span><br><span class="line">            <span class="comment">// å›é€€ï¼šå°†è¯¥æ ¼å­æ¢å¤ä¸ºç©ºä½</span></span><br><span class="line">            state.get(row).set(col, <span class="string">&quot;#&quot;</span>);</span><br><span class="line">            cols[col] = diags1[diag1] = diags2[diag2] = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* æ±‚è§£ n çš‡å */</span></span><br><span class="line">List&lt;List&lt;List&lt;String&gt;&gt;&gt; <span class="title function_">nQueens</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ– n*n å¤§å°çš„æ£‹ç›˜ï¼Œå…¶ä¸­ &#x27;Q&#x27; ä»£è¡¨çš‡åï¼Œ&#x27;#&#x27; ä»£è¡¨ç©ºä½</span></span><br><span class="line">    List&lt;List&lt;String&gt;&gt; state = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        List&lt;String&gt; row = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">            row.add(<span class="string">&quot;#&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        state.add(row);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">boolean</span>[] cols = <span class="keyword">new</span> <span class="title class_">boolean</span>[n]; <span class="comment">// è®°å½•åˆ—æ˜¯å¦æœ‰çš‡å</span></span><br><span class="line">    <span class="type">boolean</span>[] diags1 = <span class="keyword">new</span> <span class="title class_">boolean</span>[<span class="number">2</span> * n - <span class="number">1</span>]; <span class="comment">// è®°å½•ä¸»å¯¹è§’çº¿ä¸Šæ˜¯å¦æœ‰çš‡å</span></span><br><span class="line">    <span class="type">boolean</span>[] diags2 = <span class="keyword">new</span> <span class="title class_">boolean</span>[<span class="number">2</span> * n - <span class="number">1</span>]; <span class="comment">// è®°å½•æ¬¡å¯¹è§’çº¿ä¸Šæ˜¯å¦æœ‰çš‡å</span></span><br><span class="line">    List&lt;List&lt;List&lt;String&gt;&gt;&gt; res = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    backtrack(<span class="number">0</span>, n, state, res, cols, diags1, diags2);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2024-09-04è”šæ¥"><a href="#2024-09-04è”šæ¥" class="headerlink" title="2024.09.04è”šæ¥"></a>2024.09.04è”šæ¥</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">getAns</span><span class="params">(<span class="type">int</span>[][] matrix, <span class="type">int</span>[][] ans, <span class="type">boolean</span> flag)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> matrix.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> matrix[<span class="number">0</span>].length;</span><br><span class="line">        </span><br><span class="line">        <span class="type">int</span> <span class="variable">currentX</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">currentY</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> steps[][] = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">4</span>][<span class="number">2</span>];</span><br><span class="line">        steps[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>; steps[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        steps[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>; steps[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        steps[<span class="number">2</span>][<span class="number">0</span>] = <span class="number">0</span>; steps[<span class="number">2</span>][<span class="number">1</span>] = -<span class="number">1</span>;</span><br><span class="line">        steps[<span class="number">3</span>][<span class="number">0</span>] = -<span class="number">1</span>; steps[<span class="number">3</span>][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (matrix[<span class="number">0</span>][<span class="number">0</span>] == <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        ans[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="type">boolean</span> visited[][] = <span class="keyword">new</span> <span class="title class_">boolean</span>[m][n];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">                visited[i][j] = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> backtrace(matrix, visited, currentX, currentY, m, n, flag, steps, ans);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">backtrace</span><span class="params">(<span class="type">int</span>[][] matrix, <span class="type">boolean</span>[][] visited, <span class="type">int</span> currentX, <span class="type">int</span> currentY, <span class="type">int</span> m, <span class="type">int</span> n, <span class="type">boolean</span> flag, <span class="type">int</span>[][] steps, <span class="type">int</span>[][] ans)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (currentY &lt; <span class="number">0</span> || currentY &gt;= n || currentX &lt; <span class="number">0</span> || currentX &gt;= m) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; <span class="number">4</span>; j++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">tempCurrentX</span> <span class="operator">=</span> currentX + steps[j][<span class="number">0</span>];</span><br><span class="line">            <span class="type">int</span> <span class="variable">tempCurrentY</span> <span class="operator">=</span> currentY + steps[j][<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span> (tempCurrentX &lt; <span class="number">0</span> || tempCurrentX &gt;= m || tempCurrentY &lt; <span class="number">0</span> || tempCurrentY &gt;= n || visited[tempCurrentX][tempCurrentY] || matrix[tempCurrentX][tempCurrentY] == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (tempCurrentX == m - <span class="number">1</span> &amp;&amp; tempCurrentY == n - <span class="number">1</span>) &#123;</span><br><span class="line">                    flag = <span class="literal">true</span>;</span><br><span class="line">                    ans[tempCurrentX][tempCurrentY] = <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                visited[tempCurrentX][tempCurrentY] = <span class="literal">true</span>;</span><br><span class="line">                ans[tempCurrentX][tempCurrentY] = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (backtrace(matrix, visited, tempCurrentX, tempCurrentY, m, n, flag, steps, ans)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                ans[tempCurrentX][tempCurrentY] = <span class="number">0</span>;</span><br><span class="line">                visited[tempCurrentX][tempCurrentY] = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">int</span> matrix[][] = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">3</span>][<span class="number">3</span>];</span><br><span class="line">        matrix[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        matrix[<span class="number">0</span>][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> ans[][] = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">3</span>][<span class="number">3</span>];</span><br><span class="line">        flag = getAns(matrix, ans, flag);</span><br><span class="line">        <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; <span class="number">3</span>; j++) &#123;</span><br><span class="line">                    System.out.print(ans[i][j] + <span class="string">&quot; &quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;No path found.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h2><h3 id="è®°å¿†åŒ–æœç´¢"><a href="#è®°å¿†åŒ–æœç´¢" class="headerlink" title="è®°å¿†åŒ–æœç´¢"></a>è®°å¿†åŒ–æœç´¢</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* è®°å¿†åŒ–æœç´¢ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">dfs</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span>[] mem)</span> &#123;</span><br><span class="line">    <span class="comment">// å·²çŸ¥ dp[1] å’Œ dp[2] ï¼Œè¿”å›ä¹‹</span></span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">1</span> || i == <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    <span class="comment">// è‹¥å­˜åœ¨è®°å½• dp[i] ï¼Œåˆ™ç›´æ¥è¿”å›ä¹‹</span></span><br><span class="line">    <span class="keyword">if</span> (mem[i] != -<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> mem[i];</span><br><span class="line">    <span class="comment">// dp[i] = dp[i-1] + dp[i-2]</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> dfs(i - <span class="number">1</span>, mem) + dfs(i - <span class="number">2</span>, mem);</span><br><span class="line">    <span class="comment">// è®°å½• dp[i]</span></span><br><span class="line">    mem[i] = count;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* çˆ¬æ¥¼æ¢¯ï¼šè®°å¿†åŒ–æœç´¢ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">climbingStairsDFSMem</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">    <span class="comment">// mem[i] è®°å½•çˆ¬åˆ°ç¬¬ i é˜¶çš„æ–¹æ¡ˆæ€»æ•°ï¼Œ-1 ä»£è¡¨æ— è®°å½•</span></span><br><span class="line">    <span class="type">int</span>[] mem = <span class="keyword">new</span> <span class="title class_">int</span>[n + <span class="number">1</span>];</span><br><span class="line">    Arrays.fill(mem, -<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> dfs(n, mem);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="01èƒŒåŒ…"><a href="#01èƒŒåŒ…" class="headerlink" title="01èƒŒåŒ…"></a>01èƒŒåŒ…</h3><p>æš´åŠ›æœç´¢ O(2^n)</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 0-1 èƒŒåŒ…ï¼šæš´åŠ›æœç´¢ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">knapsackDFS</span><span class="params">(<span class="type">int</span>[] wgt, <span class="type">int</span>[] val, <span class="type">int</span> i, <span class="type">int</span> c)</span> &#123;</span><br><span class="line">    <span class="comment">// è‹¥å·²é€‰å®Œæ‰€æœ‰ç‰©å“æˆ–èƒŒåŒ…æ— å‰©ä½™å®¹é‡ï¼Œåˆ™è¿”å›ä»·å€¼ 0</span></span><br><span class="line">    <span class="keyword">if</span> (i == <span class="number">0</span> || c == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è‹¥è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œåˆ™åªèƒ½é€‰æ‹©ä¸æ”¾å…¥èƒŒåŒ…</span></span><br><span class="line">    <span class="keyword">if</span> (wgt[i - <span class="number">1</span>] &gt; c) &#123;</span><br><span class="line">        <span class="keyword">return</span> knapsackDFS(wgt, val, i - <span class="number">1</span>, c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// è®¡ç®—ä¸æ”¾å…¥å’Œæ”¾å…¥ç‰©å“ i çš„æœ€å¤§ä»·å€¼</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">no</span> <span class="operator">=</span> knapsackDFS(wgt, val, i - <span class="number">1</span>, c);</span><br><span class="line">    <span class="type">int</span> <span class="variable">yes</span> <span class="operator">=</span> knapsackDFS(wgt, val, i - <span class="number">1</span>, c - wgt[i - <span class="number">1</span>]) + val[i - <span class="number">1</span>];</span><br><span class="line">    <span class="comment">// è¿”å›ä¸¤ç§æ–¹æ¡ˆä¸­ä»·å€¼æ›´å¤§çš„é‚£ä¸€ä¸ª</span></span><br><span class="line">    <span class="keyword">return</span> Math.max(no, yes);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç©ºé—´ä¼˜åŒ–åŠ åŠ¨æ€è§„åˆ’</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 0-1 èƒŒåŒ…ï¼šç©ºé—´ä¼˜åŒ–åçš„åŠ¨æ€è§„åˆ’ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">knapsackDPComp</span><span class="params">(<span class="type">int</span>[] wgt, <span class="type">int</span>[] val, <span class="type">int</span> cap)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> wgt.length;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ– dp è¡¨</span></span><br><span class="line">    <span class="type">int</span>[] dp = <span class="keyword">new</span> <span class="title class_">int</span>[cap + <span class="number">1</span>];</span><br><span class="line">    <span class="comment">// çŠ¶æ€è½¬ç§»</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="comment">// å€’åºéå†</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> cap; c &gt;= <span class="number">1</span>; c--) &#123;</span><br><span class="line">            <span class="keyword">if</span> (wgt[i - <span class="number">1</span>] &lt;= c) &#123;</span><br><span class="line">                <span class="comment">// ä¸é€‰å’Œé€‰ç‰©å“ i è¿™ä¸¤ç§æ–¹æ¡ˆçš„è¾ƒå¤§å€¼</span></span><br><span class="line">                dp[c] = Math.max(dp[c], dp[c - wgt[i - <span class="number">1</span>]] + val[i - <span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[cap];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="å®Œå…¨èƒŒåŒ…"><a href="#å®Œå…¨èƒŒåŒ…" class="headerlink" title="å®Œå…¨èƒŒåŒ…"></a>å®Œå…¨èƒŒåŒ…</h3><p>ç©ºé—´ä¼˜åŒ–åŠ åŠ¨æ€è§„åˆ’</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* å®Œå…¨èƒŒåŒ…ï¼šç©ºé—´ä¼˜åŒ–åçš„åŠ¨æ€è§„åˆ’ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">unboundedKnapsackDPComp</span><span class="params">(<span class="type">int</span>[] wgt, <span class="type">int</span>[] val, <span class="type">int</span> cap)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> wgt.length;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ– dp è¡¨</span></span><br><span class="line">    <span class="type">int</span>[] dp = <span class="keyword">new</span> <span class="title class_">int</span>[cap + <span class="number">1</span>];</span><br><span class="line">    <span class="comment">// çŠ¶æ€è½¬ç§»</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> <span class="number">1</span>; c &lt;= cap; c++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (wgt[i - <span class="number">1</span>] &gt; c) &#123;</span><br><span class="line">                <span class="comment">// è‹¥è¶…è¿‡èƒŒåŒ…å®¹é‡ï¼Œåˆ™ä¸é€‰ç‰©å“ i</span></span><br><span class="line">                dp[c] = dp[c];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// ä¸é€‰å’Œé€‰ç‰©å“ i è¿™ä¸¤ç§æ–¹æ¡ˆçš„è¾ƒå¤§å€¼</span></span><br><span class="line">                dp[c] = Math.max(dp[c], dp[c - wgt[i - <span class="number">1</span>]] + val[i - <span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[cap];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-322-é›¶é’±å…‘æ¢"><a href="#Leetcode-322-é›¶é’±å…‘æ¢" class="headerlink" title="Leetcode 322.é›¶é’±å…‘æ¢"></a>Leetcode 322.é›¶é’±å…‘æ¢</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">coinChange</span><span class="params">(<span class="type">int</span>[] coins, <span class="type">int</span> amount)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">types</span> <span class="operator">=</span> coins.length;</span><br><span class="line">        <span class="type">int</span> dp[] = <span class="keyword">new</span> <span class="title class_">int</span>[amount+<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;=amount;i++)&#123;</span><br><span class="line">            dp[i]=amount+<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        dp[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;types;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">0</span>;j&lt;=amount;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span> (j&gt;=coins[i])&#123; <span class="comment">//ä¼šç”¨åˆ°è¿™ä¸ªç¡¬å¸</span></span><br><span class="line">                    <span class="keyword">if</span>(dp[j-coins[i]]+<span class="number">1</span>&lt;dp[j])&#123;</span><br><span class="line">                        dp[j] = dp[j-coins[i]]+<span class="number">1</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (dp[amount]==amount+<span class="number">1</span>)<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> dp[amount];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="é›¶é’±å…‘æ¢é—®é¢˜2"><a href="#é›¶é’±å…‘æ¢é—®é¢˜2" class="headerlink" title="é›¶é’±å…‘æ¢é—®é¢˜2"></a>é›¶é’±å…‘æ¢é—®é¢˜2</h3><p>å‡‘ç¡¬å¸</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* é›¶é’±å…‘æ¢ IIï¼šåŠ¨æ€è§„åˆ’ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">coinChangeIIDP</span><span class="params">(<span class="type">int</span>[] coins, <span class="type">int</span> amt)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> coins.length;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ– dp è¡¨</span></span><br><span class="line">    <span class="type">int</span>[][] dp = <span class="keyword">new</span> <span class="title class_">int</span>[n + <span class="number">1</span>][amt + <span class="number">1</span>];</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ–é¦–åˆ—</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        dp[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// çŠ¶æ€è½¬ç§»</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">1</span>; a &lt;= amt; a++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (coins[i - <span class="number">1</span>] &gt; a) &#123;</span><br><span class="line">                <span class="comment">// è‹¥è¶…è¿‡ç›®æ ‡é‡‘é¢ï¼Œåˆ™ä¸é€‰ç¡¬å¸ i</span></span><br><span class="line">                dp[i][a] = dp[i - <span class="number">1</span>][a];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// ä¸é€‰å’Œé€‰ç¡¬å¸ i è¿™ä¸¤ç§æ–¹æ¡ˆä¹‹å’Œ</span></span><br><span class="line">                dp[i][a] = dp[i - <span class="number">1</span>][a] + dp[i][a - coins[i - <span class="number">1</span>]];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[n][amt];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŠ ç©ºé—´ä¼˜åŒ–</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* é›¶é’±å…‘æ¢ IIï¼šç©ºé—´ä¼˜åŒ–åçš„åŠ¨æ€è§„åˆ’ */</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">coinChangeIIDPComp</span><span class="params">(<span class="type">int</span>[] coins, <span class="type">int</span> amt)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> coins.length;</span><br><span class="line">    <span class="comment">// åˆå§‹åŒ– dp è¡¨</span></span><br><span class="line">    <span class="type">int</span>[] dp = <span class="keyword">new</span> <span class="title class_">int</span>[amt + <span class="number">1</span>];</span><br><span class="line">    dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// çŠ¶æ€è½¬ç§»</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> <span class="number">1</span>; a &lt;= amt; a++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (coins[i - <span class="number">1</span>] &gt; a) &#123;</span><br><span class="line">                <span class="comment">// è‹¥è¶…è¿‡ç›®æ ‡é‡‘é¢ï¼Œåˆ™ä¸é€‰ç¡¬å¸ i</span></span><br><span class="line">                dp[a] = dp[a];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// ä¸é€‰å’Œé€‰ç¡¬å¸ i è¿™ä¸¤ç§æ–¹æ¡ˆä¹‹å’Œ</span></span><br><span class="line">                dp[a] = dp[a] + dp[a - coins[i - <span class="number">1</span>]];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[amt];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¼–è¾‘è·ç¦»é—®é¢˜"><a href="#ç¼–è¾‘è·ç¦»é—®é¢˜" class="headerlink" title="ç¼–è¾‘è·ç¦»é—®é¢˜"></a>ç¼–è¾‘è·ç¦»é—®é¢˜</h3><p><a href="https://www.hello-algo.com/chapter_dynamic_programming/edit_distance_problem/#1">14.6  ç¼–è¾‘è·ç¦»é—®é¢˜ - Hello ç®—æ³• (hello-algo.com)</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> datastructure.dp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Levenshtein</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">distance</span><span class="params">(String a, String b)</span> &#123;</span><br><span class="line">         <span class="type">int</span> <span class="variable">length1</span> <span class="operator">=</span> a.length();</span><br><span class="line">         <span class="type">int</span> <span class="variable">length2</span> <span class="operator">=</span> b.length();</span><br><span class="line">         <span class="type">int</span> dp[][] = <span class="keyword">new</span> <span class="title class_">int</span>[length1+<span class="number">1</span>][length2+<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">         <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=length1;i++)&#123;</span><br><span class="line">             dp[i][<span class="number">0</span>]=i;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">1</span>;j&lt;=length2;j++)&#123;</span><br><span class="line">             dp[<span class="number">0</span>][j]=j;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span> ;i&lt;=length1;i++)&#123;</span><br><span class="line">             <span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">1</span>;j&lt;=length2;j++)&#123;</span><br><span class="line">                 <span class="keyword">if</span> (a.charAt(i-<span class="number">1</span>)==b.charAt(j-<span class="number">1</span>))&#123;</span><br><span class="line">                    dp[i][j]=dp[i-<span class="number">1</span>][j-<span class="number">1</span>];</span><br><span class="line">                 &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                     dp[i][j]=Math.min(dp[i-<span class="number">1</span>][j-<span class="number">1</span>],Math.min(dp[i-<span class="number">1</span>][j],dp[i][j-<span class="number">1</span>]))+<span class="number">1</span>;</span><br><span class="line">                 &#125;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="keyword">return</span> dp[length1][length2];</span><br><span class="line"></span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">          <span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="string">&quot;kitten&quot;</span>;</span><br><span class="line">          <span class="type">String</span> <span class="variable">s2</span> <span class="operator">=</span> <span class="string">&quot;sitting&quot;</span>;</span><br><span class="line">          <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> distance(s1,s2);</span><br><span class="line">          System.out.println(ans);</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-198-æ‰“å®¶åŠ«èˆ"><a href="#Leetcode-198-æ‰“å®¶åŠ«èˆ" class="headerlink" title="Leetcode 198.æ‰“å®¶åŠ«èˆ"></a>Leetcode 198.æ‰“å®¶åŠ«èˆ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">rob</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="keyword">if</span> (length == <span class="number">1</span>)<span class="keyword">return</span> nums[<span class="number">0</span>];</span><br><span class="line">        <span class="type">int</span> dp [] = <span class="keyword">new</span> <span class="title class_">int</span> [length];</span><br><span class="line">        dp[<span class="number">0</span>] = nums[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>; i&lt; length;i++)&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">before</span> <span class="operator">=</span> i-<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (i==<span class="number">1</span>)&#123;</span><br><span class="line">                dp[i]=Math.max(nums[i],nums[i-<span class="number">1</span>]);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                dp[i]=Math.max(dp[i-<span class="number">1</span>],dp[i-<span class="number">2</span>]+nums[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[length-<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-139-å•è¯æ‹†åˆ†"><a href="#Leetcode-139-å•è¯æ‹†åˆ†" class="headerlink" title="Leetcode 139.å•è¯æ‹†åˆ†"></a>Leetcode 139.å•è¯æ‹†åˆ†</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">wordBreak</span><span class="params">(String s, List&lt;String&gt; wordDict)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> s.length();</span><br><span class="line">        <span class="type">boolean</span> dp[] = <span class="keyword">new</span> <span class="title class_">boolean</span>[length+<span class="number">1</span>];</span><br><span class="line">        dp[<span class="number">0</span>]=<span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;length;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j=i+<span class="number">1</span>;j&lt;length+<span class="number">1</span>;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span> (dp[i]&amp;&amp;wordDict.contains(s.substring(i,j)))&#123;</span><br><span class="line">                    dp[j]=<span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[length];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-300-æœ€é•¿é€’å¢å­åºåˆ—"><a href="#Leetcode-300-æœ€é•¿é€’å¢å­åºåˆ—" class="headerlink" title="Leetcode 300.æœ€é•¿é€’å¢å­åºåˆ—"></a>Leetcode 300.æœ€é•¿é€’å¢å­åºåˆ—</h3><p>è§£æ³•1ï¼šä¸€ç§ç‰¹æ®Šæ€æƒ³</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">lengthOfLIS</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; ans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (ans.size()==<span class="number">0</span>||nums[i]&gt;ans.get(ans.size()-<span class="number">1</span>))&#123;</span><br><span class="line">                ans.add(nums[i]);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> findSmallIndex(ans,nums[i]);</span><br><span class="line">                <span class="keyword">if</span> (index!=-<span class="number">1</span>)&#123;</span><br><span class="line">                    ans.set(index,nums[i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans.size();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findSmallIndex</span><span class="params">(List&lt;Integer&gt; ans,<span class="type">int</span> num)</span>&#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span>  <span class="operator">=</span> ans.size();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (ans.get(i)&gt;=num)&#123;</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£æ³•2ï¼šåŠ¨æ€è§„åˆ’</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">lengthOfLIS</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="keyword">if</span> (length==<span class="number">1</span>)<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> dp[]= <span class="keyword">new</span> <span class="title class_">int</span>[length];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;length;i++)&#123;</span><br><span class="line">            dp[i]=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> ans=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;length;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">0</span>;j&lt;i;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(nums[i]&gt;nums[j])&#123;</span><br><span class="line">                    dp[i]=Math.max(dp[i],dp[j]+<span class="number">1</span>);</span><br><span class="line">                    </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ans = Math.max(dp[i],ans);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-120-ä¸‰è§’å½¢æœ€å°è·¯å¾„å’Œ"><a href="#Leetcode-120-ä¸‰è§’å½¢æœ€å°è·¯å¾„å’Œ" class="headerlink" title="Leetcode 120.ä¸‰è§’å½¢æœ€å°è·¯å¾„å’Œ"></a>Leetcode 120.ä¸‰è§’å½¢æœ€å°è·¯å¾„å’Œ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">minimumTotal</span><span class="params">(List&lt;List&lt;Integer&gt;&gt; triangle)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">depth</span> <span class="operator">=</span> triangle.size();</span><br><span class="line">        <span class="type">int</span> dp[][]=<span class="keyword">new</span> <span class="title class_">int</span>[depth][depth];</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>]=triangle.get(<span class="number">0</span>).get(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (depth==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> dp[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;depth;i++)&#123;</span><br><span class="line">            dp[i][<span class="number">0</span>]=dp[i-<span class="number">1</span>][<span class="number">0</span>]+triangle.get(i).get(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">1</span>;j&lt;triangle.get(i).size()-<span class="number">1</span>;j++)&#123;</span><br><span class="line">                dp[i][j]=Math.min(dp[i-<span class="number">1</span>][j-<span class="number">1</span>]+triangle.get(i).get(j),dp[i-<span class="number">1</span>][j]+triangle.get(i).get(j));</span><br><span class="line">            &#125;</span><br><span class="line">            dp[i][triangle.get(i).size()-<span class="number">1</span>]=dp[i-<span class="number">1</span>][triangle.get(i-<span class="number">1</span>).size()-<span class="number">1</span>]+triangle.get(i).get(triangle.get(i).size()-<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> Integer.MAX_VALUE;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;triangle.get(depth-<span class="number">1</span>).size();i++)&#123;</span><br><span class="line">            ans = Math.min(dp[depth-<span class="number">1</span>][i],ans);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è´ªå¿ƒ"><a href="#è´ªå¿ƒ" class="headerlink" title="è´ªå¿ƒ"></a>è´ªå¿ƒ</h2><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè´ªå¿ƒç®—æ³•çš„é€‚ç”¨æƒ…å†µåˆ†ä»¥ä¸‹ä¸¤ç§ã€‚</p><ol><li><strong>å¯ä»¥ä¿è¯æ‰¾åˆ°æœ€ä¼˜è§£</strong>ï¼šè´ªå¿ƒç®—æ³•åœ¨è¿™ç§æƒ…å†µä¸‹å¾€å¾€æ˜¯æœ€ä¼˜é€‰æ‹©ï¼Œå› ä¸ºå®ƒå¾€å¾€æ¯”å›æº¯ã€åŠ¨æ€è§„åˆ’æ›´é«˜æ•ˆã€‚</li><li><strong>å¯ä»¥æ‰¾åˆ°è¿‘ä¼¼æœ€ä¼˜è§£</strong>ï¼šè´ªå¿ƒç®—æ³•åœ¨è¿™ç§æƒ…å†µä¸‹ä¹Ÿæ˜¯å¯ç”¨çš„ã€‚å¯¹äºå¾ˆå¤šå¤æ‚é—®é¢˜æ¥è¯´ï¼Œå¯»æ‰¾å…¨å±€æœ€ä¼˜è§£éå¸¸å›°éš¾ï¼Œèƒ½ä»¥è¾ƒé«˜æ•ˆç‡æ‰¾åˆ°æ¬¡ä¼˜è§£ä¹Ÿæ˜¯éå¸¸ä¸é”™çš„ã€‚</li></ol><p>è´ªå¿ƒé—®é¢˜çš„è§£å†³æµç¨‹å¤§ä½“å¯åˆ†ä¸ºä»¥ä¸‹ä¸‰æ­¥ã€‚</p><ol><li><strong>é—®é¢˜åˆ†æ</strong>ï¼šæ¢³ç†ä¸ç†è§£é—®é¢˜ç‰¹æ€§ï¼ŒåŒ…æ‹¬çŠ¶æ€å®šä¹‰ã€ä¼˜åŒ–ç›®æ ‡å’Œçº¦æŸæ¡ä»¶ç­‰ã€‚è¿™ä¸€æ­¥åœ¨å›æº¯å’ŒåŠ¨æ€è§„åˆ’ä¸­éƒ½æœ‰æ¶‰åŠã€‚</li><li><strong>ç¡®å®šè´ªå¿ƒç­–ç•¥</strong>ï¼šç¡®å®šå¦‚ä½•åœ¨æ¯ä¸€æ­¥ä¸­åšå‡ºè´ªå¿ƒé€‰æ‹©ã€‚è¿™ä¸ªç­–ç•¥èƒ½å¤Ÿåœ¨æ¯ä¸€æ­¥å‡å°é—®é¢˜çš„è§„æ¨¡ï¼Œå¹¶æœ€ç»ˆè§£å†³æ•´ä¸ªé—®é¢˜ã€‚</li><li><strong>æ­£ç¡®æ€§è¯æ˜</strong>ï¼šé€šå¸¸éœ€è¦è¯æ˜é—®é¢˜å…·æœ‰è´ªå¿ƒé€‰æ‹©æ€§è´¨å’Œæœ€ä¼˜å­ç»“æ„ã€‚è¿™ä¸ªæ­¥éª¤å¯èƒ½éœ€è¦ç”¨åˆ°æ•°å­¦è¯æ˜ï¼Œä¾‹å¦‚å½’çº³æ³•æˆ–åè¯æ³•ç­‰ã€‚</li></ol><h3 id="åŠ æ²¹ç«™"><a href="#åŠ æ²¹ç«™" class="headerlink" title="åŠ æ²¹ç«™"></a>åŠ æ²¹ç«™</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">canCompleteCircuit</span><span class="params">(<span class="type">int</span>[] gas, <span class="type">int</span>[] cost)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> gas.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">sumGas</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">sumCost</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            sumCost += cost[i];</span><br><span class="line">            sumGas += gas[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (sumCost &gt; sumGas)</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">rest</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">hasPassed</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i; hasPassed &lt; n; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (j == n)</span><br><span class="line">                    j = <span class="number">0</span>;</span><br><span class="line">                rest += gas[j];</span><br><span class="line">                <span class="keyword">if</span> (rest &gt;= cost[j]) &#123;</span><br><span class="line">                    rest -= cost[j];</span><br><span class="line">                    hasPassed++;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    i = j;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (hasPassed == n)</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="LCP-03-æœºå™¨äººå¤§å†’é™©"><a href="#LCP-03-æœºå™¨äººå¤§å†’é™©" class="headerlink" title="LCP 03. æœºå™¨äººå¤§å†’é™©"></a><a href="https://leetcode.cn/problems/programmable-robot/">LCP 03. æœºå™¨äººå¤§å†’é™©</a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">robot</span><span class="params">(String cmd, <span class="type">int</span>[][] obstacles, <span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> cmd.length();</span><br><span class="line">        <span class="type">int</span> <span class="variable">sx</span> <span class="operator">=</span> <span class="number">0</span>, sy = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// è®°å½•èµ°å®Œä¸€è½®åæœºå™¨äººçš„ä½ç½®</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; ++ i) &#123;</span><br><span class="line">            <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> cmd.charAt(i);</span><br><span class="line">            <span class="keyword">if</span> (c == <span class="string">&#x27;U&#x27;</span>) ++ sy;</span><br><span class="line">            <span class="keyword">else</span> ++ sx;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å…ˆè®¡ç®—èƒ½å¦åˆ°è¾¾ç»ˆç‚¹ ä¸è€ƒè™‘éšœç¢ç‰©</span></span><br><span class="line">        <span class="comment">// è‹¥ä¸èƒ½ç›´æ¥è¿”å›false</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">canFinish</span> <span class="operator">=</span> canReach(cmd, x, y, sx, sy);</span><br><span class="line">        <span class="keyword">if</span> (!canFinish) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">// åˆ¤æ–­åœ¨ç»ˆç‚¹å‰ä¼šä¸ä¼šé‡åˆ°éšœç¢ç‰© </span></span><br><span class="line">        <span class="comment">// è‹¥é‡åˆ°åˆ™è¿”å›false</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span>[] o : obstacles) &#123;</span><br><span class="line">            <span class="keyword">if</span> (o[<span class="number">0</span>] &gt; x || o[<span class="number">1</span>] &gt; y)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (canReach(cmd, o[<span class="number">0</span>], o[<span class="number">1</span>], sx, sy)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ¤æ–­èƒ½å¦ä»åæ ‡(x, y)åˆ°è¾¾(tx, ty)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">canReach</span><span class="params">(String cmd, <span class="type">int</span> tx, <span class="type">int</span> ty, <span class="type">int</span> x, <span class="type">int</span> y)</span> &#123;</span><br><span class="line">        <span class="comment">// roundè®°å½•èµ°åˆ°ç›®æ ‡ç‚¹è‡³å°‘è¦èµ°å¤šå°‘è½®</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">round</span> <span class="operator">=</span> Math.min(tx/x, ty/y);</span><br><span class="line">        <span class="type">int</span> <span class="variable">nx</span> <span class="operator">=</span> round*x, ny = round*y;</span><br><span class="line">        <span class="keyword">if</span> (nx == tx &amp;&amp; ny == ty) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> cmd.length();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; ++ i) &#123;</span><br><span class="line">            <span class="type">char</span> <span class="variable">c</span> <span class="operator">=</span> cmd.charAt(i);</span><br><span class="line">            <span class="keyword">if</span> (c == <span class="string">&#x27;U&#x27;</span>) ++ ny;</span><br><span class="line">            <span class="keyword">else</span> ++ nx;</span><br><span class="line">            <span class="keyword">if</span> (nx &gt; tx || ny &gt; ty) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (nx == tx &amp;&amp; ny == ty) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Leetcode-135-åˆ†å‘ç³–æœ"><a href="#Leetcode-135-åˆ†å‘ç³–æœ" class="headerlink" title="Leetcode 135.åˆ†å‘ç³–æœ"></a>Leetcode 135.åˆ†å‘ç³–æœ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">candy</span><span class="params">(<span class="type">int</span>[] ratings)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> ratings.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">ret</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">inc</span> <span class="operator">=</span> <span class="number">1</span>, dec = <span class="number">0</span>, pre = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (ratings[i] &gt;= ratings[i - <span class="number">1</span>]) &#123;</span><br><span class="line">                dec = <span class="number">0</span>;</span><br><span class="line">                pre = ratings[i] == ratings[i - <span class="number">1</span>] ? <span class="number">1</span> : pre + <span class="number">1</span>;</span><br><span class="line">                ret += pre;</span><br><span class="line">                inc = pre;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                dec++;</span><br><span class="line">                <span class="keyword">if</span> (dec == inc) &#123;</span><br><span class="line">                    dec++;</span><br><span class="line">                &#125;</span><br><span class="line">                ret += dec;</span><br><span class="line">                pre = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-42-æ¥é›¨æ°´"><a href="#Leetcode-42-æ¥é›¨æ°´" class="headerlink" title="Leetcode 42.æ¥é›¨æ°´"></a>Leetcode 42.æ¥é›¨æ°´</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">trap</span><span class="params">(<span class="type">int</span>[] height)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> height.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span><span class="number">1</span>;i&lt;length-<span class="number">1</span>;i++)&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">max_left</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i-<span class="number">1</span>;j&gt;=<span class="number">0</span>;j--)&#123;</span><br><span class="line">                <span class="keyword">if</span> (height[j]&gt;max_left)</span><br><span class="line">                max_left = height[j];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> <span class="variable">max_right</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i+<span class="number">1</span>;j&lt;length;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span> (height[j]&gt;max_right)</span><br><span class="line">                max_right = height[j];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (height[i]&lt;Math.min(max_left,max_right))&#123;</span><br><span class="line">                ans+=Math.min(max_left,max_right)- height[i];</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-13-ç½—é©¬æ•°å­—è½¬æ•´å½¢"><a href="#Leetcode-13-ç½—é©¬æ•°å­—è½¬æ•´å½¢" class="headerlink" title="Leetcode 13.ç½—é©¬æ•°å­—è½¬æ•´å½¢"></a>Leetcode 13.ç½—é©¬æ•°å­—è½¬æ•´å½¢</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">romanToInt</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        HashMap&lt;Character,Integer&gt; romanMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        romanMap.put(<span class="string">&#x27;I&#x27;</span>,<span class="number">1</span>);</span><br><span class="line">        romanMap.put(<span class="string">&#x27;V&#x27;</span>,<span class="number">5</span>);</span><br><span class="line">        romanMap.put(<span class="string">&#x27;X&#x27;</span>,<span class="number">10</span>);</span><br><span class="line">        romanMap.put(<span class="string">&#x27;L&#x27;</span>,<span class="number">50</span>);</span><br><span class="line">        romanMap.put(<span class="string">&#x27;C&#x27;</span>,<span class="number">100</span>);</span><br><span class="line">        romanMap.put(<span class="string">&#x27;D&#x27;</span>,<span class="number">500</span>);</span><br><span class="line">        romanMap.put(<span class="string">&#x27;M&#x27;</span>,<span class="number">1000</span>);</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> s.length();</span><br><span class="line">        <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (i==length-<span class="number">1</span>)ans+=romanMap.get(s.charAt(i));</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (romanMap.get(s.charAt(i))&lt;romanMap.get(s.charAt(i+<span class="number">1</span>)))&#123;</span><br><span class="line">                    ans-=romanMap.get(s.charAt(i));</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    ans+=romanMap.get(s.charAt(i));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-12-æ•´æ•°è½¬ç½—é©¬æ•°å­—"><a href="#Leetcode-12-æ•´æ•°è½¬ç½—é©¬æ•°å­—" class="headerlink" title="Leetcode 12.æ•´æ•°è½¬ç½—é©¬æ•°å­—"></a>Leetcode 12.æ•´æ•°è½¬ç½—é©¬æ•°å­—</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">Â  Â  <span class="type">int</span>[] values = &#123;<span class="number">1000</span>, <span class="number">900</span>, <span class="number">500</span>, <span class="number">400</span>, <span class="number">100</span>, <span class="number">90</span>, <span class="number">50</span>, <span class="number">40</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">1</span>&#125;;</span><br><span class="line">Â  Â  String[] symbols = &#123;<span class="string">&quot;M&quot;</span>, <span class="string">&quot;CM&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="string">&quot;CD&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="string">&quot;XC&quot;</span>, <span class="string">&quot;L&quot;</span>, <span class="string">&quot;XL&quot;</span>, <span class="string">&quot;X&quot;</span>, <span class="string">&quot;IX&quot;</span>, <span class="string">&quot;V&quot;</span>, <span class="string">&quot;IV&quot;</span>, <span class="string">&quot;I&quot;</span>&#125;;</span><br><span class="line"></span><br><span class="line">Â  Â  <span class="keyword">public</span> String <span class="title function_">intToRoman</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">Â  Â  Â  Â  <span class="type">StringBuffer</span> <span class="variable">roman</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; values.length; ++i) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="type">int</span> <span class="variable">value</span> <span class="operator">=</span> values[i];</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="type">String</span> <span class="variable">symbol</span> <span class="operator">=</span> symbols[i];</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">while</span> (num &gt;= value) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  num -= value;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  roman.append(symbol);</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (num == <span class="number">0</span>) &#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">break</span>;</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">return</span> roman.toString();</span><br><span class="line">Â  Â  &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Leetcode-63-ä¸åŒè·¯å¾„2"><a href="#Leetcode-63-ä¸åŒè·¯å¾„2" class="headerlink" title="Leetcode 63.ä¸åŒè·¯å¾„2"></a>Leetcode 63.ä¸åŒè·¯å¾„2</h3><p>åŠ¨æ€è§„åˆ’</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">uniquePathsWithObstacles</span><span class="params">(<span class="type">int</span>[][] obstacleGrid)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (obstacleGrid == <span class="literal">null</span> || obstacleGrid.length == <span class="number">0</span> || obstacleGrid[<span class="number">0</span>].length == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> obstacleGrid.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> obstacleGrid[<span class="number">0</span>].length;</span><br><span class="line">        <span class="comment">// dp[i][j] è¡¨ç¤ºåˆ°è¾¾ (i, j) çš„è·¯å¾„æ•°</span></span><br><span class="line">        <span class="type">int</span>[][] dp = <span class="keyword">new</span> <span class="title class_">int</span>[m][n];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–ç¬¬ä¸€è¡Œ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (obstacleGrid[<span class="number">0</span>][j] == <span class="number">1</span>) <span class="keyword">break</span>; <span class="comment">// é‡åˆ°éšœç¢ç‰©ï¼Œä¹‹åçš„æ ¼å­è·¯å¾„æ•°ä¸º0</span></span><br><span class="line">            dp[<span class="number">0</span>][j] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–ç¬¬ä¸€åˆ—</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (obstacleGrid[i][<span class="number">0</span>] == <span class="number">1</span>) <span class="keyword">break</span>; <span class="comment">// é‡åˆ°éšœç¢ç‰©ï¼Œä¹‹åçš„æ ¼å­è·¯å¾„æ•°ä¸º0</span></span><br><span class="line">            dp[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¡«å…… dp è¡¨</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; m; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span>; j &lt; n; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (obstacleGrid[i][j] == <span class="number">0</span>) &#123;</span><br><span class="line">                    dp[i][j] = dp[i - <span class="number">1</span>][j] + dp[i][j - <span class="number">1</span>];</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    dp[i][j] = <span class="number">0</span>; <span class="comment">// é‡åˆ°éšœç¢ç‰©ï¼Œè·¯å¾„æ•°ä¸º0</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> dp[m - <span class="number">1</span>][n - <span class="number">1</span>]; <span class="comment">// è¿”å›å³ä¸‹è§’çš„è·¯å¾„æ•°</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-68-æ–‡æœ¬å·¦å³å¯¹é½"><a href="#Leetcode-68-æ–‡æœ¬å·¦å³å¯¹é½" class="headerlink" title="Leetcode 68.æ–‡æœ¬å·¦å³å¯¹é½"></a>Leetcode 68.æ–‡æœ¬å·¦å³å¯¹é½</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">fullJustify</span><span class="params">(String[] words, <span class="type">int</span> maxWidth)</span> &#123;</span><br><span class="line">        List&lt;String&gt; ans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line">        <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> <span class="number">0</span>, n = words.length;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> right; <span class="comment">// å½“å‰è¡Œçš„ç¬¬ä¸€ä¸ªå•è¯åœ¨ words çš„ä½ç½®</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">sumLen</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">// ç»Ÿè®¡è¿™ä¸€è¡Œå•è¯é•¿åº¦ä¹‹å’Œ</span></span><br><span class="line">            <span class="comment">// å¾ªç¯ç¡®å®šå½“å‰è¡Œå¯ä»¥æ”¾å¤šå°‘å•è¯ï¼Œæ³¨æ„å•è¯ä¹‹é—´åº”è‡³å°‘æœ‰ä¸€ä¸ªç©ºæ ¼</span></span><br><span class="line">            <span class="keyword">while</span> (right &lt; n &amp;&amp; sumLen + words[right].length() + right - left &lt;= maxWidth) &#123;</span><br><span class="line">                sumLen += words[right++].length();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å½“å‰è¡Œæ˜¯æœ€åä¸€è¡Œï¼šå•è¯å·¦å¯¹é½ï¼Œä¸”å•è¯ä¹‹é—´åº”åªæœ‰ä¸€ä¸ªç©ºæ ¼ï¼Œåœ¨è¡Œæœ«å¡«å……å‰©ä½™ç©ºæ ¼</span></span><br><span class="line">            <span class="keyword">if</span> (right == n) &#123;</span><br><span class="line">                <span class="type">StringBuffer</span> <span class="variable">sb</span> <span class="operator">=</span> join(words, left, n, <span class="string">&quot; &quot;</span>);</span><br><span class="line">                sb.append(blank(maxWidth - sb.length()));</span><br><span class="line">                ans.add(sb.toString());</span><br><span class="line">                <span class="keyword">return</span> ans;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> <span class="variable">numWords</span> <span class="operator">=</span> right - left;</span><br><span class="line">            <span class="type">int</span> <span class="variable">numSpaces</span> <span class="operator">=</span> maxWidth - sumLen;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å½“å‰è¡Œåªæœ‰ä¸€ä¸ªå•è¯ï¼šè¯¥å•è¯å·¦å¯¹é½ï¼Œåœ¨è¡Œæœ«å¡«å……å‰©ä½™ç©ºæ ¼</span></span><br><span class="line">            <span class="keyword">if</span> (numWords == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="type">StringBuffer</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>(words[left]);</span><br><span class="line">                sb.append(blank(numSpaces));</span><br><span class="line">                ans.add(sb.toString());</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å½“å‰è¡Œä¸åªä¸€ä¸ªå•è¯</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">avgSpaces</span> <span class="operator">=</span> numSpaces / (numWords - <span class="number">1</span>);</span><br><span class="line">            <span class="type">int</span> <span class="variable">extraSpaces</span> <span class="operator">=</span> numSpaces % (numWords - <span class="number">1</span>);</span><br><span class="line">            <span class="type">StringBuffer</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">            sb.append(join(words, left, left + extraSpaces + <span class="number">1</span>, blank(avgSpaces + <span class="number">1</span>))); <span class="comment">// æ‹¼æ¥é¢å¤–åŠ ä¸€ä¸ªç©ºæ ¼çš„å•è¯</span></span><br><span class="line">            sb.append(blank(avgSpaces));</span><br><span class="line">            sb.append(join(words, left + extraSpaces + <span class="number">1</span>, right, blank(avgSpaces))); <span class="comment">// æ‹¼æ¥å…¶ä½™å•è¯</span></span><br><span class="line">            ans.add(sb.toString());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// blank è¿”å›é•¿åº¦ä¸º n çš„ç”±ç©ºæ ¼ç»„æˆçš„å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">blank</span><span class="params">(<span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="type">StringBuffer</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            sb.append(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// join è¿”å›ç”¨ sep æ‹¼æ¥ [left, right) èŒƒå›´å†…çš„ words ç»„æˆçš„å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">public</span> StringBuffer <span class="title function_">join</span><span class="params">(String[] words, <span class="type">int</span> left, <span class="type">int</span> right, String sep)</span> &#123;</span><br><span class="line">        <span class="type">StringBuffer</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>(words[left]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> left + <span class="number">1</span>; i &lt; right; ++i) &#123;</span><br><span class="line">            sb.append(sep);</span><br><span class="line">            sb.append(words[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Leetcode-125-éªŒè¯å›æ–‡ä¸²"><a href="#Leetcode-125-éªŒè¯å›æ–‡ä¸²" class="headerlink" title="Leetcode 125.éªŒè¯å›æ–‡ä¸²"></a>Leetcode 125.éªŒè¯å›æ–‡ä¸²</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isPalindrome</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">s2</span> <span class="operator">=</span> s.toLowerCase();</span><br><span class="line">        <span class="type">Stack</span> <span class="variable">stack</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Stack</span>();</span><br><span class="line">        <span class="type">Queue</span> <span class="variable">queue</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">LinkedList</span>();</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> s2.length();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (Character.isLetter(s2.charAt(i))||Character.isDigit(s2.charAt(i)))&#123;</span><br><span class="line">                stack.push(s2.charAt(i));</span><br><span class="line">                queue.offer(s2.charAt(i));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">while</span> (!stack.isEmpty())&#123;</span><br><span class="line">            <span class="keyword">if</span> (stack.peek()==queue.peek())&#123;</span><br><span class="line">                stack.pop();</span><br><span class="line">                queue.poll();</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                ans = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-167-ä¸¤æ•°ä¹‹å’Œ-II-è¾“å…¥æœ‰åºæ•°ç»„"><a href="#Leetcode-167-ä¸¤æ•°ä¹‹å’Œ-II-è¾“å…¥æœ‰åºæ•°ç»„" class="headerlink" title="Leetcode 167.ä¸¤æ•°ä¹‹å’Œ II - è¾“å…¥æœ‰åºæ•°ç»„"></a>Leetcode 167.<a href="https://leetcode.cn/problems/two-sum-ii-input-array-is-sorted/">ä¸¤æ•°ä¹‹å’Œ II - è¾“å…¥æœ‰åºæ•°ç»„</a></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åŒæŒ‡é’ˆ</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] twoSum(<span class="type">int</span>[] numbers, <span class="type">int</span> target) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">low</span> <span class="operator">=</span> <span class="number">0</span>, high = numbers.length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (low &lt; high) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> numbers[low] + numbers[high];</span><br><span class="line">            <span class="keyword">if</span> (sum == target) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;low + <span class="number">1</span>, high + <span class="number">1</span>&#125;;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sum &lt; target) &#123;</span><br><span class="line">                ++low;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                --high;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;-<span class="number">1</span>, -<span class="number">1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Leetcode-11-ç››æœ€å¤šæ°´çš„å®¹å™¨"><a href="#Leetcode-11-ç››æœ€å¤šæ°´çš„å®¹å™¨" class="headerlink" title="Leetcode 11.ç››æœ€å¤šæ°´çš„å®¹å™¨"></a>Leetcode 11.ç››æœ€å¤šæ°´çš„å®¹å™¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è¿™ä¸ªæ–¹æ³•ä¼šè¶…æ—¶</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxArea</span><span class="params">(<span class="type">int</span>[] height)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> height.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span><span class="number">0</span>;i&lt;length-<span class="number">1</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j=i+<span class="number">1</span>;j&lt;length;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span> ((j-i)*Math.min(height[i],height[j])&gt;ans)&#123;</span><br><span class="line">                    ans = (j-i)*Math.min(height[i],height[j]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//åŒæŒ‡é’ˆï¼Œæ­£ç¡®æ€§å¯ä»¥ç”¨åè¯æ³•ï¼šå¦‚æœé«˜åº¦æ›´é«˜çš„åè€Œæ”¹å˜äº†ï¼Œé‚£ä¹ˆèƒ½è£…çš„æ°´è‚¯å®šæ˜¯å˜å°çš„ï¼Œæ‰€ä»¥è¿™ç§ç­–ç•¥ä¸€å®šæ˜¯è®©èƒ½è£…çš„æ°´å˜å¤šçš„</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">maxArea</span><span class="params">(<span class="type">int</span>[] height)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> height.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">end</span> <span class="operator">=</span> length-<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(start&lt;end)&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">minHeight</span> <span class="operator">=</span> Math.min(height[start],height[end]);</span><br><span class="line">            <span class="keyword">if</span> ((end-start)*minHeight&gt;ans)&#123;</span><br><span class="line">                ans = (end-start)*minHeight;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (minHeight==height[start])start++;</span><br><span class="line">            <span class="keyword">else</span> end--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-15-ä¸‰æ•°ä¹‹å’Œ"><a href="#Leetcode-15-ä¸‰æ•°ä¹‹å’Œ" class="headerlink" title="Leetcode 15.ä¸‰æ•°ä¹‹å’Œ"></a>Leetcode 15.ä¸‰æ•°ä¹‹å’Œ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">threeSum</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        Arrays.sort(nums);</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        List&lt;List&lt;Integer&gt;&gt;ans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;List&lt;Integer&gt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span><span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (i&gt;<span class="number">0</span>&amp;&amp;nums[i]==nums[i-<span class="number">1</span>])&#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> n-<span class="number">1</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> -nums[i];</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i+<span class="number">1</span>;j&lt;n;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span> (j&gt;i+<span class="number">1</span>&amp;&amp;nums[j]==nums[j-<span class="number">1</span>])&#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">while</span> (j&lt;k&amp;&amp;nums[j]+nums[k]&gt;t)&#123;</span><br><span class="line">                    k--;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (j==k)<span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">if</span> (nums[j]+nums[k]==t)&#123;</span><br><span class="line">                    List&lt;Integer&gt;list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Integer&gt;();</span><br><span class="line">                    list.add(nums[i]);</span><br><span class="line">                    list.add(nums[j]);</span><br><span class="line">                    list.add(nums[k]);</span><br><span class="line">                    ans.add(list);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-209-é•¿åº¦æœ€å°çš„å­æ•°ç»„"><a href="#Leetcode-209-é•¿åº¦æœ€å°çš„å­æ•°ç»„" class="headerlink" title="Leetcode 209.é•¿åº¦æœ€å°çš„å­æ•°ç»„"></a>Leetcode 209.é•¿åº¦æœ€å°çš„å­æ•°ç»„</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æš´åŠ› ä¼šè¶…æ—¶</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">minSubArrayLen</span><span class="params">(<span class="type">int</span> target, <span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="type">int</span> presum[]=<span class="keyword">new</span> <span class="title class_">int</span>[length+<span class="number">1</span>];</span><br><span class="line">        <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">100000</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=length;i++)&#123;</span><br><span class="line">                presum[i]=presum[i-<span class="number">1</span>]+nums[i-<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (presum[length]&lt;target)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;length;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j=length;j&gt;=i;j--)&#123;</span><br><span class="line">                    <span class="keyword">if</span> (presum[j]-presum[i]&gt;=target)&#123;</span><br><span class="line">                        <span class="keyword">if</span> (j-i&lt;ans)ans = j-i;</span><br><span class="line">                    &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ»‘åŠ¨çª—å£</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">minSubArrayLen</span><span class="params">(<span class="type">int</span> target, <span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">end</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">100000</span>;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">flag</span> <span class="operator">=</span><span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;length;i++)&#123;</span><br><span class="line">            sum+=nums[i];</span><br><span class="line">            end++;</span><br><span class="line">            <span class="keyword">if</span> (sum&gt;=target)&#123;</span><br><span class="line">                <span class="keyword">while</span> (sum&gt;=target)&#123;</span><br><span class="line">                    <span class="keyword">if</span> (end-start&lt;ans)ans = end -start;</span><br><span class="line">                    flag = <span class="literal">true</span>;</span><br><span class="line">                    sum-=nums[start];</span><br><span class="line">                    start++;</span><br><span class="line">                &#125; </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!flag)<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-3-æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²"><a href="#Leetcode-3-æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²" class="headerlink" title="Leetcode 3.æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²"></a>Leetcode 3.æ— é‡å¤å­—ç¬¦çš„æœ€é•¿å­ä¸²</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">lengthOfLongestSubstring</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        HashMap&lt;Character,Integer&gt; map= <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        <span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;s.length();i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (map.get(Character.valueOf(s.charAt(i)))!=<span class="literal">null</span>&amp;&amp;start&lt;map.get(Character.valueOf(s.charAt(i)))+<span class="number">1</span>)&#123; <span class="comment">//å‘ç°æœ‰é‡å¤çš„äº†</span></span><br><span class="line">                start=map.get(Character.valueOf(s.charAt(i)))+<span class="number">1</span>; <span class="comment">//è·³åˆ°æ²¡æœ‰é‡å¤çš„åœ°æ–¹</span></span><br><span class="line">            &#125;</span><br><span class="line">            map.put(Character.valueOf(s.charAt(i)),i);</span><br><span class="line">            <span class="keyword">if</span> (i-start+<span class="number">1</span>&gt;ans)ans = i-start+<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-36-æœ‰æ•ˆçš„æ•°ç‹¬"><a href="#Leetcode-36-æœ‰æ•ˆçš„æ•°ç‹¬" class="headerlink" title="Leetcode 36.æœ‰æ•ˆçš„æ•°ç‹¬"></a>Leetcode 36.æœ‰æ•ˆçš„æ•°ç‹¬</h3><p>æš´åŠ›è§£æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isValidSudoku</span><span class="params">(<span class="type">char</span>[][] board)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; board.length; i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; board[<span class="number">0</span>].length; j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(board[i][j] &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; board[i][j] &lt;= <span class="string">&#x27;9&#x27;</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(!getEffective(i, j, board))&#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">getEffective</span><span class="params">(<span class="type">int</span> i, <span class="type">int</span> j, <span class="type">char</span>[][] board)</span>&#123;</span><br><span class="line">        <span class="comment">// éªŒè¯ä¸€è¡Œ</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>; k &lt; board[i].length; k++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(board[i][k] == board[i][j] &amp;&amp; k != j)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// éªŒè¯ä¸€åˆ—</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>; k &lt; board.length; k++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(board[k][j] == board[i][j] &amp;&amp; k != i)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// éªŒè¯å½“å‰ 3 * 3 æ•°ç»„</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">heng</span> <span class="operator">=</span> (i / <span class="number">3</span>) * <span class="number">3</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">zhong</span> <span class="operator">=</span> (j / <span class="number">3</span>) * <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">k1</span> <span class="operator">=</span> heng; k1 &lt; heng + <span class="number">3</span>; k1++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">k2</span> <span class="operator">=</span> zhong; k2 &lt; zhong + <span class="number">3</span>; k2++)&#123;</span><br><span class="line">                <span class="keyword">if</span>((board[k1][k2] == board[i][j]) &amp;&amp; (k1 != i &amp;&amp; k2 != j))&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-54-èºæ—‹çŸ©é˜µ"><a href="#Leetcode-54-èºæ—‹çŸ©é˜µ" class="headerlink" title="Leetcode 54.èºæ—‹çŸ©é˜µ"></a>Leetcode 54.èºæ—‹çŸ©é˜µ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">spiralOrder</span><span class="params">(<span class="type">int</span>[][] matrix)</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; order = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Integer&gt;();</span><br><span class="line">        <span class="keyword">if</span> (matrix == <span class="literal">null</span> || matrix.length == <span class="number">0</span> || matrix[<span class="number">0</span>].length == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> order;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">rows</span> <span class="operator">=</span> matrix.length, columns = matrix[<span class="number">0</span>].length;</span><br><span class="line">        <span class="type">boolean</span>[][] visited = <span class="keyword">new</span> <span class="title class_">boolean</span>[rows][columns];</span><br><span class="line">        <span class="type">int</span> <span class="variable">total</span> <span class="operator">=</span> rows * columns;</span><br><span class="line">        <span class="type">int</span> <span class="variable">row</span> <span class="operator">=</span> <span class="number">0</span>, column = <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span>[][] directions = &#123;&#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">1</span>, <span class="number">0</span>&#125;, &#123;<span class="number">0</span>, -<span class="number">1</span>&#125;, &#123;-<span class="number">1</span>, <span class="number">0</span>&#125;&#125;;</span><br><span class="line">        <span class="type">int</span> <span class="variable">directionIndex</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; total; i++) &#123;</span><br><span class="line">            order.add(matrix[row][column]);</span><br><span class="line">            visited[row][column] = <span class="literal">true</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">nextRow</span> <span class="operator">=</span> row + directions[directionIndex][<span class="number">0</span>], nextColumn = column + directions[directionIndex][<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span> (nextRow &lt; <span class="number">0</span> || nextRow &gt;= rows || nextColumn &lt; <span class="number">0</span> || nextColumn &gt;= columns || visited[nextRow][nextColumn]) &#123;</span><br><span class="line">                directionIndex = (directionIndex + <span class="number">1</span>) % <span class="number">4</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            row += directions[directionIndex][<span class="number">0</span>];</span><br><span class="line">            column += directions[directionIndex][<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> order;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Leetcode-48-æ—‹è½¬å›¾åƒ"><a href="#Leetcode-48-æ—‹è½¬å›¾åƒ" class="headerlink" title="Leetcode 48.æ—‹è½¬å›¾åƒ"></a>Leetcode 48.æ—‹è½¬å›¾åƒ</h3><p>è¿™ç§æ—‹è½¬çš„é¢˜å°±æ³¨æ„ä½ç½®æ˜ å°„å…³ç³»å°±å¥½</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rotate</span><span class="params">(<span class="type">int</span>[][] matrix)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> matrix.length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; n / <span class="number">2</span>; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; (n + <span class="number">1</span>) / <span class="number">2</span>; ++j) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">temp</span> <span class="operator">=</span> matrix[i][j];</span><br><span class="line">                matrix[i][j] = matrix[n - j - <span class="number">1</span>][i];</span><br><span class="line">                matrix[n - j - <span class="number">1</span>][i] = matrix[n - i - <span class="number">1</span>][n - j - <span class="number">1</span>];</span><br><span class="line">                matrix[n - i - <span class="number">1</span>][n - j - <span class="number">1</span>] = matrix[j][n - i - <span class="number">1</span>];</span><br><span class="line">                matrix[j][n - i - <span class="number">1</span>] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-289-ç”Ÿå‘½æ¸¸æˆ"><a href="#Leetcode-289-ç”Ÿå‘½æ¸¸æˆ" class="headerlink" title="Leetcode 289.ç”Ÿå‘½æ¸¸æˆ"></a>Leetcode 289.ç”Ÿå‘½æ¸¸æˆ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">gameOfLife</span><span class="params">(<span class="type">int</span>[][] board)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> board.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> board[<span class="number">0</span>].length;</span><br><span class="line">        <span class="type">boolean</span> isAlive[][]=<span class="keyword">new</span> <span class="title class_">boolean</span>[m][n];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span><span class="number">0</span>;i&lt;m;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span><span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> getNum(board,i,j,m,n);</span><br><span class="line">                <span class="keyword">if</span> (board[i][j]==<span class="number">1</span>)&#123;</span><br><span class="line">                    <span class="keyword">if</span> (num&lt;<span class="number">2</span>||num&gt;<span class="number">3</span>)isAlive[i][j]=<span class="literal">false</span>;</span><br><span class="line">                    <span class="keyword">if</span> (num==<span class="number">2</span>||num==<span class="number">3</span>)isAlive[i][j]=<span class="literal">true</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">if</span> (num==<span class="number">3</span>)isAlive[i][j]=<span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span><span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span> (isAlive[i][j])board[i][j]=<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    board[i][j]=<span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getNum</span><span class="params">(<span class="type">int</span>[][] board,<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> m, <span class="type">int</span> n)</span>&#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=x-<span class="number">1</span>;i&lt;=x+<span class="number">1</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (i&lt;<span class="number">0</span>||i&gt;=m)<span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j= y-<span class="number">1</span>;j&lt;=y+<span class="number">1</span>;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span> (j&lt;<span class="number">0</span>||j&gt;=n||i==x&amp;&amp;j==y)<span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span> (board[i][j]==<span class="number">1</span>)num++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> num;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å“ˆå¸Œè¡¨"><a href="#å“ˆå¸Œè¡¨" class="headerlink" title="å“ˆå¸Œè¡¨"></a>å“ˆå¸Œè¡¨</h2><h3 id="Leetcode-383-èµé‡‘ä¿¡"><a href="#Leetcode-383-èµé‡‘ä¿¡" class="headerlink" title="Leetcode 383.èµé‡‘ä¿¡"></a>Leetcode 383.èµé‡‘ä¿¡</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">canConstruct</span><span class="params">(String ransomNote, String magazine)</span> &#123;</span><br><span class="line">        <span class="type">int</span> nums[]=<span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">26</span>];</span><br><span class="line">        <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> magazine.length();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;size;i++)&#123;</span><br><span class="line">            nums[magazine.charAt(i)-<span class="string">&#x27;a&#x27;</span>]+=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> rSize= ransomNote.length();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span><span class="number">0</span>;i&lt;rSize;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[ransomNote.charAt(i)-<span class="string">&#x27;a&#x27;</span>]&lt;=<span class="number">0</span>)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            nums[ransomNote.charAt(i)-<span class="string">&#x27;a&#x27;</span>]-=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-205-åŒæ„å­—ç¬¦ä¸²"><a href="#Leetcode-205-åŒæ„å­—ç¬¦ä¸²" class="headerlink" title="Leetcode 205.åŒæ„å­—ç¬¦ä¸²"></a>Leetcode 205.åŒæ„å­—ç¬¦ä¸²</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">Â  Â  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isIsomorphic</span><span class="params">(String s, String t)</span> &#123;</span><br><span class="line">Â  Â  Â  Â  Map&lt;Character,Character&gt; cMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;Character,Character&gt;();</span><br><span class="line">Â  Â  Â  Â  Map&lt;Character,Character&gt; cMap2 = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;Character,Character&gt;();</span><br><span class="line">Â  Â  Â  Â  <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> s.length();</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;length;i++)&#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (cMap.containsKey(Character.valueOf(s.charAt(i)))||cMap2.containsKey(Character.valueOf(t.charAt(i))))&#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">if</span> (cMap.get(Character.valueOf(s.charAt(i)))!=Character.valueOf(t.charAt(i)))</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  cMap.put(Character.valueOf(s.charAt(i)),Character.valueOf(t.charAt(i)));</span><br><span class="line">Â  Â  Â  Â  Â  Â  Â  Â  cMap2.put(Character.valueOf(t.charAt(i)),Character.valueOf(s.charAt(i)));</span><br><span class="line">Â  Â  Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  &#125;</span><br><span class="line">Â  Â  Â  Â  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">Â  Â  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Leetcode-290-å•è¯è§„å¾‹"><a href="#Leetcode-290-å•è¯è§„å¾‹" class="headerlink" title="Leetcode 290.å•è¯è§„å¾‹"></a>Leetcode 290.å•è¯è§„å¾‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">wordPattern</span><span class="params">(String pattern, String s)</span> &#123;</span><br><span class="line">        Map&lt;Character,String&gt; cMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;Character,String&gt;();</span><br><span class="line">        </span><br><span class="line">        Map&lt;String,Character&gt; cMap2 = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String,Character&gt;();</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> pattern.length();</span><br><span class="line">        String words[]=s.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (words.length!=length)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (cMap.containsKey(Character.valueOf(pattern.charAt(i))))&#123;</span><br><span class="line">                <span class="keyword">if</span> (!cMap.get(Character.valueOf(pattern.charAt(i))).equals(words[i]))&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (cMap2.containsKey(words[i]))&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                cMap.put(Character.valueOf(pattern.charAt(i)),words[i]);</span><br><span class="line">                cMap2.put(words[i],Character.valueOf(pattern.charAt(i)));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-49-å­—æ¯å¼‚ä½è¯åˆ†ç»„"><a href="#Leetcode-49-å­—æ¯å¼‚ä½è¯åˆ†ç»„" class="headerlink" title="Leetcode 49.å­—æ¯å¼‚ä½è¯åˆ†ç»„"></a>Leetcode 49.å­—æ¯å¼‚ä½è¯åˆ†ç»„</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//é”™è¯¯è§£æ³•,æ²¡è€ƒè™‘åˆ°æ¬¡æ•°ï¼Œä½†æ³¨æ„keySetçš„ä½¿ç”¨</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;List&lt;String&gt;&gt; <span class="title function_">groupAnagrams</span><span class="params">(String[] strs)</span> &#123;</span><br><span class="line">        HashMap&lt;HashSet&lt;Character&gt;,ArrayList&lt;String&gt;&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> strs.length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i&lt;length; i++)&#123;</span><br><span class="line">            <span class="type">int</span> length2=strs[i].length();</span><br><span class="line">            HashSet&lt;Character&gt;set = <span class="keyword">new</span> <span class="title class_">HashSet</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span> ;j&lt;length2;j++)&#123;</span><br><span class="line">                set.add(Character.valueOf(strs[i].charAt(j)));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!map.containsKey(set))&#123;</span><br><span class="line">                ArrayList&lt;String&gt;list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">                list.add(strs[i]);</span><br><span class="line">                map.put(set,list);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                map.get(set).add(strs[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;List&lt;String&gt;&gt; ans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;List&lt;String&gt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (HashSet&lt;Character&gt; key: map.keySet())&#123;</span><br><span class="line">            ans.add(map.get(key));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ­£ç¡®è§£æ³•ï¼Œæ³¨æ„charçš„æ•°ç»„å¯ä»¥ç›´æ¥new Stringè½¬ä¸ºStringç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;List&lt;String&gt;&gt; <span class="title function_">groupAnagrams</span><span class="params">(String[] strs)</span> &#123;</span><br><span class="line">       Map&lt;String,List&lt;String&gt;&gt;map = <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> strs.length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i&lt;length; i++)&#123;</span><br><span class="line">            <span class="type">int</span> length2=strs[i].length();</span><br><span class="line">            <span class="type">char</span> word[]=<span class="keyword">new</span> <span class="title class_">char</span>[length2];</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>;j&lt;length2;j++)&#123;</span><br><span class="line">                word[j]=strs[i].charAt(j) ;</span><br><span class="line">            &#125;</span><br><span class="line">            Arrays.sort(word);</span><br><span class="line">            <span class="type">String</span> <span class="variable">key</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(word);</span><br><span class="line">            <span class="keyword">if</span> (!map.containsKey(key))&#123;</span><br><span class="line">                List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">                list.add(strs[i]);</span><br><span class="line">                map.put(key,list);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                map.get(key).add(strs[i]);</span><br><span class="line">            &#125;      </span><br><span class="line">        &#125;</span><br><span class="line">        List&lt;List&lt;String&gt;&gt; ans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;List&lt;String&gt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (String key: map.keySet())&#123;</span><br><span class="line">            ans.add(map.get(key));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-128-æœ€é•¿è¿ç»­åºåˆ—"><a href="#Leetcode-128-æœ€é•¿è¿ç»­åºåˆ—" class="headerlink" title="Leetcode 128.æœ€é•¿è¿ç»­åºåˆ—"></a>Leetcode 128.æœ€é•¿è¿ç»­åºåˆ—</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">longestConsecutive</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        Arrays.sort(nums);</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="keyword">if</span> (length==<span class="number">0</span>||length==<span class="number">1</span>)<span class="keyword">return</span> length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>;i&lt;length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[i-<span class="number">1</span>]+<span class="number">1</span>==nums[i])&#123;</span><br><span class="line">                num++;</span><br><span class="line">                ans=Math.max(num,ans);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(nums[i-<span class="number">1</span>]==nums[i])&#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                num=<span class="number">1</span>;</span><br><span class="line">            &#125;      </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åŒºé—´"><a href="#åŒºé—´" class="headerlink" title="åŒºé—´"></a>åŒºé—´</h2><h3 id="Leetcode-228-æ±‡æ€»åŒºé—´"><a href="#Leetcode-228-æ±‡æ€»åŒºé—´" class="headerlink" title="Leetcode 228.æ±‡æ€»åŒºé—´"></a>Leetcode 228.æ±‡æ€»åŒºé—´</h3><p>æ³¨æ„Integer.toStringï¼ˆï¼‰å’ŒStringBuilderçš„ç”¨æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">summaryRanges</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        List&lt;String&gt; ret = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line">        <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="keyword">while</span> (i &lt; n) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">low</span> <span class="operator">=</span> i;</span><br><span class="line">            i++;</span><br><span class="line">            <span class="keyword">while</span> (i &lt; n &amp;&amp; nums[i] == nums[i - <span class="number">1</span>] + <span class="number">1</span>) &#123;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> <span class="variable">high</span> <span class="operator">=</span> i - <span class="number">1</span>;</span><br><span class="line">            <span class="type">StringBuffer</span> <span class="variable">temp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>(Integer.toString(nums[low]));</span><br><span class="line">            <span class="keyword">if</span> (low &lt; high) &#123;</span><br><span class="line">                temp.append(<span class="string">&quot;-&gt;&quot;</span>);</span><br><span class="line">                temp.append(Integer.toString(nums[high]));</span><br><span class="line">            &#125;</span><br><span class="line">            ret.add(temp.toString());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-56-åˆå¹¶åŒºé—´"><a href="#Leetcode-56-åˆå¹¶åŒºé—´" class="headerlink" title="Leetcode 56.åˆå¹¶åŒºé—´"></a>Leetcode 56.åˆå¹¶åŒºé—´</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[][] merge(<span class="type">int</span>[][] intervals) &#123;</span><br><span class="line">        <span class="keyword">if</span> (intervals.length == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">0</span>][<span class="number">2</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        Arrays.sort(intervals, <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;<span class="type">int</span>[]&gt;() &#123;</span><br><span class="line">            <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(<span class="type">int</span>[] interval1, <span class="type">int</span>[] interval2)</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> interval1[<span class="number">0</span>] - interval2[<span class="number">0</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        List&lt;<span class="type">int</span>[]&gt; merged = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;<span class="type">int</span>[]&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; intervals.length; ++i) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">L</span> <span class="operator">=</span> intervals[i][<span class="number">0</span>], R = intervals[i][<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span> (merged.size() == <span class="number">0</span> || merged.get(merged.size() - <span class="number">1</span>)[<span class="number">1</span>] &lt; L) &#123;</span><br><span class="line">                merged.add(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;L, R&#125;);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                merged.get(merged.size() - <span class="number">1</span>)[<span class="number">1</span>] = Math.max(merged.get(merged.size() - <span class="number">1</span>)[<span class="number">1</span>], R);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> merged.toArray(<span class="keyword">new</span> <span class="title class_">int</span>[merged.size()][]); <span class="comment">//List.toArray(array)ï¼Œæ³¨æ„arrayæ˜¯æ–°å¼€è¾Ÿçš„æœªåˆ†é…çš„ç©ºé—´</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Leetcode-57-æ’å…¥åŒºé—´"><a href="#Leetcode-57-æ’å…¥åŒºé—´" class="headerlink" title="Leetcode 57.æ’å…¥åŒºé—´"></a>Leetcode 57.æ’å…¥åŒºé—´</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[][] insert(<span class="type">int</span>[][] intervals, <span class="type">int</span>[] newInterval) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length1</span> <span class="operator">=</span> intervals.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length2</span> <span class="operator">=</span> length1+<span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> [][]ans = <span class="keyword">new</span> <span class="title class_">int</span>[length2][<span class="number">2</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;length1;i++)&#123;</span><br><span class="line">            ans[i][<span class="number">0</span>]=intervals[i][<span class="number">0</span>];</span><br><span class="line">            ans[i][<span class="number">1</span>]=intervals[i][<span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        ans[length1][<span class="number">0</span>]=newInterval[<span class="number">0</span>];</span><br><span class="line">        ans[length1][<span class="number">1</span>]=newInterval[<span class="number">1</span>];</span><br><span class="line">        Arrays.sort(ans,<span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;<span class="type">int</span>[]&gt;()&#123;</span><br><span class="line">            <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(<span class="type">int</span>[]nums1,<span class="type">int</span>[] nums2)</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> nums1[<span class="number">0</span>]-nums2[<span class="number">0</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        List&lt;<span class="type">int</span>[]&gt;ans2 = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;<span class="type">int</span>[]&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;length2;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (ans2.size()==<span class="number">0</span>||ans2.get(ans2.size()-<span class="number">1</span>)[<span class="number">1</span>]&lt;ans[i][<span class="number">0</span>])&#123;</span><br><span class="line">                ans2.add(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;ans[i][<span class="number">0</span>],ans[i][<span class="number">1</span>]&#125;);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                ans2.get(ans2.size()-<span class="number">1</span>)[<span class="number">1</span>]=Math.max(ans[i][<span class="number">1</span>],ans2.get(ans2.size()-<span class="number">1</span>)[<span class="number">1</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans2.toArray(<span class="keyword">new</span> <span class="title class_">int</span>[ans2.size()][]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-452-ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ"><a href="#Leetcode-452-ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ" class="headerlink" title="Leetcode 452.ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ"></a>Leetcode 452.ç”¨æœ€å°‘æ•°é‡çš„ç®­å¼•çˆ†æ°”çƒ</h3><p>æ³¨æ„è´ªå¿ƒ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findMinArrowShots</span><span class="params">(<span class="type">int</span>[][] points)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> points.length;</span><br><span class="line">        Arrays.sort(points,(a,b)-&gt;Integer.compare(a[<span class="number">1</span>],b[<span class="number">1</span>]));</span><br><span class="line">        List&lt;<span class="type">int</span>[]&gt; ans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span><span class="number">0</span>;i&lt;length;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (ans.size()==<span class="number">0</span>||ans.get(ans.size()-<span class="number">1</span>)[<span class="number">1</span>]&lt;points[i][<span class="number">0</span>])&#123;</span><br><span class="line">                ans.add(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;points[i][<span class="number">0</span>],points[i][<span class="number">1</span>]&#125;);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">               <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans.size();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ ˆ"><a href="#æ ˆ" class="headerlink" title="æ ˆ"></a>æ ˆ</h2><h3 id="Leetcode-71-ç®€åŒ–è·¯å¾„"><a href="#Leetcode-71-ç®€åŒ–è·¯å¾„" class="headerlink" title="Leetcode 71.ç®€åŒ–è·¯å¾„"></a>Leetcode 71.ç®€åŒ–è·¯å¾„</h3><p>æ³¨æ„åŒç«¯é˜Ÿåˆ—Dequeç”¨LinkedListæ¥å®ç°ï¼ŒStringBuilder.tostring()è½¬ä¸ºå­—ç¬¦ä¸²ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">simplifyPath</span><span class="params">(String path)</span> &#123;</span><br><span class="line">        String []strs = path.split(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        Deque&lt;String&gt;stack = <span class="keyword">new</span> <span class="title class_">LinkedList</span>();</span><br><span class="line">        <span class="keyword">for</span> (String str:strs)&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&quot;..&quot;</span>.equals(str))&#123;</span><br><span class="line">                <span class="keyword">if</span> (!stack.isEmpty())&#123;</span><br><span class="line">                    stack.pollLast();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span> (str.length()&gt;<span class="number">0</span>&amp;&amp;!<span class="string">&quot;.&quot;</span>.equals(str))&#123;</span><br><span class="line">                stack.offerLast(str);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">if</span> (stack.isEmpty())&#123;</span><br><span class="line">            sb.append(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (!stack.isEmpty())&#123;</span><br><span class="line">                sb.append(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">                sb.append(stack.pollFirst());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-155-æœ€å°æ ˆ"><a href="#Leetcode-155-æœ€å°æ ˆ" class="headerlink" title="Leetcode 155.æœ€å°æ ˆ"></a>Leetcode 155.æœ€å°æ ˆ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MinStack</span> &#123;</span><br><span class="line">    ArrayList&lt;Integer&gt; stack;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MinStack</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>. stack =  <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">push</span><span class="params">(<span class="type">int</span> val)</span> &#123;</span><br><span class="line">        stack.add(val);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pop</span><span class="params">()</span> &#123;</span><br><span class="line">        stack.remove(stack.size()-<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">top</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stack.get(stack.size()-<span class="number">1</span>).intValue();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getMin</span><span class="params">()</span> &#123;  </span><br><span class="line">        <span class="type">int</span> <span class="variable">ans</span> <span class="operator">=</span> Integer.MAX_VALUE;</span><br><span class="line">        <span class="keyword">for</span> (Integer num:stack)&#123;</span><br><span class="line">            <span class="keyword">if</span> (num&lt;ans)ans = num;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-150-é€†æ³¢å…°è¡¨è¾¾å¼"><a href="#Leetcode-150-é€†æ³¢å…°è¡¨è¾¾å¼" class="headerlink" title="Leetcode 150.é€†æ³¢å…°è¡¨è¾¾å¼"></a>Leetcode 150.é€†æ³¢å…°è¡¨è¾¾å¼</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">evalRPN</span><span class="params">(String[] tokens)</span> &#123;</span><br><span class="line">        Stack&lt;String&gt;stack = <span class="keyword">new</span> <span class="title class_">Stack</span>();</span><br><span class="line">        <span class="keyword">for</span> (String str:tokens)&#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="string">&quot;+&quot;</span>.equals(str)&amp;&amp;!<span class="string">&quot;-&quot;</span>.equals(str)&amp;&amp;!<span class="string">&quot;*&quot;</span>.equals(str)&amp;&amp;!<span class="string">&quot;/&quot;</span>.equals(str))&#123;</span><br><span class="line">                stack.push(str);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> Integer.parseInt(stack.pop());</span><br><span class="line">                <span class="type">int</span> <span class="variable">a</span> <span class="operator">=</span> Integer.parseInt(stack.pop());</span><br><span class="line">                <span class="keyword">if</span> (<span class="string">&quot;+&quot;</span>.equals(str))&#123;</span><br><span class="line">                    stack.push(String.valueOf(a+b));</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;-&quot;</span>.equals(str))&#123;</span><br><span class="line">                    stack.push(String.valueOf(a-b));</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;*&quot;</span>.equals(str))&#123;</span><br><span class="line">                    stack.push(String.valueOf(a*b));</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">&quot;/&quot;</span>.equals(str))&#123;</span><br><span class="line">                    stack.push(String.valueOf(a/b));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> Integer.parseInt(stack.pop());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é“¾è¡¨"><a href="#é“¾è¡¨" class="headerlink" title="é“¾è¡¨"></a>é“¾è¡¨</h2><p>æ³¨æ„å“‘ç»“ç‚¹çš„æ„é€ ï¼Œå¾ˆæ–¹ä¾¿ï¼ï¼ï¼</p><h3 id="Leetcode-141-ç¯å½¢é“¾è¡¨"><a href="#Leetcode-141-ç¯å½¢é“¾è¡¨" class="headerlink" title="Leetcode 141.ç¯å½¢é“¾è¡¨"></a>Leetcode 141.ç¯å½¢é“¾è¡¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * class ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode next;</span></span><br><span class="line"><span class="comment"> *     ListNode(int x) &#123;</span></span><br><span class="line"><span class="comment"> *         val = x;</span></span><br><span class="line"><span class="comment"> *         next = null;</span></span><br><span class="line"><span class="comment"> *     &#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">hasCycle</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">slow</span> <span class="operator">=</span>head;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">fast</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="keyword">while</span>(fast!=<span class="literal">null</span>&amp;&amp;slow!=<span class="literal">null</span>)&#123;</span><br><span class="line">            slow=slow.next;</span><br><span class="line">            fast = fast.next;</span><br><span class="line">            <span class="keyword">if</span> (fast==<span class="literal">null</span>)<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            fast = fast.next;</span><br><span class="line">            <span class="keyword">if</span> (fast == slow)<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-2-ä¸¤æ•°ç›¸åŠ "><a href="#Leetcode-2-ä¸¤æ•°ç›¸åŠ " class="headerlink" title="Leetcode 2.ä¸¤æ•°ç›¸åŠ "></a>Leetcode 2.ä¸¤æ•°ç›¸åŠ </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">addTwoNumbers</span><span class="params">(ListNode l1, ListNode l2)</span> &#123;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">head</span> <span class="operator">=</span> <span class="literal">null</span>, tail = <span class="literal">null</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">carry</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (l1 != <span class="literal">null</span> || l2 != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">n1</span> <span class="operator">=</span> l1 != <span class="literal">null</span> ? l1.val : <span class="number">0</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">n2</span> <span class="operator">=</span> l2 != <span class="literal">null</span> ? l2.val : <span class="number">0</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> n1 + n2 + carry;</span><br><span class="line">            <span class="keyword">if</span> (head == <span class="literal">null</span>) &#123;</span><br><span class="line">                head = tail = <span class="keyword">new</span> <span class="title class_">ListNode</span>(sum % <span class="number">10</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                tail.next = <span class="keyword">new</span> <span class="title class_">ListNode</span>(sum % <span class="number">10</span>);</span><br><span class="line">                tail = tail.next;</span><br><span class="line">            &#125;</span><br><span class="line">            carry = sum / <span class="number">10</span>;</span><br><span class="line">            <span class="keyword">if</span> (l1 != <span class="literal">null</span>) &#123;</span><br><span class="line">                l1 = l1.next;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (l2 != <span class="literal">null</span>) &#123;</span><br><span class="line">                l2 = l2.next;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (carry &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            tail.next = <span class="keyword">new</span> <span class="title class_">ListNode</span>(carry);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Leetcode-206-åè½¬é“¾è¡¨"><a href="#Leetcode-206-åè½¬é“¾è¡¨" class="headerlink" title="Leetcode 206.åè½¬é“¾è¡¨"></a>Leetcode 206.åè½¬é“¾è¡¨</h3><p>é€’å½’åšæ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * public class ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode next;</span></span><br><span class="line"><span class="comment"> *     ListNode() &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int val) &#123; this.val = val; &#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int val, ListNode next) &#123; this.val = val; this.next = next; &#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">reverseList</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (head==<span class="literal">null</span>||head.next==<span class="literal">null</span>)<span class="keyword">return</span> head;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">newHead</span> <span class="operator">=</span> reverseList(head.next);</span><br><span class="line">        head.next.next = head;</span><br><span class="line">        head.next=<span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">return</span> newHead;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-92-åè½¬é“¾è¡¨2"><a href="#Leetcode-92-åè½¬é“¾è¡¨2" class="headerlink" title="Leetcode 92.åè½¬é“¾è¡¨2"></a>Leetcode 92.åè½¬é“¾è¡¨2</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">reverseBetween</span><span class="params">(ListNode head, <span class="type">int</span> left, <span class="type">int</span> right)</span> &#123;</span><br><span class="line">        <span class="comment">// å› ä¸ºå¤´èŠ‚ç‚¹æœ‰å¯èƒ½å‘ç”Ÿå˜åŒ–ï¼Œä½¿ç”¨è™šæ‹Ÿå¤´èŠ‚ç‚¹å¯ä»¥é¿å…å¤æ‚çš„åˆ†ç±»è®¨è®º</span></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">dummyNode</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(-<span class="number">1</span>);</span><br><span class="line">        dummyNode.next = head;</span><br><span class="line"></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> dummyNode;</span><br><span class="line">        <span class="comment">// ç¬¬ 1 æ­¥ï¼šä»è™šæ‹Ÿå¤´èŠ‚ç‚¹èµ° left - 1 æ­¥ï¼Œæ¥åˆ° left èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">        <span class="comment">// å»ºè®®å†™åœ¨ for å¾ªç¯é‡Œï¼Œè¯­ä¹‰æ¸…æ™°</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; left - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            pre = pre.next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç¬¬ 2 æ­¥ï¼šä» pre å†èµ° right - left + 1 æ­¥ï¼Œæ¥åˆ° right èŠ‚ç‚¹</span></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">rightNode</span> <span class="operator">=</span> pre;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; right - left + <span class="number">1</span>; i++) &#123;</span><br><span class="line">            rightNode = rightNode.next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç¬¬ 3 æ­¥ï¼šåˆ‡æ–­å‡ºä¸€ä¸ªå­é“¾è¡¨ï¼ˆæˆªå–é“¾è¡¨ï¼‰</span></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">leftNode</span> <span class="operator">=</span> pre.next;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">curr</span> <span class="operator">=</span> rightNode.next;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ³¨æ„ï¼šåˆ‡æ–­é“¾æ¥</span></span><br><span class="line">        pre.next = <span class="literal">null</span>;</span><br><span class="line">        rightNode.next = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç¬¬ 4 æ­¥ï¼šåŒç¬¬ 206 é¢˜ï¼Œåè½¬é“¾è¡¨çš„å­åŒºé—´</span></span><br><span class="line">        reverseLinkedList(leftNode);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç¬¬ 5 æ­¥ï¼šæ¥å›åˆ°åŸæ¥çš„é“¾è¡¨ä¸­</span></span><br><span class="line">        pre.next = rightNode;</span><br><span class="line">        leftNode.next = curr;</span><br><span class="line">        <span class="keyword">return</span> dummyNode.next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">reverseLinkedList</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">        <span class="comment">// ä¹Ÿå¯ä»¥ä½¿ç”¨é€’å½’åè½¬ä¸€ä¸ªé“¾è¡¨</span></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> head;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (cur != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">ListNode</span> <span class="variable">next</span> <span class="operator">=</span> cur.next;</span><br><span class="line">            cur.next = pre;</span><br><span class="line">            pre = cur;</span><br><span class="line">            cur = next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="Leetcode-138-éšæœºé“¾è¡¨çš„å¤åˆ¶"><a href="#Leetcode-138-éšæœºé“¾è¡¨çš„å¤åˆ¶" class="headerlink" title="Leetcode 138.éšæœºé“¾è¡¨çš„å¤åˆ¶"></a>Leetcode 138.éšæœºé“¾è¡¨çš„å¤åˆ¶</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">// Definition for a Node.</span></span><br><span class="line"><span class="comment">class Node &#123;</span></span><br><span class="line"><span class="comment">    int val;</span></span><br><span class="line"><span class="comment">    Node next;</span></span><br><span class="line"><span class="comment">    Node random;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    public Node(int val) &#123;</span></span><br><span class="line"><span class="comment">        this.val = val;</span></span><br><span class="line"><span class="comment">        this.next = null;</span></span><br><span class="line"><span class="comment">        this.random = null;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    Map&lt;Node,Node&gt;map = <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">    <span class="keyword">public</span> Node <span class="title function_">copyRandomList</span><span class="params">(Node head)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (head == <span class="literal">null</span>)<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (!map.containsKey(head))&#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">newNode</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(head.val);</span><br><span class="line">            map.put(head,newNode);</span><br><span class="line">            newNode.next = copyRandomList(head.next);</span><br><span class="line">            newNode.random = copyRandomList(head.random);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> map.get(head);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-19-åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹"><a href="#Leetcode-19-åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹" class="headerlink" title="Leetcode 19.åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹"></a>Leetcode 19.åˆ é™¤é“¾è¡¨çš„å€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * public class ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode next;</span></span><br><span class="line"><span class="comment"> *     ListNode() &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int val) &#123; this.val = val; &#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int val, ListNode next) &#123; this.val = val; this.next = next; &#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">removeNthFromEnd</span><span class="params">(ListNode head, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">        </span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">currentNode</span> <span class="operator">=</span> head;</span><br><span class="line">        ArrayList&lt;ListNode&gt; nodes = <span class="keyword">new</span> <span class="title class_">ArrayList</span>(); </span><br><span class="line">        <span class="keyword">while</span>(currentNode!=<span class="literal">null</span>)&#123;</span><br><span class="line">            nodes.add(currentNode);</span><br><span class="line">            currentNode = currentNode.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> nodes.size();</span><br><span class="line">        <span class="keyword">if</span> (num == <span class="number">1</span>)<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(-<span class="number">1</span>,head);</span><br><span class="line">        currentNode = pre;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;num-n+<span class="number">1</span>;i++)&#123;</span><br><span class="line">            currentNode = currentNode.next;</span><br><span class="line">        &#125;</span><br><span class="line">        currentNode.next=currentNode.next.next;</span><br><span class="line">        <span class="keyword">return</span> pre.next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-82-åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´ 2"><a href="#Leetcode-82-åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´ 2" class="headerlink" title="Leetcode 82.åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´ 2"></a>Leetcode 82.åˆ é™¤æ’åºé“¾è¡¨ä¸­çš„é‡å¤å…ƒç´ 2</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">deleteDuplicates</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (head == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">dummy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">0</span>, head);</span><br><span class="line"></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> dummy;</span><br><span class="line">        <span class="keyword">while</span> (cur.next != <span class="literal">null</span> &amp;&amp; cur.next.next != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (cur.next.val == cur.next.next.val) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> cur.next.val;</span><br><span class="line">                <span class="keyword">while</span> (cur.next != <span class="literal">null</span> &amp;&amp; cur.next.val == x) &#123;</span><br><span class="line">                    cur.next = cur.next.next;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                cur = cur.next;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> dummy.next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-61-æ—‹è½¬é“¾è¡¨"><a href="#Leetcode-61-æ—‹è½¬é“¾è¡¨" class="headerlink" title="Leetcode 61.æ—‹è½¬é“¾è¡¨"></a>Leetcode 61.æ—‹è½¬é“¾è¡¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * public class ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     ListNode next;</span></span><br><span class="line"><span class="comment"> *     ListNode() &#123;&#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int val) &#123; this.val = val; &#125;</span></span><br><span class="line"><span class="comment"> *     ListNode(int val, ListNode next) &#123; this.val = val; this.next = next; &#125;</span></span><br><span class="line"><span class="comment"> * &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">rotateRight</span><span class="params">(ListNode head, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">        ArrayList&lt;ListNode&gt; nodes = <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">dumbNode</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(-<span class="number">111</span>,head);</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="keyword">while</span>(cur!=<span class="literal">null</span>)&#123;</span><br><span class="line">            nodes.add(cur);</span><br><span class="line">            cur=cur.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> nodes.size();</span><br><span class="line">        <span class="keyword">if</span> (num==<span class="number">0</span>)<span class="keyword">return</span> head;</span><br><span class="line">        k = k%num;</span><br><span class="line">        <span class="keyword">if</span> (k==<span class="number">0</span>)<span class="keyword">return</span> head;</span><br><span class="line">        <span class="type">int</span> <span class="variable">preOrder</span> <span class="operator">=</span> num-k-<span class="number">1</span>;</span><br><span class="line">        cur = dumbNode;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>;i&lt;=preOrder;i++)&#123;</span><br><span class="line">            cur = cur.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">preNode</span> <span class="operator">=</span> cur;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">next</span> <span class="operator">=</span>preNode.next;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">last</span> <span class="operator">=</span> next;</span><br><span class="line">        <span class="keyword">while</span>(last!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (last.next==<span class="literal">null</span>)<span class="keyword">break</span>;</span><br><span class="line">            last = last.next;</span><br><span class="line">        &#125;</span><br><span class="line">        dumbNode.next = next;</span><br><span class="line">        last.next = head;</span><br><span class="line">        preNode.next = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">return</span> dumbNode.next;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Leetcode-146-LRUç¼“å­˜"><a href="#Leetcode-146-LRUç¼“å­˜" class="headerlink" title="Leetcode 146.LRUç¼“å­˜"></a>Leetcode 146.LRUç¼“å­˜</h3><p>ç›´æ¥ç»§æ‰¿<code>LinkedHashMap</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">LRUCache</span> <span class="keyword">extends</span> <span class="title class_">LinkedHashMap</span>&lt;Integer, Integer&gt;&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> capacity;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LRUCache</span><span class="params">(<span class="type">int</span> capacity)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(capacity, <span class="number">0.75F</span>, <span class="literal">true</span>);</span><br><span class="line">        <span class="built_in">this</span>.capacity = capacity;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">get</span><span class="params">(<span class="type">int</span> key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.getOrDefault(key, -<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(<span class="type">int</span> key, <span class="type">int</span> value)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.put(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">boolean</span> <span class="title function_">removeEldestEntry</span><span class="params">(Map.Entry&lt;Integer, Integer&gt; eldest)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> size() &gt; capacity; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å“ˆå¸Œ+åŒé“¾è¡¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LRUCache</span> &#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">DLinkedNode</span> &#123;</span><br><span class="line">        <span class="type">int</span> key;</span><br><span class="line">        <span class="type">int</span> value;</span><br><span class="line">        DLinkedNode prev;</span><br><span class="line">        DLinkedNode next;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">DLinkedNode</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">DLinkedNode</span><span class="params">(<span class="type">int</span> _key, <span class="type">int</span> _value)</span> &#123;key = _key; value = _value;&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;Integer, DLinkedNode&gt; cache = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;Integer, DLinkedNode&gt;();</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> size;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> capacity;</span><br><span class="line">    <span class="keyword">private</span> DLinkedNode head, tail;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LRUCache</span><span class="params">(<span class="type">int</span> capacity)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.size = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">this</span>.capacity = capacity;</span><br><span class="line">        <span class="comment">// ä½¿ç”¨ä¼ªå¤´éƒ¨å’Œä¼ªå°¾éƒ¨èŠ‚ç‚¹</span></span><br><span class="line">        head = <span class="keyword">new</span> <span class="title class_">DLinkedNode</span>();</span><br><span class="line">        tail = <span class="keyword">new</span> <span class="title class_">DLinkedNode</span>();</span><br><span class="line">        head.next = tail;</span><br><span class="line">        tail.prev = head;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">get</span><span class="params">(<span class="type">int</span> key)</span> &#123;</span><br><span class="line">        <span class="type">DLinkedNode</span> <span class="variable">node</span> <span class="operator">=</span> cache.get(key);</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¦‚æœ key å­˜åœ¨ï¼Œå…ˆé€šè¿‡å“ˆå¸Œè¡¨å®šä½ï¼Œå†ç§»åˆ°å¤´éƒ¨</span></span><br><span class="line">        moveToHead(node);</span><br><span class="line">        <span class="keyword">return</span> node.value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(<span class="type">int</span> key, <span class="type">int</span> value)</span> &#123;</span><br><span class="line">        <span class="type">DLinkedNode</span> <span class="variable">node</span> <span class="operator">=</span> cache.get(key);</span><br><span class="line">        <span class="keyword">if</span> (node == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœ key ä¸å­˜åœ¨ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„èŠ‚ç‚¹</span></span><br><span class="line">            <span class="type">DLinkedNode</span> <span class="variable">newNode</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DLinkedNode</span>(key, value);</span><br><span class="line">            <span class="comment">// æ·»åŠ è¿›å“ˆå¸Œè¡¨</span></span><br><span class="line">            cache.put(key, newNode);</span><br><span class="line">            <span class="comment">// æ·»åŠ è‡³åŒå‘é“¾è¡¨çš„å¤´éƒ¨</span></span><br><span class="line">            addToHead(newNode);</span><br><span class="line">            ++size;</span><br><span class="line">            <span class="keyword">if</span> (size &gt; capacity) &#123;</span><br><span class="line">                <span class="comment">// å¦‚æœè¶…å‡ºå®¹é‡ï¼Œåˆ é™¤åŒå‘é“¾è¡¨çš„å°¾éƒ¨èŠ‚ç‚¹</span></span><br><span class="line">                <span class="type">DLinkedNode</span> <span class="variable">tail</span> <span class="operator">=</span> removeTail();</span><br><span class="line">                <span class="comment">// åˆ é™¤å“ˆå¸Œè¡¨ä¸­å¯¹åº”çš„é¡¹</span></span><br><span class="line">                cache.remove(tail.key);</span><br><span class="line">                --size;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœ key å­˜åœ¨ï¼Œå…ˆé€šè¿‡å“ˆå¸Œè¡¨å®šä½ï¼Œå†ä¿®æ”¹ valueï¼Œå¹¶ç§»åˆ°å¤´éƒ¨</span></span><br><span class="line">            node.value = value;</span><br><span class="line">            moveToHead(node);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">addToHead</span><span class="params">(DLinkedNode node)</span> &#123;</span><br><span class="line">        node.prev = head;</span><br><span class="line">        node.next = head.next;</span><br><span class="line">        head.next.prev = node;</span><br><span class="line">        head.next = node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">removeNode</span><span class="params">(DLinkedNode node)</span> &#123;</span><br><span class="line">        node.prev.next = node.next;</span><br><span class="line">        node.next.prev = node.prev;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">moveToHead</span><span class="params">(DLinkedNode node)</span> &#123;</span><br><span class="line">        removeNode(node);</span><br><span class="line">        addToHead(node);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> DLinkedNode <span class="title function_">removeTail</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DLinkedNode</span> <span class="variable">res</span> <span class="operator">=</span> tail.prev;</span><br><span class="line">        removeNode(res);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æ‹“æ‰‘æ’åº"><a href="#æ‹“æ‰‘æ’åº" class="headerlink" title="æ‹“æ‰‘æ’åº"></a>æ‹“æ‰‘æ’åº</h2><h3 id="Leetcode-115-åºåˆ—é‡å»º"><a href="#Leetcode-115-åºåˆ—é‡å»º" class="headerlink" title="Leetcode 115.åºåˆ—é‡å»º"></a>Leetcode 115.åºåˆ—é‡å»º</h3><p>è¯æ˜æŒºç²¾å½©çš„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">sequenceReconstruction</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span>[][] sequences)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="type">int</span>[] indegrees = <span class="keyword">new</span> <span class="title class_">int</span>[n + <span class="number">1</span>];</span><br><span class="line">        Set&lt;Integer&gt;[] graph = <span class="keyword">new</span> <span class="title class_">Set</span>[n + <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            graph[i] = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;Integer&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span>[] sequence : sequences) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">size</span> <span class="operator">=</span> sequence.length;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; size; i++) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">prev</span> <span class="operator">=</span> sequence[i - <span class="number">1</span>], next = sequence[i];</span><br><span class="line">                <span class="keyword">if</span> (graph[prev].add(next)) &#123;</span><br><span class="line">                    indegrees[next]++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Queue&lt;Integer&gt; queue = <span class="keyword">new</span> <span class="title class_">ArrayDeque</span>&lt;Integer&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (indegrees[i] == <span class="number">0</span>) &#123;</span><br><span class="line">                queue.offer(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (!queue.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (queue.size() &gt; <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> queue.poll();</span><br><span class="line">            Set&lt;Integer&gt; set = graph[num];</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> next : set) &#123;</span><br><span class="line">                indegrees[next]--;</span><br><span class="line">                <span class="keyword">if</span> (indegrees[next] == <span class="number">0</span>) &#123;</span><br><span class="line">                    queue.offer(next);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å †"><a href="#å †" class="headerlink" title="å †"></a>å †</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;List&lt;Integer&gt;&gt; <span class="title function_">kSmallestPairs</span><span class="params">(<span class="type">int</span>[] nums1, <span class="type">int</span>[] nums2, <span class="type">int</span> k)</span> &#123;</span><br><span class="line">        PriorityQueue&lt;<span class="type">int</span>[]&gt; pq = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;(k, (o1, o2)-&gt;&#123;</span><br><span class="line">            <span class="keyword">return</span> nums1[o1[<span class="number">0</span>]] + nums2[o1[<span class="number">1</span>]] - nums1[o2[<span class="number">0</span>]] - nums2[o2[<span class="number">1</span>]];</span><br><span class="line">        &#125;);</span><br><span class="line">        List&lt;List&lt;Integer&gt;&gt; ans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">int</span> <span class="variable">m</span> <span class="operator">=</span> nums1.length;</span><br><span class="line">        <span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> nums2.length;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; Math.min(m, k); i++) &#123;</span><br><span class="line">            pq.offer(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;i,<span class="number">0</span>&#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (k-- &gt; <span class="number">0</span> &amp;&amp; !pq.isEmpty()) &#123;</span><br><span class="line">            <span class="type">int</span>[] idxPair = pq.poll();</span><br><span class="line">            List&lt;Integer&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">            list.add(nums1[idxPair[<span class="number">0</span>]]);</span><br><span class="line">            list.add(nums2[idxPair[<span class="number">1</span>]]);</span><br><span class="line">            ans.add(list);</span><br><span class="line">            <span class="keyword">if</span> (idxPair[<span class="number">1</span>] + <span class="number">1</span> &lt; n) &#123;</span><br><span class="line">                pq.offer(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;idxPair[<span class="number">0</span>], idxPair[<span class="number">1</span>] + <span class="number">1</span>&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åšå®¢ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
            <tag> Java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºåŠ¨æ€è§„åˆ’/æ€§ä»·æ¯”/èƒŒåŒ…é—®é¢˜çš„æ€è€ƒ</title>
      <link href="/2024/06/24/%E5%85%B3%E4%BA%8E%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%20%E6%80%A7%E4%BB%B7%E6%AF%94%E9%97%AE%E9%A2%98%20%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98%E7%9A%84%E6%80%9D%E8%80%83/"/>
      <url>/2024/06/24/%E5%85%B3%E4%BA%8E%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%20%E6%80%A7%E4%BB%B7%E6%AF%94%E9%97%AE%E9%A2%98%20%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98%E7%9A%84%E6%80%9D%E8%80%83/</url>
      
        <content type="html"><![CDATA[<h1 id="å…³äºåŠ¨æ€è§„åˆ’-æ€§ä»·æ¯”-èƒŒåŒ…é—®é¢˜çš„æ€è€ƒ"><a href="#å…³äºåŠ¨æ€è§„åˆ’-æ€§ä»·æ¯”-èƒŒåŒ…é—®é¢˜çš„æ€è€ƒ" class="headerlink" title="å…³äºåŠ¨æ€è§„åˆ’&#x2F;æ€§ä»·æ¯”&#x2F;èƒŒåŒ…é—®é¢˜çš„æ€è€ƒ"></a>å…³äºåŠ¨æ€è§„åˆ’&#x2F;æ€§ä»·æ¯”&#x2F;èƒŒåŒ…é—®é¢˜çš„æ€è€ƒ</h1><p>01èƒŒåŒ…æœ¬è´¨ä¸Šå°±å¯ä»¥ç”¨ç©ºé—´æ¢æ—¶é—´ï¼ŒåŠ¨è§„æœ¬è´¨ä¸Šä¹Ÿæ˜¯é‚£ç©ºé—´æ¢æ—¶é—´ï¼Œæœ¬èº«ä¹Ÿå°±æ˜¯ä¸€ä¸ªè´ªå¿ƒç®—æ³•ï¼Œæ‰€ä»¥<br>01èƒŒåŒ…&lt;â€“&gt;è´ªå¿ƒ&lt;â€“&gt;åŠ¨æ€è§„åˆ’</p><p>å¦‚æœè¯´æ˜¯0-1èƒŒåŒ…é—®é¢˜ï¼Œéœ€è¦é€†åºæ›´æ–°ï¼ŒåŸå› æ˜¯ä¸œè¥¿åªæœ‰ä¸€ä¸ªï¼Œä¸èƒ½å½±å“ä¹‹å‰çš„éƒ¨åˆ†</p><p>å¦‚æœæ˜¯ä¸œè¥¿æœ‰æ— æ•°ä¸ªï¼Œåˆ™ç›´æ¥é¡ºåºæ›´æ–°</p><p>å¦‚æœä¸œè¥¿æ˜¯ç‰›å¥¶ä¹‹ç±»çš„ï¼Œæœ‰æ€§ä»·æ¯”ï¼Œå¹¶ä¸”å¯ä»¥ä¹°éæ•´æ•°æ•°é‡çš„ï¼Œå¯ä»¥é€€åŒ–ä¸ºè´ªå¿ƒæ¥åšï¼Œç»“æ„ä½“ï¼šæ•°é‡ï¼Œä»·æ ¼ï¼Œæ€§ä»·æ¯”ï¼Œsortä¸€ä¸‹å°±å®Œäº‹å„¿äº†ã€‚</p><p>è®²ç©¶åºåˆ—ï¼ˆæ’åˆ—é—®é¢˜ï¼‰ï¼Œå…ˆéå†èƒŒåŒ…ï¼Œä¸è¦æ±‚åºåˆ—ï¼ˆç»„åˆé—®é¢˜ï¼‰ï¼Œå…ˆéå†ç‰©å“</p><p>æ»šåŠ¨æ•°ç»„</p><p>å¦å¤–ï¼Œ0-1èƒŒåŒ…è¦æ±‚å€’åºï¼Œè‹¥è¦æ±‚ç»„åˆè€Œéæ’åˆ—ï¼Œå³ä¸ºå…ˆç‰©å“ï¼Œå†èƒŒåŒ…ï¼Œä¸”å€’é¡ºåºï¼Œæ»šåŠ¨æ•°ç»„æ·»åŠ </p><p>è€Œä¸”ï¼Œå¦‚æœæ˜¯ç®—æœ‰å¤šå°‘ç§ï¼Œç›´æ¥åŠ å°±è¡Œ,dp[0]&#x3D;1ï¼Œå…¶ä»–ä¸º0</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dp[j]+=dp[j-nums[i]]</span><br><span class="line">    <span class="comment">//è¿™é‡Œæ€ä¹ˆå»ç†è§£å‘¢ï¼Œä¼šå¯¼è‡´é‡å¤å—ï¼Ÿ</span></span><br><span class="line">    <span class="comment">//ä¸ä¼šé‡å¤</span></span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯è¦ç®—æœ€å¤š&#x2F;æœ€å°‘ï¼Œè¿˜è¦minå’Œmaxæ¯”è¾ƒ</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dp[j]=<span class="built_in">max</span>(dp[j],dp[j-nums[i]]+value[i])</span><br></pre></td></tr></table></figure><p>[(425æ¡æ¶ˆæ¯) èƒŒåŒ…é—®é¢˜ï¼ˆèƒŒåŒ…ä¹è®²ï¼‰_ä½ å¥½ä¸–ç•Œwxxçš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/weixin_42638946/article/details/114028588?ops_request_misc=%7B%22request_id%22:%22167933155516800186567314%22,%22scm%22:%2220140713.130102334.pc_all.%22%7D&request_id=167933155516800186567314&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~pc_rank_34-6-114028588-null-null.142%5Ev74%5Epc_new_rank,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&utm_term=01%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98">https://blog.csdn.net/weixin_42638946/article/details/114028588?ops_request_misc=%7B%22request%5Fid%22%3A%22167933155516800186567314%22%2C%22scm%22%3A%2220140713.130102334.pc%5Fall.%22%7D&amp;request_id=167933155516800186567314&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~pc_rank_34-6-114028588-null-null.142^v74^pc_new_rank,201^v4^add_ask,239^v2^insert_chatgpt&amp;utm_term=01èƒŒåŒ…é—®é¢˜</a> å‡‘æ•´&amp;spm&#x3D;1018.2226.3001.4187)</p><h2 id="01èƒŒåŒ…"><a href="#01èƒŒåŒ…" class="headerlink" title="01èƒŒåŒ…"></a>01èƒŒåŒ…</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Created by WXX on 2021/2/24 14:36</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1010</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> v[N], w[N];</span><br><span class="line"><span class="type">int</span> f[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cin &gt;&gt; v[i] &gt;&gt; w[i];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = m; j &gt;= v[i]; j--) <span class="comment">//å€’å™</span></span><br><span class="line">            f[j] = <span class="built_in">max</span>(f[j], f[j - v[i]] + w[i]);</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; f[m] &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="å®Œå…¨èƒŒåŒ…"><a href="#å®Œå…¨èƒŒåŒ…" class="headerlink" title="å®Œå…¨èƒŒåŒ…"></a>å®Œå…¨èƒŒåŒ…</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Created by WXX on 2021/2/24 15:21</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1010</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> v[N], w[N];</span><br><span class="line"><span class="type">int</span> f[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cin &gt;&gt; v[i] &gt;&gt; w[i];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = v[i]; j &lt;= m; j++)<span class="comment">//é¡ºåº</span></span><br><span class="line">            f[j] = <span class="built_in">max</span>(f[j], f[j - v[i]] + w[i]);</span><br><span class="line">    cout &lt;&lt; f[m] &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="å¤šé‡èƒŒåŒ…"><a href="#å¤šé‡èƒŒåŒ…" class="headerlink" title="å¤šé‡èƒŒåŒ…"></a>å¤šé‡èƒŒåŒ…</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Created by WXX on 2021/2/24 16:07</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">110</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> v[N], w[N], s[N];</span><br><span class="line"><span class="type">int</span> f[N][N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++) cin &gt;&gt; v[i] &gt;&gt; w[i] &gt;&gt; s[i];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)  <span class="comment">// å…ˆå¾ªç¯ç‰©å“</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt;= m; j++)  <span class="comment">// å†å¾ªç¯å®¹é‡</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt;= s[i] &amp;&amp; k * v[i] &lt;= j; k++)  <span class="comment">// æœ€åå¾ªç¯å†³ç­–</span></span><br><span class="line">                f[i][j] = <span class="built_in">max</span>(f[i][j], f[i - <span class="number">1</span>][j - k * v[i]] + k * w[i]);</span><br><span class="line">    cout &lt;&lt; f[n][m] &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> åšå®¢ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
            <tag> Java </tag>
            
            <tag> C++ </tag>
            
            <tag> è´ªå¿ƒ </tag>
            
            <tag> åŠ¨æ€è§„åˆ’ </tag>
            
            <tag> èƒŒåŒ…é—®é¢˜ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¿ç ”å¤ä»¤è¥ä»–äººç»éªŒæ€»ç»“</title>
      <link href="/2024/06/24/%E4%BF%9D%E7%A0%94%E8%B5%84%E6%BA%90/"/>
      <url>/2024/06/24/%E4%BF%9D%E7%A0%94%E8%B5%84%E6%BA%90/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¿ç ”å¤ä»¤è¥"><a href="#ä¿ç ”å¤ä»¤è¥" class="headerlink" title="ä¿ç ”å¤ä»¤è¥"></a><strong>ä¿ç ”å¤ä»¤è¥</strong></h1><h2 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a><strong>å‡†å¤‡</strong></h2><ul><li>CSPï¼Œæœ€å¥½300+ï¼Ÿï¼ˆ<strong>å¯¹äºåŒ—èˆªæœ‰æ•ˆ</strong>ï¼‰</li><li>æŠ¥åä¸€èˆ¬5æœˆå¼€å§‹ï¼Œè”ç³»è€å¸ˆå»ºè®®4æœˆ</li></ul><h2 id="å…¥è¥"><a href="#å…¥è¥" class="headerlink" title="å…¥è¥"></a><strong>å…¥è¥</strong></h2><ul><li>ä¸»è¦çœ‹<strong>æˆç»©</strong>ï¼Œ<strong>é«˜è´¨é‡ç§‘ç ”</strong>æˆæœåŠ åˆ†ï¼Œå®ä¹ ç»å†ã€è·å¥–<strong>æ— ç”¨</strong>ï¼Œå…¥è¥åæˆç»©å½±å“ä¸å¤§ï¼ˆrank1å¯åŠ <strong>å°è±¡åˆ†</strong>ï¼‰â€”â€”éƒ‘åšæ–‡</li><li>æ¸…åŒ—ä¸Šäº¤å­¦ç¡•rank1éƒ½ä¸ä¸€å®šè¿›å¾—å»</li><li>éƒ½ç•™ç»™æœ¬æ ¡å­¦ç”Ÿäº†</li><li>å¤æ—¦å¡rank1</li><li>å—å¤§æ¯”è¾ƒæµ·rank5&#x2F;6å¥½åƒå°±è¡Œ</li><li>ä¸­ç§‘å¤§æœ‰ç‚¹æ­§è§†éè®¡ç§‘å‡ºèº«ï¼Œè½¯é™¢å…¥è¥çœ‹è¿æ°”</li><li>è‡ªåŠ¨åŒ–æ‰€è¦rank1&#x2F;2</li><li>è®¡ç®—æ‰€è”ç³»è€å¸ˆ</li><li>æ¸…æ·±çƒ­é—¨ä¸“ä¸šä¹Ÿæ¯”è¾ƒéš¾å…¥</li><li>å…¶ä»–æ–¹å‘è¿˜å¥½</li><li>åŒ—å¤§æ•´ä¸ªéƒ½æ˜¯è”ç³»è€å¸ˆæµçš„</li><li>æµ™å¤§å¤ä»¤è¥æ²¡æœ‰å­¦ç¡•ï¼Œå°±ä¸è¯´äº†</li><li>æ¸…åä¹Ÿæ²¡å­¦ç¡•ï¼Œç›´åšä¹Ÿä¸ç»™offer</li><li>äººå¤§é«˜ç“´è¦rank1&#x2F;2        â€”â€”éƒ‘åšæ–‡</li></ul><h2 id="æœºè¯•"><a href="#æœºè¯•" class="headerlink" title="æœºè¯•"></a><strong>æœºè¯•</strong></h2><ul><li>éå¸¸ä¸æ¨èåŠ›æ‰£ï¼ˆä¸éœ€è¦è‡ªå·±è®¾è®¡æ•°æ®ç»“æ„ã€ä¸éœ€è¦è‡ªå·±å¤„ç†è¾“å…¥è¾“å‡ºï¼‰ï¼Œä¸æ¨èå…¶ä»–è¯­è¨€</li><li>è¯­è¨€ï¼š<strong>C++</strong>        å¹³å°ï¼š<strong>æ´›è°·ã€AcWing</strong>        â€”â€”éƒ‘åšæ–‡</li><li>ç‹ æŠ“ï¼Œå› ä¸ºå¾ˆå¤šå­¦æ ¡éƒ½å› ä¸ºè¿™ä¸ªåˆç­›ï¼Œäººå·¥æ™ºèƒ½æœºè¯•å·ä¸­å·ï¼Œå°½é‡ç°åœ¨å°±è¿èµ·æ¥  leetcodeï¼ˆä¸»è¦çœ‹æ€æƒ³ï¼‰ patè¦ç›¸å¯¹éš¾ä¸€ç‚¹ï¼Œé‡ç‚¹ï¼ï¼ï¼è¦çœ‹è¾“å…¥è¾“å‡ºï¼›åœ¨ä¿ç ”æˆç»©ç¨³çš„æƒ…å†µä¸‹ï¼Œå‡†å¤‡æœºè¯•ï¼ˆæˆ‘æ‘”äº†å¾ˆå¤šæ¬¡çš„åœ°æ–¹ä¸€å®šè¦åœ¨å¼ºè°ƒå¾ˆå¤šéï¼‰ æ•°æ®ç»“æ„â€”â€”åˆ˜æ¬£å®‡</li><li>è®¡ç®—æ‰€æœºè¯•viplå®éªŒå®¤å¦‚æœç”¨c++çš„è¯  ä¸èƒ½è°ƒç”¨stlåº“  è€ƒçš„ä¹Ÿå°±æ˜¯ç”¨cå®ç°äº†  å…¶ä»–çš„éƒ½æ˜¯å¯ä»¥è°ƒç”¨åº“çš„â€”â€”åˆ˜æ¬£å®‡</li><li>æœ‰ä¸€æœ¬ç‹é“æœºè¯•æŒ‡å—  ä½ å¯ä»¥æ‰¾æ‰¾ç”µå­ç‰ˆ  é‡Œé¢é¢˜å¾ˆç»å…¸ å‰é¢çš„æ¯”è¾ƒç®€å•  å°½é‡æ—©ç‚¹è¿‡  åé¢å›¾è®ºä¹Ÿæ¯”è¾ƒå®¹æ˜“è€ƒï¼Œç®—æ³•é‡Œé¢å¾ˆçˆ±è€ƒè´ªå¿ƒ  åŠ¨æ€è§„åˆ’ï¼Œä½ ä¹Ÿå¯ä»¥çœ‹çœ‹æ—¶é—´å‡½æ•°  æˆ‘é‡åˆ°è¿‡ä¸¤æ¬¡æœºè¯•  æ˜¯è€ƒæ—¶é—´çš„  é¢˜ç›®å¤§æ¦‚æ˜¯  ä¸Šç­æ‰“å¡ï¼Œä¸‹ç­ä¹Ÿè¦æ‰“å¡ï¼Œæ‰“å¡æ–¹å¼æœ‰å¾ˆå¤šç§ï¼Œä½†æ˜¯éƒ½æ˜¯åŒä¸€ä¸ªäººçš„ï¼Œè¿™ä¸ªäººä¼šè¿›å‡ºå…¬å¸ï¼Œçœ‹è°ç´¯è®¡ä¸Šç­æ—¶é—´é•¿ â€”â€”åˆ˜æ¬£å®‡</li></ul><h2 id="ç¬”è¯•"><a href="#ç¬”è¯•" class="headerlink" title="ç¬”è¯•"></a><strong>ç¬”è¯•</strong></h2><ul><li>çœ‹æ˜¯è®¡ç®—æœºå­¦é™¢è¿˜æ˜¯aiå­¦é™¢ï¼Œæ•°æ®ç»“æ„æ¯”è¾ƒé‡è§†ï¼Œå…¶ä»–ä¸‰é—¨ä¸“ä¸šè¯¾ä¸»è¦çœ‹çŸ¥è¯†ç‚¹ï¼Œæ•°æ®ç»“æ„åˆ·äº†ä¸€æœ¬ç‹é“        â€”â€”éƒ‘åšæ–‡</li><li>å¤§å¤šæ•°å­¦æ ¡æ²¡æœ‰ç¬”è¯•ï¼Œå—å¤§ã€è®¡ç®—æ‰€æœ‰ï¼Œå—å¤§éš¾ï¼Œè€ƒåº•å±‚ï¼Œè®¡ç®—æ‰€  æœ‰å•ç‹¬çš„æ•°å­¦è€ƒè¯•ï¼ˆä»–è¿˜è€ƒäº†å°‘é‡çš„å¾®ç§¯åˆ†  æå°‘æå°‘ï¼‰â€”â€”åˆ˜æ¬£å®‡</li></ul><h2 id="é¢è¯•"><a href="#é¢è¯•" class="headerlink" title="é¢è¯•"></a>é¢è¯•</h2><ul><li>408å’Œæ•°å­¦ä¹Ÿè¦å¤ä¹  é¢è¯•ä¼šé—®ä½ ï¼Œ408é‡Œé¢ æ•°æ®ç»“æ„ã€‹è®¡ç½‘ã€‹æ“ä½œç³»ç»Ÿ  è®¡ç»„</li><li>å…ˆçœ‹æ•°æ®ç»“æ„  æ•°å­¦ï¼ˆçº¿ä»£å¾ˆçˆ±é—®æ­£å®šçŸ©é˜µ  æ¦‚ç‡è®ºå¾ˆçˆ±é—®å¤§æ•°å®šå¾‹å’Œä¸­å¿ƒæé™å®šç†ï¼‰ ç„¶ååœ¨çœ‹è®¡ç½‘ os ï¼Œè®¡ç»„åŸºæœ¬ä¸Šæ²¡é—®â€”â€”åˆ˜æ¬£å®‡</li></ul><h2 id="ç§‘ç ”"><a href="#ç§‘ç ”" class="headerlink" title="ç§‘ç ”"></a><strong>ç§‘ç ”</strong></h2><ul><li>æœ€å¥½æ‰¾ä¸ª<strong>å¤–æ ¡</strong>çš„å®éªŒå®¤ï¼Œ<strong>è®¡é™¢</strong>çš„ä¹Ÿè¡Œï¼Œæœ¬æ ¡å®éªŒå®¤ä¸ç®—å®ä¹ ï¼Œä½†å¯ä»¥è®©è€å¸ˆå¸®æŒ‚å…¬å¸</li><li>ä¸€å®šè¦<strong>é«˜è´¨é‡</strong>ç§‘ç ”æˆæœ        â€”â€”éƒ‘åšæ–‡</li></ul><h2 id="å¿ƒæ€"><a href="#å¿ƒæ€" class="headerlink" title="å¿ƒæ€"></a>å¿ƒæ€</h2><ul><li>çªç„¶æƒ³èµ·æ¥  å¿ƒæ€ä¹Ÿå¾ˆé‡è¦  æœ‰å¯èƒ½å¤ä»¤è¥å•¥ä¹Ÿæ²¡æ‹¿åˆ°  æˆ–è€…åªæœ‰ä¸€ä¸ª  ä½†æ˜¯åˆ«æ…Œ é¢„æ¨å…è¿˜æœ‰  é¢„æ¨å…å…ˆéƒ½æŠ¥ä¸Š  å¦‚åªè¦èƒ½é¢è¯•  å°±æœ‰å¾ˆå¤§æ¦‚ç‡å€™è¡¥åˆ°  ä¸è¦å…¨éƒ½é€‰å¾ˆå¥½çš„ä¸“ä¸š  å¾ˆå®¹æ˜“è½å¾—ä¸€åœºç©º  åšä¿¡  åªè¦æˆ‘é¢è¯•äº† è‚¯å®šä¼šæœ‰å€™è¡¥åˆ°çš„æ—¶å€™ï¼›ä»Šå¹´æµ™è½¯  å—å¤§è®¡ç®—æœº  åŒ—èˆªè®¡ç®—æœº å›½é˜²ç§‘å¤§éƒ½å¿«è¢«é¸½ç©¿äº† â€”â€”åˆ˜æ¬£å®‡</li></ul><h2 id="ä¸€äº›æ–‡ç« é“¾æ¥"><a href="#ä¸€äº›æ–‡ç« é“¾æ¥" class="headerlink" title="ä¸€äº›æ–‡ç« é“¾æ¥"></a>ä¸€äº›æ–‡ç« é“¾æ¥</h2><p><a href="https://blog.csdn.net/mengwuyaaa/article/details/82918032?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-1-82918032-blog-125315403.pc_relevant_vip_default&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Rate-1-82918032-blog-125315403.pc_relevant_vip_default&utm_relevant_index=2">https://blog.csdn.net/mengwuyaaa/article/details/82918032?spm=1001.2101.3001.6650.1&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-1-82918032-blog-125315403.pc_relevant_vip_default&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-1-82918032-blog-125315403.pc_relevant_vip_default&amp;utm_relevant_index=2</a></p><h1 id="ç»éªŒè´´çš„ä¸€äº›é˜…è¯»"><a href="#ç»éªŒè´´çš„ä¸€äº›é˜…è¯»" class="headerlink" title="ç»éªŒè´´çš„ä¸€äº›é˜…è¯»"></a>ç»éªŒè´´çš„ä¸€äº›é˜…è¯»</h1><h2 id="äººå“"><a href="#äººå“" class="headerlink" title="äººå“"></a>äººå“</h2><p>å¯¼å¸ˆäººå“æœ€é‡è¦ï¼Œåƒä¸‡ä¸è¦å»å‘å¯¼ç›´åšï¼Œå³ä½¿æ˜¯æ¸…åŒ—çš„ã€‚</p><p>å¯ä»¥å…ˆå»å¯¼å¸ˆè¯„ä»·ç½‘æ‰¾æ‰¾ï¼Œç›®å‰å¯ç”¨çš„æœ‰ <a href="https://link.zhihu.com/?target=https://www.yankong.org/">ç ”æ§</a> ã€<a href="https://link.zhihu.com/?target=https://www.daoshipingjia.xyz/">ç¡•åšå¯¼å¸ˆè¯„ä»·ç½‘</a>ï¼Œå¦å¤–æˆ‘è¿™é‡Œè¿˜æœ‰å¯¼å¸ˆè¯„ä»·ç½‘åå°æ•°æ®åº“ excelï¼ˆåŒ…å«å…¨å›½å„å¤§é™¢æ ¡ 1 ä¸‡æ¡å¯¼å¸ˆè¯„ä»·ä¿¡æ¯ï¼‰ï¼Œä»¥åŠä¸Šäº¤ç”µé™¢å¯¼å¸ˆè¯„ä»·ï¼Œä¸æ–¹ä¾¿å‘ï¼Œéœ€è¦çš„è¯å¯ä»¥ç§æˆ³ã€‚</p><p>ç„¶åå°±æ˜¯åœ¨ç™¾åº¦ã€è°·æ­Œä¸Šæœï¼Œè¿˜å¯ä»¥å»é—®ç»„å†… &#x2F; éš”å£ç»„å­¦é•¿å­¦å§ã€‚å¦‚ä½•è”ç³»å­¦é•¿å­¦å§ï¼Ÿ<strong>ä¸€ç§æ–¹æ³•æ˜¯æ‰¾æœ¬æ ¡ä¿ç ”åˆ°è¯¥æ ¡æˆ–åœ¨ç»¿ç¾¤æ‰¾åˆ°ä¿ç ”åˆ°è¯¥æ ¡çš„å­¦é•¿å­¦å§ï¼Œè¯·ä»–ä»‹ç»ä»‹ç»ï¼›å¦ä¸€ç§æ–¹æ³•æ˜¯é€šè¿‡å¯¼å¸ˆçš„è®ºæ–‡ï¼Œæ¨æµ‹å‡ºå­¦é•¿å­¦å§çš„åå­—ï¼Œç„¶ååœ¨è®ºæ–‡ç½‘ç«™é‡Œæ‰¾é‚®ç®±å‘é‚®ä»¶é—®ã€‚æ³¨æ„è¦å…¼å¬åˆ™æ˜</strong></p><h2 id="ä¸“ä¸šè¯¾æ€ä¹ˆå¤ä¹ "><a href="#ä¸“ä¸šè¯¾æ€ä¹ˆå¤ä¹ " class="headerlink" title="ä¸“ä¸šè¯¾æ€ä¹ˆå¤ä¹ "></a>ä¸“ä¸šè¯¾æ€ä¹ˆå¤ä¹ </h2><p>å¦‚æœæ—¶é—´ä¸æ˜¯å¾ˆå……è£•ï¼Œä¸è¦å…¨é¢æ’’ç½‘ï¼Œæ¯é—¨è¯¾è¦å¤ä¹ çš„ä¹Ÿå°±ä¸€äºŒåä¸ªå¸¸è§é—®é¢˜ï¼Œæ‰¾æ‰¾ä¿ç ” &#x2F; è€ƒç ”é¢è¯•é‡ç‚¹é—®é¢˜æ¥çœ‹çœ‹å°±è¡Œã€‚</p><p>è¦å¤ä¹ çš„è¯¾æœ‰ï¼š</p><ul><li>æ•°å­¦ï¼šçº¿æ€§ä»£æ•°ã€æ¦‚ç‡è®ºã€é«˜æ•°</li><li>è®¡ç®—æœºï¼šæ•°æ®ç»“æ„ã€è®¡ç»„ã€æ“ä½œç³»ç»Ÿã€è®¡ç½‘ã€ç®—æ³•ã€æ•°æ®åº“ã€è½¯ä»¶å·¥ç¨‹ã€ç¼–è¯‘åŸç†ã€ç¼–ç¨‹è¯­è¨€</li><li>äººå·¥æ™ºèƒ½ï¼šæœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ </li></ul><p>æ³¨æ„è¿™äº›è¯¾ä¸å¿…å®Œå…¨å¤ä¹ ï¼ŒæŒ‘å‡ é—¨å’Œç ”ç©¶æ–¹å‘ç›¸å…³çš„çœ‹çœ‹é‡ç‚¹å°±è¡Œï¼Œæ¯”å¦‚å¯¹äº AI æ–¹å‘ï¼Œæœ€é‡è¦çš„æ˜¯æ•°å­¦ã€æ•°æ®ç»“æ„ã€äººå·¥æ™ºèƒ½ã€‚</p><h2 id="æ²¡æœ‰ç§‘ç ”ç»å†å’‹åŠ"><a href="#æ²¡æœ‰ç§‘ç ”ç»å†å’‹åŠ" class="headerlink" title="æ²¡æœ‰ç§‘ç ”ç»å†å’‹åŠ"></a>æ²¡æœ‰ç§‘ç ”ç»å†å’‹åŠ</h2><p>å’Œè€å¸ˆæ–¹å‘ä¸€è‡´çš„ç§‘ç ”ç»å†éå¸¸é‡è¦ï¼Œå³ä½¿æ²¡æœ‰äº§å‡ºè®ºæ–‡ï¼Œä¹Ÿæ˜¯å·¨å¤§çš„åŠ åˆ†é¡¹ï¼Œè¿™å°±åƒå»æ‰¾å·¥ä½œï¼Œå®ä¹ ç»å†æ˜¯å·¨å¤§çš„åŠ åˆ†é¡¹ä¸€æ ·ã€‚</p><p>å¦‚æœä½ ç°åœ¨æ˜¯å¤§ä¸‰ä¸‹å­¦æœŸå¼€å­¦ä¹‹å‰çš„è¯ï¼Œå¯ä»¥å»è”ç³»æœ¬æ ¡è€å¸ˆè¿›å®éªŒå®¤åšç§‘ç ”ã€‚å¦‚æœå·²ç»å¾ˆæ™šäº†ï¼Œå¦‚å…­æœˆä»½äº†ï¼Œå¯ä»¥å»æ‰¾ä¸€äº›è®ºæ–‡ï¼Œå¤ç°æˆ–è€…è¯»æ‡‚ä»£ç ï¼ŒæŒæ¡å¥½ç»†èŠ‚ï¼ŒåŒ…è£…æˆä¸€ä¸ªé¡¹ç›®ï¼Œè€—æ—¶åŠä¸ªæœˆå·¦å³ï¼Œå‰ææ˜¯ä¸èƒ½è¢«é—®ç©¿ï¼Œå¾—ç­”å¾—ä¸Šæ¥ã€‚</p><p>ä¸€æ®µç§‘ç ”ç»å†ï¼Œè€å¸ˆæ›´å…³æ³¨ä½ åšäº†ä»€ä¹ˆï¼Œè€Œä¸æ˜¯è¿™ä¸ªç§‘ç ”åšçš„ç»“æœã€‚è¦è®²å¥½ä¸€ä¸ªé¡¹ç›®ï¼Œéœ€è¦è®²å¥½ motivationï¼ˆä¸ºä»€ä¹ˆåšï¼‰ã€methodï¼ˆåšäº†ä»€ä¹ˆï¼‰ã€resultï¼ˆåšå¾—å’‹æ ·ï¼‰ã€contributionï¼ˆä½ åšäº†å•¥ï¼‰ï¼Œå…¶ä¸­æœ€é‡è¦çš„æ˜¯ contribution å’Œ motivationã€‚ä¸è¦è¯´å¾—å¤ªç›´ç™½ï¼Œå°½é‡å­¦æœ¯åŒ–ä¸€ç‚¹ã€‚ï¼ˆå¯ä»¥å‚è€ƒé¡¶ä¼šè®ºæ–‡çš„ Introductionï¼Œçœ‹çœ‹æ€æ ·è®²å¥½ä¸€ä¸ªæ•…äº‹ï¼‰ã€‚è€å¸ˆä¹Ÿéå¸¸å–œæ¬¢é—®ä½ çš„ç§‘ç ”é¡¹ç›®é‡Œé¢ç”¨åˆ°çš„ä¸œè¥¿çš„åº•å±‚åŸç†ï¼Œè€Œè¿™äº›ä¸œè¥¿ä½ å¯èƒ½å°±æ˜¯åœ¨ PyTorch é‡Œé¢è°ƒäº†ä¸ªåº“ï¼Œéœ€è¦æ³¨æ„ä¸€ä¸‹ã€‚</p><p>å¦‚æœæœ‰è®ºæ–‡ï¼Œè®ºæ–‡çš„å†…å®¹ã€ç»†èŠ‚ä¸€å®šè¦æ¸…æ¥šï¼Œè¿˜æœ‰ EI ä¼šè®®ä¹‹ç±»çš„æ°´æ–‡ä¸å»ºè®®å†™åœ¨ç®€å†ï¼Œå¦‚æœè¢«é—®ç©¿äº†ï¼Œå¯èƒ½æ˜¯å‡åˆ†é¡¹</p><h2 id="è¦å‡†å¤‡å“ªäº›æ–‡ä¹¦"><a href="#è¦å‡†å¤‡å“ªäº›æ–‡ä¹¦" class="headerlink" title="è¦å‡†å¤‡å“ªäº›æ–‡ä¹¦"></a>è¦å‡†å¤‡å“ªäº›æ–‡ä¹¦</h2><p>æ–‡ä¹¦ææ–™çš„æ¨¡æ¿åç»­æˆ‘ä¼šæ•´ç†å‘å‡ºæ¥ã€‚</p><ul><li>ç®€å†ï¼šæ¨è <a href="https://link.zhihu.com/?target=https://www.wondercv.com/">è¶…çº§ç®€å†WonderCV</a> ï¼Œå†…å®¹å†™ä¿ç ”è¦ç´ ä¸­æ¯”è¾ƒé‡è¦çš„å°±è¡Œï¼ŒåŒ…æ‹¬ï¼šè”ç³»æ–¹å¼ã€å­¦æ ¡ã€ä¸“ä¸šã€æˆç»©ã€æ’åã€è·å¥–ã€é¡¹ç›®ã€æ•°å­¦ã€ç¼–ç¨‹ã€è‹±è¯­ã€è¯»åšæ„å‘ç­‰ï¼Œè‡ªå·±çš„åŠ£åŠ¿éƒ¨åˆ†ä¸è¦å¾€ä¸Šé¢å†™ã€‚</li><li>ä¸ªäººé™ˆè¿°ï¼šå‡†å¤‡ 1000 å­—ã€2000 å­—çš„ï¼Œå°±æ˜¯ç®€å†çš„æ‰©å……ï¼Œé‡ç‚¹æ˜¯è®²åšè¿‡çš„é¡¹ç›®ï¼Œç ”ç©¶è§„åˆ’ç­‰ã€‚</li><li>æ¨èä¿¡ï¼šå‡†å¤‡ 2 å°æ•™æˆæ¨èä¿¡å³å¯ï¼Œè¿™ä¸œè¥¿æ²¡äººçœ‹ï¼Œæ³¨æ„å¤æ—¦ã€åŒ—èˆªç­‰å­¦æ ¡éœ€æ­£æ•™æˆæ¨èä¿¡ï¼Œæ¸…åã€å¤æ—¦ç­‰å­¦æ ¡è¦æ±‚è€å¸ˆæœ¬äººåœ¨çº¿å¡«å†™æˆ–ç”¨æœ¬äººçš„é‚®ç®±å‘é€æ¨èä¿¡ã€‚</li><li>å¥—ç£ä¿¡ï¼šæ—¢è¦ç®€æ´äº†å½“ï¼Œç›´è¨€ä¸»é¢˜ï¼Œåˆä¸èƒ½ä¸å®¢å¥—ã€‚edué‚®ç®±æ¯”è¾ƒæ­£å¼ï¼Œgmailæœ‰é‚®ä»¶è¿½è¸ªæ’ä»¶mailtrackã€‚</li><li>PPTï¼šç›¸å½“äºæŠŠç®€å†è®²å‡ºæ¥ï¼Œå¤§éƒ¨åˆ†çš„ç¯‡å¹…åº”è¯¥è®²é¡¹ç›®ï¼Œå’Œå­¦ä¹ æ— å…³çš„ä¸è¦è®²å¤ªå¤šã€‚</li><li>å„ç§è¯æ˜ææ–™ï¼šæˆç»©å•ã€æ’åè¯æ˜ã€è·å¥–è¯ä¹¦ã€èº«ä»½è¯ã€å­¦ç”Ÿè¯ã€è‹±è¯­è¯æ˜ï¼Œéƒ½æ‰«ææˆpdfã€‚</li></ul><h2 id="ä¸€äº›æœ‰ç”¨çš„ç½‘ç«™"><a href="#ä¸€äº›æœ‰ç”¨çš„ç½‘ç«™" class="headerlink" title="ä¸€äº›æœ‰ç”¨çš„ç½‘ç«™"></a>ä¸€äº›æœ‰ç”¨çš„ç½‘ç«™</h2><ul><li>é‚®ä»¶è¿½è¸ªï¼šGmail æœ‰ä¸ªæ’ä»¶ mailtrackï¼Œå¯ä»¥çœ‹åˆ°ä½ å‘çš„é‚®ä»¶ä»€ä¹ˆæ—¶å€™è¢«è€å¸ˆæ‰“å¼€äº†ï¼Œæ‰“å¼€äº†å‡ æ¬¡ã€‚</li><li>æŸ¥è€å¸ˆå­¦æœ¯æ°´å¹³ï¼š<a href="https://link.zhihu.com/?target=https://scholar.google.com/">Google Scholar</a>ã€<a href="https://link.zhihu.com/?target=https://dblp.org/">dblp</a>ã€<a href="https://link.zhihu.com/?target=https://www.aminer.cn/">AMiner</a>ã€<a href="https://link.zhihu.com/?target=https://csrankings.org/%23/index?all&cn">CSRankings</a>ã€<a href="https://link.zhihu.com/?target=https://www.semanticscholar.org/">Semantic Scholar</a></li><li>æŸ¥å›½å®¶è‡ªç„¶ç§‘å­¦åŸºé‡‘ï¼š<a href="https://link.zhihu.com/?target=https://www.ceshigo.com/Nsfc/fund">æµ‹è¯•ç‹—åŸºé‡‘æŸ¥è¯¢</a>ã€<a href="https://link.zhihu.com/?target=https://grants.nsfc.gov.cn/egrantindex/funcindex/prjsearch-list">åŸºé‡‘å§”æŸ¥è¯¢ç³»ç»Ÿ</a></li><li>å¯¼å¸ˆè¯„ä»·ç½‘ï¼š<a href="https://link.zhihu.com/?target=https://www.yankong.org/">ç ”æ§</a> ã€<a href="https://link.zhihu.com/?target=https://www.daoshipingjia.xyz/">ç¡•åšå¯¼å¸ˆè¯„ä»·ç½‘</a></li><li>æœºè¯•åˆ·é¢˜å¹³å°ï¼š<a href="https://link.zhihu.com/?target=https://www.acwing.com/">AcWing</a></li><li>å¤ä»¤è¥ &#x2F; é¢„æ¨å…å¼€è¥ä¿¡æ¯ï¼š<a href="https://link.zhihu.com/?target=http://pc.baoyanwang.com.cn/">ä¿ç ”ä¿¡æ¯ç½‘</a></li><li>ä¸­ç§‘é™¢è®¡ç®—æ‰€å„å®éªŒå®¤ä»‹ç»ï¼š<a href="https://link.zhihu.com/?target=http://cskaoyan.com/thread-237791-1-2.html">ä¸­ç§‘é™¢è®¡ç®—æ‰€å®éªŒå®¤æƒ…å†µç®€è¦ä»‹ç»-ç‹é“è®ºå›</a></li></ul><h1 id="æ¸…åŒ—åäº”é™¢ç³»åˆ†æ"><a href="#æ¸…åŒ—åäº”é™¢ç³»åˆ†æ" class="headerlink" title="æ¸…åŒ—åäº”é™¢ç³»åˆ†æ"></a>æ¸…åŒ—åäº”é™¢ç³»åˆ†æ</h1><h2 id="1-æ¸…åå¤§å­¦"><a href="#1-æ¸…åå¤§å­¦" class="headerlink" title="1 æ¸…åå¤§å­¦"></a>1 æ¸…åå¤§å­¦</h2><p>æ¸…åçš„ offer åŸºæœ¬åœ¨é¢„æ¨å…å‘ï¼Œå¤ä»¤è¥å‘ offer çš„åªæœ‰å‰é™¢ã€æ·±ç ”é™¢ã€‚é™¤äº†è½¯ä»¶ã€æ·±ç ”é™¢å¤–ï¼Œå¤–æ ¡åŸºæœ¬åªèƒ½æ‹¿ç›´åšã€‚å¤ä»¤è¥å„é™¢ç³»è‡ªå·±ç»„ç»‡ï¼Œå¯ä»¥æŠ¥å¤šä¸ªï¼Œä½†æœ‰äº›é™¢ç³»æ²¡æœ‰å¤ä»¤è¥ã€‚é¢„æ¨å…æ˜¯å­¦æ ¡ç³»ç»Ÿä¸ŠæŠ¥ï¼Œæœ€å¤šæŠ¥ä¸¤ä¸ªã€‚</p><ul><li>è®¡ç®—æœºç³»ï¼ˆè´µç³»ï¼‰ï¼šå›½å†…è®¡ç®—æœº top1ï¼Œéœ€è¦å°½æ—©è”ç³»å¯¼å¸ˆã€‚å¼€å¤ä»¤è¥ï¼Œä½†ä¸å‘ offerï¼Œé€šè¿‡æœºè¯•çš„ï¼Œé¢„æ¨å…å…è¯•ã€‚æœºè¯•å¾ˆéš¾ï¼Œ3 é“ç¼–ç¨‹é¢˜ï¼Œéš¾åº¦å’Œ CSP ç¬¬ 3-4 é¢˜å·®ä¸å¤šã€‚</li><li>è‡ªåŠ¨åŒ–ç³»ï¼ˆé›·ç³»ï¼‰ï¼šæœ‰åš AI çš„è€å¸ˆï¼Œæ³¨æ„è‡ªåŠ¨åŒ–ç³»çš„ç¡•å£«åˆ†ä¸‰ç§ï¼Œå­¦ç¡•ã€å¤§æ•°æ®å·¥ç¨‹ï¼ˆè¦å»è´µå·ï¼‰ã€æ ¡ä¼è”åŸ¹ï¼ˆè¦å»ä¼ä¸šï¼‰ã€‚</li><li>å‰é™¢ï¼šå›½å†… bar æœ€é«˜çš„å­¦é™¢ï¼Œè‡³å°‘è¦ 985 rk1 + åœ¨æŠ•é¡¶ä¼š &#x2F; ACMï¼Œ6 æœˆåˆå°±å¼€è¥ã€‚</li><li>è½¯ä»¶å­¦é™¢ï¼šæ²¡æœ‰å¤ä»¤è¥ï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸“ç¡•ï¼Œå¼ºcomï¼Œä¸»è¦çœ‹æœºè¯•æˆç»©ï¼Œæœºè¯•éš¾åº¦ä¸­ç­‰ã€‚</li><li>ç½‘ç ”é™¢ï¼šç›¸å½“äºè´µç³»ç½‘å®‰ä¸“ä¸šï¼Œéš¾åº¦æ¯”è´µç³»ä½ã€‚</li><li>æ·±ç ”é™¢ï¼šæœ‰è®¡ç®—æœºæŠ€æœ¯ã€äººå·¥æ™ºèƒ½ã€å¤§æ•°æ®ã€TBSI å››ä¸ªæ–¹å‘ï¼ŒTBSI æ˜¯å­¦ç¡•ï¼Œå…¶ä»–éƒ½æ˜¯ä¸“ç¡•ï¼Œè®¡ç®—æœºæŠ€æœ¯æœºè¯•å¾ˆéš¾ï¼Œäººå·¥æ™ºèƒ½æœ€å·ï¼ŒTBSI è¦æ±‚å…­çº§ 500+ã€‚</li><li>é«˜ç­‰ç ”ç©¶é™¢ï¼šæœ‰ msra æ ¡ä¼è”åŸ¹åšå£«ï¼Œå¯¼å¸ˆéƒ­ç™¾å®ï¼Œä½†æ˜¯å¥½åƒæ²¡å•¥äººçŸ¥é“ï¼Œå¯ä»¥æ—©ç‚¹è”ç³»æ¡æ¼ã€‚</li></ul><h2 id="2-åŒ—äº¬å¤§å­¦"><a href="#2-åŒ—äº¬å¤§å­¦" class="headerlink" title="2 åŒ—äº¬å¤§å­¦"></a>2 åŒ—äº¬å¤§å­¦</h2><p>åŒ—å¤§çš„ offer å¤§å¤šæ˜¯å¤ä»¤è¥å‘å‡ºå»ï¼Œé¢„æ¨å…ç›¸å½“äºè¡¥å½•äº†ï¼Œå¯ä»¥æŠ¥å¤šä¸ªé™¢ç³»ã€‚</p><ul><li><p>è®¡ç®—æœºå­¦é™¢ï¼šè¶…å¼± comï¼Œå®Œå…¨å–å†³äºè€å¸ˆè¦ä¸è¦ä½ ï¼Œå¤ä»¤è¥æ— æœºè¯•ï¼Œé¢è¯•èµ°è¿‡åœºï¼Œéœ€è¦å°½æ—©è”ç³»å¯¼å¸ˆï¼Œå»è¿›ç»„å®ä¹ ï¼Œbar æ¯”è´µç³»ä½ï¼Œ985 å‰ 5% å°±å¯ä»¥è¯•è¯•ã€‚å¤ä»¤è¥ä¹‹åï¼Œè½¯ä»¶æ‰€ä¸€èˆ¬é¸½çš„æ¯”è¾ƒå¤šï¼Œè¿˜æœ‰å¤–æ ¡åŸºæœ¬åªèƒ½æ‹¿ç›´åšã€‚</p></li><li><p>æ™ºèƒ½å­¦é™¢ï¼šåŸä¿¡ç§‘æ™ºèƒ½æ‰€ï¼Œå’Œè®¡ç®—æœºå­¦é™¢çš„æƒ…å†µå·®ä¸å¤šã€‚</p></li><li><p>è½¯å¾®ï¼šåŸºæœ¬å…¨æ˜¯ä¸“ç¡•ï¼Œçº¯å°±ä¸šå‘ï¼Œå¼ºcomï¼Œå…¥è¥ä¸»è¦çœ‹æ’åï¼Œä¸è¿‡æ®è¯´ä»ä»Šå¹´å¼€å§‹ï¼Œä¹Ÿè¦åšç§‘ç ”äº†ã€‚</p></li><li><p>æ·±ç ”é™¢ï¼šåŸºæœ¬å…¨æ˜¯å­¦ç¡•ï¼Œå¼±comï¼Œä¸è¿‡å‘å¯¼è¾ƒå¤šã€‚</p></li><li><p>è½¯å¾®ï¼š</p><ul><li><p>ä¸å¾—ä¸è¯´åŒ—äº¬çœŸçš„æ˜¯å¤§åŸå¸‚ï¼Œè¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡æ¥åŒ—äº¬ï¼ŒçœŸçš„æ„Ÿå—åˆ°äº†é¦–éƒ½çš„é­…åŠ›ã€‚</p><p> â€ƒâ€ƒå¤è¯•åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šæ‰‹æ’•ç®—æ³•é¢˜ + é¢è¯•</p><pre><code>â€ƒâ€ƒæ‰‹æ’•ç®—æ³•é¢˜éƒ¨åˆ†ï¼Œå½“å¤©é¢è¯•çš„æ‰€æœ‰äººéƒ½åœ¨ä¸€èµ·å†™é¢˜ï¼Œä¸€å…±æœ‰ä¸‰é“é¢˜ï¼Œé€‰å…¶ä¸­ä¸€é“é¢˜æ‰‹æ’•ä»£ç å°±å¯ä»¥äº†ï¼Œéš¾åº¦å¤§æ¦‚æ˜¯ easy åˆ° medium ä¹‹é—´å§ï¼Œæ‰‹æ’•å¿«æ’ä¹Ÿæœ‰ï¼Œå¤§æ¨¡æ‹Ÿä¹Ÿæœ‰ã€‚â€ƒâ€ƒé¢è¯•éƒ¨åˆ†ï¼Œé¦–å…ˆä½ è¦ç»™æ¯ä½è€å¸ˆå‘ä½ çš„ç®€å†ï¼Œè€å¸ˆçœ‹åˆ°æˆ‘æ˜¯æ¹–å¤§çš„ï¼Œå°±è¦æˆ‘è‹±æ–‡æè¿°ä¸€ä¸‹æ¹–å¤§çš„é£æ™¯ï¼Œå…¶å®æˆ‘æ—©æœ‰å‡†å¤‡ï¼Œå½“æ—¶èƒŒçš„æ˜¯ä»‹ç»é•¿æ²™ï¼Œæˆ‘å°±æ´»ç”¨äº†ã€‚ç„¶åè€å¸ˆè®©æˆ‘æŠ½ä¸€é“åŸºç¡€é¢˜ï¼Œæˆ‘æŠ½åˆ°äº†æ•°æ®åº“ç³»ç»Ÿï¼Œå…¶å®å¾ˆä¸å·§æˆ‘å°±æ•°æ®åº“æ²¡æ€ä¹ˆå¤ä¹ ï¼Œä½†æ˜¯è¿˜æ˜¯å‡­è‡ªå·±çš„è®°å¿†è¯´äº†ä¸€é€šï¼Œç„¶åè€å¸ˆè¿˜é—®äº†æ•°æ®åº“ç³»ç»Ÿå’Œæ•°æ®åº“ç®¡ç†ç³»ç»Ÿçš„åŒºåˆ«ï¼Œæˆ‘è®°å¾—ä»–è¯´çš„æ˜¯ DBS å’Œ DBMS çš„åŒºåˆ«ï¼Œå½“æ—¶æˆ‘ç§’æ‡‚ï¼ŒDBMS æˆ‘ä¼šå•Šï¼Œæ‰€ä»¥æˆ‘åˆè¯´äº†ä¸€é€šã€‚â€ƒâ€ƒæ¥ç€è€å¸ˆä¼šæ‹¿å‡ºåˆšåˆšæ‰‹æ’•çš„ç®—æ³•é¢˜é—®ä½ è§‰å¾—æ€ä¹ˆæ ·ï¼Œå†™å¾—å¯¹ä¸å¯¹ï¼Œä½ è¦å°½å¯èƒ½å±•ç°å‡ºä½ çš„ç®—æ³•åŠŸåº•å°±å¥½äº†ï¼Œæ¯”æ–¹è¯´ä¸€ä¸ªå¾ˆç®€å•çš„æ±‚å¹³æ–¹å’Œï¼Œæ²¡æœ‰ç»™ä½ æ•°æ®èŒƒå›´æ—¶ï¼Œå…¶å®æ˜¯ä¸€ä¸ªå¤§æ•°ä¹˜æ³• + å¤§æ•°åŠ æ³•ã€‚ç„¶åè€å¸ˆå¼€å§‹é—®æˆ‘é¡¹ç›®äº†ï¼Œå¤§æ¦‚é—®äº†æˆ‘çš„ä»£ç é‡å’Œå®ç°éš¾ç‚¹ã€‚</code></pre></li><li></li></ul></li></ul><h2 id="3-ä¸­ç§‘é™¢"><a href="#3-ä¸­ç§‘é™¢" class="headerlink" title="3 ä¸­ç§‘é™¢"></a>3 ä¸­ç§‘é™¢</h2><p>ä¸­ç§‘é™¢å„æ‰€å·®åˆ«æå¤§ï¼Œæ‰€å†…å„ç»„ä¹Ÿå·®åˆ«æå¤§ï¼Œæ‰€è°“â€œå¼ºç»„æ¸…åŒ—ï¼Œå¼±ç»„211â€ã€‚ä¸­ç§‘é™¢çš„å¸ˆç”Ÿæ¯”å¾ˆé«˜ï¼Œä¸€èˆ¬ç¡•å¯¼ä¸€å¹´ 0-1 ä¸ªç¡•å£«åé¢ï¼Œåšå¯¼ä¸€å¹´1ç¡•1åšï¼Œä¸­ç§‘é™¢å¯ä»¥æŠ¥ä»»æ„å¤šä¸ªæ‰€ï¼ˆå¤šå‡†å¤‡å‡ ä¸ªé‚®ç®±å¤šæ³¨å†Œå‡ ä¸ªå·å°±è¡Œï¼‰ã€‚è®¡ç®—æœºç›¸å…³çš„ç ”ç©¶æ‰€æœ‰ï¼š</p><p>è¡¨æ ¼ è¿˜åœ¨åŠ è½½ä¸­ï¼Œè¯·ç­‰å¾…åŠ è½½å®Œæˆåå†å°è¯•å¤åˆ¶</p><p>å„æ‰€åŸºæœ¬æ˜¯å¤ä»¤è¥å°±æ‹›å®Œå­¦ç”Ÿï¼Œé¢„æ¨å…ç›¸å½“äºè¡¥å½•ï¼Œå¦å¤–ï¼Œå›½ç§‘å¤§è®¡ç®—æœºå­¦é™¢ã€äººå·¥æ™ºèƒ½å­¦é™¢ä¹Ÿæ‹›ç”Ÿï¼ˆæ¯”ä¸¤æ‰€å®¹æ˜“ä¸€äº›ï¼‰ï¼Œå¯¼å¸ˆåŸºæœ¬æ˜¯ä¸¤æ‰€çš„ã€‚æœ€åå†è¯´ä¸€ä¸‹ï¼Œè™½ç„¶ä¸¤æ‰€çš„å®åŠ›è¦ç•¥å¼ºäºåäº”ï¼Œå¦‚æœä½ ä»¥åä»äº‹ä¸“ä¸šç›¸å…³çš„äº‹æƒ…ï¼ˆå¦‚ï¼šå­¦æœ¯å±Šã€ä¼ä¸šæŠ€æœ¯å²—ï¼‰ï¼Œå¯ä»¥æ¥ä¸¤æ‰€ï¼›ä½†å¦‚æœä»¥åä»äº‹éä¸“ä¸šç›¸å…³çš„äº‹æƒ…ï¼ˆå¦‚ï¼šè€ƒå…¬ï¼‰ï¼Œæ›´å»ºè®®å»åäº”ã€‚</p><ul><li>è®¡ç®—æ‰€ï¼šä½“ç³»ç»“æ„æ–¹å‘äºšæ´²ç¬¬ä¸€ï¼ŒAI æ–¹å‘å®åŠ›ä¹Ÿå¾ˆå¼ºï¼Œè¶…å¼±comï¼Œä½ ç”šè‡³æ²¡å…¥è¥éƒ½å¯ä»¥æ‹¿ offerï¼Œæœ‰éœ¸é¢æœºåˆ¶ï¼Œå³å¦‚æœä½ æ²¡æœ‰å…¥è¥ï¼Œè€å¸ˆä¹Ÿå¯ä»¥é‚€è¯·ä½ æ¥é¢è¯•ï¼Œå’Œå…¥è¥çš„æ²¡åŒºåˆ«ã€‚è®¡ç®—æ‰€æ˜¯åˆ†ç»„æ¥è€ƒæ ¸çš„ï¼Œæ‰€é‡Œä¸ç®¡ï¼Œç‰›ç»„ç«äº‰éå¸¸æ¿€çƒˆï¼ˆå¦‚å¯’æ­¦çºªã€é¾™èŠ¯ã€viplç­‰ï¼‰ã€‚ä½“ç³»ç»“æ„å’Œ AI çš„å¤§ç‰›å¾ˆå¤šï¼Œå°±ä¸ç»†è¯´äº†ã€‚è¿˜æœ‰è¦æ³¨æ„å¾ˆå¤šç»„è¦æ±‚åšå£«å»¶æ¯•ä¸€å¹´ã€‚</li><li>è‡ªåŠ¨åŒ–æ‰€ï¼šä½“é‡å¾ˆå¤§ï¼Œå…‰æ¨¡å¼è¯†åˆ«å›½é‡å°± 100 å¤šä½è€å¸ˆï¼ŒAI æ–¹å‘ç‰¹åˆ« CV å¾ˆå¼ºï¼Œæ¨¡å¼è¯†åˆ«å›½é‡æœ‰å¾ˆå¤š AI å¤§ç‰›ã€‚å¼º comï¼Œbar 985 å‰ 5ï¼Œä»¥â€œæœªæ¥çš„é‚€çº¦â€é—»åäºä¿ç ”åœˆã€‚</li><li>è½¯ä»¶æ‰€ï¼šæœ‰è®¡ç®—æœºç§‘å­¦å›½é‡ï¼ˆè½¯ä»¶ä¸ç†è®ºæ–¹å‘ï¼‰ï¼Œå¦å¤–ä¸­æ–‡ä¿¡æ¯å®éªŒå®¤çš„å­™lã€éŸ©xpè€å¸ˆä¹Ÿæ¯”è¾ƒå¼ºï¼ˆNLP æ–¹å‘ï¼‰ã€‚</li><li>ä¿¡å·¥æ‰€ï¼šæœ‰ç½‘å®‰å›½é‡ï¼Œæœ‰ä¸ª CV ç»„ä¹Ÿå¾ˆå¼ºï¼ˆæ“xcç»„ï¼‰ï¼Œä¸è¿‡ï¼Œæ“è€å¸ˆå»å¹´è·³æ§½åˆ°ä¸­å±±å½“é™¢é•¿äº†ã€‚</li><li>ç¥ä»™é™¢ï¼šæ·±åœ³å…ˆè¿›æŠ€æœ¯ç ”ç©¶é™¢ï¼Œä¸‹é¢çš„æ•°å­—æ‰€æœ‰ä¸ª MM Lab å¾ˆå¼ºï¼Œå’Œæ¸¯ä¸­å¤§é‚£ä¸ª MM Lab ã€å•†æ±¤ã€ä¸Šæµ·æµ¦æ±Ÿå®éªŒå®¤å…³ç³»å¯†åˆ‡ï¼Œè´Ÿè´£äººæ˜¯ä¹”yè€å¸ˆï¼ˆ3ä¸‡å¼•ï¼‰ï¼Œå¦å¤–ç»„é‡Œè‘£cè€å¸ˆä¹Ÿæ˜¯å¤§ç‰›ã€‚</li></ul><h2 id="4-ä¸Šæµ·äº¤é€šå¤§å­¦"><a href="#4-ä¸Šæµ·äº¤é€šå¤§å­¦" class="headerlink" title="4 ä¸Šæµ·äº¤é€šå¤§å­¦"></a>4 ä¸Šæµ·äº¤é€šå¤§å­¦</h2><p>æ‹›ç”Ÿä¸»è¦åœ¨å¤ä»¤è¥ï¼Œé¢„æ¨å…æ‹›çš„å°‘ã€‚æ³¨æ„ä¸Šäº¤ç”µé™¢åšå£«æ¯•ä¸šæ˜¯å‡ºäº†åçš„éš¾ï¼Œæ®è¯´åŸºæœ¬ 6 å¹´èµ·æ­¥ã€‚å¯†è¥¿æ ¹æ˜¯å•ç‹¬æŠ¥åï¼Œå…¶ä»–é™¢ç³»åœ¨å­¦æ ¡ç³»ç»Ÿä¸ŠæŠ¥åï¼Œåªèƒ½æŠ¥ä¸€ä¸ªã€‚</p><ul><li>è®¡ç®—æœºç³»ã€ç½‘å®‰ï¼šä¸Šäº¤è®¡ç®—æœºç³»åƒè´µç³»é‚£æ ·ï¼Œå„æ–¹å‘éƒ½æœ‰ï¼Œéƒ½æ¯”è¾ƒå¼ºã€‚ç¡•å£«éå¸¸éš¾ï¼Œ2021 å¹´éåäº”åªå½•äº† 4 ä¸ªï¼Œæœ‰æœºè¯•ã€‚ç›´åšå…¥è¥å®¹æ˜“ï¼Œæ²¡æœ‰æœºè¯•ï¼Œå…³é”®æ˜¯è¦æ‰¾åˆ°å¯¼å¸ˆæ¥æ”¶ï¼ˆç›´åšæ²¡æœ‰å¯¼å¸ˆæ¥æ”¶ï¼Œæ‹¿äº†ä¼˜è¥ä¹Ÿæ²¡ç”¨ï¼‰ã€‚ä¸Šäº¤ç‰›å¯¼å¾ˆå¤šï¼ŒAI æ–¹å‘æœ‰å‡ ä¸ªå¹´è½»è€å¸ˆç‰¹åˆ«ç«ï¼Œå¦‚å¢cwã€å¼ wnã€å¼ qsã€ä¸¥jc ç­‰ã€‚</li><li>è½¯ä»¶å­¦é™¢ï¼šå›½å†…æœ€å¼ºçš„è½¯ä»¶å­¦é™¢ï¼Œä»¥ ipadså®éªŒå®¤ï¼ˆåˆ†å¸ƒå¼ç³»ç»Ÿæ–¹å‘ï¼‰é—»åï¼Œæœºè¯•å¬è¯´æ˜¯å¼€å‘è½¯ä»¶ï¼Œæ¯”è¾ƒç¡¬æ ¸ã€‚</li><li>ç½‘å®‰å­¦é™¢ï¼šæ¯”è®¡ç®—æœºç³»è¦å®¹æ˜“ã€‚</li><li>å¯†è¥¿æ ¹å­¦é™¢ï¼šæƒ³å»ä¸Šäº¤ï¼Œå¯†è¥¿æ ¹æœ€å®¹æ˜“ï¼Œä¸è¿‡å­¦è´¹è´µï¼Œå¯¼å¸ˆä¸€èˆ¬ã€‚</li></ul><h2 id="5-æµ™æ±Ÿå¤§å­¦"><a href="#5-æµ™æ±Ÿå¤§å­¦" class="headerlink" title="5 æµ™æ±Ÿå¤§å­¦"></a>5 æµ™æ±Ÿå¤§å­¦</h2><p>æµ™å¤§çš„è®¡ç®—æœºå›¾å½¢å­¦å›½å†…ç¬¬ä¸€ï¼Œè®¡ç®—æœºå­¦é™¢ä½“é‡ä¹Ÿéå¸¸å¤§ã€‚æµ™å¤§åªèƒ½æŠ¥ä¸€ä¸ªå­¦é™¢ã€‚</p><ul><li>è®¡ç®—æœºå­¦é™¢ï¼šå¤ä»¤è¥åªæœ‰ç›´åšï¼Œè¦å»åšä¸€ä¸ªå¤šæœˆçš„é¡¹ç›®ï¼Œå†…å®¹ç”±æŠ¥åè€å¸ˆæŒ‡å®šï¼Œ8æœˆä¸‹æ—¬ï¼Œæ¯ä¸ªåšå¯¼å¯ä»¥æ¨è 1 åå­¦ç”Ÿï¼ˆé™¢å£« 2 åï¼‰ï¼Œè¿›å…¥å­¦é™¢ç­”è¾©ç¯èŠ‚ï¼ˆèµ°è¿‡åœºï¼‰ã€‚æµ™å¤§å¤§é‡åé¢ï¼ˆå«æ‰€æœ‰ç¡•å£«åé¢ï¼‰åœ¨é¢„æ¨å…ï¼Œä¸è¿‡è¦è·Ÿæµ™å¤§æœ¬æ ¡ç«äº‰ã€‚CAD&amp;CG å›½é‡é‡Œé¢æœ‰å¾ˆå¤š CGã€CV å¤§ç‰›ã€‚</li><li>è½¯ä»¶å­¦é™¢ï¼šåœ¨å®æ³¢ï¼Œçº¯å°±ä¸šå‘ï¼Œå¤ä»¤è¥å…¥è¥ç‚¹å‡»å°±é€ï¼Œåƒäººæµ·ç‹è¥ï¼Œè€ƒæ ¸è¦åšé¡¹ç›®ï¼Œä¼˜è¥å®¹æ˜“æ‹¿ï¼Œä½†æ²¡ä»€ä¹ˆç”¨ï¼Œè¿˜æ˜¯è¦å‚åŠ é¢„æ¨å…ï¼Œé¢„æ¨å…æœ‰æœºè¯•ã€‚</li><li>å·¥ç¨‹å¸ˆå­¦é™¢ï¼šå¤ä»¤è¥ã€é¢„æ¨å…éƒ½æœ‰ï¼Œæ¯”è®¡ç®—æœºå­¦é™¢å®¹æ˜“ã€‚</li><li>å›½é™…è”åˆå­¦é™¢ï¼šåœ¨å˜‰å…´å¸‚æµ·å®å¸‚ï¼ˆå¿çº§å¸‚ï¼‰ï¼Œä¸å¤ªäº†è§£ï¼Œæ‹›è®¡ç®—æœºä¸“ä¸šçš„å­¦ç”Ÿã€‚</li></ul><h2 id="6-å¤æ—¦å¤§å­¦"><a href="#6-å¤æ—¦å¤§å­¦" class="headerlink" title="6 å¤æ—¦å¤§å­¦"></a>6 å¤æ—¦å¤§å­¦</h2><p>å¤æ—¦çš„è®¡ç®—æœºæ˜¯ B+ï¼Œä½†æ˜¯äººå·¥æ™ºèƒ½æ–¹å‘å¾ˆå¼ºï¼Œå­¦æ ¡ title å¥½ï¼Œé­”éƒ½ä½ç½®å¥½ã€‚å¤æ—¦åªèƒ½æŠ¥ä¸€ä¸ªå­¦é™¢ã€‚</p><ul><li>è®¡ç®—æœºå­¦é™¢ï¼šå‘æ”¾ offer å¤ä»¤è¥ï¼šé¢„æ¨å… &#x3D; 1 : 2ï¼Œå¤ä»¤è¥çš„ bar å·¨é«˜ï¼Œ985 ä¸€ä¸ªä¸“ä¸šåªèƒ½å…¥ä¸€ä¸ªã€‚æœ‰æœºè¯•ä½†ä¸ç®—åˆ†ã€‚NLP ç»„ï¼ˆé»„é‚±å¼ ï¼‰å¾ˆå¼ºï¼ŒCV æ–¹å‘å§œygç»„ã€è–›xyç»„ä¹Ÿæ¯”è¾ƒå¼ºã€‚</li><li>å¤§æ•°æ®å­¦é™¢ï¼šå‘ç»Ÿè®¡å­¦æˆ–é‡‘èå­¦ä½è¯ï¼Œéš¾åº¦ä¸æ¯”è®¡ç®—æœºå­¦é™¢ä½ï¼Œå¯¹æ•°å­¦è¦æ±‚é«˜ã€‚</li><li>å·¥ç ”é™¢ï¼šéš¾åº¦æ¯”è®¡ç®—æœºå­¦é™¢ä½ã€‚</li><li>ç±»è„‘æ™ºèƒ½ç ”ç©¶é™¢ï¼šæœ‰éƒ¨åˆ†è€å¸ˆåš AI å’Œç”Ÿç‰©äº¤å‰ã€‚</li></ul><h2 id="7-å—äº¬å¤§å­¦"><a href="#7-å—äº¬å¤§å­¦" class="headerlink" title="7 å—äº¬å¤§å­¦"></a>7 å—äº¬å¤§å­¦</h2><p>å—å¤§ä¸‰ä¸ªå­¦é™¢éƒ½å¯ä»¥æŠ¥ï¼Œä½†åªèƒ½å…¥ä¸€ä¸ªï¼Œæµ·ç‹è¥ï¼Œå…¥è¥åæœ‰çº¿ä¸Šç¬”è¯•ï¼Œè€ƒ408ç­‰ä¸“ä¸šè¯¾ï¼Œæ²¡æœ‰æœºè¯•ï¼Œå—å¤§æ˜¯è¶…å¼º comã€‚</p><ul><li>è®¡ç®—æœºç³»ï¼šè½¯ä»¶æ‰€éå¸¸å¼ºï¼Œè½¯ä»¶æ‰€åœ¨å­¦é™¢å¤ä»¤è¥å‰æœ‰è‡ªå·±åŠçš„å¤ä»¤è¥ï¼Œå¦å¤– MCG ç»„çš„ç‹lmè€å¸ˆæ˜¯å—å¤§ CV æœ€å¼ºçš„è€å¸ˆï¼ŒNLP ç»„é»„sjè€å¸ˆä¹Ÿæ¯”è¾ƒå¼ºã€‚</li><li>äººå·¥æ™ºèƒ½å­¦é™¢ï¼šlamdaï¼ˆå‘¨zhç»„ï¼‰éå¸¸å¼ºï¼Œä¸»è¦æ˜¯åšæœºå™¨å­¦ä¹ ã€æ•°æ®æŒ–æ˜çš„ï¼Œ lamda åœ¨å­¦é™¢å¤ä»¤è¥å‰ä¹Ÿæœ‰è‡ªå·±åŠçš„å¤ä»¤è¥ï¼Œlamda ä¸€å…±ä¸¤è½®é¢è¯•ï¼Œç¬¬ä¸€è½®å­¦é•¿é¢ï¼Œç¬¬äºŒè½®æŠ¥è€ƒè€å¸ˆé¢ã€‚æ³¨æ„æ‹¿äº† lamda offer åï¼Œè¿˜éœ€è¦äººå·¥æ™ºèƒ½å­¦é™¢ä¼˜è¥æ‰èƒ½å½•å–ï¼Œå—å¤§çš„ com éå¸¸å¼ºã€‚</li><li>è½¯ä»¶å­¦é™¢ï¼šæ¯” CSã€AI å®¹æ˜“ä¸€äº›ï¼Œçº¯å°±ä¸šå‹ã€‚</li></ul><h2 id="8-ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦"><a href="#8-ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦" class="headerlink" title="8 ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦"></a>8 ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦</h2><p>ä¸­ç§‘å¤§æ²¡æœ‰ç›´åšï¼Œå…¨æ˜¯ç¡•å£«ï¼Œç³»ç»Ÿé‡Œå¯ä»¥æŠ¥ä¸‰ä¸ªå¿—æ„¿ï¼Œåªèƒ½å…¥ä¸€ä¸ªï¼ŒåŸºæœ¬ä¸Šåªæœ‰ä¸€å¿—æ„¿æœ‰ç”¨ï¼Œä¸­ç§‘å¤§æ˜¯å¼± comã€‚è¿˜æœ‰å…¥è¥ä¸­ç§‘å¤§åä¼šæ”¶åˆ°å…¥è¥å¤§ç¤¼åŒ…ï¼ï¼ï¼</p><ul><li>è®¡ç®—æœºå­¦é™¢ï¼šå…¥è¥æ­§è§†è½¯ä»¶ä¸“ä¸šï¼Œæˆ‘æ ¡è®¡ç®—æœºå‰5%å¯å…¥ï¼Œè½¯ä»¶åªèƒ½å…¥1%ï¼Œæ²¡æœ‰é¢„æ¨å…ã€‚AIæ–¹å‘åšæ•°æ®æŒ–æ˜çš„å¤šï¼Œå‡ ä¹æ²¡æœ‰åšCVçš„ï¼ˆéƒ½åœ¨è‡ªåŠ¨åŒ–ç³»ã€ç”µå­ç³»ï¼‰ã€‚BDAAï¼ˆé™ˆehç»„ï¼‰å¾ˆå¼ºï¼Œé™ˆehè€å¸ˆæ˜¯æ°é’ï¼Œç»„é‡Œè¿˜æœ‰åˆ˜qã€è¿dfä¸¤ä½ä¼˜é’ï¼Œäººå¥½å­¦æœ¯å¥½ã€‚ç½‘ç»œæ–¹å‘æxyï¼ˆACM &#x2F; IEEE fellowï¼‰ç»„å¾ˆç‰›ï¼Œç»„é‡Œå¼ yyè€å¸ˆä¹Ÿæ˜¯IEEE fellowï¼Œåšæ™ºèƒ½æ„ŸçŸ¥çš„ã€‚å¦å¤–è®¡ç®—æœºå­¦é™¢è¿˜æœ‰ç½‘çº¢æ•™æˆå¼ lï¼ˆé€ƒï¼‰</li><li>è‡ªåŠ¨åŒ–ç³»ï¼ˆ10ç³»ï¼‰ï¼šè‡ªåŠ¨åŒ–ç³»å’Œç”µå­ç³»è™½ç„¶åŒå±ä¿¡æ¯å­¦é™¢ï¼Œä½†æ‹›ç”Ÿæ˜¯åˆ†å¼€çš„ï¼Œå¿…é¡»å¯¼å¸ˆæ¨èæ‰èƒ½å…¥è¥ï¼Œé¢„æ¨å…æœ‰å°‘é‡åé¢ã€‚CV æ–¹å‘çš„å¼ tzï¼ŒæŸ¥zjè€å¸ˆå¾ˆå¼ºï¼Œéƒ½æ˜¯ä¼˜é’+ä¸‡å¼•ã€‚</li><li>ç”µå­ç³»ï¼ˆ6ç³»ï¼‰ï¼šè™½ç„¶å«ç”µå­ç³»ï¼Œå…¶å®å¾ˆå¤šè€å¸ˆæ˜¯åšäººå·¥æ™ºèƒ½çš„ï¼Œå¤§ç‰›å¾ˆå¤šã€‚ä½•xnç»„ï¼ˆå·¨ç‰›ï¼Œ30å²ï¼Œ2.2ä¸‡å¼•ï¼‰éå¸¸å¼ºï¼Œä½•è€å¸ˆç»„é‡Œä¸¤ä½å°è€æ¿ä¹Ÿå¾ˆå¼ºï¼Œç‹xï¼ˆ7kå¼•ï¼‰ã€å†¯flï¼ˆ4kå¼•ï¼‰ï¼Œéƒ½æ˜¯30å²å‡ºå¤´ã€‚ç”µå­ç³»AIæ–¹å‘è¿˜æœ‰å´fï¼ˆé™¢å£«å€™é€‰äººï¼‰ã€æhqã€å¼ ydç­‰æ°é’ï¼Œå‘¨wgã€åˆ˜dã€è°¢htã€ç‹jç­‰ä¼˜é’ï¼Œå®åŠ›éå¸¸å¼ºã€‚</li><li>å¤§æ•°æ®å­¦é™¢ï¼šå°±æ˜¯è®¡ç®—æœºã€è‡ªåŠ¨åŒ–ã€ç”µå­çš„è€å¸ˆï¼Œä¸€èˆ¬ç§‘å¤§æœ¬æ ¡å–œæ¬¢æ‹¿å¤§æ•°æ®å­¦é™¢åé¢ï¼Œæ‰€ä»¥å¤–æ ¡å…¥è¥éš¾ï¼Œæ²¡æœ‰é¢„æ¨å…ã€‚</li><li>ç½‘å®‰å­¦é™¢ï¼šä½•xnçš„ä¸¤ä¸ªå°è€æ¿éƒ½æŒ‚åœ¨ç½‘å®‰å­¦é™¢ï¼Œè¿™é‡Œç”šè‡³è¿˜èƒ½æ‰¾åˆ°æ½˜å»ºä¼Ÿã€‚</li><li>è½¯ä»¶å­¦é™¢ï¼šä¸€å…±å°±å‡ ä¸ªä¿ç ”æ‹›ç”Ÿåé¢ï¼Œä¸»è¦æ‹›è€ƒç ”ã€‚</li><li>è‹å·ç ”ç©¶é™¢ï¼šæ¯”æœ¬éƒ¨ç®€å•ä¸€äº›ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œä¸­ç§‘é™¢è®¡ç®—æ‰€å¥‡è¿¹ç»„çš„å‘¨shè€å¸ˆï¼ˆIEEE fellowï¼Œä¸‡å¼•ï¼ŒåŒ»å­¦å½±åƒå¤§ç‰›ï¼‰å…¨èŒæ¥ä¸­ç§‘å¤§ï¼Œåœ¨è¿™é‡Œæ‹›ç”Ÿç‰©åŒ»å­¦å·¥ç¨‹ä¸“ä¸šçš„å­¦ç”Ÿï¼ˆåŒ»å­¦ CV æ–¹å‘ï¼‰ã€‚</li><li>å…ˆç ”é™¢ï¼šæ¯”æœ¬éƒ¨ç®€å•ä¸€äº›ã€‚</li><li>ç§‘å­¦å²›ï¼šä¸­ç§‘é™¢åˆè‚¥ç‰©è´¨ç ”ç©¶é™¢ï¼Œå‘ä¸­ç§‘å¤§æ¯•ä¸šè¯ï¼Œå…¥è¥ç‚¹å‡»å°±é€ï¼Œæœ€å®¹æ˜“ä¸Šå²¸åäº”çš„åœ°æ–¹ã€‚</li></ul><h2 id="9-ä¸­å›½äººæ°‘å¤§å­¦"><a href="#9-ä¸­å›½äººæ°‘å¤§å­¦" class="headerlink" title="9 ä¸­å›½äººæ°‘å¤§å­¦"></a>9 ä¸­å›½äººæ°‘å¤§å­¦</h2><p>äººå¤§åœ¨ä¸­å…³æ‘ï¼Œä½ç½®å¥½ï¼Œå­¦æœ¯å¼ºçš„è€å¸ˆå¤§å¤šåœ¨é«˜ç“´ï¼Œå¼º comã€‚äººå¤§ä¿¡æ¯å’Œé«˜ç“´å¯ä»¥éƒ½æŠ¥ï¼Œä¹Ÿå¯ä»¥éƒ½å…¥è¥ï¼Œ</p><ul><li>ä¿¡æ¯å­¦é™¢ï¼ˆç‹è€å‰ï¼‰ï¼šå¤ä»¤è¥ 4 æœˆ 20 å·å·¦å³å°±å¼€æ”¾æŠ¥åäº†ï¼Œç„¶åæ„£æ˜¯ 6 æœˆ 29 æ‰å‘å…¥è¥åå•ï¼Œå®˜ç½‘é€šå‘Šæ ä¸€ç›´æ˜¯ç‹è€å‰å¥–å­¦é‡‘è·å¥–å…¬ç¤ºï¼Œç»¿ç¾¤ç¾¤å‹ä»¬å¤©å¤©å»åˆ·å­¦é™¢å®˜ç½‘éƒ½ç­‰ä¸åˆ°å…¥è¥åå•ï¼Œæ•…ç§°ä¸ºç‹è€å‰å­¦é™¢ã€‚ç‹è€å‰æ‹›ç”Ÿäººæ•°å°‘ï¼Œä¹‹å‰å…¥è¥ä¹Ÿå°‘ï¼Œbar å¾ˆé«˜ï¼ˆå­¦ç¡•å¡ 985 rk2 å·¦å³ï¼‰ï¼Œä½†ä»Šå¹´æ˜¯æµ·ç‹è¥äº†ã€‚ç‹è€å‰æ•°æ®åº“æ–¹å‘æ¯”è¾ƒå¼ºï¼Œæ— é¢„æ¨å…ã€‚</li><li>é«˜ç“´äººå·¥æ™ºèƒ½å­¦é™¢ï¼ˆåŠ å¤šå®ï¼‰ï¼šç‹è€å‰çš„ hxd å½“ç„¶æ˜¯åŠ å¤šå®äº†ã€‚é«˜ç“´çš„è€å¸ˆåŸºæœ¬éƒ½æ˜¯åš AI çš„ï¼ˆåä¿¡æ¯æ£€ç´¢ã€æ•°æ®æŒ–æ˜ï¼‰ï¼Œæ²¡æœ‰ä»€ä¹ˆæ¯”è¾ƒå·®çš„ï¼Œä¸‹é™å¾ˆé«˜ï¼Œéƒ½åšå­¦æœ¯ã€‚é«˜ç“´åªæœ‰å­¦ç¡•å’Œç›´åšï¼Œéƒ½åœ¨å¤ä»¤è¥æ‹›ç”Ÿï¼Œæ²¡æœ‰é¢„æ¨å…ï¼Œé¸½å­æ¯”è¾ƒå¤šï¼Œä¸€èˆ¬å…¥è¥å³ offerï¼Œå­¦ç¡• bar æŒºé«˜ï¼Œå¯èƒ½ 985 2% å·¦å³ï¼Œç›´åšä½ä¸€äº›ã€‚æ–‡jrã€å¾jç­‰è€å¸ˆéƒ½æ˜¯ msra è¿‡æ¥çš„ï¼ŒIR å¤§ç‰›ï¼Œä¸¥rè€å¸ˆæ˜¯åŒ—å¤§ç‹é€‰æ‰€è¿‡æ¥çš„ï¼ŒNLP å¤§ç‰›ï¼Œè¿˜æœ‰å‡ ä¸ªå§šç­æ¯•ä¸šçš„ AP ä¹Ÿå¾ˆå¼ºã€‚é«˜ç“´æœ€å¤§çš„åŠ£åŠ¿å°±æ˜¯äººå¤§è¿™ä¸ª title ä¸å¤Ÿå¥½äº†å§ã€‚</li></ul><h2 id="10-å…¶ä»–å­¦æ ¡çš„éƒ¨åˆ†AIç‰›ç»„"><a href="#10-å…¶ä»–å­¦æ ¡çš„éƒ¨åˆ†AIç‰›ç»„" class="headerlink" title="10 å…¶ä»–å­¦æ ¡çš„éƒ¨åˆ†AIç‰›ç»„"></a>10 å…¶ä»–å­¦æ ¡çš„éƒ¨åˆ†AIç‰›ç»„</h2><p>æˆ‘ä¿ç ”è¿‡ç¨‹ä¸­äº†è§£åˆ°çš„å…¶ä»–å­¦æ ¡çš„ä¸€äº› AI ç‰›ç»„ï¼ˆè¿˜æœ‰å¾ˆå¤šæ²¡åˆ—ä¸Šæ¥ï¼‰ï¼š</p><p>å—å¼€å¤§å­¦ç¨‹mmç»„ï¼ˆCVï¼‰ã€å“ˆå·¥å¤§SCIRå®éªŒå®¤ï¼ˆåˆ˜tç»„ï¼ŒNLPï¼‰ã€åŒ—èˆªVRå›½é‡ï¼ˆCVï¼‰ã€å¦é—¨å¤§å­¦macå®éªŒå®¤ï¼ˆçºªrrç»„ï¼ŒCVï¼‰ã€ä¸œå—å¤§å­¦palmå®éªŒå®¤ï¼ˆè€¿xç»„ï¼‰ã€ä¸­å±±å¤§å­¦éƒ‘wsç»„ï¼ˆCVï¼‰ã€åç§‘ç™½xç»„ï¼ˆOCRï¼‰ã€ä¸Šç§‘å¤§è™jyç»„ï¼ˆCVï¼‰ã€è¥¿æ¹–å¤§å­¦æzqç»„ï¼ˆåŸè‡ªåŠ¨åŒ–æ‰€å¤§ç‰›ï¼‰ã€è¥¿æ¹–å¤§å­¦å¼ yç»„ï¼ˆNLPï¼‰ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç»éªŒè´´ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ä¿ç ” </tag>
            
            <tag> å¤ä»¤è¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ·±å…¥ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿï¼ˆä¸€ï¼‰è®¤è¯†åˆ†å¸ƒå¼ç³»ç»Ÿ</title>
      <link href="/2024/06/24/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%EF%BC%88%E4%B8%80%EF%BC%89%E4%BB%80%E4%B9%88%E6%98%AF%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/"/>
      <url>/2024/06/24/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%EF%BC%88%E4%B8%80%EF%BC%89%E4%BB%80%E4%B9%88%E6%98%AF%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<h1 id="è®¤è¯†åˆ†å¸ƒå¼ç³»ç»Ÿ"><a href="#è®¤è¯†åˆ†å¸ƒå¼ç³»ç»Ÿ" class="headerlink" title="è®¤è¯†åˆ†å¸ƒå¼ç³»ç»Ÿ"></a>è®¤è¯†åˆ†å¸ƒå¼ç³»ç»Ÿ</h1><h2 id="1-1-ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿ"><a href="#1-1-ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿ" class="headerlink" title="1.1 ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿ"></a>1.1 ä»€ä¹ˆæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿ</h2><p>å®šä¹‰ï¼š</p><p>åˆ†å¸ƒå¼ç³»ç»ŸæŒ‡çš„æ˜¯ç”±å¤šå°è®¡ç®—æœºç»„æˆçš„ç³»ç»Ÿï¼Œè¿™äº›è®¡ç®—æœºé€šè¿‡ç½‘ç»œè¿æ¥èµ·æ¥ï¼ŒååŒå·¥ä½œä»¥å®ç°å…±åŒçš„ç›®æ ‡ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå„ä¸ªè®¡ç®—æœºä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼ŒåŒæ—¶ä¹Ÿéœ€è¦ååŒå·¥ä½œæ¥å¤„ç†å¤§é‡çš„æ•°æ®å’Œä»»åŠ¡ã€‚åˆ†å¸ƒå¼ç³»ç»Ÿå¯ä»¥åŒ…æ‹¬ä¸åŒç±»å‹çš„è®¡ç®—æœºï¼ŒåŒ…æ‹¬æœåŠ¡å™¨ã€å°å¼æœºã€ç§»åŠ¨è®¾å¤‡ç­‰ç­‰ã€‚</p><p>åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸€ä¸ªä¸»è¦ç‰¹ç‚¹æ˜¯å…¶é«˜åº¦çš„å¯æ‰©å±•æ€§ï¼Œå¯ä»¥éšç€éœ€æ±‚å¢é•¿è€Œå¢åŠ è®¡ç®—æœºçš„æ•°é‡ã€‚åˆ†å¸ƒå¼ç³»ç»Ÿè¿˜å…·æœ‰é«˜å¯é æ€§ï¼Œå› ä¸ºå³ä½¿å…¶ä¸­ä¸€ä¸ªè®¡ç®—æœºå‘ç”Ÿæ•…éšœï¼Œç³»ç»Ÿä¹Ÿå¯ä»¥ç»§ç»­è¿è¡Œï¼Œä¸ä¼šå› ä¸ºå•ä¸€ç‚¹çš„æ•…éšœè€Œå®Œå…¨å´©æºƒã€‚åˆ†å¸ƒå¼ç³»ç»Ÿè¿˜å¯ä»¥æä¾›æ›´å¥½çš„æ€§èƒ½å’Œæ›´å¿«çš„å“åº”æ—¶é—´ï¼Œå› ä¸ºå¯ä»¥å°†ä»»åŠ¡åˆ†é…ç»™å¤šä¸ªè®¡ç®—æœºå¹¶è¡Œå¤„ç†ï¼Œè€Œä¸æ˜¯ä¾é å•ä¸ªè®¡ç®—æœºæ¥å¤„ç†æ‰€æœ‰ä»»åŠ¡ã€‚</p><p>åˆ†å¸ƒå¼ç³»ç»Ÿçš„åº”ç”¨éå¸¸å¹¿æ³›ï¼ŒåŒ…æ‹¬äº‘è®¡ç®—ã€å¤§æ•°æ®å¤„ç†ã€åˆ†å¸ƒå¼æ•°æ®åº“ã€åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿã€åˆ†å¸ƒå¼æœç´¢å¼•æ“ç­‰ç­‰ã€‚</p><h2 id="1-2-ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ç³»ç»Ÿ"><a href="#1-2-ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ç³»ç»Ÿ" class="headerlink" title="1.2 ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ç³»ç»Ÿ"></a>1.2 ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼ç³»ç»Ÿ</h2><p>åˆ†å¸ƒå¼ç³»ç»Ÿæ˜¯ç”±å¤šä¸ªç‹¬ç«‹è®¡ç®—æœºç»„æˆçš„ç½‘ç»œï¼Œè¿™äº›è®¡ç®—æœºé€šè¿‡ç½‘ç»œäº’ç›¸é€šä¿¡å’Œåè°ƒï¼Œå…±åŒå®ŒæˆæŸäº›ä»»åŠ¡æˆ–æä¾›æŸäº›æœåŠ¡ã€‚åˆ†å¸ƒå¼ç³»ç»Ÿä¹‹æ‰€ä»¥é‡è¦ï¼Œæ˜¯å› ä¸ºå®ƒå¯ä»¥å¸¦æ¥ä»¥ä¸‹å‡ ä¸ªå¥½å¤„ï¼š</p><ol><li>å¯é æ€§ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿå¯ä»¥æé«˜ç³»ç»Ÿçš„å¯é æ€§ï¼Œå› ä¸ºå®ƒå¯ä»¥åœ¨æŸä¸ªèŠ‚ç‚¹æˆ–å¤šä¸ªèŠ‚ç‚¹å‘ç”Ÿæ•…éšœçš„æƒ…å†µä¸‹ç»§ç»­å·¥ä½œã€‚</li><li>å¯æ‰©å±•æ€§ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿå¯ä»¥é€šè¿‡å¢åŠ è®¡ç®—æœºèŠ‚ç‚¹æ¥æ‰©å±•ç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›ï¼Œä»è€Œåº”å¯¹æ›´å¤§çš„å·¥ä½œè´Ÿè½½ã€‚</li><li>é«˜æ€§èƒ½ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿå¯ä»¥å°†ä»»åŠ¡åˆ†å‰²æˆå¤šä¸ªå­ä»»åŠ¡ï¼Œå¹¶åœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šå¹¶è¡Œå¤„ç†ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¤„ç†é€Ÿåº¦ã€‚</li><li>è´Ÿè½½å‡è¡¡ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿå¯ä»¥å°†è´Ÿè½½åˆ†é…åˆ°å¤šä¸ªèŠ‚ç‚¹ä¸Šï¼Œé¿å…æŸä¸ªèŠ‚ç‚¹è¿‡åº¦è´Ÿè½½çš„æƒ…å†µå‘ç”Ÿï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯ç”¨æ€§ã€‚</li><li>æ•°æ®å…±äº«ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿå¯ä»¥è®©ä¸åŒèŠ‚ç‚¹ä¹‹é—´å…±äº«æ•°æ®ï¼Œä»è€Œä½¿å¾—æ•°æ®æ›´å®¹æ˜“è¢«è®¿é—®å’Œå¤„ç†ã€‚</li></ol><p>æ€»ä¹‹ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿå¯ä»¥æé«˜ç³»ç»Ÿçš„å¯é æ€§ã€å¯æ‰©å±•æ€§ã€é«˜æ€§èƒ½å’Œè´Ÿè½½å‡è¡¡èƒ½åŠ›ï¼Œä½¿å¾—ç³»ç»Ÿæ›´åŠ ç¨³å®šå’Œé«˜æ•ˆã€‚å› æ­¤ï¼Œåœ¨å¤§è§„æ¨¡åº”ç”¨ä¸­ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿå·²æˆä¸ºä¸€ç§å¿…è¦çš„æŠ€æœ¯æ‰‹æ®µã€‚</p><h2 id="1-3-åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç¤ºä¾‹"><a href="#1-3-åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç¤ºä¾‹" class="headerlink" title="1.3 åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç¤ºä¾‹"></a>1.3 åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç¤ºä¾‹</h2><h3 id="1-3-1-æœç´¢å¼•æ“"><a href="#1-3-1-æœç´¢å¼•æ“" class="headerlink" title="1.3.1 æœç´¢å¼•æ“"></a>1.3.1 æœç´¢å¼•æ“</h3><p>DNSæ˜¯ä¸€ä¸ªå°†IPåœ°å€å’ŒåŸŸåç›¸äº’æ˜ å°„çš„åˆ†å¸ƒå¼æ•°æ®åº“ï¼Œä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬å»ä¸­å¿ƒåŒ–ã€å¯æ‰©å±•æ€§å’Œå¥å£®æ€§ã€‚</p><p>æœç´¢å¼•æ“èƒŒåçš„åˆ†å¸ƒå¼åŸºç¡€è®¾æ–½ï¼š</p><ul><li>ä¸€ä¸ªå…¨çƒåŒ–ã€å·¨å¤§çš„å¤šæ•°æ®ä¸­å¿ƒï¼ˆä¸€ä¸ªä¸­å¿ƒä¸Šä¸‡å°ç‰©ç†æœºï¼‰</li><li>ä¸€ä¸ªåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼ˆGFSï¼‰</li><li>å¤§è§„æ¨¡ç»“æ„åŒ–æ•°æ®çš„å­˜å‚¨ç³»ç»Ÿï¼ˆBigtableï¼‰</li><li>åˆ†å¸ƒå¼é”æœåŠ¡(chubby)</li><li>å¹¶è¡Œå’Œåˆ†å¸ƒå¼è®¡ç®—çš„ç¼–ç¨‹æ¨¡å¼ï¼ˆMapReduceï¼‰</li><li>åˆ†å¸ƒå¼æ•°æ®åº“ï¼ˆSpannerï¼‰</li></ul><h3 id="1-3-2-åŠ å¯†è´§å¸"><a href="#1-3-2-åŠ å¯†è´§å¸" class="headerlink" title="1.3.2 åŠ å¯†è´§å¸"></a>1.3.2 åŠ å¯†è´§å¸</h3><p>åŠ å¯†è´§å¸å’Œåˆ†å¸ƒå¼ç³»ç»Ÿå¯†ä¸å¯åˆ†ã€‚äº‹å®ä¸Šï¼ŒåŠ å¯†è´§å¸çš„æ ¸å¿ƒæŠ€æœ¯å°±æ˜¯åŸºäºåˆ†å¸ƒå¼ç³»ç»Ÿã€‚</p><p>åŠ å¯†è´§å¸ä½¿ç”¨çš„æ˜¯ä¸€ç§ç§°ä¸ºåŒºå—é“¾çš„åˆ†å¸ƒå¼è´¦æœ¬æŠ€æœ¯ã€‚è¿™ç§æŠ€æœ¯å°†è´¦æœ¬æ•°æ®åˆ†æ•£å­˜å‚¨åœ¨ç½‘ç»œä¸Šçš„å¤šä¸ªèŠ‚ç‚¹ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰å®Œæ•´çš„è´¦æœ¬å‰¯æœ¬ï¼Œå¹¶é€šè¿‡åŠ å¯†ç®—æ³•è¿›è¡ŒéªŒè¯å’Œä¿æŠ¤ã€‚è¿™ç§åˆ†å¸ƒå¼å­˜å‚¨å’ŒéªŒè¯æ–¹å¼ä½¿å¾—åŒºå—é“¾ä¸Šçš„äº¤æ˜“è®°å½•æ— æ³•è¢«ç¯¡æ”¹æˆ–åˆ é™¤ï¼Œä»è€Œç¡®ä¿äº†åŠ å¯†è´§å¸çš„å®‰å…¨æ€§å’Œå»ä¸­å¿ƒåŒ–ç‰¹ç‚¹ã€‚</p><p>æ­¤å¤–ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿè¿˜èƒ½å¤Ÿå®ç°å»ä¸­å¿ƒåŒ–çš„äº¤æ˜“å’Œè½¬è´¦ï¼Œä»¥åŠå®ç°æ™ºèƒ½åˆçº¦ç­‰åŠŸèƒ½ã€‚æ™ºèƒ½åˆçº¦æ˜¯ä¸€ç§è‡ªåŠ¨æ‰§è¡Œçš„è®¡ç®—æœºç¨‹åºï¼Œå¯ä»¥è‡ªåŠ¨åŒ–å®Œæˆå„ç§äº‹åŠ¡ï¼Œä¾‹å¦‚æ”¯ä»˜ã€è½¬è´¦ã€æŠ•ç¥¨ç­‰ã€‚</p><p><a href="https://blog.csdn.net/weixin_40413961/article/details/122639770?ops_request_misc=%7B%22request_id%22:%22168554858916800213023799%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168554858916800213023799&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-122639770-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6&spm=1018.2226.3001.4187">(458æ¡æ¶ˆæ¯) åŒºå—é“¾æŠ€æœ¯å¿…æ€æŠ€ä¹‹â€”â€”æ™ºèƒ½åˆçº¦_åŒºå—é“¾æ™ºèƒ½åˆçº¦_jeff-yçš„åšå®¢-CSDNåšå®¢</a></p><p>æ€»çš„æ¥è¯´ï¼ŒåŠ å¯†è´§å¸å’Œåˆ†å¸ƒå¼ç³»ç»Ÿå¯†åˆ‡ç›¸å…³ï¼ŒåŠ å¯†è´§å¸çš„å®ç°ç¦»ä¸å¼€åˆ†å¸ƒå¼ç³»ç»Ÿçš„æŠ€æœ¯æ”¯æŒï¼ŒåŒæ—¶åˆ†å¸ƒå¼ç³»ç»Ÿä¹Ÿå› ä¸ºåŠ å¯†è´§å¸çš„éœ€æ±‚è€Œå¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨å’Œå‘å±•ã€‚</p><p>åŠ å¯†è´§å¸ä¸­çš„åŒºå—é“¾æŠ€æœ¯ä½¿ç”¨äº†Merkle Treeæ¥å®ç°å¿«é€ŸéªŒè¯äº¤æ˜“çš„æœ‰æ•ˆæ€§ã€‚</p><p>Merkle Treeæ˜¯ä¸€ç§æ ‘çŠ¶ç»“æ„ï¼Œå®ƒå°†æ•°æ®åˆ†æˆå°å—å¹¶å¯¹è¿™äº›å—è¿›è¡Œå“ˆå¸Œè¿ç®—ã€‚æ¯ä¸ªå“ˆå¸Œå€¼ä»£è¡¨äº†å®ƒæ‰€å¯¹åº”æ•°æ®å—çš„å†…å®¹ã€‚ç„¶åå†å°†è¿™äº›å“ˆå¸Œå€¼è¿›è¡Œå“ˆå¸Œï¼Œå¾—åˆ°æ–°çš„å“ˆå¸Œå€¼ï¼Œç§°ä¸ºçˆ¶èŠ‚ç‚¹ã€‚çˆ¶èŠ‚ç‚¹ä¹Ÿå¯ä»¥å†å’Œå…¶ä»–çˆ¶èŠ‚ç‚¹ä¸€èµ·å“ˆå¸Œï¼Œå½¢æˆæ–°çš„çˆ¶èŠ‚ç‚¹ï¼Œæœ€ç»ˆå½¢æˆæ ¹èŠ‚ç‚¹ã€‚è¿™ä¸ªè¿‡ç¨‹å°±åƒä¸€æ£µæ ‘ä¸€æ ·ï¼Œå› æ­¤è¢«ç§°ä¸ºMerkle Treeã€‚</p><p>åœ¨åŠ å¯†è´§å¸çš„äº¤æ˜“éªŒè¯ä¸­ï¼ŒMerkle Treeè¢«ç”¨æ¥å¿«é€ŸéªŒè¯æŸä¸ªäº¤æ˜“æ˜¯å¦å±äºæŸä¸ªåŒºå—ã€‚æ¯ä¸ªåŒºå—ä¸­çš„æ‰€æœ‰äº¤æ˜“æ•°æ®è¢«ç»„ç»‡æˆMerkle Treeç»“æ„ï¼Œæ ¹èŠ‚ç‚¹çš„å“ˆå¸Œå€¼è¢«åŒ…å«åœ¨åŒºå—å¤´ä¸­ã€‚å½“å…¶ä»–èŠ‚ç‚¹éœ€è¦éªŒè¯æŸä¸ªäº¤æ˜“æ˜¯å¦å±äºè¯¥åŒºå—æ—¶ï¼Œåªéœ€è¦éªŒè¯è¯¥äº¤æ˜“çš„å“ˆå¸Œå€¼ä¸Merkle Treeä¸­çš„å¯¹åº”å“ˆå¸Œå€¼æ˜¯å¦åŒ¹é…ï¼Œå¦‚æœåŒ¹é…ï¼Œåˆ™è¯¥äº¤æ˜“æœ‰æ•ˆï¼Œå¦åˆ™æ— æ•ˆã€‚</p><p>é€šè¿‡Merkle Treeçš„ç»“æ„ï¼Œäº¤æ˜“æ•°æ®å¯ä»¥è¢«é«˜æ•ˆåœ°ç»„ç»‡å’ŒéªŒè¯ï¼Œä»è€Œæé«˜äº†åŠ å¯†è´§å¸ç³»ç»Ÿçš„å®‰å…¨æ€§å’Œæ•ˆç‡ã€‚</p><h2 id="1-4-åˆ†å¸ƒå¼ç³»ç»Ÿçš„æŒ‘æˆ˜"><a href="#1-4-åˆ†å¸ƒå¼ç³»ç»Ÿçš„æŒ‘æˆ˜" class="headerlink" title="1.4 åˆ†å¸ƒå¼ç³»ç»Ÿçš„æŒ‘æˆ˜"></a>1.4 åˆ†å¸ƒå¼ç³»ç»Ÿçš„æŒ‘æˆ˜</h2><p>ç½‘ç»œå»¶è¿Ÿé—®é¢˜ï¼Œéƒ¨åˆ†å¤±æ•ˆé—®é¢˜ï¼Œæ—¶é’Ÿé—®é¢˜</p><h3 id="1-4-1-ç½‘ç»œå»¶è¿Ÿé—®é¢˜"><a href="#1-4-1-ç½‘ç»œå»¶è¿Ÿé—®é¢˜" class="headerlink" title="1.4.1 ç½‘ç»œå»¶è¿Ÿé—®é¢˜"></a>1.4.1 ç½‘ç»œå»¶è¿Ÿé—®é¢˜</h3><p>åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ç½‘ç»œå»¶è¿Ÿæ˜¯ä¸€ä¸ªå¸¸è§çš„é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯åœ¨è·¨è¶Šä¸åŒçš„åœ°ç†ä½ç½®å’Œæ•°æ®ä¸­å¿ƒæ—¶ã€‚ç½‘ç»œå»¶è¿ŸæŒ‡çš„æ˜¯ä»ä¸€ä¸ªèŠ‚ç‚¹å‘é€æ¶ˆæ¯åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹æ‰€éœ€çš„æ—¶é—´ã€‚è¿™ä¸ªæ—¶é—´å¯ä»¥å—åˆ°å¤šç§å› ç´ çš„å½±å“ï¼ŒåŒ…æ‹¬ç½‘ç»œæ‹“æ‰‘ã€å¸¦å®½ã€ä¼ è¾“åè®®å’Œç½‘ç»œæ‹¥å¡ç­‰ã€‚</p><p>ä¸ºäº†é™ä½ç½‘ç»œå»¶è¿Ÿï¼Œå¯ä»¥é‡‡å–ä»¥ä¸‹æªæ–½ï¼š</p><ol><li>ç½‘ç»œæ‹“æ‰‘ä¼˜åŒ–ï¼šè®¾è®¡ä¸€ä¸ªåˆç†çš„ç½‘ç»œæ‹“æ‰‘ï¼Œä½¿å¾—èŠ‚ç‚¹ä¹‹é—´çš„è·ç¦»å°½å¯èƒ½çŸ­ï¼Œå‡å°‘ç½‘ç»œä¼ è¾“æ‰€éœ€çš„æ—¶é—´ã€‚</li><li>åè®®é€‰æ‹©ä¼˜åŒ–ï¼šé€‰æ‹©åˆé€‚çš„åè®®ï¼Œä¾‹å¦‚ä½¿ç”¨TCP&#x2F;IPåè®®æ—¶å¯ä»¥é‡‡ç”¨TCPå¿«é€Ÿæ‰“å¼€ï¼ˆTCP Fast Openï¼‰åè®®æ¥å‡å°‘æ¡æ‰‹æ—¶é—´ï¼Œæˆ–ä½¿ç”¨UDPåè®®æ¥å‡å°‘ä¼ è¾“å»¶è¿Ÿã€‚</li><li>æ•°æ®å‹ç¼©ä¼˜åŒ–ï¼šå¯¹éœ€è¦ä¼ è¾“çš„æ•°æ®è¿›è¡Œå‹ç¼©ï¼Œå¯ä»¥å‡å°‘æ•°æ®ä¼ è¾“é‡ï¼Œä»è€Œå‡å°‘ç½‘ç»œä¼ è¾“æ‰€éœ€çš„æ—¶é—´ã€‚</li><li>ç¼“å­˜ä¼˜åŒ–ï¼šä½¿ç”¨ç¼“å­˜æŠ€æœ¯å¯ä»¥å‡å°‘å¯¹æ•°æ®çš„é‡å¤è®¿é—®ï¼Œä»è€Œå‡å°‘ç½‘ç»œä¼ è¾“æ‰€éœ€çš„æ—¶é—´ã€‚</li><li>è´Ÿè½½å‡è¡¡ä¼˜åŒ–ï¼šä½¿ç”¨è´Ÿè½½å‡è¡¡æŠ€æœ¯å¯ä»¥å°†è¯·æ±‚åˆ†æ•£åˆ°å¤šä¸ªèŠ‚ç‚¹ä¸Šï¼Œå‡å°‘å•ä¸ªèŠ‚ç‚¹çš„è´Ÿè½½ï¼Œä»è€Œå‡å°‘ç½‘ç»œä¼ è¾“æ‰€éœ€çš„æ—¶é—´ã€‚</li></ol><p>ç»¼ä¸Šæ‰€è¿°ï¼Œç½‘ç»œå»¶è¿Ÿæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ä¸€ä¸ªé‡è¦é—®é¢˜ï¼Œéœ€è¦é‡‡å–å¤šç§ä¼˜åŒ–æªæ–½æ¥é™ä½å»¶è¿Ÿï¼Œæé«˜ç³»ç»Ÿçš„æ€§èƒ½å’Œå¯é æ€§ã€‚</p><h3 id="1-4-2-éƒ¨åˆ†å¤±æ•ˆé—®é¢˜"><a href="#1-4-2-éƒ¨åˆ†å¤±æ•ˆé—®é¢˜" class="headerlink" title="1.4.2 éƒ¨åˆ†å¤±æ•ˆé—®é¢˜"></a>1.4.2 éƒ¨åˆ†å¤±æ•ˆé—®é¢˜</h3><p>åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„éƒ¨åˆ†å¤±æ•ˆé—®é¢˜æ˜¯æŒ‡åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æŸäº›èŠ‚ç‚¹æˆ–è€…æœåŠ¡å‘ç”Ÿæ•…éšœæˆ–å¤±æ•ˆï¼Œè€Œç³»ç»Ÿçš„å…¶ä»–éƒ¨åˆ†ä»ç„¶æ­£å¸¸è¿è¡Œã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿéœ€è¦é‡‡å–æªæ–½æ¥ä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œç¨³å®šæ€§ã€‚</p><p>ä»¥ä¸‹æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­è§£å†³éƒ¨åˆ†å¤±æ•ˆé—®é¢˜çš„ä¸€äº›å¸¸è§æ–¹æ³•ï¼š</p><ol><li>å†—ä½™å¤‡ä»½ï¼šé€šè¿‡åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¢åŠ å†—ä½™èŠ‚ç‚¹æˆ–æœåŠ¡æ¥ä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚å½“æŸäº›èŠ‚ç‚¹æˆ–æœåŠ¡å¤±æ•ˆæ—¶ï¼Œå†—ä½™èŠ‚ç‚¹æˆ–æœåŠ¡å¯ä»¥æ¥ç®¡å…¶å·¥ä½œï¼Œä»è€Œä¿è¯ç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œã€‚</li><li>è´Ÿè½½å‡è¡¡ï¼šå°†è¯·æ±‚åˆ†æ•£åˆ°å¤šä¸ªèŠ‚ç‚¹ä¸Šï¼Œå¯ä»¥å‡è½»å•ä¸ªèŠ‚ç‚¹çš„è´Ÿæ‹…ï¼Œä»è€Œå‡å°‘æ•…éšœçš„å‘ç”Ÿæ¦‚ç‡ã€‚è´Ÿè½½å‡è¡¡ä¹Ÿå¯ä»¥å°†è¯·æ±‚è½¬å‘åˆ°æœ€è¿‘çš„å¯ç”¨èŠ‚ç‚¹ä¸Šï¼Œæé«˜ç³»ç»Ÿçš„æ€§èƒ½å’Œå¯ç”¨æ€§ã€‚</li><li>å¼‚å¸¸æ£€æµ‹å’Œæ¢å¤ï¼šå½“æŸäº›èŠ‚ç‚¹æˆ–æœåŠ¡å‘ç”Ÿæ•…éšœæ—¶ï¼Œéœ€è¦åŠæ—¶æ£€æµ‹å¹¶é‡‡å–æ°å½“çš„æªæ–½è¿›è¡Œæ¢å¤ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨å¼‚å¸¸æ£€æµ‹å’Œæ¢å¤æœºåˆ¶æ¥å®ç°ï¼Œä¾‹å¦‚ä½¿ç”¨å¿ƒè·³æ£€æµ‹æœºåˆ¶æ¥æ£€æµ‹èŠ‚ç‚¹æˆ–æœåŠ¡æ˜¯å¦å­˜æ´»ã€‚</li><li>é™æµå’Œç†”æ–­ï¼šå½“æŸäº›èŠ‚ç‚¹æˆ–æœåŠ¡çš„è´Ÿè½½è¿‡é«˜æ—¶ï¼Œå¯ä»¥é‡‡ç”¨é™æµå’Œç†”æ–­æœºåˆ¶æ¥ä¿æŠ¤ç³»ç»Ÿå…å—è¿‡åº¦è´Ÿè½½çš„å½±å“ã€‚é™æµæœºåˆ¶å¯ä»¥æ§åˆ¶æµé‡çš„é€Ÿç‡ï¼Œç†”æ–­æœºåˆ¶å¯ä»¥æš‚æ—¶å…³é—­æŸäº›èŠ‚ç‚¹æˆ–æœåŠ¡ï¼Œä»¥é˜²æ­¢å®ƒä»¬çš„æ•…éšœå½±å“æ•´ä¸ªç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œã€‚</li><li>äº‹åŠ¡å¤„ç†å’Œå›æ»šï¼šå½“æŸäº›èŠ‚ç‚¹æˆ–æœåŠ¡å‘ç”Ÿæ•…éšœæ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´åˆ†å¸ƒå¼äº‹åŠ¡å¤±è´¥ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦é‡‡å–äº‹åŠ¡å¤„ç†å’Œå›æ»šæœºåˆ¶æ¥æ¢å¤æ•…éšœï¼Œä¿è¯æ•°æ®çš„ä¸€è‡´æ€§å’Œå¯é æ€§ã€‚</li></ol><p>ç»¼ä¸Šæ‰€è¿°ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„éƒ¨åˆ†å¤±æ•ˆé—®é¢˜æ˜¯ä¸€ä¸ªå¸¸è§çš„æŒ‘æˆ˜ï¼Œéœ€è¦é‡‡å–å¤šç§æŠ€æœ¯å’Œæœºåˆ¶æ¥ä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œç¨³å®šæ€§ã€‚</p><h3 id="1-4-3-æ—¶é’Ÿé—®é¢˜"><a href="#1-4-3-æ—¶é’Ÿé—®é¢˜" class="headerlink" title="1.4.3 æ—¶é’Ÿé—®é¢˜"></a>1.4.3 æ—¶é’Ÿé—®é¢˜</h3><p>åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ—¶é’Ÿé—®é¢˜æ˜¯æŒ‡ç”±äºç³»ç»Ÿä¸­çš„èŠ‚ç‚¹ä½äºä¸åŒçš„åœ°ç†ä½ç½®ï¼Œæ‰€ä»¥èŠ‚ç‚¹çš„æ—¶é’Ÿå­˜åœ¨åå·®å’Œä¸åŒæ­¥çš„é—®é¢˜ã€‚æ—¶é’Ÿåå·®å’Œä¸åŒæ­¥ä¼šå¯¼è‡´åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ•°æ®åŒæ­¥ã€äº‹åŠ¡å¤„ç†å’Œåè®®æ‰§è¡Œç­‰æ–¹é¢å‡ºç°é—®é¢˜ï¼Œä»è€Œå½±å“ç³»ç»Ÿçš„æ­£ç¡®æ€§å’Œå¯é æ€§ã€‚</p><p>ä»¥ä¸‹æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­è§£å†³æ—¶é’Ÿé—®é¢˜çš„ä¸€äº›å¸¸è§æ–¹æ³•ï¼š</p><ol><li>ç‰©ç†æ—¶é’ŸåŒæ­¥ï¼šç‰©ç†æ—¶é’ŸåŒæ­¥æ˜¯é€šè¿‡ä½¿ç”¨ç½‘ç»œæ—¶é—´åè®®ï¼ˆNTPï¼‰æˆ–å…¶ä»–æ—¶é’ŸåŒæ­¥åè®®æ¥ä¿è¯ç³»ç»Ÿä¸­çš„èŠ‚ç‚¹æ—¶é’Ÿä¿æŒåŒæ­¥ã€‚è¿™å¯ä»¥å‡å°‘èŠ‚ç‚¹ä¹‹é—´çš„æ—¶é’Ÿåå·®ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¯é æ€§å’Œæ­£ç¡®æ€§ã€‚</li><li>é€»è¾‘æ—¶é’Ÿï¼šé€»è¾‘æ—¶é’Ÿæ˜¯ä¸€ç§åŸºäºäº‹ä»¶é¡ºåºçš„æ—¶é’Ÿï¼Œå¯ä»¥ç”¨äºè·¨è¶Šä¸åŒèŠ‚ç‚¹çš„äº‹ä»¶é¡ºåºæ ‡è®°ã€‚ä¾‹å¦‚ï¼ŒLamportæ—¶é’Ÿå’Œå‘é‡æ—¶é’Ÿå¯ä»¥è®°å½•äº‹ä»¶çš„å‘ç”Ÿé¡ºåºï¼Œå¹¶é€šè¿‡æ¯”è¾ƒæ—¶é—´æˆ³æ¥ç¡®å®šäº‹ä»¶çš„å…ˆåå…³ç³»ã€‚</li><li>æ—¶é’Ÿæ¼‚ç§»å’Œä¿®æ­£ï¼šç”±äºç¡¬ä»¶æ—¶é’Ÿå­˜åœ¨æ¼‚ç§»ï¼Œå› æ­¤éœ€è¦å®šæœŸå¯¹æ—¶é’Ÿè¿›è¡Œä¿®æ­£ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨æ—¶é—´åŒæ­¥åè®®æ¥æ ¡æ­£æ—¶é’Ÿæ¼‚ç§»ï¼Œæˆ–è€…åœ¨èŠ‚ç‚¹ä¹‹é—´è¿›è¡Œæ—¶é’Ÿæ ¡å‡†ï¼Œä»è€Œå‡å°‘æ—¶é’Ÿæ¼‚ç§»çš„å½±å“ã€‚</li><li>æ—¶é’Ÿå®¹å¿åº¦ï¼šæ—¶é’Ÿå®¹å¿åº¦æ˜¯æŒ‡åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æ¥å—çš„æ—¶é’Ÿè¯¯å·®èŒƒå›´ã€‚èŠ‚ç‚¹ä¹‹é—´çš„æ—¶é’Ÿè¯¯å·®è¶…å‡ºå®¹å¿åº¦èŒƒå›´æ—¶ï¼Œç³»ç»Ÿä¼šé‡‡å–ç›¸åº”çš„æªæ–½æ¥é¿å…æ—¶é’Ÿé—®é¢˜å¯¹ç³»ç»Ÿäº§ç”Ÿä¸è‰¯å½±å“ã€‚</li></ol><p>ç»¼ä¸Šæ‰€è¿°ï¼Œæ—¶é’Ÿé—®é¢˜æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ä¸€ä¸ªé‡è¦æŒ‘æˆ˜ï¼Œéœ€è¦é‡‡å–å¤šç§æŠ€æœ¯å’Œæœºåˆ¶æ¥è§£å†³ã€‚ç‰©ç†æ—¶é’ŸåŒæ­¥ã€é€»è¾‘æ—¶é’Ÿã€æ—¶é’Ÿæ¼‚ç§»å’Œä¿®æ­£ä»¥åŠæ—¶é’Ÿå®¹å¿åº¦ç­‰æŠ€æœ¯å’Œæœºåˆ¶å¯ä»¥ç”¨æ¥è§£å†³æ—¶é’Ÿé—®é¢˜ï¼Œæé«˜ç³»ç»Ÿçš„å¯é æ€§å’Œæ­£ç¡®æ€§ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åˆ†å¸ƒå¼ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ†å¸ƒå¼ç³»ç»Ÿ </tag>
            
            <tag> æ·±å…¥ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>C++åˆ·é¢˜</title>
      <link href="/2024/06/24/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"/>
      <url>/2024/06/24/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h1 id="æ•°æ®ç»“æ„ä¸ç®—æ³•"><a href="#æ•°æ®ç»“æ„ä¸ç®—æ³•" class="headerlink" title="æ•°æ®ç»“æ„ä¸ç®—æ³•"></a>æ•°æ®ç»“æ„ä¸ç®—æ³•</h1><p>[(459æ¡æ¶ˆæ¯) ã€Cè¯­è¨€ã€‘ç¨‹åºè¿è¡Œè¿‡ç¨‹ï¼šé¢„å¤„ç†&#x2F;ç¼–è¯‘&#x2F;æ±‡ç¼–&#x2F;é“¾æ¥_é¢„å¤„ç†ç¼–è¯‘æ±‡ç¼–é“¾æ¥_æ…•é›ªåå¹´çš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/muxuen/article/details/123227200?ops_request_misc=%7B%22request_id%22:%22168596052316800182799736%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168596052316800182799736&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-123227200-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=%E9%A2%84%E5%A4%84%E7%90%86">https://blog.csdn.net/muxuen/article/details/123227200?ops_request_misc=%7B%22request%5Fid%22%3A%22168596052316800182799736%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=168596052316800182799736&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-123227200-null-null.142^v88^control_2,239^v2^insert_chatgpt&amp;utm_term=é¢„å¤„ç†</a> ç¼–è¯‘ æ±‡ç¼– é“¾æ¥&amp;spm&#x3D;1018.2226.3001.4187)</p><p><a href="https://blog.csdn.net/weixin_54338498/article/details/126953046?ops_request_misc=%7B%22request_id%22:%22168175034116800197040062%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168175034116800197040062&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-126953046-null-null.142%5Ev84%5Epc_search_v2,239%5Ev2%5Einsert_chatgpt&utm_term=%E4%BF%9D%E7%A0%94%E6%9C%BA%E8%AF%95&spm=1018.2226.3001.4187">(443æ¡æ¶ˆæ¯) ä¿ç ”æœºè¯•â€”â€”1åŸºç¡€ç®—æ³•ï¼ˆæ’åºã€å“ˆå¸Œã€æ¨¡æ‹Ÿï¼ˆæ—¥æœŸã€å›¾å½¢ã€æŸ¥æ‰¾ã€è¿›åˆ¶ã€å­—ç¬¦ä¸²ï¼‰ã€é€’å½’ä¸åˆ†æ²»ã€è´ªå¿ƒï¼‰_Yuezero_çš„åšå®¢-CSDNåšå®¢</a></p><p>[(425æ¡æ¶ˆæ¯) æ•°æ®ç»“æ„ä¿ç ”é¢è¯•é¢˜æ•´ç†ï¼ˆè‡ªç”¨ï¼‰_ä¿ç ”æ•°æ®ç»“æ„å¸¸æ¸©é—®é¢˜_ä¹Œé¸¡æ‘¸é±¼çš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/m0_52571748/article/details/120505195?ops_request_misc=&request_id=&biz_id=102&utm_term=%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84">https://blog.csdn.net/m0_52571748/article/details/120505195?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=æ•°æ®ç»“æ„</a> ä¿ç ”&amp;utm_medium&#x3D;distribute.pc_search_result.none-task-blog-2<del>all</del>sobaiduweb~default-0-120505195.142^v73^pc_search_v2,201^v4^add_ask,239^v2^insert_chatgpt&amp;spm&#x3D;1018.2226.3001.4187)</p><p><a href="https://blog.csdn.net/qq_53524653/article/details/121522229?ops_request_misc=%7B%22request_id%22:%22168740926216782425172942%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168740926216782425172942&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-121522229-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=%E6%8A%98%E5%8D%8A%E6%8F%92%E5%85%A5%E6%8E%92%E5%BA%8F&spm=1018.2226.3001.4187">(463æ¡æ¶ˆæ¯) æ’å…¥æ’åºâ€“æŠ˜åŠæ’å…¥æ’åºï¼ˆæ¥ä¸€æ¥ï¼Œçœ‹ä¸€çœ‹ï¼Œèµ°è¿‡è·¯è¿‡ï¼Œä¸è¦é”™è¿‡ï¼‰_è€ èƒ¡çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://zhuanlan.zhihu.com/p/385907273">Pé—®é¢˜ã€NPé—®é¢˜ã€NPCé—®é¢˜ã€NP-hardé—®é¢˜è¯¦è§£ - çŸ¥ä¹ (zhihu.com)</a></p><p>[ä¿ç ”æœºè¯•æ•´ç† - çŸ¥ä¹ (zhihu.com)</p><p>ä»€ä¹ˆæ—¶å€™æ‰è€ƒè™‘ç”¨äºŒåˆ†ç­”æ¡ˆçš„æŠ€å·§ï¼Ÿ<br>æ­£å‘æ±‚å‡ºç­”æ¡ˆä¸å¥½å…¥æ‰‹ï¼Œæ±‚è§£ç­”æ¡ˆè¿œè¿œæ²¡æœ‰éªŒè¯ç­”æ¡ˆç®€å•ã€‚</p><p>å·²çŸ¥å‰åºååºç®—ä¸­åºæœ‰å¤šå°‘ç§ï¼š</p><p>[<a href="https://blog.csdn.net/qq_37437983/article/details/79613947">(441æ¡æ¶ˆæ¯) äºŒå‰æ ‘éå†ï¼ˆå·²çŸ¥å‰åºå’Œååºéå†ï¼Œæ±‚ä¸­åºéå†çš„å¯èƒ½çš„åºåˆ—æ•°ï¼‰_å·²çŸ¥äºŒå‰æ ‘çš„å‰åºéå†å’Œååºéå†_æˆ‘è¦å‡ºå®¶å½“é“å£«çš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://zhuanlan.zhihu.com/p/40915131"></a></p><p><a href="https://blog.csdn.net/yizhiniu_xuyw/article/details/109596961?ops_request_misc=%7B%22request_id%22:%22168707250016800213049573%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168707250016800213049573&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-109596961-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=%E5%A0%86%E6%8E%92%E5%BA%8F%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6&spm=1018.2226.3001.4187">(462æ¡æ¶ˆæ¯) å †æ’åºçš„æ—¶é—´å¤æ‚åº¦åˆ†æ_ä¸€åªç‰›_007çš„åšå®¢-CSDNåšå®¢</a></p><p>å»ºç«‹ç´¢å¼•æ ‘ï¼š[(462æ¡æ¶ˆæ¯) 2020åŒ—èˆªè®¡ç®—æœºå¤ä»¤è¥æœºè¯•é¢˜ç›®ä¸ªäººç†è§£_åŒ—èˆªå¤ä»¤è¥ æœºè¯•_å››å¤„ç¢°å£å˜¤å˜¤æ€ªçš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/Bernie_double/article/details/118190022?ops_request_misc=%7B%22request_id%22:%22168715279416800185829257%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168715279416800185829257&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-5-118190022-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=%E5%8C%97%E8%88%AA%E5%A4%8F%E4%BB%A4%E8%90%A5">https://blog.csdn.net/Bernie_double/article/details/118190022?ops_request_misc=%7B%22request%5Fid%22%3A%22168715279416800185829257%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=168715279416800185829257&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-5-118190022-null-null.142^v88^control_2,239^v2^insert_chatgpt&amp;utm_term=åŒ—èˆªå¤ä»¤è¥</a> æœºè¯•&amp;spm&#x3D;1018.2226.3001.4187)</p><h2 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h2><p>scanfåï¼Œç”¨getchar()åƒæ‰å›è½¦</p><p>è¡¨ç¤ºæœ€å¤§ INT_MAX(climits)</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//malloc</span></span><br><span class="line"><span class="type">int</span> *nums;</span><br><span class="line">nums=(*<span class="type">int</span>)<span class="built_in">malloc</span>(<span class="number">10</span>*<span class="built_in">sizeof</span>(<span class="type">int</span>));</span><br><span class="line"><span class="comment">//long long int åˆ«ç”¨cin cout</span></span><br><span class="line"><span class="type">long</span> <span class="type">long</span> a;</span><br><span class="line"><span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>,&amp;a);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,a);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>scanfè¿˜ä¼šè¿”å›æˆåŠŸè¾“å…¥çš„å˜é‡çš„ä¸ªæ•°,å› æ­¤å¯åˆ¤å®šEOF</p><p>Floydåˆ¤åœˆæ³•å¾ˆåŠ</p><p>1.lower_bound(v.begin(), v.end(), key)-v.begin()è¿”å›æœ‰åºåºåˆ—ä¸­å¤§äºç­‰äºkeyçš„ç¬¬ä¸€ä¸ªå€¼çš„ä½ç½®<br>2.upper_bound(v.begin(), v.end(), key)-v.begin()è¿”å›æœ‰åºåºåˆ—ä¸­å¤§äºkeyçš„ç¬¬ä¸€ä¸ªå€¼çš„ä½ç½®<br>3.lower_bound(v.begin(), v.end(), key, greater<int>())-v.begin()è¿”å›æœ‰åºåºåˆ—ä¸­å°äºç­‰äºkeyçš„ç¬¬ä¸€ä¸ªå€¼çš„ä½ç½®<br>4.upper_bound(v.begin(), v.end(), key, greater<int>())-v.begin()è¿”å›æœ‰åºåºåˆ—ä¸­å°äºkeyçš„ç¬¬ä¸€ä¸ªå€¼çš„ä½ç½®<br>5.ä¸Šè¿°å››ä¸ªå‡½æ•°ï¼Œè‹¥æ— æ»¡è¶³æ¡ä»¶çš„å€¼ï¼Œåˆ™è¿”å›v.size() </p><h3 id="æ–‡ä»¶æ“ä½œ"><a href="#æ–‡ä»¶æ“ä½œ" class="headerlink" title="æ–‡ä»¶æ“ä½œ"></a>æ–‡ä»¶æ“ä½œ</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">freopen</span>(<span class="string">&quot;1.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line"><span class="built_in">freopen</span>(<span class="string">&quot;1.out&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span><br></pre></td></tr></table></figure><h2 id="ä¸€äº›å¸¸ç”¨çš„åº“"><a href="#ä¸€äº›å¸¸ç”¨çš„åº“" class="headerlink" title="ä¸€äº›å¸¸ç”¨çš„åº“"></a>ä¸€äº›å¸¸ç”¨çš„åº“</h2><ol><li>algorithm</li><li>vector</li><li>map</li><li>queue</li><li>iostream</li><li>string</li><li>bits&#x2F;stdc++.hï¼ˆå¸¦ä¸Šå°±å¯¹äº†ï¼‰</li><li>cmath(sqrtä¹‹ç±»çš„)</li><li>climitsï¼ˆINT_MAX INT_MINï¼‰</li></ol><p><strong>STLå†…ç½®find()å¤æ‚åº¦</strong>ï¼š<br><code>algorithmçš„find</code> å¤æ‚åº¦æ˜¯<code>O(n)</code>ï¼Œå¯¹vectorï¼Œstringç­‰ é¡ºåºæŸ¥è¯¢ã€‚<br><code>map::find</code> å’Œ <code>set::find</code> å¤æ‚åº¦æ˜¯<code>O(logn)</code>ï¼Œå› ä¸ºmapå’Œsetåº•å±‚éƒ½æ˜¯çº¢é»‘æ ‘ã€‚</p><hr><h3 id="vector"><a href="#vector" class="headerlink" title="vector:"></a><strong>vector:</strong></h3><p>ä¸‹é¢æ˜¯ä¸€äº›å¸¸ç”¨çš„vectoræ–¹æ³•ï¼š</p><ol><li><p><code>push_back</code>ï¼šåœ¨vectorçš„æœ«å°¾æ·»åŠ ä¸€ä¸ªå…ƒç´ ã€‚</p></li><li><p><code>pop_back</code>ï¼šåˆ é™¤vectoræœ«å°¾çš„ä¸€ä¸ªå…ƒç´ ã€‚</p></li><li><p><code>size</code>ï¼šè¿”å›vectorä¸­å…ƒç´ çš„ä¸ªæ•°ã€‚</p></li><li><p><code>clear</code>ï¼šåˆ é™¤vectorä¸­æ‰€æœ‰çš„å…ƒç´ ã€‚</p></li><li><p><code>empty</code>ï¼šåˆ¤æ–­vectoræ˜¯å¦ä¸ºç©ºã€‚</p></li><li><p><code>at</code>ï¼šè¿”å›vectorä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚</p></li><li><p><code>front</code>ï¼šè¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</p></li><li><p><code>back</code>ï¼šè¿”å›æœ€åä¸€ä¸ªå…ƒç´ ã€‚</p></li><li><p><code>erase</code>ï¼šåˆ é™¤vectorä¸­æŒ‡å®šä½ç½®çš„å…ƒç´ ã€‚</p></li><li><p><code>insert</code>ï¼šåœ¨vectorä¸­æŒ‡å®šä½ç½®æ’å…¥ä¸€ä¸ªå…ƒç´ æˆ–å¤šä¸ªå…ƒç´ ã€‚</p></li><li><p><code>resize</code>ï¼šæ”¹å˜vectorçš„å¤§å°ã€‚</p></li><li><p><code>reserve</code>ï¼šä¸ºvectoré¢„ç•™ä¸€å®šçš„ç©ºé—´ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">reverse</span>(a.<span class="built_in">begin</span>(),a.<span class="built_in">end</span>());</span><br></pre></td></tr></table></figure></li><li><p><code>swap</code>ï¼šäº¤æ¢ä¸¤ä¸ªvectorä¸­çš„å…ƒç´ ã€‚</p></li><li><p><code>begin</code>ï¼šè¿”å›æŒ‡å‘vectorç¬¬ä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨ã€‚</p></li><li><p><code>end</code>ï¼šè¿”å›æŒ‡å‘vectoræœ€åä¸€ä¸ªå…ƒç´ ä¹‹åçš„è¿­ä»£å™¨ã€‚ è¿™äº›æ–¹æ³•èƒ½å¤Ÿæ»¡è¶³å¤§éƒ¨åˆ†æƒ…å†µä¸‹çš„éœ€æ±‚ï¼Œå¯ä»¥æ ¹æ®å…·ä½“çš„ä½¿ç”¨åœºæ™¯é€‰æ‹©åˆé€‚çš„æ–¹æ³•è¿›è¡Œæ“ä½œã€‚</p></li></ol><p>è¦å–è¿­ä»£å™¨çš„å€¼ï¼Œç›´æ¥*æŒ‡é’ˆå–å€¼</p><p>å¯¹äºå‘é‡(vector)ï¼Œå®ƒæ˜¯ä¸€ç§æ”¯æŒéšæœºè®¿é—®çš„å®¹å™¨ï¼Œå› æ­¤<strong>å¯ä»¥ç›´æ¥é€šè¿‡ä¸‹æ ‡è®¿é—®å‘é‡ä¸­çš„å…ƒç´ </strong>ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="type">int</span>&gt; v = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line"><span class="comment">// ä½¿ç”¨autoå…³é”®å­—å®šä¹‰è¿­ä»£å™¨</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> it = v.<span class="built_in">begin</span>(); it != v.<span class="built_in">end</span>(); it++) &#123;</span><br><span class="line">    cout &lt;&lt; *it &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>vectorä¸èƒ½ç›´æ¥ä½¿ç”¨sortå‡½æ•°è¿›è¡Œæ’åºï¼Œéœ€è¦ä¼ å…¥ä¸€ä¸ªè¿­ä»£å™¨æŒ‡å®šæ’åºçš„èŒƒå›´ã€‚ä¿®æ”¹ä»£ç å¦‚ä¸‹ï¼š</p><p>sort(v.begin(),v.end(),com);</p><hr><h3 id="map"><a href="#map" class="headerlink" title="map"></a><strong>map</strong></h3><p>ä»¥ä¸‹æ˜¯C++ä¸­mapç±»çš„å¸¸ç”¨æ–¹æ³•ï¼š</p><ol><li><p>insert(make_pair&lt;key, value&gt;)ï¼šå‘mapä¸­æ’å…¥ä¸€ä¸ªé”®å€¼å¯¹ã€‚</p></li><li><p>erase(key)ï¼šåˆ é™¤mapä¸­æŒ‡å®šé”®çš„å…ƒç´ ã€‚</p></li><li><p>clear()ï¼šæ¸…ç©ºmapä¸­æ‰€æœ‰å…ƒç´ ã€‚</p></li><li><p>size()ï¼šè¿”å›mapä¸­å…ƒç´ çš„ä¸ªæ•°ã€‚</p></li><li><p>empty()ï¼šè¿”å›mapæ˜¯å¦ä¸ºç©ºã€‚</p></li><li><p>find(key)ï¼šæŸ¥æ‰¾mapä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šé”®çš„å…ƒç´ ï¼Œå¦‚æœå­˜åœ¨åˆ™è¿”å›æŒ‡å‘è¯¥å…ƒç´ çš„è¿­ä»£å™¨ï¼Œå¦åˆ™è¿”å›end()è¿­ä»£å™¨ã€‚</p><p>å¸¸å¸¸å’Œendè”åˆèµ·æ¥ç”¨åˆ¤æ–­æ‰¾åˆ°æ²¡ã€‚(<strong>è¿™ä¸ªé€‚åˆåŠ¨æ€æŸ¥æ‰¾ï¼Œåº•å±‚çº¢é»‘æ ‘å®ç°</strong>)</p></li><li><p>count(key)ï¼šè¿”å›æŒ‡å®šé”®åœ¨mapä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å›0æˆ–1ã€‚</p></li><li><p>begin()ï¼šè¿”å›æŒ‡å‘mapç¬¬ä¸€ä¸ªå…ƒç´ çš„è¿­ä»£å™¨ã€‚</p></li><li><p>end()ï¼šè¿”å›æŒ‡å‘mapæœ€åä¸€ä¸ªå…ƒç´ åé¢çš„ä½ç½®çš„è¿­ä»£å™¨ã€‚</p></li><li><p>operator[]ï¼šé€šè¿‡é”®è®¿é—®mapä¸­çš„å…ƒç´ ï¼Œå¦‚æœé”®ä¸å­˜åœ¨ï¼Œåˆ™è‡ªåŠ¨æ’å…¥ä¸€ä¸ªæ–°çš„é”®å€¼å¯¹å¹¶è¿”å›å¯¹åº”çš„å€¼ã€‚</p></li><li><p>lower_bound(key)ï¼šè¿”å›ç¬¬ä¸€ä¸ªå¤§äºæˆ–ç­‰äºæŒ‡å®šé”®çš„å…ƒç´ çš„è¿­ä»£å™¨ã€‚</p></li><li><p>upper_bound(key)ï¼šè¿”å›ç¬¬ä¸€ä¸ªå¤§äºæŒ‡å®šé”®çš„å…ƒç´ çš„è¿­ä»£å™¨ã€‚</p></li><li><p>equal_range(key)ï¼šè¿”å›ä¸€ä¸ªpairå¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«lower_boundå’Œupper_boundè¿”å›çš„è¿­ä»£å™¨ã€‚</p></li><li><p>swap(map2)ï¼šäº¤æ¢å½“å‰mapå’Œmap2çš„å…ƒç´ ã€‚ C++ä¸­çš„mapç±»æ˜¯ä¸€ç§å…³è”å¼å®¹å™¨ï¼Œç”¨äºå­˜å‚¨é”®å€¼å¯¹ï¼Œå…¶ä¸­æ¯ä¸ªé”®éƒ½å”¯ä¸€ï¼Œå¹¶ä¸”æŒ‰ç…§ä¸€å®šçš„é¡ºåºæ’åˆ—ã€‚mapçš„åº•å±‚å®ç°é€šå¸¸æ˜¯çº¢é»‘æ ‘ï¼Œå› æ­¤æŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸ºO(log n)ï¼Œå…¶ä¸­næ˜¯mapä¸­å…ƒç´ çš„ä¸ªæ•°ã€‚mapç±»æä¾›äº†ä¸°å¯Œçš„æ–¹æ³•ï¼Œå¯ä»¥æ–¹ä¾¿åœ°è¿›è¡Œé”®å€¼å¯¹çš„æ“ä½œï¼Œä¾‹å¦‚æ’å…¥ã€åˆ é™¤ã€æŸ¥æ‰¾ã€æ’åºç­‰ã€‚åŒæ—¶ï¼Œç”±äºmapä½¿ç”¨é”®å€¼å¯¹æ¥å­˜å‚¨æ•°æ®ï¼Œå› æ­¤å¯ä»¥å°†mapçœ‹ä½œæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ•°ç»„ï¼Œå…¶ä¸‹æ ‡ä¸ºé”®ï¼Œå¯¹åº”çš„å€¼ä¸ºæ•°ç»„å…ƒç´ ã€‚å› æ­¤ï¼Œå¯ä»¥é€šè¿‡ä¸‹æ ‡æ¥è®¿é—®å’Œä¿®æ”¹mapä¸­çš„å…ƒç´ ã€‚</p></li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">map&lt;string, <span class="type">int</span>&gt; m = &#123;&#123;<span class="string">&quot;apple&quot;</span>, <span class="number">1</span>&#125;, &#123;<span class="string">&quot;banana&quot;</span>, <span class="number">2</span>&#125;, &#123;<span class="string">&quot;orange&quot;</span>, <span class="number">3</span>&#125;&#125;;</span><br><span class="line"><span class="comment">// ä½¿ç”¨autoå…³é”®å­—å®šä¹‰è¿­ä»£å™¨</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> it = m.<span class="built_in">begin</span>(); it != m.<span class="built_in">end</span>(); it++) &#123;</span><br><span class="line">    cout &lt;&lt; it-&gt;first &lt;&lt; <span class="string">&quot;: &quot;</span> &lt;&lt; it-&gt;second &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="stack"><a href="#stack" class="headerlink" title="stack"></a><strong>stack</strong></h3><p>C++ ä¸­çš„ stack åº“æä¾›äº†ä»¥ä¸‹å¸¸ç”¨çš„æ–¹æ³•ï¼š</p><ul><li>push(elem)ï¼šå°†å…ƒç´  elem å‹å…¥æ ˆé¡¶ã€‚</li><li>pop()ï¼šå¼¹å‡ºæ ˆé¡¶å…ƒç´ ã€‚</li><li>top()ï¼šè¿”å›æ ˆé¡¶å…ƒç´ ï¼Œä½†ä¸å¼¹å‡ºã€‚</li><li>empty()ï¼šåˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©ºã€‚</li><li>size()ï¼šè¿”å›æ ˆä¸­å…ƒç´ çš„ä¸ªæ•°ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œstack è¿˜æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</li><li>emplace(argsâ€¦)ï¼šæ„é€ ä¸€ä¸ªæ–°å…ƒç´ å¹¶å°†å…¶å‹å…¥æ ˆé¡¶ã€‚</li><li>swap(stack)ï¼šäº¤æ¢ä¸¤ä¸ª stack çš„å…ƒç´ ã€‚</li><li>operator&#x3D;&#x3D;ã€operator!&#x3D;ã€operator&lt;ã€operator&lt;&#x3D;ã€operator&gt;ã€operator&gt;&#x3D;ï¼šæ¯”è¾ƒä¸¤ä¸ª stack æ˜¯å¦ç›¸ç­‰ã€ä¸ç›¸ç­‰ã€å°äºã€å°äºç­‰äºã€å¤§äºã€å¤§äºç­‰äºã€‚ å…·ä½“ç”¨æ³•å¯ä»¥å‚è€ƒä¸‹é¢çš„ç¤ºä¾‹ä»£ç </li></ul><p>stackå…ƒç´ å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ã€‚</p><hr><h3 id="queue"><a href="#queue" class="headerlink" title="queue"></a><strong>queue</strong></h3><p>C++ä¸­çš„queueæ˜¯ä¸€ç§å®¹å™¨é€‚é…å™¨ï¼Œç”¨äºå®ç°â€œå…ˆè¿›å…ˆå‡ºâ€ï¼ˆFIFOï¼‰çš„æ•°æ®ç»“æ„ã€‚queueåŸºäºdequeæˆ–listè¿›è¡Œå®ç°ï¼Œæä¾›äº†ä¸€äº›æ–¹æ³•æ¥æ“ä½œé˜Ÿåˆ—ï¼ŒåŒ…æ‹¬å…¥é˜Ÿã€å‡ºé˜Ÿã€è·å–é˜Ÿé¦–å…ƒç´ ã€è·å–é˜Ÿåˆ—å¤§å°ç­‰ã€‚ä»¥ä¸‹æ˜¯queueçš„å¸¸ç”¨æ–¹æ³•ï¼š</p><ol><li>push(element)ï¼šå°†ä¸€ä¸ªå…ƒç´ åŠ å…¥é˜Ÿåˆ—çš„å°¾éƒ¨ã€‚</li><li>pop()ï¼šå°†é˜Ÿåˆ—å¤´éƒ¨çš„å…ƒç´ å¼¹å‡ºï¼Œä½†æ²¡æœ‰è¿”å›å€¼ã€‚</li><li>front()ï¼šè¿”å›é˜Ÿåˆ—å¤´éƒ¨çš„å…ƒç´ ã€‚</li><li>top():è¿”å›é˜Ÿåˆ—å¤´éƒ¨å…ƒç´ ï¼ˆå’Œfrontä¸€æ ·ï¼‰</li><li>back()ï¼šè¿”å›é˜Ÿåˆ—å°¾éƒ¨çš„å…ƒç´ ã€‚</li><li>empty()ï¼šåˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºã€‚</li><li>size()ï¼šè¿”å›é˜Ÿåˆ—ä¸­å…ƒç´ çš„ä¸ªæ•°ã€‚ ä½¿ç”¨queueéœ€è¦åŒ…å«å¤´æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åˆ›å»ºä¸€ä¸ªqueueå¯¹è±¡ï¼š</li></ol><p>å¯¹äºé˜Ÿåˆ—(queue)ï¼Œç”±äºå®ƒæ˜¯ä¸€ç§å…ˆè¿›å…ˆå‡º(FIFO)çš„æ•°æ®ç»“æ„ï¼Œå› æ­¤åªèƒ½é€šè¿‡front()å’Œback()å‡½æ•°æ¥è®¿é—®é˜Ÿåˆ—çš„å¤´éƒ¨å’Œå°¾éƒ¨å…ƒç´ ï¼Œ<strong>è€Œä¸èƒ½ç›´æ¥é€šè¿‡ä¸‹æ ‡è®¿é—®</strong>ã€‚å¦‚æœè¦ä½¿ç”¨ä¸‹æ ‡è®¿é—®é˜Ÿåˆ—å…ƒç´ ï¼Œéœ€è¦å…ˆå°†é˜Ÿåˆ—è½¬æ¢ä¸ºæ•°ç»„æˆ–å‘é‡ã€‚ </p><hr><h4 id="priority-queue"><a href="#priority-queue" class="headerlink" title="priority_queue"></a><strong>priority_queue</strong></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="comment">//å¯¹äºåŸºç¡€ç±»å‹ é»˜è®¤æ˜¯å¤§é¡¶å †</span></span><br><span class="line">    priority_queue&lt;<span class="type">int</span>&gt; a; </span><br><span class="line">    <span class="comment">//ç­‰åŒäº priority_queue&lt;int, vector&lt;int&gt;, less&lt;int&gt; &gt; a;</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    priority_queue&lt;<span class="type">int</span>, vector&lt;<span class="type">int</span>&gt;, greater&lt;<span class="type">int</span>&gt; &gt; c;  <span class="comment">//è¿™æ ·å°±æ˜¯å°é¡¶å †</span></span><br><span class="line">    priority_queue&lt;string&gt; b;</span><br></pre></td></tr></table></figure><p>å¯¹äºä¼˜å…ˆé˜Ÿåˆ—ï¼Œå¤æ‚ç»“æ„ç±»å‹è¦é‡è½½è¿ç®—ç¬¦<a href="https://blog.csdn.net/qq_27278957/article/details/85269245?ops_request_misc=%7B%22request_id%22:%22168033538216800213097640%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168033538216800213097640&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-85269245-null-null.142%5Ev80%5Einsert_down38,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&utm_term=c++%E9%87%8D%E8%BD%BD%E8%BF%90%E7%AE%97%E7%AC%A6&spm=1018.2226.3001.4187">(436æ¡æ¶ˆæ¯) C++ è¿ç®—ç¬¦é‡è½½_c é‡è½½è¿ç®—ç¬¦_é«˜ç¥¥xiangçš„åšå®¢-CSDNåšå®¢</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">complex</span>&#123;</span><br><span class="line"><span class="type">int</span> real;</span><br><span class="line"><span class="type">int</span> imag;</span><br><span class="line">......</span><br><span class="line"><span class="type">bool</span> <span class="keyword">operator</span>&lt;(Complex c)<span class="type">const</span>&#123;</span><br><span class="line"><span class="keyword">return</span> real*real+imag*imag&lt;c.real*c.real+c.imag*c.imag;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ä¸Šé¢è¿™ä¸ªconstæ˜¯å¿…é¡»è¦æœ‰çš„</p><hr><h3 id="string"><a href="#string" class="headerlink" title="string"></a><strong>string</strong></h3><p>C++ä¸­çš„stringç±»æ˜¯ä¸€ä¸ªå°è£…äº†å­—ç¬¦ä¸²æ“ä½œçš„ç±»ï¼Œæä¾›äº†ä¸€ç³»åˆ—æ–¹æ³•æ¥å¤„ç†å’Œæ“ä½œå­—ç¬¦ä¸²ã€‚ä»¥ä¸‹æ˜¯å¸¸ç”¨çš„stringç±»æ–¹æ³•ï¼š</p><ol><li><p>length()ï¼šè¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚</p></li><li><p>size()ï¼šè¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚</p></li><li><p>clear()ï¼šæ¸…ç©ºå­—ç¬¦ä¸²ã€‚</p></li><li><p>empty()ï¼šåˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºã€‚</p></li><li><p>assign(str)ï¼šå°†å­—ç¬¦ä¸²çš„å€¼è®¾ç½®ä¸ºstrã€‚</p></li><li><p>assign(str, pos, len)ï¼šå°†å­—ç¬¦ä¸²çš„å€¼è®¾ç½®ä¸ºsträ¸­ä»posä½ç½®å¼€å§‹çš„é•¿åº¦ä¸ºlençš„å­ä¸²ã€‚</p></li><li><p>append(str)ï¼šåœ¨å­—ç¬¦ä¸²çš„æœ«å°¾æ·»åŠ strã€‚</p></li><li><p>append(str, pos, len)ï¼šåœ¨å­—ç¬¦ä¸²çš„æœ«å°¾æ·»åŠ strä¸­ä»posä½ç½®å¼€å§‹çš„é•¿åº¦ä¸ºlençš„å­ä¸²ã€‚</p></li><li><p>push_back(ch)ï¼šåœ¨å­—ç¬¦ä¸²çš„æœ«å°¾æ·»åŠ ä¸€ä¸ªå­—ç¬¦ã€‚</p></li><li><p>insert(pos, str)ï¼šåœ¨å­—ç¬¦ä¸²çš„posä½ç½®æ’å…¥strã€‚</p></li><li><p>erase(pos, len)ï¼šåˆ é™¤ä»posä½ç½®å¼€å§‹é•¿åº¦ä¸ºlençš„å­ä¸²ã€‚</p><p>erase(n):åˆ é™¤indexnåé¢çš„å­—ç¬¦</p></li><li><p>replace(pos, len, str)ï¼šæ›¿æ¢ä»posä½ç½®å¼€å§‹é•¿åº¦ä¸ºlençš„å­ä¸²ä¸ºstrã€‚</p></li><li><p><strong>substr(pos, len)ï¼šè¿”å›ä»posä½ç½®å¼€å§‹é•¿åº¦ä¸ºlençš„å­ä¸²ã€‚</strong></p></li><li><p><strong>find(str)ï¼šæŸ¥æ‰¾stråœ¨å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œè¿”å›è¯¥ä½ç½®çš„ç´¢å¼•å€¼ã€‚</strong>(æ‰¾ä¸åˆ°å°±æ˜¯-1)</p></li><li><p>rfind(str)ï¼šæŸ¥æ‰¾stråœ¨å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œè¿”å›è¯¥ä½ç½®çš„ç´¢å¼•å€¼ã€‚</p></li><li><p>compare(str)ï¼šæ¯”è¾ƒå­—ç¬¦ä¸²å’Œstrçš„å¤§å°ï¼Œè¿”å›0ï¼ˆç›¸ç­‰ï¼‰ã€1ï¼ˆå¤§äºï¼‰æˆ–-1ï¼ˆå°äºï¼‰ã€‚ é™¤äº†ä»¥ä¸Šåˆ—ä¸¾çš„æ–¹æ³•ï¼Œstringç±»è¿˜æ”¯æŒé‡è½½è¿ç®—ç¬¦ï¼Œä¾‹å¦‚+ï¼ˆå­—ç¬¦ä¸²æ‹¼æ¥ï¼‰ã€+&#x3D;ï¼ˆå­—ç¬¦ä¸²æ‹¼æ¥èµ‹å€¼ï¼‰ã€&#x3D;&#x3D;ï¼ˆå­—ç¬¦ä¸²ç›¸ç­‰åˆ¤æ–­ï¼‰ã€[]ï¼ˆè®¿é—®å­—ç¬¦ä¸²ä¸­æŒ‡å®šä½ç½®çš„å­—ç¬¦ï¼‰ç­‰ã€‚stringç±»çš„ä½¿ç”¨éå¸¸æ–¹ä¾¿ï¼Œå¯ä»¥åƒä½¿ç”¨æ™®é€šå˜é‡ä¸€æ ·å¯¹å­—ç¬¦ä¸²è¿›è¡Œèµ‹å€¼ã€æ‹¼æ¥ã€æŸ¥æ‰¾ã€æ›¿æ¢ç­‰æ“ä½œã€‚ä¾‹å¦‚ï¼š</p></li></ol><p>æ³¨æ„string sï¼Œå…¶s[i]ç±»å‹ä¸ºcharï¼Œcharå¼ºåˆ¶ç±»å‹è½¬æ¢å¯ä»¥è¿™æ ·è½¬æ¢</p><p>string(1,s[i])ï¼Œ1è¡¨ç¤ºcharé•¿åº¦</p><p>s[i]å¯ä»¥ç›´æ¥æ¯”è¾ƒ</p><p>è¾“å…¥str1,å¦‚æœstr1ä¸ºç©ºåˆ™é€€å‡º</p><p><img src="C:\Users\11505\AppData\Roaming\Typora\typora-user-images\image-20230313213418581.png" alt="image-20230313213418581"></p><p>scanfä¸ä¼šè¯»å›è½¦ï¼Œå¦‚æœä¸‹ä¸€è¡Œæ˜¯getsä¼šç›´æ¥è¯»å–ç¼“å†²åŒºä¸­çš„å›è½¦ï¼Œæ‰€æœ‰ä¼šç”¨ä¸€ä¸ªgetchar()åœ¨ä¸­é—´æŠŠç¼“å†²åŒºä¸­çš„å›è½¦æŠµæ¶ˆæ‰</p><p>stoi(str) å°†å…¶è½¬æ¢ä¸ºæ•´æ•°ï¼Œæ³¨æ„ï¼Œå¦‚æœæ˜¯â€04â€,ç›´æ¥å˜æˆ4</p><p>string::nposç”¨äºåˆ¤æ–­ç»“å°¾ï¼ˆå…¶å®æ‰¾ä¸åˆ°ç›´æ¥-1ä¹Ÿè¡Œï¼‰ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//findå‡½æ•°è¿”å› jk åœ¨ s ä¸­çš„ä¸‹æ ‡ä½ç½®</span></span><br><span class="line">position = s.<span class="built_in">find</span>(<span class="string">&quot;jk&quot;</span>);</span><br><span class="line"><span class="comment">// å¦‚æœæ²¡æ‰¾åˆ°ï¼Œè¿”å›ä¸€ä¸ªç‰¹åˆ«çš„æ ‡å¿—</span></span><br><span class="line"><span class="comment">// c++ä¸­ç”¨nposè¡¨ç¤ºï¼Œæˆ‘è¿™é‡Œnposå–å€¼æ˜¯4294967295</span></span><br><span class="line"><span class="keyword">if</span>(position != s.npos)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;position: &quot;</span> &lt;&lt; position &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;Not found the flag&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¦‚æœè¾“å…¥çš„å­—ç¬¦ä¸²æœ‰ç©ºæ ¼ï¼Œé‚£ä¹ˆç”¨å¦‚ä¸‹ä»£ç </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">getline</span>(cin,str)</span><br></pre></td></tr></table></figure><p>å¯ä»¥ç›´æ¥é€šè¿‡ä¸‹æ ‡ä¿®æ”¹å­—ç¬¦</p><p>åˆ é™¤å­—ç¬¦ä¸²å†…é‡å¤å­—ç¬¦:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">string str=<span class="string">&quot;aadfgggh&quot;</span>;</span><br><span class="line"><span class="comment">//å»é‡å¤</span></span><br><span class="line"><span class="built_in">sort</span>(str.<span class="built_in">begin</span>(),str.<span class="built_in">end</span>());</span><br><span class="line">str.<span class="built_in">erase</span>(<span class="built_in">unique</span>(str.<span class="built_in">begin</span>(),str.<span class="built_in">end</span>()),str.<span class="built_in">end</span>());  </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åˆ é™¤å­—ç¬¦ä¸²å†…æŸä¸ªæŒ‡å®šå­—ç¬¦:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">string str=<span class="string">&quot;aadfgggh&quot;</span>;</span><br><span class="line">str.<span class="built_in">erase</span>(<span class="built_in">remove</span>(str.<span class="built_in">begin</span>(),str.<span class="built_in">end</span>(),<span class="string">&#x27;a&#x27;</span>),str.<span class="built_in">end</span>()); <span class="comment">//åœ¨å®¹å™¨ä¸­, åˆ é™¤[begin,end)ä¹‹é—´çš„æ‰€æœ‰å€¼ç­‰äº&#x27;a&#x27;çš„å€¼.</span></span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line">string::<span class="built_in">erase</span>(begin,end)ï¼šåˆ é™¤[begin,end)ä¹‹é—´çš„æ‰€æœ‰å€¼c</span><br></pre></td></tr></table></figure><p>åœ¨Find the Smallest Numberä¸­ï¼Œæˆ‘å‘ç°stringçš„è¶…å‡ºindexä¸€ä½çš„ä½ç½®ä¾ç„¶å¯ä»¥è®¿é—®ï¼Œä½†æ˜¯æ²¡æœ‰æ•°</p><hr><h3 id="algorithm"><a href="#algorithm" class="headerlink" title="algorithm"></a><strong>algorithm</strong></h3><p>C++æ ‡å‡†åº“ä¸­çš„algorithmåº“æä¾›äº†è®¸å¤šå¸¸ç”¨çš„ç®—æ³•ï¼Œè¿™äº›ç®—æ³•å¯ä»¥ç”¨äºå¤„ç†å®¹å™¨ä¸­çš„æ•°æ®ï¼Œä¾‹å¦‚æ’åºã€æŸ¥æ‰¾ã€éå†ç­‰ã€‚ä»¥ä¸‹æ˜¯algorithmåº“ä¸­å¸¸ç”¨çš„æ–¹æ³•ï¼š</p><ol><li>sort(first, last, func)ï¼šå¯¹[first, last)åŒºé—´å†…çš„å…ƒç´ è¿›è¡Œå‡&#x2F;é™åºæ’åºï¼ˆå–å†³äºfuncè¿”å›ï¼‰ã€‚</li><li>reverse(first, last)ï¼šå¯¹[first, last)åŒºé—´å†…çš„å…ƒç´ è¿›è¡Œç¿»è½¬ã€‚</li><li>find(first, last, val)ï¼šåœ¨[first, last)åŒºé—´å†…æŸ¥æ‰¾å€¼ä¸ºvalçš„å…ƒç´ ï¼Œè¿”å›è¯¥å…ƒç´ çš„è¿­ä»£å™¨ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œè¿”å›lastã€‚</li><li>find_if(first, last, pred)ï¼šåœ¨[first, last)åŒºé—´å†…æŸ¥æ‰¾æ»¡è¶³æ¡ä»¶predçš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œè¿”å›è¯¥å…ƒç´ çš„è¿­ä»£å™¨ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œè¿”å›lastã€‚</li><li>count(first, last, val)ï¼šç»Ÿè®¡[first, last)åŒºé—´å†…å€¼ä¸ºvalçš„å…ƒç´ ä¸ªæ•°ã€‚</li><li>count_if(first, last, pred)ï¼šç»Ÿè®¡[first, last)åŒºé—´å†…æ»¡è¶³æ¡ä»¶predçš„å…ƒç´ ä¸ªæ•°ã€‚</li><li>accumulate(first, last, init)ï¼šå¯¹[first, last)åŒºé—´å†…çš„å…ƒç´ è¿›è¡Œç´¯åŠ ï¼Œåˆå§‹å€¼ä¸ºinitã€‚</li><li>max_element(first, last)ï¼šè¿”å›[first, last)åŒºé—´å†…çš„æœ€å¤§å…ƒç´ çš„è¿­ä»£å™¨ã€‚</li><li>min_element(first, last)ï¼šè¿”å›[first, last)åŒºé—´å†…çš„æœ€å°å…ƒç´ çš„è¿­ä»£å™¨ã€‚</li><li>unique(first, last)ï¼šå¯¹[first, last)åŒºé—´å†…çš„å…ƒç´ å»é‡ï¼Œè¿”å›å»é‡åçš„æœ«å°¾è¿­ä»£å™¨ã€‚</li><li>remove(first, last, val)ï¼šåˆ é™¤[first, last)åŒºé—´å†…å€¼ä¸ºvalçš„å…ƒç´ ï¼Œè¿”å›åˆ é™¤åçš„æœ«å°¾è¿­ä»£å™¨ã€‚</li><li>remove_if(first, last, pred)ï¼šåˆ é™¤[first, last)åŒºé—´å†…æ»¡è¶³æ¡ä»¶predçš„å…ƒç´ ï¼Œè¿”å›åˆ é™¤åçš„æœ«å°¾è¿­ä»£å™¨ã€‚</li><li>for_each(first, last, func)ï¼šå¯¹[first, last)åŒºé—´å†…çš„å…ƒç´ æ‰§è¡Œæ“ä½œfuncã€‚</li><li>transform(first1, last1, first2, result, op)ï¼šå°†[first1, last1)åŒºé—´å†…çš„å…ƒç´ å’Œ[first2, â€¦)åŒºé—´å†…çš„å…ƒç´ è¿›è¡Œopæ“ä½œï¼Œå¹¶å°†ç»“æœå­˜å‚¨åˆ°[result, â€¦)åŒºé—´å†…ã€‚</li></ol><h3 id="climits"><a href="#climits" class="headerlink" title="climits"></a>climits</h3><p><climits>ä¸­å®šä¹‰çš„å¸¸é‡ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ol><li>æ•´æ•°ç±»å‹çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼šINT_MAXã€INT_MINã€LONG_MAXã€LONG_MINã€SHRT_MAXã€SHRT_MINç­‰ç­‰ã€‚</li><li>å­—ç¬¦ç±»å‹çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ï¼šCHAR_MAXã€CHAR_MINã€SCHAR_MAXã€SCHAR_MINã€UCHAR_MAXç­‰ç­‰ã€‚</li><li>ä½æ•°ç›¸å…³çš„å¸¸é‡ï¼šCHAR_BITã€INT_BITã€LONG_BITç­‰ç­‰ã€‚</li><li>å…¶ä»–å¸¸é‡ï¼šMB_LEN_MAXè¡¨ç¤ºä¸€ä¸ªå¤šå­—èŠ‚å­—ç¬¦çš„æœ€å¤§é•¿åº¦ï¼ŒFLT_MAXã€FLT_MINã€DBL_MAXã€DBL_MINç­‰ç­‰è¡¨ç¤ºæµ®ç‚¹ç±»å‹çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚</li></ol><h2 id="è®¾ç½®è¾“å‡ºç²¾åº¦"><a href="#è®¾ç½®è¾“å‡ºç²¾åº¦" class="headerlink" title="è®¾ç½®è¾“å‡ºç²¾åº¦"></a>è®¾ç½®è¾“å‡ºç²¾åº¦</h2><p>è®¾ç½®è¾“å‡ºç²¾åº¦ä¸º1ä½å°æ•°</p><p>cout &lt;&lt; fixed &lt;&lt; setprecision(1) &lt;&lt; ans &lt;&lt; endl</p><h2 id="è®¾ç½®è¾“å‡ºä½æ•°"><a href="#è®¾ç½®è¾“å‡ºä½æ•°" class="headerlink" title="è®¾ç½®è¾“å‡ºä½æ•°"></a>è®¾ç½®è¾“å‡ºä½æ•°</h2><p>printf(â€œ%02dâ€,&amp;)</p><p>å‰é¢è¡¥é›¶ï¼Œä¸¤ä½ï¼Œä¸å¤Ÿä¸¤ä½å°±è¡¥é›¶</p><h2 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h2><p><a href="https://zhuanlan.zhihu.com/p/83334559">KMP ç®—æ³•è¯¦è§£ - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://blog.csdn.net/v_JULY_v/article/details/7041827?ops_request_misc=%7B%22request_id%22:%22167957843316800227474381%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=167957843316800227474381&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-7041827-null-null.142%5Ev76%5Epc_new_rank,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&utm_term=KMP&spm=1018.2226.3001.4187">(427æ¡æ¶ˆæ¯) ä»å¤´åˆ°å°¾å½»åº•ç†è§£KMPï¼ˆ2014å¹´8æœˆ22æ—¥ç‰ˆï¼‰_kmpç®—æ³•éš¾å—æ˜¯ä»€ä¹ˆçº§åˆ«_v_JULY_vçš„åšå®¢-CSDNåšå®¢</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//next</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">GetNext</span><span class="params">(<span class="type">char</span>* p,<span class="type">int</span> next[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> pLen = <span class="built_in">strlen</span>(p);</span><br><span class="line">next[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line"><span class="type">int</span> k = <span class="number">-1</span>;</span><br><span class="line"><span class="type">int</span> j = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (j &lt; pLen - <span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//p[k]è¡¨ç¤ºå‰ç¼€ï¼Œp[j]è¡¨ç¤ºåç¼€</span></span><br><span class="line"><span class="keyword">if</span> (k == <span class="number">-1</span> || p[j] == p[k]) </span><br><span class="line">&#123;</span><br><span class="line">++k;</span><br><span class="line">++j;</span><br><span class="line">next[j] = k;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line">k = next[k];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//kmp</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">KmpSearch</span><span class="params">(<span class="type">char</span>* s, <span class="type">char</span>* p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> j = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> sLen = <span class="built_in">strlen</span>(s);</span><br><span class="line"><span class="type">int</span> pLen = <span class="built_in">strlen</span>(p);</span><br><span class="line"><span class="keyword">while</span> (i &lt; sLen &amp;&amp; j &lt; pLen)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//â‘ å¦‚æœj = -1ï¼Œæˆ–è€…å½“å‰å­—ç¬¦åŒ¹é…æˆåŠŸï¼ˆå³S[i] == P[j]ï¼‰ï¼Œéƒ½ä»¤i++ï¼Œj++    </span></span><br><span class="line"><span class="keyword">if</span> (j == <span class="number">-1</span> || s[i] == p[j])</span><br><span class="line">&#123;</span><br><span class="line">i++;</span><br><span class="line">j++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//â‘¡å¦‚æœj != -1ï¼Œä¸”å½“å‰å­—ç¬¦åŒ¹é…å¤±è´¥ï¼ˆå³S[i] != P[j]ï¼‰ï¼Œåˆ™ä»¤ i ä¸å˜ï¼Œj = next[j]    </span></span><br><span class="line"><span class="comment">//next[j]å³ä¸ºjæ‰€å¯¹åº”çš„nextå€¼      </span></span><br><span class="line">j = next[j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (j == pLen)</span><br><span class="line"><span class="keyword">return</span> i - j;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åŠ¨æ€è§„åˆ’"><a href="#åŠ¨æ€è§„åˆ’" class="headerlink" title="åŠ¨æ€è§„åˆ’"></a>åŠ¨æ€è§„åˆ’</h2><h3 id="æœ€å¤§è¿ç»­å­åºåˆ—"><a href="#æœ€å¤§è¿ç»­å­åºåˆ—" class="headerlink" title="æœ€å¤§è¿ç»­å­åºåˆ—"></a>æœ€å¤§è¿ç»­å­åºåˆ—</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;climits&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> dp[<span class="number">1000001</span>];</span><br><span class="line"><span class="type">int</span> nums[<span class="number">1000001</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="type">int</span> N;</span><br><span class="line"><span class="keyword">while</span>(cin&gt;&gt;N)&#123;</span><br><span class="line"><span class="keyword">if</span> (N==EOF)<span class="keyword">break</span>;</span><br><span class="line"><span class="type">int</span> maxnum=INT_MIN;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;i++)&#123;</span><br><span class="line">cin&gt;&gt;nums[i];</span><br><span class="line">&#125;</span><br><span class="line">dp[<span class="number">1</span>]=nums[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">if</span> (N==<span class="number">1</span>)&#123;</span><br><span class="line">cout&lt;&lt;dp[<span class="number">1</span>]&lt;&lt;endl;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">2</span>;i&lt;=N;i++)&#123;</span><br><span class="line">dp[i]=<span class="built_in">max</span>(nums[i],dp[i<span class="number">-1</span>]+nums[i]);</span><br><span class="line">maxnum=<span class="built_in">max</span>(dp[i],maxnum);</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;maxnum&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æœ€å¤§å­çŸ©é˜µ"><a href="#æœ€å¤§å­çŸ©é˜µ" class="headerlink" title="æœ€å¤§å­çŸ©é˜µ"></a>æœ€å¤§å­çŸ©é˜µ</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> dp[<span class="number">101</span>];</span><br><span class="line"><span class="type">int</span> matrix[<span class="number">101</span>][<span class="number">101</span>];</span><br><span class="line"><span class="type">int</span> support[<span class="number">101</span>][<span class="number">101</span>];</span><br><span class="line"><span class="type">int</span> arr[<span class="number">101</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">hangmax</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line"><span class="type">int</span> maxnum;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">dp[i]=<span class="built_in">max</span>(arr[i],dp[i<span class="number">-1</span>]+arr[i]);</span><br><span class="line">maxnum=<span class="built_in">max</span>(maxnum,dp[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> maxnum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">allmax</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line"><span class="type">int</span> maxnum;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j=i;j&lt;=n;j++)&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k=<span class="number">1</span>;k&lt;=n;k++)&#123;</span><br><span class="line"><span class="keyword">if</span> (i==<span class="number">1</span>)&#123;</span><br><span class="line">arr[k]=support[j][k];</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">arr[k]=support[j][k]-support[i<span class="number">-1</span>][k];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">maxnum=<span class="built_in">max</span>(<span class="built_in">hangmax</span>(n),maxnum);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> maxnum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;j++)&#123;</span><br><span class="line">cin&gt;&gt;matrix[i][j];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">1</span>;j&lt;=n;j++)&#123;</span><br><span class="line"><span class="keyword">if</span> (i==<span class="number">1</span>)support[i][j]=matrix[i][j];</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">support[i][j]=matrix[i][j]+support[i<span class="number">-1</span>][j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> maxnum;</span><br><span class="line">maxnum=<span class="built_in">allmax</span>(n);</span><br><span class="line">cout&lt;&lt;maxnum&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æœ€é•¿é€’å¢-å‡åºåˆ—"><a href="#æœ€é•¿é€’å¢-å‡åºåˆ—" class="headerlink" title="æœ€é•¿é€’å¢&#x2F;å‡åºåˆ—"></a>æœ€é•¿é€’å¢&#x2F;å‡åºåˆ—</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> dp[<span class="number">26</span>];</span><br><span class="line"><span class="type">int</span> daodan[<span class="number">26</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">countmax</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line"><span class="type">int</span> maxnum=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">dp[i]=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">1</span>;j&lt;i;j++)&#123;</span><br><span class="line"><span class="keyword">if</span> (daodan[i]&lt;=daodan[j])</span><br><span class="line">dp[i]=<span class="built_in">max</span>(<span class="number">1</span>,dp[j]+<span class="number">1</span>);</span><br><span class="line">maxnum=<span class="built_in">max</span>(maxnum,dp[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> maxnum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">cin&gt;&gt;daodan[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> maxnum;</span><br><span class="line">maxnum=<span class="built_in">countmax</span>(n);</span><br><span class="line">cout&lt;&lt;maxnum&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æœ€å¤§ä¸Šå‡å­åºåˆ—å’Œï¼ˆO-N-2-ï¼‰"><a href="#æœ€å¤§ä¸Šå‡å­åºåˆ—å’Œï¼ˆO-N-2-ï¼‰" class="headerlink" title="æœ€å¤§ä¸Šå‡å­åºåˆ—å’Œï¼ˆO(N^2)ï¼‰"></a>æœ€å¤§ä¸Šå‡å­åºåˆ—å’Œï¼ˆO(N^2)ï¼‰</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> dp[<span class="number">1001</span>];</span><br><span class="line"><span class="type">int</span> nums[<span class="number">1001</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">countmax</span><span class="params">(<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line"><span class="type">int</span> maxsum;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">dp[i]=nums[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">1</span>;j&lt;i;j++)&#123;</span><br><span class="line"><span class="keyword">if</span> (nums[i]&gt;nums[j])</span><br><span class="line">dp[i]=<span class="built_in">max</span>(nums[i],dp[j]+nums[i]);</span><br><span class="line">maxsum=<span class="built_in">max</span>(maxsum,dp[i]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> maxsum;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">cin&gt;&gt;nums[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> maxsum;</span><br><span class="line"><span class="keyword">if</span> (n==<span class="number">1</span>)&#123;</span><br><span class="line">cout&lt;&lt;nums[<span class="number">1</span>];</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">maxsum=<span class="built_in">countmax</span>(n);</span><br><span class="line">cout&lt;&lt;maxsum&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æœ€é•¿å…¬å…±å­åºåˆ—ï¼ˆLCSï¼‰"><a href="#æœ€é•¿å…¬å…±å­åºåˆ—ï¼ˆLCSï¼‰" class="headerlink" title="æœ€é•¿å…¬å…±å­åºåˆ—ï¼ˆLCSï¼‰"></a>æœ€é•¿å…¬å…±å­åºåˆ—ï¼ˆLCSï¼‰</h3><p>1<br>7<br>3<br>5<br>9<br>4<br>8<br>3</p><p><a href="https://blog.csdn.net/lxt_Lucia/article/details/81209962?ops_request_misc=%7B%22request_id%22:%22168639963816800225544693%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168639963816800225544693&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-81209962-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=LCS&spm=1018.2226.3001.4187">(461æ¡æ¶ˆæ¯) æœ€é•¿å…¬å…±å­åºåˆ— (LCS) è¯¦è§£+ä¾‹é¢˜æ¨¡æ¿ï¼ˆå…¨ï¼‰_lxt_Luciaçš„åšå®¢-CSDNåšå®¢</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">string s1;</span><br><span class="line">string s2;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">countmax</span><span class="params">(string s1,string s2)</span></span>&#123;</span><br><span class="line"><span class="type">int</span> length1=s1.<span class="built_in">size</span>();</span><br><span class="line"><span class="type">int</span> length2=s2.<span class="built_in">size</span>();</span><br><span class="line"><span class="type">int</span> dp[length1][length2];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;length1;i++)&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">0</span>;j&lt;length2;j++)&#123;</span><br><span class="line">dp[i][j]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> maxnum=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;length1;i++)&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">0</span>;j&lt;length2;j++)&#123;</span><br><span class="line"><span class="keyword">if</span> (s1[i]==s2[j])&#123;</span><br><span class="line"><span class="keyword">if</span> (i==<span class="number">0</span>||j==<span class="number">0</span>)&#123;</span><br><span class="line">dp[i][j]=<span class="number">1</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">dp[i][j]=dp[i<span class="number">-1</span>][j<span class="number">-1</span>]+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">if</span> (i==<span class="number">0</span>||j==<span class="number">0</span>)&#123;</span><br><span class="line">dp[i][j]=<span class="number">0</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">dp[i][j]=<span class="built_in">max</span>(dp[i<span class="number">-1</span>][j],dp[i][j<span class="number">-1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">maxnum=<span class="built_in">max</span>(maxnum,dp[i][j]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> maxnum;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(cin&gt;&gt;s1&gt;&gt;s2)&#123;</span><br><span class="line"><span class="type">int</span> maxnum=<span class="built_in">countmax</span>(s1,s2);</span><br><span class="line">cout&lt;&lt;maxnum&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="LISï¼ˆNlognï¼‰"><a href="#LISï¼ˆNlognï¼‰" class="headerlink" title="LISï¼ˆNlognï¼‰"></a>LISï¼ˆNlognï¼‰</h3><p><a href="https://blog.csdn.net/lxt_Lucia/article/details/81206439?ops_request_misc=%7B%22request_id%22:%22168766303316800185860492%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168766303316800185860492&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-81206439-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=%E6%9C%80%E5%A4%A7%E4%B8%8A%E5%8D%87%E5%AD%90%E5%BA%8F%E5%88%97&spm=1018.2226.3001.4187">(465æ¡æ¶ˆæ¯) æœ€é•¿ä¸Šå‡å­åºåˆ— (LIS) è¯¦è§£+ä¾‹é¢˜æ¨¡æ¿ (å…¨)_lxt_Luciaçš„åšå®¢-CSDNåšå®¢</a></p><h3 id="01èƒŒåŒ…"><a href="#01èƒŒåŒ…" class="headerlink" title="01èƒŒåŒ…"></a>01èƒŒåŒ…</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">d</span>&#123;</span><br><span class="line"><span class="type">int</span> price;</span><br><span class="line"><span class="type">int</span> score;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="type">int</span> C,N;</span><br><span class="line"><span class="keyword">while</span> (cin&gt;&gt;C&gt;&gt;N)&#123;</span><br><span class="line"><span class="keyword">if</span> (C==<span class="number">0</span>&amp;&amp;N==<span class="number">0</span>)<span class="keyword">break</span>;</span><br><span class="line"><span class="type">int</span> dp[C+<span class="number">1</span>];</span><br><span class="line">d deal[N];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;=C;i++)&#123;</span><br><span class="line">dp[i]=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;N;i++)&#123;</span><br><span class="line"><span class="type">int</span> price;</span><br><span class="line"><span class="type">int</span> score;</span><br><span class="line">cin&gt;&gt;price&gt;&gt;score;</span><br><span class="line">deal[i].price=price;</span><br><span class="line">deal[i].score=score;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;N;i++)&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j=C;j&gt;=<span class="number">1</span>;j--)&#123;</span><br><span class="line"><span class="keyword">if</span> (j&gt;=deal[i].price)&#123;</span><br><span class="line">dp[j]=<span class="built_in">max</span>(dp[j-deal[i].price]+deal[i].score,dp[j]);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;dp[C]&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ‰ä¸ªèƒŒåŒ…çš„å˜ç§</p><p><a href="https://blog.csdn.net/weixin_41994332/article/details/115829716?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromBaidu~Rate-1-115829716-blog-109011034.235%5Ev38%5Epc_relevant_anti_t3&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2~default~BlogCommendFromBaidu~Rate-1-115829716-blog-109011034.235%5Ev38%5Epc_relevant_anti_t3&utm_relevant_index=1">(465æ¡æ¶ˆæ¯) å¤æ—¦å¤§å­¦2021å¹´è®¡ç®—æœºå­¦é™¢æœºè¯•é¢˜è§£_å¤æ—¦oj_PyKtçš„åšå®¢-CSDNåšå®¢</a></p><p>è¿™é‡Œæ˜¯ç›´æ¥é¡ºåºçš„</p><h2 id="DFS-BFS"><a href="#DFS-BFS" class="headerlink" title="DFS BFS"></a>DFS BFS</h2><h2 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h2><h3 id="å½’å¹¶"><a href="#å½’å¹¶" class="headerlink" title="å½’å¹¶"></a>å½’å¹¶</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">merge</span><span class="params">(<span class="type">int</span>* a, <span class="type">int</span> low, <span class="type">int</span> mid, <span class="type">int</span> hight)</span>  <span class="comment">//åˆå¹¶å‡½æ•°</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span>* b = <span class="keyword">new</span> <span class="type">int</span>[hight - low + <span class="number">1</span>];  <span class="comment">//ç”¨ new ç”³è¯·ä¸€ä¸ªè¾…åŠ©å‡½æ•°</span></span><br><span class="line"><span class="type">int</span> i = low, j = mid + <span class="number">1</span>, k = <span class="number">0</span>;    <span class="comment">// kä¸º b æ•°ç»„çš„å°æ ‡</span></span><br><span class="line"><span class="keyword">while</span> (i &lt;= mid &amp;&amp; j &lt;= hight)  </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (a[i] &lt;= a[j])</span><br><span class="line">&#123;</span><br><span class="line">b[k++] = a[i++];  <span class="comment">//æŒ‰ä»å°åˆ°å¤§å­˜æ”¾åœ¨ b æ•°ç»„é‡Œé¢</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">b[k++] = a[j++];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (i &lt;= mid)  <span class="comment">// j åºåˆ—ç»“æŸï¼Œå°†å‰©ä½™çš„ i åºåˆ—è¡¥å……åœ¨ b æ•°ç»„ä¸­ </span></span><br><span class="line">&#123;</span><br><span class="line">b[k++] = a[i++];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (j &lt;= hight)<span class="comment">// i åºåˆ—ç»“æŸï¼Œå°†å‰©ä½™çš„ j åºåˆ—è¡¥å……åœ¨ b æ•°ç»„ä¸­ </span></span><br><span class="line">&#123;</span><br><span class="line">b[k++] = a[j++];</span><br><span class="line">&#125;</span><br><span class="line">k = <span class="number">0</span>;  <span class="comment">//ä»å°æ ‡ä¸º 0 å¼€å§‹ä¼ é€</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = low; i &lt;= hight; i++)  <span class="comment">//å°† b æ•°ç»„çš„å€¼ä¼ é€’ç»™æ•°ç»„ a</span></span><br><span class="line">&#123;</span><br><span class="line">a[i] = b[k++];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">delete</span>[]b;     <span class="comment">// è¾…åŠ©æ•°ç»„ç”¨å®Œåï¼Œå°†å…¶çš„ç©ºé—´è¿›è¡Œé‡Šæ”¾ï¼ˆé”€æ¯ï¼‰</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mergesort</span><span class="params">(<span class="type">int</span>* a, <span class="type">int</span> low, <span class="type">int</span> hight)</span> <span class="comment">//å½’å¹¶æ’åº</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (low &lt; hight)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">int</span> mid = (low + hight) / <span class="number">2</span>;</span><br><span class="line"><span class="built_in">mergesort</span>(a, low, mid);          <span class="comment">//å¯¹ a[low,mid]è¿›è¡Œæ’åº</span></span><br><span class="line"><span class="built_in">mergesort</span>(a, mid + <span class="number">1</span>, hight);    <span class="comment">//å¯¹ a[mid+1,hight]è¿›è¡Œæ’åº</span></span><br><span class="line"><span class="built_in">merge</span>(a, low, mid, hight);       <span class="comment">//è¿›è¡Œåˆå¹¶æ“ä½œ</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">int</span> n, a[<span class="number">100</span>];</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;è¯·è¾“å…¥æ•°åˆ—ä¸­çš„å…ƒç´ ä¸ªæ•° n ä¸ºï¼š&quot;</span> &lt;&lt; endl;</span><br><span class="line">cin &gt;&gt; n;</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;è¯·ä¾æ¬¡è¾“å…¥æ•°åˆ—ä¸­çš„å…ƒç´ ï¼š&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">&#123;</span><br><span class="line">cin &gt;&gt; a[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">mergesort</span>(a, <span class="number">0</span>, n<span class="number">-1</span>);</span><br><span class="line">cout &lt;&lt; <span class="string">&quot;å½’å¹¶æ’åºç»“æœ&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">&#123;</span><br><span class="line">cout &lt;&lt; a[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">cout &lt;&lt; endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¿«é€Ÿå¹‚"><a href="#å¿«é€Ÿå¹‚" class="headerlink" title="å¿«é€Ÿå¹‚"></a>å¿«é€Ÿå¹‚</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">long</span> <span class="type">long</span> m=<span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="function"><span class="type">long</span> <span class="type">long</span> <span class="title">quickpow</span><span class="params">(<span class="type">long</span> <span class="type">long</span> a,<span class="type">long</span> <span class="type">long</span> b)</span></span>&#123;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> sum=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(b)&#123;</span><br><span class="line"><span class="keyword">if</span>(b&amp;<span class="number">1</span>)<span class="comment">//ä¸è¿ç®—ï¼Œå¯åˆ¤æ–­å¥‡å¶ï¼Œè¯¦ç»†è§æ³¨é‡Š</span></span><br><span class="line">sum=sum*a%m;<span class="comment">//å–æ¨¡è¿ç®—</span></span><br><span class="line">a=a*a%m;</span><br><span class="line">b&gt;&gt;=<span class="number">1</span>;<span class="comment">//ä½è¿ç®—ï¼Œå³ç§»ï¼Œç›¸å½“äºé™¤ä»¥2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure><h2 id="æ¨¡æ‹Ÿé—®é¢˜"><a href="#æ¨¡æ‹Ÿé—®é¢˜" class="headerlink" title="æ¨¡æ‹Ÿé—®é¢˜"></a>æ¨¡æ‹Ÿé—®é¢˜</h2><p>å°±æ˜¯æ‰¾è§„å¾‹ï¼Œè¿˜è¡Œ</p><h2 id="æ—¥æœŸé—®é¢˜"><a href="#æ—¥æœŸé—®é¢˜" class="headerlink" title="æ—¥æœŸé—®é¢˜"></a>æ—¥æœŸé—®é¢˜</h2><p>è¦é¢„å¤„ç†</p><h2 id="æœ€å¤§å…¬å› æ•°-æœ€å°å…¬å€æ•°"><a href="#æœ€å¤§å…¬å› æ•°-æœ€å°å…¬å€æ•°" class="headerlink" title="æœ€å¤§å…¬å› æ•°&#x2F;æœ€å°å…¬å€æ•°"></a>æœ€å¤§å…¬å› æ•°&#x2F;æœ€å°å…¬å€æ•°</h2><p>æœ€å°å…¬å€æ•°&#x3D;a*b&#x2F;c</p><p>cä¸ºæœ€å¤§å…¬å› æ•°</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æœ€å¤§å…¬å› æ•°</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">biggest</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> b!=<span class="number">0</span>?<span class="built_in">biggest</span>(b,a%b):a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æœ€å°å…¬å€æ•°</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">smallest</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">   <span class="type">int</span> big=<span class="built_in">biggest</span>(a,b);</span><br><span class="line">    <span class="keyword">return</span> a*b/big;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç´ æ•°ç­›æ³•"><a href="#ç´ æ•°ç­›æ³•" class="headerlink" title="ç´ æ•°ç­›æ³•"></a>ç´ æ•°ç­›æ³•</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">while</span> (cin&gt;&gt;n)&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (n==<span class="number">0</span>)<span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">if</span> (n==<span class="number">2</span>)&#123;</span><br><span class="line">cout&lt;&lt;<span class="number">-1</span>&lt;&lt;endl;</span><br><span class="line"><span class="keyword">continue</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> sushu[n+<span class="number">1</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line">sushu[i]=<span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line"><span class="keyword">if</span> (sushu[i]==<span class="literal">false</span>)<span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j=i;j*i&lt;=n;j++)&#123; <span class="comment">//jç›´æ¥ä»iå¼€å§‹ï¼Œæé«˜æ•ˆç‡</span></span><br><span class="line"><span class="keyword">if</span> (j*i&lt;n)&#123;</span><br><span class="line">sushu[j*i]=<span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">2</span>;i&lt;n;i++)&#123;</span><br><span class="line"><span class="keyword">if</span> (sushu[i])&#123;</span><br><span class="line"><span class="keyword">if</span> (i%<span class="number">10</span>==<span class="number">1</span>)&#123;</span><br><span class="line">cout&lt;&lt;i&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹äºä¸€ä¸ªæ•°nï¼Œå…¶è´¨å› æ•°æœ€å¤šåªæœ‰ä¸€ä¸ªå¤§äºå…¶å¹³æ–¹æ ¹ï¼</p><h2 id="çŸ©é˜µä¹˜æ³•ï¼ˆæ„é€ å‡½æ•°ï¼‰"><a href="#çŸ©é˜µä¹˜æ³•ï¼ˆæ„é€ å‡½æ•°ï¼‰" class="headerlink" title="çŸ©é˜µä¹˜æ³•ï¼ˆæ„é€ å‡½æ•°ï¼‰"></a>çŸ©é˜µä¹˜æ³•ï¼ˆæ„é€ å‡½æ•°ï¼‰</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Matrix</span>&#123;</span><br><span class="line"><span class="type">int</span> matrix[<span class="number">10</span>][<span class="number">10</span>];</span><br><span class="line"><span class="type">int</span> row;</span><br><span class="line"><span class="type">int</span> col;</span><br><span class="line"><span class="built_in">Matrix</span>(<span class="type">int</span> a,<span class="type">int</span> b):<span class="built_in">row</span>(a),<span class="built_in">col</span>(b)&#123;&#125;<span class="comment">//æ³¨æ„æ„é€ å‡½æ•°çš„å†™æ³•</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function">Matrix <span class="title">Multiply</span><span class="params">(Matrix a,Matrix b)</span></span>&#123;</span><br><span class="line">Matrix ans=<span class="built_in">Matrix</span>(a.row,b.col);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;a.row;i++)&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">0</span>;j&lt;b.col;j++)&#123;</span><br><span class="line"><span class="type">int</span> temp=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k=<span class="number">0</span>;k&lt;a.col;k++)&#123;</span><br><span class="line">temp+=a.matrix[i][k]*b.matrix[k][j];</span><br><span class="line">&#125;</span><br><span class="line">ans.matrix[i][j]=temp;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">printMatrix</span><span class="params">(Matrix m)</span></span>&#123;</span><br><span class="line"><span class="type">int</span> row=m.row;</span><br><span class="line"><span class="type">int</span> col=m.col;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;row;i++)&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">0</span>;j&lt;col;j++)&#123;</span><br><span class="line"><span class="keyword">if</span> (j!=<span class="number">0</span>)&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;m.matrix[i][j];</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">Matrix a=<span class="built_in">Matrix</span>(<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line">Matrix b=<span class="built_in">Matrix</span>(<span class="number">3</span>,<span class="number">2</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">2</span>;i++)&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">3</span>;j++)&#123;</span><br><span class="line">cin&gt;&gt;a.matrix[i][j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">2</span>;j++)&#123;</span><br><span class="line">cin&gt;&gt;b.matrix[i][j];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">Matrix c=<span class="built_in">Multiply</span>(a,b);</span><br><span class="line"><span class="built_in">printMatrix</span>(c);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é«˜ç²¾åº¦"><a href="#é«˜ç²¾åº¦" class="headerlink" title="é«˜ç²¾åº¦"></a>é«˜ç²¾åº¦</h2><h2 id="æœ€å°ç”Ÿæˆæ ‘"><a href="#æœ€å°ç”Ÿæˆæ ‘" class="headerlink" title="æœ€å°ç”Ÿæˆæ ‘"></a>æœ€å°ç”Ÿæˆæ ‘</h2><p><a href="https://so.csdn.net/so/search?spm=1000.2115.3001.4498&q=prim%E7%AE%97%E6%B3%95%E6%B1%82%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91&t=&u=">primç®—æ³•æ±‚æœ€å°ç”Ÿæˆæ ‘- CSDNæœç´¢</a></p><p>kruscal</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span>&#123;</span><br><span class="line"><span class="type">int</span> a;</span><br><span class="line"><span class="type">int</span> b;</span><br><span class="line"><span class="type">int</span> weight;</span><br><span class="line"><span class="type">bool</span> <span class="keyword">operator</span>&gt;(edge c)<span class="type">const</span>&#123;</span><br><span class="line"><span class="keyword">return</span> weight&gt;c.weight;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">edge</span>(<span class="type">int</span> q,<span class="type">int</span> w,<span class="type">int</span> e):<span class="built_in">a</span>(q),<span class="built_in">b</span>(w),<span class="built_in">weight</span>(e)&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">priority_queue&lt;edge,vector&lt;edge&gt;,greater&lt;edge&gt;&gt;edges;</span><br><span class="line"><span class="type">int</span> graph[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span> (graph[x]==<span class="number">-1</span>)<span class="keyword">return</span> x;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="type">int</span> temp;</span><br><span class="line">temp=<span class="built_in">find</span>(graph[x]);</span><br><span class="line">graph[x]=temp;</span><br><span class="line"><span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="keyword">while</span> (cin&gt;&gt;n)&#123;</span><br><span class="line"><span class="keyword">if</span> (n==<span class="number">0</span>)<span class="keyword">break</span>;</span><br><span class="line"><span class="type">int</span> a,b,weight;</span><br><span class="line"><span class="type">int</span> num=n*(n<span class="number">-1</span>)/<span class="number">2</span>;</span><br><span class="line"><span class="built_in">memset</span>(graph,<span class="number">-1</span>,<span class="built_in">sizeof</span>(graph));</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">graph[i]=<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (num--)&#123;</span><br><span class="line">cin&gt;&gt;a&gt;&gt;b&gt;&gt;weight;</span><br><span class="line">edge edge1=<span class="built_in">edge</span>(a,b,weight);</span><br><span class="line">edges.<span class="built_in">push</span>(edge1);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> sum=<span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> count=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> (!edges.<span class="built_in">empty</span>()&amp;&amp;count&lt;n<span class="number">-1</span>)&#123;</span><br><span class="line">edge temp=edges.<span class="built_in">top</span>();</span><br><span class="line">edges.<span class="built_in">pop</span>();</span><br><span class="line"><span class="type">int</span> a=<span class="built_in">find</span>(temp.a);</span><br><span class="line"><span class="type">int</span> b=<span class="built_in">find</span>(temp.b);</span><br><span class="line"><span class="type">int</span> weight=temp.weight;</span><br><span class="line"><span class="keyword">if</span> (a!=b)&#123;</span><br><span class="line">graph[a]=b;</span><br><span class="line">count++;</span><br><span class="line">sum+=weight;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;sum&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å¼—æ´›ä¼Šå¾·"><a href="#å¼—æ´›ä¼Šå¾·" class="headerlink" title="å¼—æ´›ä¼Šå¾·"></a>å¼—æ´›ä¼Šå¾·</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">1</span>;k &lt;= n;k ++) &#123; </span><br><span class="line"> <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>;i &lt;= n;i ++) &#123; </span><br><span class="line"> <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>;j &lt;= n;j ++) &#123; </span><br><span class="line"> <span class="keyword">if</span> (ans[i][k] == æ— ç©· || ans[k][j] == æ— ç©·) <span class="keyword">continue</span>; </span><br><span class="line"> <span class="keyword">if</span> (ans[i][j] == æ— ç©· || ans[i][k] + ans[k][j] &lt; ans[i][j]) </span><br><span class="line"> ans[i][j] = ans[i][k] + ans[k][j]; </span><br><span class="line"> &#125; </span><br><span class="line"> &#125; </span><br><span class="line"> &#125; </span><br></pre></td></tr></table></figure><h2 id="è¿ªæ°æ–¯ç‰¹æ‹‰"><a href="#è¿ªæ°æ–¯ç‰¹æ‹‰" class="headerlink" title="è¿ªæ°æ–¯ç‰¹æ‹‰"></a>è¿ªæ°æ–¯ç‰¹æ‹‰</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>;i &lt;= n;i ++) &#123; <span class="comment">//åˆå§‹åŒ–</span></span><br><span class="line"> Dis[i] = <span class="number">-1</span>; <span class="comment">//æ‰€æœ‰è·ç¦»ä¸º-1ï¼Œå³ä¸å¯è¾¾</span></span><br><span class="line"> mark[i] = <span class="literal">false</span>; <span class="comment">//æ‰€æœ‰ç»“ç‚¹ä¸å±äºé›†åˆK</span></span><br><span class="line"> &#125; </span><br><span class="line"> Dis[<span class="number">1</span>] = <span class="number">0</span>; <span class="comment">//å¾—åˆ°æœ€è¿‘çš„ç‚¹ä¸ºç»“ç‚¹1,é•¿åº¦ä¸º0</span></span><br><span class="line"> mark[<span class="number">1</span>] = <span class="literal">true</span>; <span class="comment">//å°†ç»“ç‚¹1åŠ å…¥é›†åˆK</span></span><br><span class="line"> <span class="type">int</span> newP = <span class="number">1</span>; <span class="comment">//é›†åˆKä¸­æ–°åŠ å…¥çš„ç‚¹ä¸ºç»“ç‚¹1 </span></span><br><span class="line"> <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>;i &lt; n;i ++) &#123; <span class="comment">//å¾ªç¯n-1æ¬¡,æŒ‰ç…§æœ€çŸ­è·¯å¾„é€’å¢çš„é¡ºåºç¡®å®šå…¶ä»–n-1ä¸ªç‚¹çš„æœ€çŸ­è·¯å¾„é•¿åº¦</span></span><br><span class="line"> <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>;j &lt; edge[newP].<span class="built_in">size</span>();j ++) &#123; <span class="comment">//éå†ä¸è¯¥æ–°åŠ å…¥é›†åˆ</span></span><br><span class="line">Kä¸­çš„ç»“ç‚¹ç›´æ¥ç›¸é‚»çš„è¾¹</span><br><span class="line"> <span class="type">int</span> t = edge[newP][j].next; <span class="comment">//è¯¥è¾¹çš„å¦ä¸€ä¸ªç»“ç‚¹</span></span><br><span class="line"> <span class="type">int</span> c = edge[newP][j].c; <span class="comment">//è¯¥è¾¹çš„é•¿åº¦</span></span><br><span class="line"> <span class="keyword">if</span> (mark[t] == <span class="literal">true</span>) <span class="keyword">continue</span>; <span class="comment">//è‹¥å¦ä¸€ä¸ªç»“ç‚¹ä¹Ÿå±äºé›†åˆK,åˆ™è·³è¿‡</span></span><br><span class="line"> <span class="keyword">if</span> (Dis[t] == - <span class="number">1</span> || Dis[t] &gt; Dis[newP] + c) <span class="comment">//è‹¥è¯¥ç»“ç‚¹å°šä¸å¯</span></span><br><span class="line">è¾¾,æˆ–è€…è¯¥ç»“ç‚¹ä»æ–°åŠ å…¥çš„ç»“ç‚¹ç»è¿‡ä¸€æ¡è¾¹åˆ°è¾¾æ—¶æ¯”ä»¥å¾€è·ç¦»æ›´çŸ­</span><br><span class="line"> Dis[t] = Dis[newP] + c; <span class="comment">//æ›´æ–°å…¶è·ç¦»ä¿¡æ¯</span></span><br><span class="line"> &#125; </span><br><span class="line"> <span class="type">int</span> min = <span class="number">123123123</span>; <span class="comment">//æœ€å°å€¼åˆå§‹åŒ–ä¸ºä¸€ä¸ªå¤§æ•´æ•°,ä¸ºæ‰¾æœ€å°å€¼åšå‡†å¤‡</span></span><br><span class="line"> <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>;j &lt;= n;j ++) &#123; <span class="comment">//éå†æ‰€æœ‰ç»“ç‚¹</span></span><br><span class="line"> <span class="keyword">if</span> (mark[j] == <span class="literal">true</span>) <span class="keyword">continue</span>; <span class="comment">//è‹¥å…¶å±äºé›†åˆKåˆ™è·³è¿‡</span></span><br><span class="line"> <span class="keyword">if</span> (Dis[j] == <span class="number">-1</span>) <span class="keyword">continue</span>; <span class="comment">//è‹¥è¯¥ç»“ç‚¹ä»ä¸å¯è¾¾åˆ™è·³è¿‡</span></span><br><span class="line"> <span class="keyword">if</span> (Dis[j] &lt; min) &#123; <span class="comment">//è‹¥è¯¥ç»“ç‚¹ç»ç”±ç»“ç‚¹1è‡³é›†åˆKä¸­çš„æŸç‚¹åœ¨ç»è¿‡ä¸€æ¡</span></span><br><span class="line">è¾¹åˆ°è¾¾æ—¶è·ç¦»å°äºå½“å‰æœ€å°å€¼</span><br><span class="line"> min = Dis[j]; <span class="comment">//æ›´æ–°å…¶ä¸ºæœ€å°å€¼</span></span><br><span class="line"> newP = j; <span class="comment">//æ–°åŠ å…¥çš„ç‚¹æš‚å®šä¸ºè¯¥ç‚¹</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h2 id="æ¬§æ‹‰å›è·¯ï¼ˆhierholzerï¼‰"><a href="#æ¬§æ‹‰å›è·¯ï¼ˆhierholzerï¼‰" class="headerlink" title="æ¬§æ‹‰å›è·¯ï¼ˆhierholzerï¼‰"></a>æ¬§æ‹‰å›è·¯ï¼ˆhierholzerï¼‰</h2><p><a href="https://blog.csdn.net/weixin_44316314/article/details/96898445?ops_request_misc=%7B%22request_id%22:%22168707940816800182775723%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168707940816800182775723&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-96898445-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=%E6%AC%A7%E6%8B%89%E5%9B%9E%E8%B7%AF%E7%9A%84%E7%AE%97%E6%B3%95&spm=1018.2226.3001.4187">(462æ¡æ¶ˆæ¯) æ¬§æ‹‰å›è·¯ï¼ˆhierholzerç®—æ³•ï¼‰_é€æ­¥æ’å…¥å›è·¯æ³•_run aroundçš„åšå®¢-CSDNåšå®¢</a></p><h2 id="å…³é”®è·¯å¾„ï¼ˆAOEç½‘ï¼‰"><a href="#å…³é”®è·¯å¾„ï¼ˆAOEç½‘ï¼‰" class="headerlink" title="å…³é”®è·¯å¾„ï¼ˆAOEç½‘ï¼‰"></a>å…³é”®è·¯å¾„ï¼ˆAOEç½‘ï¼‰</h2><p>æœ€æ—©å¼€å§‹æ—¶é—´&#x3D;æœ€æ™šå¼€å§‹æ—¶é—´</p><p>ç”¨æ‹“æ‰‘å›¾</p><p>æœ€æ—©å¼€å§‹æ—¶é—´ï¼ˆæ‰€æœ‰å…ˆåºæ´»åŠ¨çš„æœ€æ™šå®Œæˆæ—¶é—´ï¼‰</p><p>æœ€æ™šå¼€å§‹æ—¶é—´ï¼ˆæ‰€æœ‰åç»­æ´»åŠ¨çš„æœ€æ—©å¼€å§‹æ—¶é—´å‡å»è¯¥æ´»åŠ¨èŠ±è´¹çš„æ—¶é—´ï¼‰</p><p>æ³¨æ„æºç‚¹çš„æœ€æ—©å¼€å§‹æ—¶é—´ä¸ä¸€å®šä¸º0ï¼Œè¦åˆå§‹åŒ–</p><p>æ±‡ç‚¹çš„æœ€æ™šå¼€å§‹æ—¶é—´åˆå§‹åŒ–ä¸ºtotalTime-è¯¥æ±‡ç‚¹ä»»åŠ¡çš„æ—¶é—´</p><p>éæ±‡ç‚¹çš„æœ€æ™šå¼€å§‹æ—¶é—´ä¸ºæ— ç©·</p><p>å¦‚æœåªæ˜¯è¦æ±‚å…³é”®è·¯å¾„çš„é•¿åº¦ï¼Œå…¶å®åœ¨earliest[i]åˆå§‹åŒ–çš„æ—¶å€™å°±è®¾ç½®ä¸ºä»»åŠ¡çš„æ—¶é—´å°±è¡Œï¼Œä½†å¦‚æœè¦ç®—å…¶ä»–çš„ï¼Œå°±è¿˜æ˜¯è®¾ç½®ä¸º0</p><p>7 5<br>11 20 17 10 11 17 17<br>5 4<br>6 1<br>7 3<br>2 4<br>2 1</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;climits&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> yushu 1e9+7</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line">queue&lt;<span class="type">int</span>&gt;zero;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;re;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span>&#123;</span><br><span class="line"><span class="type">int</span> to;</span><br><span class="line"><span class="type">int</span> weight;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> in[<span class="number">100001</span>];</span><br><span class="line">vector&lt;edge&gt;edges[<span class="number">100001</span>];</span><br><span class="line"><span class="type">int</span> task[<span class="number">100001</span>];</span><br><span class="line"><span class="type">int</span> earliest[<span class="number">100001</span>];</span><br><span class="line"><span class="type">int</span> latest[<span class="number">100001</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">max</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a&gt;b?a:b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">min</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;</span><br><span class="line"><span class="keyword">return</span> a&lt;b?a:b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line">cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">in[i]=<span class="number">0</span>;</span><br><span class="line">cin&gt;&gt;task[i];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> num=m;</span><br><span class="line"><span class="type">int</span> allTime=<span class="number">0</span>;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;input edge&quot;</span>&lt;&lt;endl;</span><br><span class="line"><span class="keyword">while</span> (num--)&#123;</span><br><span class="line"><span class="type">int</span> a,b;</span><br><span class="line">cin&gt;&gt;a&gt;&gt;b;</span><br><span class="line">in[b]++;</span><br><span class="line">edge temp;</span><br><span class="line">temp.to=b;</span><br><span class="line">temp.weight=task[b];</span><br><span class="line">edges[a].<span class="built_in">push_back</span>(temp);</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;input finished.&quot;</span>&lt;&lt;endl;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;earliest[&quot;</span>&lt;&lt;i&lt;&lt;<span class="string">&quot;]:&quot;</span>&lt;&lt;earliest[i]&lt;&lt;endl;</span><br><span class="line"><span class="keyword">if</span> (in[i]==<span class="number">0</span>)&#123;</span><br><span class="line">zero.<span class="built_in">push</span>(i);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> (!zero.<span class="built_in">empty</span>())&#123;</span><br><span class="line"><span class="type">int</span> node=zero.<span class="built_in">front</span>();</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;zero:&quot;</span>&lt;&lt;node&lt;&lt;endl;</span><br><span class="line">zero.<span class="built_in">pop</span>();</span><br><span class="line">re.<span class="built_in">push_back</span>(node);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span>;i&lt;edges[node].<span class="built_in">size</span>();i++)&#123;</span><br><span class="line"><span class="type">int</span> to=edges[node][i].to;</span><br><span class="line"><span class="type">int</span> weight=edges[node][i].weight;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;edge:&quot;</span>&lt;&lt;node&lt;&lt;<span class="string">&quot;-&quot;</span>&lt;&lt;to&lt;&lt;<span class="string">&quot;:&quot;</span>&lt;&lt;weight&lt;&lt;endl;</span><br><span class="line">earliest[to]=<span class="built_in">max</span>(earliest[to],earliest[node]+task[node]);</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;earliest[&quot;</span>&lt;&lt;to&lt;&lt;<span class="string">&quot;]:&quot;</span>&lt;&lt;earliest[to]&lt;&lt;endl;</span><br><span class="line">in[to]--;</span><br><span class="line"><span class="keyword">if</span> (in[to]==<span class="number">0</span>)&#123;</span><br><span class="line">zero.<span class="built_in">push</span>(to);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">allTime=<span class="built_in">max</span>(allTime,earliest[i]+task[i]);</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;reverse:&quot;</span>&lt;&lt;endl;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=re.<span class="built_in">size</span>()<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line"><span class="type">int</span> u=re[i];</span><br><span class="line"><span class="keyword">if</span> (edges[u].<span class="built_in">size</span>()==<span class="number">0</span>)&#123;</span><br><span class="line">latest[u]=allTime-task[u];</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;latest:[&quot;</span>&lt;&lt;u&lt;&lt;<span class="string">&quot;]:&quot;</span>&lt;&lt;latest[u]&lt;&lt;endl;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">latest[u]=<span class="number">99999999</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> j=<span class="number">0</span>;j&lt;edges[u].<span class="built_in">size</span>();j++)&#123;</span><br><span class="line"><span class="type">int</span> to=edges[u][j].to;</span><br><span class="line"><span class="type">int</span> weight=edges[u][j].weight;</span><br><span class="line">latest[u]=<span class="built_in">min</span>(latest[u],latest[to]-task[u]);</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;latest:[&quot;</span>&lt;&lt;u&lt;&lt;<span class="string">&quot;]:&quot;</span>&lt;&lt;latest[u]&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">cout&lt;&lt;endl;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;earliest[&quot;</span>&lt;&lt;i&lt;&lt;<span class="string">&quot;]:&quot;</span>&lt;&lt;earliest[i]&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;<span class="string">&quot;latest[&quot;</span>&lt;&lt;i&lt;&lt;<span class="string">&quot;]:&quot;</span>&lt;&lt;latest[i]&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> sum=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">sum*=(latest[i]-earliest[i]+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line">cout&lt;&lt;allTime&lt;&lt;endl;</span><br><span class="line">cout&lt;&lt;sum&lt;&lt;endl;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/u011240016/article/details/53171808?ops_request_misc=%7B%22request_id%22:%22168784579716782425186584%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168784579716782425186584&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-53171808-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=AOE&spm=1018.2226.3001.4187">(466æ¡æ¶ˆæ¯) AOEé—®é¢˜æ€»ç»“_DrCryptoçš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/qq_44880154/article/details/114380592?ops_request_misc=&request_id=&biz_id=102&utm_term=AOE%E9%A2%98&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-114380592.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&spm=1018.2226.3001.4187">(466æ¡æ¶ˆæ¯) AOEç½‘å…³é”®è·¯å¾„æ±‚è§£ä¾‹é¢˜_å…³é”®è·¯å¾„ä¾‹é¢˜å›¾è§£_HardyDragon_CCçš„åšå®¢-CSDNåšå®¢</a></p><h2 id="æ•°ä½dp"><a href="#æ•°ä½dp" class="headerlink" title="æ•°ä½dp"></a>æ•°ä½dp</h2><p><a href="https://blog.csdn.net/yc_cy1999/article/details/104580701?ops_request_misc=&request_id=&biz_id=102&utm_term=%E4%BF%9D%E7%A0%94%E6%9C%BA%E8%AF%95%E9%A2%98%E5%8D%95&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-104580701.142%5Ev84%5Epc_search_v2,239%5Ev2%5Einsert_chatgpt&spm=1018.2226.3001.4187">(443æ¡æ¶ˆæ¯) 2019å¹´å—äº¬å¤§å­¦è®¡ç®—æœºè€ƒç ”å¤è¯•æœºè¯•çœŸé¢˜_å—å¤§è®¡ç®—æœºä¸“ä¸šè€ƒç ”æœºè¯•_yc_cy1999çš„åšå®¢-CSDNåšå®¢</a></p><p>ä¸€ä¸ªæ•´æ•°å¯ä»¥å˜ä¸ºå¤šå°‘ä¸ªæ•´æ•°ç›¸åŠ </p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">1010</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> f[N];<span class="comment">//å­˜æ‰€æœ‰çŠ¶æ€</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = i; j &lt;= n; j ++)<span class="comment">//jæ˜¯å®¹é‡</span></span><br><span class="line">            f[j] = (f[j] + f[j - i]) % mod;</span><br><span class="line">    cout &lt;&lt; f[n] &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="çŠ¶å‹DP"><a href="#çŠ¶å‹DP" class="headerlink" title="çŠ¶å‹DP"></a>çŠ¶å‹DP</h2><p><a href="https://blog.csdn.net/qq12323qweeqwe/article/details/123083331?ops_request_misc=&request_id=&biz_id=102&utm_term=%E8%92%99%E5%BE%B7%E9%87%8C%E5%AE%89%E7%9A%84%E6%A2%A6%E6%83%B3&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-123083331.nonecase&spm=1018.2226.3001.4187">(462æ¡æ¶ˆæ¯) 291. è’™å¾·é‡Œå®‰çš„æ¢¦æƒ³ï¼ˆçŠ¶å‹dpï¼‰_seezçš„åšå®¢-CSDNåšå®¢</a></p><p>[(462æ¡æ¶ˆæ¯) <a href="https://blog.csdn.net/yl_puyu/article/details/109631735?ops_request_misc=&request_id=&biz_id=102&utm_term=%E8%92%99%E5%BE%B7%E9%87%8C%E5%AE%89%E7%9A%84%E6%A2%A6%E6%83%B3&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-2-109631735.nonecase&spm=1018.2226.3001.4187">çŠ¶å‹dp] è’™å¾·é‡Œå®‰çš„æ¢¦æƒ³(æ¨¡æ¿é¢˜+çŠ¶å‹dp)_çŠ¶å‹dpæ¨¡æ¿é¢˜_Ypuyuçš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/qq_27262727/article/details/105700957?ops_request_misc=&request_id=&biz_id=102&utm_term=%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%E8%B4%AA%E5%BF%83%E9%A2%98%E7%9B%AE&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-105700957.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&spm=1018.2226.3001.4187">(462æ¡æ¶ˆæ¯) C++ç¬”è¯•é¢˜æ¨¡ç‰ˆæ±‡æ€»(äº”)åŠ¨æ€è§„åˆ’&#x2F;è´ªå¿ƒ_c++ç¬”è¯•é¢˜ è€ƒåŠ¨æ€è§„åˆ’ä¹ˆ_ai_XZP_masterçš„åšå®¢-CSDNåšå®¢</a></p><p><a href="https://blog.csdn.net/hzf0701/article/details/117430400?ops_request_misc=&request_id=&biz_id=102&utm_term=%E7%8A%B6%E6%80%81%E5%8E%8B%E7%BC%A9dp&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-3-117430400.142%5Ev100%5Epc_search_result_base8&spm=1018.2226.3001.4187">çŠ¶æ€å‹ç¼©DPå­¦ä¹ æ€»ç»“+ç»å…¸ä¾‹é¢˜ç²¾è§£_çŠ¶å‹dp-CSDNåšå®¢</a></p><h2 id="æ±‰è¯ºå¡”é—®é¢˜"><a href="#æ±‰è¯ºå¡”é—®é¢˜" class="headerlink" title="æ±‰è¯ºå¡”é—®é¢˜"></a>æ±‰è¯ºå¡”é—®é¢˜</h2><p>ç»“è®ºï¼šæŠŠiä¸ªç›˜å­ç§»åˆ°å¦ä¸€ä¸ªæŸ±é¢ä¸Šï¼Œéœ€è¦2^i-1æ­¥</p><p><a href="https://zhuanlan.zhihu.com/p/392523306">å…³äºæ±‰è¯ºå¡”é—®é¢˜ - çŸ¥ä¹ (zhihu.com)</a></p><h2 id="æ”¾ç½®è¡—ç¯ï¼ˆPlacing-Lampposts-UVa-10859ï¼‰-star"><a href="#æ”¾ç½®è¡—ç¯ï¼ˆPlacing-Lampposts-UVa-10859ï¼‰-star" class="headerlink" title="æ”¾ç½®è¡—ç¯ï¼ˆPlacing Lampposts, UVa 10859ï¼‰:star:"></a>æ”¾ç½®è¡—ç¯ï¼ˆPlacing Lampposts, UVa 10859ï¼‰:star:</h2><p><img src="C:\Users\11505\AppData\Roaming\Typora\typora-user-images\image-20230515221130204.png" alt="image-20230515221130204"></p><h2 id="ç»å…¸è´ªå¿ƒ"><a href="#ç»å…¸è´ªå¿ƒ" class="headerlink" title="ç»å…¸è´ªå¿ƒ"></a>ç»å…¸è´ªå¿ƒ</h2><p><a href="https://blog.csdn.net/KXL5180/article/details/82824003?ops_request_misc=%7B%22request_id%22:%22168424305316800227456811%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168424305316800227456811&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-82824003-null-null.142%5Ev87%5Einsert_down28,239%5Ev2%5Einsert_chatgpt&utm_term=UVa10382&spm=1018.2226.3001.4187">(450æ¡æ¶ˆæ¯) UVA-10382ç»å…¸è´ªå¿ƒé—®é¢˜ï¼ŒåŒºé—´è¦†ç›–_uva 10382_KXL5180çš„åšå®¢-CSDNåšå®¢</a></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//é…¸å¥¶å·¥ç¨‹</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;<span class="comment">//å®šä¹‰long longï¼Œé˜²æ­¢çˆ†int</span></span><br><span class="line">ll n,s;</span><br><span class="line">ll c[<span class="number">10010</span>],y[<span class="number">10010</span>];<span class="comment">//å­˜å‚¨è´¹ç”¨å’Œäº¤äº’æ•°é‡</span></span><br><span class="line">ll f[<span class="number">10010</span>];</span><br><span class="line">ll sum=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>,&amp;n,&amp;s);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>,&amp;c[i],&amp;y[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i==<span class="number">1</span>)&#123;</span><br><span class="line">            f[i]=c[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            f[i]=<span class="built_in">min</span>(c[i],f[i<span class="number">-1</span>]+s);</span><br><span class="line">        &#125;</span><br><span class="line">        sum=sum+f[i]*y[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>,sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è·³è·ƒé—®é¢˜"><a href="#è·³è·ƒé—®é¢˜" class="headerlink" title="è·³è·ƒé—®é¢˜"></a>è·³è·ƒé—®é¢˜</h2><p><a href="https://blog.csdn.net/weixin_41570890/article/details/110795229?ops_request_misc=&request_id=&biz_id=102&utm_term=%E8%B7%B3%E8%B7%83%E9%97%AE%E9%A2%982&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-110795229.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&spm=1018.2226.3001.4187">(462æ¡æ¶ˆæ¯) Leetcodeâ€”â€”è·³è·ƒé—®é¢˜II_è·³è·ƒé—®é¢˜2_Purple.â€™â€™çš„åšå®¢-CSDNåšå®¢</a></p><h2 id="åˆ†å‘ç³–æœ"><a href="#åˆ†å‘ç³–æœ" class="headerlink" title="åˆ†å‘ç³–æœ"></a>åˆ†å‘ç³–æœ</h2><p><a href="https://blog.csdn.net/youngyangyang04/article/details/111190664?ops_request_misc=%7B%22request_id%22:%22168647702416800197016860%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168647702416800197016860&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-4-111190664-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=%E5%88%86%E5%8F%91%E7%B3%96%E6%9E%9C&spm=1018.2226.3001.4187">(462æ¡æ¶ˆæ¯) ã€Œleetcodeã€135.åˆ†å‘ç³–æœã€è´ªå¿ƒç®—æ³•ã€‘è¯¦ç»†å›¾è§£_ä»£ç éšæƒ³å½•çš„åšå®¢-CSDNåšå®¢</a></p><h2 id="çº¿æ®µæ ‘"><a href="#çº¿æ®µæ ‘" class="headerlink" title="çº¿æ®µæ ‘"></a>çº¿æ®µæ ‘</h2><p><a href="https://blog.csdn.net/weixin_45697774/article/details/104274713?ops_request_misc=%7B%22request_id%22:%22168667245116800197028500%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168667245116800197028500&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-104274713-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=%E7%BA%BF%E6%AE%B5%E6%A0%91&spm=1018.2226.3001.4187">(462æ¡æ¶ˆæ¯) çº¿æ®µæ ‘ ä»å…¥é—¨åˆ°è¿›é˜¶ï¼ˆè¶…æ¸…æ™°ï¼Œç®€å•æ˜“æ‡‚ï¼‰_çº¿æ®µæ ‘è¿›é˜¶_ç¹å‡¡ã•ã‚“çš„åšå®¢-CSDNåšå®¢</a></p><h2 id="åŒˆç‰™åˆ©ç®—æ³•"><a href="#åŒˆç‰™åˆ©ç®—æ³•" class="headerlink" title="åŒˆç‰™åˆ©ç®—æ³•"></a>åŒˆç‰™åˆ©ç®—æ³•</h2><p><a href="https://blog.csdn.net/lemonxiaoxiao/article/details/108672039?ops_request_misc=%7B%22request_id%22:%22168667270816800222874127%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168667270816800222874127&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-108672039-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=%E5%8C%88%E7%89%99%E5%88%A9%E7%AE%97%E6%B3%95&spm=1018.2226.3001.4187">(462æ¡æ¶ˆæ¯) åŒˆç‰™åˆ©ç®—æ³•è¯¦è§£_Amelie_xiaoçš„åšå®¢-CSDNåšå®¢</a></p><p><strong>ä¸€ä¸ªäºŒåˆ†å›¾ä¸­çš„æœ€å¤§åŒ¹é…æ•°ç­‰äºè¿™ä¸ªå›¾ä¸­çš„æœ€å°ç‚¹è¦†ç›–æ•°</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> M, N;            <span class="comment">//M, Nåˆ†åˆ«è¡¨ç¤ºå·¦ã€å³ä¾§é›†åˆçš„å…ƒç´ æ•°é‡</span></span><br><span class="line"><span class="type">int</span> Map[MAXM][MAXN]; <span class="comment">//é‚»æ¥çŸ©é˜µå­˜å›¾</span></span><br><span class="line"><span class="type">int</span> p[MAXN];         <span class="comment">//è®°å½•å½“å‰å³ä¾§å…ƒç´ æ‰€å¯¹åº”çš„å·¦ä¾§å…ƒç´ </span></span><br><span class="line"><span class="type">bool</span> vis[MAXN];      <span class="comment">//è®°å½•å³ä¾§å…ƒç´ æ˜¯å¦å·²è¢«è®¿é—®è¿‡</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">match</span><span class="params">(<span class="type">int</span> i)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= N; ++j)</span><br><span class="line">        <span class="keyword">if</span> (Map[i][j] &amp;&amp; !vis[j]) <span class="comment">//æœ‰è¾¹ä¸”æœªè®¿é—®</span></span><br><span class="line">        &#123;</span><br><span class="line">            vis[j] = <span class="literal">true</span>;                 <span class="comment">//è®°å½•çŠ¶æ€ä¸ºè®¿é—®è¿‡</span></span><br><span class="line">            <span class="keyword">if</span> (p[j] == <span class="number">0</span> || <span class="built_in">match</span>(p[j])) <span class="comment">//å¦‚æœæš‚æ— åŒ¹é…ï¼Œæˆ–è€…åŸæ¥åŒ¹é…çš„å·¦ä¾§å…ƒç´ å¯ä»¥æ‰¾åˆ°æ–°çš„åŒ¹é…</span></span><br><span class="line">            &#123;</span><br><span class="line">                p[j] = i;    <span class="comment">//å½“å‰å·¦ä¾§å…ƒç´ æˆä¸ºå½“å‰å³ä¾§å…ƒç´ çš„æ–°åŒ¹é…</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">//è¿”å›åŒ¹é…æˆåŠŸ</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">//å¾ªç¯ç»“æŸï¼Œä»æœªæ‰¾åˆ°åŒ¹é…ï¼Œè¿”å›åŒ¹é…å¤±è´¥</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Hungarian</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= M; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">memset</span>(vis, <span class="number">0</span>, <span class="built_in">sizeof</span>(vis)); <span class="comment">//é‡ç½®visæ•°ç»„</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">match</span>(i))</span><br><span class="line">            cnt++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="å›æº¯"><a href="#å›æº¯" class="headerlink" title="å›æº¯"></a>å›æº¯</h2><p>[(462æ¡æ¶ˆæ¯) 2018å—äº¬å¤§å­¦è®¡ç®—æœºå¤ä»¤è¥æœºè¯•ç¬¬äºŒé¢˜ï¼ˆå›æº¯ï¼‰_åªä¼šå†™è‡­è™«çš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/weixin_43175029/article/details/94670710?ops_request_misc=&request_id=&biz_id=102&utm_term=Missing">https://blog.csdn.net/weixin_43175029/article/details/94670710?ops_request_misc=&amp;request_id=&amp;biz_id=102&amp;utm_term=Missing</a> number  Given a positi&amp;utm_medium&#x3D;distribute.pc_search_result.none-task-blog-2<del>all</del>sobaiduweb~default-0-94670710.142^v88^control_2,239^v2^insert_chatgpt&amp;spm&#x3D;1018.2226.3001.4187)</p><p>å›æº¯å°±æ˜¯dfsï¼Œå¹¶ä¸”åœ¨æ¯æ¬¡dfsæ—¶è®°å¾—æ¢å¤åŸçŠ¶æ€ï¼›å¦‚æœåªéœ€è¦è¾“å‡ºä¸€ç§çŠ¶æ€ï¼Œè®¾ç½®flagæ ‡å¿—ä½</p><p>Nçš‡å</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">20</span>; </span><br><span class="line"> </span><br><span class="line"><span class="comment">// boolæ•°ç»„ç”¨æ¥åˆ¤æ–­æœç´¢çš„ä¸‹ä¸€ä¸ªä½ç½®æ˜¯å¦å¯è¡Œ</span></span><br><span class="line"><span class="comment">// colåˆ—ï¼Œdgå¯¹è§’çº¿ï¼Œudgåå¯¹è§’çº¿</span></span><br><span class="line"><span class="comment">// g[N][N]ç”¨æ¥å­˜è·¯å¾„</span></span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">char</span> g[N][N];</span><br><span class="line"><span class="type">bool</span> col[N], dg[N], udg[N];</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// u == n è¡¨ç¤ºå·²ç»æœäº†nè¡Œï¼Œæ•…è¾“å‡ºè¿™æ¡è·¯å¾„</span></span><br><span class="line">    <span class="keyword">if</span> (u == n) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i ++ ) <span class="built_in">puts</span>(g[i]);   <span class="comment">// ç­‰ä»·äºcout &lt;&lt; g[i] &lt;&lt; endl;</span></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);  <span class="comment">// æ¢è¡Œ</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// æšä¸¾uè¿™ä¸€è¡Œï¼Œæœç´¢åˆæ³•çš„åˆ—</span></span><br><span class="line">    <span class="type">int</span> x = u;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> y = <span class="number">0</span>; y &lt; n; y ++ )</span><br><span class="line">        <span class="comment">// å‰ªæ(å¯¹äºä¸æ»¡è¶³è¦æ±‚çš„ç‚¹ï¼Œä¸å†ç»§ç»­å¾€ä¸‹æœç´¢)  </span></span><br><span class="line">        <span class="comment">// è¿™é‡Œy-x+næ˜¯å·¦ä¸Šè§’åˆ°å³ä¸‹è§’,y+xæ˜¯å·¦ä¸‹è§’åˆ°å³ä¸Šè§’</span></span><br><span class="line">        <span class="keyword">if</span> (col[y] == <span class="literal">false</span> &amp;&amp; dg[y - x + n] == <span class="literal">false</span> &amp;&amp; udg[y + x] == <span class="literal">false</span>) &#123;</span><br><span class="line">            col[y] = dg[y - x + n] = udg[y + x] = <span class="literal">true</span>;</span><br><span class="line">            g[x][y] = <span class="string">&#x27;Q&#x27;</span>;</span><br><span class="line">            <span class="built_in">dfs</span>(x + <span class="number">1</span>);</span><br><span class="line">            g[x][y] = <span class="string">&#x27;.&#x27;</span>;  <span class="comment">// æ¢å¤ç°åœº</span></span><br><span class="line">            col[y] = dg[y - x + n] = udg[y + x] = <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; i ++ )</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; j ++ )</span><br><span class="line">            g[i][j] = <span class="string">&#x27;.&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">0</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;   </span><br><span class="line"> </span><br></pre></td></tr></table></figure><h2 id="å»ºç«‹ç´¢å¼•æ ‘"><a href="#å»ºç«‹ç´¢å¼•æ ‘" class="headerlink" title="å»ºç«‹ç´¢å¼•æ ‘"></a>å»ºç«‹ç´¢å¼•æ ‘</h2><p>[(462æ¡æ¶ˆæ¯) 2020åŒ—èˆªè®¡ç®—æœºå¤ä»¤è¥æœºè¯•é¢˜ç›®ä¸ªäººç†è§£_åŒ—èˆªå¤ä»¤è¥ æœºè¯•_å››å¤„ç¢°å£å˜¤å˜¤æ€ªçš„åšå®¢-CSDNåšå®¢](<a href="https://blog.csdn.net/Bernie_double/article/details/118190022?ops_request_misc=%7B%22request_id%22:%22168715279416800185829257%22,%22scm%22:%2220140713.130102334..%22%7D&request_id=168715279416800185829257&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-5-118190022-null-null.142%5Ev88%5Econtrol_2,239%5Ev2%5Einsert_chatgpt&utm_term=%E5%8C%97%E8%88%AA%E5%A4%8F%E4%BB%A4%E8%90%A5">https://blog.csdn.net/Bernie_double/article/details/118190022?ops_request_misc=%7B%22request%5Fid%22%3A%22168715279416800185829257%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&amp;request_id=168715279416800185829257&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-5-118190022-null-null.142^v88^control_2,239^v2^insert_chatgpt&amp;utm_term=åŒ—èˆªå¤ä»¤è¥</a> æœºè¯•&amp;spm&#x3D;1018.2226.3001.4187)</p><p>æ³¨æ„ å»ºæ ‘ä¸ä¸€å®šè¦æŒ‡é’ˆï¼Œæ•°ç»„ä¹Ÿå¯</p><p>4 5<br>1 0 1 0 0<br>1 0 1 1 1<br>1 1 1 1 1<br>1 0 0 1 0</p>]]></content>
      
      
      <categories>
          
          <category> åšå®¢ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
            <tag> C++ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ·±å…¥ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿï¼ˆäºŒï¼‰åˆ†å¸ƒå¼ç³»ç»Ÿæ¨¡å‹</title>
      <link href="/2024/06/24/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%EF%BC%88%E4%BA%8C%EF%BC%89%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E6%A8%A1%E5%9E%8B/"/>
      <url>/2024/06/24/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%EF%BC%88%E4%BA%8C%EF%BC%89%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E6%A8%A1%E5%9E%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="åˆ†å¸ƒå¼ç³»ç»Ÿæ¨¡å‹"><a href="#åˆ†å¸ƒå¼ç³»ç»Ÿæ¨¡å‹" class="headerlink" title="åˆ†å¸ƒå¼ç³»ç»Ÿæ¨¡å‹"></a>åˆ†å¸ƒå¼ç³»ç»Ÿæ¨¡å‹</h1><h2 id="2-1-ä¸¤å°†å†›é—®é¢˜"><a href="#2-1-ä¸¤å°†å†›é—®é¢˜" class="headerlink" title="2.1 ä¸¤å°†å†›é—®é¢˜"></a>2.1 ä¸¤å°†å†›é—®é¢˜</h2><p>â€œä¸¤å°†å†›é—®é¢˜â€æ˜¯ä¸€ä¸ªç»å…¸çš„åˆ†å¸ƒå¼ç³»ç»Ÿé—®é¢˜ï¼Œæ—¨åœ¨ç ”ç©¶åœ¨å­˜åœ¨æ•…éšœèŠ‚ç‚¹çš„æƒ…å†µä¸‹å¦‚ä½•åè°ƒä¸¤ä¸ªè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚</p><p>é—®é¢˜åœºæ™¯æ˜¯ä¸¤ä¸ªå°†å†›åˆ†åˆ«ç‡é¢†ä¸€æ”¯å†›é˜Ÿè¿›æ”»æ•Œæ–¹åŸå¸‚ã€‚ä¸¤ä¸ªå°†å†›ä¹‹é—´å¿…é¡»è¾¾æˆä¸€è‡´ï¼Œä»¥ç¡®å®šè¿›æ”»æ—¶é—´å’Œç­–ç•¥ã€‚ä½†æ˜¯ï¼Œå°†å†›ä»¬åˆ†åˆ«ä½äºä¸¤ä¸ªä¸åŒçš„è¥åœ°ï¼Œåªèƒ½é€šè¿‡ä¿¡ä½¿è¿›è¡Œé€šä¿¡ã€‚æ­¤å¤–ï¼Œæœ‰å¯èƒ½å­˜åœ¨æ¶åŠ£çš„å¤©æ°”æˆ–å…¶å®ƒå› ç´ å¹²æ‰°é€šä¿¡ï¼Œæˆ–è€…å…¶ä¸­ä¸€ä¸ªå°†å†›çš„ä¿¡ä½¿è¢«æ•ŒäººæŠ“ä½å¹¶ä¿®æ”¹äº†æ¶ˆæ¯ã€‚</p><p>è¯¥é—®é¢˜çš„å…³é”®æ˜¯å¦‚ä½•ç¡®ä¿å°†å†›ä¹‹é—´çš„é€šä¿¡å¯é ï¼Œå¹¶é¿å…æ¶ˆæ¯çš„ä¸¢å¤±å’Œç¯¡æ”¹ã€‚ç»å…¸çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨æ‹œå åº­å°†å†›é—®é¢˜ä¸­çš„æ‹œå åº­å®¹é”™ç®—æ³•ï¼Œè¯¥ç®—æ³•å¯ä»¥å®¹å¿éƒ¨åˆ†èŠ‚ç‚¹çš„æ•…éšœå’Œæ¶æ„æ”»å‡»ã€‚</p><p>å…·ä½“å®ç°ä¸Šï¼Œå°†å†›ä»¬éœ€è¦è¾¾æˆå…±è¯†ï¼Œä»¥å†³å®šè¿›æ”»æ—¶é—´å’Œç­–ç•¥ã€‚é¦–å…ˆï¼Œæ¯ä¸ªå°†å†›å‘æ‰€æœ‰å…¶ä»–å°†å†›å‘é€ä¸€ä¸ªå†³ç­–ä¿¡æ¯ï¼Œå¹¶ç­‰å¾…å›å¤ã€‚å¦‚æœå°†å†›æ”¶åˆ°çš„å›å¤éƒ½æ˜¯ä¸€è‡´çš„ï¼Œä»–å°±å¯ä»¥ç¡®å®šå…¶ä»–å°†å†›çš„å†³ç­–ï¼Œå¹¶åšå‡ºç›¸åº”çš„è¡ŒåŠ¨ã€‚å¦‚æœå°†å†›æ”¶åˆ°çš„å›å¤ä¸ä¸€è‡´ï¼Œä»–ä¼šå°†è¿™äº›ä¿¡æ¯å†æ¬¡å‘é€ç»™æ‰€æœ‰å…¶ä»–å°†å†›ï¼Œç›´åˆ°æ”¶åˆ°ä¸€è‡´çš„å›å¤ã€‚</p><p>åœ¨è¯¥é—®é¢˜ä¸­ï¼Œæ¯ä¸ªå°†å†›éœ€è¦çŸ¥é“æœ‰å¤šå°‘å…¶ä»–å°†å†›å‚ä¸åè°ƒï¼Œå¹¶ä¸”éœ€è¦å®¹å¿å…¶ä»–å°†å†›çš„å¯èƒ½å¤±è´¥å’Œæ¶æ„è¡Œä¸ºã€‚è¿™éœ€è¦è®¾è®¡åˆé€‚çš„ç®—æ³•å’Œåè®®æ¥ä¿è¯å°†å†›ä¹‹é—´çš„åä½œå’Œå…±è¯†ã€‚</p><p>æ€»ä¹‹ï¼Œâ€œä¸¤å°†å†›é—®é¢˜â€æ˜¯ä¸€ä¸ªç»å…¸çš„åˆ†å¸ƒå¼ç³»ç»Ÿé—®é¢˜ï¼Œå®ƒæ¢è®¨äº†å¦‚ä½•åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å®ç°å¯é é€šä¿¡å’Œå…±è¯†åä½œçš„é—®é¢˜ã€‚æ‹œå åº­å®¹é”™ç®—æ³•æä¾›äº†ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥å®¹å¿éƒ¨åˆ†èŠ‚ç‚¹çš„æ•…éšœå’Œæ¶æ„æ”»å‡»ï¼Œä»è€Œç¡®ä¿å°†å†›ä¹‹é—´çš„é€šä¿¡å¯é æ€§å’Œä¸€è‡´æ€§ã€‚</p><p><strong>TCPä¸‰æ¬¡æ¡æ‰‹ä¸å…¶çš„å…³ç³»</strong></p><p>TCPä¸‰æ¬¡æ¡æ‰‹æ˜¯ä¸€ç§å»ºç«‹TCPè¿æ¥çš„è¿‡ç¨‹ï¼ŒåŒ…æ‹¬å®¢æˆ·ç«¯å‘é€SYNæŠ¥æ–‡ï¼ŒæœåŠ¡å™¨å›å¤SYN+ACKæŠ¥æ–‡ï¼Œæœ€åå®¢æˆ·ç«¯å›å¤ACKæŠ¥æ–‡ï¼Œå»ºç«‹è¿æ¥ã€‚</p><p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒTCPä¸‰æ¬¡æ¡æ‰‹æ˜¯å®ç°å¯é é€šä¿¡çš„é‡è¦æ‰‹æ®µã€‚å®ƒç¡®ä¿äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„è¿æ¥åœ¨å»ºç«‹æ—¶å…·æœ‰å¯é æ€§å’Œç¨³å®šæ€§ã€‚é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å¯ä»¥ç¡®ä¿å¯¹æ–¹å·²ç»å‡†å¤‡å¥½è¿›è¡Œé€šä¿¡ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥åœ¨è¿æ¥å»ºç«‹ä¹‹å‰è¿›è¡Œä¸€äº›å¿…è¦çš„ä¿¡æ¯äº¤æ¢å’ŒéªŒè¯ï¼Œå¦‚åå•†è¿æ¥å‚æ•°å’Œæ£€æŸ¥è¿æ¥çš„æœ‰æ•ˆæ€§ç­‰ã€‚</p><p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒTCPä¸‰æ¬¡æ¡æ‰‹ä¹Ÿå¯ä»¥ç”¨äºè§£å†³â€œä¸¤å°†å†›é—®é¢˜â€ï¼Œç¡®ä¿ä¸¤ä¸ªè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡å¯é å’Œä¸€è‡´ã€‚ç±»ä¼¼äºTCPä¸‰æ¬¡æ¡æ‰‹ï¼Œä¸¤ä¸ªè¿›ç¨‹å¯ä»¥é€šè¿‡å‘é€å’Œç¡®è®¤æ¶ˆæ¯æ¥å»ºç«‹è¿æ¥ï¼Œå¹¶åœ¨å»ºç«‹è¿æ¥ä¹‹å‰è¿›è¡Œå¿…è¦çš„éªŒè¯å’Œä¿¡æ¯äº¤æ¢ï¼Œä»¥ç¡®ä¿è¿æ¥çš„å¯é æ€§å’Œæœ‰æ•ˆæ€§ã€‚</p><p>æ€»ä¹‹ï¼ŒTCPä¸‰æ¬¡æ¡æ‰‹æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å®ç°å¯é é€šä¿¡çš„é‡è¦æ‰‹æ®µï¼Œå®ƒå¯ä»¥ç¡®ä¿è¿æ¥çš„å¯é æ€§å’Œæœ‰æ•ˆæ€§ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥åº”ç”¨äºè§£å†³å…¶ä»–ç±»ä¼¼çš„åˆ†å¸ƒå¼ç³»ç»Ÿé—®é¢˜ï¼Œå¦‚â€œä¸¤å°†å†›é—®é¢˜â€ã€‚</p><h2 id="2-2-æ‹œå åº­å°†å†›é—®é¢˜"><a href="#2-2-æ‹œå åº­å°†å†›é—®é¢˜" class="headerlink" title="2.2 æ‹œå åº­å°†å†›é—®é¢˜"></a>2.2 æ‹œå åº­å°†å†›é—®é¢˜</h2><p>æ‹œå åº­å°†å†›é—®é¢˜ï¼ˆByzantine Generals Problemï¼‰æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ä¸€ä¸ªç»å…¸é—®é¢˜ï¼Œæ¶‰åŠåˆ°åœ¨å­˜åœ¨æ•…éšœæˆ–æ¶æ„è¡Œä¸ºçš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•è¿›è¡Œåˆ†å¸ƒå¼å†³ç­–ã€‚</p><p>é—®é¢˜åœºæ™¯æ˜¯ï¼Œåœ¨æ‹œå åº­å¸å›½ï¼Œå‡ ä¸ªå°†å†›ç‡é¢†å„è‡ªçš„éƒ¨é˜Ÿå›´æ”»æ•Œäººã€‚ä»–ä»¬å¿…é¡»å°±è¿›æ”»æˆ–æ’¤é€€è¾¾æˆä¸€è‡´çš„å†³ç­–ï¼Œä½†æ˜¯å°†å†›ä¹‹é—´åªèƒ½é€šè¿‡æ¶ˆæ¯ä¼ é€’è¿›è¡Œé€šä¿¡ã€‚ç„¶è€Œï¼Œæœ‰å¯èƒ½å­˜åœ¨ä¸€äº›å›å˜çš„å°†å†›ï¼Œä»–ä»¬ä¼šä¼ é€’è™šå‡ä¿¡æ¯ï¼Œå¯¼è‡´å…¶ä»–å°†å†›åšå‡ºé”™è¯¯çš„å†³ç­–ã€‚</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚ä½•ç¡®ä¿å°†å†›ä»¬å¯ä»¥å°±æ­£ç¡®çš„è¿›æ”»æˆ–æ’¤é€€åšå‡ºå†³ç­–ï¼Œå³ä½¿æœ‰äº›å°†å†›å›å˜æˆ–å‘ç”Ÿæ•…éšœã€‚</p><p>æ‹œå åº­å°†å†›é—®é¢˜çš„è§£å†³æ–¹æ¡ˆæ˜¯æ‹œå åº­å®¹é”™ç®—æ³•ï¼ˆByzantine Fault Tolerance Algorithmï¼‰ã€‚è¯¥ç®—æ³•å¯ä»¥å®¹å¿éƒ¨åˆ†èŠ‚ç‚¹çš„æ•…éšœå’Œæ¶æ„æ”»å‡»ï¼Œä»è€Œç¡®ä¿åˆ†å¸ƒå¼ç³»ç»Ÿåœ¨å­˜åœ¨æ•…éšœæˆ–æ¶æ„è¡Œä¸ºçš„æƒ…å†µä¸‹ä»ç„¶èƒ½å¤Ÿæ­£ç¡®åœ°å·¥ä½œã€‚</p><p>å…·ä½“å®ç°ä¸Šï¼Œæ‹œå åº­å®¹é”™ç®—æ³•éœ€è¦å°†æ¯ä¸ªå°†å†›çœ‹ä½œä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°†èŠ‚ç‚¹ä¹‹é—´çš„é€šä¿¡çœ‹ä½œæ¶ˆæ¯ä¼ é€’ã€‚æ¯ä¸ªå°†å†›å¿…é¡»å‘å…¶ä»–å°†å†›å‘é€è‡ªå·±çš„å†³ç­–ä¿¡æ¯ï¼Œå¹¶æ ¹æ®æ¥æ”¶åˆ°çš„æ¶ˆæ¯æ¥åšå‡ºæœ€ç»ˆçš„å†³ç­–ã€‚</p><p>åœ¨ç®—æ³•ä¸­ï¼Œæ¯ä¸ªå°†å†›å¿…é¡»å†³å®šä¸€ä¸ªä¿¡ä»»é˜ˆå€¼ï¼ˆtrust thresholdï¼‰ï¼Œå³å¯ä»¥å®¹å¿å¤šå°‘ä¸ªå›å˜èŠ‚ç‚¹ã€‚å¦‚æœå›å˜èŠ‚ç‚¹çš„æ•°é‡è¶…è¿‡ä¿¡ä»»é˜ˆå€¼ï¼Œåˆ™å°†å†›ä¸å†ç›¸ä¿¡è¿™äº›èŠ‚ç‚¹ä¼ é€’çš„ä¿¡æ¯ã€‚æ¯ä¸ªå°†å†›éƒ½éœ€è¦å‘å…¶ä»–å°†å†›å‘é€è‡ªå·±çš„å†³ç­–ä¿¡æ¯ï¼Œå¹¶åœ¨æ¥æ”¶åˆ°è¶³å¤Ÿæ•°é‡çš„ä¿¡æ¯åï¼Œæ ¹æ®è¿™äº›ä¿¡æ¯æ¥åšå‡ºæœ€ç»ˆçš„å†³ç­–ã€‚</p><p>æ‹œå åº­å®¹é”™ç®—æ³•æä¾›äº†ä¸€ç§è§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å­˜åœ¨æ•…éšœæˆ–æ¶æ„è¡Œä¸ºçš„é—®é¢˜çš„æ–¹æ³•ï¼Œå¯ä»¥ä¿è¯åœ¨ä¸€å®šç¨‹åº¦ä¸Šå®¹å¿èŠ‚ç‚¹çš„æ•…éšœå’Œæ¶æ„æ”»å‡»ï¼Œä»è€Œç¡®ä¿ç³»ç»Ÿçš„å¯é æ€§å’Œæ­£ç¡®æ€§ã€‚</p><h2 id="2-3-ç³»ç»Ÿæ¨¡å‹"><a href="#2-3-ç³»ç»Ÿæ¨¡å‹" class="headerlink" title="2.3 ç³»ç»Ÿæ¨¡å‹"></a>2.3 ç³»ç»Ÿæ¨¡å‹</h2><h3 id="2-3-1-ç½‘ç»œé“¾è·¯æ¨¡å‹"><a href="#2-3-1-ç½‘ç»œé“¾è·¯æ¨¡å‹" class="headerlink" title="2.3.1 ç½‘ç»œé“¾è·¯æ¨¡å‹"></a>2.3.1 ç½‘ç»œé“¾è·¯æ¨¡å‹</h3><p>å¯é é“¾è·¯ã€å…¬å¹³æŸå¤±é“¾è·¯å’Œä»»æ„é“¾è·¯æ˜¯ä¸‰ç§ä¸åŒç±»å‹çš„é“¾è·¯æ¨¡å‹ï¼Œå®ƒä»¬åˆ†åˆ«æè¿°äº†ç½‘ç»œé“¾è·¯çš„ä¸åŒç‰¹æ€§ã€‚</p><ol><li>å¯é é“¾è·¯ï¼šæŒ‡ä¼ è¾“å±‚æä¾›çš„æ•°æ®ä¼ è¾“æœåŠ¡æ˜¯å¯é çš„ï¼Œå³æ•°æ®åŒ…ä¸ä¼šä¸¢å¤±ã€é‡å¤ã€ä¹±åºç­‰ï¼Œè€Œä¸”ä¿è¯æ•°æ®ä¼ è¾“çš„æ­£ç¡®æ€§ã€‚è¿™ç§é“¾è·¯é€šå¸¸ç”¨äºéœ€è¦å¯é ä¼ è¾“çš„åº”ç”¨ï¼Œä¾‹å¦‚æ–‡ä»¶ä¼ è¾“ã€ç”µå­é‚®ä»¶ç­‰ã€‚</li><li>å…¬å¹³æŸå¤±é“¾è·¯ï¼šæŒ‡ä¼ è¾“å±‚æä¾›çš„æ•°æ®ä¼ è¾“æœåŠ¡æ˜¯ä¸å¯é çš„ï¼Œå³æ•°æ®åŒ…å¯èƒ½ä¼šä¸¢å¤±ã€é‡å¤ã€ä¹±åºç­‰ï¼Œä½†æ˜¯ä¸¢å¤±çš„æ¦‚ç‡æ˜¯å…¬å¹³çš„ï¼Œå³æ¯ä¸ªæ•°æ®åŒ…æœ‰ç›¸åŒçš„ä¸¢å¤±æ¦‚ç‡ã€‚è¿™ç§é“¾è·¯é€šå¸¸ç”¨äºéœ€è¦ä½å»¶è¿Ÿå’Œé«˜ååé‡çš„åº”ç”¨ï¼Œä¾‹å¦‚è§†é¢‘æµå’ŒéŸ³é¢‘æµã€‚</li><li>ä»»æ„é“¾è·¯ï¼šæŒ‡ä¼ è¾“å±‚æä¾›çš„æ•°æ®ä¼ è¾“æœåŠ¡æ˜¯ä¸å¯é çš„ï¼Œæ•°æ®åŒ…å¯èƒ½ä¼šä¸¢å¤±ã€é‡å¤ã€ä¹±åºç­‰ï¼Œå¹¶ä¸”ä¸¢å¤±çš„æ¦‚ç‡ä¹Ÿæ˜¯ä¸ç¡®å®šçš„ã€‚è¿™ç§é“¾è·¯é€šå¸¸ç”¨äºäº’è”ç½‘ç­‰å¤§è§„æ¨¡ã€ä¸å¯æ§çš„ç½‘ç»œç¯å¢ƒä¸­ã€‚</li></ol><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä¸åŒçš„é“¾è·¯æ¨¡å‹é€‚ç”¨äºä¸åŒçš„åº”ç”¨åœºæ™¯ã€‚ä¾‹å¦‚ï¼Œå¯é é“¾è·¯é€‚ç”¨äºéœ€è¦å¯é ä¼ è¾“çš„åº”ç”¨ï¼Œå…¬å¹³æŸå¤±é“¾è·¯é€‚ç”¨äºéœ€è¦ä½å»¶è¿Ÿå’Œé«˜ååé‡çš„åº”ç”¨ï¼Œä»»æ„é“¾è·¯åˆ™é€‚ç”¨äºå¤§è§„æ¨¡ã€ä¸å¯æ§çš„ç½‘ç»œç¯å¢ƒã€‚</p><h3 id="2-3-2-èŠ‚ç‚¹æ•…éšœç±»å‹"><a href="#2-3-2-èŠ‚ç‚¹æ•…éšœç±»å‹" class="headerlink" title="2.3.2 èŠ‚ç‚¹æ•…éšœç±»å‹"></a>2.3.2 èŠ‚ç‚¹æ•…éšœç±»å‹</h3><p>åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼ŒèŠ‚ç‚¹æ•…éšœç±»å‹ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ol><li>å®•æœºæ•…éšœï¼šæŒ‡èŠ‚ç‚¹å› ä¸ºç¡¬ä»¶æ•…éšœã€è½¯ä»¶æ•…éšœç­‰åŸå› è€Œåœæ­¢å·¥ä½œï¼Œæ— æ³•å¤„ç†è¯·æ±‚å’Œå‘é€å“åº”ã€‚</li><li>ç½‘ç»œæ•…éšœï¼šæŒ‡èŠ‚ç‚¹ä¸ç½‘ç»œä¸­çš„å…¶ä»–èŠ‚ç‚¹å¤±å»äº†è¿æ¥ï¼Œæ— æ³•æ­£å¸¸é€šä¿¡ã€‚</li><li>æ—¶é’Ÿåå·®æ•…éšœï¼šæŒ‡èŠ‚ç‚¹çš„æœ¬åœ°æ—¶é’Ÿä¸å…¶ä»–èŠ‚ç‚¹çš„æ—¶é’Ÿå­˜åœ¨åå·®ï¼Œå¯¼è‡´èŠ‚ç‚¹æ— æ³•å‡†ç¡®åˆ¤æ–­äº‹ä»¶çš„å…ˆåé¡ºåºã€‚</li><li>èŠ‚ç‚¹è½¯ä»¶æ•…éšœï¼šæŒ‡èŠ‚ç‚¹è¿è¡Œçš„è½¯ä»¶å‡ºç°äº†é”™è¯¯ï¼Œå¯¼è‡´èŠ‚ç‚¹æ— æ³•æ­£å¸¸å¤„ç†è¯·æ±‚å’Œå‘é€å“åº”ã€‚</li><li>èŠ‚ç‚¹é…ç½®æ•…éšœï¼šæŒ‡èŠ‚ç‚¹çš„é…ç½®æ–‡ä»¶æˆ–è€…å‚æ•°è®¾ç½®å‡ºç°é”™è¯¯ï¼Œå¯¼è‡´èŠ‚ç‚¹æ— æ³•æ­£å¸¸å·¥ä½œã€‚</li></ol><p>ä»¥ä¸ŠèŠ‚ç‚¹æ•…éšœç±»å‹éƒ½å¯èƒ½å¯¹åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œé€ æˆå½±å“ï¼Œå› æ­¤åœ¨è®¾è®¡å’Œå®ç°åˆ†å¸ƒå¼ç³»ç»Ÿæ—¶éœ€è¦è€ƒè™‘å¦‚ä½•å¤„ç†è¿™äº›æ•…éšœï¼Œæé«˜ç³»ç»Ÿçš„å®¹é”™æ€§å’Œå¯é æ€§ã€‚å¸¸ç”¨çš„æ–¹æ³•åŒ…æ‹¬å¤‡ä»½ã€å†—ä½™ã€æ£€æŸ¥ç‚¹å’Œæ¢å¤ç­‰ã€‚</p><p>å´©æºƒåœæ­¢ã€å´©æºƒæ¢å¤å’Œæ‹œå åº­æ•…éšœæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¸¸è§çš„æ•…éšœç±»å‹å’Œå¤„ç†æ–¹æ³•ã€‚</p><ol><li>å´©æºƒåœæ­¢ï¼šæŒ‡èŠ‚ç‚¹å› ä¸ºç¡¬ä»¶æ•…éšœã€è½¯ä»¶æ•…éšœç­‰åŸå› è€Œåœæ­¢å·¥ä½œï¼Œæ— æ³•å¤„ç†è¯·æ±‚å’Œå‘é€å“åº”ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé€šå¸¸çš„åšæ³•æ˜¯é€šè¿‡å¤‡ä»½æˆ–è€…å†—ä½™æœºåˆ¶æ¥ä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚</li><li>å´©æºƒæ¢å¤ï¼šæŒ‡èŠ‚ç‚¹åœ¨å´©æºƒä¹‹åèƒ½å¤Ÿæ¢å¤æ­£å¸¸å·¥ä½œã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå´©æºƒæ¢å¤é€šå¸¸é€šè¿‡æ£€æŸ¥ç‚¹å’Œæ¢å¤æœºåˆ¶å®ç°ã€‚æ£€æŸ¥ç‚¹æ˜¯æŒ‡åœ¨èŠ‚ç‚¹æ­£å¸¸å·¥ä½œçš„è¿‡ç¨‹ä¸­å®šæœŸä¿å­˜ç³»ç»ŸçŠ¶æ€çš„å¿«ç…§ï¼Œå½“èŠ‚ç‚¹å´©æºƒä¹‹åï¼Œå¯ä»¥é€šè¿‡æ¢å¤æœ€è¿‘ä¸€æ¬¡çš„æ£€æŸ¥ç‚¹æ¥æ¢å¤ç³»ç»ŸçŠ¶æ€ã€‚</li><li>æ‹œå åº­æ•…éšœï¼šæŒ‡èŠ‚ç‚¹åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å‡ºç°ä¸å¯é¢„æµ‹çš„é”™è¯¯æˆ–è€…æ•…éšœï¼Œä¾‹å¦‚èŠ‚ç‚¹å‘é€é”™è¯¯çš„æ¶ˆæ¯ã€æ•…æ„ä¸å‘é€æ¶ˆæ¯ã€ç¯¡æ”¹æ¶ˆæ¯ç­‰ã€‚è¿™ç§æ•…éšœåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æ¯”è¾ƒå¸¸è§ï¼Œå› æ­¤éœ€è¦é‡‡å–ç‰¹æ®Šçš„å¤„ç†æ–¹å¼ã€‚åœ¨æ‹œå åº­æ•…éšœä¸­ï¼Œé€šå¸¸ä½¿ç”¨å¤šæ•°æŠ•ç¥¨ç®—æ³•æˆ–è€…æ‹œå åº­å®¹é”™ç®—æ³•æ¥è§£å†³ã€‚å¤šæ•°æŠ•ç¥¨ç®—æ³•æ˜¯æŒ‡èŠ‚ç‚¹ä¹‹é—´é€šè¿‡æŠ•ç¥¨æ¥å†³å®šæœ€ç»ˆçš„ç»“æœï¼Œåªæœ‰å¾—åˆ°å¤šæ•°èŠ‚ç‚¹çš„è®¤å¯æ‰è¢«è®¤ä¸ºæ˜¯æœ‰æ•ˆçš„ã€‚æ‹œå åº­å®¹é”™ç®—æ³•åˆ™æ˜¯ä¸€ç§æ›´åŠ å¤æ‚çš„ç®—æ³•ï¼Œå¯ä»¥åœ¨å°‘æ•°èŠ‚ç‚¹å‡ºç°æ•…éšœæˆ–è€…æ¶æ„è¡Œä¸ºçš„æƒ…å†µä¸‹ä»ç„¶ä¿è¯ç³»ç»Ÿçš„æ­£ç¡®æ€§ã€‚</li></ol><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œåˆ†å¸ƒå¼ç³»ç»Ÿéœ€è¦æ ¹æ®ä¸åŒçš„æ•…éšœç±»å‹å’Œå¤„ç†æ–¹å¼æ¥è®¾è®¡å’Œå®ç°ï¼Œæé«˜ç³»ç»Ÿçš„å®¹é”™æ€§å’Œå¯é æ€§ã€‚</p><h3 id="2-3-3-æŒ‰æ—¶é—´åˆ’åˆ†æ¨¡å‹"><a href="#2-3-3-æŒ‰æ—¶é—´åˆ’åˆ†æ¨¡å‹" class="headerlink" title="2.3.3 æŒ‰æ—¶é—´åˆ’åˆ†æ¨¡å‹"></a>2.3.3 æŒ‰æ—¶é—´åˆ’åˆ†æ¨¡å‹</h3><p>åŒæ­¥æ¨¡å‹ã€å¼‚æ­¥æ¨¡å‹å’Œéƒ¨åˆ†åŒæ­¥æ¨¡å‹æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¸¸è§çš„é€šä¿¡æ¨¡å‹ã€‚</p><ol><li>åŒæ­¥æ¨¡å‹ï¼šæŒ‡è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æ˜¯åŸºäºåŒæ­¥çš„ï¼Œå³å‘é€æ–¹å‘é€æ¶ˆæ¯åéœ€è¦ç­‰å¾…æ¥æ”¶æ–¹ç¡®è®¤æ”¶åˆ°æ¶ˆæ¯åæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚è¿™ç§æ¨¡å‹å…·æœ‰ç®€å•ã€å¯é ã€æ˜“äºå®ç°çš„ä¼˜ç‚¹ï¼Œä½†åŒæ—¶ä¹Ÿå­˜åœ¨æ•ˆç‡ä½ã€å®¹æ˜“æ­»é”ç­‰é—®é¢˜ã€‚</li><li>å¼‚æ­¥æ¨¡å‹ï¼šæŒ‡è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æ˜¯åŸºäºå¼‚æ­¥çš„ï¼Œå³å‘é€æ–¹å‘é€æ¶ˆæ¯åä¸éœ€è¦ç­‰å¾…æ¥æ”¶æ–¹ç¡®è®¤ï¼Œå¯ä»¥ç›´æ¥ç»§ç»­æ‰§è¡Œã€‚è¿™ç§æ¨¡å‹å…·æœ‰æ•ˆç‡é«˜ã€å¹¶è¡Œåº¦é«˜ç­‰ä¼˜ç‚¹ï¼Œä½†åŒæ—¶ä¹Ÿå­˜åœ¨å¯é æ€§ä½ã€å®¹æ˜“äº§ç”Ÿä¹±åºç­‰é—®é¢˜ã€‚</li><li>éƒ¨åˆ†åŒæ­¥æ¨¡å‹ï¼šæŒ‡è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æ—¢åŒ…æ‹¬åŒæ­¥æ¨¡å‹çš„ç‰¹ç‚¹ï¼ŒåˆåŒ…æ‹¬å¼‚æ­¥æ¨¡å‹çš„ç‰¹ç‚¹ã€‚å…·ä½“æ¥è¯´ï¼Œéƒ¨åˆ†åŒæ­¥æ¨¡å‹ä¸­æ—¢å­˜åœ¨åŒæ­¥æ¶ˆæ¯ï¼Œä¹Ÿå­˜åœ¨å¼‚æ­¥æ¶ˆæ¯ã€‚è¿™ç§æ¨¡å‹å¯ä»¥åœ¨ä¿è¯å¯é æ€§çš„åŒæ—¶ï¼Œåˆèƒ½å……åˆ†å‘æŒ¥ç³»ç»Ÿçš„å¹¶è¡Œæ€§èƒ½ï¼Œå› æ­¤åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¾—åˆ°å¹¿æ³›åº”ç”¨ã€‚</li></ol><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œéœ€è¦æ ¹æ®å…·ä½“çš„åœºæ™¯æ¥é€‰æ‹©ä¸åŒçš„é€šä¿¡æ¨¡å‹ã€‚ä¾‹å¦‚ï¼Œåœ¨éœ€è¦ä¿è¯æ•°æ®ä¸€è‡´æ€§å’Œå¯é æ€§çš„åœºæ™¯ä¸­ï¼Œå¯ä»¥é€‰æ‹©åŒæ­¥æ¨¡å‹æˆ–è€…éƒ¨åˆ†åŒæ­¥æ¨¡å‹ï¼›è€Œåœ¨éœ€è¦é«˜æ•ˆå¹¶è¡Œå¤„ç†çš„åœºæ™¯ä¸­ï¼Œå¯ä»¥é€‰æ‹©å¼‚æ­¥æ¨¡å‹æˆ–è€…éƒ¨åˆ†åŒæ­¥æ¨¡å‹ã€‚</p><h2 id="2-4-æ¶ˆæ¯è¯­ä¹‰ä¼ é€’"><a href="#2-4-æ¶ˆæ¯è¯­ä¹‰ä¼ é€’" class="headerlink" title="2.4 æ¶ˆæ¯è¯­ä¹‰ä¼ é€’"></a>2.4 æ¶ˆæ¯è¯­ä¹‰ä¼ é€’</h2><p>æ¶ˆæ¯è¯­ä¹‰ä¼ é€’æŒ‡çš„æ˜¯åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¦‚ä½•ç¡®ä¿æ¶ˆæ¯çš„æ­£ç¡®ä¼ é€’å’Œè¯­ä¹‰çš„ä¸€è‡´æ€§ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæ¶ˆæ¯çš„ä¼ é€’æ˜¯é€šè¿‡ç½‘ç»œè¿›è¡Œçš„ï¼Œç½‘ç»œé€šä¿¡å¯èƒ½ä¼šå—åˆ°å„ç§å› ç´ çš„å¹²æ‰°å’Œå½±å“ï¼Œä¾‹å¦‚ç½‘ç»œå»¶è¿Ÿã€ä¸¢åŒ…ã€é‡å¤ç­‰é—®é¢˜ã€‚å› æ­¤ï¼Œåœ¨æ¶ˆæ¯çš„ä¼ é€’è¿‡ç¨‹ä¸­éœ€è¦ä¿è¯æ¶ˆæ¯çš„æ­£ç¡®æ€§å’Œè¯­ä¹‰çš„ä¸€è‡´æ€§ã€‚</p><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé€šå¸¸ä½¿ç”¨ä¸€äº›æŠ€æœ¯æ¥ä¿è¯æ¶ˆæ¯çš„æ­£ç¡®æ€§å’Œè¯­ä¹‰çš„ä¸€è‡´æ€§ï¼Œä¾‹å¦‚ï¼š</p><ol><li>æ¶ˆæ¯ç¡®è®¤æœºåˆ¶ï¼šå‘é€æ–¹åœ¨å‘é€æ¶ˆæ¯åï¼Œéœ€è¦ç­‰å¾…æ¥æ”¶æ–¹çš„ç¡®è®¤æ¶ˆæ¯ï¼Œä»¥ç¡®ä¿æ¶ˆæ¯è¢«æ­£ç¡®åœ°æ¥æ”¶ã€‚å¦‚æœå‘é€æ–¹åœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°ç¡®è®¤æ¶ˆæ¯ï¼Œå°±ä¼šé‡æ–°å‘é€æ¶ˆæ¯ï¼Œä»¥ä¿è¯æ¶ˆæ¯çš„å¯é ä¼ é€’ã€‚</li><li>æ¶ˆæ¯é‡å¤æ£€æµ‹ï¼šæ¥æ”¶æ–¹åœ¨æ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šå¯¹æ¶ˆæ¯è¿›è¡Œå”¯ä¸€æ€§æ£€æµ‹ï¼Œä»¥é¿å…é‡å¤å¤„ç†æ¶ˆæ¯ï¼Œä»è€Œä¿è¯æ¶ˆæ¯è¯­ä¹‰çš„ä¸€è‡´æ€§ã€‚</li><li>äº‹åŠ¡æœºåˆ¶ï¼šåœ¨æ¶‰åŠåˆ°å¤šä¸ªæ“ä½œçš„åœºæ™¯ä¸­ï¼Œå¯ä»¥ä½¿ç”¨äº‹åŠ¡æœºåˆ¶æ¥ä¿è¯æ“ä½œçš„åŸå­æ€§ã€ä¸€è‡´æ€§å’ŒæŒä¹…æ€§ã€‚ä¾‹å¦‚ï¼Œæ•°æ®åº“ä¸­çš„äº‹åŠ¡æœºåˆ¶å¯ä»¥ä¿è¯ä¸€ç»„æ•°æ®åº“æ“ä½œè¦ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œå¤±è´¥ï¼Œä»è€Œç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§å’Œå¯é æ€§ã€‚</li><li>æ¶ˆæ¯åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼šåœ¨æ¶ˆæ¯çš„ä¼ é€’è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å°†æ¶ˆæ¯è½¬æ¢æˆç½‘ç»œä¼ è¾“æ ¼å¼è¿›è¡Œä¼ è¾“ã€‚å› æ­¤ï¼Œéœ€è¦å¯¹æ¶ˆæ¯è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œä»¥ä¿è¯æ¶ˆæ¯çš„æ­£ç¡®æ€§å’Œå¯é æ€§ã€‚</li></ol><p>ç»¼ä¸Šæ‰€è¿°ï¼Œæ¶ˆæ¯è¯­ä¹‰ä¼ é€’æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­éå¸¸é‡è¦çš„ä¸€ç¯ï¼Œéœ€è¦é‡‡å–å„ç§æŠ€æœ¯æ‰‹æ®µæ¥ç¡®ä¿æ¶ˆæ¯çš„æ­£ç¡®æ€§å’Œè¯­ä¹‰çš„ä¸€è‡´æ€§ï¼Œä»è€Œä¿è¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç¨³å®šè¿è¡Œã€‚</p><p>å¹‚ç­‰æ€§æŒ‡çš„æ˜¯åœ¨è¿›è¡Œå¤šæ¬¡ç›¸åŒæ“ä½œæ—¶ï¼Œæœ€ç»ˆçš„ç»“æœä¸åªæ‰§è¡Œä¸€æ¬¡æ“ä½œæ—¶çš„ç»“æœæ˜¯ä¸€è‡´çš„ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œç”±äºç½‘ç»œé€šä¿¡ç­‰å› ç´ çš„å½±å“ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ¶ˆæ¯è¢«é‡å¤ä¼ é€’ï¼Œå› æ­¤ï¼Œéœ€è¦è€ƒè™‘å¦‚ä½•ä¿è¯æ¶ˆæ¯çš„å¹‚ç­‰æ€§ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œæ¶ˆæ¯å¹‚ç­‰æ€§é€šå¸¸å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼æ¥å®ç°ï¼š</p><ol><li>å»é‡ï¼šå¯¹äºå·²ç»å¤„ç†è¿‡çš„æ¶ˆæ¯ï¼Œå¯ä»¥è¿›è¡Œå»é‡æ“ä½œï¼Œé¿å…é‡å¤å¤„ç†ç›¸åŒçš„æ¶ˆæ¯ã€‚</li><li>ä¹è§‚é”ï¼šä½¿ç”¨ä¹è§‚é”æœºåˆ¶å¯ä»¥é¿å…å¤šæ¬¡ä¿®æ”¹åŒä¸€èµ„æºå¯¼è‡´çš„æ•°æ®ä¸ä¸€è‡´é—®é¢˜ã€‚</li><li>ç‰ˆæœ¬å·ï¼šåœ¨å¯¹èµ„æºè¿›è¡Œä¿®æ”¹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·æ¥ç¡®ä¿ä¿®æ”¹çš„åŸå­æ€§å’Œä¸€è‡´æ€§ã€‚</li><li>ä¸šåŠ¡é€»è¾‘å®ç°ï¼šåœ¨å®ç°ä¸šåŠ¡é€»è¾‘æ—¶ï¼Œå¯ä»¥é€šè¿‡è®¾è®¡åˆç†çš„ä¸šåŠ¡é€»è¾‘æ¥ç¡®ä¿å¤šæ¬¡æ‰§è¡Œç›¸åŒæ“ä½œæ—¶çš„ç»“æœæ˜¯ä¸€è‡´çš„ã€‚</li></ol><p>ç»¼ä¸Šæ‰€è¿°ï¼Œæ¶ˆæ¯è¯­ä¹‰å’Œå¹‚ç­‰æ€§åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­éƒ½æ˜¯éå¸¸é‡è¦çš„æ¦‚å¿µã€‚æ¶ˆæ¯è¯­ä¹‰ä¿è¯äº†æ¶ˆæ¯çš„æ­£ç¡®æ€§å’Œè¯­ä¹‰çš„ä¸€è‡´æ€§ï¼Œè€Œå¹‚ç­‰æ€§åˆ™ä¿è¯äº†æ“ä½œçš„åŸå­æ€§å’Œä¸€è‡´æ€§ï¼Œä»è€Œç¡®ä¿åˆ†å¸ƒå¼ç³»ç»Ÿçš„ç¨³å®šè¿è¡Œã€‚ </p>]]></content>
      
      
      <categories>
          
          <category> åˆ†å¸ƒå¼ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ†å¸ƒå¼ç³»ç»Ÿ </tag>
            
            <tag> æ·±å…¥ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿ </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
